<ng-container hraFeature="data-viewer">
  <div class="header" hraFeature="header">
    <div class="logos">
      @let productIcon = variant() === 'ftu' ? 'product:ftu' : 'product:3d-organ';
      <hra-icon [svgIcon]="productIcon" />
      <hra-icon [svgIcon]="organ_()?.icon" />
    </div>
    <span class="header-label">
      @if (variant() === 'ftu') {
        Functional Tissue Units
      } @else {
        3D Organs
      }
    </span>
    <button
      mat-icon-button
      hraFeature="menu"
      hraClickEvent
      [matMenuTriggerFor]="viewermenu.menu()"
      hraIconButtonSize="large"
      aria-label="Open the data viewer's menu"
      hraPlainTooltip="More"
    >
      <mat-icon>more_vert</mat-icon>
    </button>

    <hra-viewer-menu
      hraFeature="menu"
      [currentVersion]="releaseVersion_()"
      [githubIconsUrl]="githubIconsUrl()"
      #viewermenu
    />
  </div>
  <div class="content">
    <div class="text-fields" hraFeature="data-selectors">
      <mat-form-field class="select" hraFeature="release-version" subscriptSizing="dynamic">
        <mat-icon matPrefix class="search-icon">search</mat-icon>
        <mat-label>Release version</mat-label>
        <mat-select
          [hraModelChangeEvent]="['version']"
          [ngModel]="releaseVersion_()"
          (ngModelChange)="releaseVersion.set($event.version)"
          panelClass="options-container"
          disableRipple
        >
          <mat-select-trigger>{{ releaseVersion_().label }}</mat-select-trigger>
          @for (dataset of releaseVersionData(); track dataset) {
            <mat-option [value]="dataset">
              <div class="release-label">
                <span class="release-name">{{ dataset.label }}</span>
                <span class="release-date">{{ dataset.date }}</span>
              </div>
            </mat-option>
          }
        </mat-select>
      </mat-form-field>

      <mat-form-field class="select" hraFeature="organ" subscriptSizing="dynamic">
        <mat-icon matPrefix class="search-icon">search</mat-icon>
        <mat-label>Organ</mat-label>
        <mat-select
          class="organ-selector"
          [hraModelChangeEvent]="['label']"
          [ngModel]="organ_()"
          (ngModelChange)="organ.set($event.label)"
          panelClass="options-container"
          disableRipple
        >
          @for (organ of releaseVersion_().organData; track organ) {
            <mat-option [value]="organ">{{ organ.label }}</mat-option>
          }
        </mat-select>
        @if (organ_() === undefined) {
          <mat-hint>Please select an organ from this release</mat-hint>
        }
      </mat-form-field>
    </div>

    <div class="viewer-cards" hraFeature="cards">
      @for (viewerCard of organ_()?.cards; track viewerCard) {
        <hra-viewer-card
          [hraFeature]="getCardFeatureId(viewerCard)"
          [variant]="variant()"
          [viewerCardData]="viewerCard"
        />
      }
    </div>
  </div>
</ng-container>
