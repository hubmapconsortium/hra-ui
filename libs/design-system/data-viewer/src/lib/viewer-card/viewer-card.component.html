<div class="object">
  <!-- <img src="assets/ui-images/placeholder.png" alt="" /> -->
  @if (variant() === 'ftu') {
    <img
      class="viewer-image"
      aria-hidden="true"
      alt=""
      [src]="tissue().png"
      (click)="openImageViewer(imageContent)"
      (keyup.enter)="openImageViewer(imageContent)"
    />
    <ng-template #imageContent>
      <div class="dialog-container">
        <div class="dialog-header">
          <div mat-dialog-title>{{ tissue().name }}</div>
          <div class="filler"></div>
          <button mat-icon-button>
            <mat-icon (click)="close()">clear</mat-icon>
          </button>
        </div>
        <div class="img-container">
          <img [src]="tissue().svg" class="dialog-image" alt="" />
        </div>
      </div>
    </ng-template>
  } @else {
    <model-viewer
      class="model-viewer"
      alt=""
      [src]="tissue().threeDimImage"
      shadow-intensity="1"
      camera-controls
      auto-rotate
    >
    </model-viewer>
  }
</div>

<div class="object-menu">
  <span class="tagline">{{ tissue().name }}</span>
  <button
    mat-icon-button
    [matMenuTriggerFor]="menu"
    hraIconButtonSize="large"
    aria-label="Icon to open nested menu"
    hraMicroTooltip="More"
  >
    <mat-icon>more_vert</mat-icon>
  </button>

  <mat-menu #menu="matMenu">
    <button mat-menu-item [matMenuTriggerFor]="submenu">
      <mat-icon>download</mat-icon>
      Downloads
      <mat-icon class="expand-arrow">arrow_right</mat-icon>
    </button>
    <mat-divider class="menu-divider"></mat-divider>
    <a mat-menu-item [href]="tissue().metadataUrl" target="_blank" rel="noopener noreferrer">
      <mat-icon class="reset icon">database</mat-icon>
      View source data
    </a>
  </mat-menu>
  <mat-menu #submenu="matMenu">
    @if (variant() === 'ftu') {
      <button mat-menu-item (click)="downloadClick($event, tissue().svg ?? '')">
        <mat-icon>download</mat-icon>
        SVG
      </button>
      <button mat-menu-item (click)="downloadClick($event, tissue().png ?? '')">
        <mat-icon>download</mat-icon>
        PNG
      </button>
      <a mat-menu-item [href]="tissue().ai">
        <mat-icon>download</mat-icon>
        Adobe Illustrator
      </a>
    } @else {
      <a mat-menu-item [href]="tissue().threeDimImage">
        <mat-icon>download</mat-icon>
        GLB
      </a>
    }
    <mat-divider class="menu-divider"></mat-divider>
    <a mat-menu-item class="csv-button" [href]="tissue().csv">
      <mat-icon>download</mat-icon>
      <span class="csv-label">CSV-Crosswalk</span>
      <span class="csv-desc"> A CSV file connecting digital objects to ontology terms in ASCT+B Tables. </span>
    </a>
  </mat-menu>
</div>
