<span class="mat-caption cell-types-label">
  Cell Types
  <button mat-icon-button [matMenuTriggerFor]="menu" [hraIconButtonSize]="'medium'">
    <mat-icon>more_vert</mat-icon>
  </button>
  <mat-menu #menu="matMenu" class="hra-nested-menu medium">
    <button mat-menu-item [matMenuTriggerFor]="infoSubMenu" class="expanded" matRipple matRippleColor="#201E3D14">
      <mat-icon>info</mat-icon>
      <span>Info</span>
      <mat-icon class="expand-arrow">arrow_right</mat-icon>
    </button>
    <button mat-menu-item [matMenuTriggerFor]="downloadSubMenu" class="expanded" matRipple matRippleColor="#201E3D14">
      <mat-icon>download</mat-icon>
      <span>Download</span>
      <mat-icon class="expand-arrow">arrow_right</mat-icon>
    </button>
    <button mat-menu-item>
      <mat-icon>visibility</mat-icon>
      Show Cell Link Data
    </button>
    <button mat-menu-item>
      <mat-icon>restart_alt</mat-icon>
      Reset All Colors
    </button>
    <button mat-menu-item>
      <mat-icon>code</mat-icon>
      Embed App
    </button>
  </mat-menu>
  <mat-menu #infoSubMenu="matMenu" class="hra-nested-menu medium">
    <button mat-menu-item>
      <mat-icon>info</mat-icon>
      <span>Icon 1</span>
    </button>
    <button mat-menu-item>
      <mat-icon>info</mat-icon>
      <span>Icon 2</span>
    </button>
  </mat-menu>
  <mat-menu #downloadSubMenu="matMenu" class="hra-nested-menu medium">
    <button mat-menu-item>
      <mat-icon>download</mat-icon>
      <span>Cells CSV</span>
    </button>
    <button mat-menu-item>
      <mat-icon>download</mat-icon>
      <span>Cell Links CSV</span>
    </button>
    <button mat-menu-item>
      <mat-icon>download</mat-icon>
      <span>Cell Color Map CSV</span>
    </button>
  </mat-menu>
</span>

<div class="mat-caption total-ct-label">
  Total Cell Types
  <span>{{ selection().length }}</span>
</div>
<div class="mat-caption total-cells">
  Total Cells
  <span data-testid="total-cell-count">{{ totalCellCount() | number }}</span>
</div>

<ng-scrollbar
  class="table-overflow-container"
  externalViewport=".scroll-viewport"
  externalContentWrapper="tbody"
  externalSpacer="tbody"
  asyncDetection="auto"
  hraScrollOverflowFade
  [scrollOverflowFadeOffset]="36"
>
  <div class="scroll-viewport">
    <table
      mat-table
      [dataSource]="dataSource"
      [trackBy]="trackByName"
      matSort
      matSortDirection="desc"
      matSortActive="count"
      aria-label="Cell Types Count Table"
    >
      <ng-container matColumnDef="select">
        <th mat-header-cell *matHeaderCellDef>
          <mat-checkbox
            (change)="toggleAllRows()"
            [checked]="selectionState() === 'full'"
            [indeterminate]="selectionState() === 'partial'"
            [aria-label]="getCheckboxLabel(selectionState() === 'full')"
          >
          </mat-checkbox>
        </th>
        <td mat-cell *matCellDef="let row; let index = index">
          <mat-checkbox
            (click)="$event.stopPropagation()"
            (change)="toggleRow(row)"
            [checked]="isSelected(row)"
            [aria-label]="getCheckboxLabel(isSelected(row), index + 1)"
          >
          </mat-checkbox>
        </td>
      </ng-container>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header start="desc" class="mat-caption">Name</th>
        <td mat-cell *matCellDef="let element" class="mat-caption name">
          <cde-color-picker-label
            [label]="element.name"
            [color]="element.color"
            [isAnchor]="element.name === selectedCellType()"
            (colorChange)="updateColor(element, $event)"
          >
          </cde-color-picker-label>
        </td>
      </ng-container>

      <ng-container matColumnDef="count">
        <th mat-header-cell *matHeaderCellDef mat-sort-header start="desc" class="mat-caption">Count</th>
        <td mat-cell *matCellDef="let element" class="mat-caption">{{ element.count.toLocaleString() }}</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="columns; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: columns"></tr>
    </table>
  </div>
</ng-scrollbar>
