<div class="header">
  <hra-app-logos
    appLink="https://apps.humanatlas.io/cde/"
    appIcon="assets/logo/cde_logo.svg"
    appTitle="Cell Distance Explorer"
    variant="fixed"
  >
  </hra-app-logos>
</div>

<div class="metadata">
  <cde-metadata [metadata]="mergedMetadata()"></cde-metadata>
  <cde-cell-types
    [(cellTypes)]="cellTypes"
    [(cellTypesSelection)]="cellTypesSelection"
    [selectedCellType]="selectedNodeTargetValue()"
    (download)="downloadColorMap()"
    #cellTypesTable
  ></cde-cell-types>
</div>

<div class="visualizations">
  <div class="top">
    <cde-node-dist-visualization
      [nodes]="loadedNodes()"
      [nodeTargetKey]="nodeTypeKey()"
      [nodeTargetValue]="selectedNodeTargetValue()"
      [edges]="loadedEdges()"
      [maxEdgeDistance]="maxEdgeDistance()"
      [colorMap]="cellTypesAsColorMap()"
      [colorMapKey]="colorMapTypeKey()"
      [colorMapValueKey]="colorMapValueKey()"
      [cellTypesSelection]="cellTypesSelection()"
      (nodeClick)="nodeClick.emit($event)"
      (nodeHover)="nodeHover.emit($event)"
      (edgesChange)="edges.set($event)"
      #visualization
    ></cde-node-dist-visualization>

    <cde-violin [colors]="filteredColors()" [data]="filteredDistances()" #violin></cde-violin>
  </div>

  <cde-histogram
    [colors]="filteredColors()"
    [data]="filteredDistances()"
    [filteredCellTypes]="filteredCellTypes()"
    [selectedCellType]="selectedNodeTargetValue()"
    (updateColor)="updateColor($event.entry, $event.color)"
    #histogram
  ></cde-histogram>
</div>
