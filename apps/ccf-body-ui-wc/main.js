(self.webpackChunkccf_body_ui_wc=self.webpackChunkccf_body_ui_wc||[]).push([[792],{123:(hr,Hn,Qe)=>{hr.exports={ResizeSensor:Qe(718),ElementQueries:Qe(240)}},240:function(hr,Hn,Qe){"use strict";var yn,kt,rn;typeof window<"u"&&window,kt=[Qe(718)],void 0!==(rn="function"==typeof(yn=function(zn){var _e=function(){var xe,We={},j=[];function Fe(Y){Y||(Y=document.documentElement);var K=window.getComputedStyle(Y,null).fontSize;return parseFloat(K)||16}function J(Y,K){var Ee=K.split(/\d/),Ce=Ee[Ee.length-1];switch(K=parseFloat(K),Ce){case"px":default:return K;case"em":return K*Fe(Y);case"rem":return K*Fe();case"vw":return K*document.documentElement.clientWidth/100;case"vh":return K*document.documentElement.clientHeight/100;case"vmin":case"vmax":var Le=document.documentElement.clientWidth/100,At=document.documentElement.clientHeight/100;return K*(0,Math["vmin"===Ce?"min":"max"])(Le,At)}}function ne(Y,K){this.element=Y;var Ee,Ce,Le,At,cn,Tt,Jt,vn,fr=["min-width","min-height","max-width","max-height"];this.call=function(){for(Ee in Le=function Z(Y){if(!Y.getBoundingClientRect)return{width:Y.offsetWidth,height:Y.offsetHeight};var K=Y.getBoundingClientRect();return{width:Math.round(K.width),height:Math.round(K.height)}}(this.element),Tt={},We[K])We[K].hasOwnProperty(Ee)&&(At=J(this.element,(Ce=We[K][Ee]).value),cn="width"===Ce.property?Le.width:Le.height,Jt="","min"===Ce.mode&&cn>=At&&(Jt+=Ce.value),"max"===Ce.mode&&cn<=At&&(Jt+=Ce.value),Tt[vn=Ce.mode+"-"+Ce.property]||(Tt[vn]=""),Jt&&-1===(" "+Tt[vn]+" ").indexOf(" "+Jt+" ")&&(Tt[vn]+=" "+Jt));for(var Kn in fr)fr.hasOwnProperty(Kn)&&(Tt[fr[Kn]]?this.element.setAttribute(fr[Kn],Tt[fr[Kn]].substr(1)):this.element.removeAttribute(fr[Kn]))}}function be(Y,K){Y.elementQueriesSetupInformation||(Y.elementQueriesSetupInformation=new ne(Y,K)),Y.elementQueriesSensor||(Y.elementQueriesSensor=new zn(Y,function(){Y.elementQueriesSetupInformation.call()}))}function ee(Y,K,Ee,Ce){if(typeof We[Y]>"u"){We[Y]=[];var Le=j.length;xe.innerHTML+="\n"+Y+" {animation: 0.1s element-queries;}",xe.innerHTML+="\n"+Y+" > .resize-sensor {min-width: "+Le+"px;}",j.push(Y)}We[Y].push({mode:K,property:Ee,value:Ce})}function le(Y){var K;if(document.querySelectorAll&&(K=Y?Y.querySelectorAll.bind(Y):document.querySelectorAll.bind(document)),!K&&typeof $$<"u"&&(K=$$),!K&&typeof jQuery<"u"&&(K=jQuery),!K)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return K}function Dn(Y){var K=[],Ee=[],Ce=[],Le=0,At=-1,cn=[];for(var Tt in Y.children)if(Y.children.hasOwnProperty(Tt)&&Y.children[Tt].tagName&&"img"===Y.children[Tt].tagName.toLowerCase()){K.push(Y.children[Tt]);var Jt=Y.children[Tt].getAttribute("min-width")||Y.children[Tt].getAttribute("data-min-width"),vn=Y.children[Tt].getAttribute("data-src")||Y.children[Tt].getAttribute("url");Ce.push(vn),Ee.push({minWidth:Jt}),Jt?Y.children[Tt].style.display="none":(Le=K.length-1,Y.children[Tt].style.display="block")}function Kn(){var ln,xt=!1;for(ln in K)K.hasOwnProperty(ln)&&Ee[ln].minWidth&&Y.offsetWidth>Ee[ln].minWidth&&(xt=ln);if(xt||(xt=Le),At!==xt)if(cn[xt])K[At].style.display="none",K[xt].style.display="block",At=xt;else{var Gn=new Image;Gn.onload=function(){K[xt].src=Ce[xt],K[At].style.display="none",K[xt].style.display="block",cn[xt]=!0,At=xt},Gn.src=Ce[xt]}else K[xt].src=Ce[xt]}At=Le,Y.resizeSensorInstance=new zn(Y,Kn),Kn()}var sn=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,Pi=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function En(Y){var K,Ee,Ce,Le;for(Y=Y.replace(/'/g,'"');null!==(K=sn.exec(Y));)for(Ee=K[1]+K[3],Ce=K[2];null!==(Le=Pi.exec(Ce));)ee(Ee,Le[1],Le[2],Le[3])}function Ir(Y){var K="";if(Y)if("string"==typeof Y)(-1!==(Y=Y.toLowerCase()).indexOf("min-width")||-1!==Y.indexOf("max-width"))&&En(Y);else for(var Ee=0,Ce=Y.length;Ee<Ce;Ee++)1===Y[Ee].type?(-1!==(K=Y[Ee].selectorText||Y[Ee].cssText).indexOf("min-height")||-1!==K.indexOf("max-height")||-1!==K.indexOf("min-width")||-1!==K.indexOf("max-width"))&&En(K):4===Y[Ee].type?Ir(Y[Ee].cssRules||Y[Ee].rules):3===Y[Ee].type&&Y[Ee].styleSheet.hasOwnProperty("cssRules")&&Ir(Y[Ee].styleSheet.cssRules)}var hi=!1;this.init=function(){var Y="animationstart";typeof document.documentElement.style.webkitAnimationName<"u"?Y="webkitAnimationStart":typeof document.documentElement.style.MozAnimationName<"u"?Y="mozanimationstart":typeof document.documentElement.style.OAnimationName<"u"&&(Y="oanimationstart"),document.body.addEventListener(Y,function(Ce){var Le=Ce.target,At=Le&&window.getComputedStyle(Le,null),cn=At&&At.getPropertyValue("animation-name");if(cn&&-1!==cn.indexOf("element-queries")){Le.elementQueriesSensor=new zn(Le,function(){Le.elementQueriesSetupInformation&&Le.elementQueriesSetupInformation.call()});var vn=window.getComputedStyle(Le.resizeSensor,null).getPropertyValue("min-width");vn=parseInt(vn.replace("px","")),be(Ce.target,j[vn])}}),hi||((xe=document.createElement("style")).type="text/css",xe.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",xe.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(xe),hi=!0);for(var K=0,Ee=document.styleSheets.length;K<Ee;K++)try{document.styleSheets[K].href&&0===document.styleSheets[K].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[K].href),Ir(document.styleSheets[K].cssRules||document.styleSheets[K].rules||document.styleSheets[K].cssText)}catch{}!function nt(){for(var K=le()("[data-responsive-image],[responsive-image]"),Ee=0,Ce=K.length;Ee<Ce;Ee++)Dn(K[Ee])}()},this.findElementQueriesElements=function(Y){!function jt(Y){var K=le(Y);for(var Ee in We)if(We.hasOwnProperty(Ee))for(var Ce=K(Ee,Y),Le=0,At=Ce.length;Le<At;Le++)be(Ce[Le],Ee)}(Y)},this.update=function(){this.init()}};_e.update=function(){_e.instance.update()},_e.detach=function(xe){xe.elementQueriesSetupInformation?(xe.elementQueriesSensor.detach(),delete xe.elementQueriesSetupInformation,delete xe.elementQueriesSensor):xe.resizeSensorInstance&&(xe.resizeSensorInstance.detach(),delete xe.resizeSensorInstance)},_e.init=function(){_e.instance||(_e.instance=new _e),_e.instance.init()};return _e.findElementQueriesElements=function(xe){_e.instance.findElementQueriesElements(xe)},_e.listen=function(){!function(xe){if(document.addEventListener)document.addEventListener("DOMContentLoaded",xe,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var We=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(xe(),clearInterval(We))},10);else window.onload=xe}(_e.init)},_e})?yn.apply(Hn,kt):yn)&&(hr.exports=rn)},435:()=>{},492:()=>{},511:(hr,Hn,Qe)=>{var yn;!function(kt,rn,zn,_e){"use strict";var le,ut=["","webkit","Moz","MS","ms","o"],xe=rn.createElement("div"),j=Math.round,Fe=Math.abs,Z=Date.now;function J(C,x,S){return setTimeout(sn(C,S),x)}function ne(C,x,S){return!!Array.isArray(C)&&(be(C,S[x],S),!0)}function be(C,x,S){var O;if(C)if(C.forEach)C.forEach(x,S);else if(C.length!==_e)for(O=0;O<C.length;)x.call(S,C[O],O,C),O++;else for(O in C)C.hasOwnProperty(O)&&x.call(S,C[O],O,C)}function ee(C,x,S){var O="DEPRECATED METHOD: "+x+"\n"+S+" AT \n";return function(){var H=new Error("get-stack-trace"),oe=H&&H.stack?H.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",$e=kt.console&&(kt.console.warn||kt.console.log);return $e&&$e.call(kt.console,O,oe),C.apply(this,arguments)}}le="function"!=typeof Object.assign?function(x){if(x===_e||null===x)throw new TypeError("Cannot convert undefined or null to object");for(var S=Object(x),O=1;O<arguments.length;O++){var H=arguments[O];if(H!==_e&&null!==H)for(var oe in H)H.hasOwnProperty(oe)&&(S[oe]=H[oe])}return S}:Object.assign;var jt=ee(function(x,S,O){for(var H=Object.keys(S),oe=0;oe<H.length;)(!O||O&&x[H[oe]]===_e)&&(x[H[oe]]=S[H[oe]]),oe++;return x},"extend","Use `assign`."),Dn=ee(function(x,S){return jt(x,S,!0)},"merge","Use `assign`.");function nt(C,x,S){var H,O=x.prototype;(H=C.prototype=Object.create(O)).constructor=C,H._super=O,S&&le(H,S)}function sn(C,x){return function(){return C.apply(x,arguments)}}function Pi(C,x){return"function"==typeof C?C.apply(x&&x[0]||_e,x):C}function En(C,x){return C===_e?x:C}function Ir(C,x,S){be(Ee(x),function(O){C.addEventListener(O,S,!1)})}function hi(C,x,S){be(Ee(x),function(O){C.removeEventListener(O,S,!1)})}function Y(C,x){for(;C;){if(C==x)return!0;C=C.parentNode}return!1}function K(C,x){return C.indexOf(x)>-1}function Ee(C){return C.trim().split(/\s+/g)}function Ce(C,x,S){if(C.indexOf&&!S)return C.indexOf(x);for(var O=0;O<C.length;){if(S&&C[O][S]==x||!S&&C[O]===x)return O;O++}return-1}function Le(C){return Array.prototype.slice.call(C,0)}function At(C,x,S){for(var O=[],H=[],oe=0;oe<C.length;){var $e=x?C[oe][x]:C[oe];Ce(H,$e)<0&&O.push(C[oe]),H[oe]=$e,oe++}return S&&(O=x?O.sort(function(Vt,mr){return Vt[x]>mr[x]}):O.sort()),O}function cn(C,x){for(var S,O,H=x[0].toUpperCase()+x.slice(1),oe=0;oe<ut.length;){if((O=(S=ut[oe])?S+H:x)in C)return O;oe++}return _e}var Tt=1;function vn(C){var x=C.ownerDocument||C;return x.defaultView||x.parentWindow||kt}var Kn="ontouchstart"in kt,xt=cn(kt,"PointerEvent")!==_e,ln=Kn&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Gn="touch",Th="mouse",Kg=["x","y"],Yl=["clientX","clientY"];function Xr(C,x){var S=this;this.manager=C,this.callback=x,this.element=C.element,this.target=C.options.inputTarget,this.domHandler=function(O){Pi(C.options.enable,[C])&&S.handler(O)},this.init()}function Ih(C,x,S){var O=S.pointers.length,H=S.changedPointers.length,oe=1&x&&O-H==0,$e=12&x&&O-H==0;S.isFirst=!!oe,S.isFinal=!!$e,oe&&(C.session={}),S.eventType=x,function g0(C,x){var S=C.session,O=x.pointers,H=O.length;S.firstInput||(S.firstInput=Zl(x)),H>1&&!S.firstMultiple?S.firstMultiple=Zl(x):1===H&&(S.firstMultiple=!1);var oe=S.firstInput,$e=S.firstMultiple,Rn=$e?$e.center:oe.center,Vt=x.center=Kl(O);x.timeStamp=Z(),x.deltaTime=x.timeStamp-oe.timeStamp,x.angle=Jl(Rn,Vt),x.distance=Ic(Rn,Vt),function uR(C,x){var S=x.center,O=C.offsetDelta||{},H=C.prevDelta||{},oe=C.prevInput||{};(1===x.eventType||4===oe.eventType)&&(H=C.prevDelta={x:oe.deltaX||0,y:oe.deltaY||0},O=C.offsetDelta={x:S.x,y:S.y}),x.deltaX=H.x+(S.x-O.x),x.deltaY=H.y+(S.y-O.y)}(S,x),x.offsetDirection=Mt(x.deltaX,x.deltaY);var mr=Sc(x.deltaTime,x.deltaX,x.deltaY);x.overallVelocityX=mr.x,x.overallVelocityY=mr.y,x.overallVelocity=Fe(mr.x)>Fe(mr.y)?mr.x:mr.y,x.scale=$e?function ns(C,x){return Ic(x[0],x[1],Yl)/Ic(C[0],C[1],Yl)}($e.pointers,O):1,x.rotation=$e?function Jg(C,x){return Jl(x[1],x[0],Yl)+Jl(C[1],C[0],Yl)}($e.pointers,O):0,x.maxPointers=S.prevInput?x.pointers.length>S.prevInput.maxPointers?x.pointers.length:S.prevInput.maxPointers:x.pointers.length,function dt(C,x){var H,oe,$e,Rn,S=C.lastInterval||x,O=x.timeStamp-S.timeStamp;if(8!=x.eventType&&(O>25||S.velocity===_e)){var Vt=x.deltaX-S.deltaX,mr=x.deltaY-S.deltaY,os=Sc(O,Vt,mr);oe=os.x,$e=os.y,H=Fe(os.x)>Fe(os.y)?os.x:os.y,Rn=Mt(Vt,mr),C.lastInterval=x}else H=S.velocity,oe=S.velocityX,$e=S.velocityY,Rn=S.direction;x.velocity=H,x.velocityX=oe,x.velocityY=$e,x.direction=Rn}(S,x);var os=C.element;Y(x.srcEvent.target,os)&&(os=x.srcEvent.target),x.target=os}(C,S),C.emit("hammer.input",S),C.recognize(S),C.session.prevInput=S}function Zl(C){for(var x=[],S=0;S<C.pointers.length;)x[S]={clientX:j(C.pointers[S].clientX),clientY:j(C.pointers[S].clientY)},S++;return{timeStamp:Z(),pointers:x,center:Kl(x),deltaX:C.deltaX,deltaY:C.deltaY}}function Kl(C){var x=C.length;if(1===x)return{x:j(C[0].clientX),y:j(C[0].clientY)};for(var S=0,O=0,H=0;H<x;)S+=C[H].clientX,O+=C[H].clientY,H++;return{x:j(S/x),y:j(O/x)}}function Sc(C,x,S){return{x:x/C||0,y:S/C||0}}function Mt(C,x){return C===x?1:Fe(C)>=Fe(x)?C<0?2:4:x<0?8:16}function Ic(C,x,S){S||(S=Kg);var O=x[S[0]]-C[S[0]],H=x[S[1]]-C[S[1]];return Math.sqrt(O*O+H*H)}function Jl(C,x,S){return S||(S=Kg),180*Math.atan2(x[S[1]]-C[S[1]],x[S[0]]-C[S[0]])/Math.PI}Xr.prototype={handler:function(){},init:function(){this.evEl&&Ir(this.element,this.evEl,this.domHandler),this.evTarget&&Ir(this.target,this.evTarget,this.domHandler),this.evWin&&Ir(vn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&hi(this.element,this.evEl,this.domHandler),this.evTarget&&hi(this.target,this.evTarget,this.domHandler),this.evWin&&hi(vn(this.element),this.evWin,this.domHandler)}};var Ql={mousedown:1,mousemove:2,mouseup:4};function tu(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,Xr.apply(this,arguments)}nt(tu,Xr,{handler:function(x){var S=Ql[x.type];1&S&&0===x.button&&(this.pressed=!0),2&S&&1!==x.which&&(S=4),this.pressed&&(4&S&&(this.pressed=!1),this.callback(this.manager,S,{pointers:[x],changedPointers:[x],pointerType:Th,srcEvent:x}))}});var m0={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},_0={2:Gn,3:"pen",4:Th,5:"kinect"},nu="pointerdown",Ns="pointermove pointerup pointercancel";function ba(){this.evEl=nu,this.evWin=Ns,Xr.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}kt.MSPointerEvent&&!kt.PointerEvent&&(nu="MSPointerDown",Ns="MSPointerMove MSPointerUp MSPointerCancel"),nt(ba,Xr,{handler:function(x){var S=this.store,O=!1,H=x.type.toLowerCase().replace("ms",""),oe=m0[H],$e=_0[x.pointerType]||x.pointerType,Rn=$e==Gn,Vt=Ce(S,x.pointerId,"pointerId");1&oe&&(0===x.button||Rn)?Vt<0&&(S.push(x),Vt=S.length-1):12&oe&&(O=!0),!(Vt<0)&&(S[Vt]=x,this.callback(this.manager,oe,{pointers:S,changedPointers:[x],pointerType:$e,srcEvent:x}),O&&S.splice(Vt,1))}});var y0={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ru(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,Xr.apply(this,arguments)}function b0(C,x){var S=Le(C.touches),O=Le(C.changedTouches);return 12&x&&(S=At(S.concat(O),"identifier",!0)),[S,O]}nt(ru,Xr,{handler:function(x){var S=y0[x.type];if(1===S&&(this.started=!0),this.started){var O=b0.call(this,x,S);12&S&&O[0].length-O[1].length==0&&(this.started=!1),this.callback(this.manager,S,{pointers:O[0],changedPointers:O[1],pointerType:Gn,srcEvent:x})}}});var wa={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function su(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},Xr.apply(this,arguments)}function Dh(C,x){var S=Le(C.touches),O=this.targetIds;if(3&x&&1===S.length)return O[S[0].identifier]=!0,[S,S];var H,oe,$e=Le(C.changedTouches),Rn=[],Vt=this.target;if(oe=S.filter(function(mr){return Y(mr.target,Vt)}),1===x)for(H=0;H<oe.length;)O[oe[H].identifier]=!0,H++;for(H=0;H<$e.length;)O[$e[H].identifier]&&Rn.push($e[H]),12&x&&delete O[$e[H].identifier],H++;return Rn.length?[At(oe.concat(Rn),"identifier",!0),Rn]:void 0}function Ni(){Xr.apply(this,arguments);var C=sn(this.handler,this);this.touch=new su(this.manager,C),this.mouse=new tu(this.manager,C),this.primaryTouch=null,this.lastTouches=[]}function E0(C,x){1&C?(this.primaryTouch=x.changedPointers[0].identifier,Rh.call(this,x)):12&C&&Rh.call(this,x)}function Rh(C){var x=C.changedPointers[0];if(x.identifier===this.primaryTouch){var S={x:x.clientX,y:x.clientY};this.lastTouches.push(S);var O=this.lastTouches;setTimeout(function(){var oe=O.indexOf(S);oe>-1&&O.splice(oe,1)},2500)}}function Se(C){for(var x=C.srcEvent.clientX,S=C.srcEvent.clientY,O=0;O<this.lastTouches.length;O++){var H=this.lastTouches[O],oe=Math.abs(x-H.x),$e=Math.abs(S-H.y);if(oe<=25&&$e<=25)return!0}return!1}nt(su,Xr,{handler:function(x){var S=wa[x.type],O=Dh.call(this,x,S);O&&this.callback(this.manager,S,{pointers:O[0],changedPointers:O[1],pointerType:Gn,srcEvent:x})}}),nt(Ni,Xr,{handler:function(x,S,O){var oe=O.pointerType==Th;if(!(oe&&O.sourceCapabilities&&O.sourceCapabilities.firesTouchEvents)){if(O.pointerType==Gn)E0.call(this,S,O);else if(oe&&Se.call(this,O))return;this.callback(x,S,O)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Oh=cn(xe.style,"touchAction"),em=Oh!==_e,tm="compute",fe="manipulation",ks="none",Qt="pan-x",Ea="pan-y",bt=function he(){if(!em)return!1;var C={},x=kt.CSS&&kt.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(S){C[S]=!x||kt.CSS.supports("touch-action",S)}),C}();function _t(C,x){this.manager=C,this.set(x)}function Fs(C){this.options=le({},this.defaults,C||{}),this.id=function Jt(){return Tt++}(),this.manager=null,this.options.enable=En(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Nh(C){return 16&C?"cancel":8&C?"end":4&C?"move":2&C?"start":""}function ki(C){return 16==C?"down":8==C?"up":2==C?"left":4==C?"right":""}function is(C,x){var S=x.manager;return S?S.get(C):C}function $n(){Fs.apply(this,arguments)}function ss(){$n.apply(this,arguments),this.pX=null,this.pY=null}function au(){$n.apply(this,arguments)}function Mc(){Fs.apply(this,arguments),this._timer=null,this._input=null}function Ls(){$n.apply(this,arguments)}function rm(){$n.apply(this,arguments)}function at(){Fs.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Aa(C,x){return(x=x||{}).recognizers=En(x.recognizers,Aa.defaults.preset),new kh(C,x)}function kh(C,x){this.options=le({},Aa.defaults,x||{}),this.options.inputTarget=this.options.inputTarget||C,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=C,this.input=function p0(C){return new(C.options.inputClass||(xt?ba:ln?su:Kn?Ni:tu))(C,Ih)}(this),this.touchAction=new _t(this,this.options.touchAction),un(this,!0),be(this.options.recognizers,function(S){var O=this.add(new S[0](S[1]));S[2]&&O.recognizeWith(S[2]),S[3]&&O.requireFailure(S[3])},this)}function un(C,x){var O,S=C.element;S.style&&(be(C.options.cssProps,function(H,oe){O=cn(S.style,oe),x?(C.oldCssProps[O]=S.style[O],S.style[O]=H):S.style[O]=C.oldCssProps[O]||""}),x||(C.oldCssProps={}))}_t.prototype={set:function(C){C==tm&&(C=this.compute()),em&&this.manager.element.style&&bt[C]&&(this.manager.element.style[Oh]=C),this.actions=C.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var C=[];return be(this.manager.recognizers,function(x){Pi(x.options.enable,[x])&&(C=C.concat(x.getTouchAction()))}),function C0(C){if(K(C,ks))return ks;var x=K(C,Qt),S=K(C,Ea);return x&&S?ks:x||S?x?Qt:Ea:K(C,fe)?fe:"auto"}(C.join(" "))},preventDefaults:function(C){var x=C.srcEvent,S=C.offsetDirection;if(!this.manager.session.prevented){var O=this.actions,H=K(O,ks)&&!bt[ks],oe=K(O,Ea)&&!bt[Ea],$e=K(O,Qt)&&!bt[Qt];if(H&&1===C.pointers.length&&C.distance<2&&C.deltaTime<250)return;return $e&&oe||!(H||oe&&6&S||$e&&24&S)?void 0:this.preventSrc(x)}x.preventDefault()},preventSrc:function(C){this.manager.session.prevented=!0,C.preventDefault()}},Fs.prototype={defaults:{},set:function(C){return le(this.options,C),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(C){if(ne(C,"recognizeWith",this))return this;var x=this.simultaneous;return x[(C=is(C,this)).id]||(x[C.id]=C,C.recognizeWith(this)),this},dropRecognizeWith:function(C){return ne(C,"dropRecognizeWith",this)||(C=is(C,this),delete this.simultaneous[C.id]),this},requireFailure:function(C){if(ne(C,"requireFailure",this))return this;var x=this.requireFail;return-1===Ce(x,C=is(C,this))&&(x.push(C),C.requireFailure(this)),this},dropRequireFailure:function(C){if(ne(C,"dropRequireFailure",this))return this;C=is(C,this);var x=Ce(this.requireFail,C);return x>-1&&this.requireFail.splice(x,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(C){return!!this.simultaneous[C.id]},emit:function(C){var x=this,S=this.state;function O(H){x.manager.emit(H,C)}S<8&&O(x.options.event+Nh(S)),O(x.options.event),C.additionalEvent&&O(C.additionalEvent),S>=8&&O(x.options.event+Nh(S))},tryEmit:function(C){if(this.canEmit())return this.emit(C);this.state=32},canEmit:function(){for(var C=0;C<this.requireFail.length;){if(!(33&this.requireFail[C].state))return!1;C++}return!0},recognize:function(C){var x=le({},C);if(!Pi(this.options.enable,[this,x]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(x),30&this.state&&this.tryEmit(x)},process:function(C){},getTouchAction:function(){},reset:function(){}},nt($n,Fs,{defaults:{pointers:1},attrTest:function(C){var x=this.options.pointers;return 0===x||C.pointers.length===x},process:function(C){var x=this.state,S=C.eventType,O=6&x,H=this.attrTest(C);return O&&(8&S||!H)?16|x:O||H?4&S?8|x:2&x?4|x:2:32}}),nt(ss,$n,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var C=this.options.direction,x=[];return 6&C&&x.push(Ea),24&C&&x.push(Qt),x},directionTest:function(C){var x=this.options,S=!0,O=C.distance,H=C.direction,oe=C.deltaX,$e=C.deltaY;return H&x.direction||(6&x.direction?(H=0===oe?1:oe<0?2:4,S=oe!=this.pX,O=Math.abs(C.deltaX)):(H=0===$e?1:$e<0?8:16,S=$e!=this.pY,O=Math.abs(C.deltaY))),C.direction=H,S&&O>x.threshold&&H&x.direction},attrTest:function(C){return $n.prototype.attrTest.call(this,C)&&(2&this.state||!(2&this.state)&&this.directionTest(C))},emit:function(C){this.pX=C.deltaX,this.pY=C.deltaY;var x=ki(C.direction);x&&(C.additionalEvent=this.options.event+x),this._super.emit.call(this,C)}}),nt(au,$n,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ks]},attrTest:function(C){return this._super.attrTest.call(this,C)&&(Math.abs(C.scale-1)>this.options.threshold||2&this.state)},emit:function(C){1!==C.scale&&(C.additionalEvent=this.options.event+(C.scale<1?"in":"out")),this._super.emit.call(this,C)}}),nt(Mc,Fs,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(C){var x=this.options,S=C.pointers.length===x.pointers,O=C.distance<x.threshold,H=C.deltaTime>x.time;if(this._input=C,!O||!S||12&C.eventType&&!H)this.reset();else if(1&C.eventType)this.reset(),this._timer=J(function(){this.state=8,this.tryEmit()},x.time,this);else if(4&C.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(C){8===this.state&&(C&&4&C.eventType?this.manager.emit(this.options.event+"up",C):(this._input.timeStamp=Z(),this.manager.emit(this.options.event,this._input)))}}),nt(Ls,$n,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ks]},attrTest:function(C){return this._super.attrTest.call(this,C)&&(Math.abs(C.rotation)>this.options.threshold||2&this.state)}}),nt(rm,$n,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return ss.prototype.getTouchAction.call(this)},attrTest:function(C){var S,x=this.options.direction;return 30&x?S=C.overallVelocity:6&x?S=C.overallVelocityX:24&x&&(S=C.overallVelocityY),this._super.attrTest.call(this,C)&&x&C.offsetDirection&&C.distance>this.options.threshold&&C.maxPointers==this.options.pointers&&Fe(S)>this.options.velocity&&4&C.eventType},emit:function(C){var x=ki(C.offsetDirection);x&&this.manager.emit(this.options.event+x,C),this.manager.emit(this.options.event,C)}}),nt(at,Fs,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[fe]},process:function(C){var x=this.options,S=C.pointers.length===x.pointers,O=C.distance<x.threshold,H=C.deltaTime<x.time;if(this.reset(),1&C.eventType&&0===this.count)return this.failTimeout();if(O&&H&&S){if(4!=C.eventType)return this.failTimeout();var oe=!this.pTime||C.timeStamp-this.pTime<x.interval,$e=!this.pCenter||Ic(this.pCenter,C.center)<x.posThreshold;if(this.pTime=C.timeStamp,this.pCenter=C.center,$e&&oe?this.count+=1:this.count=1,this._input=C,0==this.count%x.taps)return this.hasRequireFailures()?(this._timer=J(function(){this.state=8,this.tryEmit()},x.interval,this),2):8}return 32},failTimeout:function(){return this._timer=J(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Aa.VERSION="2.0.7",Aa.defaults={domEvents:!1,touchAction:tm,enable:!0,inputTarget:null,inputClass:null,preset:[[Ls,{enable:!1}],[au,{enable:!1},["rotate"]],[rm,{direction:6}],[ss,{direction:6},["swipe"]],[at],[at,{event:"doubletap",taps:2},["tap"]],[Mc]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},kh.prototype={set:function(C){return le(this.options,C),C.touchAction&&this.touchAction.update(),C.inputTarget&&(this.input.destroy(),this.input.target=C.inputTarget,this.input.init()),this},stop:function(C){this.session.stopped=C?2:1},recognize:function(C){var x=this.session;if(!x.stopped){this.touchAction.preventDefaults(C);var S,O=this.recognizers,H=x.curRecognizer;(!H||H&&8&H.state)&&(H=x.curRecognizer=null);for(var oe=0;oe<O.length;)S=O[oe],2===x.stopped||H&&S!=H&&!S.canRecognizeWith(H)?S.reset():S.recognize(C),!H&&14&S.state&&(H=x.curRecognizer=S),oe++}},get:function(C){if(C instanceof Fs)return C;for(var x=this.recognizers,S=0;S<x.length;S++)if(x[S].options.event==C)return x[S];return null},add:function(C){if(ne(C,"add",this))return this;var x=this.get(C.options.event);return x&&this.remove(x),this.recognizers.push(C),C.manager=this,this.touchAction.update(),C},remove:function(C){if(ne(C,"remove",this))return this;if(C=this.get(C)){var x=this.recognizers,S=Ce(x,C);-1!==S&&(x.splice(S,1),this.touchAction.update())}return this},on:function(C,x){if(C!==_e&&x!==_e){var S=this.handlers;return be(Ee(C),function(O){S[O]=S[O]||[],S[O].push(x)}),this}},off:function(C,x){if(C!==_e){var S=this.handlers;return be(Ee(C),function(O){x?S[O]&&S[O].splice(Ce(S[O],x),1):delete S[O]}),this}},emit:function(C,x){this.options.domEvents&&function Fh(C,x){var S=rn.createEvent("Event");S.initEvent(C,!0,!0),S.gesture=x,x.target.dispatchEvent(S)}(C,x);var S=this.handlers[C]&&this.handlers[C].slice();if(S&&S.length){x.type=C,x.preventDefault=function(){x.srcEvent.preventDefault()};for(var O=0;O<S.length;)S[O](x),O++}},destroy:function(){this.element&&un(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},le(Aa,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:kh,Input:Xr,TouchAction:_t,TouchInput:su,MouseInput:tu,PointerEventInput:ba,TouchMouseInput:Ni,SingleTouchInput:ru,Recognizer:Fs,AttrRecognizer:$n,Tap:at,Pan:ss,Swipe:rm,Pinch:au,Rotate:Ls,Press:Mc,on:Ir,off:hi,each:be,merge:Dn,extend:jt,assign:le,inherit:nt,bindFn:sn,prefixed:cn}),(typeof kt<"u"?kt:typeof self<"u"?self:{}).Hammer=Aa,(yn=function(){return Aa}.call(Hn,Qe,Hn,hr))!==_e&&(hr.exports=yn)}(window,document)},718:function(hr,Hn,Qe){"use strict";var yn,kt;typeof window<"u"&&window,void 0!==(kt="function"==typeof(yn=function(){if(typeof window>"u")return null;var rn=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")(),zn=rn.requestAnimationFrame||rn.mozRequestAnimationFrame||rn.webkitRequestAnimationFrame||function(Z){return rn.setTimeout(Z,20)},_e=rn.cancelAnimationFrame||rn.mozCancelAnimationFrame||rn.webkitCancelAnimationFrame||function(Z){rn.clearTimeout(Z)};function ut(Z,J){var ne=Object.prototype.toString.call(Z),be="[object Array]"===ne||"[object NodeList]"===ne||"[object HTMLCollection]"===ne||"[object Object]"===ne||typeof jQuery<"u"&&Z instanceof jQuery||typeof Elements<"u"&&Z instanceof Elements,ee=0,le=Z.length;if(be)for(;ee<le;ee++)J(Z[ee]);else J(Z)}function xe(Z){if(!Z.getBoundingClientRect)return{width:Z.offsetWidth,height:Z.offsetHeight};var J=Z.getBoundingClientRect();return{width:Math.round(J.width),height:Math.round(J.height)}}function We(Z,J){Object.keys(J).forEach(function(ne){Z.style[ne]=J[ne]})}var j=function(Z,J){var ne=0;function be(){var jt,Dn,le=[];this.add=function(nt){le.push(nt)},this.call=function(nt){for(jt=0,Dn=le.length;jt<Dn;jt++)le[jt].call(this,nt)},this.remove=function(nt){var sn=[];for(jt=0,Dn=le.length;jt<Dn;jt++)le[jt]!==nt&&sn.push(le[jt]);le=sn},this.length=function(){return le.length}}function ee(le,jt){if(le){if(le.resizedAttached)return void le.resizedAttached.add(jt);le.resizedAttached=new be,le.resizedAttached.add(jt),le.resizeSensor=document.createElement("div"),le.resizeSensor.dir="ltr",le.resizeSensor.className="resize-sensor";var Dn={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},nt={position:"absolute",left:"0px",top:"0px",transition:"0s"};We(le.resizeSensor,Dn);var sn=document.createElement("div");sn.className="resize-sensor-expand",We(sn,Dn);var Pi=document.createElement("div");We(Pi,nt),sn.appendChild(Pi);var En=document.createElement("div");En.className="resize-sensor-shrink",We(En,Dn);var Ir=document.createElement("div");We(Ir,nt),We(Ir,{width:"200%",height:"200%"}),En.appendChild(Ir),le.resizeSensor.appendChild(sn),le.resizeSensor.appendChild(En),le.appendChild(le.resizeSensor);var hi=window.getComputedStyle(le),Y=hi?hi.getPropertyValue("position"):null;"absolute"!==Y&&"relative"!==Y&&"fixed"!==Y&&"sticky"!==Y&&(le.style.position="relative");var K=!1,Ee=0,Ce=xe(le),Le=0,At=0,cn=!0;ne=0;var Jt=function(){if(cn){if(0===le.offsetWidth&&0===le.offsetHeight)return void(ne||(ne=zn(function(){ne=0,Jt()})));cn=!1}var xt,ln;ln=le.offsetHeight,Pi.style.width=(xt=le.offsetWidth)+10+"px",Pi.style.height=ln+10+"px",sn.scrollLeft=xt+10,sn.scrollTop=ln+10,En.scrollLeft=xt+10,En.scrollTop=ln+10};le.resizeSensor.resetSensor=Jt;var vn=function(){Ee=0,K&&(Le=Ce.width,At=Ce.height,le.resizedAttached&&le.resizedAttached.call(Ce))},fr=function(){Ce=xe(le),(K=Ce.width!==Le||Ce.height!==At)&&!Ee&&(Ee=zn(vn)),Jt()},Kn=function(xt,ln,Gn){xt.attachEvent?xt.attachEvent("on"+ln,Gn):xt.addEventListener(ln,Gn)};Kn(sn,"scroll",fr),Kn(En,"scroll",fr),ne=zn(function(){ne=0,Jt()})}}ut(Z,function(le){ee(le,J)}),this.detach=function(le){ne||(_e(ne),ne=0),j.detach(Z,le)},this.reset=function(){Z.resizeSensor.resetSensor()}};if(j.reset=function(Z){ut(Z,function(J){J.resizeSensor.resetSensor()})},j.detach=function(Z,J){ut(Z,function(ne){ne&&(ne.resizedAttached&&"function"==typeof J&&(ne.resizedAttached.remove(J),ne.resizedAttached.length())||ne.resizeSensor&&(ne.contains(ne.resizeSensor)&&ne.removeChild(ne.resizeSensor),delete ne.resizeSensor,delete ne.resizedAttached))})},typeof MutationObserver<"u"){var Fe=new MutationObserver(function(Z){for(var J in Z)if(Z.hasOwnProperty(J))for(var ne=Z[J].addedNodes,be=0;be<ne.length;be++)ne[be].resizeSensor&&j.reset(ne[be])});document.addEventListener("DOMContentLoaded",function(Z){Fe.observe(document.body,{childList:!0,subtree:!0})})}return j})?yn.call(Hn,Qe,Hn,hr):yn)&&(hr.exports=kt)},738:(hr,Hn,Qe)=>{"use strict";var yn={};Qe.r(yn),Qe.d(yn,{decode:()=>Pbe,name:()=>Obe});var kt={};Qe.r(kt),Qe.d(kt,{name:()=>Ube,preprocess:()=>jbe});var rn={};Qe.r(rn),Qe.d(rn,{name:()=>Vbe,preprocess:()=>Hbe});var zn={};Qe.r(zn),Qe.d(zn,{decode:()=>x0e,encode:()=>S0e,name:()=>A0e,preprocess:()=>T0e});var _e={};Qe.r(_e),Qe.d(_e,{decode:()=>O0e,encode:()=>P0e,name:()=>R0e});var ut={};Qe.r(ut),Qe.d(ut,{decode:()=>k0e,encode:()=>F0e,name:()=>N0e});var xe={};function We(n,e,t,r,i,s,o){try{var a=n[s](o),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(r,i)}function j(n){return function(){var e=this,t=arguments;return new Promise(function(r,i){var s=n.apply(e,t);function o(c){We(s,r,i,o,a,"next",c)}function a(c){We(s,r,i,o,a,"throw",c)}o(void 0)})}}function Fe(n,e){return Object.is(n,e)}Qe.r(xe),Qe.d(xe,{decode:()=>B0e,encode:()=>U0e,name:()=>L0e});let Z=null,J=!1,ne=1;const be=Symbol("SIGNAL");function ee(n){const e=Z;return Z=n,e}const nt={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function sn(n){if(J)throw new Error("");if(null===Z)return;Z.consumerOnSignalRead(n);const e=Z.nextProducerIndex++;vn(Z),e<Z.producerNode.length&&Z.producerNode[e]!==n&&Jt(Z)&&Tt(Z.producerNode[e],Z.producerIndexOfThis[e]),Z.producerNode[e]!==n&&(Z.producerNode[e]=n,Z.producerIndexOfThis[e]=Jt(Z)?cn(n,Z,e):0),Z.producerLastReadVersion[e]=n.version}function En(n){if((!Jt(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==ne)){if(!n.producerMustRecompute(n)&&!Le(n))return void K(n);n.producerRecomputeValue(n),K(n)}}function Ir(n){if(void 0===n.liveConsumerNode)return;const e=J;J=!0;try{for(const t of n.liveConsumerNode)t.dirty||Y(t)}finally{J=e}}function hi(){return!1!==Z?.consumerAllowSignalWrites}function Y(n){n.dirty=!0,Ir(n),n.consumerMarkedDirty?.(n)}function K(n){n.dirty=!1,n.lastCleanEpoch=ne}function Ee(n){return n&&(n.nextProducerIndex=0),ee(n)}function Ce(n,e){if(ee(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(Jt(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Tt(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Le(n){vn(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(En(t),r!==t.version))return!0}return!1}function At(n){if(vn(n),Jt(n))for(let e=0;e<n.producerNode.length;e++)Tt(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function cn(n,e,t){if(fr(n),0===n.liveConsumerNode.length&&Kn(n))for(let r=0;r<n.producerNode.length;r++)n.producerIndexOfThis[r]=cn(n.producerNode[r],n,r);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function Tt(n,e){if(fr(n),1===n.liveConsumerNode.length&&Kn(n))for(let r=0;r<n.producerNode.length;r++)Tt(n.producerNode[r],n.producerIndexOfThis[r]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];vn(i),i.producerIndexOfThis[r]=e}}function Jt(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function vn(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function fr(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function Kn(n){return void 0!==n.producerNode}const ln=Symbol("UNSET"),Gn=Symbol("COMPUTING"),Os=Symbol("ERRORED"),Th={...nt,value:ln,dirty:!0,error:null,equal:Fe,kind:"computed",producerMustRecompute:n=>n.value===ln||n.value===Gn,producerRecomputeValue(n){if(n.value===Gn)throw new Error("Detected cycle in computations.");const e=n.value;n.value=Gn;const t=Ee(n);let r,i=!1;try{r=n.computation(),ee(null),i=e!==ln&&e!==Os&&r!==Os&&n.equal(e,r)}catch(s){r=Os,n.error=s}finally{Ce(n,t)}i?n.value=e:(n.value=r,n.version++)}};let Zg=function f0(){throw new Error};function Wn(n){Zg(n)}function Ps(n,e){hi()||Wn(n),n.equal(n.value,e)||(n.value=e,function Io(n){n.version++,function Pi(){ne++}(),Ir(n)}(n))}const qr={...nt,equal:Fe,value:void 0,kind:"signal"};function dt(n){return"function"==typeof n}function Zl(n){const t=n(r=>{Error.call(r),r.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Kl=Zl(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Sc(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Mt{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:r}=this;if(dt(r))try{r()}catch(s){e=s instanceof Kl?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{Jg(s)}catch(o){e=e??[],o instanceof Kl?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Kl(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Jg(e);else{if(e instanceof Mt){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Sc(t,e)}remove(e){const{_finalizers:t}=this;t&&Sc(t,e),e instanceof Mt&&e._removeParent(this)}}Mt.EMPTY=(()=>{const n=new Mt;return n.closed=!0,n})();const Ic=Mt.EMPTY;function Jl(n){return n instanceof Mt||n&&"closed"in n&&dt(n.remove)&&dt(n.add)&&dt(n.unsubscribe)}function Jg(n){dt(n)?n():n.unsubscribe()}const ns={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Ql={setTimeout(n,e,...t){const{delegate:r}=Ql;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=Ql;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Qg(n){Ql.setTimeout(()=>{const{onUnhandledError:e}=ns;if(!e)throw n;e(n)})}function eu(){}const tu=nu("C",void 0,void 0);function nu(n,e,t){return{kind:n,value:e,error:t}}let Ns=null;function ba(n){if(ns.useDeprecatedSynchronousErrorHandling){const e=!Ns;if(e&&(Ns={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:r}=Ns;if(Ns=null,t)throw r}}else n()}class Mh extends Mt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Jl(e)&&e.add(this)):this.destination=w0}static create(e,t,r){return new wa(e,t,r)}next(e){this.isStopped?Dh(function _0(n){return nu("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Dh(function m0(n){return nu("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Dh(tu,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const v0=Function.prototype.bind;function ru(n,e){return v0.call(n,e)}class b0{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){iu(r)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){iu(r)}else iu(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){iu(t)}}}class wa extends Mh{constructor(e,t,r){let i;if(super(),dt(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&ns.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&ru(e.next,s),error:e.error&&ru(e.error,s),complete:e.complete&&ru(e.complete,s)}):i=e}this.destination=new b0(i)}}function iu(n){ns.useDeprecatedSynchronousErrorHandling?function y0(n){ns.useDeprecatedSynchronousErrorHandling&&Ns&&(Ns.errorThrown=!0,Ns.error=n)}(n):Qg(n)}function Dh(n,e){const{onStoppedNotification:t}=ns;t&&Ql.setTimeout(()=>t(n,e))}const w0={closed:!0,next:eu,error:function su(n){throw n},complete:eu},ou="function"==typeof Symbol&&Symbol.observable||"@@observable";function Ni(n){return n}let Se=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){const s=function tm(n){return n&&n instanceof Mh||function em(n){return n&&dt(n.next)&&dt(n.error)&&dt(n.complete)}(n)&&Jl(n)}(t)?t:new wa(t,r,i);return ba(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return new(r=Oh(r))((i,s)=>{const o=new wa({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(t)}[ou](){return this}pipe(...t){return function Rh(n){return 0===n.length?Ni:1===n.length?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}(t)(this)}toPromise(t){return new(t=Oh(t))((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function Oh(n){var e;return null!==(e=n??ns.Promise)&&void 0!==e?e:Promise}const nm=Zl(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let fe=(()=>{class n extends Se{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const r=new ks(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new nm}next(t){ba(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(t)}})}error(t){ba(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){ba(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:r,isStopped:i,observers:s}=this;return r||i?Ic:(this.currentObservers=null,s.push(t),new Mt(()=>{this.currentObservers=null,Sc(s,t)}))}_checkFinalizedStatuses(t){const{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){const t=new Se;return t.source=this,t}}return n.create=(e,t)=>new ks(e,t),n})();class ks extends fe{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)}error(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:Ic}}class Qt extends fe{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}function Ea(n){return dt(n?.lift)}function bt(n){return e=>{if(Ea(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function _t(n,e,t,r,i){return new C0(n,e,t,r,i)}class C0 extends Mh{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function he(n,e){return bt((t,r)=>{let i=0;t.subscribe(_t(r,s=>{r.next(n.call(e,s,i++))}))})}const Mr="https://g.co/ng/security#xss";class V extends Error{code;constructor(e,t){super(function gr(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function ki(n){return{toString:n}.toString()}const $n="__parameters__";function Ls(n,e,t){return ki(()=>{const r=function Mc(n){return function(...t){if(n){const r=n(...t);for(const i in r)this[i]=r[i]}}}(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(c,l,u){const d=c.hasOwnProperty($n)?c[$n]:Object.defineProperty(c,$n,{value:[]})[$n];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}const at=globalThis;function ht(n){for(let e in n)if(n[e]===ht)return e;throw Error("Could not find renamed property on target object.")}function kh(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function un(n){if("string"==typeof n)return n;if(Array.isArray(n))return`[${n.map(un).join(", ")}]`;if(null==n)return""+n;const e=n.overriddenName||n.name;if(e)return`${e}`;const t=n.toString();if(null==t)return""+t;const r=t.indexOf("\n");return r>=0?t.slice(0,r):t}function Fh(n,e){return n?e?`${n} ${e}`:n:e||""}const C=ht({__forward_ref__:ht});function x(n){return n.__forward_ref__=x,n.toString=function(){return un(this())},n}function S(n){return O(n)?n():n}function O(n){return"function"==typeof n&&n.hasOwnProperty(C)&&n.__forward_ref__===x}function U(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function fi(n){return{providers:n.providers||[],imports:n.imports||[]}}function im(n){return fR(n,om)||fR(n,pR)}function fR(n,e){return n.hasOwnProperty(e)?n[e]:null}function sm(n){return n&&(n.hasOwnProperty(A0)||n.hasOwnProperty(L5))?n[A0]:null}const om=ht({\u0275prov:ht}),A0=ht({\u0275inj:ht}),pR=ht({ngInjectableDef:ht}),L5=ht({ngInjectorDef:ht});class P{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=U({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function S0(n){return n&&!!n.\u0275providers}const cu=ht({\u0275cmp:ht}),I0=ht({\u0275dir:ht}),M0=ht({\u0275pipe:ht}),Mo=ht({\u0275fac:ht}),Lh=ht({__NG_ELEMENT_ID__:ht}),_R=ht({__NG_ENV_ID__:ht});function Ne(n){return"string"==typeof n?n:null==n?"":String(n)}function D0(n,e){throw new V(-201,!1)}var Ke=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Ke||{});let R0;function yR(){return R0}function Kr(n){const e=R0;return R0=n,e}function vR(n,e,t){const r=im(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:t&Ke.Optional?null:void 0!==e?e:void D0()}const Bh={},O0="__NG_DI_FLAG__",lm="ngTempTokenPath",z5=/\n/gm,bR="__source";let lu;function Ta(n){const e=lu;return lu=n,e}function $5(n,e=Ke.Default){if(void 0===lu)throw new V(-203,!1);return null===lu?vR(n,void 0,e):lu.get(n,e&Ke.Optional?null:void 0,e)}function X(n,e=Ke.Default){return(yR()||$5)(S(n),e)}function A(n,e=Ke.Default){return X(n,um(e))}function um(n){return typeof n>"u"||"number"==typeof n?n:(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function P0(n){const e=[];for(let t=0;t<n.length;t++){const r=S(n[t]);if(Array.isArray(r)){if(0===r.length)throw new V(900,!1);let i,s=Ke.Default;for(let o=0;o<r.length;o++){const a=r[o],c=q5(a);"number"==typeof c?-1===c?i=a.token:s|=c:i=a}e.push(X(i,s))}else e.push(X(r))}return e}function Uh(n,e){return n[O0]=e,n.prototype[O0]=e,n}function q5(n){return n[O0]}const uu=Uh(Ls("Optional"),8),dm=Uh(Ls("SkipSelf"),4);function Dc(n,e){return n.hasOwnProperty(Mo)?n[Mo]:null}function du(n,e){n.forEach(t=>Array.isArray(t)?du(t,e):e(t))}function ER(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function hm(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function pi(n,e,t){let r=hu(n,e);return r>=0?n[1|r]=t:(r=~r,function CR(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(1===i)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;)n[i]=n[i-2],i--;n[e]=t,n[e+1]=r}}(n,r,e,t)),r}function k0(n,e){const t=hu(n,e);if(t>=0)return n[1|t]}function hu(n,e){return function AR(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){const s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}(n,e,1)}const as={},ft=[],Dr=new P(""),pm=new P("",-1),F0=new P("");class gm{get(e,t=Bh){if(t===Bh){const r=new Error(`NullInjectorError: No provider for ${un(e)}!`);throw r.name="NullInjectorError",r}return t}}function je(n){return n[cu]||null}function On(n){return n[I0]||null}function Jn(n){return n[M0]||null}function Bs(n){return{\u0275providers:n}}function TR(...n){return{\u0275providers:L0(0,n),\u0275fromNgModule:!0}}function L0(n,...e){const t=[],r=new Set;let i;const s=o=>{t.push(o)};return du(e,o=>{const a=o;mm(a,s,[],r)&&(i||=[],i.push(a))}),void 0!==i&&xR(i,s),t}function xR(n,e){for(let t=0;t<n.length;t++){const{ngModule:r,providers:i}=n[t];B0(i,s=>{e(s,r)})}}function mm(n,e,t,r){if(!(n=S(n)))return!1;let i=null,s=sm(n);const o=!s&&je(n);if(s||o){if(o&&!o.standalone)return!1;i=n}else{const c=n.ngModule;if(s=sm(c),!s)return!1;i=c}const a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){const c="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of c)mm(l,e,t,r)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;r.add(i);try{du(s.imports,u=>{mm(u,e,t,r)&&(l||=[],l.push(u))})}finally{}void 0!==l&&xR(l,e)}if(!a){const l=Dc(i)||(()=>new i);e({provide:i,useFactory:l,deps:ft},i),e({provide:F0,useValue:i,multi:!0},i),e({provide:Dr,useValue:()=>X(i),multi:!0},i)}const c=s.providers;if(null!=c&&!a){const l=n;B0(c,u=>{e(u,l)})}}}return i!==n&&void 0!==n.providers}function B0(n,e){for(let t of n)S0(t)&&(t=t.\u0275providers),Array.isArray(t)?B0(t,e):e(t)}const eW=ht({provide:String,useValue:ht});function U0(n){return null!==n&&"object"==typeof n&&eW in n}function Rc(n){return"function"==typeof n}const j0=new P(""),_m={},nW={};let V0;function ym(){return void 0===V0&&(V0=new gm),V0}class Qn{}class Oc extends Qn{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,z0(e,o=>this.processProvider(o)),this.records.set(pm,fu(void 0,this)),i.has("environment")&&this.records.set(Qn,fu(void 0,this));const s=this.records.get(j0);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(F0,ft,Ke.Self))}destroy(){jh(this),this._destroyed=!0;const e=ee(null);try{for(const r of this._ngOnDestroyHooks)r.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ee(e)}}onDestroy(e){return jh(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){jh(this);const t=Ta(this),r=Kr(void 0);try{return e()}finally{Ta(t),Kr(r)}}get(e,t=Bh,r=Ke.Default){if(jh(this),e.hasOwnProperty(_R))return e[_R](this);r=um(r);const s=Ta(this),o=Kr(void 0);try{if(!(r&Ke.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function aW(n){return"function"==typeof n||"object"==typeof n&&n instanceof P}(e)&&im(e);c=l&&this.injectableDefInScope(l)?fu(H0(e),_m):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(r&Ke.Self?ym():this.parent).get(e,t=r&Ke.Optional&&t===Bh?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[lm]=a[lm]||[]).unshift(un(e)),s)throw a;return function X5(n,e,t,r){const i=n[lm];throw e[bR]&&i.unshift(e[bR]),n.message=function Y5(n,e,t,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let i=un(e);if(Array.isArray(e))i=e.map(un).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):un(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(z5,"\n  ")}`}("\n"+n.message,i,t,r),n.ngTokenPath=i,n[lm]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{Kr(o),Ta(s)}}resolveInjectorInitializers(){const e=ee(null),t=Ta(this),r=Kr(void 0);try{const s=this.get(Dr,ft,Ke.Self);for(const o of s)o()}finally{Ta(t),Kr(r),ee(e)}}toString(){const e=[],t=this.records;for(const r of t.keys())e.push(un(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){let t=Rc(e=S(e))?e:S(e&&e.provide);const r=function iW(n){return U0(n)?fu(void 0,n.useValue):fu(MR(n),_m)}(e);if(!Rc(e)&&!0===e.multi){let i=this.records.get(t);i||(i=fu(void 0,_m,!0),i.factory=()=>P0(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){const r=ee(null);try{return t.value===_m&&(t.value=nW,t.value=t.factory()),"object"==typeof t.value&&t.value&&function oW(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{ee(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;const t=S(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function H0(n){const e=im(n),t=null!==e?e.factory:Dc(n);if(null!==t)return t;if(n instanceof P)throw new V(204,!1);if(n instanceof Function)return function rW(n){if(n.length>0)throw new V(204,!1);const t=function F5(n){return n&&(n[om]||n[pR])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new V(204,!1)}function MR(n,e,t){let r;if(Rc(n)){const i=S(n);return Dc(i)||H0(i)}if(U0(n))r=()=>S(n.useValue);else if(function IR(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...P0(n.deps||[]));else if(function SR(n){return!(!n||!n.useExisting)}(n))r=()=>X(S(n.useExisting));else{const i=S(n&&(n.useClass||n.provide));if(!function sW(n){return!!n.deps}(n))return Dc(i)||H0(i);r=()=>new i(...P0(n.deps))}return r}function jh(n){if(n.destroyed)throw new V(205,!1)}function fu(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function z0(n,e){for(const t of n)Array.isArray(t)?z0(t,e):t&&S0(t)?z0(t.\u0275providers,e):e(t)}function gi(n,e){n instanceof Oc&&jh(n);const r=Ta(n),i=Kr(void 0);try{return e()}finally{Ta(r),Kr(i)}}function DR(){return void 0!==yR()||null!=function W5(){return lu}()}function Pc(n){if(!DR())throw new V(-203,!1)}function an(n){return Array.isArray(n)&&"object"==typeof n[1]}function Nn(n){return Array.isArray(n)&&!0===n[1]}function $0(n){return!!(4&n.flags)}function ls(n){return n.componentOffset>-1}function Cm(n){return!(1&~n.flags)}function mi(n){return!!n.template}function Ro(n){return!!(512&n[2])}function Ia(n){return!(256&~n[2])}class vW{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}}function BR(n,e,t,r){null!==e?e.applyValueToInputSignal(e,r):n[t]=r}const us=(()=>{const n=()=>UR;return n.ngInherit=!0,n})();function UR(n){return n.type.prototype.ngOnChanges&&(n.setInput=wW),bW}function bW(){const n=VR(this),e=n?.current;if(e){const t=n.previous;if(t===as)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function wW(n,e,t,r,i){const s=this.declaredInputs[r],o=VR(n)||function EW(n,e){return n[jR]=e}(n,{previous:as,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new vW(l&&l.currentValue,t,c===as),BR(n,e,i,t)}const jR="__ngSimpleChanges__";function VR(n){return n[jR]||null}function it(n){for(;Array.isArray(n);)n=n[0];return n}function wu(n,e){return it(e[n])}function Or(n,e){return it(e[n.index])}function Lc(n,e){return n.data[e]}function Pr(n,e){const t=e[n];return an(t)?t:t[0]}function Y0(n){return!(128&~n[2])}function Fi(n,e){return null==e?null:n[e]}function GR(n){n[17]=0}function Z0(n){1024&n[2]||(n[2]|=1024,Y0(n)&&Eu(n))}function Tm(n){return!!(9216&n[2]||n[24]?.dirty)}function K0(n){n[10].changeDetectionScheduler?.notify(8),64&n[2]&&(n[2]|=1024),Tm(n)&&Eu(n)}function Eu(n){n[10].changeDetectionScheduler?.notify(0);let e=Oo(n);for(;null!==e&&!(8192&e[2])&&(e[2]|=8192,Y0(e));)e=Oo(e)}function xm(n,e){if(Ia(n))throw new V(911,!1);null===n[21]&&(n[21]=[]),n[21].push(e)}function Oo(n){const e=n[3];return Nn(e)?e[3]:e}function $R(n){return n[7]??=[]}function qR(n){return n.cleanup??=[]}const De={lFrame:n1(null),bindingsEnabled:!0,skipHydrationRootTNode:null};let ew=!1;function tw(){return De.bindingsEnabled}function Uc(){return null!==De.skipHydrationRootTNode}function N(){return De.lFrame.lView}function Me(){return De.lFrame.tView}function Ma(n){return De.lFrame.contextLView=n,n[8]}function Da(n){return De.lFrame.contextLView=null,n}function qe(){let n=XR();for(;null!==n&&64===n.type;)n=n.parent;return n}function XR(){return De.lFrame.currentTNode}function ds(n,e){const t=De.lFrame;t.currentTNode=n,t.isParent=e}function nw(){return De.lFrame.isParent}function rw(){De.lFrame.isParent=!1}function KR(){return ew}function Im(n){const e=ew;return ew=n,e}function Nr(){const n=De.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Li(){return De.lFrame.bindingIndex++}function No(n){const e=De.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function LW(n,e){const t=De.lFrame;t.bindingIndex=t.bindingRootIndex=n,iw(e)}function iw(n){De.lFrame.currentDirectiveIndex=n}function ow(){return De.lFrame.currentQueryIndex}function Mm(n){De.lFrame.currentQueryIndex=n}function UW(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[5]:null}function e1(n,e,t){if(t&Ke.SkipSelf){let i=e,s=n;for(;!(i=i.parent,null!==i||t&Ke.Host||(i=UW(s),null===i||(s=s[14],10&i.type))););if(null===i)return!1;e=i,n=s}const r=De.lFrame=t1();return r.currentTNode=e,r.lView=n,!0}function aw(n){const e=t1(),t=n[1];De.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function t1(){const n=De.lFrame,e=null===n?null:n.child;return null===e?n1(n):e}function n1(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function r1(){const n=De.lFrame;return De.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const s1=r1;function cw(){const n=r1();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function er(){return De.lFrame.selectedIndex}function jc(n){De.lFrame.selectedIndex=n}function Dt(){const n=De.lFrame;return Lc(n.tView,n.selectedIndex)}function lw(){De.lFrame.currentNamespace="svg"}let a1=!0;function zh(){return a1}function Vs(n){a1=n}function uw(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),null!=u&&(n.destroyHooks??=[]).push(t,u)}}function Dm(n,e,t){c1(n,e,3,t)}function Rm(n,e,t,r){(3&n[2])===t&&c1(n,e,t,r)}function dw(n,e){let t=n[2];(3&t)===e&&(t&=16383,t+=1,n[2]=t)}function c1(n,e,t,r){const s=r??-1,o=e.length-1;let a=0;for(let c=void 0!==r?65535&n[17]:0;c<o;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=r&&a>=r)break}else e[c]<0&&(n[17]+=65536),(a<s||-1==s)&&(WW(n,t,e,c),n[17]=(4294901760&n[17])+c+2),c++}function l1(n,e){const t=ee(null);try{e.call(n)}finally{ee(t)}}function WW(n,e,t,r){const i=t[r]<0,s=t[r+1],a=n[i?-t[r]:t[r]];i?n[2]>>14<n[17]>>16&&(3&n[2])===e&&(n[2]+=16384,l1(a,s)):l1(a,s)}class Gh{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r){this.factory=e,this.canSeeViewProviders=t,this.injectImpl=r}}function u1(n){return 3===n||4===n||6===n}function d1(n){return 64===n.charCodeAt(0)}function Au(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?t=i:0===t||h1(n,t,i,null,-1===t||2===t?e[++r]:null)}}return n}function h1(n,e,t,r,i){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===r)return void(null!==i&&(n[s+1]=i));if(r===n[s+1])return void(n[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==r&&n.splice(s++,0,r),null!==i&&n.splice(s++,0,i)}const pw={};class Vc{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=um(r);const i=this.injector.get(e,pw,r);return i!==pw||t===pw?i:this.parentInjector.get(e,t,r)}}function gw(n){return-1!==n}function Wh(n){return 32767&n}function $h(n,e){let t=function KW(n){return n>>16}(n),r=e;for(;t>0;)r=r[14],t--;return r}let mw=!0;function Om(n){const e=mw;return mw=n,e}let QW=0;const Hs={};function Pm(n,e){const t=g1(n,e);if(-1!==t)return t;const r=e[1];r.firstCreatePass&&(n.injectorIndex=e.length,_w(r.data,n),_w(e,null),_w(r.blueprint,null));const i=Nm(n,e),s=n.injectorIndex;if(gw(i)){const o=Wh(i),a=$h(i,e),c=a[1].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function _w(n,e){n.push(0,0,0,0,0,0,0,0,e)}function g1(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Nm(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;null!==i;){if(r=E1(i),null===r)return-1;if(t++,i=i[14],-1!==r.injectorIndex)return r.injectorIndex|t<<16}return-1}function yw(n,e,t){!function e$(n,e,t){let r;"string"==typeof t?r=t.charCodeAt(0)||0:t.hasOwnProperty(Lh)&&(r=t[Lh]),null==r&&(r=t[Lh]=QW++);const i=255&r;e.data[n+(i>>5)]|=1<<i}(n,e,t)}function m1(n,e,t){if(t&Ke.Optional||void 0!==n)return n;D0()}function _1(n,e,t,r){if(t&Ke.Optional&&void 0===r&&(r=null),!(t&(Ke.Self|Ke.Host))){const i=n[9],s=Kr(void 0);try{return i?i.get(e,r,t&Ke.Optional):vR(e,r,t&Ke.Optional)}finally{Kr(s)}}return m1(r,0,t)}function y1(n,e,t,r=Ke.Default,i){if(null!==n){if(2048&e[2]&&!(r&Ke.Self)){const o=function s$(n,e,t,r,i){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[2]&&!Ro(o);){const a=v1(s,o,t,r|Ke.Self,Hs);if(a!==Hs)return a;let c=s.parent;if(!c){const l=o[20];if(l){const u=l.get(t,Hs,r);if(u!==Hs)return u}c=E1(o),o=o[14]}s=c}return i}(n,e,t,r,Hs);if(o!==Hs)return o}const s=v1(n,e,t,r,Hs);if(s!==Hs)return s}return _1(e,t,r,i)}function v1(n,e,t,r,i){const s=function r$(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Lh)?n[Lh]:void 0;return"number"==typeof e?e>=0?255&e:i$:e}(t);if("function"==typeof s){if(!e1(e,n,r))return r&Ke.Host?m1(i,0,r):_1(e,t,r,i);try{let o;if(o=s(r),null!=o||r&Ke.Optional)return o;D0()}finally{s1()}}else if("number"==typeof s){let o=null,a=g1(n,e),c=-1,l=r&Ke.Host?e[15][5]:null;for((-1===a||r&Ke.SkipSelf)&&(c=-1===a?Nm(n,e):e[a+8],-1!==c&&w1(r,!1)?(o=e[1],a=Wh(c),e=$h(c,e)):a=-1);-1!==a;){const u=e[1];if(b1(s,a,u.data)){const d=n$(a,e,t,o,r,l);if(d!==Hs)return d}c=e[a+8],-1!==c&&w1(r,e[1].data[a+8]===l)&&b1(s,a,e)?(o=u,a=Wh(c),e=$h(c,e)):a=-1}}return i}function n$(n,e,t,r,i,s){const o=e[1],a=o.data[n+8],u=km(a,o,t,null==r?ls(a)&&mw:r!=o&&!!(3&a.type),i&Ke.Host&&s===a);return null!==u?qh(e,o,u,a):Hs}function km(n,e,t,r,i){const s=n.providerIndexes,o=e.data,a=1048575&s,c=n.directiveStart,u=s>>20,h=i?a+u:n.directiveEnd;for(let f=r?a:a+u;f<h;f++){const p=o[f];if(f<c&&t===p||f>=c&&p.type===t)return f}if(i){const f=o[c];if(f&&mi(f)&&f.type===t)return c}return null}function qh(n,e,t,r){let i=n[t];const s=e.data;if(function $W(n){return n instanceof Gh}(i)){const o=i;o.resolving&&function j5(n){throw new V(-200,n)}(function yt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Ne(n)}(s[t]));const a=Om(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Kr(o.injectImpl):null;e1(n,r,Ke.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&function GW(n,e,t){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const o=UR(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==l&&Kr(l),Om(a),o.resolving=!1,s1()}}return i}function b1(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function w1(n,e){return!(n&Ke.Self||n&Ke.Host&&e)}class hn{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return y1(this._tNode,this._lView,e,um(r),t)}}function i$(){return new hn(qe(),N())}function Bi(n){return ki(()=>{const e=n.prototype.constructor,t=e[Mo]||vw(e),r=Object.prototype;let i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){const s=i[Mo]||vw(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function vw(n){return O(n)?()=>{const e=vw(S(n));return e&&e()}:Dc(n)}function E1(n){const e=n[1],t=e.type;return 2===t?e.declTNode:1===t?n[5]:null}function S1(n,e=null,t=null,r){const i=function I1(n,e=null,t=null,r,i=new Set){const s=[t||ft,TR(n)];return r=r||("object"==typeof n?void 0:un(n)),new Oc(s,e||ym(),r||null,i)}(n,e,t,r);return i.resolveInjectorInitializers(),i}class pt{static THROW_IF_NOT_FOUND=Bh;static NULL=new gm;static create(e,t){if(Array.isArray(e))return S1({name:""},t,e,"");{const r=e.name??"";return S1({name:r},e.parent,e.providers,r)}}static \u0275prov=U({token:pt,providedIn:"any",factory:()=>X(pm)});static __NG_ELEMENT_ID__=-1}class M1{attributeName;constructor(e){this.attributeName=e}__NG_ELEMENT_ID__=()=>function Xh(n){return function t$(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const r=t.length;let i=0;for(;i<r;){const s=t[i];if(u1(s))break;if(0===s)i+=2;else if("number"==typeof s)for(i++;i<r&&"string"==typeof t[i];)i++;else{if(s===e)return t[i+1];i+=2}}}return null}(qe(),n)}(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}}new P("").__NG_ELEMENT_ID__=n=>{const e=qe();if(null===e)throw new V(204,!1);if(2&e.type)return e.value;if(n&Ke.Optional)return null;throw new V(204,!1)};const D1=!1;let hs=(()=>class n{static __NG_ELEMENT_ID__=p$;static __NG_ENV_ID__=t=>t})();class R1 extends hs{_lView;constructor(e){super(),this._lView=e}onDestroy(e){return xm(this._lView,e),()=>function J0(n,e){if(null===n[21])return;const t=n[21].indexOf(e);-1!==t&&n[21].splice(t,1)}(this._lView,e)}}function p$(){return new R1(N())}class zs{}const Yh=new P("",{providedIn:"root",factory:()=>!1}),O1=new P(""),ww=new P("");let Gs=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new Qt(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=U({token:n,providedIn:"root",factory:()=>new n})}return n})();const ze=class m$ extends fe{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,DR()&&(this.destroyRef=A(hs,{optional:!0})??void 0,this.pendingTasks=A(Gs,{optional:!0})??void 0)}emit(e){const t=ee(null);try{super.next(e)}finally{ee(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&"object"==typeof e){const c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),i&&(i=this.wrapInTimeout(i)),o&&(o=this.wrapInTimeout(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof Mt&&e.add(a),a}wrapInTimeout(e){return t=>{const r=this.pendingTasks?.add();setTimeout(()=>{e(t),void 0!==r&&this.pendingTasks?.remove(r)})}}};function Zh(...n){}function P1(n){let e,t;function r(){n=Zh;try{void 0!==t&&"function"==typeof cancelAnimationFrame&&cancelAnimationFrame(t),void 0!==e&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),"function"==typeof requestAnimationFrame&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function N1(n){return queueMicrotask(()=>n()),()=>{n=Zh}}const Ew="isAngularZone",Lm=Ew+"_ID";let _$=0;class ye{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new ze(!1);onMicrotaskEmpty=new ze(!1);onStable=new ze(!1);onError=new ze(!1);constructor(e){const{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:s=D1}=e;if(typeof Zone>"u")throw new V(908,!1);Zone.assertZonePatched();const o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!i&&r,o.shouldCoalesceRunChangeDetection=i,o.callbackScheduled=!1,o.scheduleInRootZone=s,function b$(n){const e=()=>{!function v$(n){function e(){P1(()=>{n.callbackScheduled=!1,Aw(n),n.isCheckStableRunning=!0,Cw(n),n.isCheckStableRunning=!1})}n.isCheckStableRunning||n.callbackScheduled||(n.callbackScheduled=!0,n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Aw(n))}(n)},t=_$++;n._inner=n._inner.fork({name:"angular",properties:{[Ew]:!0,[Lm]:t,[Lm+t]:!0},onInvokeTask:(r,i,s,o,a,c)=>{if(function w$(n){return L1(n,"__ignore_ng_zone__")}(c))return r.invokeTask(s,o,a,c);try{return k1(n),r.invokeTask(s,o,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||n.shouldCoalesceRunChangeDetection)&&e(),F1(n)}},onInvoke:(r,i,s,o,a,c,l)=>{try{return k1(n),r.invoke(s,o,a,c,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!function E$(n){return L1(n,"__scheduler_tick__")}(c)&&e(),F1(n)}},onHasTask:(r,i,s,o)=>{r.hasTask(s,o),i===s&&("microTask"==o.change?(n._hasPendingMicrotasks=o.microTask,Aw(n),Cw(n)):"macroTask"==o.change&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(r,i,s,o)=>(r.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}(o)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get(Ew)}static assertInAngularZone(){if(!ye.isInAngularZone())throw new V(909,!1)}static assertNotInAngularZone(){if(ye.isInAngularZone())throw new V(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,y$,Zh,Zh);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}}const y$={};function Cw(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Aw(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&!0===n.callbackScheduled)}function k1(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function F1(n){n._nesting--,Cw(n)}class Tw{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new ze;onMicrotaskEmpty=new ze;onStable=new ze;onError=new ze;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}}function L1(n,e){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0]?.data?.[e]}class ei{_console=console;handleError(e){this._console.error("ERROR",e)}}const A$=new P("",{providedIn:"root",factory:()=>{const n=A(ye),e=A(ei);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function I$(){return Tu(qe(),N())}function Tu(n,e){return new fn(Or(n,e))}let fn=(()=>class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=I$})();function j1(n){return n instanceof fn?n.nativeElement:n}function Oa(n,e){const t=function pr(n){const e=Object.create(qr);e.value=n;const t=()=>(sn(e),e.value);return t[be]=e,t}(n),r=t[be];return e?.equal&&(r.equal=e.equal),t.set=i=>Ps(r,i),t.update=i=>function va(n,e){hi()||Wn(n),Ps(n,e(n.value))}(r,i),t.asReadonly=Bm.bind(t),t}function Bm(){const n=this[be];if(void 0===n.readonlyFn){const e=()=>this();e[be]=n,n.readonlyFn=e}return n.readonlyFn}function M$(){return this._results[Symbol.iterator]()}class H1{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new fe}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;const r=function Jr(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function Q5(n,e,t){if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++){let i=n[r],s=e[r];if(t&&(i=t(i),s=t(s)),s!==i)return!1}return!0}(this._results,r,t))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=M$}function Jh(n){return!(128&~n.flags)}var Um=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(Um||{});const jm=new Map;let R$=0;function Iw(n){jm.delete(n[19])}const Vm="__ngContext__";function ti(n,e){an(e)?(n[Vm]=e[19],function P$(n){jm.set(n[19],n)}(e)):n[Vm]=e}function K1(n){return Q1(n[12])}function J1(n){return Q1(n[4])}function Q1(n){for(;null!==n&&!Nn(n);)n=n[4];return n}let Rw;const Pa=new P("",{providedIn:"root",factory:()=>J$}),J$="ng",Ow=new P(""),ko=new P("",{providedIn:"platform",factory:()=>"unknown"}),Pw=new P(""),Nw=new P("",{providedIn:"root",factory:()=>function Ws(){if(void 0!==Rw)return Rw;if(typeof document<"u")return document;throw new V(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null}),uO=new P("",{providedIn:"root",factory:()=>!1});var Ww=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(Ww||{});const Iu=new P(""),pO=new Set;function _i(n){pO.has(n)||(pO.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}let qm=(()=>class n{view;node;constructor(t,r){this.view=t,this.node=r}static __NG_ELEMENT_ID__=rq})();function rq(){return new qm(N(),qe())}var Mu=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(Mu||{});let $w=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=U({token:n,providedIn:"root",factory:()=>new n})}return n})();const gO=[Mu.EarlyRead,Mu.Write,Mu.MixedReadWrite,Mu.Read];let mO=(()=>{class n{ngZone=A(ye);scheduler=A(zs);errorHandler=A(ei,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){A(Iu,{optional:!0})}execute(){this.executing=!0;for(const r of gO)for(const i of this.sequences)if(!i.erroredOrDestroyed&&i.hooks[r])try{i.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>(0,i.hooks[r])(i.pipelinedValue),i.snapshot))}catch(s){i.erroredOrDestroyed=!0,this.errorHandler?.handleError(s)}this.executing=!1;for(const r of this.sequences)r.afterRun(),r.once&&(this.sequences.delete(r),r.destroy());for(const r of this.deferredRegistrations)this.sequences.add(r);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(t){const{view:r}=t;void 0!==r?((r[25]??=[]).push(t),Eu(r),r[2]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,r){return r?r.run(Ww.AFTER_NEXT_RENDER,t):t()}static \u0275prov=U({token:n,providedIn:"root",factory:()=>new n})}return n})();class _O{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,r,i,s,o=null){this.impl=e,this.hooks=t,this.view=r,this.once=i,this.snapshot=o,this.unregisterOnDestroy=s?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();const e=this.view?.[25];e&&(this.view[25]=e.filter(t=>t!==this))}}function nf(n,e){!e?.injector&&Pc();const t=e?.injector??A(pt);return _i("NgAfterNextRender"),yO(n,t,e,!0)}function yO(n,e,t,r){const i=e.get($w);i.impl??=e.get(mO);const s=e.get(Iu,null,{optional:!0}),o=t?.phase??Mu.MixedReadWrite,a=!0!==t?.manualCleanup?e.get(hs):null,c=e.get(qm,null,{optional:!0}),l=new _O(i.impl,function iq(n,e){if(n instanceof Function){const t=[void 0,void 0,void 0,void 0];return t[e]=n,t}return[n.earlyRead,n.write,n.mixedReadWrite,n.read]}(n,o),c?.view,r,a,s?.snapshot(null));return i.impl.register(l),l}function VO(n,e){const t=n.contentQueries;if(null!==t){const r=ee(null);try{for(let i=0;i<t.length;i+=2){const o=t[i+1];if(-1!==o){const a=n.data[o];Mm(t[i]),a.contentQueries(2,e[o],o)}}}finally{ee(r)}}}function sE(n,e,t){Mm(0);const r=ee(null);try{e(n,t)}finally{ee(r)}}function oE(n,e,t){if($0(e)){const r=ee(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{ee(r)}}}var Ui=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Ui||{});let n_;function Lu(n){return function aE(){if(void 0===n_&&(n_=null,at.trustedTypes))try{n_=at.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return n_}()?.createHTML(n)||n}class Wc{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Mr})`}}class jq extends Wc{getTypeName(){return"HTML"}}class Vq extends Wc{getTypeName(){return"Style"}}class Hq extends Wc{getTypeName(){return"Script"}}class zq extends Wc{getTypeName(){return"URL"}}class Gq extends Wc{getTypeName(){return"ResourceURL"}}function yi(n){return n instanceof Wc?n.changingThisBreaksApplicationSecurity:n}function $s(n,e){const t=function Wq(n){return n instanceof Wc&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Mr})`)}return t===e}class Kq{inertDocumentHelper;constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(Lu(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.firstChild?.remove(),t)}catch{return null}}}class Jq{defaultDoc;inertDocument;constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=Lu(e),t}}const eX=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function i_(n){return(n=String(n)).match(eX)?n:"unsafe:"+n}function Lo(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function ff(...n){const e={};for(const t of n)for(const r in t)t.hasOwnProperty(r)&&(e[r]=!0);return e}const $O=Lo("area,br,col,hr,img,wbr"),qO=Lo("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),XO=Lo("rp,rt"),lE=ff($O,ff(qO,Lo("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ff(XO,Lo("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ff(XO,qO)),uE=Lo("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),YO=ff(uE,Lo("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Lo("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),tX=Lo("script,style,template");class nX{sanitizedSomething=!1;buf=[];sanitizeChildren(e){let t=e.firstChild,r=!0,i=[];for(;t;)if(t.nodeType===Node.ELEMENT_NODE?r=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,r&&t.firstChild)i.push(t),t=sX(t);else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let s=iX(t);if(s){t=s;break}t=i.pop()}return this.buf.join("")}startElement(e){const t=ZO(e).toLowerCase();if(!lE.hasOwnProperty(t))return this.sanitizedSomething=!0,!tX.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const r=e.attributes;for(let i=0;i<r.length;i++){const s=r.item(i),o=s.name,a=o.toLowerCase();if(!YO.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=s.value;uE[a]&&(c=i_(c)),this.buf.push(" ",o,'="',JO(c),'"')}return this.buf.push(">"),!0}endElement(e){const t=ZO(e).toLowerCase();lE.hasOwnProperty(t)&&!$O.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(JO(e))}}function iX(n){const e=n.nextSibling;if(e&&n!==e.previousSibling)throw KO(e);return e}function sX(n){const e=n.firstChild;if(e&&function rX(n,e){return(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}(n,e))throw KO(e);return e}function ZO(n){const e=n.nodeName;return"string"==typeof e?e:"FORM"}function KO(n){return new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`)}const oX=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,aX=/([^\#-~ |!])/g;function JO(n){return n.replace(/&/g,"&amp;").replace(oX,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(aX,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let s_;function QO(n,e){let t=null;try{s_=s_||function WO(n){const e=new Jq(n);return function Qq(){try{return!!(new window.DOMParser).parseFromString(Lu(""),"text/html")}catch{return!1}}()?new Kq(e):e}(n);let r=e?String(e):"";t=s_.getInertBodyElement(r);let i=5,s=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=s,s=t.innerHTML,t=s_.getInertBodyElement(r)}while(r!==s);return Lu((new nX).sanitizeChildren(dE(t)||t))}finally{if(t){const r=dE(t)||t;for(;r.firstChild;)r.firstChild.remove()}}}function dE(n){return"content"in n&&function cX(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var tr=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(tr||{});function hE(n){const e=function pf(){const n=N();return n&&n[10].sanitizer}();return e?e.sanitize(tr.URL,n)||"":$s(n,"URL")?yi(n):i_(Ne(n))}function IX(n,e,t){let r=n.length;for(;;){const i=n.indexOf(e,t);if(-1===i)return i;if(0===i||n.charCodeAt(i-1)<=32){const s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}const uP="ng-template";function MX(n,e,t,r){let i=0;if(r){for(;i<e.length&&"string"==typeof e[i];i+=2)if("class"===e[i]&&-1!==IX(e[i+1].toLowerCase(),t,0))return!0}else if(gE(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&"string"==typeof(s=e[i]);)if(s.toLowerCase()===t)return!0}return!1}function gE(n){return 4===n.type&&n.value!==uP}function DX(n,e,t){return e===(4!==n.type||t?n.value:uP)}function RX(n,e,t){let r=4;const i=n.attrs,s=null!==i?function NX(n){for(let e=0;e<n.length;e++)if(u1(n[e]))return e;return n.length}(i):0;let o=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!o)if(4&r){if(r=2|1&r,""!==c&&!DX(n,c,t)||""===c&&1===e.length){if(fs(r))return!1;o=!0}}else if(8&r){if(null===i||!MX(n,i,c,t)){if(fs(r))return!1;o=!0}}else{const l=e[++a],u=OX(c,i,gE(n),t);if(-1===u){if(fs(r))return!1;o=!0;continue}if(""!==l){let d;if(d=u>s?"":i[u+1].toLowerCase(),2&r&&l!==d){if(fs(r))return!1;o=!0}}}}else{if(!o&&!fs(r)&&!fs(c))return!1;if(o&&fs(c))continue;o=!1,r=c|1&r}}return fs(r)||o}function fs(n){return!(1&n)}function OX(n,e,t,r){if(null===e)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){const o=e[i];if(o===n)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function kX(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const r=n[t];if("number"==typeof r)return-1;if(r===e)return t;t++}return-1}(e,n)}function dP(n,e,t=!1){for(let r=0;r<e.length;r++)if(RX(n,e[r],t))return!0;return!1}function FX(n,e){e:for(let t=0;t<e.length;t++){const r=e[t];if(n.length===r.length){for(let i=0;i<n.length;i++)if(n[i]!==r[i])continue e;return!0}}return!1}function hP(n,e){return n?":not("+e.trim()+")":e}function LX(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&r){const a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!fs(o)&&(e+=hP(s,i),i=""),r=o,s=s||!fs(r);t++}return""!==i&&(e+=hP(s,i)),e}const ke={};function c_(n,e,t){return n.createElement(e,t)}function $c(n,e,t,r,i){n.insertBefore(e,t,r,i)}function pP(n,e,t){n.appendChild(e,t)}function gP(n,e,t,r,i){null!==r?$c(n,e,t,r,i):pP(n,e,t)}function _P(n,e,t){const{mergedAttrs:r,classes:i,styles:s}=t;null!==r&&function ZW(n,e,t){let r=0;for(;r<t.length;){const i=t[r];if("number"==typeof i){if(0!==i)break;r++;const s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{const s=i,o=t[++r];d1(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}}(n,e,r),null!==i&&function VX(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}(n,e,i),null!==s&&function jX(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}function yE(n,e,t,r,i,s,o,a,c,l,u){const d=26+r,h=d+i,f=function HX(n,e){const t=[];for(let r=0;r<e;r++)t.push(r<n?null:ke);return t}(d,h),p="function"==typeof l?l():l;return f[1]={type:n,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}function l_(n,e,t,r,i,s,o,a,c,l,u){const d=e.blueprint.slice();return d[0]=i,d[2]=1228|r,(null!==l||n&&2048&n[2])&&(d[2]|=2048),GR(d),d[3]=d[14]=n,d[8]=t,d[10]=o||n&&n[10],d[11]=a||n&&n[11],d[9]=c||n&&n[9]||null,d[5]=s,d[19]=function O$(){return R$++}(),d[6]=u,d[20]=l,d[15]=2==e.type?n[15]:d,d}function vE(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function mf(n,e,t,r){if(0===t)return-1;const i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function bE(n,e){return n[12]?n[13][4]=e:n[12]=e,n[13]=e,e}function Yn(n=1){vP(Me(),N(),er()+n,!1)}function vP(n,e,t,r){if(!r)if(3&~e[2]){const s=n.preOrderHooks;null!==s&&Rm(e,s,0,t)}else{const s=n.preOrderCheckHooks;null!==s&&Dm(e,s,t)}jc(t)}var u_=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(u_||{});function _f(n,e,t,r){const i=ee(null);try{const[s,o,a]=n.inputs[t];let c=null;!!(o&u_.SignalBased)&&(c=e[s][be]),null!==c&&void 0!==c.transformFn?r=c.transformFn(r):null!==a&&(r=a.call(e,r)),null!==n.setInput?n.setInput(e,c,r,t,s):BR(e,c,s,r)}finally{ee(i)}}function bP(n,e,t,r,i){const s=er(),o=2&r;try{jc(-1),o&&e.length>26&&vP(n,e,26,!1),t(r,i)}finally{jc(s)}}function d_(n,e,t){(function ZX(n,e,t){const r=t.directiveStart,i=t.directiveEnd;ls(t)&&function zX(n,e,t){const r=Or(e,n),i=function yP(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=yE(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}(t),s=n[10].rendererFactory,o=bE(n,l_(n,i,null,vE(t),r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=o}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Pm(t,e);const s=t.initialInputs;for(let o=r;o<i;o++){const a=n.data[o],c=qh(e,n,o,t);ti(c,e),null!==s&&QX(0,o-r,c,a,0,s),mi(a)&&(Pr(t.index,e)[8]=qh(e,n,o,t))}})(n,e,t),!(64&~t.flags)&&function KX(n,e,t){const r=t.directiveStart,i=t.directiveEnd,s=t.index,o=function BW(){return De.lFrame.currentDirectiveIndex}();try{jc(s);for(let a=r;a<i;a++){const c=n.data[a],l=e[a];iw(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&JX(c,l)}}finally{jc(-1),iw(o)}}(n,e,t)}function wE(n,e,t=Or){const r=e.localNames;if(null!==r){let i=e.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?t(e,n):n[o];n[i++]=a}}}let wP=()=>null;function ni(n,e,t,r,i,s,o,a){if(a||!AE(e,n,t,r,i)){if(3&e.type){const c=Or(e,t);r=function XX(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),i=null!=o?o(i,e.value||"",r):i,s.setProperty(c,r,i)}}else ls(e)&&function YX(n,e){const t=Pr(e,n);16&t[2]||(t[2]|=64)}(t,e.index)}function JX(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function EE(n,e){const t=n.directiveRegistry;let r=null;if(t)for(let i=0;i<t.length;i++){const s=t[i];dP(e,s.selectors,!1)&&(r??=[],mi(s)?r.unshift(s):r.push(s))}return r}function qs(n,e,t,r,i,s){const o=Or(n,e);!function CE(n,e,t,r,i,s,o){if(null==s)n.removeAttribute(e,i,t);else{const a=null==o?Ne(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}(e[11],o,s,n.value,t,r,i)}function QX(n,e,t,r,i,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;a+=2)_f(r,t,o[a],o[a+1])}function h_(n,e){const t=n[9],r=t?t.get(ei,null):null;r&&r.handleError(e)}function AE(n,e,t,r,i){const s=n.inputs?.[r],o=n.hostDirectiveInputs?.[r];let a=!1;if(o)for(let c=0;c<o.length;c+=2){const l=o[c];_f(e.data[l],t[l],o[c+1],i),a=!0}if(s)for(const c of s)_f(e.data[c],t[c],r,i),a=!0;return a}function eY(n,e){const t=Pr(e,n),r=t[1];!function tY(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(r,t);const i=t[0];null!==i&&null===t[6]&&(t[6]=null),f_(r,t,t[8])}function f_(n,e,t){aw(e);try{const r=n.viewQuery;null!==r&&sE(1,r,t);const i=n.template;null!==i&&bP(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[18]?.finishViewCreation(n),n.staticContentQueries&&VO(n,e),n.staticViewQueries&&sE(2,n.viewQuery,t);const s=n.components;null!==s&&function nY(n,e){for(let t=0;t<e.length;t++)eY(n,e[t])}(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[2]&=-5,cw()}}function Uu(n,e,t,r){const i=ee(null);try{const s=e.tView,c=l_(n,s,t,4096&n[2]?4096:16,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null);c[16]=n[e.index];const u=n[18];return null!==u&&(c[18]=u.createEmbeddedView(s)),f_(s,c,t),c}finally{ee(i)}}function qc(n,e){return!e||null===e.firstChild||Jh(n)}function xE(n,e){return undefined(n,e)}var Fa=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Fa||{});function La(n){return!(32&~n.flags)}function ju(n,e,t,r,i){if(null!=r){let s,o=!1;Nn(r)?s=r:an(r)&&(o=!0,r=r[0]);const a=it(r);0===n&&null!==t?null==i?pP(e,t,a):$c(e,t,a,i||null,!0):1===n&&null!==t?$c(e,t,a,i||null,!0):2===n?function gf(n,e,t){n.removeChild(null,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function lY(n,e,t,r,i){const s=t[7];s!==it(t)&&ju(e,n,r,s,i);for(let a=10;a<t.length;a++){const c=t[a];g_(c[1],c,n,e,r,s)}}(e,n,s,t,i)}}function TP(n,e){e[10].changeDetectionScheduler?.notify(9),g_(n,e,e[11],2,null,null)}function SE(n,e){const t=n[9],r=t.indexOf(e);t.splice(r,1)}function yf(n,e){if(Ia(e))return;const t=e[11];t.destroyNode&&g_(n,e,t,3,null,null),function sY(n){let e=n[12];if(!e)return IE(n[1],n);for(;e;){let t=null;if(an(e))t=e[12];else{const r=e[10];r&&(t=r)}if(!t){for(;e&&!e[4]&&e!==n;)an(e)&&IE(e[1],e),e=e[3];null===e&&(e=n),an(e)&&IE(e[1],e),t=e&&e[4]}e=t}}(e)}function IE(n,e){if(Ia(e))return;const t=ee(null);try{e[2]&=-129,e[2]|=256,e[24]&&At(e[24]),function aY(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let r=0;r<t.length;r+=2){const i=e[t[r]];if(!(i instanceof Gh)){const s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],c=s[o+1];try{c.call(a)}finally{}}else try{s.call(i)}finally{}}}}(n,e),function oY(n,e){const t=n.cleanup,r=e[7];if(null!==t)for(let o=0;o<t.length-1;o+=2)if("string"==typeof t[o]){const a=t[o+3];a>=0?r[a]():r[-a].unsubscribe(),o+=2}else t[o].call(r[t[o+1]]);null!==r&&(e[7]=null);const i=e[21];if(null!==i){e[21]=null;for(let o=0;o<i.length;o++)(0,i[o])()}const s=e[23];if(null!==s){e[23]=null;for(const o of s)o.destroy()}}(n,e),1===e[1].type&&e[11].destroy();const r=e[16];if(null!==r&&Nn(e[3])){r!==e[3]&&SE(r,e);const i=e[18];null!==i&&i.detachView(n)}Iw(e)}finally{ee(t)}}function ME(n,e,t){return function xP(n,e,t){let r=e;for(;null!==r&&168&r.type;)r=(e=r).parent;if(null===r)return t[0];if(ls(r)){const{encapsulation:i}=n.data[r.directiveStart+r.componentOffset];if(i===Ui.None||i===Ui.Emulated)return null}return Or(r,t)}(n,e.parent,t)}function SP(n,e,t){return MP(n,e,t)}let MP=function IP(n,e,t){return 40&n.type?Or(n,t):null};function p_(n,e,t,r){const i=ME(n,r,e),s=e[11],a=SP(r.parent||e[5],r,e);if(null!=i)if(Array.isArray(t))for(let c=0;c<t.length;c++)gP(s,i,t[c],a,!1);else gP(s,i,t,a,!1)}function Xc(n,e){if(null!==e){const t=e.type;if(3&t)return Or(e,n);if(4&t)return RE(-1,n[e.index]);if(8&t){const r=e.child;if(null!==r)return Xc(n,r);{const i=n[e.index];return Nn(i)?RE(-1,i):it(i)}}if(128&t)return Xc(n,e.next);if(32&t)return xE(e,n)()||it(n[e.index]);{const r=RP(n,e);return null!==r?Array.isArray(r)?r[0]:Xc(Oo(n[15]),r):Xc(n,e.next)}}return null}function RP(n,e){return null!==e?n[15][5].projection[e.projection]:null}function RE(n,e){const t=10+n+1;if(t<e.length){const r=e[t],i=r[1].firstChild;if(null!==i)return Xc(r,i)}return e[7]}function OE(n,e,t,r,i,s,o){for(;null!=t;){if(128===t.type){t=t.next;continue}const a=r[t.index],c=t.type;if(o&&0===e&&(a&&ti(it(a),r),t.flags|=2),!La(t))if(8&c)OE(n,e,t.child,r,i,s,!1),ju(e,n,i,a,s);else if(32&c){const l=xE(t,r);let u;for(;u=l();)ju(e,n,i,u,s);ju(e,n,i,a,s)}else 16&c?OP(n,e,r,t,i,s):ju(e,n,i,a,s);t=o?t.projectionNext:t.next}}function g_(n,e,t,r,i,s){OE(t,r,n.firstChild,e,i,s,!1)}function OP(n,e,t,r,i,s){const o=t[15],c=o[5].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)ju(e,n,i,c[l],s);else{let l=c;const u=o[3];Jh(r)&&(l.flags|=128),OE(n,e,l,u,i,s,!0)}}function Vu(n,e,t,r,i=!1){for(;null!==t;){if(128===t.type){t=i?t.projectionNext:t.next;continue}const s=e[t.index];null!==s&&r.push(it(s)),Nn(s)&&PE(s,r);const o=t.type;if(8&o)Vu(n,e,t.child,r);else if(32&o){const a=xE(t,e);let c;for(;c=a();)r.push(c)}else if(16&o){const a=RP(e,t);if(Array.isArray(a))r.push(...a);else{const c=Oo(e[15]);Vu(c[1],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function PE(n,e){for(let t=10;t<n.length;t++){const r=n[t],i=r[1].firstChild;null!==i&&Vu(r[1],r,i,e)}n[7]!==n[0]&&e.push(n[7])}function PP(n){if(null!==n[25]){for(const e of n[25])e.impl.addSequence(e);n[25].length=0}}let NP=[];const pY={...nt,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Eu(n.lView)},consumerOnSignalRead(){this.lView[24]=this}},mY={...nt,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Oo(n.lView);for(;e&&!kP(e[1]);)e=Oo(e);e&&Z0(e)},consumerOnSignalRead(){this.lView[24]=this}};function kP(n){return 2!==n.type}function FP(n){if(null===n[23])return;let e=!0;for(;e;){let t=!1;for(const r of n[23])r.dirty&&(t=!0,null===r.zone||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(8192&n[2])}}function m_(n,e=!0,t=0){const i=n[10].rendererFactory;i.begin?.();try{!function yY(n,e){const t=KR();try{Im(!0),NE(n,e);let r=0;for(;Tm(n);){if(100===r)throw new V(103,!1);r++,NE(n,1)}}finally{Im(t)}}(n,t)}catch(o){throw e&&h_(n,o),o}finally{i.end?.()}}function BP(n,e,t,r){if(Ia(e))return;const i=e[2];aw(e);let a=!0,c=null,l=null;kP(n)?(l=function dY(n){return n[24]??function hY(n){const e=NP.pop()??Object.create(pY);return e.lView=n,e}(n)}(e),c=Ee(l)):null===function le(){return Z}()?(a=!1,l=function gY(n){const e=n[24]??Object.create(mY);return e.lView=n,e}(e),c=Ee(l)):e[24]&&(At(e[24]),e[24]=null);try{GR(e),function JR(n){return De.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&bP(n,e,t,2,r);const u=!(3&~i);if(u){const f=n.preOrderCheckHooks;null!==f&&Dm(e,f,null)}else{const f=n.preOrderHooks;null!==f&&Rm(e,f,0,null),dw(e,0)}if(function vY(n){for(let e=K1(n);null!==e;e=J1(e)){if(!(2&e[2]))continue;const t=e[9];for(let r=0;r<t.length;r++)Z0(t[r])}}(e),FP(e),UP(e,0),null!==n.contentQueries&&VO(n,e),u){const f=n.contentCheckHooks;null!==f&&Dm(e,f)}else{const f=n.contentHooks;null!==f&&Rm(e,f,1),dw(e,1)}!function wY(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let r=0;r<t.length;r++){const i=t[r];if(i<0)jc(~i);else{const s=i,o=t[++r],a=t[++r];LW(o,s);const c=e[s];a(2,c)}}}finally{jc(-1)}}(n,e);const d=n.components;null!==d&&VP(e,d,0);const h=n.viewQuery;if(null!==h&&sE(2,h,r),u){const f=n.viewCheckHooks;null!==f&&Dm(e,f)}else{const f=n.viewHooks;null!==f&&Rm(e,f,2),dw(e,2)}if(!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[22]){for(const f of e[22])f();e[22]=null}PP(e),e[2]&=-73}catch(u){throw Eu(e),u}finally{null!==l&&(Ce(l,c),a&&function fY(n){n.lView[24]!==n&&(n.lView=null,NP.push(n))}(l)),cw()}}function UP(n,e){for(let t=K1(n);null!==t;t=J1(t))for(let r=10;r<t.length;r++)jP(t[r],e)}function bY(n,e,t){const r=Pr(e,n);jP(r,t)}function jP(n,e){Y0(n)&&NE(n,e)}function NE(n,e){const r=n[1],i=n[2],s=n[24];let o=!!(0===e&&16&i);if(o||=!!(64&i&&0===e),o||=!!(1024&i),o||=!(!s?.dirty||!Le(s)),o||=!1,s&&(s.dirty=!1),n[2]&=-9217,o)BP(r,n,r.template,n[8]);else if(8192&i){FP(n),UP(n,1);const a=r.components;null!==a&&VP(n,a,1),PP(n)}}function VP(n,e,t){for(let r=0;r<e.length;r++)bY(n,e[r],t)}function vf(n,e){const t=KR()?64:1088;for(n[10].changeDetectionScheduler?.notify(e);n;){n[2]|=t;const r=Oo(n);if(Ro(n)&&!r)return n;n=r}return null}function HP(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function Hu(n,e,t,r=!0){const i=e[1];if(function EY(n,e,t,r){const i=10+r,s=t.length;r>0&&(t[i-1][4]=e),r<s-10?(e[4]=t[i],ER(t,10+r,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[16];null!==o&&t!==o&&GP(o,e);const a=e[18];null!==a&&a.insertView(n),K0(e),e[2]|=128}(i,e,n,t),r){const o=RE(t,n),a=e[11],c=a.parentNode(n[7]);null!==c&&function iY(n,e,t,r,i,s){r[0]=i,r[5]=e,g_(n,r,t,1,i,s)}(i,n[5],a,e,c,o)}const s=e[6];null!==s&&null!==s.firstChild&&(s.firstChild=null)}function bf(n,e){if(n.length<=10)return;const t=10+e,r=n[t];if(r){const i=r[16];null!==i&&i!==n&&SE(i,r),e>0&&(n[t-1][4]=r[4]);const s=hm(n,10+e);!function AP(n,e){TP(n,e),e[0]=null,e[5]=null}(r[1],r);const o=s[18];null!==o&&o.detachView(s[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function GP(n,e){const t=n[9],r=e[3];(an(r)||e[15]!==r[3][15])&&(n[2]|=2),null===t?n[9]=[e]:t.push(e)}class wf{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){const e=this._lView,t=e[1];return Vu(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r}get context(){return this._lView[8]}get dirty(){return!!(9280&this._lView[2])||!!this._lView[24]?.dirty}set context(e){this._lView[8]=e}get destroyed(){return Ia(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Nn(e)){const t=e[8],r=t?t.indexOf(this):-1;r>-1&&(bf(e,r),hm(t,r))}this._attachedToViewContainer=!1}yf(this._lView[1],this._lView)}onDestroy(e){xm(this._lView,e)}markForCheck(){vf(this._cdRefInjectingView||this._lView,4)}markForRefresh(){Z0(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){K0(this._lView),this._lView[2]|=128}detectChanges(){this._lView[2]|=1024,m_(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new V(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const e=Ro(this._lView),t=this._lView[16];null!==t&&!e&&SE(t,this._lView),TP(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new V(902,!1);this._appRef=e;const t=Ro(this._lView),r=this._lView[16];null!==r&&!t&&GP(r,this._lView),K0(this._lView)}}let ps=(()=>class n{static __NG_ELEMENT_ID__=TY})();const CY=ps,AY=class extends CY{_declarationLView;_declarationTContainer;elementRef;constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){const i=Uu(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new wf(i)}};function TY(){return __(qe(),N())}function __(n,e){return 4&n.type?new AY(e,n,Tu(n,e)):null}function zu(n,e,t,r,i){let s=n.data[e];if(null===s)s=function UE(n,e,t,r,i){const s=XR(),o=nw(),c=n.data[e]=function kY(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return Uc()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,r,i);return function NY(n,e,t,r){null===n.firstChild&&(n.firstChild=e),null!==t&&(r?null==t.child&&null!==e.parent&&(t.child=e):null===t.next&&(t.next=e,e.prev=t))}(n,c,s,o),c}(n,e,t,r,i),function FW(){return De.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=r,s.attrs=i;const o=function Hh(){const n=De.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return ds(s,!0),s}class wZ{}class fN{}class EZ{resolveComponentFactory(e){throw Error(`No component factory found for ${un(e)}.`)}}class $u{static NULL=new EZ}class Bo{}let Zc=(()=>class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>function CZ(){const n=N(),t=Pr(qe().index,n);return(an(t)?t:n)[11]}()})(),AZ=(()=>{class n{static \u0275prov=U({token:n,providedIn:"root",factory:()=>null})}return n})();function YE(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=Fh(i,a):2==s&&(r=Fh(r,a+": "+e[++o]+";"))}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function pe(n,e=Ke.Default){const t=N();return null===t?X(n,e):y1(qe(),t,S(n),e)}function ZE(n,e,t,r,i){const s=null===r?null:{"":-1},o=i(n,t);if(null!==o){let a,c=null,l=null;const u=function IZ(n){let e=null,t=!1;for(let o=0;o<n.length;o++){const a=n[o];if(0===o&&mi(a)&&(e=a),null!==a.findHostDirectiveDefs){t=!0;break}}if(!t)return null;let r=null,i=null,s=null;for(const o of n)null!==o.findHostDirectiveDefs&&(r??=[],i??=new Map,s??=new Map,MZ(o,r,s,i)),o===e&&(r??=[],r.push(o));return null!==r?(r.push(...null===e?n:n.slice(1)),[r,i,s]):null}(o);null===u?a=o:[a,c,l]=u,function RZ(n,e,t,r,i,s,o){const a=r.length;let c=!1;for(let h=0;h<a;h++){const f=r[h];!c&&mi(f)&&(c=!0,DZ(n,t,h)),yw(Pm(t,e),n,f.type)}!function LZ(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,a);for(let h=0;h<a;h++){const f=r[h];f.providersResolver&&f.providersResolver(f)}let l=!1,u=!1,d=mf(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let h=0;h<a;h++){const f=r[h];if(t.mergedAttrs=Au(t.mergedAttrs,f.hostAttrs),PZ(n,t,e,d,f),FZ(d,f,i),null!==o&&o.has(f)){const[g,m]=o.get(f);t.directiveToIndex.set(f.type,[d,g+t.directiveStart,m+t.directiveStart])}else(null===s||!s.has(f))&&t.directiveToIndex.set(f.type,d);null!==f.contentQueries&&(t.flags|=4),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(t.flags|=64);const p=f.type.prototype;!l&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),l=!0),!u&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),u=!0),d++}!function OZ(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){const i=n.data[r];if(null!==t&&t.has(i)){const s=t.get(i);yN(0,e,s,r),yN(1,e,s,r),bN(e,r,!0)}else _N(0,e,i,r),_N(1,e,i,r),bN(e,r,!1)}}(n,t,s)}(n,e,t,a,s,c,l)}null!==s&&null!==r&&function SZ(n,e,t){const r=n.localNames=[];for(let i=0;i<e.length;i+=2){const s=t[e[i+1]];if(null==s)throw new V(-301,!1);r.push(e[i],s)}}(t,r,s)}function MZ(n,e,t,r){const i=e.length;n.findHostDirectiveDefs(n,e,r),t.set(n,[i,e.length-1])}function DZ(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function _N(n,e,t,r){const i=0===n?t.inputs:t.outputs;for(const s in i)if(i.hasOwnProperty(s)){let o;o=0===n?e.inputs??={}:e.outputs??={},o[s]??=[],o[s].push(r),vN(e,s)}}function yN(n,e,t,r){const i=0===n?t.inputs:t.outputs;for(const s in i)if(i.hasOwnProperty(s)){const o=i[s];let a;a=0===n?e.hostDirectiveInputs??={}:e.hostDirectiveOutputs??={},a[o]??=[],a[o].push(r,s),vN(e,o)}}function vN(n,e){"class"===e?n.flags|=8:"style"===e&&(n.flags|=16)}function bN(n,e,t){const{attrs:r,inputs:i,hostDirectiveInputs:s}=n;if(null===r||!t&&null===i||t&&null===s||gE(n))return n.initialInputs??=[],void n.initialInputs.push(null);let o=null,a=0;for(;a<r.length;){const c=r[a];if(0!==c)if(5!==c){if("number"==typeof c)break;if(!t&&i.hasOwnProperty(c)){const l=i[c];for(const u of l)if(u===e){o??=[],o.push(c,r[a+1]);break}}else if(t&&s.hasOwnProperty(c)){const l=s[c];for(let u=0;u<l.length;u+=2)if(l[u]===e){o??=[],o.push(l[u+1],r[a+1]);break}}a+=2}else a+=2;else a+=4}n.initialInputs??=[],n.initialInputs.push(o)}function PZ(n,e,t,r,i){n.data[r]=i;const s=i.factory||(i.factory=Dc(i.type)),o=new Gh(s,mi(i),pe);n.blueprint[r]=o,t[r]=o,function NZ(n,e,t,r,i){const s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function kZ(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,r,s)}}(n,e,r,mf(n,t,i.hostVars,ke),i)}function FZ(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;mi(e)&&(t[""]=n)}}function wN(n,e,t,r,i,s,o,a){const c=e.consts,u=zu(e,n,2,r,Fi(c,o));return s&&ZE(e,t,u,Fi(c,a),i),u.mergedAttrs=Au(u.mergedAttrs,u.attrs),null!==u.attrs&&YE(u,u.attrs,!1),null!==u.mergedAttrs&&YE(u,u.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,u),u}function EN(n,e){uw(n,e),$0(e)&&n.queries.elementEnd(e)}class CN extends $u{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=je(e);return new Rf(t,this.ngModule)}}class Rf extends fN{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;get inputs(){return function BZ(n){return Object.keys(n).map(e=>{const[t,r,i]=n[e],s={propName:t,templateName:e,isSignal:!!(r&u_.SignalBased)};return i&&(s.transform=i),s})}(this.componentDef.inputs)}get outputs(){return function UZ(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function BX(n){return n.map(LX).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,i){const s=ee(null);try{const o=this.componentDef,a=r?["ng-version","19.2.0"]:function UX(n){const e=[],t=[];let r=1,i=2;for(;r<n.length;){let s=n[r];if("string"==typeof s)2===i?""!==s&&e.push(s,n[++r]):8===i&&t.push(s);else{if(!fs(i))break;i=s}r++}return t.length&&e.push(1,...t),e}(this.componentDef.selectors[0]),c=yE(0,null,null,1,0,null,null,null,null,[a],null),l=function jZ(n,e,t){let r=e instanceof Qn?e:e?.injector;return r&&null!==n.getStandaloneInjector&&(r=n.getStandaloneInjector(r)||r),r?new Vc(t,r):t}(o,i||this.ngModule,e),u=function VZ(n){const e=n.get(Bo,null);if(null===e)throw new V(407,!1);return{rendererFactory:e,sanitizer:n.get(AZ,null),changeDetectionScheduler:n.get(zs,null)}}(l),d=u.rendererFactory.createRenderer(null,o),h=r?function GX(n,e,t,r){const s=r.get(uO,!1)||t===Ui.ShadowDom,o=n.selectRootElement(e,s);return function WX(n){wP(n)}(o),o}(d,r,o.encapsulation,l):function HZ(n,e){const t=(n.selectors[0][0]||"div").toLowerCase();return c_(e,t,"svg"===t?"svg":"math"===t?"math":null)}(o,d),f=l_(null,c,null,512|vE(o),null,null,u,d,l,null,null);f[26]=h,aw(f);let p=null;try{const g=wN(26,c,f,"#host",()=>[this.componentDef],!0,0);h&&(_P(d,h,g),ti(h,f)),d_(c,f,g),oE(c,g,f),EN(c,g),void 0!==t&&function GZ(n,e,t){const r=n.projection=[];for(let i=0;i<e.length;i++){const s=t[i];r.push(null!=s&&s.length?Array.from(s):null)}}(g,this.ngContentSelectors,t),p=Pr(g.index,f),f[8]=p[8],f_(c,f,null)}catch(g){throw null!==p&&Iw(p),Iw(f),g}finally{cw()}return new zZ(this.componentType,f)}finally{ee(s)}}}class zZ extends wZ{_rootLView;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t){super(),this._rootLView=t,this._tNode=Lc(t[1],26),this.location=Tu(this._tNode,t),this.instance=Pr(this._tNode.index,t)[8],this.hostView=this.changeDetectorRef=new wf(t,void 0,!1),this.componentType=e}setInput(e,t){const r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const i=this._rootLView;AE(r,i[1],i,e,t),this.previousInputValues.set(e,t),vf(Pr(r.index,i),1)}get injector(){return new hn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}let Lr=(()=>class n{static __NG_ELEMENT_ID__=WZ})();function WZ(){return xN(qe(),N())}const $Z=Lr,AN=class extends $Z{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Tu(this._hostTNode,this._hostLView)}get injector(){return new hn(this._hostTNode,this._hostLView)}get parentInjector(){const e=Nm(this._hostTNode,this._hostLView);if(gw(e)){const t=$h(e,this._hostLView),r=Wh(e);return new hn(t[1].data[r+8],t)}return new hn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=TN(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,r){let i,s;"number"==typeof r?i=r:null!=r&&(i=r.index,s=r.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,i,qc(this._hostTNode,null)),a}createComponent(e,t,r,i,s){const o=e&&!function Vh(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const p=t||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}const c=o?e:new Rf(je(e)),l=r||this.parentInjector;if(!s&&null==c.ngModule){const g=(o?l:this.parentInjector).get(Qn,null);g&&(s=g)}je(c.componentType??{});const f=c.create(l,i,null,s);return this.insertImpl(f.hostView,a,qc(this._hostTNode,null)),f}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){const i=e._lView;if(function xW(n){return Nn(n[3])}(i)){const a=this.indexOf(e);if(-1!==a)this.detach(a);else{const c=i[3],l=new AN(c,c[5],c[3]);l.detach(l.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;return Hu(o,i,s,r),e.attachToViewContainerRef(),ER(KE(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=TN(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),r=bf(this._lContainer,t);r&&(hm(KE(this._lContainer),t),yf(r[1],r))}detach(e){const t=this._adjustIndex(e,-1),r=bf(this._lContainer,t);return r&&null!=hm(KE(this._lContainer),t)?new wf(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function TN(n){return n[8]}function KE(n){return n[8]||(n[8]=[])}function xN(n,e){let t;const r=e[n.index];return Nn(r)?t=r:(t=HP(r,e,null,n),e[n.index]=t,bE(e,t)),SN(t,e,n,r),new AN(t,n,e)}let SN=function MN(n,e,t,r){if(n[7])return;let i;i=8&t.type?it(r):function qZ(n,e){const t=n[11],r=t.createComment(""),i=Or(e,n),s=t.parentNode(i);return $c(t,s,r,t.nextSibling(i),!1),r}(e,t),n[7]=i};class QE{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new QE(this.queryList)}setDirty(){this.queryList.setDirty()}}class eC{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const r=null!==e.contentQueries?e.contentQueries[0]:t.length,i=[];for(let s=0;s<r;s++){const o=t.getByIndex(s);i.push(this.queries[o.indexInDeclarationView].clone())}return new eC(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==sC(e,t).matches&&this.queries[t].setDirty()}}class DN{flags;read;predicate;constructor(e,t,r=null){this.flags=t,this.read=r,this.predicate="string"==typeof e?function t7(n){return n.split(",").map(e=>e.trim())}(e):e}}class tC{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let r=0;r<this.length;r++){const i=null!==t?t.length:0,s=this.getByIndex(r).embeddedTView(e,i);s&&(s.indexInDeclarationView=r,null!==t?t.push(s):t=[s])}return null!==t?new tC(t):null}template(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class nC{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new nC(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1&~this.metadata.flags){const t=this._declarationNodeIndex;let r=e.parent;for(;null!==r&&8&r.type&&r.index!==t;)r=r.parent;return t===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){const s=r[i];this.matchTNodeWithReadOption(e,t,KZ(t,s)),this.matchTNodeWithReadOption(e,t,km(t,e,s,!1,!1))}else r===ps?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,km(t,e,r,!1,!1))}matchTNodeWithReadOption(e,t,r){if(null!==r){const i=this.metadata.read;if(null!==i)if(i===fn||i===Lr||i===ps&&4&t.type)this.addMatch(t.index,-2);else{const s=km(t,e,i,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,r)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function KZ(n,e){const t=n.localNames;if(null!==t)for(let r=0;r<t.length;r+=2)if(t[r]===e)return t[r+1];return null}function QZ(n,e,t,r){return-1===t?function JZ(n,e){return 11&n.type?Tu(n,e):4&n.type?__(n,e):null}(e,n):-2===t?function e7(n,e,t){return t===fn?Tu(e,n):t===ps?__(e,n):t===Lr?xN(e,n):void 0}(n,e,r):qh(n,n[1],t,e)}function RN(n,e,t,r){const i=e[18].queries[r];if(null===i.matches){const s=n.data,o=t.matches,a=[];for(let c=0;null!==o&&c<o.length;c+=2){const l=o[c];a.push(l<0?null:QZ(e,s[l],o[c+1],t.metadata.read))}i.matches=a}return i.matches}function rC(n,e,t,r){const i=n.queries.getByIndex(t),s=i.matches;if(null!==s){const o=RN(n,e,i,t);for(let a=0;a<s.length;a+=2){const c=s[a];if(c>0)r.push(o[a/2]);else{const l=s[a+1],u=e[-c];for(let d=10;d<u.length;d++){const h=u[d];h[16]===h[3]&&rC(h[1],h,l,r)}if(null!==u[9]){const d=u[9];for(let h=0;h<d.length;h++){const f=d[h];rC(f[1],f,l,r)}}}}}return r}function ON(n,e,t){const r=new H1(!(4&~t));return function SW(n,e,t,r){const i=$R(e);i.push(t),n.firstCreatePass&&qR(n).push(r,i.length-1)}(n,e,r,r.destroy),(e[18]??=new eC).queries.push(new QE(r))-1}function kN(n,e,t){null===n.queries&&(n.queries=new tC),n.queries.track(new nC(e,t))}function sC(n,e){return n.queries.getByIndex(e)}function FN(n,e){const t=n[1],r=sC(t,e);return r.crossesNgTemplate?rC(t,n,e,[]):RN(t,n,r,e)}class Uo{}class XN extends Uo{injector;componentFactoryResolver=new CN(this);instance=null;constructor(e){super();const t=new Oc([...e.providers,{provide:Uo,useValue:this},{provide:$u,useValue:this.componentFactoryResolver}],e.parent||ym(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}let g7=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const r=L0(0,t.type),i=r.length>0?function lC(n,e,t=null){return new XN({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=U({token:n,providedIn:"environment",factory:()=>new n(X(Qn))})}return n})();function nn(n){return ki(()=>{const e=YN(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Um.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(g7).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Ui.Emulated,styles:n.styles||ft,_:null,schemas:n.schemas||null,tView:null,id:""};e.standalone&&_i("NgStandalone"),ZN(t);const r=n.dependencies;return t.directiveDefs=x_(r,!1),t.pipeDefs=x_(r,!0),t.id=function w7(n){let e=0;const r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,"function"==typeof n.consts?"":n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(const s of r.join("|"))e=Math.imul(31,e)+s.charCodeAt(0)|0;return e+=2147483648,"c"+e}(t),t})}function m7(n){return je(n)||On(n)}function _7(n){return null!==n}function ji(n){return ki(()=>({type:n.type,bootstrap:n.bootstrap||ft,declarations:n.declarations||ft,imports:n.imports||ft,exports:n.exports||ft,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function y7(n,e){if(null==n)return as;const t={};for(const r in n)if(n.hasOwnProperty(r)){const i=n[r];let s,o,a,c;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s,c=i[3]||null):(s=i,o=i,a=u_.None,c=null),t[s]=[r,a,c],e[s]=o}return t}function v7(n){if(null==n)return as;const e={};for(const t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function et(n){return ki(()=>{const e=YN(n);return ZN(e),e})}function vr(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function YN(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||as,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:!0===n.signals,selectors:n.selectors||ft,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:y7(n.inputs,e),outputs:v7(n.outputs),debugInfo:null}}function ZN(n){n.features?.forEach(e=>e(n))}function x_(n,e){if(!n)return null;const t=e?Jn:m7;return()=>("function"==typeof n?n():n).map(r=>t(r)).filter(_7)}function jo(n){let e=function KN(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const r=[n];for(;e;){let i;if(mi(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new V(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);const o=n;o.inputs=uC(n.inputs),o.declaredInputs=uC(n.declaredInputs),o.outputs=uC(n.outputs);const a=i.hostBindings;a&&x7(n,a);const c=i.viewQuery,l=i.contentQueries;if(c&&A7(n,c),l&&T7(n,l),E7(n,i),kh(n.outputs,i.outputs),mi(i)&&i.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(i.data.animation)}}const s=i.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===jo&&(t=!1)}}e=Object.getPrototypeOf(e)}!function C7(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){const i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Au(i.hostAttrs,t=Au(t,i.hostAttrs))}}(r)}function E7(n,e){for(const t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;const r=e.inputs[t];void 0!==r&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t])}}function uC(n){return n===as?{}:n===ft?[]:n}function A7(n,e){const t=n.viewQuery;n.viewQuery=t?(r,i)=>{e(r,i),t(r,i)}:e}function T7(n,e){const t=n.contentQueries;n.contentQueries=t?(r,i,s)=>{e(r,i,s),t(r,i,s)}:e}function x7(n,e){const t=n.hostBindings;n.hostBindings=t?(r,i)=>{e(r,i),t(r,i)}:e}function JN(n){const e=t=>{const r=Array.isArray(n);null===t.hostDirectives?(t.findHostDirectiveDefs=QN,t.hostDirectives=r?n.map(dC):[n]):r?t.hostDirectives.unshift(...n.map(dC)):t.hostDirectives.unshift(n)};return e.ngInherit=!0,e}function QN(n,e,t){if(null!==n.hostDirectives)for(const r of n.hostDirectives)if("function"==typeof r){const i=r();for(const s of i)ek(dC(s),e,t)}else ek(r,e,t)}function ek(n,e,t){const r=On(n.directive);(function D7(n,e){for(const t in e)e.hasOwnProperty(t)&&(n[e[t]]=n[t])})(r.declaredInputs,n.inputs),QN(r,e,t),t.set(r,n),e.push(r)}function dC(n){return"function"==typeof n?{directive:S(n),inputs:as,outputs:as}:{directive:S(n.directive),inputs:tk(n.inputs),outputs:tk(n.outputs)}}function tk(n){if(void 0===n||0===n.length)return as;const e={};for(let t=0;t<n.length;t+=2)e[n[t]]=n[t+1];return e}function S_(n){return!!function hC(n){return null!==n&&("function"==typeof n||"object"==typeof n)}(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function Xs(n,e,t){return n[e]=t}function pn(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Nf(n,e,t,r,i,s,o,a,c,l){const u=t+26,d=e.firstCreatePass?function N7(n,e,t,r,i,s,o,a,c){const l=e.consts,u=zu(e,n,4,o||null,a||null);tw()&&ZE(e,t,u,Fi(l,c),EE),u.mergedAttrs=Au(u.mergedAttrs,u.attrs),uw(e,u);const d=u.tView=yE(2,u,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,e,n,r,i,s,o,a,c):e.data[u];ds(d,!1);const h=rk(e,n,d,t);zh()&&p_(e,n,h,d),ti(h,n);const f=HP(h,n,h,d);return n[u]=f,bE(n,f),Cm(d)&&d_(e,n,d),null!=c&&wE(n,d,l),d}function gs(n,e,t,r,i,s,o,a){const c=N(),l=Me();return Nf(c,l,n,e,t,r,i,Fi(l.consts,s),o,a),gs}let rk=function ik(n,e,t,r){return Vs(!0),e[11].createComment("")};const yk=new P(""),O_=new P("");let bC,yC=(()=>{class n{_ngZone;registry;_isZoneStable=!0;_callbacks=[];taskTrackingZone=null;constructor(t,r,i){this._ngZone=t,this.registry=r,bC||(function PK(n){bC=n}(i),i.addToWindow(r)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ye.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(t)||(clearTimeout(r.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t()},r)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:i})}whenStable(t,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,i),this._runCallbacksIfReady()}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,r,i){return[]}static \u0275fac=function(r){return new(r||n)(X(ye),X(vC),X(O_))};static \u0275prov=U({token:n,factory:n.\u0275fac})}return n})(),vC=(()=>{class n{_applications=new Map;registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return bC?.findTestabilityInTree(this,t,r)??null}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),wC=(()=>{class n{static \u0275prov=U({token:n,providedIn:"root",factory:()=>new vk})}return n})();class vk{queuedEffectCount=0;queues=new Map;schedule(e){this.enqueue(e)}remove(e){const r=this.queues.get(e.zone);r.has(e)&&(r.delete(e),this.queuedEffectCount--)}enqueue(e){const t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);const r=this.queues.get(t);r.has(e)||(this.queuedEffectCount++,r.add(e))}flush(){for(;this.queuedEffectCount>0;)for(const[e,t]of this.queues)null===e?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(const t of e)e.delete(t),this.queuedEffectCount--,t.run()}}function Jc(n){return!!n&&"function"==typeof n.then}function bk(n){return!!n&&"function"==typeof n.subscribe}const EC=new P("");let wk=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=A(EC,{optional:!0})??[];injector=A(pt);constructor(){}runInitializers(){if(this.initialized)return;const t=[];for(const i of this.appInits){const s=gi(this.injector,i);if(Jc(s))t.push(s);else if(bk(s)){const o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),0===t.length&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Zu=new P("");let nr=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=A(A$);afterRenderManager=A($w);zonelessEnabled=A(Yh);rootEffectScheduler=A(wC);dirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new fe;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=A(Gs).hasPendingTasks.pipe(he(t=>!t));constructor(){A(Iu,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=A(Qn);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){const i=t instanceof fN;if(!this._injector.get(wk).done)throw!i&&function xa(n){const e=je(n)||On(n)||Jn(n);return null!==e&&e.standalone}(t),new V(405,!1);let o;o=i?t:this._injector.get($u).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function NK(n){return n.isBoundToModule}(o)?void 0:this._injector.get(Uo),l=o.create(pt.NULL,[],r||o.selector,a),u=l.location.nativeElement,d=l.injector.get(yk,null);return d?.registerApplication(u),l.onDestroy(()=>{this.detachView(l.hostView),P_(this.components,l),d?.unregisterApplication(u)}),this._loadComponent(l),l}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){null!==this.tracingSnapshot?this.tracingSnapshot.run(Ww.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new V(101,!1);const t=ee(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,ee(t),this.afterTick.next()}};synchronize(){null===this._rendererFactory&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Bo,null,{optional:!0}));let t=0;for(;0!==this.dirtyFlags&&t++<10;)this.synchronizeOnce()}synchronizeOnce(){if(16&this.dirtyFlags&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),7&this.dirtyFlags){const t=!!(1&this.dirtyFlags);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r,notifyErrorHandler:i}of this.allViews)FK(r,i,t,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),23&this.dirtyFlags)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();8&this.dirtyFlags&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){this.allViews.some(({_lView:t})=>Tm(t))?this.dirtyFlags|=2:this.dirtyFlags&=-8}attachView(t){const r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){const r=t;P_(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Zu,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>P_(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new V(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function P_(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function FK(n,e,t,r){(t||Tm(n))&&m_(n,e,t&&!r?0:1)}function ms(n,e,t,r){const i=N();return pn(i,Li(),e)&&(Me(),qs(Dt(),i,n,e,t,r)),ms}function Ju(n,e,t,r){return pn(n,Li(),t)?e+Ne(t)+r:ke}function N_(n,e){return n<<17|e<<2}function za(n){return n>>17&32767}function xC(n){return 2|n}function el(n){return(131068&n)>>2}function SC(n,e){return-131069&n|e<<2}function IC(n){return 1|n}function Uk(n,e,t,r){const i=n[t+1],s=null===e;let o=r?za(i):el(i),a=!1;for(;0!==o&&(!1===a||s);){const l=n[o+1];EJ(n[o],e)&&(a=!0,n[o+1]=r?IC(l):xC(l)),o=r?za(l):el(l)}a&&(n[t+1]=r?xC(i):IC(i))}function EJ(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&hu(n,e)>=0}const kn={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function jk(n){return n.substring(kn.key,kn.keyEnd)}function Vk(n,e){const t=kn.textEnd;return t===e?-1:(e=kn.keyEnd=function xJ(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,kn.key=e,t),od(n,e,t))}function od(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function Br(n,e,t){const r=N();return pn(r,Li(),e)&&ni(Me(),Dt(),r,n,e,r[11],t,!1),Br}function MC(n,e,t,r,i){AE(e,n,t,i?"class":"style",r)}function Lf(n,e,t){return _s(n,e,t,!1),Lf}function bi(n,e){return _s(n,e,null,!0),bi}function k_(n){!function ys(n,e,t,r){const i=Me(),s=No(2);i.firstUpdatePass&&qk(i,null,s,r);const o=N();if(t!==ke&&pn(o,s,t)){const a=i.data[er()];if(Kk(a,r)&&!$k(i,s)){let c=r?a.classesWithoutHost:a.stylesWithoutHost;null!==c&&(t=Fh(c,t||"")),MC(i,a,o,t,r)}else!function FJ(n,e,t,r,i,s,o,a){i===ke&&(i=ft);let c=0,l=0,u=0<i.length?i[0]:null,d=0<s.length?s[0]:null;for(;null!==u||null!==d;){const h=c<i.length?i[c+1]:void 0,f=l<s.length?s[l+1]:void 0;let g,p=null;u===d?(c+=2,l+=2,h!==f&&(p=d,g=f)):null===d||null!==u&&u<d?(c+=2,p=u):(l+=2,p=d,g=f),null!==p&&Yk(n,e,t,r,p,g,o,a),u=c<i.length?i[c]:null,d=l<s.length?s[l]:null}}(i,a,o,o[11],o[s+1],o[s+1]=function NJ(n,e,t){if(null==t||""===t)return ft;const r=[],i=yi(t);if(Array.isArray(i))for(let s=0;s<i.length;s++)n(r,i[s],!0);else if("object"==typeof i)for(const s in i)i.hasOwnProperty(s)&&n(r,s,i[s]);else"string"==typeof i&&e(r,i);return r}(n,e,t),r,s)}}(kJ,Zs,n,!0)}function Zs(n,e){for(let t=function AJ(n){return function zk(n){kn.key=0,kn.keyEnd=0,kn.value=0,kn.valueEnd=0,kn.textEnd=n.length}(n),Vk(n,od(n,0,kn.textEnd))}(e);t>=0;t=Vk(e,t))pi(n,jk(e),!0)}function _s(n,e,t,r){const i=N(),s=Me(),o=No(2);s.firstUpdatePass&&qk(s,n,o,r),e!==ke&&pn(i,o,e)&&Yk(s,s.data[er()],i,i[11],n,i[o+1]=function LJ(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=un(yi(n)))),n}(e,t),r,o)}function $k(n,e){return e>=n.expandoStartIndex}function qk(n,e,t,r){const i=n.data;if(null===i[t+1]){const s=i[er()],o=$k(n,t);Kk(s,r)&&null===e&&!o&&(e=!1),e=function DJ(n,e,t,r){const i=function sw(n){const e=De.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(t=Bf(t=DC(null,n,e,t,r),e.attrs,r),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==i)if(t=DC(i,n,e,t,r),null===s){let c=function RJ(n,e,t){const r=t?e.classBindings:e.styleBindings;if(0!==el(r))return n[za(r)]}(n,e,r);void 0!==c&&Array.isArray(c)&&(c=DC(null,n,e,c[1],r),c=Bf(c,e.attrs,r),function OJ(n,e,t,r){n[za(t?e.classBindings:e.styleBindings)]=r}(n,e,r,c))}else s=function PJ(n,e,t){let r;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)r=Bf(r,n[s].hostAttrs,t);return Bf(r,e.attrs,t)}(n,e,r)}return void 0!==s&&(r?e.residualClasses=s:e.residualStyles=s),t}(i,s,e,r),function bJ(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,a=za(o),c=el(o);n[r]=t;let u,l=!1;if(Array.isArray(t)?(u=t[1],(null===u||hu(t,u)>0)&&(l=!0)):u=t,i)if(0!==c){const h=za(n[a+1]);n[r+1]=N_(h,a),0!==h&&(n[h+1]=SC(n[h+1],r)),n[a+1]=function yJ(n,e){return 131071&n|e<<17}(n[a+1],r)}else n[r+1]=N_(a,0),0!==a&&(n[a+1]=SC(n[a+1],r)),a=r;else n[r+1]=N_(c,0),0===a?a=r:n[c+1]=SC(n[c+1],r),c=r;l&&(n[r+1]=xC(n[r+1])),Uk(n,u,r,!0),Uk(n,u,r,!1),function wJ(n,e,t,r,i){const s=i?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&hu(s,e)>=0&&(t[r+1]=IC(t[r+1]))}(e,u,n,r,s),o=N_(a,c),s?e.classBindings=o:e.styleBindings=o}(i,s,e,t,o,r)}}function DC(n,e,t,r,i){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],r=Bf(r,s.hostAttrs,i),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),r}function Bf(n,e,t){const r=t?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),pi(n,o,!!t||e[++s]))}return void 0===n?null:n}function kJ(n,e,t){const r=String(e);""!==r&&!r.includes(" ")&&pi(n,r,t)}function Yk(n,e,t,r,i,s,o,a){if(!(3&e.type))return;const c=n.data,l=c[a+1],u=function vJ(n){return!(1&~n)}(l)?Zk(c,e,t,i,el(l),o):void 0;F_(u)||(F_(s)||function _J(n){return!(2&~n)}(l)&&(s=Zk(c,null,t,i,a,o)),function uY(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=-1===r.indexOf("-")?void 0:Fa.DashCase;null==i?n.removeStyle(t,r,s):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Fa.Important),n.setStyle(t,r,i,s))}}(r,o,wu(er(),t),i,s))}function Zk(n,e,t,r,i,s){const o=null===e;let a;for(;i>0;){const c=n[i],l=Array.isArray(c),u=l?c[1]:c,d=null===u;let h=t[i+1];h===ke&&(h=d?ft:void 0);let f=d?k0(h,r):u===r?h:void 0;if(l&&!F_(f)&&(f=k0(c,r)),F_(f)&&(a=f,o))return a;const p=n[i+1];i=o?za(p):el(p)}if(null!==e){let c=s?e.residualClasses:e.residualStyles;null!=c&&(a=k0(c,r))}return a}function F_(n){return void 0!==n}function Kk(n,e){return!!(n.flags&(e?8:16))}function PC(n,e){_i("NgControlFlow");const t=N(),r=Li(),i=t[r]!==ke?t[r]:-1,s=-1!==i?L_(t,26+i):void 0;if(pn(t,r,n)){const a=ee(null);try{if(void 0!==s&&function kE(n,e){const t=bf(n,e);return void 0!==t&&yf(t[1],t),t}(s,0),-1!==n){const c=26+n,l=L_(t,c),u=function NC(n,e){return Lc(n,e)}(t[1],c),d=null;Hu(l,Uu(t,u,e,{dehydratedView:d}),0,qc(u,d))}}finally{ee(a)}}else if(void 0!==s){const a=function zP(n,e){const t=10+e;if(t<n.length)return n[t]}(s,0);void 0!==a&&(a[8]=e)}}function L_(n,e){return n[e]}function It(n,e,t,r){const i=N(),s=Me(),o=26+n,a=i[11],c=s.firstCreatePass?wN(o,s,i,e,EE,tw(),t,r):s.data[o],l=tF(s,i,c,a,e,n);i[o]=l;const u=Cm(c);return ds(c,!0),_P(a,l,c),!La(c)&&zh()&&p_(s,i,l,c),(0===function IW(){return De.lFrame.elementDepthCount}()||u)&&ti(l,i),function MW(){De.lFrame.elementDepthCount++}(),u&&(d_(s,i,c),oE(s,c,i)),null!==r&&wE(i,c),It}function Ot(){let n=qe();nw()?rw():(n=n.parent,ds(n,!1));const e=n;(function RW(n){return De.skipHydrationRootTNode===n})(e)&&function kW(){De.skipHydrationRootTNode=null}(),function DW(){De.lFrame.elementDepthCount--}();const t=Me();return t.firstCreatePass&&EN(t,e),null!=e.classesWithoutHost&&function XW(n){return!!(8&n.flags)}(e)&&MC(t,e,N(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function YW(n){return!!(16&n.flags)}(e)&&MC(t,e,N(),e.stylesWithoutHost,!1),Ot}function Ks(n,e,t,r){return It(n,e,t,r),Ot(),Ks}let tF=(n,e,t,r,i,s)=>(Vs(!0),c_(r,i,function o1(){return De.lFrame.currentNamespace}()));function B_(){return N()}function U_(n,e,t){const r=N();return pn(r,Li(),e)&&ni(Me(),Dt(),r,n,e,r[11],t,!0),U_}const j_="en-US";let aF=j_;function wi(n,e,t,r){const i=N(),s=Me(),o=qe();return function UC(n,e,t,r,i,s,o){const a=Cm(r),l=n.firstCreatePass?qR(n):null,u=e[8],d=$R(e);let h=!0;if(3&r.type||o){const f=Or(r,e),p=o?o(f):f,g=d.length,m=o?v=>o(it(v[r.index])):r.index;let y=null;if(!o&&a&&(y=function eee(n,e,t,r){const i=n.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===t&&i[s+1]===r){const a=e[7],c=i[s+2];return a.length>c?a[c]:null}"string"==typeof o&&(s+=2)}return null}(n,e,i,r.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=s,y.__ngLastListenerFn__=s,h=!1;else{s=DF(r,e,u,s);const v=t.listen(p,i,s);d.push(s,v),l&&l.push(i,m,g,g+1)}}else s=DF(r,e,u,s);if(h){const f=r.outputs?.[i],p=r.hostDirectiveOutputs?.[i];if(p&&p.length)for(let g=0;g<p.length;g+=2)IF(r,n,e,p[g],p[g+1],i,s,d,l);if(f&&f.length)for(const g of f)IF(r,n,e,g,i,i,s,d,l)}}(s,i,i[11],o,n,e,r),wi}function IF(n,e,t,r,i,s,o,a,c){const f=t[r][e.data[r].outputs[i]].subscribe(o),p=a.length;a.push(o,f),c&&c.push(s,n.index,p,-(p+1))}function MF(n,e,t,r){const i=ee(null);try{return!1!==t(r)}catch(s){return h_(n,s),!1}finally{ee(i)}}function DF(n,e,t,r){return function i(s){if(s===Function)return r;vf(ls(n)?Pr(n.index,e):e,5);let a=MF(e,0,r,s),c=i.__ngNextListenerFn__;for(;c;)a=MF(e,0,c,s)&&a,c=c.__ngNextListenerFn__;return a}}function Ga(n=1){return function jW(n){return(De.lFrame.contextLView=function WR(n,e){for(;n>0;)e=e[14],n--;return e}(n,De.lFrame.contextLView))[8]}(n)}function tee(n,e){let t=null;const r=function PX(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let i=0;i<e.length;i++){const s=e[i];if("*"!==s){if(null===r?dP(n,s,!0):FX(r,s))return i}else t=i}return t}function Wa(n){const e=N()[15][5];if(!e.projection){const r=e.projection=function fm(n,e){const t=[];for(let r=0;r<n;r++)t.push(e);return t}(n?n.length:1,null),i=r.slice();let s=e.child;for(;null!==s;){if(128!==s.type){const o=n?tee(s,n):0;null!==o&&(i[o]?i[o].projectionNext=s:r[o]=s,i[o]=s)}s=s.next}}}function br(n,e=0,t,r,i,s){const o=N(),a=Me(),c=r?n+1:null;null!==c&&Nf(o,a,c,r,i,s,null,t);const l=zu(a,26+n,16,null,t||null);null===l.projection&&(l.projection=e),rw();const d=!o[6]||Uc();null===o[15][5].projection[l.projection]&&null!==c?function nee(n,e,t){const r=26+t,i=e.data[r],s=n[r];Hu(s,Uu(n,i,void 0,{dehydratedView:null}),0,qc(i,null))}(o,a,c):d&&!La(l)&&function cY(n,e,t){OP(e[11],0,e,t,ME(n,t,e),SP(t.parent||e[5],t,e))}(a,o,l)}function jC(n,e,t){return VC(n,"",e,"",t),jC}function VC(n,e,t,r,i){const s=N(),o=Ju(s,e,t,r);return o!==ke&&ni(Me(),Dt(),s,n,o,s[11],i,!1),VC}function HC(n,e,t,r){!function NN(n,e,t,r){const i=Me();if(i.firstCreatePass){const s=qe();kN(i,new DN(e,t,r),s.index),function n7(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(i,n),!(2&~t)&&(i.staticContentQueries=!0)}return ON(i,N(),t)}(n,e,t,r)}function nl(n,e,t){!function PN(n,e,t){const r=Me();return r.firstCreatePass&&(kN(r,new DN(n,e,t),-1),!(2&~e)&&(r.staticViewQueries=!0)),ON(r,N(),e)}(n,e,t)}function Vo(n){const e=N(),t=Me(),r=ow();Mm(r+1);const i=sC(t,r);if(n.dirty&&function TW(n){return!(4&~n[2])}(e)===!(2&~i.metadata.flags)){if(null===i.matches)n.reset([]);else{const s=FN(e,r);n.reset(s,j1),n.notifyOnChanges()}return!0}return!1}function Ho(){return function iC(n,e){return n[18].queries[e].queryList}(N(),ow())}function $a(n,e=""){const t=N(),r=Me(),i=n+26,s=r.firstCreatePass?zu(r,i,1,e,null):r.data[i],o=XF(r,t,s,e,n);t[i]=o,zh()&&p_(r,t,o,s),ds(s,!1)}let XF=(n,e,t,r,i)=>(Vs(!0),function mE(n,e){return n.createText(e)}(e[11],r));function rl(n){return GC("",n,""),rl}function GC(n,e,t){const r=N(),i=Ju(r,n,e,t);return i!==ke&&function zo(n,e,t){const r=wu(e,n);!function fP(n,e,t){n.setValue(e,t)}(n[11],r,t)}(r,er(),i),GC}function WC(n,e,t,r,i){if(n=S(n),Array.isArray(n))for(let s=0;s<n.length;s++)WC(n[s],e,t,r,i);else{const s=Me(),o=N(),a=qe();let c=Rc(n)?n:S(n.provide);const l=MR(n),u=1048575&a.providerIndexes,d=a.directiveStart,h=a.providerIndexes>>20;if(Rc(n)||!n.multi){const f=new Gh(l,i,pe),p=qC(c,e,i?u:u+h,d);-1===p?(yw(Pm(a,o),s,c),$C(s,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(f),o.push(f)):(t[p]=f,o[p]=f)}else{const f=qC(c,e,u+h,d),p=qC(c,e,u,u+h),m=p>=0&&t[p];if(i&&!m||!i&&!(f>=0&&t[f])){yw(Pm(a,o),s,c);const y=function Tee(n,e,t,r,i){const s=new Gh(n,t,pe);return s.multi=[],s.index=e,s.componentProviders=0,aL(s,i,r&&!t),s}(i?Aee:Cee,t.length,i,r,l);!i&&m&&(t[p].providerFactory=y),$C(s,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(y),o.push(y)}else $C(s,n,f>-1?f:p,aL(t[i?p:f],l,!i&&r));!i&&r&&m&&t[p].componentProviders++}}}function $C(n,e,t,r){const i=Rc(e),s=function tW(n){return!!n.useClass}(e);if(i||s){const c=(s?S(e.useClass):e).prototype.ngOnDestroy;if(c){const l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){const u=l.indexOf(t);-1===u?l.push(t,[r,c]):l[u+1].push(r,c)}else l.push(t,c)}}}function aL(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function qC(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function Cee(n,e,t,r){return XC(this.multi,[])}function Aee(n,e,t,r){const i=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=qh(t,t[1],this.providerFactory.index,r);s=a.slice(0,o),XC(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],XC(i,s);return s}function XC(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function YC(n,e=[]){return t=>{t.providersResolver=(r,i)=>function Eee(n,e,t){const r=Me();if(r.firstCreatePass){const i=mi(n);WC(t,r.data,r.blueprint,i,!0),WC(e,r.data,r.blueprint,i,!1)}}(r,i?i(n):n,e)}}function uL(n,e,t,r,i,s){const o=e+t;return pn(n,o,i)?Xs(n,o+1,s?r.call(s,i):r(i)):function Gf(n,e){const t=n[e];return t===ke?void 0:t}(n,o+1)}function qa(n,e){const t=Me();let r;const i=n+26;t.firstCreatePass?(r=function Bee(n,e){if(e)for(let t=e.length-1;t>=0;t--){const r=e[t];if(n===r.name)return r}}(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];const s=r.factory||(r.factory=Dc(r.type)),a=Kr(pe);try{const c=Om(!1),l=s();return Om(c),function zC(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}(t,N(),i,l),l}finally{Kr(a)}}function Xa(n,e,t){const r=n+26,i=N(),s=function Bc(n,e){return n[e]}(i,r);return function Wf(n,e){return n[1].data[e].pure}(i,r)?uL(i,Nr(),e,s.transform,t,s):s.transform(t)}class ud{full;major;minor;patch;constructor(e){this.full=e;const t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}}const RL=new ud("19.2.0");let wte=(()=>{class n{zone=A(ye);changeDetectionScheduler=A(zs);applicationRef=A(nr);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function eA({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new ye({...tA(),scheduleInRootZone:t}),[{provide:ye,useFactory:n},{provide:Dr,multi:!0,useFactory:()=>{const r=A(wte,{optional:!0});return()=>r.initialize()}},{provide:Dr,multi:!0,useFactory:()=>{const r=A(Cte);return()=>{r.initialize()}}},!0===e?{provide:O1,useValue:!0}:[],{provide:ww,useValue:t??D1}]}function tA(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}let Cte=(()=>{class n{subscription=new Mt;initialized=!1;zone=A(ye);pendingTasks=A(Gs);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ye.assertNotInAngularZone(),queueMicrotask(()=>{null!==t&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{ye.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),qf=(()=>{class n{appRef=A(nr);taskService=A(Gs);ngZone=A(ye);zonelessEnabled=A(Yh);tracing=A(Iu,{optional:!0});disableScheduling=A(O1,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Mt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Lm):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(A(ww,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Tw||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&5===t)return;let r=!1;switch(t){case 0:this.appRef.dirtyFlags|=2;break;case 3:case 2:case 4:case 5:case 1:this.appRef.dirtyFlags|=4;break;case 6:case 13:this.appRef.dirtyFlags|=2,r=!0;break;case 12:this.appRef.dirtyFlags|=16,r=!0;break;case 11:r=!0;break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;const i=this.useMicrotaskScheduler?N1:P1;this.pendingRenderTaskId=this.taskService.add(),this.cancelScheduledCallback=this.scheduleInRootZone?Zone.root.run(()=>i(()=>this.tick())):this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Lm+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(0===this.appRef.dirtyFlags)return void this.cleanup();!this.zonelessEnabled&&7&this.appRef.dirtyFlags&&(this.appRef.dirtyFlags|=1);const t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,N1(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Go=new P("",{providedIn:"root",factory:()=>A(Go,Ke.Optional|Ke.SkipSelf)||function Ate(){return typeof $localize<"u"&&$localize.locale||j_}()}),q_=new P(""),Dte=new P("");function Xf(n){return!n.moduleRef}let Ya=null;let vs=(()=>class n{static __NG_ELEMENT_ID__=Fte})();function Fte(n){return function Lte(n,e,t){if(ls(n)&&!t){const r=Pr(n.index,e);return new wf(r,r)}return 175&n.type?new wf(e[15],e):null}(qe(),N(),!(16&~n))}class WL{constructor(){}supports(e){return S_(e)}create(e){return new Hte(e)}}const Vte=(n,e)=>e;class Hte{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||Vte}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){const o=!r||t&&t.currentIndex<qL(r,i,s)?t:r,a=qL(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,null==o.previousIndex)i++;else{s||(s=[]);const l=a-i,u=c-i;if(l!=u){for(let h=0;h<l;h++){const f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<l&&(s[h]=f+1)}s[o.previousIndex]=u-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!S_(e))throw new V(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,s,o,t=this._itHead,r=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),r=!0),t=t._next}else i=0,function O7(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let r;for(;!(r=t.next()).done;)e(r.value)}}(e,a=>{o=this._trackByFn(i,a),null!==t&&Object.is(t.trackById,o)?(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,i),r=!0),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(r,i))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new zte(t,r),s,i),e}_verifyReinsertion(e,t,r,i){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==s?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,s=e._nextRemoved;return null===i?this._removalsHead=s:i._nextRemoved=s,null===s?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){const i=null===t?this._itHead:t._next;return e._next=i,e._prev=t,null===i?this._itTail=e:i._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new $L),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,r=e._next;return null===t?this._itHead=r:t._next=r,null===r?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new $L),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class zte{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}}class Gte{_head=null;_tail=null;add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===t||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){const t=e._prevDup,r=e._nextDup;return null===t?this._head=r:t._nextDup=r,null===r?this._tail=t:r._prevDup=t,null===this._head}}class $L{map=new Map;put(e){const t=e.trackById;let r=this.map.get(t);r||(r=new Gte,this.map.set(t,r)),r.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function qL(n,e,t){const r=n.previousIndex;if(null===r)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function YL(){return new cA([new WL])}let cA=(()=>{class n{factories;static \u0275prov=U({token:n,providedIn:"root",factory:YL});constructor(t){this.factories=t}static create(t,r){if(null!=r){const i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||YL()),deps:[[n,new dm,new uu]]}}find(t){const r=this.factories.find(i=>i.supports(t));if(null!=r)return r;throw new V(901,!1)}}return n})(),Yte=(()=>{class n{constructor(t){}static \u0275fac=function(r){return new(r||n)(X(nr))};static \u0275mod=ji({type:n});static \u0275inj=fi({})}return n})();function ane(n){try{const{rootComponent:e,appProviders:t,platformProviders:r}=n,i=function kte(n=[]){if(Ya)return Ya;const e=function UL(n=[],e){return pt.create({name:e,providers:[{provide:j0,useValue:"platform"},{provide:q_,useValue:new Set([()=>Ya=null])},...n]})}(n);return Ya=e,function Ek(){!function So(n){Zg=n}(()=>{throw new V(600,!1)})}(),function jL(n){const e=n.get(Ow,null);gi(n,()=>{e?.forEach(t=>t())})}(e),e}(r),s=[eA({}),{provide:zs,useExisting:qf},...t||[]];return function FL(n){const e=Xf(n)?n.r3Injector:n.moduleRef.injector,t=e.get(ye);return t.run(()=>{Xf(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();const r=e.get(ei,null);let i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:s=>{r.handleError(s)}})}),Xf(n)){const s=()=>e.destroy(),o=n.platformInjector.get(q_);o.add(s),e.onDestroy(()=>{i.unsubscribe(),o.delete(s)})}else{const s=()=>n.moduleRef.destroy(),o=n.platformInjector.get(q_);o.add(s),n.moduleRef.onDestroy(()=>{P_(n.allPlatformModules,n.moduleRef),i.unsubscribe(),o.delete(s)})}return function Ote(n,e,t){try{const r=t();return Jc(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}(r,t,()=>{const s=e.get(wk);return s.runInitializers(),s.donePromise.then(()=>{if(function mQ(n){"string"==typeof n&&(aF=n.toLowerCase().replace(/_/g,"-"))}(e.get(Go,j_)||j_),!e.get(Dte,!0))return Xf(n)?e.get(nr):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Xf(n)){const c=e.get(nr);return void 0!==n.rootComponent&&c.bootstrap(n.rootComponent),c}return function Rte(n,e){const t=n.injector.get(nr);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else{if(!n.instance.ngDoBootstrap)throw new V(-403,!1);n.instance.ngDoBootstrap(t)}e.push(n)}(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}({r3Injector:new XN({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1}).injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}}function bs(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function sy(n,e=NaN){return isNaN(parseFloat(n))||isNaN(Number(n))?e:Number(n)}function ii(n){const e=ee(null);try{return n()}finally{ee(e)}}function ol(n,e){const t=function xt(n){const e=Object.create(Th);e.computation=n;const t=()=>{if(En(e),sn(e),e.value===Os)throw e.error;return e.value};return t[be]=e,t}(n);return e?.equal&&(t[be].equal=e.equal),t}function pA(n,e){const t=je(n),r=e.elementInjector||ym();return new Rf(t).create(r,e.projectableNodes,e.hostElement,e.environmentInjector)}const gA={now:()=>(gA.delegate||Date).now(),delegate:void 0};class Wo extends fe{constructor(e=1/0,t=1/0,r=gA){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;t||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){const o=t.now();let a=0;for(let c=1;c<r.length&&r[c]<=o;c+=2)a=c;a&&r.splice(0,a+1)}}}function Ye(n,e,t,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,e,t,r);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}function yA(n,e){return function(t,r){e(t,r,n)}}function Q(n,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,e)}function Za(n){return this instanceof Za?(this.v=n,this):new Za(n)}function OB(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function bA(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){!function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}(a,c,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const PB=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function NB(n){return dt(n?.then)}function kB(n){return dt(n[ou])}function FB(n){return Symbol.asyncIterator&&dt(n?.[Symbol.asyncIterator])}function LB(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const BB=function wre(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function UB(n){return dt(n?.[BB])}function jB(n){return function RB(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=t.apply(n,e||[]),s=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function o(f){return function(p){return Promise.resolve(p).then(f,d)}}),i[Symbol.asyncIterator]=function(){return this},i;function a(f,p){r[f]&&(i[f]=function(g){return new Promise(function(m,y){s.push([f,g,m,y])>1||c(f,g)})},p&&(i[f]=p(i[f])))}function c(f,p){try{!function l(f){f.value instanceof Za?Promise.resolve(f.value.v).then(u,d):h(s[0][2],f)}(r[f](p))}catch(g){h(s[0][3],g)}}function u(f){c("next",f)}function d(f){c("throw",f)}function h(f,p){f(p),s.shift(),s.length&&c(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:r,done:i}=yield Za(t.read());if(i)return yield Za(void 0);yield yield Za(r)}}finally{t.releaseLock()}})}function VB(n){return dt(n?.getReader)}function rr(n){if(n instanceof Se)return n;if(null!=n){if(kB(n))return function Ere(n){return new Se(e=>{const t=n[ou]();if(dt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(PB(n))return function Cre(n){return new Se(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(NB(n))return function Are(n){return new Se(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Qg)})}(n);if(FB(n))return HB(n);if(UB(n))return function Tre(n){return new Se(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(VB(n))return function xre(n){return HB(jB(n))}(n)}throw LB(n)}function HB(n){return new Se(e=>{(function Sre(n,e){var t,r,i,s;return function MB(n,e,t,r){return new(t||(t=Promise))(function(s,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):function i(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=OB(n);!(r=yield t.next()).done;)if(e.next(r.value),e.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function $o(n,e,t,r=0,i=!1){const s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function Cn(n,e,t=1/0){return dt(e)?Cn((r,i)=>he((s,o)=>e(r,s,i,o))(rr(n(r,i))),t):("number"==typeof e&&(t=e),bt((r,i)=>function Ire(n,e,t,r,i,s,o,a){const c=[];let l=0,u=0,d=!1;const h=()=>{d&&!c.length&&!l&&e.complete()},f=g=>l<r?p(g):c.push(g),p=g=>{s&&e.next(g),l++;let m=!1;rr(t(g,u++)).subscribe(_t(e,y=>{i?.(y),s?f(y):e.next(y)},()=>{m=!0},void 0,()=>{if(m)try{for(l--;c.length&&l<r;){const y=c.shift();o?$o(e,o,()=>p(y)):p(y)}h()}catch(y){e.error(y)}}))};return n.subscribe(_t(e,f,()=>{d=!0,h()})),()=>{a?.()}}(r,i,n,t)))}function ay(n=1/0){return Cn(Ni,n)}const si=new Se(n=>n.complete());function zB(n){return n&&dt(n.schedule)}function EA(n){return n[n.length-1]}function GB(n){return dt(EA(n))?n.pop():void 0}function tp(n){return zB(EA(n))?n.pop():void 0}function WB(n,e=0){return bt((t,r)=>{t.subscribe(_t(r,i=>$o(r,n,()=>r.next(i),e),()=>$o(r,n,()=>r.complete(),e),i=>$o(r,n,()=>r.error(i),e)))})}function $B(n,e=0){return bt((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function qB(n,e){if(!n)throw new Error("Iterable cannot be null");return new Se(t=>{$o(t,e,()=>{const r=n[Symbol.asyncIterator]();$o(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function Ln(n,e){return e?function Lre(n,e){if(null!=n){if(kB(n))return function Ore(n,e){return rr(n).pipe($B(e),WB(e))}(n,e);if(PB(n))return function Nre(n,e){return new Se(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}(n,e);if(NB(n))return function Pre(n,e){return rr(n).pipe($B(e),WB(e))}(n,e);if(FB(n))return qB(n,e);if(UB(n))return function kre(n,e){return new Se(t=>{let r;return $o(t,e,()=>{r=n[BB](),$o(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){return void t.error(o)}s?t.complete():t.next(i)},0,!0)}),()=>dt(r?.return)&&r.return()})}(n,e);if(VB(n))return function Fre(n,e){return qB(jB(n),e)}(n,e)}throw LB(n)}(n,e):rr(n)}function al(...n){const e=tp(n),t=function Rre(n,e){return"number"==typeof EA(n)?n.pop():e}(n,1/0),r=n;return r.length?1===r.length?rr(r[0]):ay(t)(Ln(r,e)):si}function Bn(n,e){return bt((t,r)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&r.complete();t.subscribe(_t(r,c=>{i?.unsubscribe();let l=0;const u=s++;rr(n(c,u)).subscribe(i=_t(r,d=>r.next(e?e(c,d,u,l++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}const Bre={schedule(n,e){const t=setTimeout(n,e);return()=>clearTimeout(t)}};let CA;function Wre(n,e,t){let r=t;return function jre(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}(n)&&e.some((i,s)=>!("*"===i||!function Vre(n,e){if(!CA){const t=Element.prototype;CA=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE&&CA.call(n,e)}(n,i)||(r=s,0))),r}class qre{componentFactory;inputMap=new Map;constructor(e,t){this.componentFactory=t.get($u).resolveComponentFactory(e);for(const r of this.componentFactory.inputs)this.inputMap.set(r.propName,r.templateName)}create(e){return new Xre(this.componentFactory,e,this.inputMap)}}class Xre{componentFactory;injector;inputMap;eventEmitters=new Wo(1);events=this.eventEmitters.pipe(Bn(e=>al(...e)));componentRef=null;scheduledDestroyFn=null;initialInputValues=new Map;ngZone;elementZone;appRef;cdScheduler;constructor(e,t,r){this.componentFactory=e,this.injector=t,this.inputMap=r,this.ngZone=this.injector.get(ye),this.appRef=this.injector.get(nr),this.cdScheduler=t.get(zs),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=Bre.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null)},10))})}getInputValue(e){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,t){null!==this.componentRef?this.runInZone(()=>{this.componentRef.setInput(this.inputMap.get(e)??e,t),this.componentRef.hostView.dirty&&(this.componentRef.changeDetectorRef.markForRefresh(),this.cdScheduler.notify(6))}):this.initialInputValues.set(e,t)}initializeComponent(e){const t=pt.create({providers:[],parent:this.injector}),r=function Gre(n,e){const t=n.childNodes,r=e.map(()=>[]);let i=-1;e.some((s,o)=>"*"===s&&(i=o,!0));for(let s=0,o=t.length;s<o;++s){const a=t[s],c=Wre(a,e,i);-1!==c&&r[c].push(a)}return r}(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(t,r,e),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.appRef.attachView(this.componentRef.hostView),this.componentRef.hostView.detectChanges()}initializeInputs(){for(const[e,t]of this.initialInputValues)this.setInputValue(e,t);this.initialInputValues.clear()}initializeOutputs(e){const t=this.componentFactory.outputs.map(({propName:r,templateName:i})=>{const s=e.instance[r];return new Se(o=>{const a=s.subscribe(c=>o.next({name:i,value:c}));return()=>a.unsubscribe()})});this.eventEmitters.next(t)}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}class Yre extends HTMLElement{ngElementEventsSubscription=null}let XB=null;function dd(){return XB}class Jre{}const vt=new P("");let YB=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:()=>A(Qre),providedIn:"platform"})}return n})(),Qre=(()=>{class n extends YB{_location;_history;_doc=A(vt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return dd().getBaseHref(this._doc)}onPopState(t){const r=dd().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=dd().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function ZB(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function KB(n){const e=n.search(/#|\?|$/);return"/"===n[e-1]?n.slice(0,e-1)+n.slice(e):n}function cl(n){return n&&"?"!==n[0]?`?${n}`:n}let cy=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:()=>A(tie),providedIn:"root"})}return n})();const eie=new P("");let tie=(()=>{class n extends cy{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??A(vt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return ZB(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+cl(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){const o=this.prepareExternalUrl(i+cl(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){const o=this.prepareExternalUrl(i+cl(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(X(YB),X(eie,8))};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),hd=(()=>{class n{_subject=new fe;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;const r=this._locationStrategy.getBaseHref();this._basePath=function iie(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(KB(JB(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+cl(r))}normalize(t){return n.stripTrailingSlash(function rie(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,JB(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+cl(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+cl(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=cl;static joinWithSlash=ZB;static stripTrailingSlash=KB;static \u0275fac=function(r){return new(r||n)(X(cy))};static \u0275prov=U({token:n,factory:()=>function nie(){return new hd(X(cy))}(),providedIn:"root"})}return n})();function JB(n){return n.replace(/\/index.html$/,"")}function c2(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,s]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}class Gie{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let d2=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const r=this._viewContainer;t.forEachOperation((i,s,o)=>{if(null==i.previousIndex)r.createEmbeddedView(this._template,new Gie(i.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)r.remove(null===s?void 0:s);else if(null!==s){const a=r.get(s);r.move(a,o),h2(a,i)}});for(let i=0,s=r.length;i<s;i++){const a=r.get(i).context;a.index=i,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{h2(r.get(i.currentIndex),i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(pe(Lr),pe(ps),pe(cA))};static \u0275dir=et({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function h2(n,e){n.context.$implicit=e.item}let NA=(()=>{class n{_viewContainer;_context=new Wie;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){f2("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){f2("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(pe(Lr),pe(ps))};static \u0275dir=et({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})();class Wie{$implicit=null;ngIf=null}function f2(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${un(e)}'.`)}class Xie{createSubscription(e,t){return ii(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){ii(()=>e.unsubscribe())}}class Yie{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}}const Zie=new Yie,Kie=new Xie;let by=(()=>{class n{_ref;_latestValue=null;markForCheckOnValueUpdate=!0;_subscription=null;_obj=null;_strategy=null;constructor(t){this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){if(!this._obj){if(t)try{this.markForCheckOnValueUpdate=!1,this._subscribe(t)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,r=>this._updateLatestValue(t,r))}_selectStrategy(t){if(Jc(t))return Zie;if(bk(t))return Kie;throw function Es(n,e){return new V(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,r){t===this._obj&&(this._latestValue=r,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static \u0275fac=function(r){return new(r||n)(pe(vs,16))};static \u0275pipe=vr({name:"async",type:n,pure:!1})}return n})(),m2=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=ji({type:n});static \u0275inj=fi({})}return n})();const _2="browser";function Ka(n){return n===_2}function UA(n){return"server"===n}class y2{}class Gse extends Jre{supportsDOMEvents=!0}class zA extends Gse{static makeCurrent(){!function Kre(n){XB??=n}(new zA)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function Wse(){return sp=sp||document.querySelector("base"),sp?sp.getAttribute("href"):null}();return null==t?null:function $se(n){return new URL(n,document.baseURI).pathname}(t)}resetBaseElement(){sp=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return c2(document.cookie,e)}}let sp=null,Xse=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac})}return n})();const GA=new P("");let M2=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i,s){return this._findPluginFor(r).addEventListener(t,r,i,s)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new V(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(X(GA),X(ye))};static \u0275prov=U({token:n,factory:n.\u0275fac})}return n})();class D2{_doc;constructor(e){this._doc=e}manager}const Ay="ng-app-id";function R2(n){for(const e of n)e.remove()}function O2(n,e){const t=e.createElement("style");return t.textContent=n,t}function WA(n,e){const t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}let P2=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.isServer=UA(s),function Yse(n,e,t,r){const i=n.head?.querySelectorAll(`style[${Ay}="${e}"],link[${Ay}="${e}"]`);if(i)for(const s of i)s.removeAttribute(Ay),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&t.set(s.textContent,{usage:0,elements:[s]})}(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(const i of t)this.addUsage(i,this.inline,O2);r?.forEach(i=>this.addUsage(i,this.external,WA))}removeStyles(t,r){for(const i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){const s=r.get(t);s?s.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,i(t,this.doc)))})}removeUsage(t,r){const i=r.get(t);i&&(i.usage--,i.usage<=0&&(R2(i.elements),r.delete(t)))}ngOnDestroy(){for(const[,{elements:t}]of[...this.inline,...this.external])R2(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(const[r,{elements:i}]of this.inline)i.push(this.addElement(t,O2(r,this.doc)));for(const[r,{elements:i}]of this.external)i.push(this.addElement(t,WA(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(Ay,this.appId),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(X(vt),X(Pa),X(Nw,8),X(ko))};static \u0275prov=U({token:n,factory:n.\u0275fac})}return n})();const $A={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},qA=/%COMP%/g,toe=new P("",{providedIn:"root",factory:()=>!0});function k2(n,e){return e.map(t=>t.replace(qA,n))}let F2=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,s,o,a,c,l=null,u=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=c,this.nonce=l,this.tracingService=u,this.platformIsServer=UA(a),this.defaultRenderer=new XA(t,o,c,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Ui.ShadowDom&&(r={...r,encapsulation:Ui.Emulated});const i=this.getOrCreateRenderer(t,r);return i instanceof B2?i.applyToHost(t):i instanceof YA&&i.applyStyles(),i}getOrCreateRenderer(t,r){const i=this.rendererByCompId;let s=i.get(r.id);if(!s){const o=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer,h=this.tracingService;switch(r.encapsulation){case Ui.Emulated:s=new B2(c,l,r,this.appId,u,o,a,d,h);break;case Ui.ShadowDom:return new soe(c,l,t,r,o,a,this.nonce,d,h);default:s=new YA(c,l,r,u,o,a,d,h)}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(X(M2),X(P2),X(Pa),X(toe),X(vt),X(ko),X(ye),X(Nw),X(Iu,8))};static \u0275prov=U({token:n,factory:n.\u0275fac})}return n})();class XA{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,s){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=s}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS($A[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(L2(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(L2(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r="string"==typeof e?this.doc.querySelector(e):e;if(!r)throw new V(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const s=$A[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=$A[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Fa.DashCase|Fa.Important)?e.style.setProperty(t,r,i&Fa.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Fa.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){null!=e&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if("string"==typeof e&&!(e=dd().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);let s=this.decoratePreventDefault(r);return null!==this.tracingService&&this.tracingService.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,t,s)),this.eventManager.addEventListener(e,t,s,i)}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function L2(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class soe extends XA{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,s,o,a,c,l){super(e,s,o,c,l),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=i.styles;u=k2(i.id,u);for(const h of u){const f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=h,this.shadowRoot.appendChild(f)}const d=i.getExternalStyles?.();if(d)for(const h of d){const f=WA(h,s);a&&f.setAttribute("nonce",a),this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class YA extends XA{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,s,o,a,c,l){super(e,s,o,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let u=r.styles;this.styles=l?k2(l,u):u,this.styleUrls=r.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}}class B2 extends YA{contentAttr;hostAttr;constructor(e,t,r,i,s,o,a,c,l){const u=i+"-"+r.id;super(e,t,r,s,o,a,c,l,u),this.contentAttr=function noe(n){return"_ngcontent-%COMP%".replace(qA,n)}(u),this.hostAttr=function roe(n){return"_nghost-%COMP%".replace(qA,n)}(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}let ooe=(()=>{class n extends D2{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,s){return t.addEventListener(r,i,s),()=>this.removeEventListener(t,r,i,s)}removeEventListener(t,r,i,s){return t.removeEventListener(r,i,s)}static \u0275fac=function(r){return new(r||n)(X(vt))};static \u0275prov=U({token:n,factory:n.\u0275fac})}return n})();const U2=["alt","control","meta","shift"],aoe={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},coe={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let loe=(()=>{class n extends D2{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i,s){const o=n.parseEventName(r),a=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>dd().onAndCancel(t,o.domEventName,a,s))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const s=n._normalizeKey(r.pop());let o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),U2.forEach(l=>{const u=r.indexOf(l);u>-1&&(r.splice(u,1),o+=l+".")}),o+=s,0!=r.length||0===s.length)return null;const c={};return c.domEventName=i,c.fullKey=o,c}static matchEventFullKeyCode(t,r){let i=aoe[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),U2.forEach(o=>{o!==i&&(0,coe[o])(t)&&(s+=o+".")}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static \u0275fac=function(r){return new(r||n)(X(vt))};static \u0275prov=U({token:n,factory:n.\u0275fac})}return n})();const poe=[{provide:ko,useValue:_2},{provide:Ow,useValue:function doe(){zA.makeCurrent()},multi:!0},{provide:vt,useFactory:function foe(){return function K$(n){Rw=n}(document),document},deps:[]}],V2=[{provide:O_,useClass:class qse{addToWindow(e){at.getAngularTestability=(r,i=!0)=>{const s=e.findTestabilityInTree(r,i);if(null==s)throw new V(5103,!1);return s},at.getAllAngularTestabilities=()=>e.getAllTestabilities(),at.getAllAngularRootElements=()=>e.getAllRootElements(),at.frameworkStabilizers||(at.frameworkStabilizers=[]),at.frameworkStabilizers.push(r=>{const i=at.getAllAngularTestabilities();let s=i.length;const o=function(){s--,0==s&&r()};i.forEach(a=>{a.whenStable(o)})})}findTestabilityInTree(e,t,r){return null==t?null:e.getTestability(t)??(r?dd().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:yk,useClass:yC,deps:[ye,vC,O_]},{provide:yC,useClass:yC,deps:[ye,vC,O_]}],H2=[{provide:j0,useValue:"root"},{provide:ei,useFactory:function hoe(){return new ei},deps:[]},{provide:GA,useClass:ooe,multi:!0,deps:[vt]},{provide:GA,useClass:loe,multi:!0,deps:[vt]},F2,P2,M2,{provide:Bo,useExisting:F2},{provide:y2,useClass:Xse,deps:[]},[]];let goe=(()=>{class n{constructor(){}static \u0275fac=function(r){return new(r||n)};static \u0275mod=ji({type:n});static \u0275inj=fi({providers:[...H2,...V2],imports:[m2,Yte]})}return n})(),op=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:function(r){let i=null;return i=r?new(r||n):X(boe),i},providedIn:"root"})}return n})(),boe=(()=>{class n extends op{_doc;constructor(t){super(),this._doc=t}sanitize(t,r){if(null==r)return null;switch(t){case tr.NONE:return r;case tr.HTML:return $s(r,"HTML")?yi(r):QO(this._doc,String(r)).toString();case tr.STYLE:return $s(r,"Style")?yi(r):r;case tr.SCRIPT:if($s(r,"Script"))return yi(r);throw new V(5200,!1);case tr.URL:return $s(r,"URL")?yi(r):i_(String(r));case tr.RESOURCE_URL:if($s(r,"ResourceURL"))return yi(r);throw new V(5201,!1);default:throw new V(5202,!1)}}bypassSecurityTrustHtml(t){return function $q(n){return new jq(n)}(t)}bypassSecurityTrustStyle(t){return function qq(n){return new Vq(n)}(t)}bypassSecurityTrustScript(t){return function Xq(n){return new Hq(n)}(t)}bypassSecurityTrustUrl(t){return function Yq(n){return new zq(n)}(t)}bypassSecurityTrustResourceUrl(t){return function Zq(n){return new Gq(n)}(t)}static \u0275fac=function(r){return new(r||n)(X(vt))};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const gd=Zl(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function gt(n,e){return bt((t,r)=>{let i=0;t.subscribe(_t(r,s=>n.call(e,s,i++)&&r.next(s)))})}function Cs(n){return!!n&&(n instanceof Se||dt(n.lift)&&dt(n.subscribe))}const Ty={schedule(n,e){const t=setTimeout(n,e);return()=>clearTimeout(t)},scheduleBeforeRender(n){if(typeof window>"u")return Ty.schedule(n,0);if(typeof window.requestAnimationFrame>"u")return Ty.schedule(n,16);const e=window.requestAnimationFrame(n);return()=>window.cancelAnimationFrame(e)}};let ZA;function Ooe(n,e,t){let r=t;return function Ioe(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}(n)&&e.some((i,s)=>!("*"===i||!function Moe(n,e){if(!ZA){const t=Element.prototype;ZA=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE&&ZA.call(n,e)}(n,i)||(r=s,0))),r}class Noe{component;constructor(e){this.component=e}create(e){return new koe(this.component,e)}}class koe{component;injector;eventEmitters=new Wo(1);events=this.eventEmitters.pipe(Bn(e=>al(...e)));componentRef=null;viewChangeDetectorRef=null;hasInputChanges=!1;scheduledChangeDetectionFn=null;scheduledDestroyFn=null;initialInputValues=new Map;unchangedInputs;ngZone;elementZone;componentMirror;constructor(e,t){this.component=e,this.injector=t,this.componentMirror=function Kne(n){const e=je(n);if(!e)return null;const t=new Rf(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(this.component),this.unchangedInputs=new Set(this.componentMirror.inputs.map(({propName:r})=>r)),this.ngZone=this.injector.get(ye),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=Ty.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>{if(null===this.componentRef)return this.initialInputValues.get(e);const t=this.componentRef.instance[e];return function xw(n){return"function"==typeof n&&void 0!==n[be]}(t)?t():t})}setInputValue(e,t,r){this.runInZone(()=>{r&&(t=r.call(this.componentRef?.instance,t)),null!==this.componentRef?function Doe(n,e){return n===e||n!=n&&e!=e}(t,this.getInputValue(e))&&(void 0!==t||!this.unchangedInputs.has(e))||(this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.setInput(e,t),this.scheduleDetectChanges()):this.initialInputValues.set(e,t)})}initializeComponent(e){const t=this.injector.get(Qn),r=pt.create({providers:[],parent:this.injector}),i=function Roe(n,e){const t=n.childNodes,r=e.map(()=>[]);let i=-1;e.some((s,o)=>"*"===s&&(i=o,!0));for(let s=0,o=t.length;s<o;++s){const a=t[s],c=Ooe(a,e,i);-1!==c&&r[c].push(a)}return r}(e,[...this.componentMirror.ngContentSelectors]);this.componentRef=pA(this.component,{environmentInjector:t,elementInjector:r,projectableNodes:i,hostElement:e}),this.viewChangeDetectorRef=this.componentRef.injector.get(vs),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(nr).attachView(this.componentRef.hostView)}initializeInputs(){this.componentMirror.inputs.forEach(({propName:e,transform:t})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e),t)}),this.initialInputValues.clear()}initializeOutputs(e){const t=this.componentMirror.outputs.map(({propName:r,templateName:i})=>{const s=e.instance[r];return(Cs(s)?s:function Coe(n){const e=function T$(n){return n.destroyRef}(n);return new Se(t=>{e?.onDestroy(()=>t.complete());const r=n.subscribe(i=>t.next(i));return()=>r.unsubscribe()})}(s)).pipe(he(a=>({name:i,value:a})))});this.eventEmitters.next(t)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=Ty.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}detectChanges(){null!==this.componentRef&&(this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}function KA(){return(KA=j(function*(n,e,t){const{injector:r}=yield function uoe(n){return ane(function j2(n){return{appProviders:[...H2,...n?.providers??[]],platformProviders:poe}}(n))}(t),o=function Foe(n,e){return class t extends n{get instance(){return this.ngElementStrategy.componentRef?.instance}whenStable(){return j(function*(){const i=e.get(nr);yield function woe(n,e){const t="object"==typeof e;return new Promise((r,i)=>{const s=new wa({next:o=>{r(o),s.unsubscribe()},error:i,complete:()=>{t?r(e.defaultValue):i(new gd)}});n.subscribe(s)})}(i.isStable.pipe(gt(s=>s)))})()}}}(function Zre(n,e){const t=function zre(n,e){return e.get($u).resolveComponentFactory(n).inputs}(n,e.injector),r=e.strategyFactory||new qre(n,e.injector),i=function Hre(n){const e={};return n.forEach(({propName:t,templateName:r,transform:i})=>{e[function Ure(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}(r)]=[t,i]}),e}(t);class s extends Yre{injector;static observedAttributes=Object.keys(i);get ngElementStrategy(){if(!this._ngElementStrategy){const a=this._ngElementStrategy=r.create(this.injector||e.injector);t.forEach(({propName:c,transform:l})=>{if(!this.hasOwnProperty(c))return;const u=this[c];delete this[c],a.setInputValue(c,u,l)})}return this._ngElementStrategy}_ngElementStrategy;constructor(a){super(),this.injector=a}attributeChangedCallback(a,c,l,u){const[d,h]=i[a];this.ngElementStrategy.setInputValue(d,l,h)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{const c=new CustomEvent(a.name,{detail:a.value});this.dispatchEvent(c)})}}return t.forEach(({propName:o,transform:a})=>{Object.defineProperty(s.prototype,o,{get(){return this.ngElementStrategy.getInputValue(o)},set(c){this.ngElementStrategy.setInputValue(o,c,a)},configurable:!0,enumerable:!0})}),s}(e,{injector:r,strategyFactory:new Noe(e)}),r);return customElements.define(n,o),o})).apply(this,arguments)}let Boe=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=ji({type:n});static \u0275inj=fi({imports:[m2]})}return n})();function cp(n){return(cp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(n)}function w(n,e,t){return(e=function joe(n){var e=function Uoe(n,e){if("object"!=cp(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var r=t.call(n,e||"default");if("object"!=cp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==cp(e)?e:e+""}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function X2(n){if(typeof window<"u"&&"object"==typeof window.process&&"renderer"===window.process.type||typeof process<"u"&&"object"==typeof process.versions&&process.versions.electron)return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,t=n||e;return!!(t&&t.indexOf("Electron")>=0)}function Js(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||X2()}const Y2=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Js();class Hoe{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";w(this,"storage",void 0),w(this,"id",void 0),w(this,"config",void 0),this.storage=function Voe(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch{return null}}(r),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function JA(n,e,t){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const i=n.src.replace(/\(/g,"%28").replace(/\)/g,"%29");n.width>r&&(t=Math.min(t,r/n.width));const s=n.width*t,o=n.height*t,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let xy;var n;function Z2(n){return"string"==typeof n?xy[n.toUpperCase()]||xy.WHITE:n}function Sy(n,e){if(!n)throw new Error(e||"Assertion failed")}(n=xy||(xy={}))[n.BLACK=30]="BLACK",n[n.RED=31]="RED",n[n.GREEN=32]="GREEN",n[n.YELLOW=33]="YELLOW",n[n.BLUE=34]="BLUE",n[n.MAGENTA=35]="MAGENTA",n[n.CYAN=36]="CYAN",n[n.WHITE=37]="WHITE",n[n.BRIGHT_BLACK=90]="BRIGHT_BLACK",n[n.BRIGHT_RED=91]="BRIGHT_RED",n[n.BRIGHT_GREEN=92]="BRIGHT_GREEN",n[n.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",n[n.BRIGHT_BLUE=94]="BRIGHT_BLUE",n[n.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",n[n.BRIGHT_CYAN=96]="BRIGHT_CYAN",n[n.BRIGHT_WHITE=97]="BRIGHT_WHITE";const Qa={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:"object"==typeof process&&process},Iy=Qa.window||Qa.self||Qa.global,lp=Qa.process||{};function md(){let n;var e,t;if(Js&&"performance"in Iy)n=null==Iy||null===(e=Iy.performance)||void 0===e||null===(t=e.now)||void 0===t?void 0:t.call(e);else if("hrtime"in lp){var r;const i=null==lp||null===(r=lp.hrtime)||void 0===r?void 0:r.call(lp);n=1e3*i[0]+i[1]/1e6}else n=Date.now();return n}const _d={debug:Js&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Yoe={enabled:!0,level:0};function Gi(){}const K2={},J2={once:!0};class up{constructor(){let{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};w(this,"id",void 0),w(this,"VERSION",Y2),w(this,"_startTs",md()),w(this,"_deltaTs",md()),w(this,"_storage",void 0),w(this,"userData",{}),w(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new Hoe("__probe-".concat(this.id,"__"),Yoe),this.timeStamp("".concat(this.id," started")),function Xoe(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const t=Object.getPrototypeOf(n),r=Object.getOwnPropertyNames(t);for(const i of r)"function"==typeof n[i]&&(e.find(s=>i===s)||(n[i]=n[i].bind(n)))}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((md()-this._startTs).toPrecision(10))}getDelta(){return Number((md()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){return this._storage.setConfiguration({enabled:!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){Sy(e,t)}warn(e){return this._getLogFunction(0,e,_d.warn,arguments,J2)}error(e){return this._getLogFunction(0,e,_d.error,arguments)}deprecated(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}removed(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}probe(e,t){return this._getLogFunction(e,t,_d.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,_d.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,t,_d.debug||_d.info,arguments,J2)}table(e,t,r){return t?this._getLogFunction(e,t,console.table||Gi,r&&[r],{tag:Qoe(t)}):Gi}image(e){let{logLevel:t,priority:r,image:i,message:s="",scale:o=1}=e;return this._shouldLog(t||r)?Js?function Joe(n){let{image:e,message:t="",scale:r=1}=n;if("string"==typeof e){const s=new Image;return s.onload=()=>{const o=JA(s,t,r);console.log(...o)},s.src=e,Gi}const i=e.nodeName||"";if("img"===i.toLowerCase())return console.log(...JA(e,t,r)),Gi;if("canvas"===i.toLowerCase()){const s=new Image;return s.onload=()=>console.log(...JA(s,t,r)),s.src=e.toDataURL(),Gi}return Gi}({image:i,message:s,scale:o}):function Koe(n){let{message:t="",scale:r=1}=n;return console.warn("removed"),Gi}({image:i,message:s,scale:o}):Gi}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||Gi)}group(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const i=eU({logLevel:e,message:t,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,t){return this.group(e,t,Object.assign({},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Gi)}withGroup(e,t,r){this.group(e,t)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Q2(e)}_getLogFunction(e,t,r,i,s){if(this._shouldLog(e)){s=eU({logLevel:e,message:t,args:i,opts:s}),Sy(r=r||s.method),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=md();const o=s.tag||s.message;if(s.once){if(K2[o])return Gi;K2[o]=md()}return t=function Zoe(n,e,t){if("string"==typeof e){const r=t.time?function Goe(n){const t=Math.max((arguments.length>1&&void 0!==arguments[1]?arguments[1]:8)-n.length,0);return"".concat(" ".repeat(t)).concat(n)}(function zoe(n){let e;return e=n<10?"".concat(n.toFixed(2),"ms"):n<100?"".concat(n.toFixed(1),"ms"):n<1e3?"".concat(n.toFixed(0),"ms"):"".concat((n/1e3).toFixed(2),"s"),e}(t.total)):"";e=function qoe(n,e,t){return!Js&&"string"==typeof n&&(e&&(e=Z2(e),n="\x1b[".concat(e,"m").concat(n,"\x1b[39m")),t&&(e=Z2(t),n="\x1b[".concat(t+10,"m").concat(n,"\x1b[49m"))),n}(e=t.time?"".concat(n,": ").concat(r,"  ").concat(e):"".concat(n,": ").concat(e),t.color,t.background)}return e}(this.id,s.message,s),r.bind(console,t,...s.args)}return Gi}}function Q2(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return Sy(Number.isFinite(e)&&e>=0),e}function eU(n){const{logLevel:e,message:t}=n;n.logLevel=Q2(e);const r=n.args?Array.from(n.args):[];for(;r.length&&r.shift()!==t;);switch(typeof e){case"string":case"function":void 0!==t&&r.unshift(t),n.message=e;break;case"object":Object.assign(n,e)}"function"==typeof n.message&&(n.message=n.message());const i=typeof n.message;return Sy("string"===i||"object"===i),Object.assign(n,{args:r},n.opts)}function Qoe(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}w(up,"VERSION",Y2);const Je=new up({id:"deck"}),dp=new class eae{constructor(e={}){w(this,"_pool",[]),w(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:c}){const l=i||e&&e.constructor||Float32Array,u=t*r+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new l(e.buffer,0,u)}let d=1/0;c&&(d=c*r+s);const h=this._allocate(l,u,a,d);return e&&o?h.set(e):a||h.fill(0,0,4),this._release(e),h}release(e){this._release(e)}_allocate(e,t,r,i){let s=Math.max(Math.ceil(t*this.opts.overAlloc),1);s>i&&(s=i);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,c=o.findIndex(l=>l.byteLength>=a);if(c>=0){const l=new e(o.splice(c,1)[0],0,s);return r&&l.fill(0),l}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:r}=e,{byteLength:i}=r,s=t.findIndex(o=>o.byteLength>=i);s<0?t.push(r):(s>0||t.length<this.opts.poolSize)&&t.splice(s,0,r),t.length>this.opts.poolSize&&t.shift()}},wn=(Math,Math,{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0});function rae(n,{precision:e=wn.precision}={}){return n=function aae(n){return Math.round(n/wn.EPSILON)*wn.EPSILON}(n),"".concat(parseFloat(n.toPrecision(e)))}function Xo(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function ir(n,e,t){return function Yo(n,e,t){if(Xo(n)){const r=n;t=t||function cae(n){return n.clone?n.clone():new Array(n.length)}(r);for(let i=0;i<t.length&&i<r.length;++i)t[i]=e(n[i],i,t);return t}return e(n)}(n,r=>Math.max(e,Math.min(t,r)))}function My(n,e,t){return Xo(n)?n.map((r,i)=>My(r,e[i],t)):t*e+(1-t)*n}function yd(n,e,t){const r=wn.EPSILON;t&&(wn.EPSILON=t);try{if(n===e)return!0;if(Xo(n)&&Xo(e)){if(n.length!==e.length)return!1;for(let i=0;i<n.length;++i)if(!yd(n[i],e[i]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):"number"==typeof n&&"number"==typeof e&&Math.abs(n-e)<=wn.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{wn.EPSILON=r}}class QA extends(function lae(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+t];return this.check()}toArray(e=[],t=0){for(let r=0;r<this.ELEMENTS;++r)e[t+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Xo(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(wn)}formatString(e){let t="";for(let r=0;r<this.ELEMENTS;++r)t+=(r>0?", ":"")+rae(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!yd(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,r){if(void 0===r)return this.lerp(this,e,t);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(t[i]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),t[r]);return this.check()}add(...e){for(const t of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=t[r];return this.check()}subtract(...e){for(const t of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=t[r];return this.check()}scale(e){if("number"==typeof e)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(wn.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),t);return this.check()}get elements(){return this}}function Bt(n){if(!Number.isFinite(n))throw new Error("Invalid number ".concat(n));return n}function Dy(n,e,t=""){if(wn.debug&&!function uae(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error("math.gl: ".concat(t," some fields set to invalid numbers'"));return n}function nU(n,e){if(!n)throw new Error("math.gl assertion ".concat(e))}class rU extends QA{get x(){return this[0]}set x(e){this[0]=Bt(e)}get y(){return this[1]}set y(e){this[1]=Bt(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];t+=i*i}return Bt(t)}dot(e){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*e[r];return Bt(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=t[r];return this.check()}divide(...e){for(const t of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=t[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return nU(e>=0&&e<this.ELEMENTS,"index is out of range"),Bt(this[e])}setComponent(e,t){return nU(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var Qs=1e-6,oi=typeof Float32Array<"u"?Float32Array:Array;function iU(){var n=new oi(3);return oi!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function sU(n,e,t){var r=new oi(3);return r[0]=n,r[1]=e,r[2]=t,r}function oU(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function Ry(n,e,t){var r=e[0],i=e[1],s=e[2],o=t[0],a=t[1],c=t[2];return n[0]=i*c-s*a,n[1]=s*o-r*c,n[2]=r*a-i*o,n}function eT(n,e,t){var r=e[0],i=e[1],s=e[2],o=t[3]*r+t[7]*i+t[11]*s+t[15];return n[0]=(t[0]*r+t[4]*i+t[8]*s+t[12])/(o=o||1),n[1]=(t[1]*r+t[5]*i+t[9]*s+t[13])/o,n[2]=(t[2]*r+t[6]*i+t[10]*s+t[14])/o,n}function aU(n,e,t){var r=t[0],i=t[1],s=t[2],a=e[0],c=e[1],l=e[2],u=i*l-s*c,d=s*a-r*l,h=r*c-i*a,f=i*h-s*d,p=s*u-r*h,g=r*d-i*u,m=2*t[3];return d*=m,h*=m,p*=2,g*=2,n[0]=a+(u*=m)+(f*=2),n[1]=c+d+p,n[2]=l+h+g,n}Math,Math,Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});function cU(n,e,t){const r=e[0],i=e[1],s=e[2],o=t[3]*r+t[7]*i+t[11]*s||1;return n[0]=(t[0]*r+t[4]*i+t[8]*s)/o,n[1]=(t[1]*r+t[5]*i+t[9]*s)/o,n[2]=(t[2]*r+t[6]*i+t[10]*s)/o,n}iU();const tT=[0,0,0];let Oy;class wr extends rU{static get ZERO(){return Oy||(Oy=new wr(0,0,0),Object.freeze(Oy)),Oy}constructor(e=0,t=0,r=0){super(-0,-0,-0),1===arguments.length&&Xo(e)?this.copy(e):(wn.debug&&(Bt(e),Bt(t),Bt(r)),this[0]=e,this[1]=t,this[2]=r)}set(e,t,r){return this[0]=e,this[1]=t,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return wn.debug&&(Bt(e.x),Bt(e.y),Bt(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Bt(e)}angle(e){return function bae(n,e){var t=n[0],r=n[1],i=n[2],s=e[0],o=e[1],a=e[2],u=Math.sqrt(t*t+r*r+i*i)*Math.sqrt(s*s+o*o+a*a),d=u&&oU(n,e)/u;return Math.acos(Math.min(Math.max(d,-1),1))}(this,e)}cross(e){return Ry(this,this,e),this.check()}rotateX({radians:e,origin:t=tT}){return function _ae(n,e,t,r){var i=[],s=[];i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}rotateY({radians:e,origin:t=tT}){return function yae(n,e,t,r){var i=[],s=[];i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=tT}){return function vae(n,e,t,r){var i=[],s=[];i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return eT(this,this,e),this.check()}transformAsVector(e){return cU(this,this,e),this.check()}transformByMatrix3(e){return function mae(n,e,t){var r=e[0],i=e[1],s=e[2];n[0]=r*t[0]+i*t[3]+s*t[6],n[1]=r*t[1]+i*t[4]+s*t[7],n[2]=r*t[2]+i*t[5]+s*t[8]}(this,this,e),this.check()}transformByMatrix2(e){return function Aae(n,e,t){const r=e[0],i=e[1];n[0]=t[0]*r+t[2]*i,n[1]=t[1]*r+t[3]*i,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return aU(this,this,e),this.check()}}const lU=new wr;function vd(n,e,t,r){lU.set(n,e,t);const i=lU.len();return{distance:r/i,normal:new wr(-n/i,-e/i,-t/i)}}function Dae(n){return n-Math.fround(n)}let fp;function nT(n,e){const{size:t=1,startIndex:r=0}=e,i=void 0!==e.endIndex?e.endIndex:n.length,s=(i-r)/t;fp=dp.allocate(fp,s,{type:Float32Array,size:2*t});let o=r,a=0;for(;o<i;){for(let c=0;c<t;c++){const l=n[o++];fp[a+c]=l,fp[a+c+t]=Dae(l)}a+=2*t}return fp.subarray(0,s*t*2)}class Rae extends QA{toString(){let e="[";if(wn.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,r){return this[t*this.RANK+e]=Bt(r),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)t[i]=this[r+i];return t}setColumn(e,t){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=t[i];return this}}function rT(n,e){var t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=e[9],h=e[10],f=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=t*a-r*o,_=t*c-i*o,E=t*l-s*o,T=r*c-i*a,I=r*l-s*a,D=i*l-s*c,M=u*g-d*p,k=u*m-h*p,B=u*y-f*p,L=d*m-h*g,z=d*y-f*g,R=h*y-f*m,F=v*R-_*z+E*L+T*B-I*k+D*M;return F?(n[0]=(a*R-c*z+l*L)*(F=1/F),n[1]=(i*z-r*R-s*L)*F,n[2]=(g*D-m*I+y*T)*F,n[3]=(h*I-d*D-f*T)*F,n[4]=(c*B-o*R-l*k)*F,n[5]=(t*R-i*B+s*k)*F,n[6]=(m*E-p*D-y*_)*F,n[7]=(u*D-h*E+f*_)*F,n[8]=(o*z-a*B+l*M)*F,n[9]=(r*B-t*z-s*M)*F,n[10]=(p*I-g*E+y*v)*F,n[11]=(d*E-u*I-f*v)*F,n[12]=(a*k-o*L-c*M)*F,n[13]=(t*L-r*k+i*M)*F,n[14]=(g*_-p*T-m*v)*F,n[15]=(u*T-d*_+h*v)*F,n):null}function ll(n,e,t){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],d=e[8],h=e[9],f=e[10],p=e[11],g=e[12],m=e[13],y=e[14],v=e[15],_=t[0],E=t[1],T=t[2],I=t[3];return n[0]=_*r+E*a+T*d+I*g,n[1]=_*i+E*c+T*h+I*m,n[2]=_*s+E*l+T*f+I*y,n[3]=_*o+E*u+T*p+I*v,n[4]=(_=t[4])*r+(E=t[5])*a+(T=t[6])*d+(I=t[7])*g,n[5]=_*i+E*c+T*h+I*m,n[6]=_*s+E*l+T*f+I*y,n[7]=_*o+E*u+T*p+I*v,n[8]=(_=t[8])*r+(E=t[9])*a+(T=t[10])*d+(I=t[11])*g,n[9]=_*i+E*c+T*h+I*m,n[10]=_*s+E*l+T*f+I*y,n[11]=_*o+E*u+T*p+I*v,n[12]=(_=t[12])*r+(E=t[13])*a+(T=t[14])*d+(I=t[15])*g,n[13]=_*i+E*c+T*h+I*m,n[14]=_*s+E*l+T*f+I*y,n[15]=_*o+E*u+T*p+I*v,n}function Py(n,e,t){var o,a,c,l,u,d,h,f,p,g,m,y,r=t[0],i=t[1],s=t[2];return e===n?(n[12]=e[0]*r+e[4]*i+e[8]*s+e[12],n[13]=e[1]*r+e[5]*i+e[9]*s+e[13],n[14]=e[2]*r+e[6]*i+e[10]*s+e[14],n[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(a=e[1],c=e[2],l=e[3],u=e[4],d=e[5],h=e[6],f=e[7],p=e[8],g=e[9],m=e[10],y=e[11],n[0]=o=e[0],n[1]=a,n[2]=c,n[3]=l,n[4]=u,n[5]=d,n[6]=h,n[7]=f,n[8]=p,n[9]=g,n[10]=m,n[11]=y,n[12]=o*r+u*i+p*s+e[12],n[13]=a*r+d*i+g*s+e[13],n[14]=c*r+h*i+m*s+e[14],n[15]=l*r+f*i+y*s+e[15]),n}function iT(n,e,t){var r=t[0],i=t[1],s=t[2];return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7]*i,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function uU(n,e,t){var r=Math.sin(t),i=Math.cos(t),s=e[4],o=e[5],a=e[6],c=e[7],l=e[8],u=e[9],d=e[10],h=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=s*i+l*r,n[5]=o*i+u*r,n[6]=a*i+d*r,n[7]=c*i+h*r,n[8]=l*i-s*r,n[9]=u*i-o*r,n[10]=d*i-a*r,n[11]=h*i-c*r,n}function dU(n,e,t){var r=Math.sin(t),i=Math.cos(t),s=e[0],o=e[1],a=e[2],c=e[3],l=e[4],u=e[5],d=e[6],h=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*i+l*r,n[1]=o*i+u*r,n[2]=a*i+d*r,n[3]=c*i+h*r,n[4]=l*i-s*r,n[5]=u*i-o*r,n[6]=d*i-a*r,n[7]=h*i-c*r,n}function Ny(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function hU(n,e){return n[0]=-e[0],n[1]=-e[1],n}function fU(n,e,t,r){var i=e[0],s=e[1];return n[0]=i+r*(t[0]-i),n[1]=s+r*(t[1]-s),n}function pU(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function pp(n,e,t){var r=e[0],i=e[1],s=e[2],o=e[3];return n[0]=t[0]*r+t[4]*i+t[8]*s+t[12]*o,n[1]=t[1]*r+t[5]*i+t[9]*s+t[13]*o,n[2]=t[2]*r+t[6]*i+t[10]*s+t[14]*o,n[3]=t[3]*r+t[7]*i+t[11]*s+t[15]*o,n}!function $ae(){var n=new oi(2);oi!=Float32Array&&(n[0]=0,n[1]=0)}(),function Xae(){var n=new oi(4);oi!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0)}();var gU=function(n){return n[n.COL0ROW0=0]="COL0ROW0",n[n.COL0ROW1=1]="COL0ROW1",n[n.COL0ROW2=2]="COL0ROW2",n[n.COL0ROW3=3]="COL0ROW3",n[n.COL1ROW0=4]="COL1ROW0",n[n.COL1ROW1=5]="COL1ROW1",n[n.COL1ROW2=6]="COL1ROW2",n[n.COL1ROW3=7]="COL1ROW3",n[n.COL2ROW0=8]="COL2ROW0",n[n.COL2ROW1=9]="COL2ROW1",n[n.COL2ROW2=10]="COL2ROW2",n[n.COL2ROW3=11]="COL2ROW3",n[n.COL3ROW0=12]="COL3ROW0",n[n.COL3ROW1=13]="COL3ROW1",n[n.COL3ROW2=14]="COL3ROW2",n[n.COL3ROW3=15]="COL3ROW3",n}(gU||{});const cce=45*Math.PI/180,lce=1,sT=.1,oT=500,uce=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Ve extends Rae{static get IDENTITY(){return function hce(){return Fy||(Fy=new Ve,Object.freeze(Fy)),Fy}()}static get ZERO(){return function dce(){return ky||(ky=new Ve([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(ky)),ky}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return gU}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,r,i,s,o,a,c,l,u,d,h,f,p,g,m){return this[0]=e,this[1]=t,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=c,this[8]=l,this[9]=u,this[10]=d,this[11]=h,this[12]=f,this[13]=p,this[14]=g,this[15]=m,this.check()}setRowMajor(e,t,r,i,s,o,a,c,l,u,d,h,f,p,g,m){return this[0]=e,this[1]=s,this[2]=l,this[3]=f,this[4]=t,this[5]=o,this[6]=u,this[7]=p,this[8]=r,this[9]=a,this[10]=d,this[11]=g,this[12]=i,this[13]=c,this[14]=h,this[15]=m,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(uce)}fromObject(e){return this.check()}fromQuaternion(e){return function Uae(n,e){var t=e[0],r=e[1],i=e[2],s=e[3],o=t+t,a=r+r,c=i+i,l=t*o,u=r*o,d=r*a,h=i*o,f=i*a,p=i*c,g=s*o,m=s*a,y=s*c;n[0]=1-d-p,n[1]=u+y,n[2]=h-m,n[3]=0,n[4]=u-y,n[5]=1-l-p,n[6]=f+g,n[7]=0,n[8]=h+m,n[9]=f-g,n[10]=1-l-d,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(this,e),this.check()}frustum(e){const{left:t,right:r,bottom:i,top:s,near:o=sT,far:a=oT}=e;return a===1/0?function fce(n,e,t,r,i,s){const a=2*s/(i-r),c=(t+e)/(t-e),l=(i+r)/(i-r),h=-2*s;n[0]=2*s/(t-e),n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a,n[6]=0,n[7]=0,n[8]=c,n[9]=l,n[10]=-1,n[11]=-1,n[12]=0,n[13]=0,n[14]=h,n[15]=0}(this,t,r,i,s,o):function jae(n,e,t,r,i,s,o){var a=1/(t-e),c=1/(i-r),l=1/(s-o);n[0]=2*s*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=2*s*c,n[6]=0,n[7]=0,n[8]=(t+e)*a,n[9]=(i+r)*c,n[10]=(o+s)*l,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*s*2*l,n[15]=0}(this,t,r,i,s,o,a),this.check()}lookAt(e){const{eye:t,center:r=[0,0,0],up:i=[0,1,0]}=e;return function Wae(n,e,t,r){var i,s,o,a,c,l,u,d,h,f,p=e[0],g=e[1],m=e[2],y=r[0],v=r[1],_=r[2],E=t[0],T=t[1],I=t[2];Math.abs(p-E)<Qs&&Math.abs(g-T)<Qs&&Math.abs(m-I)<Qs?function Oae(n){n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(n):(u=p-E,d=g-T,h=m-I,i=v*(h*=f=1/Math.hypot(u,d,h))-_*(d*=f),s=_*(u*=f)-y*h,o=y*d-v*u,(f=Math.hypot(i,s,o))?(i*=f=1/f,s*=f,o*=f):(i=0,s=0,o=0),a=d*o-h*s,c=h*i-u*o,l=u*s-d*i,(f=Math.hypot(a,c,l))?(a*=f=1/f,c*=f,l*=f):(a=0,c=0,l=0),n[0]=i,n[1]=a,n[2]=u,n[3]=0,n[4]=s,n[5]=c,n[6]=d,n[7]=0,n[8]=o,n[9]=l,n[10]=h,n[11]=0,n[12]=-(i*p+s*g+o*m),n[13]=-(a*p+c*g+l*m),n[14]=-(u*p+d*g+h*m),n[15]=1)}(this,t,r,i),this.check()}ortho(e){const{left:t,right:r,bottom:i,top:s,near:o=sT,far:a=oT}=e;return function zae(n,e,t,r,i,s,o){var a=1/(e-t),c=1/(r-i),l=1/(s-o);n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*c,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*l,n[11]=0,n[12]=(e+t)*a,n[13]=(i+r)*c,n[14]=(o+s)*l,n[15]=1}(this,t,r,i,s,o,a),this.check()}orthographic(e){const{fovy:t=cce,aspect:r=lce,focalDistance:i=1,near:s=sT,far:o=oT}=e;mU(t);const c=i*Math.tan(t/2),l=c*r;return this.ortho({left:-l,right:l,bottom:-c,top:c,near:s,far:o})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return mU(t),function Vae(n,e,t,r,i){var o,s=1/Math.tan(e/2);n[0]=s/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=i&&i!==1/0?(n[10]=(i+r)*(o=1/(r-i)),n[14]=2*i*r*o):(n[10]=-1,n[14]=-2*r)}(this,t,r,i,s),this.check()}determinant(){return function Nae(n){var e=n[0],t=n[1],r=n[2],i=n[3],s=n[4],o=n[5],a=n[6],c=n[7],l=n[8],u=n[9],d=n[10],h=n[11],f=n[12],p=n[13],g=n[14],m=n[15];return(e*o-t*s)*(d*m-h*g)-(e*a-r*s)*(u*m-h*p)+(e*c-i*s)*(u*g-d*p)+(t*a-r*o)*(l*m-h*f)-(t*c-i*o)*(l*g-d*f)+(r*c-i*a)*(l*p-u*f)}(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0];const r=this.getScale(t=t||[-0,-0,-0]),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0];const r=this.getScale(t=t||[-0,-0,-0]),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return function Pae(n,e){if(n===e){var t=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=r,n[9]=s,n[11]=e[14],n[12]=i,n[13]=o,n[14]=a}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15]}(this,this),this.check()}invert(){return rT(this,this),this.check()}multiplyLeft(e){return ll(this,e,this),this.check()}multiplyRight(e){return ll(this,this,e),this.check()}rotateX(e){return uU(this,this,e),this.check()}rotateY(e){return function Fae(n,e,t){var r=Math.sin(t),i=Math.cos(t),s=e[0],o=e[1],a=e[2],c=e[3],l=e[8],u=e[9],d=e[10],h=e[11];e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*i-l*r,n[1]=o*i-u*r,n[2]=a*i-d*r,n[3]=c*i-h*r,n[8]=s*r+l*i,n[9]=o*r+u*i,n[10]=a*r+d*i,n[11]=c*r+h*i}(this,this,e),this.check()}rotateZ(e){return dU(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return function kae(n,e,t,r){var c,l,u,d,h,f,p,g,m,y,v,_,E,T,I,D,M,k,B,L,z,R,F,W,i=r[0],s=r[1],o=r[2],a=Math.hypot(i,s,o);a<Qs||(i*=a=1/a,s*=a,o*=a,c=Math.sin(t),l=Math.cos(t),h=e[1],f=e[2],p=e[3],m=e[5],y=e[6],v=e[7],E=e[9],T=e[10],I=e[11],B=i*s*(u=1-l)-o*c,L=s*s*u+l,z=o*s*u+i*c,R=i*o*u+s*c,F=s*o*u-i*c,W=o*o*u+l,n[0]=(d=e[0])*(D=i*i*u+l)+(g=e[4])*(M=s*i*u+o*c)+(_=e[8])*(k=o*i*u-s*c),n[1]=h*D+m*M+E*k,n[2]=f*D+y*M+T*k,n[3]=p*D+v*M+I*k,n[4]=d*B+g*L+_*z,n[5]=h*B+m*L+E*z,n[6]=f*B+y*L+T*z,n[7]=p*B+v*L+I*z,n[8]=d*R+g*F+_*W,n[9]=h*R+m*F+E*W,n[10]=f*R+y*F+T*W,n[11]=p*R+v*F+I*W,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]))}(this,this,e,t),this.check()}scale(e){return iT(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Py(this,this,e),this.check()}transform(e,t){return 4===e.length?(Dy(t=pp(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:r}=e;let i;switch(r){case 2:i=function qae(n,e,t){var r=e[0],i=e[1];return n[0]=t[0]*r+t[4]*i+t[12],n[1]=t[1]*r+t[5]*i+t[13],n}(t||[-0,-0],e,this);break;case 3:i=eT(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Dy(i,e.length),i}transformAsVector(e,t){let r;switch(e.length){case 2:r=function Cae(n,e,t){const r=e[0],i=e[1],s=t[3]*r+t[7]*i||1;return n[0]=(t[0]*r+t[4]*i)/s,n[1]=(t[1]*r+t[5]*i)/s,n}(t||[-0,-0],e,this);break;case 3:r=cU(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Dy(r,e.length),r}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,r){return this.identity().translate([e,t,r])}}let ky,Fy;function mU(n){if(n>2*Math.PI)throw Error("expected radians")}function bd(n,e){const t=pp([],e,n);return pU(t,t,1/t[3]),t}function _U(n,e){const t=n%e;return t<0?e+t:t}function aT(n,e,t){return n<e?e:n>t?t:n}const cT=Math.log2||function gce(n){return Math.log(n)*Math.LOG2E};function Zo(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const As=Math.PI,yU=As/4,Wi=As/180,lT=180/As,Ly=4003e4,By=85.051129,mce=1.5;function Uy(n){const[e,t]=n;return Zo(Number.isFinite(e)),Zo(Number.isFinite(t)&&t>=-90&&t<=90,"invalid latitude"),[512*(e*Wi+As)/(2*As),512*(As+Math.log(Math.tan(yU+t*Wi*.5)))/(2*As)]}function Ed(n){const[e,t]=n,r=e/512*(2*As)-As,i=2*(Math.atan(Math.exp(t/512*(2*As)-As))-yU);return[r*lT,i*lT]}function uT(n){const{latitude:e,longitude:t,highPrecision:r=!1}=n;Zo(Number.isFinite(e)&&Number.isFinite(t));const s=Math.cos(e*Wi),o=512/360,a=o/s,c=512/Ly/s,l={unitsPerMeter:[c,c,c],metersPerUnit:[1/c,1/c,1/c],unitsPerDegree:[o,a,c],degreesPerUnit:[1/o,1/a,1/c]};if(r){const u=Wi*Math.tan(e*Wi)/s,h=512/Ly*u,f=h/a*c;l.unitsPerDegree2=[0,o*u/2,h],l.unitsPerMeter2=[f,0,f]}return l}function vU(n,e){const[t,r,i]=n,[s,o,a]=e,{unitsPerMeter:c,unitsPerMeter2:l}=uT({longitude:t,latitude:r,highPrecision:!0}),u=Uy(n);u[0]+=s*(c[0]+l[0]*o),u[1]+=o*(c[1]+l[1]*o);const d=Ed(u),h=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[d[0],d[1],h]:d}function jy(n){return 2*Math.atan(.5/n)*lT}function dT(n){return.5/Math.tan(.5*n*Wi)}function wU(n,e){const[t,r,i=0]=n;return Zo(Number.isFinite(t)&&Number.isFinite(r)&&Number.isFinite(i)),bd(e,[t,r,i,1])}function gp(n,e,t=0){const[r,i,s]=n;if(Zo(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return bd(e,[r,i,s,1]);const o=bd(e,[r,i,0,1]),a=bd(e,[r,i,1,1]),c=o[2],l=a[2];return fU([],o,a,c===l?0:((t||0)-c)/(l-c))}function EU(n){const{width:e,height:t,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=n,[[a,c],[l,u]]=r,d=function bce(n=0){return"number"==typeof n?{top:n,bottom:n,left:n,right:n}:(Zo(Number.isFinite(n.top)&&Number.isFinite(n.bottom)&&Number.isFinite(n.left)&&Number.isFinite(n.right)),n)}(n.padding),h=Uy([a,aT(u,-By,By)]),f=Uy([l,aT(c,-By,By)]),p=[Math.max(Math.abs(f[0]-h[0]),i),Math.max(Math.abs(f[1]-h[1]),i)],g=[e-d.left-d.right-2*Math.abs(o[0]),t-d.top-d.bottom-2*Math.abs(o[1])];Zo(g[0]>0&&g[1]>0);const m=g[0]/p[0],y=g[1]/p[1],T=Ed([(f[0]+h[0])/2+(d.right-d.left)/2/m,(f[1]+h[1])/2+(d.top-d.bottom)/2/y]),I=Math.min(s,cT(Math.abs(Math.min(m,y))));return Zo(Number.isFinite(I)),{longitude:T[0],latitude:T[1],zoom:I}}const CU=Math.PI/180;function AU(n,e,t){const{pixelUnprojectionMatrix:r}=n,i=bd(r,[e,0,1,1]),s=bd(r,[e,n.height,1,1]),l=Ed(fU([],i,s,(t*n.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2])));return l.push(t),l}const st={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(st,"IDENTITY",{get:()=>(Je.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const eo={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Vy={common:0,meters:1,pixels:2},MU={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},Ace=Math.PI/180,Tce=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],DU=[0,0,0],xce={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class ec{constructor(e={}){w(this,"id",void 0),w(this,"x",void 0),w(this,"y",void 0),w(this,"width",void 0),w(this,"height",void 0),w(this,"padding",void 0),w(this,"isGeospatial",void 0),w(this,"zoom",void 0),w(this,"focalDistance",void 0),w(this,"position",void 0),w(this,"modelMatrix",void 0),w(this,"distanceScales",void 0),w(this,"scale",void 0),w(this,"center",void 0),w(this,"cameraPosition",void 0),w(this,"projectionMatrix",void 0),w(this,"viewMatrix",void 0),w(this,"viewMatrixUncentered",void 0),w(this,"viewMatrixInverse",void 0),w(this,"viewProjectionMatrix",void 0),w(this,"pixelProjectionMatrix",void 0),w(this,"pixelUnprojectionMatrix",void 0),w(this,"resolution",void 0),w(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||xce,this.focalDistance=e.focalDistance||1,this.position=e.position||DU,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?eo.WEB_MERCATOR:eo.WEB_MERCATOR_AUTO_OFFSET:eo.IDENTITY}equals(e){return e instanceof ec&&(this===e||e.width===this.width&&e.height===this.height&&e.scale===this.scale&&yd(e.projectionMatrix,this.projectionMatrix)&&yd(e.viewMatrix,this.viewMatrix))}project(e,{topLeft:t=!0}={}){const i=wU(this.projectPosition(e),this.pixelProjectionMatrix),[s,o]=i,a=t?o:this.height-o;return 2===e.length?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:t=!0,targetZ:r}={}){const[i,s,o]=e,l=gp([i,t?s:this.height-s,o],this.pixelUnprojectionMatrix,r&&r*this.distanceScales.unitsPerMeter[2]),[u,d,h]=this.unprojectPosition(l);return Number.isFinite(o)?[u,d,h]:Number.isFinite(r)?[u,d,r]:[u,d]}projectPosition(e){const[t,r]=this.projectFlat(e);return[t,r,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,r]=this.unprojectFlat(e);return[t,r,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){if(this.isGeospatial){const t=Uy(e);return t[1]=ir(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?Ed(e):e}getBounds(e={}){const t={targetZ:e.z||0},r=this.unproject([0,0],t),i=this.unproject([this.width,0],t),s=this.unproject([0,this.height],t),o=this.unproject([this.width,this.height],t);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}getDistanceScales(e){return e?uT({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:t,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&t<this.y+this.height&&this.y<t+i}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function Mae(n){return{left:vd(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),right:vd(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),bottom:vd(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),top:vd(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),near:vd(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),far:vd(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14])}}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=function yce(n){const{latitude:e}=n;Zo(Number.isFinite(e));const t=Math.cos(e*Wi);return function _ce(n){return cT(n)}(Ly*t)-9}({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||uT({latitude:r,longitude:t}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:o}=e;let a=DU;if(s&&(a=o?new Ve(o).transformAsVector(s,[]):s),this.isGeospatial){const c=this.projectPosition([t,r,0]);this.center=new wr(a).scale(this.distanceScales.unitsPerMeter).add(c)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:t=Tce,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:c=1e3,padding:l=null,focalDistance:u=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=(new Ve).multiplyRight(t).translate(new wr(this.center).negate()),this.projectionMatrix=r||function Sce({width:n,height:e,orthographic:t,fovyRadians:r,focalDistance:i,padding:s,near:o,far:a}){const c=n/e,l=t?(new Ve).orthographic({fovy:r,aspect:c,focalDistance:i,near:o,far:a}):(new Ve).perspective({fovy:r,aspect:c,near:o,far:a});if(s){const{left:u=0,right:d=0,top:h=0,bottom:f=0}=s,p=ir((u+n-d)/2,0,n)-n/2,g=ir((h+e-f)/2,0,e)-e/2;l[8]-=2*p/n,l[9]+=2*g/e}return l}({width:this.width,height:this.height,orthographic:i,fovyRadians:s||o*Ace,focalDistance:u,padding:l,near:a,far:c});const d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];ll(d,d,this.projectionMatrix),ll(d,d,this.viewMatrix),this.viewProjectionMatrix=d,this.viewMatrixInverse=rT([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=function Iae(n){return[n[12],n[13],n[14]]}(this.viewMatrixInverse);const h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];iT(h,h,[this.width/2,-this.height/2,1]),Py(h,h,[1,-1,0]),ll(f,h,this.viewProjectionMatrix),this.pixelProjectionMatrix=f,this.pixelUnprojectionMatrix=rT([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Je.warn("Pixel project matrix not invertible")()}}w(ec,"displayName","Viewport");const Ice=/([0-9]+\.?[0-9]*)(%|px)/;function tc(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=Ice.exec(n);if(e&&e.length>=3){const t="%"===e[2],r=parseFloat(e[1]);return{position:t?r/100:r,relative:t}}default:throw new Error("Could not parse position string ".concat(n))}}function nc(n,e){return n.relative?Math.round(n.position*e):n.position}function Cd(n,e){if(n===e)return!0;if(!n||!e)return!1;for(const t in n){const r=n[t],i=e[t];if(!(r===i||Array.isArray(r)&&Array.isArray(i)&&Cd(r,i)))return!1}return!0}function sr(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}class fT{constructor(e){w(this,"id",void 0),w(this,"viewportInstance",void 0),w(this,"_x",void 0),w(this,"_y",void 0),w(this,"_width",void 0),w(this,"_height",void 0),w(this,"_padding",void 0),w(this,"props",void 0);const{id:t,x:r=0,y:i=0,width:s="100%",height:o="100%",padding:a=null,viewportInstance:c}=e||{};sr(!c||c instanceof ec),this.viewportInstance=c,this.id=t||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=tc(r),this._y=tc(i),this._width=tc(s),this._height=tc(o),this._padding=a&&{left:tc(a.left||0),right:tc(a.right||0),top:tc(a.top||0),bottom:tc(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?!!e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):this.ViewportType===e.ViewportType&&Cd(this.props,e.props))}makeViewport({width:e,height:t,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:t});return new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return"string"==typeof e?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t={...e};for(const r in this.props.viewState)"id"!==r&&(t[r]=this.props.viewState[r]);return t}return e}getDimensions({width:e,height:t}){const r={x:nc(this._x,e),y:nc(this._y,t),width:nc(this._width,e),height:nc(this._height,t)};return this._padding&&(r.padding={left:nc(this._padding.left,e),top:nc(this._padding.top,t),right:nc(this._padding.right,e),bottom:nc(this._padding.bottom,t)}),r}get controller(){const e=this.props.controller;return e?!0===e?{type:this.ControllerType}:"function"==typeof e?{type:e}:{type:this.ControllerType,...e}:null}}const Mce=(new Ve).lookAt({eye:[0,0,1]});function Dce({width:n,height:e,near:t,far:r,padding:i}){let s=-n/2,o=n/2,a=-e/2,c=e/2;if(i){const{left:l=0,right:u=0,top:d=0,bottom:h=0}=i,f=ir((l+n-u)/2,0,n)-n/2,p=ir((d+e-h)/2,0,e)-e/2;s-=f,o-=f,a+=p,c+=p}return(new Ve).ortho({left:s,right:o,bottom:a,top:c,near:t,far:r})}class Rce extends ec{constructor(e){const{width:t,height:r,near:i=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],padding:c=null,flipY:l=!0}=e,u=Array.isArray(o)?o[0]:o,d=Array.isArray(o)?o[1]:o,h=Math.min(u,d),f=Math.pow(2,h);let p;if(u!==d){const g=Math.pow(2,u),m=Math.pow(2,d);p={unitsPerMeter:[g/f,m/f,1],metersPerUnit:[f/g,f/m,1]}}super({...e,longitude:void 0,position:a,viewMatrix:Mce.clone().scale([f,f*(l?-1:1),f]),projectionMatrix:Dce({width:t||1,height:r||1,padding:c,near:i,far:s}),zoom:h,distanceScales:p})}projectFlat([e,t]){const{unitsPerMeter:r}=this.distanceScales;return[e*r[0],t*r[1]]}unprojectFlat([e,t]){const{metersPerUnit:r}=this.distanceScales;return[e*r[0],t*r[1]]}panByPosition(e,t){const r=gp(t,this.pixelUnprojectionMatrix),s=Ny([],this.projectFlat(e),hU([],r)),o=Ny([],this.center,s);return{target:this.unprojectFlat(o)}}}class _p{constructor(e){w(this,"_inProgress",void 0),w(this,"_handle",void 0),w(this,"_timeline",void 0),w(this,"time",void 0),w(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var t,r;this.cancel(),this.settings=e,this._inProgress=!0,null===(t=(r=this.settings).onStart)||void 0===t||t.call(r,this)}end(){var e,t;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(e=(t=this.settings).onEnd)||void 0===e||e.call(t,this))}cancel(){var e,t;this._inProgress&&(null===(e=(t=this.settings).onInterrupt)||void 0===e||e.call(t,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var e,t;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(e=(t=this.settings).onUpdate)||void 0===e||e.call(t,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const RU=()=>{},Oce=n=>n;class Nce{constructor(e){w(this,"getControllerState",void 0),w(this,"props",void 0),w(this,"propsInTransition",void 0),w(this,"transition",void 0),w(this,"onViewStateChange",void 0),w(this,"onStateChange",void 0),w(this,"_onTransitionUpdate",t=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:o,duration:a,easing:c}}=t,l=c(r/a),u=i.interpolateProps(s,o,l);this.propsInTransition=this.getControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new _p(e.timeline),this.onViewStateChange=e.onViewStateChange||RU,this.onStateChange=e.onStateChange||RU}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;i={...r,...2===s?o:this.propsInTransition||r}}this._triggerTransition(i,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:r}=e;return(t>0||"auto"===t)&&!!r}_isUpdateDueToCurrentTransition(e){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const r=this.getControllerState(e),i=this.getControllerState(t).shortestPathFrom(r),s=t.transitionInterpolator,o=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(0===o)return;const a=s.initializeProps(e,i);this.propsInTransition={};const c={duration:o,easing:t.transitionEasing||Oce,interpolator:s,interruption:t.transitionInterruption||1,startProps:a.start,endProps:a.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(c),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(t)}}}class kce{constructor(e){w(this,"_propsToCompare",void 0),w(this,"_propsToExtract",void 0),w(this,"_requiredProps",void 0);const{compare:t,extract:r,required:i}=e;this._propsToCompare=t,this._propsToExtract=r||t,this._requiredProps=i}arePropsEqual(e,t){for(const r of this._propsToCompare)if(!(r in e)||!(r in t)||!yd(e[r],t[r]))return!1;return!0}initializeProps(e,t){const r={},i={};for(const s of this._propsToExtract)(s in e||s in t)&&(r[s]=e[s],i[s]=t[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(t=>{const r=e[t];sr(Number.isFinite(r)||Array.isArray(r),"".concat(t," is required for transition"))})}}const Fce=["longitude","latitude","zoom","bearing","pitch"],Lce=["longitude","latitude","zoom"];class Hy extends kce{constructor(e={}){const t=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:Fce,required:Lce},super(r.transitionProps),w(this,"opts",void 0),this.opts=r}initializeProps(e,t){const r=super.initializeProps(e,t),{makeViewport:i,around:s}=this.opts;if(i&&s){const o=i(e),a=i(t),c=o.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(c),aroundPosition:c,width:t.width,height:t.height})}return r}interpolateProps(e,t,r){const i={};for(const s of this._propsToExtract)i[s]=My(e[s]||0,t[s]||0,r);if(t.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...t,...i});Object.assign(i,s.panByPosition(t.aroundPosition,My(e.around,t.around,r)))}return i}}const rc={transitionDuration:0},zy=n=>1-(1-n)*(1-n),Ad_WHEEL=["wheel"],Ad_PAN=["panstart","panmove","panend"],Ad_PINCH=["pinchstart","pinchmove","pinchend"],Ad_TRIPLE_PAN=["tripanstart","tripanmove","tripanend"],Ad_DOUBLE_TAP=["doubletap"],Ad_KEYBOARD=["keydown"],ul={};class gT{constructor(e){w(this,"props",void 0),w(this,"state",{}),w(this,"transitionManager",void 0),w(this,"eventManager",void 0),w(this,"onViewStateChange",void 0),w(this,"onStateChange",void 0),w(this,"makeViewport",void 0),w(this,"_controllerState",void 0),w(this,"_events",{}),w(this,"_interactionState",{isDragging:!1}),w(this,"_customEvents",[]),w(this,"_eventStartBlocked",null),w(this,"_panMove",!1),w(this,"invertPan",!1),w(this,"dragMode","rotate"),w(this,"inertia",0),w(this,"scrollZoom",!0),w(this,"dragPan",!0),w(this,"dragRotate",!0),w(this,"doubleClickZoom",!0),w(this,"touchZoom",!0),w(this,"touchRotate",!1),w(this,"keyboard",!0),this.transitionManager=new Nce({...e,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const t in this._events)if(this._events[t]){var e;null===(e=this.eventManager)||void 0===e||e.off(t,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return!t&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!t&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!t&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:t,y:r}=this.props,{offsetCenter:i}=e;return[i.x-t,i.y-r]}isPointInBounds(e,t){const{width:r,height:i}=this.props;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:!0===t?300:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:c=!1,keyboard:l=!0}=e,u=!!this.onViewStateChange;this.toggleEvents(Ad_WHEEL,u&&r),this.toggleEvents(Ad_PAN,u&&(i||s)),this.toggleEvents(Ad_PINCH,u&&(a||c)),this.toggleEvents(Ad_TRIPLE_PAN,u&&c),this.toggleEvents(Ad_DOUBLE_TAP,u&&o),this.toggleEvents(Ad_KEYBOARD,u&&l),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=c,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(r=>{this._events[r]!==t&&(this._events[r]=t,t?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,t=null,r={}){const i={...e.getViewportProps(),...t},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:t});return this._panMove=r,this.updateViewport(i,rc,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),r=this.controllerState.pan({pos:t});return this.updateViewport(r,rc,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const r=this.getCenter(e),s=this.controllerState.pan({pos:[r[0]+e.velocityX*t/2,r[1]+e.velocityY*t/2]}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:zy},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),r=this.controllerState.rotate({pos:t});return this.updateViewport(r,rc,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const r=this.getCenter(e),s=this.controllerState.rotate({pos:[r[0]+e.velocityX*t/2,r[1]+e.velocityY*t/2]}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:zy},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const{speed:r=.01,smooth:i=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*r)));s<0&&0!==o&&(o=1/o);const a=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:t}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const r=this.controllerState.rotateStart({pos:t});return this.updateViewport(r,rc,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const r=this.controllerState.rotate({pos:t});return this.updateViewport(r,rc,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:zy},{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const r=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return ul._startPinchRotation=e.rotation,ul._lastPinchEvent=e,this.updateViewport(r,rc,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);t=t.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;t=t.rotate({deltaAngleX:ul._startPinchRotation-r})}return this.updateViewport(t,rc,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),ul._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:r}=ul;if(this.touchZoom&&t&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),c=Math.pow(2,o+a*t/2);s=s.zoom({pos:i,scale:c}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:t,transitionEasing:zy},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return ul._startPinchRotation=null,ul._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:t,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:o}=!0===this.keyboard?{}:this.keyboard,{controllerState:a}=this;let c;const l={};switch(e.srcEvent.code){case"Minus":c=t?a.zoomOut(r).zoomOut(r):a.zoomOut(r),l.isZooming=!0;break;case"Equal":c=t?a.zoomIn(r).zoomIn(r):a.zoomIn(r),l.isZooming=!0;break;case"ArrowLeft":t?(c=a.rotateLeft(s),l.isRotating=!0):(c=a.moveLeft(i),l.isPanning=!0);break;case"ArrowRight":t?(c=a.rotateRight(s),l.isRotating=!0):(c=a.moveRight(i),l.isPanning=!0);break;case"ArrowUp":t?(c=a.rotateUp(o),l.isRotating=!0):(c=a.moveUp(i),l.isPanning=!0);break;case"ArrowDown":t?(c=a.rotateDown(o),l.isRotating=!0):(c=a.moveDown(i),l.isPanning=!0);break;default:return!1}return this.updateViewport(c,this._getTransitionProps(),l),!0}_getTransitionProps(e){const{transition:t}=this;return t&&t.transitionInterpolator?e?{...t,transitionInterpolator:new Hy({...e,...t.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:t:rc}}class OU{constructor(e,t){w(this,"_viewportProps",void 0),w(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}class PU extends OU{constructor(e){const{width:t,height:r,rotationX:i=0,rotationOrbit:s=0,target:o=[0,0,0],zoom:a=0,minRotationX:c=-90,maxRotationX:l=90,minZoom:u=-1/0,maxZoom:d=1/0,startPanPosition:h,startRotatePos:f,startRotationX:p,startRotationOrbit:g,startZoomPosition:m,startZoom:y}=e;super({width:t,height:r,rotationX:i,rotationOrbit:s,target:o,zoom:a,minRotationX:c,maxRotationX:l,minZoom:u,maxZoom:d},{startPanPosition:h,startRotatePos:f,startRotationX:p,startRotationOrbit:g,startZoomPosition:m,startZoom:y}),w(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:t}){const r=this.getState().startPanPosition||t;if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:r=0}){const{startRotatePos:i,startRotationX:s,startRotationOrbit:o}=this.getState(),{width:a,height:c}=this.getViewportProps();if(!i||void 0===s||void 0===o)return this;let l;if(e){let u=(e[0]-i[0])/a;(s<-90||s>90)&&(u*=-1),l={rotationX:s+(e[1]-i[1])/c*180,rotationOrbit:o+180*u}}else l={rotationX:s+r,rotationOrbit:o+t};return this._getUpdatedState(l)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const t=e.getViewportProps(),r={...this.getViewportProps()},{rotationOrbit:i}=r;return Math.abs(i-t.rotationOrbit)>180&&(r.rotationOrbit=i<0?i+360:i-360),r}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:t,scale:r}){let{startZoom:i,startZoomPosition:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(t)||this._unproject(e)),!s)return this;const o=this._calculateNewZoom({scale:r,startZoom:i}),a=this.makeViewport({...this.getViewportProps(),zoom:o});return this._getUpdatedState({zoom:o,...a.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:r,minZoom:i}=this.getViewportProps();return void 0===t&&(t=this.getViewportProps().zoom),ir(t+Math.log2(e),i,r)}_panFromCenter(e){const{width:t,height:r,target:i}=this.getViewportProps();return this.pan({startPosition:i,pos:[t/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){const{maxZoom:t,minZoom:r,zoom:i,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=Array.isArray(i)?[ir(i[0],r,t),ir(i[1],r,t)]:ir(i,r,t),e.rotationX=ir(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=function Sae(n,e){const t=n%e;return t<0?e+t:t}(a+180,360)-180),e}}class Uce extends gT{constructor(...e){super(...e),w(this,"ControllerState",PU),w(this,"transition",{transitionDuration:300,transitionInterpolator:new Hy({transitionProps:{compare:["target","zoom","rotationX","rotationOrbit"],required:["target","zoom"]}})})}}class jce extends PU{constructor(e){super(e),w(this,"zoomAxis",void 0),this.zoomAxis=e.zoomAxis||"all"}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:r,minZoom:i}=this.getViewportProps();void 0===t&&(t=this.getViewportProps().zoom);let s=Math.log2(e);if(Array.isArray(t)){let[o,a]=t;switch(this.zoomAxis){case"X":o=ir(o+s,i,r);break;case"Y":a=ir(a+s,i,r);break;default:let c=Math.min(o+s,a+s);c<i&&(s+=i-c),c=Math.max(o+s,a+s),c>r&&(s+=r-c),o+=s,a+=s}return[o,a]}return ir(t+s,i,r)}}class Vce extends gT{constructor(...e){super(...e),w(this,"ControllerState",jce),w(this,"transition",{transitionDuration:300,transitionInterpolator:new Hy(["target","zoom"])}),w(this,"dragMode","pan")}_onPanRotate(){return!1}}class mT extends fT{get ViewportType(){return Rce}get ControllerType(){return Vce}}w(mT,"displayName","OrthographicView");const _T=Math.PI/180;function Hce({height:n,focalDistance:e,orbitAxis:t,rotationX:r,rotationOrbit:i,zoom:s}){const o="Z"===t?[0,0,1]:[0,1,0],a="Z"===t?[0,-e,0]:[0,0,e],c=(new Ve).lookAt({eye:a,up:o});c.rotateX(r*_T),"Z"===t?c.rotateZ(i*_T):c.rotateY(i*_T);const l=Math.pow(2,s)/n;return c.scale(l),c}class zce extends ec{constructor(e){const{height:t,projectionMatrix:r,fovy:i=50,orbitAxis:s="Z",target:o=[0,0,0],rotationX:a=0,rotationOrbit:c=0,zoom:l=0}=e,u=r?r[5]/2:dT(i);super({...e,longitude:void 0,viewMatrix:Hce({height:t||1,focalDistance:u,orbitAxis:s,rotationX:a,rotationOrbit:c,zoom:l}),fovy:i,focalDistance:u,position:o,zoom:l}),w(this,"projectedCenter",void 0),this.projectedCenter=this.project(this.center)}unproject(e,{topLeft:t=!0}={}){const[r,i,s=this.projectedCenter[2]]=e,o=t?i:this.height-i,[a,c,l]=gp([r,o,s],this.pixelUnprojectionMatrix);return[a,c,l]}panByPosition(e,t){const r=this.project(e);return{target:this.unproject([this.width/2+r[0]-t[0],this.height/2+r[1]-t[1],this.projectedCenter[2]])}}}class NU extends fT{constructor(e={}){super(e),this.props.orbitAxis=e.orbitAxis||"Z"}get ViewportType(){return zce}get ControllerType(){return Uce}}w(NU,"displayName","OrbitView");const yp="vs",yT="fs";function Ci(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const vT={number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},array:{validate:(n,e)=>Array.isArray(n)||ArrayBuffer.isView(n)}};function Wce(n){let e=kU(n);return"object"===e?n?"type"in n?Object.assign({},n,vT[n.type]):"value"in n?(e=kU(n.value),Object.assign({type:e},n,vT[e])):{type:"object",value:n}:{type:"object",value:null}:Object.assign({type:e,value:n},vT[e])}function kU(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}class bT{constructor(e){let{name:t,vs:r,fs:i,dependencies:s=[],uniforms:o,getUniforms:a,deprecations:c=[],defines:l={},inject:u={},vertexShader:d,fragmentShader:h}=e;Ci("string"==typeof t),this.name=t,this.vs=r||d,this.fs=i||h,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(c),this.defines=l,this.injections=function Xce(n){const e={vs:{},fs:{}};for(const t in n){let r=n[t];"string"==typeof r&&(r={order:0,injection:r}),e[t.slice(0,2)][t]=r}return e}(u),o&&(this.uniforms=function Gce(n){const e={};for(const t in n){const i=Wce(n[t]);e[t]=i}return e}(o))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:Ci(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(t,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?t.deprecated(r.old,r.new)():t.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(t=>{t.regex="function"===t.type?new RegExp("\\b".concat(t.old,"\\(")):new RegExp("".concat(t.type," ").concat(t.old,";"))}),e}_defaultGetUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&Ci(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),t[i]=e[i]):t[i]=s.value}return t}}function Yce(n){return function FU(n){const e={},t={};return wT({modules:n,level:0,moduleMap:e,moduleDepth:t}),Object.keys(t).sort((r,i)=>t[i]-t[r]).map(r=>e[r])}(LU(n))}function wT(n){let{modules:e,level:t,moduleMap:r,moduleDepth:i}=n;if(t>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(void 0===i[s.name]||i[s.name]<t)&&(i[s.name]=t);for(const s of e)s.dependencies&&wT({modules:s.dependencies,level:t+1,moduleMap:r,moduleDepth:i})}function LU(n,e){return n.map(t=>(t instanceof bT||(Ci("string"!=typeof t,"Shader module use by name is deprecated. Import shader module '".concat(t,"' and use it directly.")),Ci(t.name,"shader module has no name"),(t=new bT(t)).dependencies=LU(t.dependencies)),t))}const ET={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},dl={};function rle(n,e){return n.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":n.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":n.match(/AMD/i)||e.match(/AMD/i)||n.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}Object.keys(ET).forEach(n=>{dl[n]=n});const CT={};function BU(n,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=ET[e];if(Ci(r,e),!function Zce(){const e=typeof window<"u"&&window.navigator||{},t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).userAgent||e.userAgent||"",r=-1!==t.indexOf("MSIE "),i=-1!==t.indexOf("Trident/");return r||i}(t))return!0;if(e in CT)return CT[e];const s=t.behavior||"enable",o="#extension GL_".concat(r[0]," : ").concat(s,"\nvoid main(void) {}"),a=n.createShader(35633);n.shaderSource(a,o),n.compileShader(a);const c=n.getShaderParameter(a,35713);return n.deleteShader(a),CT[e]=c,c}function Gy(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>function ile(n,e){const t=ET[e];Ci(t,e);const r=function tle(n){return typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext||!(!n||2!==n._version)}(n)&&t[1]||t[0],i="string"==typeof r?!!n.getExtension(r):r;return Ci(!1===i||!0===i),i}(n,t))}const lle={[yp]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[yT]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},Wy="__LUMA_INJECT_DECLARATIONS__",UU=/void\s+main\s*\([^)]*\)\s*\{\n?/,jU=/}\n?[^{}]*$/,AT=[];function VU(n,e,t){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=e===yp;for(const s in t){const o=t[s];o.sort((c,l)=>c.order-l.order),AT.length=o.length;for(let c=0,l=o.length;c<l;++c)AT[c]=o[c].injection;const a="".concat(AT.join("\n"),"\n");switch(s){case"vs:#decl":i&&(n=n.replace(Wy,a));break;case"vs:#main-start":i&&(n=n.replace(UU,c=>c+a));break;case"vs:#main-end":i&&(n=n.replace(jU,c=>a+c));break;case"fs:#decl":i||(n=n.replace(Wy,a));break;case"fs:#main-start":i||(n=n.replace(UU,c=>c+a));break;case"fs:#main-end":i||(n=n.replace(jU,c=>a+c));break;default:n=n.replace(s,c=>c+a)}}return n=n.replace(Wy,""),r&&(n=n.replace(/\}\s*$/,s=>s+lle[e])),n}function TT(n){const e={};return Ci(Array.isArray(n)&&n.length>1),n.forEach(t=>{for(const r in t)e[r]=e[r]?"".concat(e[r],"\n").concat(t[r]):t[r]}),e}function Td(n){return new RegExp("\\b".concat(n,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const HU=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],ule=[...HU,[Td("attribute"),"in $1"],[Td("varying"),"out $1"]],dle=[...HU,[Td("varying"),"in $1"]],zU=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],hle=[...zU,[Td("in"),"attribute $1"],[Td("out"),"varying $1"]],fle=[...zU,[Td("in"),"varying $1"]],xT="gl_FragColor",ST=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,ple=/void\s+main\s*\([^)]*\)\s*\{\n?/;function $y(n,e){for(const[t,r]of e)n=n.replace(t,r);return n}const yle="\n\n".concat(Wy,"\n\n"),GU={[yp]:"vertex",[yT]:"fragment"};function WU(n,e){let{id:t,source:r,type:i,modules:s,defines:o={},hookFunctions:a=[],inject:c={},transpileToGLSL100:l=!1,prologue:u=!0,log:d}=e;Ci("string"==typeof r,"shader source must be a string");const h=i===yp,f=r.split("\n");let p=100,g="",m=r;0===f[0].indexOf("#version ")?(p=300,g=f[0],m=f.slice(1).join("\n")):g="#version ".concat(p);const y={};s.forEach(D=>{Object.assign(y,D.getDefines())}),Object.assign(y,o);let v=u?"".concat(g,"\n").concat(function Cle(n){let{id:e,source:t,type:r}=n;return e&&"string"==typeof e&&-1===t.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(e,"_").concat(GU[r],"\n\n"):""}({id:t,source:r,type:i}),"\n").concat(function Ele(n){let{type:e}=n;return"\n#define SHADER_TYPE_".concat(GU[e].toUpperCase(),"\n")}({type:i}),"\n").concat(function sle(n){switch(function nle(n){const e=n.getExtension("WEBGL_debug_renderer_info"),t=n.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),r=n.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:rle(t,r),vendor:t,renderer:r,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(n),"\n").concat(function ole(n){let r="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return Gy(n,dl.GLSL_FRAG_DEPTH)&&(r+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),Gy(n,dl.GLSL_DERIVATIVES)&&BU(n,dl.GLSL_DERIVATIVES)&&(r+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),Gy(n,dl.GLSL_FRAG_DATA)&&BU(n,dl.GLSL_FRAG_DATA,{behavior:"require"})&&(r+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),Gy(n,dl.GLSL_TEXTURE_LOD)&&(r+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),r}(n),"\n").concat(function Ale(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=0,t="";for(const r in n){0===e&&(t+="\n// APPLICATION DEFINES\n"),e++;const i=n[r];(i||Number.isFinite(i))&&(t+="#define ".concat(r.toUpperCase()," ").concat(n[r],"\n"))}return 0===e&&(t+="\n"),t}(y),"\n").concat(h?"":"precision highp float;\n\n","\n"):"".concat(g,"\n");const _=function xle(n){const e={vs:{},fs:{}};return n.forEach(t=>{let r;"string"!=typeof t?(r=t,t=r.hook):r={},t=t.trim();const[i,s]=t.split(":"),o=t.replace(/\(.+/,"");e[i][o]=Object.assign(r,{signature:s})}),e}(a),E={},T={},I={};for(const D in c){const M="string"==typeof c[D]?{injection:c[D],order:0}:c[D],k=D.match(/^(v|f)s:(#)?([\w-]+)$/);k?k[2]?"decl"===k[3]?T[D]=[M]:I[D]=[M]:E[D]=[M]:I[D]=[M]}for(const D of s){d&&D.checkDeprecations(m,d),v+=D.getModuleSource(i,p);const k=D.injections[i];for(const B in k){const L=B.match(/^(v|f)s:#([\w-]+)$/);if(L){const R="decl"===L[2]?T:I;R[B]=R[B]||[],R[B].push(k[B])}else E[B]=E[B]||[],E[B].push(k[B])}}return v+=yle,v=VU(v,i,T),v+=function Tle(n,e){let t="";for(const r in n){const i=n[r];if(t+="void ".concat(i.signature," {\n"),i.header&&(t+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((o,a)=>o.order-a.order);for(const o of s)t+="  ".concat(o.injection,"\n")}i.footer&&(t+="  ".concat(i.footer)),t+="}\n"}return t}(_[i],E),v+=m,v=VU(v,i,I),v=function gle(n,e,t){switch(e){case 300:return t?$y(n,ule):function mle(n){const e=(n=$y(n,dle)).match(ST);if(e){const t=e[1];n=n.replace(new RegExp("\\b".concat(xT,"\\b"),"g"),t)}else{const t="fragmentColor";n=n.replace(ple,r=>"out vec4 ".concat(t,";\n").concat(r)).replace(new RegExp("\\b".concat(xT,"\\b"),"g"),t)}return n}(n);case 100:return t?$y(n,hle):function _le(n){const e=(n=$y(n,fle)).match(ST);if(e){const t=e[1];n=n.replace(ST,"").replace(new RegExp("\\b".concat(t,"\\b"),"g"),xT)}return n}(n);default:throw new Error("unknown GLSL version ".concat(e))}}(v,l?100:p,h),v}function wle(n){return function(t){const r={};for(const i of n){const s=i.getUniforms(t,r);Object.assign(r,s)}return r}}const ue=new up({id:"luma.gl"});function Hr(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function qy(n){return typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext||!(!n||!Number.isFinite(n._version))}function Xe(n){return typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext||!(!n||2!==n._version)}function Xy(n){return Hr(qy(n),"Invalid WebGLRenderingContext"),n}function Er(n){return Hr(Xe(n),"Requires WebGL2"),n}const vp={};const bp=function n(e){const t=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new n.VertexAttrib(t);this.attribs[r]=i}this.maxAttrib=0};(bp.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const hl=function(e){const t=this;this.gl=e,function Ple(n){const e=n.getError;n.getError=function(){let r;do{r=e.apply(n),0!==r&&(vp[r]=!0)}while(0!==r);for(r in vp)if(vp[r])return delete vp[r],parseInt(r,10);return 0}}(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;return o.maxAttrib=Math.max(o.maxAttrib,s),o.attribs[s].enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;return o.maxAttrib=Math.max(o.maxAttrib,s),o.attribs[s].enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:t.currentArrayBuffer=o;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=o}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const c=t.currentVertexArrayObject.attribs[s];switch(o){case 34975:return c.buffer;case 34338:return c.enabled;case 34339:return c.size;case 34340:return c.stride;case 34341:return c.type;case 34922:return c.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,c,l,u){const d=t.currentVertexArrayObject;d.maxAttrib=Math.max(d.maxAttrib,s);const h=d.attribs[s];return h.buffer=t.currentArrayBuffer,h.size=o,h.type=a,h.normalized=c,h.stride=l,h.offset=u,h.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{(function Rle(n){globalThis.console&&globalThis.console.log&&globalThis.console.log(n)})("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};hl.prototype.VERTEX_ARRAY_BINDING_OES=34229,hl.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new bp(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},hl.prototype.createVertexArrayOES=function(){const e=new bp(this);return this.vertexArrayObjects.push(e),e},hl.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},hl.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof bp&&e.hasBeenBound&&e.ext===this)},hl.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void function Ole(n,e){vp[n]=!0,void 0!==e&&function Dle(n){globalThis.console&&globalThis.console.error&&globalThis.console.error(n)}(e)}(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(t,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let c=0;c<=a;c++){const l=s.attribs[c],u=i?i.attribs[c]:null;if((!i||l.enabled!==u.enabled)&&(l.enabled?r.enableVertexAttribArray.call(t,c):r.disableVertexAttribArray.call(t,c)),l.enabled){let d=!1;(!i||l.buffer!==u.buffer)&&(o!==l.buffer&&(r.bindBuffer.call(t,34962,l.buffer),o=l.buffer),d=!0),(d||l.cached!==u.cached)&&r.vertexAttribPointer.call(t,c,l.size,l.type,l.normalized,l.stride,l.offset)}}this.currentArrayBuffer!==o&&r.bindBuffer.call(t,34962,this.currentArrayBuffer)};const $U="OES_element_index",qU="WEBGL_draw_buffers",XU="WEBGL_debug_renderer_info",Ble=35723,jle=36795,Vle=34047,Hle=37445,zle=37446,Wt=n=>Xe(n)?void 0:0,Gle={3074:n=>Xe(n)?void 0:36064,[Ble]:n=>Xe(n)?void 0:4352,35977:Wt,32937:Wt,[jle]:(n,e)=>{const t=Xe(n)?n.getExtension("EXT_disjoint_timer_query_webgl2"):n.getExtension("EXT_disjoint_timer_query");return t&&t.GPU_DISJOINT_EXT?e(t.GPU_DISJOINT_EXT):0},[Hle]:(n,e)=>{const t=n.getExtension(XU);return e(t&&t.UNMASKED_VENDOR_WEBGL||7936)},[zle]:(n,e)=>{const t=n.getExtension(XU);return e(t&&t.UNMASKED_RENDERER_WEBGL||7937)},[Vle]:(n,e)=>{const t=n.luma.extensions.EXT_texture_filter_anisotropic;return t?e(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Wt,35071:Wt,37447:Wt,36063:(n,e)=>{if(!Xe(n)){const t=n.getExtension(qU);return t?e(t.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Wt,35374:Wt,35377:Wt,34852:n=>{if(!Xe(n)){const e=n.getExtension(qU);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:n=>n.getExtension($U)?2147483647:65535,33001:n=>n.getExtension($U)?16777216:65535,33e3:n=>16777216,37157:Wt,35373:Wt,35657:Wt,36183:Wt,37137:Wt,34045:Wt,35978:Wt,35979:Wt,35968:Wt,35376:Wt,35375:Wt,35659:Wt,37154:Wt,35371:Wt,35658:Wt,35076:Wt,35077:Wt,35380:Wt},$le="OES_vertex_array_object",YU="ANGLE_instanced_arrays",qle="WEBGL_draw_buffers",Xle="EXT_disjoint_timer_query",ZU={[$le]:{meta:{suffix:"OES"},createVertexArray:()=>{Hr(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[YU]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(n,e){Hr(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[qle]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Hr(!1)}},[Xle]:{meta:{suffix:"EXT"},createQuery:()=>{Hr(!1)},deleteQuery:()=>{Hr(!1)},beginQuery:()=>{Hr(!1)},endQuery:()=>{},getQuery(n,e){return this.getQueryObject(n,e)},getQueryParameter(n,e){return this.getQueryObject(n,e)},getQueryObject:()=>{}}},IT={readBuffer:(n,e,t)=>{Xe(n)&&e(t)},getVertexAttrib:(n,e,t,r)=>{const{webgl2:i,ext:s}=function Kle(n,e){return{webgl2:Xe(n),ext:n.getExtension(e)}}(n,YU);let o;switch(r){case 35069:o=!!i&&void 0;break;case 35070:o=i||s?void 0:0}return void 0!==o?o:e(t,r)},getProgramParameter:(n,e,t,r)=>{if(!Xe(n))switch(r){case 35967:return 35981;case 35971:case 35382:return 0}return e(t,r)},getInternalformatParameter:(n,e,t,r,i)=>Xe(n)||32937!==i?n.getInternalformatParameter(t,r,i):new Int32Array([0]),getTexParameter(n,e,t,r){if(34046===r){const{extensions:i}=n.luma,s=i.EXT_texture_filter_anisotropic;r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(t,r)},getParameter:function Wle(n,e,t){const r=Gle[t],i="function"==typeof r?r(n,e,t):r;return void 0!==i?i:e(t)},hint:(n,e,t,r)=>e(t,r)};function nue(n,e){let{extension:t,target:r,target2:i}=e;const s=ZU[t];Hr(s);const{meta:o={}}=s,{suffix:a=""}=o,c=n.getExtension(t);for(const l of Object.keys(s)){const u="".concat(l).concat(a);let d=null;"meta"===l||"function"==typeof n[l]||(c&&"function"==typeof c[u]?d=function(){return c[u](...arguments)}:"function"==typeof s[l]&&(d=s[l].bind(r))),d&&(r[l]=d,i[l]=d)}}globalThis.polyfillContext=function Jle(n){n.luma=n.luma||{};const{luma:e}=n;return e.polyfilled||(function Nle(n){if("function"==typeof n.createVertexArray)return;const e=n.getSupportedExtensions;n.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const t=n.getExtension;n.getExtension=function(i){return t.call(this,i)||("OES_vertex_array_object"!==i?null:(n.__OESVertexArrayObject||(this.__OESVertexArrayObject=new hl(this)),this.__OESVertexArrayObject))}}(n),function Qle(n){n.luma.extensions={};const e=n.getSupportedExtensions()||[];for(const t of e)n.luma[t]=n.getExtension(t)}(n),function tue(n,e){for(const t of Object.getOwnPropertyNames(e))"overrides"!==t&&nue(n,{extension:t,target:n.luma,target2:n})}(n,ZU),function eue(n,e){let{target:t,target2:r}=e;Object.keys(IT).forEach(i=>{if("function"==typeof IT[i]){const s=n[i]?n[i].bind(n):()=>{},o=IT[i].bind(null,n,s);t[i]=o,r[i]=o}})}(n,{target:e,target2:n}),e.polyfilled=!0),n};const MT={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},ic=(n,e,t)=>e?n.enable(t):n.disable(t),KU=(n,e,t)=>n.hint(t,e),Ai=(n,e,t)=>n.pixelStorei(t,e);function wp(n){return Array.isArray(n)||ArrayBuffer.isView(n)}const sue={3042:ic,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:ic,2885:(n,e)=>n.cullFace(e),2929:ic,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:ic,35723:KU,36006:(n,e)=>{const t=Xe(n)?36009:36160;return n.bindFramebuffer(t,e)},2886:(n,e)=>n.frontFace(e),33170:KU,2849:(n,e)=>n.lineWidth(e),32823:ic,32824:"polygonOffset",10752:"polygonOffset",35977:ic,32938:"sampleCoverage",32939:"sampleCoverage",3089:ic,3088:(n,e)=>n.scissor(...e),2960:ic,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),3333:Ai,3317:Ai,37440:Ai,37441:Ai,37443:Ai,3330:Ai,3332:Ai,3331:Ai,36010:(n,e)=>n.bindFramebuffer(36008,e),3314:Ai,32878:Ai,3316:Ai,3315:Ai,32877:Ai,framebuffer:(n,e)=>n.bindFramebuffer(36160,e&&"handle"in e?e.handle:e),blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{e=wp(e)?e:[e,e],n.blendEquationSeparate(...e)},blendFunc:(n,e)=>{e=wp(e)&&2===e.length?[...e,...e]:e,n.blendFuncSeparate(...e)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(...e),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=wp(e)?e:[e,e];const[t,r]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,r)},stencilFunc:(n,e)=>{e=wp(e)&&3===e.length?[...e,...e]:e;const[t,r,i,s,o,a]=e;n.stencilFuncSeparate(1028,t,r,i),n.stencilFuncSeparate(1029,s,o,a)},stencilOp:(n,e)=>{e=wp(e)&&3===e.length?[...e,...e]:e;const[t,r,i,s,o,a]=e;n.stencilOpSeparate(1028,t,r,i),n.stencilOpSeparate(1029,s,o,a)},viewport:(n,e)=>n.viewport(...e)};function mn(n,e,t){return void 0!==e[n]?e[n]:t[n]}const oue={blendEquation:(n,e,t)=>n.blendEquationSeparate(mn(32777,e,t),mn(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(mn(32969,e,t),mn(32968,e,t),mn(32971,e,t),mn(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(mn(32824,e,t),mn(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(mn(32938,e,t),mn(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,mn(2962,e,t),mn(2967,e,t),mn(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,mn(34816,e,t),mn(36003,e,t),mn(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,mn(2964,e,t),mn(2965,e,t),mn(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,mn(34817,e,t),mn(34818,e,t),mn(34819,e,t))},JU={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},blendColor:(n,e,t,r,i)=>n({32773:new Float32Array([e,t,r,i])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,r,i)=>n({32969:e,32968:t,32971:r,32970:i}),clearColor:(n,e,t,r,i)=>n({3106:new Float32Array([e,t,r,i])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,r,i)=>n({3107:[e,t,r,i]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,r,i)=>n({3088:new Int32Array([e,t,r,i])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[1028===e?2968:36005]:t}),stencilFunc:(n,e,t,r)=>n({2962:e,2967:t,2963:r,34816:e,36003:t,36004:r}),stencilFuncSeparate:(n,e,t,r,i)=>n({[1028===e?2962:34816]:t,[1028===e?2967:36003]:r,[1028===e?2963:36004]:i}),stencilOp:(n,e,t,r)=>n({2964:e,2965:t,2966:r,34817:e,34818:t,34819:r}),stencilOpSeparate:(n,e,t,r,i)=>n({[1028===e?2964:34817]:t,[1028===e?2965:34818]:r,[1028===e?2966:34819]:i}),viewport:(n,e,t,r,i)=>n({2978:[e,t,r,i]})},to=(n,e)=>n.isEnabled(e),QU={3042:to,2884:to,2929:to,3024:to,32823:to,32926:to,32928:to,3089:to,2960:to,35977:to};function e3(n){for(const e in n)return!1;return!0}function aue(n,e){if(n===e)return!0;const t=Array.isArray(n)||ArrayBuffer.isView(n),r=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&r&&n.length===e.length){for(let i=0;i<n.length;++i)if(n[i]!==e[i])return!1;return!0}return!1}function t3(n,e){const t=n[e].bind(n);n[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in n.state.cache&&n.state.enable?n.state.cache[i]:t(...arguments)},Object.defineProperty(n[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function cue(n,e,t){const r=n[e].bind(n);n[e]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const{valueChanged:c,oldValue:l}=t(n.state._updateCache,...o);return c&&r(...o),l},Object.defineProperty(n[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}class uue{constructor(e){let{copyState:t=!1,log:r=()=>{}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?function hue(n,e){if("number"==typeof(e=e||MT)){const i=e,s=QU[i];return s?s(n,i):n.getParameter(i)}const t=Array.isArray(e)?e:Object.keys(e),r={};for(const i of t){const s=QU[i];r[i]=s?s(n,Number(i)):n.getParameter(Number(i))}return r}(e):Object.assign({},MT),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Hr(this.stateStack.length>0),Ko(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(e){let r,t=!1;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Hr(void 0!==s);const o=e[s],a=this.cache[s];aue(o,a)||(t=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=o)}return{valueChanged:t,oldValue:r}}}function n3(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{enable:t=!0,copyState:r}=e;if(Hr(void 0!==r),!n.state){const{polyfillContext:i}=globalThis;i&&i(n),n.state=new uue(n,{copyState:r}),function lue(n){const e=n.useProgram.bind(n);n.useProgram=function(r){n.state.program!==r&&(e(r),n.state.program=r)}}(n);for(const s in JU)cue(n,s,JU[s]);t3(n,"getParameter"),t3(n,"isEnabled")}return n.state.enable=t,n}function r3(n){Hr(n.state),n.state.pop()}function Ko(n,e){if(Hr(qy(n),"setParameters requires a WebGL context"),e3(e))return;const t={};for(const i in e){const s=Number(i),o=sue[i];o&&("string"==typeof o?t[o]=!0:o(n,e[i],s))}const r=n.state&&n.state.cache;if(r)for(const i in t)(0,oue[i])(n,e,r)}function $i(n,e,t){if(e3(e))return t(n);const{nocatch:r=!0}=e;let i;if(function due(n){n.state||n3(n,{copyState:!1}),n.state.push()}(n),Ko(n,e),r)i=t(n),r3(n);else try{i=t(n)}finally{r3(n)}return i}function xd(n){const{luma:e}=n;if(n.canvas&&e){const t=e.canvasSizeInfo,r="clientWidth"in t?t.clientWidth:n.canvas.clientWidth;return r?n.drawingBufferWidth/r:1}return 1}function DT(n,e){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function gue(n,e,t,r,i){const s=s3(n[0],e,t);let o=o3(n[1],e,r,i),a=s3(n[0]+1,e,t);const c=a===t-1?a:a-1;let l;return a=o3(n[1]+1,e,r,i),i?(a=0===a?a:a+1,l=o,o=a):l=a===r-1?a:a-1,{x:s,y:o,width:Math.max(c-s+1,1),height:Math.max(l-o+1,1)}}(e,xd(n),n.drawingBufferWidth,n.drawingBufferHeight,t)}function s3(n,e,t){return Math.min(Math.round(n*e),t-1)}function o3(n,e,t,r){return r?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}const RT=Js(),mue=RT&&typeof document<"u",a3={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function c3(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Hr(RT,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),n=Object.assign({},a3,n);const{width:e,height:t}=n;function r(a){if(n.throwOnError)throw new Error(a);return console.error(a),null}let i;n.onError=r;const{canvas:s}=n,o=function bue(n){let s,{canvas:e,width:t=800,height:r=600,onError:i}=n;return"string"==typeof e?(mue&&"complete"===document.readyState||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(t)?"".concat(t,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}({canvas:s,width:e,height:t,onError:r});return i=function vue(n,e){const{onError:t}=e;let r=null;const i=c=>r=c.statusMessage||r;n.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||n.getContext("webgl2",e),a=a||n.getContext("experimental-webgl2",e)),s&&(a=a||n.getContext("webgl",e),a=a||n.getContext("experimental-webgl",e)),n.removeEventListener("webglcontextcreationerror",i,!1),a?(e.onContextLost&&n.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&n.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):t("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}(o,n),i?(i=OT(i,n),function wue(n){const e=Xe(n)?"WebGL2":"WebGL1",t=function _ue(n){const e=n.getParameter(7936),t=n.getParameter(7937),r=n.getExtension("WEBGL_debug_renderer_info");return{vendor:r&&n.getParameter(r.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:r&&n.getParameter(r.UNMASKED_RENDERER_WEBGL||7937)||t,vendorMasked:e,rendererMasked:t,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n),r=t?"(".concat(t.vendor,",").concat(t.renderer,")"):"",i=n.debug?" debug":"";ue.info(1,"".concat(e).concat(i," context ").concat(r))()}(i),i):null}function OT(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!n||n._instrumented)return n;n._version=n._version||function Eue(n){return typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext?2:1}(n),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{},e=Object.assign({},a3,e);const{manageState:t,debug:r}=e;return t&&n3(n,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ue.log(1,...s)()}}),RT&&r&&(globalThis.makeDebugContext?(n=globalThis.makeDebugContext(n,e),ue.level=Math.max(ue.level,1)):ue.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),n._instrumented=!0,n}function l3(){let n;if(typeof window<"u"&&window.performance)n=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}class u3{constructor(e,t){w(this,"name",void 0),w(this,"type",void 0),w(this,"sampleSize",1),w(this,"time",void 0),w(this,"count",void 0),w(this,"samples",void 0),w(this,"lastTiming",void 0),w(this,"lastSampleTime",void 0),w(this,"lastSampleCount",void 0),w(this,"_count",0),w(this,"_time",0),w(this,"_samples",0),w(this,"_startTime",0),w(this,"_timerPending",!1),this.name=e,this.type=t,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=l3(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(l3()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class PT{constructor(e){w(this,"id",void 0),w(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){return this._getOrCreate({name:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count"})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(t=>this._getOrCreate(t))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:r}=e;return this.stats[t]||(this.stats[t]=e instanceof u3?e:new u3(t,r)),this.stats[t]}}const Ep="8.5.21",fl=new class Tue{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new PT({id:e})),this.stats.get(e)}};if(globalThis.luma&&globalThis.luma.VERSION!==Ep)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Ep));function te(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function NT(n,e){if("string"!=typeof e)return e;const t=Number(e);if(!isNaN(t))return t;const r=n[e=e.replace(/^.*\./,"")];return te(void 0!==r,"Accessing undefined constant GL.".concat(e)),r}function sc(n,e){e=Number(e);for(const t in n)if(n[t]===e)return"GL.".concat(t);return String(e)}globalThis.luma||(Js()&&ue.log(1,"luma.gl ".concat(Ep," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),globalThis.luma=globalThis.luma||{VERSION:Ep,version:Ep,log:ue,stats:fl,globals:{modules:{},nodeIO:{}}}),globalThis;const kT={};function ai(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";kT[n]=kT[n]||1;const e=kT[n]++;return"".concat(n,"-").concat(e)}function d3(n){return te("number"==typeof n,"Input must be a number"),n&&!(n&n-1)}function Sd(n){let e=!0;for(const t in n){e=!1;break}return e}function h3(n,e,t,r){const i="See luma.gl ".concat(t," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(n);r.forEach(o=>{s.methodName||(s[o]=()=>{throw ue.removed("Calling removed method ".concat(e,".").concat(o,": "),i)(),new Error(o)})})}const Id="Resource subclass must define virtual methods";class Jo{get[Symbol.toStringTag](){return"Resource"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Xy(e);const{id:r,userData:i={}}=t;this.gl=e,this.gl2=e,this.id=r||ai(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach(r=>r.delete()),this}bind(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!=typeof e?(this._bindHandle(e),this):(this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t)}unbind(){this.bind(null)}getParameter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};te(e=NT(this.gl,e));const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=Xe(this.gl);if("webgl2"in i&&!s||"extension"in i&&!this.gl.getExtension(i.extension))return s&&"webgl2"in i?i.webgl2:i.webgl1}return this._getParameter(e,t)}getParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{parameters:t,keys:r}=e,i=this.constructor.PARAMETERS||{},s=Xe(this.gl),o={},a=t||Object.keys(i);for(const c of a){const l=i[c];if(l&&(!("webgl2"in l)||s)&&(!("extension"in l)||this.gl.getExtension(l.extension))){const d=r?sc(this.gl,c):c;o[d]=this.getParameter(c,e),r&&"GLenum"===l.type&&(o[d]=sc(this.gl,o[d]))}}return o}setParameter(e,t){te(e=NT(this.gl,e));const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=Xe(this.gl);if("webgl2"in i&&!s||"extension"in i&&!this.gl.getExtension(i.extension))throw new Error("Parameter not available on this platform");"GLenum"===i.type&&(t=NT(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,r){return h3(this,e,t,r)}initialize(e){}_createHandle(){throw new Error(Id)}_deleteHandle(){throw new Error(Id)}_bindHandle(e){throw new Error(Id)}_getOptsFromHandle(){throw new Error(Id)}_getParameter(e,t){throw new Error(Id)}_setParameter(e,t){throw new Error(Id)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],t=fl.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get("".concat(e,"s Created")).incrementCount(),t.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];fl.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,t),this._trackAllocatedMemoryForContext(e,t,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];const i=fl.get("Memory Usage".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:""));i.get("GPU Memory").addCount(e),i.get("".concat(t," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];const r=fl.get("Memory Usage".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:""));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}}function FT(n){switch(ArrayBuffer.isView(n)?n.constructor:n){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function Cp(n){let{clamped:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(n){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Iue(n){let{data:e,width:t,height:r}=n;const i=Math.round(t/2),s=Math.round(r/2),o=new Uint8Array(i*s*4);for(let a=0;a<s;a++)for(let c=0;c<i;c++)for(let l=0;l<4;l++)o[4*(a*i+c)+l]=e[4*(2*a*t+2*c)+l];return{data:o,width:i,height:s}}function LT(n,e,t){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=t;for(const a in r)if(a in e){const l=r[a]?"".concat(n,".").concat(r[a]):"N/A";ue.removed("".concat(n,".").concat(a),l)()}for(const a in i)if(a in e){const c=i[a];ue.deprecated("".concat(n,".").concat(a),"".concat(n,".").concat(c))()}let o=null;for(const a in s)if(a in e){const c=s[a];ue.deprecated("".concat(n,".").concat(a),"".concat(n,".").concat(c))(),o=o||Object.assign({},e),o[c]=e[a],delete o[a]}return o||e}const Mue={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Due={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class ci{static getBytesPerElement(e){return Cp(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return te(e.size),Cp(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new ci(Mue,...t)}constructor(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return ci.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return ci.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=LT("Accessor",e,Due),void 0!==e.type&&(this.type=e.type,(5124===e.type||5125===e.type)&&(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&(this.index="boolean"==typeof e.index?e.index?1:0:e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const p3={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Rue={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:p3},Oue={removedProps:p3};class Pt extends Jo{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(){return Math.round(this.byteLength/ci.getBytesPerElement(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor))}getVertexCount(){return Math.round(this.byteLength/ci.getBytesPerVertex(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor))}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=LT("Buffer",e,Rue),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=LT("Buffer",e,Oue))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new ci(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;te(t);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==i||void 0!==s?(Er(this.gl),this.gl.bufferSubData(this.target,r,t,i,s)):this.gl.bufferSubData(o,r,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData(e){let{sourceBuffer:t,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:o}=this;return Er(o),o.bindBuffer(36662,t.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,r,i,s),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:t=0,dstOffset:r=0,length:i=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Er(this.gl);const s=Cp(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(t),a=r;let c,l;e?(l=e.length,c=l-a):(c=Math.min(o,i||o),l=a+c);const u=Math.min(o,c);return i=i||u,te(i<=u),e=e||new s(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===e||35982===e?void 0!==i?this.gl.bindBufferRange(e,t,this.handle,r,i):(te(0===r),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:t=this.accessor&&this.accessor.index}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength+t;te(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,t,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,10),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=FT(e);return te(s),this.setAccessor(new ci(this.accessor,{type:s})),this}_setByteLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;te(e>=0),this._trackDeallocatedMemory();let r=e;0===e&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,t),this.gl.bindBuffer(i,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const r=e/Cp(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new ci(this.accessor,{type:FT(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return ue.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return ue.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return ue.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return ue.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new ci(this.accessor,e),this}}const BT={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},g3={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},m3={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},kue=[9729,9728],_3=globalThis.WebGLBuffer||function(){};class pl extends Jo{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{format:r,linearFiltering:i}=t;let s=!0;return r&&(s=s&&function Pue(n,e){const t=BT[e];if(!t)return!1;if(void 0===t.gl1&&void 0===t.gl2)return!0;const r=Xe(n)&&t.gl2||t.gl1;return"string"==typeof r?n.getExtension(r):r}(e,r),s=s&&(!i||function Nue(n,e){const t=BT[e];switch(t&&t.types[0]){case 5126:return n.getExtension("OES_texture_float_linear");case 5131:return n.getExtension("OES_texture_half_float_linear");default:return!0}}(e,r))),s}constructor(e,t){const{id:r=ai("texture"),handle:i,target:s}=t;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data;if(t instanceof Promise)return t.then(v=>this.initialize(Object.assign({},e,{pixels:v,data:v}))),this;const r=typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement;if(r&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:o=0,recreate:a=!1,parameters:c={},pixelStore:l={},textureUnit:u}=e;t||(t=i);let{width:d,height:h,dataFormat:f,type:p,compressed:g=!1,mipmaps:m=!0}=e;const{depth:y=0}=e;return({width:d,height:h,compressed:g,dataFormat:f,type:p}=this._deduceParameters({format:s,type:p,dataFormat:f,compressed:g,data:t,width:d,height:h})),this.width=d,this.height=h,this.depth=y,this.format=s,this.type=p,this.dataFormat=f,this.border=o,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),m&&this._isNPOT()&&(ue.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),m=!1,this._updateForNPOT(c)),this.mipmaps=m,this.setImageData({data:t,width:d,height:h,depth:y,format:s,type:p,dataFormat:f,border:o,mipmaps:m,parameters:l,compressed:g}),m&&this.generateMipmap(),this.setParameters(c),a&&(this.data=t),r&&(this._video={video:t,parameters:c,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:t,width:r,mipmaps:i=!1}=e;return r!==this.width||t!==this.height?this.initialize({width:r,height:t,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isNPOT()?(ue.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),$i(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:r=null,level:i=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:c={}}=e;let{data:l=null,type:u=this.type,width:d=this.width,height:h=this.height,dataFormat:f=this.dataFormat,compressed:p=!1}=e;l||(l=r),({type:u,dataFormat:f,compressed:p,width:d,height:h}=this._deduceParameters({format:s,type:u,dataFormat:f,compressed:p,data:l,width:d,height:h}));const{gl:g}=this;g.bindTexture(this.target,this.handle);let m=null;({data:l,dataType:m}=this._getDataType({data:l,compressed:p}));let y,v=0;return $i(this.gl,c,()=>{switch(m){case"null":g.texImage2D(t,i,s,d,h,o,f,u,l);break;case"typed-array":g.texImage2D(t,i,s,d,h,o,f,u,l,a);break;case"buffer":y=Er(g),y.bindBuffer(35052,l.handle||l),y.texImage2D(t,i,s,d,h,o,f,u,a),y.bindBuffer(35052,null);break;case"browser-object":Xe(g)?g.texImage2D(t,i,s,d,h,o,f,u,l):g.texImage2D(t,i,s,f,u,l);break;case"compressed":for(const[_,E]of l.entries())g.compressedTexImage2D(t,_,E.format,E.width,E.height,o,E.data),v+=E.levelSize;break;default:te(!1,"Unknown image data type")}}),this._trackAllocatedMemory("compressed"===m?v:l&&l.byteLength?l.byteLength:this.width*this.height*(g3[this.dataFormat]||4)*(m3[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData(e){let{target:t=this.target,pixels:r=null,data:i=null,x:s=0,y:o=0,width:a=this.width,height:c=this.height,level:l=0,format:u=this.format,type:d=this.type,dataFormat:h=this.dataFormat,compressed:f=!1,offset:p=0,border:g=this.border,parameters:m={}}=e;if(({type:d,dataFormat:h,compressed:f,width:a,height:c}=this._deduceParameters({format:u,type:d,dataFormat:h,compressed:f,data:i,width:a,height:c})),te(0===this.depth,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const y=i;i=y.data,a=y.shape[0],c=y.shape[1]}i instanceof Pt&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),$i(this.gl,m,()=>{if(f)this.gl.compressedTexSubImage2D(t,l,s,o,a,c,u,i);else if(null===i)this.gl.texSubImage2D(t,l,s,o,a,c,h,d,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(t,l,s,o,a,c,h,d,i,p);else if(i instanceof _3){const y=Er(this.gl);y.bindBuffer(35052,i),y.texSubImage2D(t,l,s,o,a,c,h,d,p),y.bindBuffer(35052,null)}else Xe(this.gl)?Er(this.gl).texSubImage2D(t,l,s,o,a,c,h,d,i):this.gl.texSubImage2D(t,l,s,o,h,d,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return ue.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType(e){let{data:t,compressed:r=!1}=e;return r?{data:t,dataType:"compressed"}:null===t?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof Pt?{data:t.handle,dataType:"buffer"}:t instanceof _3?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:r}=e;let{width:i,height:s,dataFormat:o,type:a,compressed:c}=e;const l=BT[t];return o=o||l&&l.dataFormat,a=a||l&&l.types[0],c=c||l&&l.compressed,({width:i,height:s}=this._deduceImageSize(r,i,s)),{dataFormat:o,type:a,compressed:c,width:i,height:s,format:t,data:r}}_deduceImageSize(e,t,r){let i;return i=typeof ImageData<"u"&&e instanceof ImageData?{width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?{width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:r}:{width:t>=0?t:1,height:r>=0?r:1},te(i,"Could not deduced texture size"),te(void 0===t||i.width===t,"Deduced texture width does not match supplied width"),te(void 0===r||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:te(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(Xe(this.gl)||!this.width||!this.height||d3(this.width)&&d3(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===kue.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}function Fue(n,e){return te("string"==typeof n),n=""+n,new Promise((t,r)=>{try{const i=new Image;i.onload=()=>t(i),i.onerror=()=>r(new Error("Could not load image ".concat(n,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=n}catch(i){r(i)}})}class or extends pl{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,t){return pl.isSupported(e,t)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Xy(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:Fue(t.data)})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const gl="EXT_color_buffer_float",y3={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:gl,bpp:2},33327:{gl2:gl,bpp:4},34842:{gl2:gl,bpp:8},33326:{gl2:gl,bpp:4},33328:{gl2:gl,bpp:8},34836:{gl2:gl,bpp:16},35898:{gl2:gl,bpp:4}};class Md extends Jo{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:null};return!t||function Lue(n,e,t){const r=t[e];if(!r)return!1;const i=Xe(n)&&r.gl2||r.gl1;return"string"==typeof i?n.getExtension(i):i}(e,t,y3)}static getSamplesForFormat(e,t){let{format:r}=t;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.initialize(t),Object.seal(this)}initialize(e){let{format:t,width:r=1,height:i=1,samples:s=0}=e;return te(t,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==s&&Xe(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,t,r,i):this.gl.renderbufferStorage(36161,t,r,i),this.format=t,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*y3[this.format].bpp),this}resize(e){let{width:t,height:r}=e;return t!==this.width||r!==this.height?this.initialize({width:t,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const v3=6144,C3="clear: bad arguments";function jT(n){let{framebuffer:e=null,color:t=null,depth:r=null,stencil:i=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s={};e&&(s.framebuffer=e);let o=0;t&&(o|=16384,!0!==t&&(s.clearColor=t)),r&&(o|=256,!0!==r&&(s.clearDepth=r)),i&&(o|=1024,!0!==r&&(s.clearStencil=r)),te(0!==o,C3),$i(n,s,()=>{n.clear(o)})}const VT=[34069,34070,34071,34072,34073,34074];let zue=(()=>{class n extends pl{get[Symbol.toStringTag](){return"TextureCube"}constructor(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Xy(t),super(t,Object.assign({},r,{target:34067})),this.initialize(r),Object.seal(this)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mipmaps:r=!0,parameters:i={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,r&&this.generateMipmap(t),this.setParameters(i)}),this}subImage(t){let{face:r,data:i,x:s=0,y:o=0,mipmapLevel:a=0}=t;return this._subImage({target:r,data:i,x:s,y:o,mipmapLevel:a})}setCubeMapImageData(t){var r=this;return j(function*(){let{width:i,height:s,pixels:o,data:a,border:c=0,format:l=6408,type:u=5121}=t;const{gl:d}=r,h=o||a,f=yield Promise.all(VT.map(p=>{const g=h[p];return Promise.all(Array.isArray(g)?g:[g])}));r.bind(),VT.forEach((p,g)=>{f[g].length>1&&!1!==r.opts.mipmaps&&ue.warn("".concat(r.id," has mipmap and multiple LODs."))(),f[g].forEach((m,y)=>{i&&s?d.texImage2D(p,y,l,i,s,c,l,u,m):d.texImage2D(p,y,l,l,u,m)})}),r.unbind()})()}setImageDataForFace(t){const{face:r,width:i,height:s,pixels:o,data:a,border:c=0,format:l=6408,type:u=5121}=t,{gl:d}=this,h=o||a;return this.bind(),h instanceof Promise?h.then(f=>this.setImageDataForFace(Object.assign({},t,{face:r,data:f,pixels:f}))):this.width||this.height?d.texImage2D(r,0,l,i,s,c,l,u,h):d.texImage2D(r,0,l,l,u,h),this}}return n.FACES=VT,n})();class Gue extends pl{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return Xe(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Er(e),t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1}),super(e,t),this.initialize(t),Object.seal(this)}setImageData(e){let{level:t=0,dataFormat:r=6408,width:i,height:s,depth:o=1,border:a=0,format:c,type:l=5121,offset:u=0,data:d,parameters:h={}}=e;return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),$i(this.gl,h,()=>{ArrayBuffer.isView(d)&&this.gl.texImage3D(this.target,t,r,i,s,o,a,c,l,d),d instanceof Pt&&(this.gl.bindBuffer(35052,d.handle),this.gl.texImage3D(this.target,t,r,i,s,o,a,c,l,u))}),this._trackAllocatedMemory(d&&d.byteLength?d.byteLength:this.width*this.height*this.depth*(g3[this.dataFormat]||4)*(m3[this.type]||1),"Texture"),this.loaded=!0,this}}function $ue(n,e){const{gl:t,width:r,height:i,id:s}=n;return new xn(t,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{36064:n}}))}function Yy(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sourceX:t=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:c,sourceType:l}=e;const{framebuffer:u,deleteFramebuffer:d}=Ap(n);te(u);const{gl:h,handle:f,attachments:p}=u;a=a||u.width,c=c||u.height,36064===s&&null===f&&(s=1028),te(p[s]),l=l||p[s].type,o=function Xue(n,e,t,r,i){if(n)return n;const s=Cp(e=e||5121,{clamped:!1}),o=function Hue(n){switch(n){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return te(!1),0}}(t);return new s(r*i*o)}(o,l,i,a,c),l=l||FT(o);const g=h.bindFramebuffer(36160,f);return h.readPixels(t,r,a,c,i,l,o),h.bindFramebuffer(36160,g||null),d&&u.delete(),o}function HT(n){let{sourceAttachment:e=36064,targetMaxHeight:t=Number.MAX_SAFE_INTEGER}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Yy(n,{sourceAttachment:e}),{width:i,height:s}=n;for(;s>t;)({data:r,width:i,height:s}=Iue({data:r,width:i,height:s}));!function Sue(n){let{data:e,width:t,height:r,bytesPerPixel:i=4,temp:s}=n;const o=t*i;s=s||new Uint8Array(o);for(let a=0;a<r/2;++a){const c=a*o,l=(r-a-1)*o;s.set(e.subarray(c,c+o)),e.copyWithin(c,l,l+o),e.set(s,l)}}({data:r,width:i,height:s});const o=document.createElement("canvas");o.width=i,o.height=s;const a=o.getContext("2d"),c=a.createImageData(i,s);return c.data.set(r),a.putImageData(c,0,0),o.toDataURL()}function Ap(n){return n instanceof xn?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:$ue(n),deleteFramebuffer:!0}}const $t_WEBGL2="WEBGL2",$t_VERTEX_ARRAY_OBJECT="VERTEX_ARRAY_OBJECT",$t_TIMER_QUERY="TIMER_QUERY",$t_INSTANCED_RENDERING="INSTANCED_RENDERING",$t_MULTIPLE_RENDER_TARGETS="MULTIPLE_RENDER_TARGETS",$t_ELEMENT_INDEX_UINT32="ELEMENT_INDEX_UINT32",$t_BLEND_EQUATION_MINMAX="BLEND_EQUATION_MINMAX",$t_FLOAT_BLEND="FLOAT_BLEND",$t_COLOR_ENCODING_SRGB="COLOR_ENCODING_SRGB",$t_TEXTURE_DEPTH="TEXTURE_DEPTH",$t_TEXTURE_FLOAT="TEXTURE_FLOAT",$t_TEXTURE_HALF_FLOAT="TEXTURE_HALF_FLOAT",$t_TEXTURE_FILTER_LINEAR_FLOAT="TEXTURE_FILTER_LINEAR_FLOAT",$t_TEXTURE_FILTER_LINEAR_HALF_FLOAT="TEXTURE_FILTER_LINEAR_HALF_FLOAT",$t_TEXTURE_FILTER_ANISOTROPIC="TEXTURE_FILTER_ANISOTROPIC",$t_COLOR_ATTACHMENT_RGBA32F="COLOR_ATTACHMENT_RGBA32F",$t_COLOR_ATTACHMENT_FLOAT="COLOR_ATTACHMENT_FLOAT",$t_COLOR_ATTACHMENT_HALF_FLOAT="COLOR_ATTACHMENT_HALF_FLOAT",$t_GLSL_FRAG_DATA="GLSL_FRAG_DATA",$t_GLSL_FRAG_DEPTH="GLSL_FRAG_DEPTH",$t_GLSL_DERIVATIVES="GLSL_DERIVATIVES",$t_GLSL_TEXTURE_LOD="GLSL_TEXTURE_LOD",A3={[$t_WEBGL2]:[!1,!0],[$t_VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[$t_TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[$t_INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[$t_MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[$t_ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[$t_BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[$t_FLOAT_BLEND]:["EXT_float_blend"],[$t_COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[$t_TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[$t_TEXTURE_FLOAT]:["OES_texture_float",!0],[$t_TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[$t_TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[$t_TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[$t_TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[$t_COLOR_ATTACHMENT_RGBA32F]:[function Yue(n){const e=new or(n,{format:6408,type:5126,dataFormat:6408}),t=new xn(n,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=t.getStatus();return e.delete(),t.delete(),36053===r},"EXT_color_buffer_float"],[$t_COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[$t_COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[$t_GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[$t_GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[$t_GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[$t_GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]};function zT(n,e){return T3(n,e)}function T3(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>x3(n,t))}function x3(n,e){return n.luma=n.luma||{},n.luma.caps=n.luma.caps||{},void 0===n.luma.caps[e]&&(n.luma.caps[e]=function Jue(n,e){const t=A3[e];let r;te(t,e);const i=Xe(n)&&t[1]||t[0];if("function"==typeof i)r=i(n);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&!!n.getExtension(s)}else"string"==typeof i?r=!!n.getExtension(i):"boolean"==typeof i?r=i:te(!1);return r}(n,e)),n.luma.caps[e]||ue.log(2,"Feature: ".concat(e," not supported"))(),n.luma.caps[e]}const S3="Multiple render targets not supported";class xn extends Jo{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=t;let s=!0;return r&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!(!e.getExtension("EXT_color_buffer_float")&&!e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new xn(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Er(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Er(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:t=1,height:r=1,attachments:i=null,color:s=!0,depth:o=!0,stencil:a=!1,check:c=!0,readBuffer:l,drawBuffers:u}=e;if(te(t>=0&&r>=0,"Width and height need to be integers"),this.width=t,this.height=r,i)for(const d in i){const h=i[d];(Array.isArray(h)?h[0]:h).resize({width:t,height:r})}else i=this._createDefaultAttachments(s,o,a,t,r);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:u}),i&&c&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:t={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:o=!0}=e;this.attach(t,{clearAttachments:s,resizeAttachments:o});const{gl:a}=this,c=a.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),a.bindFramebuffer(36160,c||null),this}resize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{width:t,height:r}=e;if(null===this.handle)return te(void 0===t&&void 0===r),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===r&&(r=this.gl.drawingBufferHeight),t!==this.width&&r!==this.height&&ue.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(t,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:t,height:r});return this.width=t,this.height=r,this}attach(e){let{clearAttachments:t=!1,resizeAttachments:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i={};t&&Object.keys(this.attachments).forEach(o=>{i[o]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in i){te(void 0!==o,"Misspelled framebuffer binding point?");const a=Number(o),c=i[a];let l=c;if(l)if(l instanceof Md)this._attachRenderbuffer({attachment:a,renderbuffer:l});else if(Array.isArray(c)){const[u,d=0,h=0]=c;l=u,this._attachTexture({attachment:a,texture:u,layer:d,level:h})}else this._attachTexture({attachment:a,texture:l,layer:0,level:0});else this._unattach(a);r&&l&&l.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const t=this.getStatus();if(36053!==t)throw new Error(function ede(n){return(xn.STATUS||{})[n]||"Framebuffer error ".concat(n)}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),r}clear(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:t,depth:r,stencil:i,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(t||r||i)&&jT(this.gl,{color:t,depth:r,stencil:i}),s.forEach((a,c)=>{!function Vue(n){let{framebuffer:e=null,buffer:t=v3,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Er(n),$i(n,{framebuffer:e},()=>{switch(t){case v3:switch(i.constructor){case Int32Array:n.clearBufferiv(t,r,i);break;case Uint32Array:n.clearBufferuiv(t,r,i);break;case Float32Array:default:n.clearBufferfv(t,r,i)}break;case 6145:n.clearBufferfv(6145,0,[i]);break;case 6146:n.clearBufferiv(6146,0,[i]);break;case 34041:const[s,o]=i;n.clearBufferfi(34041,0,s,o);break;default:te(!1,C3)}})}(this.gl,{drawBuffer:c,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return ue.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return ue.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return ue.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return ue.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return ue.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return ue.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:t=[],x:r=0,y:i=0,width:s,height:o}=e;const a=Er(this.gl),c=a.bindFramebuffer(36008,this.handle);return 0===r&&0===i&&void 0===s&&void 0===o?a.invalidateFramebuffer(36008,t):a.invalidateFramebuffer(36008,t,r,i,s,o),a.bindFramebuffer(36008,c),this}getAttachmentParameter(e,t,r){let i=this._getAttachmentParameterFallback(t);return null===i&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=sc(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r)i[t?sc(this.gl,s):s]=this.getAttachmentParameter(e,s,t);return i}getParameters(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=Object.keys(this.attachments),r={};for(const i of t){const s=Number(i);r[e?sc(this.gl,s):s]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(HT(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e>ue.level||typeof window>"u")return this;t=t||"Framebuffer ".concat(this.id);const r=HT(this,{targetMaxHeight:100});return ue.image({logLevel:e,message:t,image:r},t)(),this}bind(){let{target:e=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,r,i,s){let o=null;return e&&(o=o||{},o[36064]=new or(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),t&&r?(o=o||{},o[33306]=new Md(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(o[33306])):t?(o=o||{},o[36096]=new Md(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(o[36096])):r&&te(!1),o}_unattach(e){const t=this.attachments[e];t&&(t instanceof Md?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:t=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,t,36161,r.handle),this.attachments[t]=r}_attachTexture(e){let{attachment:t=36064,texture:r,layer:i,level:s}=e;const{gl:o}=this;switch(o.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:Er(o).framebufferTextureLayer(36160,t,r.target,s,i);break;case 34067:const c=function Que(n){return n<34069?n+34069:n}(i);o.framebufferTexture2D(36160,t,c,r.handle,s);break;case 3553:o.framebufferTexture2D(36160,t,3553,r.handle,s);break;default:te(!1,"Illegal texture type")}o.bindTexture(r.target,null),this.attachments[t]=r}_setReadBuffer(e){const t=function Mle(n){return Xe(n)?n:null}(this.gl);t?t.readBuffer(e):te(36064===e||1029===e,S3),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,r=Er(t);if(r)r.drawBuffers(e);else{const i=t.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):te(1===e.length&&(36064===e[0]||1029===e[0]),S3)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function Kue(n){n.luma=n.luma||{},n.luma.caps=n.luma.caps||{};for(const e in A3)void 0===n.luma.caps[e]&&(n.luma.caps[e]=x3(n,e));return n.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}xn.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const nde={5126:Yt.bind(null,"uniform1fv",Ti,1,Cr),35664:Yt.bind(null,"uniform2fv",Ti,2,Cr),35665:Yt.bind(null,"uniform3fv",Ti,3,Cr),35666:Yt.bind(null,"uniform4fv",Ti,4,Cr),5124:Yt.bind(null,"uniform1iv",oc,1,Cr),35667:Yt.bind(null,"uniform2iv",oc,2,Cr),35668:Yt.bind(null,"uniform3iv",oc,3,Cr),35669:Yt.bind(null,"uniform4iv",oc,4,Cr),35670:Yt.bind(null,"uniform1iv",oc,1,Cr),35671:Yt.bind(null,"uniform2iv",oc,2,Cr),35672:Yt.bind(null,"uniform3iv",oc,3,Cr),35673:Yt.bind(null,"uniform4iv",oc,4,Cr),35674:Yt.bind(null,"uniformMatrix2fv",Ti,4,Qo),35675:Yt.bind(null,"uniformMatrix3fv",Ti,9,Qo),35676:Yt.bind(null,"uniformMatrix4fv",Ti,16,Qo),35678:ar,35680:ar,5125:Yt.bind(null,"uniform1uiv",Zy,1,Cr),36294:Yt.bind(null,"uniform2uiv",Zy,2,Cr),36295:Yt.bind(null,"uniform3uiv",Zy,3,Cr),36296:Yt.bind(null,"uniform4uiv",Zy,4,Cr),35685:Yt.bind(null,"uniformMatrix2x3fv",Ti,6,Qo),35686:Yt.bind(null,"uniformMatrix2x4fv",Ti,8,Qo),35687:Yt.bind(null,"uniformMatrix3x2fv",Ti,6,Qo),35688:Yt.bind(null,"uniformMatrix3x4fv",Ti,12,Qo),35689:Yt.bind(null,"uniformMatrix4x2fv",Ti,8,Qo),35690:Yt.bind(null,"uniformMatrix4x3fv",Ti,12,Qo),35678:ar,35680:ar,35679:ar,35682:ar,36289:ar,36292:ar,36293:ar,36298:ar,36299:ar,36300:ar,36303:ar,36306:ar,36307:ar,36308:ar,36311:ar},rde={},ide={},sde={},I3=[0];function GT(n,e,t,r){1===e&&"boolean"==typeof n&&(n=n?1:0),Number.isFinite(n)&&(I3[0]=n,n=I3);const i=n.length;if(i%e&&ue.warn("Uniform size should be multiples of ".concat(e),n)(),n instanceof t)return n;let s=r[i];s||(s=new t(i),r[i]=s);for(let o=0;o<i;o++)s[o]=n[o];return s}function Ti(n,e){return GT(n,e,Float32Array,rde)}function oc(n,e){return GT(n,e,Int32Array,ide)}function Zy(n,e){return GT(n,e,Uint32Array,sde)}function M3(n,e,t){const r=nde[t.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(t.type));return r().bind(null,n,e)}function ode(n){if("]"!==n[n.length-1])return{name:n,length:1,isArray:!1};const t=n.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(n));return{name:t[1],length:t[2]||1,isArray:!!t[2]}}function cde(n){return Array.isArray(n)||ArrayBuffer.isView(n)?function ude(n){if(0===n.length)return!1;const e=Math.min(n.length,16);for(let t=0;t<e;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n):!!(isFinite(n)||!0===n||!1===n||n instanceof pl||n instanceof Md)||n instanceof xn&&!!n.texture}function lde(n,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))if(n[e]){const r=n[e];for(let i=0,s=t.length;i<s;++i)r[i]=t[i]}else n[e]=t.slice();else n[e]=t}function ar(){let n=null;return(e,t,r)=>{const i=n!==r;return i&&(e.uniform1i(t,r),n=r),i}}function Yt(n,e,t,r){let i=null,s=null;return(o,a,c)=>{const l=e(c,t),u=l.length;let d=!1;if(null===i)i=new Float32Array(u),s=u,d=!0;else{te(s===u,"Uniform length cannot change.");for(let h=0;h<u;++h)if(l[h]!==i[h]){d=!0;break}}return d&&(r(o,n,a,l),i.set(l)),d}}function Cr(n,e,t,r){n[e](t,r)}function Qo(n,e,t,r){n[e](t,!1,r)}function Ky(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const r=n.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return r?r[1]:e}function R3(n,e){let t="";for(let r=0;r<e.length;r++)if((n[r+3]||n[r+2]||n[r+1])&&(t+="".concat(e[r],"\n"),n[r+1])){const s=n[r+1],o=s.split(":",3),a=o[0],c=parseInt(o[1],10)||0,l=s.substring(o.join(":").length+1).trim();t+=O3("^^^ ".concat(a,": ").concat(l,"\n\n"),c)}return t}function O3(n,e){let t="";for(let r=0;r<e;++r)t+=" ";return"".concat(t).concat(n)}class Tp extends Jo{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return te(!1),"unknown"}}constructor(e,t){Xy(e),te("string"==typeof t.source,"Shader: GLSL source code must be a JavaScript string"),super(e,{id:Ky(t.source,null)||t.id||ai("unnamed ".concat(Tp.getTypeName(t.shaderType)))}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize(e){let{source:t}=e;const r=Ky(t,null);r&&(this.id=ai(r)),this._compile(t)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(Tp.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Ky(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.source;if(e.startsWith("#version ")||(e="#version 100\n".concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:o}=function D3(n,e,t,r){const i=n.split(/\r?\n/),s={},o={},a=r||Ky(e)||"(unnamed)",c="".concat(function fde(n){switch(n){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(t)," shader ").concat(a);for(let u=0;u<i.length;u++){const d=i[u];if(d.length<=1)continue;const h=d.split(":"),f=h[0],p=parseInt(h[2],10);if(isNaN(p))throw new Error("GLSL compilation error in ".concat(c,": ").concat(n));"WARNING"!==f?s[p]=d:o[p]=d}const l=function pde(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ";const r=n.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,o)=>{const a=String(o+e);return O3(a,i-a.length)+t+s})}(e);return{shaderName:c,errors:R3(s,l),warnings:R3(o,l)}}(r,this.source,this.shaderType,this.id);throw ue.error("GLSL compilation errors in ".concat(i,"\n").concat(s))(),ue.warn("GLSL compilation warnings in ".concat(i,"\n").concat(o))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class WT extends Tp{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class $T extends Tp{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Un=5126,bde=35664,wde=35665,Ede=35666,xp=5124,Cde=35667,Ade=35668,Tde=35669,Sp=5125,xde=36294,Sde=36295,Ide=36296,Mde=35670,Dde=35671,Rde=35672,Ode=35673,Pde=35674,Nde=35675,kde=35676,Fde=35685,Lde=35686,Bde=35687,Ude=35688,jde=35689,Vde=35690,qT={[Un]:[Un,1,"float"],[bde]:[Un,2,"vec2"],[wde]:[Un,3,"vec3"],[Ede]:[Un,4,"vec4"],[xp]:[xp,1,"int"],[Cde]:[xp,2,"ivec2"],[Ade]:[xp,3,"ivec3"],[Tde]:[xp,4,"ivec4"],[Sp]:[Sp,1,"uint"],[xde]:[Sp,2,"uvec2"],[Sde]:[Sp,3,"uvec3"],[Ide]:[Sp,4,"uvec4"],[Mde]:[Un,1,"bool"],[Dde]:[Un,2,"bvec2"],[Rde]:[Un,3,"bvec3"],[Ode]:[Un,4,"bvec4"],[Pde]:[Un,8,"mat2"],[Fde]:[Un,8,"mat2x3"],[Lde]:[Un,8,"mat2x4"],[Nde]:[Un,12,"mat3"],[Bde]:[Un,12,"mat3x2"],[Ude]:[Un,12,"mat3x4"],[kde]:[Un,16,"mat4"],[jde]:[Un,16,"mat4x2"],[Vde]:[Un,16,"mat4x3"]};function B3(n){const e=qT[n];if(!e)return null;const[t,r]=e;return{type:t,components:r}}function U3(n,e){switch(n){case 5120:case 5121:case 5122:case 5123:n=Un}for(const t in qT){const[r,i,s]=qT[t];if(r===n&&i===e)return{glType:t,name:s}}return null}class zde{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,r=t.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=t.getActiveAttrib(e.handle,i),c=t.getAttribLocation(e.handle,s);c>=0&&this._addAttribute(c,s,o,a)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!Xe(t))return;const r=t.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=t.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,o,a)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,t,r,i){const{type:s,components:o}=B3(r),a={type:s,size:i*o};this._inferProperties(e,t,a);const c={location:e,name:t,accessor:new ci(a)};this.attributeInfos.push(c),this.attributeInfosByLocation[e]=c,this.attributeInfosByName[c.name]=c}_inferProperties(e,t,r){/instance/i.test(t)&&(r.divisor=1)}_addVarying(e,t,r,i){const{type:s,components:o}=B3(r),c={location:e,name:t,accessor:new ci({type:s,size:i*o})};this.varyingInfos.push(c),this.varyingInfosByName[c.name]=c}}const Gde=35981,Wde=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class V3 extends Jo{get[Symbol.toStringTag](){return"Program"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.stubRemovedMethods("Program","v6.0",Wde),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hash:t,vs:r,fs:i,varyings:s,bufferMode:o=Gde}=e;return this.hash=t||"",this.vs="string"==typeof r?new WT(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs="string"==typeof i?new $T(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,te(this.vs instanceof WT),te(this.fs instanceof $T),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Er(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new zde(this),this.setProps(e)}delete(){return this._isCached?this:super.delete(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:t,drawMode:r=4,vertexCount:i,offset:s=0,start:o,end:a,isIndexed:c=!1,indexType:l=5123,instanceCount:u=0,isInstanced:d=u>0,vertexArray:h=null,transformFeedback:f,framebuffer:p,parameters:g={},uniforms:m,samplers:y}=e;if((m||y)&&(ue.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(m||{})),ue.priority>=t){const v=p?p.id:"default",_="mode=".concat(sc(this.gl,r)," verts=").concat(i," ")+"instances=".concat(u," indexType=").concat(sc(this.gl,l)," ")+"isInstanced=".concat(d," isIndexed=").concat(c," ")+"Framebuffer=".concat(v);ue.log(t,_)()}return te(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||d&&0===u||(h.bindForDraw(i,u,()=>{if(void 0!==p&&(g=Object.assign({},g,{framebuffer:p})),f){const v=function L3(n){switch(n){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return te(!1),0}}(r);f.begin(v)}this._bindTextures(),$i(this.gl,g,()=>{c&&d?this.gl2.drawElementsInstanced(r,i,l,s,u):c&&Xe(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(r,o,a,i,l,s):c?this.gl.drawElements(r,i,l,s):d?this.gl2.drawArraysInstanced(r,s,i,u):this.gl.drawArrays(r,s,i)}),f&&f.end()}),0))}setUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ue.priority>=2&&function ade(n,e,t){for(const r in n){const i=n[r];if((!t||t[r])&&!cde(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const r=e[t],i=this._uniformSetters[t];if(i){let s=r,o=!1;if(s instanceof xn&&(s=s.texture),s instanceof pl)if(o=this.uniforms[t]!==r,o){void 0===i.textureIndex&&(i.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:c}=i;a.bind(c),s=c,this._textureUniforms[t]=a}else s=i.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(i(s)||o)&&lde(this.uniforms,t,r)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const r=this._textureUniforms[t];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms)this._textureUniforms[e].bind(this._uniformSetters[e].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),r={};for(const i of t)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new WT({handle:i});break;case 35632:r.fs=new $T({handle:i})}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const t=this._getName();this.id=ai(t)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),ue.time(4,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),ue.timeEnd(4,"linkProgram for ".concat(this._getName()))(),e.debug||ue.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const r=this.gl.getActiveUniform(this.handle,t),{name:i}=ode(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=M3(e,s,r),r.size>1)for(let o=0;o<r.size;o++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(o,"]")),this._uniformSetters["".concat(i,"[").concat(o,"]")]=M3(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class Ip{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Ip(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(t=>t.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==t),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{vs:t="",fs:r="",defines:i={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:c=!1}=e,l=this._getModuleList(e.modules),u=this._getHash(t),d=this._getHash(r),h=l.map(_=>this._getHash(_.name)).sort(),f=o.map(_=>this._getHash(_)),p=Object.keys(i).sort(),g=Object.keys(s).sort(),m=[],y=[];for(const _ of p)m.push(this._getHash(_)),m.push(this._getHash(i[_]));for(const _ of g)y.push(this._getHash(_)),y.push(this._getHash(s[_]));const v="".concat(u,"/").concat(d,"D").concat(m.join("/"),"M").concat(h.join("/"),"I").concat(y.join("/"),"V").concat(f.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(c?"T":"");if(!this._programCache[v]){const _=function ble(n,e){const{vs:t,fs:r}=e,i=Yce(e.modules||[]);return{gl:n,vs:WU(n,Object.assign({},e,{source:t,type:yp,modules:i})),fs:WU(n,Object.assign({},e,{source:r,type:"fs",modules:i})),getUniforms:wle(i)}}(this.gl,{vs:t,fs:r,modules:l,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:c});this._programCache[v]=new V3(this.gl,{hash:v,vs:_.vs,fs:_.fs,varyings:o,bufferMode:a}),this._getUniforms[v]=_.getUniforms||(E=>{}),this._useCounts[v]=0}return this._useCounts[v]++,this._programCache[v]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],c=a.name;t[i++]=a,r[c]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],c=a.name;r[c]||(t[i++]=a,r[c]=!0)}return t.length=i,t}}const $de=[255,255,255],qde=1;let Xde=0;class H3{constructor(e={}){w(this,"id",void 0),w(this,"color",void 0),w(this,"intensity",void 0),w(this,"type","ambient");const{color:t=$de}=e,{intensity:r=qde}=e;this.id=e.id||"ambient-".concat(Xde++),this.color=t,this.intensity=r}}const Yde=[255,255,255],Zde=1,Kde=[0,0,-1];let Jde=0;class z3{constructor(e={}){w(this,"id",void 0),w(this,"color",void 0),w(this,"intensity",void 0),w(this,"type","directional"),w(this,"direction",void 0),w(this,"shadow",void 0);const{color:t=Yde}=e,{intensity:r=Zde}=e,{direction:i=Kde}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(Jde++),this.color=t,this.intensity=r,this.type="directional",this.direction=new wr(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class Qde{constructor(e,t={id:"pass"}){w(this,"id",void 0),w(this,"gl",void 0),w(this,"props",void 0);const{id:r}=t;this.id=r,this.gl=e,this.props={...t}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class Qy extends Qde{constructor(...e){super(...e),w(this,"_lastRenderIndex",-1)}render(e){return Ko(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:t,moduleParameters:r,viewports:i,views:s,onViewportActive:o,clearStack:a=!0,clearCanvas:c=!0}=e;e.pass=e.pass||"unknown";const l=this.gl;c&&function the(n){Ko(n,{viewport:[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}),n.clear(16640)}(l),a&&(this._lastRenderIndex=-1);const u=[];for(const d of i){const h=s&&s[d.id];o(d);const f=this._getDrawLayerParams(d,e),p=d.subViewports||[d];for(const g of p){const m=this._drawLayersInViewport(l,{target:t,moduleParameters:r,viewport:g,view:h,pass:e.pass,layers:e.layers},f);u.push(m)}}return u}_getDrawLayerParams(e,{layers:t,pass:r,layerFilter:i,cullRect:s,effects:o,moduleParameters:a}){const c=[],l=G3(this._lastRenderIndex+1),u={layer:t[0],viewport:e,isPicking:r.startsWith("picking"),renderPass:r,cullRect:s},d={};for(let h=0;h<t.length;h++){const f=t[h],p=this._shouldDrawLayer(f,u,i,d),g={shouldDrawLayer:p};p&&(g.layerRenderIndex=l(f,p),g.moduleParameters=this._getModuleParameters(f,o,r,a),g.layerParameters=this.getLayerParameters(f,h,e)),c[h]=g}return c}_drawLayersInViewport(e,{layers:t,moduleParameters:r,pass:i,target:s,viewport:o,view:a},c){const l=function ehe(n,{moduleParameters:e,target:t,viewport:r}){const i=t&&"default-framebuffer"!==t.id,s=e&&e.devicePixelRatio||xd(n);return[r.x*s,(i?t.height:n.drawingBufferHeight)-(r.y+r.height)*s,r.width*s,r.height*s]}(e,{moduleParameters:r,target:s,viewport:o});if(a&&a.props.clear){const d=!0===a.props.clear?{color:!0,depth:!0}:a.props.clear;$i(e,{scissorTest:!0,scissor:l},()=>jT(e,d))}const u={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};Ko(e,{viewport:l});for(let d=0;d<t.length;d++){const h=t[d],{shouldDrawLayer:f,layerRenderIndex:p,moduleParameters:g,layerParameters:m}=c[d];if(f&&h.props.pickable&&u.pickableCount++,h.isComposite)u.compositeCount++;else if(f){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,p),g.viewport=o;try{h._drawLayer({moduleParameters:g,uniforms:{layerIndex:p},parameters:m})}catch(y){h.raiseError(y,"drawing ".concat(h," to ").concat(i))}}}return u}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t,r){return e.props.parameters}_shouldDrawLayer(e,t,r,i){if(!e.props.visible||!this.shouldDrawLayer(e))return!1;t.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(t))return!1;t.layer=o,o=o.parent}if(r){const a=t.layer.id;if(a in i||(i[a]=r(t)),!i[a])return!1}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,r,i){var s;const o=Object.assign(Object.create((null===(s=e.internalState)||void 0===s?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:xd(this.gl)});if(t)for(const c of t){var a;Object.assign(o,null===(a=c.getModuleParameters)||void 0===a?void 0:a.call(c,e))}return Object.assign(o,this.getModuleParameters(e,t),i)}}function G3(n=0,e={}){const t={},r=(i,s)=>{const o=i.props._offset,a=i.id,c=i.parent&&i.parent.id;let l;if(c&&!(c in e)&&r(i.parent,!1),c in t){const u=t[c]=t[c]||G3(e[c],e);l=u(i,s),t[a]=u}else Number.isFinite(o)?(l=o+(e[c]||0),t[a]=null):l=n;return s&&l>=n&&(n=l+1),e[a]=l,l};return r}class nhe extends Qy{constructor(e,t){super(e,t),w(this,"shadowMap",void 0),w(this,"depthBuffer",void 0),w(this,"fbo",void 0),this.shadowMap=new or(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Md(e,{format:33189,width:1,height:1}),this.fbo=new xn(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;$i(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=xd(this.gl),s=r.width*i,o=r.height*i;(s!==t.width||o!==t.height)&&t.resize({width:s,height:o}),super.render({...e,target:t,pass:"shadow"})})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const W3="#define SMOOTH_EDGE_RADIUS 0.5",ohe={name:"geometry",vs:"\n".concat(W3,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(W3,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")},ahe=Object.keys(st).map(n=>"const int COORDINATE_SYSTEM_".concat(n," = ").concat(st[n],";")).join(""),che=Object.keys(eo).map(n=>"const int PROJECTION_MODE_".concat(n," = ").concat(eo[n],";")).join(""),lhe=Object.keys(Vy).map(n=>"const int UNIT_".concat(n.toUpperCase()," = ").concat(Vy[n],";")).join(""),uhe="".concat(ahe,"\n").concat(che,"\n").concat(lhe,'\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0; // meters\nconst float GLOBE_RADIUS = 256.0;\n\n// returns an adjustment factor for uCommonUnitsPerMeter\nfloat project_size_at_latitude(float lat) {\n  float y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n\n    // uCommonUnitsPerMeter in low-zoom Web Mercator is non-linear\n    // Adjust by 1 / cos(latitude)\n    // If geometry.position (vertex in common space) is populated, use it\n    // Otherwise use geometry.worldPosition (anchor in world space)\n    \n    if (geometry.position.w == 0.0) {\n      return project_size_at_latitude(geometry.worldPosition.y);\n    }\n\n    // latitude from common y: 2.0 * (atan(exp(y / TILE_SIZE * 2.0 * PI - PI)) - PI / 4.0)\n    // Taylor series of 1 / cos(latitude)\n    // Max error < 0.003\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\nfloat project_size_at_latitude(float meters, float lat) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\n\n//\n// Scaling offsets - scales meters to "world distance"\n// Note the scalar version of project_size is for scaling the z component only\n//\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\n\n// Get rotation matrix that aligns the z axis with the given up vector\n// Find 3 unit vectors ux, uy, uz that are perpendicular to each other and uz == up\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  // Tangent on XY plane\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n\n//\n// Projecting normal - transform deltas from current coordinate system to\n// normals in the worldspace\n//\nvec3 project_normal(vec3 vector) {\n  // Apply model matrix\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\n\n//\n// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]\n//\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\n\n//\n// Projects positions (defined by project_uCoordinateSystem) to common space (defined by project_uProjectionMode)\n//\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n\n  // Work around for a Mac+NVIDIA bug https://github.com/visgl/deck.gl/issues/4145\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size_at_latitude(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        // Too far from the projection center for offset mode to be accurate\n        // Only use high parts\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n\n  // Translation is already added to the high parts\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\n\n//\n// Projects from common space coordinates to clip space.\n// Uses project_uViewProjectionMatrix\n//\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\n\n// Returns a clip space offset that corresponds to a given number of screen pixels\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  // UNIT_PIXELS\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n');function dhe(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}return!1}function ev(n){let t,e={};return r=>{for(const i in r)if(!dhe(r[i],e[i])){t=n(r),e=r;break}return t}}const $3=[0,0,0,0],hhe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],q3=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],fhe=[0,0,0],X3=[0,0,0],phe=ev(function _he({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:c,geospatialOrigin:l}=function ghe(n,e,t){const{viewMatrixUncentered:r,projectionMatrix:i}=n;let{viewMatrix:s,viewProjectionMatrix:o}=n,a=$3,c=$3,l=n.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:d,offsetMode:h}=Y3(n,e,t);return h&&(c=n.projectPosition(u||d),l=[l[0]-c[0],l[1]-c[1],l[2]-c[2]],c[3]=1,a=pp([],c,o),s=r||s,o=ll([],i,s),o=ll([],o,hhe)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:c,cameraPosCommon:l,shaderCoordinateOrigin:d,geospatialOrigin:u}}(n,t,r),u=n.getDistanceScales(),d=[n.width*e,n.height*e],h=pp([],[0,0,-n.focalDistance,1],n.projectionMatrix)[3]||1,f={project_uCoordinateSystem:t,project_uProjectionMode:n.projectionMode,project_uCoordinateOrigin:c,project_uCommonOrigin:o.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!n._pseudoMeters,project_uViewportSize:d,project_uDevicePixelRatio:e,project_uFocalDistance:h,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:fhe,project_uScale:n.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:q3,project_uCameraPosition:a};if(l){const p=n.getDistanceScales(l);switch(t){case st.METER_OFFSETS:f.project_uCommonUnitsPerWorldUnit=p.unitsPerMeter,f.project_uCommonUnitsPerWorldUnit2=p.unitsPerMeter2;break;case st.LNGLAT:case st.LNGLAT_OFFSETS:n._pseudoMeters||(f.project_uCommonUnitsPerMeter=p.unitsPerMeter),f.project_uCommonUnitsPerWorldUnit=p.unitsPerDegree,f.project_uCommonUnitsPerWorldUnit2=p.unitsPerDegree2;break;case st.CARTESIAN:f.project_uCommonUnitsPerWorldUnit=[1,1,p.unitsPerMeter[2]],f.project_uCommonUnitsPerWorldUnit2=[0,0,p.unitsPerMeter2[2]]}}return f});function Y3(n,e,t=X3){t.length<3&&(t=[t[0],t[1],0]);let i,r=t,s=!0;switch(i=e===st.LNGLAT_OFFSETS||e===st.METER_OFFSETS?t:n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case eo.WEB_MERCATOR:(e===st.LNGLAT||e===st.CARTESIAN)&&(i=[0,0,0],s=!1);break;case eo.WEB_MERCATOR_AUTO_OFFSET:e===st.LNGLAT?r=i:e===st.CARTESIAN&&(r=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],i=n.unprojectPosition(r),r[0]-=t[0],r[1]-=t[1],r[2]-=t[2]);break;case eo.IDENTITY:r=n.position.map(Math.fround),r[2]=r[2]||0;break;case eo.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}const yhe={},XT={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null},ohe],vs:uhe,getUniforms:function vhe(n=yhe){return"viewport"in n?function mhe({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:r=st.DEFAULT,coordinateOrigin:i=X3,autoWrapLongitude:s=!1}){r===st.DEFAULT&&(r=n.isGeospatial?st.LNGLAT:st.CARTESIAN);const o=phe({viewport:n,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.project_uWrapLongitude=s,o.project_uModelMatrix=t||q3,o}(n):{}}},Ehe=ev(function She({viewport:n,center:e}){return new Ve(n.viewProjectionMatrix).invert().transform(e)}),Che=ev(function Ihe({viewport:n,shadowMatrices:e}){const t=[],r=n.pixelUnprojectionMatrix,i=n.isGeospatial?void 0:1,s=[[0,0,i],[n.width,0,i],[0,n.height,i],[n.width,n.height,i],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(o=>function xhe(n,e){const[t,r,i]=n,s=gp([t,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}(o,r));for(const o of e){const a=o.clone().translate(new wr(n.center).negate()),c=s.map(u=>a.transform(u)),l=(new Ve).ortho({left:Math.min(...c.map(u=>u[0])),right:Math.max(...c.map(u=>u[0])),bottom:Math.min(...c.map(u=>u[1])),top:Math.max(...c.map(u=>u[1])),near:Math.min(...c.map(u=>-u[2])),far:Math.max(...c.map(u=>-u[2]))});t.push(l.multiplyRight(o))}return t}),Ahe=[0,0,0,1],The=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],ZT={name:"shadow",dependencies:[XT],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(n={},e={})=>"viewport"in n&&(n.drawToShadowMap||n.shadowMaps&&n.shadowMaps.length>0)?function Mhe(n,e){const{shadowEnabled:t=!0}=n;if(!t||!n.shadowMatrices||!n.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!n.drawToShadowMap,shadow_uUseShadowMap:!!n.shadowMaps&&n.shadowMaps.length>0,shadow_uColor:n.shadowColor||Ahe,shadow_uLightId:n.shadowLightId||0,shadow_uLightCount:n.shadowMatrices.length},i=Ehe({viewport:n.viewport,center:e.project_uCenter}),s=[],o=Che({shadowMatrices:n.shadowMatrices,viewport:n.viewport}).slice();for(let a=0;a<n.shadowMatrices.length;a++){const c=o[a],l=c.clone().translate(new wr(n.viewport.center).negate());e.project_uCoordinateSystem===st.LNGLAT&&e.project_uProjectionMode===eo.WEB_MERCATOR?(o[a]=l,s[a]=i):(o[a]=c.clone().multiplyRight(The),s[a]=l.transform(i))}for(let a=0;a<o.length;a++)r["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],r["shadow_uProjectCenters[".concat(a,"]")]=s[a],r["shadow_uShadowMap".concat(a)]=n.shadowMaps&&n.shadowMaps.length>0?n.shadowMaps[a]:n.dummyShadowMap;return r}(n,e):{}},Dhe={color:[255,255,255],intensity:1},Z3=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Rhe=[0,0,0,200/255];class KT{constructor(e={}){w(this,"id","lighting-effect"),w(this,"props",null),w(this,"shadowColor",Rhe),w(this,"shadow",void 0),w(this,"ambientLight",null),w(this,"directionalLights",[]),w(this,"pointLights",[]),w(this,"shadowPasses",[]),w(this,"shadowMaps",[]),w(this,"dummyShadowMap",null),w(this,"programManager",void 0),w(this,"shadowMatrices",void 0);for(const t in e){const r=e[t];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow)}preRender(e,{layers:t,layerFilter:r,viewports:i,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=Ip.getDefaultProgramManager(e),ZT&&this.programManager.addDefaultModule(ZT)),this.dummyShadowMap||(this.dummyShadowMap=new or(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:t,layerFilter:r,viewports:i,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(ZT),this.programManager=null)}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const r=(new Ve).lookAt({eye:new wr(t.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const r=new nhe(e);this.shadowPasses[t]=r,this.shadowMaps[t]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:r}=this;!e&&0===t.length&&0===r.length&&(this.ambientLight=new H3(Dhe),this.directionalLights.push(new z3(Z3[0]),new z3(Z3[1])))}}let Ohe=1,Phe=1;class K3{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,o=Ohe++,a={time:0,delay:t,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,r]of this.animations)r.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const i of t)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:o}=i;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const r=Phe++;return this.animations.set(r,{animation:e,channel:t}),e.setTime(this.getTime(t)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const r=t-e.delay;r>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const tv=Symbol.for("component"),Pd=Symbol.for("asyncPropDefaults"),ml=Symbol.for("asyncPropOriginal"),ac=Symbol.for("asyncPropResolved");let JT={};function Ar(n,e,t,r){Je.level>0&&JT[n]&&JT[n].call(null,e,t,r)}function QT(n,e=()=>!0){return Array.isArray(n)?J3(n,e,[]):e(n)?[n]:[]}function J3(n,e,t){let r=-1;for(;++r<n.length;){const i=n[r];Array.isArray(i)?J3(i,e,t):e(i)&&t.push(i)}return t}function khe({target:n,source:e,start:t=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=t;o<i;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s);return n}const Ts=n=>"function"==typeof n,cc=n=>null!==n&&"object"==typeof n,ej=n=>cc(n)&&n.constructor==={}.constructor,Nd=n=>typeof Response<"u"&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,kd=n=>typeof Blob<"u"&&n instanceof Blob,tj=n=>(n=>typeof ReadableStream<"u"&&n instanceof ReadableStream||cc(n)&&Ts(n.tee)&&Ts(n.cancel)&&Ts(n.getReader))(n)||(n=>cc(n)&&Ts(n.read)&&Ts(n.pipe)&&(n=>"boolean"==typeof n)(n.readable))(n);function nj(n,e){if(!n)throw new Error(e||"loader assertion failed.")}function ex(n){var e;return!!n&&(Array.isArray(n)&&(n=n[0]),Array.isArray(null===(e=n)||void 0===e?void 0:e.extensions))}function tx(n){var e,t;let r;return nj(n,"null loader"),nj(ex(n),"invalid loader"),Array.isArray(n)&&(r=n[1],n=n[0],n={...n,options:{...n.options,...r}}),(null!==(e=n)&&void 0!==e&&e.parseTextSync||null!==(t=n)&&void 0!==t&&t.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}const rx={},Ghe=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Whe=/^([-\w.]+\/[-\w.+]+)/;function $he(n){const e=Whe.exec(n);return e?e[1]:n}function rj(n){const e=Ghe.exec(n);return e?e[1]:""}const qhe=/\?.*/;function nv(n){if(Nd(n)){const e=ix(n.url||"");return{url:e,type:$he(n.headers.get("content-type")||"")||rj(e)}}return kd(n)?{url:ix(n.name||""),type:n.type||""}:"string"==typeof n?{url:ix(n),type:rj(n)}:{url:"",type:""}}function ix(n){return n.replace(qhe,"")}function ij(n){return sx.apply(this,arguments)}function sx(){return sx=j(function*(n){if(Nd(n))return n;const e={},t=function Xhe(n){return Nd(n)?n.headers["content-length"]||-1:kd(n)?n.size:"string"==typeof n?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}(n);t>=0&&(e["content-length"]=String(t));const{url:r,type:i}=nv(n);i&&(e["content-type"]=i);const s=yield function Khe(n){return cx.apply(this,arguments)}(n);s&&(e["x-first-bytes"]=s),"string"==typeof n&&(n=(new TextEncoder).encode(n));const o=new Response(n,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}),sx.apply(this,arguments)}function ox(){return ox=j(function*(n){if(!n.ok){const e=yield function Zhe(n){return ax.apply(this,arguments)}(n);throw new Error(e)}}),ox.apply(this,arguments)}function ax(){return ax=j(function*(n){let e="Failed to fetch resource ".concat(n.url," (").concat(n.status,"): ");try{const t=n.headers.get("Content-Type");let r=n.statusText;t.includes("application/json")&&(r+=" ".concat(yield n.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}),ax.apply(this,arguments)}function cx(){return cx=j(function*(n){if("string"==typeof n)return"data:,".concat(n.slice(0,5));if(n instanceof Blob){const t=n.slice(0,5);return yield new Promise(r=>{const i=new FileReader;i.onload=s=>{var o;return r(null==s||null===(o=s.target)||void 0===o?void 0:o.result)},i.readAsDataURL(t)})}if(n instanceof ArrayBuffer){const r=function Jhe(n){let e="";const t=new Uint8Array(n);for(let r=0;r<t.byteLength;r++)e+=String.fromCharCode(t[r]);return btoa(e)}(n.slice(0,5));return"data:base64,".concat(r)}return null}),cx.apply(this,arguments)}function sj(n,e){return lx.apply(this,arguments)}function lx(){return lx=j(function*(n,e){if("string"==typeof n){n=function zhe(n){for(const e in rx)n.startsWith(e)&&(n=n.replace(e,rx[e]));return!n.startsWith("http://")&&!n.startsWith("https://")&&(n="".concat("").concat(n)),n}(n);let t=e;return null!=e&&e.fetch&&"function"!=typeof e?.fetch&&(t=e.fetch),yield fetch(n,t)}return yield ij(n)}),lx.apply(this,arguments)}const oj=new up({id:"loaders.gl"});class Qhe{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}typeof self<"u"&&self,typeof window<"u"&&window,typeof global<"u"&&global,typeof document<"u"&&document;const aj=!("object"==typeof process&&"[object process]"===String(process)&&!process.browser),cj=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),lj=(cj&&parseFloat(cj[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class efe{constructor(){w(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:aj,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),tfe={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function ux(){globalThis.loaders=globalThis.loaders||{};const{loaders:n}=globalThis;return n._state=n._state||{},n._state}const dx=()=>{const n=ux();return n.globalOptions=n.globalOptions||{...lj},n.globalOptions};function nfe(n,e,t,r){return t=t||[],function rfe(n,e){dj(n,null,lj,tfe,e);for(const t of e)dj(n&&n[t.id]||{},t.id,t.options&&t.options[t.id]||{},t.deprecatedOptions&&t.deprecatedOptions[t.id]||{},e)}(n,t=Array.isArray(t)?t:[t]),function hj(n,e,t){const i={...n.options||{}};return function sfe(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}(i,t),null===i.log&&(i.log=new Qhe),fj(i,dx()),fj(i,e),i}(e,n,r)}function uj(n,e){const t=dx(),r=n||t;return"function"==typeof r.fetch?r.fetch:cc(r.fetch)?i=>sj(i,r):null!=e&&e.fetch?e?.fetch:sj}function dj(n,e,t,r,i){const s=e||"Top level",o=e?"".concat(e,"."):"";for(const a in n){const c=!e&&cc(n[a]);if(!(a in t)&&("baseUri"!==a||e)&&("workerUrl"!==a||!e))if(a in r)oj.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!c){const d=ife(a,i);oj.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(d))()}}}function ife(n,e){const t=n.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(n===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const o=s.toLowerCase();(t.startsWith(o)||o.startsWith(t))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function fj(n,e){for(const t in e)t in e&&(n[t]=ej(e[t])&&ej(n[t])?{...n[t],...e[t]}:e[t])}function ro(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}const io={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},cfe=io.global||io.self||io.window||{},lc="object"!=typeof process||"[object process]"!==String(process)||process.browser,hx="function"==typeof importScripts,lfe=typeof window<"u"&&typeof window.orientation<"u",pj=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);pj&&parseFloat(pj[1]);class fx{}const px=new Map;function gj(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function mj(n,e=!0,t){const r=t||new Set;if(n)if(_j(n))r.add(n);else if(_j(n.buffer))r.add(n.buffer);else if(!ArrayBuffer.isView(n)&&e&&"object"==typeof n)for(const i in n)mj(n[i],e,r);return void 0===t?Array.from(r):[]}function _j(n){return!!n&&(n instanceof ArrayBuffer||typeof MessagePort<"u"&&n instanceof MessagePort||typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)}const gx=()=>{};class mx{static isSupported(){return typeof Worker<"u"&&lc||typeof fx<"u"&&!lc}constructor(e){w(this,"name",void 0),w(this,"source",void 0),w(this,"url",void 0),w(this,"terminated",!1),w(this,"worker",void 0),w(this,"onMessage",void 0),w(this,"onError",void 0),w(this,"_loadableURL","");const{name:t,source:r,url:i}=e;ro(r||i),this.name=t,this.source=r,this.url=i,this.onMessage=gx,this.onError=s=>console.log(s),this.worker=lc?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=gx,this.onError=gx,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,t){t=t||mj(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(t+="".concat(e.message," in ")),e.lineno&&(t+=":".concat(e.lineno,":").concat(e.colno)),new Error(t)}_createBrowserWorker(){this._loadableURL=function ufe(n){ro(n.source&&!n.url||!n.source&&n.url);let e=px.get(n.source||n.url);return e||(n.url&&(e=function dfe(n){if(!n.startsWith("http"))return n;const e=function hfe(n){return"try {\n  importScripts('".concat(n,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")}(n);return gj(e)}(n.url),px.set(n.url,e)),n.source&&(e=gj(n.source),px.set(n.source,e))),ro(e),e}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new fx(r,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new fx(this.source,{eval:!0})}return e.on("message",t=>{this.onMessage(t)}),e.on("error",t=>{this.onError(t)}),e.on("exit",t=>{}),e}}class pfe{constructor(e,t){w(this,"name",void 0),w(this,"workerThread",void 0),w(this,"isRunning",!0),w(this,"result",void 0),w(this,"_resolve",()=>{}),w(this,"_reject",()=>{}),this.name=e,this.workerThread=t,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){ro(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){ro(this.isRunning),this.isRunning=!1,this._reject(e)}}class gfe{static isSupported(){return mx.isSupported()}constructor(e){w(this,"name","unnamed"),w(this,"source",void 0),w(this,"url",void 0),w(this,"maxConcurrency",1),w(this,"maxMobileConcurrency",1),w(this,"onDebug",()=>{}),w(this,"reuseWorkers",!0),w(this,"props",{}),w(this,"jobQueue",[]),w(this,"idleQueue",[]),w(this,"count",0),w(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}startJob(e,t=(i,s,o)=>i.done(o),r=(i,s)=>i.error(s)){var i=this;return j(function*(){const s=new Promise(o=>(i.jobQueue.push({name:e,onMessage:t,onError:r,onStart:o}),i));return i._startQueuedJob(),yield s})()}_startQueuedJob(){var e=this;return j(function*(){if(!e.jobQueue.length)return;const t=e._getAvailableWorker();if(!t)return;const r=e.jobQueue.shift();if(r){e.onDebug({message:"Starting job",name:r.name,workerThread:t,backlog:e.jobQueue.length});const i=new pfe(r.name,t);t.onMessage=s=>r.onMessage(i,s.type,s.payload),t.onError=s=>r.onError(i,s),r.onStart(i);try{yield i.result}finally{e.returnWorkerToQueue(t)}}})()}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new mx({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return lfe?this.maxMobileConcurrency:this.maxConcurrency}}const mfe={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class ea{static isSupported(){return mx.isSupported()}static getWorkerFarm(e={}){return ea._workerFarm=ea._workerFarm||new ea({}),ea._workerFarm.setProps(e),ea._workerFarm}constructor(e){w(this,"props",void 0),w(this,"workerPools",new Map),this.props={...mfe},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:r,url:i}=e;let s=this.workerPools.get(t);return s||(s=new gfe({name:t,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function _x(){return _x=j(function*(n,e,t,r,i){const s=n.id,o=function yfe(n,e={}){const t=e[n.id]||{},r="".concat(n.id,"-worker.js");let i=t.workerUrl;if(!i&&"compression"===n.id&&(i=e.workerUrl),"test"===e._workerType&&(i="modules/".concat(n.module,"/dist/").concat(r)),!i){let s=n.version;"latest"===s&&(s="latest");const o=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(n.module).concat(o,"/dist/").concat(r)}return ro(i),i}(n,t),c=ea.getWorkerFarm(t).getWorkerPool({name:s,url:o});t=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(r||{}));const l=yield c.startJob("process-on-worker",wfe.bind(null,i));return l.postMessage("process",{input:e,options:t,context:r}),yield(yield l.result).result}),_x.apply(this,arguments)}function wfe(n,e,t,r){return yx.apply(this,arguments)}function yx(){return yx=j(function*(n,e,t,r){switch(t){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:o}=r;try{const a=yield n(s,o);e.postMessage("done",{id:i,result:a})}catch(a){const c=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:c})}break;default:console.warn("parse-with-worker unknown message ".concat(t))}}),yx.apply(this,arguments)}function vx(n){var e,t,r,i=2;for(typeof Symbol<"u"&&(t=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(t&&null!=(e=n[t]))return e.call(n);if(r&&null!=(e=n[r]))return new rv(e.call(n));t="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function rv(n){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var r=t.done;return Promise.resolve(t.value).then(function(i){return{value:i,done:r}})}return(rv=function(r){this.s=r,this.n=r.next}).prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(r){var i=this.s.return;return void 0===i?Promise.resolve({value:r,done:!0}):e(i.apply(this.s,arguments))},throw:function(r){var i=this.s.return;return void 0===i?Promise.reject(r):e(i.apply(this.s,arguments))}},new rv(n)}function vj(n){return n&&"object"==typeof n&&n.isBuffer}function bj(n){if(vj(n))return function Efe(n){return vj(n)?new Uint8Array(n.buffer,n.byteOffset,n.length).slice().buffer:n}(n);if(n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return 0===n.byteOffset&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if("string"==typeof n){const e=n;return(new TextEncoder).encode(e).buffer}if(n&&"object"==typeof n&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function wx(){return wx=j(function*(n){const e=[];var i,t=!1,r=!1;try{for(var o,s=vx(n);t=!(o=yield s.next()).done;t=!1)e.push(o.value)}catch(a){r=!0,i=a}finally{try{t&&null!=s.return&&(yield s.return())}finally{if(r)throw i}}return function Afe(...n){const e=n.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),t=e.reduce((s,o)=>s+o.byteLength,0),r=new Uint8Array(t);let i=0;for(const s of e)r.set(s,i),i+=s.byteLength;return r.buffer}(...e)}),wx.apply(this,arguments)}w(ea,"_workerFarm",void 0),Qe(492);const Ife=262144;function wj(n,e){this.v=n,this.k=e}function iv(n){return new wj(n,0)}function Cx(n){return function(){return new Mp(n.apply(this,arguments))}}function Mp(n){var e,t;function r(s,o){try{var a=n[s](o),c=a.value,l=c instanceof wj;Promise.resolve(l?c.v:c).then(function(u){if(l){var d="return"===s?"return":"next";if(!c.k||u.done)return r(d,u);u=n[d](u).value}i(a.done?"return":"normal",u)},function(u){r("throw",u)})}catch(u){i("throw",u)}}function i(s,o){switch(s){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?r(e.key,e.arg):t=null}this._invoke=function(s,o){return new Promise(function(a,c){var l={key:s,arg:o,resolve:a,reject:c,next:null};t?t=t.next=l:(e=t=l,r(s,o))})},"function"!=typeof n.return&&(this.return=void 0)}function Ax(){return Ax=Cx(function*(n,e){const t=e?.chunkSize||1048576;let r=0;for(;r<n.size;){const i=r+t,s=yield iv(n.slice(r,i).arrayBuffer());r=i,yield s}}),Ax.apply(this,arguments)}function Ej(n,e){return aj?function Ofe(n,e){return Tx.apply(this,arguments)}(n,e):function Pfe(n,e){return xx.apply(this,arguments)}(n,e)}function Tx(){return Tx=Cx(function*(n,e){const t=n.getReader();let r;try{for(;;){const i=r||t.read();null!=e&&e._streamReadAhead&&(r=t.read());const{done:s,value:o}=yield iv(i);if(s)return;yield bj(o)}}catch{t.releaseLock()}}),Tx.apply(this,arguments)}function xx(){return xx=Cx(function*(n,e){var i,t=!1,r=!1;try{for(var o,s=vx(n);t=!(o=yield iv(s.next())).done;t=!1){const a=o.value;yield bj(a)}}catch(a){r=!0,i=a}finally{try{t&&null!=s.return&&(yield iv(s.return()))}finally{if(r)throw i}}}),xx.apply(this,arguments)}Mp.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Mp.prototype.next=function(n){return this._invoke("next",n)},Mp.prototype.throw=function(n){return this._invoke("throw",n)},Mp.prototype.return=function(n){return this._invoke("return",n)};const Sx="Cannot convert supplied data type";function Ix(){return Ix=j(function*(n,e,t){const r=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if("string"==typeof n||r)return function kfe(n,e){if(e.text&&"string"==typeof n)return n;if((n=>n&&"object"==typeof n&&n.isBuffer)(n)&&(n=n.buffer),n instanceof ArrayBuffer){const r=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let r=n.buffer;const i=n.byteLength||n.length;return(0!==n.byteOffset||i!==r.byteLength)&&(r=r.slice(n.byteOffset,n.byteOffset+i)),r}throw new Error(Sx)}(n,e);if(kd(n)&&(n=yield ij(n)),Nd(n)){const i=n;return yield function Yhe(n){return ox.apply(this,arguments)}(i),e.binary?yield i.arrayBuffer():yield i.text()}if(tj(n)&&(n=function Nfe(n,e){if("string"==typeof n)return function*Sfe(n,e){const t=e?.chunkSize||262144;let r=0;const i=new TextEncoder;for(;r<n.length;){const s=Math.min(n.length-r,t),o=n.slice(r,r+s);r+=s,yield i.encode(o)}}(n,e);if(n instanceof ArrayBuffer)return function*Mfe(n,e={}){const{chunkSize:t=Ife}=e;let r=0;for(;r<n.byteLength;){const i=Math.min(n.byteLength-r,t),s=new ArrayBuffer(i),o=new Uint8Array(n,r,i);new Uint8Array(s).set(o),r+=i,yield s}}(n,e);if(kd(n))return function Rfe(n,e){return Ax.apply(this,arguments)}(n,e);if(tj(n))return Ej(n,e);if(Nd(n))return Ej(n.body,e);throw new Error("makeIterator")}(n,t)),(n=>n&&"function"==typeof n[Symbol.iterator])(n)||(n=>n&&"function"==typeof n[Symbol.asyncIterator])(n))return function Tfe(n){return wx.apply(this,arguments)}(n);throw new Error(Sx)}),Ix.apply(this,arguments)}const Vfe=new up({id:"loaders.gl"}),Cj=()=>{const n=ux();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry};function Aj(n){const e=Cj();n=Array.isArray(n)?n:[n];for(const t of n){const r=tx(t);e.find(i=>r===i)||e.unshift(r)}}const zfe=/\.([^.]+)$/;function Rx(){return Rx=j(function*(n,e=[],t,r){if(!xj(n))return null;let i=Tj(n,e,{...t,nothrow:!0},r);if(i)return i;if(kd(n)&&(i=Tj(n=yield n.slice(0,10).arrayBuffer(),e,t,r)),!(i||null!=t&&t.nothrow))throw new Error(Sj(n));return i}),Rx.apply(this,arguments)}function Tj(n,e=[],t,r){if(!xj(n))return null;if(e&&!Array.isArray(e))return tx(e);let i=[];e&&(i=i.concat(e)),null!=t&&t.ignoreRegisteredLoaders||i.push(...function Hfe(){return Cj()}()),function $fe(n){for(const e of n)tx(e)}(i);const s=function Wfe(n,e,t,r){const{url:i,type:s}=nv(n),o=i||r?.url;let a=null,c="";var l;return null!=t&&t.mimeType&&(a=Ox(e,t?.mimeType),c="match forced by supplied MIME type ".concat(t?.mimeType)),a=a||function qfe(n,e){const t=e&&zfe.exec(e),r=t&&t[1];return r?function Xfe(n,e){e=e.toLowerCase();for(const t of n)for(const r of t.extensions)if(r.toLowerCase()===e)return t;return null}(n,r):null}(e,o),c=c||(a?"matched url ".concat(o):""),a=a||Ox(e,s),c=c||(a?"matched MIME type ".concat(s):""),a=a||function Yfe(n,e){if(!e)return null;for(const t of n)if("string"==typeof e){if(Zfe(e,t))return t}else if(ArrayBuffer.isView(e)){if(Ij(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&Ij(e,0,t))return t;return null}(e,n),c=c||(a?"matched initial data ".concat(Mj(n)):""),a=a||Ox(e,t?.fallbackMimeType),c=c||(a?"matched fallback MIME type ".concat(s):""),c&&Vfe.log(1,"selectLoader selected ".concat(null===(l=a)||void 0===l?void 0:l.name,": ").concat(c,".")),a}(n,i,t,r);if(!(s||null!=t&&t.nothrow))throw new Error(Sj(n));return s}function xj(n){return!(n instanceof Response&&204===n.status)}function Sj(n){const{url:e,type:t}=nv(n);let r="No valid loader found (";r+=e?"".concat(function jfe(n){const e=n&&n.lastIndexOf("/");return e>=0?n.substr(e+1):""}(e),", "):"no url provided, ",r+="MIME type: ".concat(t?'"'.concat(t,'"'):"not provided",", ");const i=n?Mj(n):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function Ox(n,e){for(const t of n)if(t.mimeTypes&&t.mimeTypes.includes(e)||e==="application/x.".concat(t.id))return t;return null}function Zfe(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>n.startsWith(r))}function Ij(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(i=>function Kfe(n,e,t,r){if(r instanceof ArrayBuffer)return function Cfe(n,e,t){if(n.byteLength<(t=t||n.byteLength)||e.byteLength<t)return!1;const r=new Uint8Array(n),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(r,n,r.byteLength);switch(typeof r){case"function":return r(n,t);case"string":return r===Px(n,e,r.length);default:return!1}}(n,e,t,i))}function Mj(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?Px(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?Px(n,0,e):""}function Px(n,e,t){if(n.byteLength<e+t)return"";const r=new DataView(n);let i="";for(let s=0;s<t;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}function sv(n,e,t,r){return Nx.apply(this,arguments)}function Nx(){return Nx=j(function*(n,e,t,r){ro(!r||"object"==typeof r),e&&!Array.isArray(e)&&!ex(e)&&(r=void 0,t=e,e=void 0),n=yield n,t=t||{};const{url:i}=nv(n),o=function Ufe(n,e){if(!e&&n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...r]:r}return t&&t.length?t:null}(e,r),a=yield function Gfe(n){return Rx.apply(this,arguments)}(n,o,t);return a?(r=function Bfe(n,e,t=null){if(t)return t;const r={fetch:uj(e,n),...n};return Array.isArray(r.loaders)||(r.loaders=null),r}({url:i,parse:sv,loaders:o},t=nfe(t,a,o,i),r),yield function Jfe(n,e,t,r){return kx.apply(this,arguments)}(a,n,t,r)):null}),Nx.apply(this,arguments)}function kx(){return kx=j(function*(n,e,t,r){if(function afe(n){ro(n,"no worker provided")}(n),Nd(e)){const i=e,{ok:s,redirected:o,status:a,statusText:c,type:l,url:u}=i,d=Object.fromEntries(i.headers.entries());r.response={headers:d,ok:s,redirected:o,status:a,statusText:c,type:l,url:u}}if(e=yield function Ffe(n,e,t){return Ix.apply(this,arguments)}(e,n,t),n.parseTextSync&&"string"==typeof e)return t.dataType="text",n.parseTextSync(e,t,r,n);if(function vfe(n,e){return!(!ea.isSupported()||!(lc||null!=e&&e._nodeWorkers))&&n.worker&&e?.worker}(n,t))return yield function bfe(n,e,t,r,i){return _x.apply(this,arguments)}(n,e,t,r,sv);if(n.parseText&&"string"==typeof e)return yield n.parseText(e,t,r,n);if(n.parse)return yield n.parse(e,t,r,n);throw ro(!n.parseSync),new Error("".concat(n.id," loader - no parser found and worker is disabled"))}),kx.apply(this,arguments)}function Dp(n,e,t,r){return Fx.apply(this,arguments)}function Fx(){return Fx=j(function*(n,e,t,r){!Array.isArray(e)&&!ex(e)&&(t=e,e=void 0);const i=uj(t);let s=n;return"string"==typeof n&&(s=yield i(n)),kd(n)&&(s=yield i(n)),yield sv(s,e,t)}),Fx.apply(this,arguments)}class Qfe{constructor(e,t,r){w(this,"id",void 0),w(this,"context",void 0),w(this,"isLoaded",void 0),w(this,"persistent",void 0),w(this,"_loadCount",0),w(this,"_subscribers",new Set),w(this,"_data",void 0),w(this,"_loader",void 0),w(this,"_error",void 0),w(this,"_content",void 0),this.id=e,this.context=r,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const r=++this._loadCount;let i=e;"string"==typeof e&&(i=Dp(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class epe{constructor({gl:e,protocol:t}){w(this,"protocol",void 0),w(this,"_context",void 0),w(this,"_resources",void 0),w(this,"_consumers",void 0),w(this,"_pruneRequest",void 0),this.protocol=t||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(t,r):(s=new Qfe(e,t,this._context),this._resources[e]=s),s.persistent=i}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const r in t){const i=t[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(s[e=e.replace(o,"")]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,t),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,r,i){const s=this._consumers,o=s[e]=s[e]||{},a=o[t]||{},c=a.resourceId&&this._resources[a.resourceId];c&&(c.unsubscribe(a),this.prune()),r&&(o[t]=a,a.onChange=i,a.resourceId=r.id,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const tpe=[XT],npe=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function rpe(n){const e=Ip.getDefaultProgramManager(n);for(const t of tpe)e.addDefaultModule(t);for(const t of npe)e.addShaderHook(t);return e}class ope{constructor(e,{deck:t,stats:r,viewport:i,timeline:s}={}){w(this,"layers",void 0),w(this,"context",void 0),w(this,"resourceManager",void 0),w(this,"_lastRenderedLayers",[]),w(this,"_needsRedraw",!1),w(this,"_needsUpdate",!1),w(this,"_nextLayers",null),w(this,"_debug",!1),w(this,"activateViewport",o=>{Ar("layerManager.activateViewport",this,o),o&&(this.context.viewport=o)}),this.layers=[],this.resourceManager=new epe({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:t,programManager:e&&rpe(e),stats:r||new PT({id:"deck.gl"}),viewport:i||new ec({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new K3,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);t=t||i}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(t=>e.find(r=>0===t.id.indexOf(r))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){Ar("layerManager.setLayers",this,t,e),this._lastRenderedLayers=e;const r=QT(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,t,r){r.raiseError(t,"".concat(e," of ").concat(r))}_updateLayers(e,t){const r={};for(const o of e)r[o.id]?Je.warn("Multiple old layers with same id ".concat(o.id))():r[o.id]=o;const i=[];this._updateSublayersRecursively(t,r,i),this._finalizeOldLayers(r);let s=!1;for(const o of i)if(o.hasUniformTransition()){s="Uniform transition in ".concat(o);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,t,r){for(const i of e){i.context=this.context;const s=t[i.id];null===s&&Je.warn("Multiple new layers with same id ".concat(i.id))(),t[i.id]=null;let o=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}o&&this._updateSublayersRecursively(o,t,r)}}_finalizeOldLayers(e){for(const t in e){const r=e[t];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle="Initialized"}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle="Matched. State transferred from previous layer",t!==e&&(e.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle="No longer matched. Awaiting garbage collection";try{e._finalize(),e.lifecycle="Finalized! Awaiting garbage collection"}catch(t){this._handleError("finalization",t,e)}}}class ape{constructor(e){w(this,"width",void 0),w(this,"height",void 0),w(this,"views",void 0),w(this,"viewState",void 0),w(this,"controllers",void 0),w(this,"timeline",void 0),w(this,"_viewports",void 0),w(this,"_viewportMap",void 0),w(this,"_isUpdating",void 0),w(this,"_needsRedraw",void 0),w(this,"_needsUpdate",void 0),w(this,"_eventManager",void 0),w(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return this.views.find(t=>t.id===e)}getViewState(e){const t="string"==typeof e?this.getView(e):e,r=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,t){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const o=r[s];if(o.containsPixel(i)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=QT(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Cd(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Je.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...t,viewId:e})}_createController(e,t){return new(0,t.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return null===(o=this.getView(e.id))||void 0===o?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,t,r,i){const s=e.controller;if(s){const o={...t,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return i||(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let c=t[s.id];const l=!!s.controller;l&&!c&&(r=!0),(r||!l)&&c&&(c.finalize(),c=null),this.controllers[s.id]=this._updateController(s,o,a,c),this._viewports.unshift(a)}for(const i in t){const s=t[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((r,i)=>!e[i].equals(t[i]))}}const upe=Math.PI/180;function Dj(n){return 512/4003e4/Math.cos(n*upe)}class uc extends ec{constructor(e={}){const{latitude:t=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:c=1.01,orthographic:l=!1,projectionMatrix:u,repeat:d=!1,worldOffset:h=0,legacyMeterSizes:f=!1}=e;let{width:p,height:g,altitude:m=1.5}=e;const y=Math.pow(2,i);p=p||1,g=g||1;let v,_=null;u?(m=u[5]/2,v=jy(m)):(e.fovy?(v=e.fovy,m=dT(v)):v=jy(m),_=function bU(n){const{width:e,height:t,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:c=1,farZMultiplier:l=1}=n;let{fovy:u=jy(mce)}=n;void 0!==r&&(u=jy(r));const d=u*Wi,h=i*Wi,f=dT(u);let p=f;o&&(p+=o[2]*a/Math.cos(h)/t);const g=d*(.5+(s?s[1]:0)/t),m=Math.sin(g)*p/Math.sin(aT(Math.PI/2-h-g,.01,Math.PI-.01)),y=Math.sin(h)*m+p;return{fov:d,aspect:e/t,focalDistance:f,near:c,far:Math.min(y*l,10*p)}}({width:p,height:g,pitch:s,fovy:v,nearZMultiplier:a,farZMultiplier:c}));let E=function vce(n){const{height:e,pitch:t,bearing:r,altitude:i,scale:s,center:o}=n,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Py(a,a,[0,0,-i]),uU(a,a,-t*Wi),dU(a,a,r*Wi);const c=s/e;return iT(a,a,[c,c,c]),o&&Py(a,a,function pae(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}([],o)),a}({height:g,pitch:s,bearing:o,scale:y,altitude:m});h&&(E=(new Ve).translate([512*h,0,0]).multiplyLeft(E)),super({...e,width:p,height:g,viewMatrix:E,longitude:r,latitude:t,zoom:i,..._,fovy:v,focalDistance:m}),w(this,"longitude",void 0),w(this,"latitude",void 0),w(this,"pitch",void 0),w(this,"bearing",void 0),w(this,"altitude",void 0),w(this,"fovy",void 0),w(this,"orthographic",void 0),w(this,"_subViewports",void 0),w(this,"_pseudoMeters",void 0),this.latitude=t,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=m,this.fovy=v,this.orthographic=l,this._subViewports=d?[]:null,this._pseudoMeters=f,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=t;i<=r;i++){const s=i?new uc({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,r]=this.projectFlat(e);return[t,r,(e[2]||0)*Dj(e[1])]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,r]=this.unprojectFlat(e);return[t,r,(e[2]||0)/Dj(r)]}addMetersToLngLat(e,t){return vU(e,t)}panByPosition(e,t){const r=gp(t,this.pixelUnprojectionMatrix),s=Ny([],this.projectFlat(e),hU([],r)),o=Ny([],this.center,s),[a,c]=this.unprojectFlat(o);return{longitude:a,latitude:c}}getBounds(e={}){const t=function wce(n,e=0){const{width:t,height:r,unproject:i}=n,s={targetZ:e},o=i([0,r],s),a=i([t,r],s);let c,l;return(n.fovy?.5*n.fovy*CU:Math.atan(.5/n.altitude))>(90-n.pitch)*CU-.01?(c=AU(n,0,e),l=AU(n,t,e)):(c=i([0,0],s),l=i([t,0],s)),[o,a,l,c]}(this,e.z||0);return[Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),Math.min(t[0][1],t[1][1],t[2][1],t[3][1]),Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),Math.max(t[0][1],t[1][1],t[2][1],t[3][1])]}fitBounds(e,t={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=EU({width:r,height:i,bounds:e,...t});return new uc({width:r,height:i,longitude:s,latitude:o,zoom:a})}}w(uc,"displayName","WebMercatorViewport");class hpe extends OU{constructor(e){const{width:t,height:r,latitude:i,longitude:s,zoom:o,bearing:a=0,pitch:c=0,altitude:l=1.5,position:u=[0,0,0],maxZoom:d=20,minZoom:h=0,maxPitch:f=60,minPitch:p=0,startPanLngLat:g,startZoomLngLat:m,startRotatePos:y,startBearing:v,startPitch:_,startZoom:E,normalize:T=!0}=e;sr(Number.isFinite(s)),sr(Number.isFinite(i)),sr(Number.isFinite(o)),super({width:t,height:r,latitude:i,longitude:s,zoom:o,bearing:a,pitch:c,altitude:l,maxZoom:d,minZoom:h,maxPitch:f,minPitch:p,normalize:T,position:u},{startPanLngLat:g,startZoomLngLat:m,startRotatePos:y,startBearing:v,startPitch:_,startZoom:E}),w(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const r=this.getState().startPanLngLat||this._unproject(t);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||void 0===s||void 0===o)return this;let a;return a=e?this._getNewRotation(e,i,o,s):{bearing:s+t,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:t,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(t)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let c=i+Math.log2(r);c=ir(c,a,o);const l=this.makeViewport({...this.getViewportProps(),zoom:c});return this._getUpdatedState({zoom:c,...l.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-t.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-t.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:t,minZoom:r,zoom:i}=e;e.zoom=ir(i,r,t);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=ir(a,o,s);const{normalize:c=!0}=e;return c&&Object.assign(e,function Ece(n){const{width:e,height:t,pitch:r=0}=n;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=n;(i<-180||i>180)&&(i=_U(i+180,360)-180),(a<-180||a>180)&&(a=_U(a+180,360)-180);const c=cT(t/512);if(o<=c)o=c,s=0;else{const l=t/2/Math.pow(2,o),u=Ed([0,l])[1];if(s<u)s=u;else{const d=Ed([0,512-l])[1];s>d&&(s=d)}}return{width:e,height:t,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}(e)),e}_zoomFromCenter(e){const{width:t,height:r}=this.getViewportProps();return this.zoom({pos:[t/2,r/2],scale:e})}_panFromCenter(e){const{width:t,height:r}=this.getViewportProps();return this.pan({startPos:[t/2,r/2],pos:[t/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,r,i){const s=e[0]-t[0],o=e[1]-t[1],a=e[1],c=t[1],{width:l,height:u}=this.getViewportProps(),d=s/l;let h=0;o>0?Math.abs(u-c)>5&&(h=o/(c-u)*1.2):o<0&&c>5&&(h=1-a/c),h=ir(h,-1,1);const{minPitch:f,maxPitch:p}=this.getViewportProps();let m=r;return h>0?m=r+h*(p-r):h<0&&(m=r-h*(f-r)),{pitch:m,bearing:i+180*d}}}class fpe extends gT{constructor(...e){super(...e),w(this,"ControllerState",hpe),w(this,"transition",{transitionDuration:300,transitionInterpolator:new Hy({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),w(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Oj extends fT{get ViewportType(){return uc}get ControllerType(){return fpe}}w(Oj,"displayName","MapView");class ppe extends Qy{constructor(e,t){super(e,t),w(this,"maskMap",void 0),w(this,"fbo",void 0);const{mapSize:r=2048}=t;this.maskMap=new or(e,{width:r,height:r,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.fbo=new xn(e,{id:"maskmap",width:r,height:r,attachments:{36064:this.maskMap}})}render(e){const t=this.gl,r=[!1,!1,!1,!1];return r[e.channel]=!0,$i(t,{clearColor:[255,255,255,255],blend:!0,blendFunc:[0,1],blendEquation:32778,colorMask:r,depthTest:!1},()=>super.render({...e,target:this.fbo,pass:"mask"}))}shouldDrawLayer(e){return"mask"===e.props.operation}delete(){this.fbo.delete(),this.maskMap.delete()}}class ype{constructor(){w(this,"id","mask-effect"),w(this,"props",null),w(this,"useInPicking",!0),w(this,"dummyMaskMap",void 0),w(this,"channels",[]),w(this,"masks",null),w(this,"maskPass",void 0),w(this,"maskMap",void 0),w(this,"lastViewport",void 0)}preRender(e,{layers:t,layerFilter:r,viewports:i,onViewportActive:s,views:o}){this.dummyMaskMap||(this.dummyMaskMap=new or(e,{width:1,height:1}));const a=t.filter(d=>d.props.visible&&"mask"===d.props.operation);if(0===a.length)return this.masks=null,void(this.channels.length=0);this.masks={},this.maskPass||(this.maskPass=new ppe(e,{id:"default-mask"}),this.maskMap=this.maskPass.maskMap);const c=this._sortMaskChannels(a),l=i[0],u=!this.lastViewport||!this.lastViewport.equals(l);for(const d in c)this._renderChannel(c[d],{layerFilter:r,onViewportActive:s,views:o,viewport:l,viewportChanged:u})}_renderChannel(e,{layerFilter:t,onViewportActive:r,views:i,viewport:s,viewportChanged:o}){const a=this.channels[e.index];if(!a)return;const c=e===a||a.layers.length!==e.layers.length||e.layerBounds.some((l,u)=>l!==a.layerBounds[u]);if(e.bounds=a.bounds,e.maskBounds=a.maskBounds,this.channels[e.index]=e,(c||o)&&(this.lastViewport=s,e.bounds=function gpe({layers:n,viewport:e}){let t=null;for(const s of n){const o=s.getBounds();o&&(t?(t[0]=Math.min(t[0],o[0][0]),t[1]=Math.min(t[1],o[0][1]),t[2]=Math.max(t[2],o[1][0]),t[3]=Math.max(t[3],o[1][1])):t=[o[0][0],o[0][1],o[1][0],o[1][1]])}const r=e.getBounds();if(!t)return r;const i=function _pe(n){const e_x=n[2]-n[0],e_y=n[3]-n[1],t_x=n[0]+.5*e_x,t_y=n[1]+.5*e_y;return[t_x-e_x,t_y-e_y,t_x+e_x,t_y+e_y]}(r);return t[2]-t[0]<i[2]-i[0]||t[3]-t[1]<i[3]-i[1]||(t[0]=Math.max(t[0],i[0]),t[1]=Math.max(t[1],i[1]),t[2]=Math.min(t[2],i[2]),t[3]=Math.min(t[3],i[3])),t}({layers:e.layers,viewport:s}),c||!yd(e.bounds,a.bounds))){const{maskPass:l,maskMap:u}=this,d=function mpe({bounds:n,viewport:e,width:t,height:r}){if(n[2]<=n[0]||n[3]<=n[1])return null;if(t-=2,r-=2,e instanceof uc){const{longitude:a,latitude:c,zoom:l}=EU({width:t,height:r,bounds:[[n[0],n[1]],[n[2],n[3]]],maxZoom:20});return new uc({longitude:a,latitude:c,zoom:l,x:1,y:1,width:t,height:r})}const s=[(n[0]+n[2])/2,(n[1]+n[3])/2,0],o=Math.min(20,t/(n[2]-n[0]),r/(n[3]-n[1]));return new mT({x:1,y:1}).makeViewport({width:t,height:r,viewState:{target:s,zoom:Math.log2(o)}})}({bounds:e.bounds,viewport:s,width:u.width,height:u.height});e.maskBounds=d?d.getBounds():[0,0,1,1],l.render({pass:"mask",channel:e.index,layers:e.layers,layerFilter:t,viewports:d?[d]:[],onViewportActive:r,views:i,moduleParameters:{devicePixelRatio:1}})}this.masks[e.id]={index:e.index,bounds:e.maskBounds,coordinateOrigin:e.coordinateOrigin,coordinateSystem:e.coordinateSystem}}_sortMaskChannels(e){const t={};let r=0;for(const i of e){const{id:s}=i.root;let o=t[s];if(!o){if(++r>4){Je.warn("Too many mask layers. The max supported is 4")();continue}o={id:s,index:this.channels.findIndex(a=>a?.id===s),layers:[],layerBounds:[],coordinateOrigin:i.root.props.coordinateOrigin,coordinateSystem:i.root.props.coordinateSystem},t[s]=o}o.layers.push(i),o.layerBounds.push(i.getBounds())}for(let i=0;i<4;i++){const s=this.channels[i];(!s||!(s.id in t))&&(this.channels[i]=null)}for(const i in t){const s=t[i];s.index<0&&(s.index=this.channels.findIndex(o=>!o),this.channels[s.index]=s)}return t}getModuleParameters(){return{maskMap:this.masks?this.maskMap:this.dummyMaskMap,maskChannels:this.masks}}cleanup(){this.dummyMaskMap&&(this.dummyMaskMap.delete(),this.dummyMaskMap=void 0),this.maskPass&&(this.maskPass.delete(),this.maskPass=void 0,this.maskMap=void 0),this.lastViewport=void 0,this.masks=null,this.channels.length=0}}const vpe=new KT;class bpe{constructor(){w(this,"effects",void 0),w(this,"_internalEffects",void 0),w(this,"_needsRedraw",void 0),this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!Cd(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._internalEffects=e.slice(),this._internalEffects.push(new ype),e.some(t=>t instanceof KT)||this._internalEffects.push(vpe)}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}}class wpe extends Qy{shouldDrawLayer(e){return"draw"===e.props.operation}}const Pj={blendFunc:[1,0,32771,0],blendEquation:32774};class Nj extends Qy{constructor(...e){super(...e),w(this,"pickZ",void 0),w(this,"_colors",null)}render(e){return e.pickingFBO?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:t,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:c,width:l,height:u},cullRect:d,effects:h,pass:f="picking",pickZ:p}){const g=this.gl;this.pickZ=p;const m=p?null:{byLayer:new Map,byAlpha:[]};this._colors=m;const y=$i(g,{scissorTest:!0,scissor:[a,c,l,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...Pj,blend:!p},()=>super.render({target:o,layers:e,layerFilter:t,views:r,viewports:i,onViewportActive:s,cullRect:d,effects:h?.filter(_=>_.useInPicking),pass:f}));return this._colors=null,{decodePickingColor:m&&Cpe.bind(null,m),stats:y}}shouldDrawLayer(e){return e.props.pickable&&"draw"===e.props.operation}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t,r){const i={...e.props.parameters};return this._colors?(Object.assign(i,Pj),i.blend=!0,i.blendColor=function Epe(n,e,t){const{byLayer:r,byAlpha:i}=n;let s,o=r.get(e);return o?(o.viewports.push(t),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:e,viewports:[t]},r.set(e,o),i[s]=o):(Je.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}(this._colors,e,r)):i.blend=!1,i}}function Cpe(n,e){const t=n.byAlpha[e[3]];return t&&{pickedLayer:t.layer,pickedViewports:t.viewports,pickedObjectIndex:t.layer.decodePickingColor(e)}}class Tpe{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new wpe(e),this.pickLayersPass=new Nj(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=e.layerFilter||this.layerFilter,e.effects=e.effects||[],e.target=e.target||xn.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const r=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,i=t.render({...e,target:r});this._postRender(e.effects,e),this.renderCount++,Ar("deckRenderer.renderLayers",this,i,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){let r=null;for(const i of e)i.preRender(this.gl,t),i.postRender&&(r=i);r&&this._resizeRenderBuffers(),this.lastPostProcessEffect=r}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new xn(this.gl),new xn(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:r}=this,i={inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){i.target=t.target,s.postRender(this.gl,i);break}const o=s.postRender(this.gl,i);i.inputBuffer=o,i.swapBuffer=o===r[0]?r[1]:r[0]}}}const xpe={pickedColor:null,pickedObjectIndex:-1};function Spe({pickedColors:n,decodePickingColor:e,deviceX:t,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:o,y:a,width:c,height:l}=s;let u=i*i,d=-1,h=0;for(let f=0;f<l;f++){const p=f+a-r,g=p*p;if(g>u)h+=4*c;else for(let m=0;m<c;m++){if(n[h+3]-1>=0){const v=m+o-t,_=v*v+g;_<=u&&(u=_,d=h)}h+=4}}if(d>=0){const f=n.slice(d,d+4),p=e(f);if(p){const g=Math.floor(d/4/c),m=d/4-g*c;return{...p,pickedColor:f,pickedX:o+m,pickedY:a+g}}Je.error("Picked non-existent layer. Is picking buffer corrupt?")()}return xpe}function kj({pickInfo:n,viewports:e,pixelRatio:t,x:r,y:i,z:s}){let a,o=e[0];if(e.length>1&&(o=function Dpe(n,e){for(let t=n.length-1;t>=0;t--){const r=n[t];if(r.containsPixel(e))return r}return n[0]}(n?.pickedViewports||e,{x:r,y:i})),o){const c=[r-o.x,i-o.y];void 0!==s&&(c[2]=s),a=o.unproject(c)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:n&&"pickedX"in n?[n.pickedX,n.pickedY]:void 0,pixelRatio:t}}function Mpe(n){const{pickInfo:e,lastPickedInfo:t,mode:r,layers:i}=n,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,c=o?[o]:[];if("hover"===r){const h=t.layerId,f=o?o.props.id:null;if(f!==h||a!==t.index){if(f!==h){const p=i.find(g=>g.props.id===h);p&&c.unshift(p)}t.layerId=f,t.index=a,t.info=null}}const l=kj(n),u=new Map;return u.set(null,l),c.forEach(d=>{let h={...l};d===o&&(h.color=s,h.index=a,h.picked=!0),h=Fj({layer:d,info:h,mode:r});const f=h.layer;d===o&&"hover"===r&&(t.info=h),u.set(f.id,h),"hover"===r&&f.updateAutoHighlight(h)}),u}function Fj({layer:n,info:e,mode:t}){for(;n&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:r}),n=n.parent}return e}class Rpe{constructor(e){w(this,"gl",void 0),w(this,"pickingFBO",void 0),w(this,"depthFBO",void 0),w(this,"pickLayersPass",void 0),w(this,"layerFilter",void 0),w(this,"lastPickedInfo",void 0),w(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new Nj(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:r,viewports:i},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,c=o?r.find(h=>h.id===o):null,l=a&&i.find(h=>h.id===a)||i[0],u=l&&l.unproject([e-l.x,t-l.y]);return{...s,x:e,y:t,viewport:l,coordinate:u,layer:c}}_resizeBuffer(){var e,t;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new xn(r),xn.isSupported(r,{colorBufferFloat:!0}))){const i=new xn(r);i.attach({36064:new or(r,{format:Xe(r)?34836:6408,type:5126})}),this.depthFBO=i}null===(e=this.pickingFBO)||void 0===e||e.resize({width:r.canvas.width,height:r.canvas.height}),null===(t=this.depthFBO)||void 0===t||t.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(r=>r.isPickable()&&!r.isComposite);return t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:c="query",unproject3D:l,onViewportActive:u,effects:d}){const h=this._getPickable(e),f=xd(this.gl);if(!h)return{result:[],emptyInfo:kj({viewports:r,x:i,y:s,pixelRatio:f})};this._resizeBuffer();const p=DT(this.gl,[i,s],!0),g=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],m=Math.round(o*f),{width:y,height:v}=this.pickingFBO,_=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceWidth:y,deviceHeight:v}),E={x:i-o,y:s-o,width:2*o+1,height:2*o+1};let T;const I=[],D=new Set;for(let M=0;M<a;M++){let k,B;k=_?Spe({...this._drawAndSample({layers:h,views:t,viewports:r,onViewportActive:u,deviceRect:_,cullRect:E,effects:d,pass:"picking:".concat(c)}),deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceRect:_}):{pickedColor:null,pickedObjectIndex:-1},k.pickedLayer&&l&&this.depthFBO&&(B=this._drawAndSample({layers:[k.pickedLayer],views:t,viewports:r,onViewportActive:u,deviceRect:{x:k.pickedX,y:k.pickedY,width:1,height:1},cullRect:E,effects:d,pass:"picking:".concat(c,":z")},!0).pickedColors[0]),k.pickedLayer&&M+1<a&&(D.add(k.pickedLayer),k.pickedLayer.disablePickingIndex(k.pickedObjectIndex)),T=Mpe({pickInfo:k,lastPickedInfo:this.lastPickedInfo,mode:c,layers:h,viewports:r,x:i,y:s,z:B,pixelRatio:f});for(const L of T.values())L.layer&&I.push(L);if(!k.pickedColor)break}for(const M of D)M.restorePickingColors();return{result:I,emptyInfo:T.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:c="query",maxObjects:l=null,onViewportActive:u,effects:d}){const h=this._getPickable(e);if(!h)return[];this._resizeBuffer();const f=xd(this.gl),p=DT(this.gl,[i,s],!0),g=p.x,m=p.y+p.height,y=DT(this.gl,[i+o,s+a],!0),_=y.y,I=function Ipe({pickedColors:n,decodePickingColor:e}){const t=new Map;if(n)for(let r=0;r<n.length;r+=4)if(n[r+3]-1>=0){const s=n.slice(r,r+4),o=s.join(",");if(!t.has(o)){const a=e(s);a?t.set(o,{...a,color:s}):Je.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(t.values())}(this._drawAndSample({layers:h,views:t,viewports:r,onViewportActive:u,deviceRect:{x:g,y:_,width:y.x+y.width-g,height:m-_},cullRect:{x:i,y:s,width:o,height:a},effects:d,pass:"picking:".concat(c)})),D=new Map,M=Number.isFinite(l);for(let k=0;k<I.length&&!(M&&l&&D.size>=l);k++){const B=I[k];let L={color:B.pickedColor,layer:null,index:B.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:f};L=Fj({layer:B.pickedLayer,info:L,mode:c}),D.has(L.object)||D.set(L.object,L)}return Array.from(D.values())}_drawAndSample({layers:e,views:t,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:c},l=!1){const u=l?this.depthFBO:this.pickingFBO,{decodePickingColor:d}=this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:t,viewports:r,onViewportActive:i,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:c,pickZ:l}),{x:h,y:f,width:p,height:g}=s,m=new(l?Float32Array:Uint8Array)(p*g*4);return Yy(u,{sourceX:h,sourceY:f,sourceWidth:p,sourceHeight:g,target:m}),{pickedColors:m,decodePickingColor:d}}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const o=Math.max(0,e-r),a=Math.max(0,t-r),c=Math.min(i,e+r+1)-o,l=Math.min(s,t+r+1)-a;return c<=0||l<=0?null:{x:o,y:a,width:c,height:l}}}const Ope={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class Ppe{constructor(e){w(this,"el",null),w(this,"isVisible",!1);const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,Ope),t.appendChild(this.el))}setTooltip(e,t,r){const i=this.el;if(i){if("string"==typeof e)i.innerText=e;else{if(!e)return this.isVisible=!1,void(i.style.display="none");e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className),Object.assign(i.style,e.style)}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(t,"px, ").concat(r,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}function Lj(n,e){if(!n)throw new Error(e||"loader assertion failed.")}typeof self<"u"&&self,typeof window<"u"&&window,typeof global<"u"&&global,typeof document<"u"&&document;const kpe=!("object"==typeof process&&"[object process]"===String(process)&&!process.browser),Bj=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:Fpe}=(Bj&&parseFloat(Bj[1]),globalThis),Lx=typeof Image<"u",Bx=typeof ImageBitmap<"u",Ux=!!kpe||!!Fpe;function Uj(n){const e=function Vj(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&n instanceof Image?"image":n&&"object"==typeof n&&n.data&&n.width&&n.height?"data":null}(n);if(!e)throw new Error("Not an image");return e}const Upe=/^data:image\/svg\+xml/,jpe=/\.svg((\?|#).*)?$/;function jx(n){return n&&(Upe.test(n)||jpe.test(n))}function Hj(n,e){if(jx(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}function zj(n,e,t){return Vx.apply(this,arguments)}function Vx(){return Vx=j(function*(n,e,t){const r=function Vpe(n,e){if(jx(e)){let r=(new TextDecoder).decode(n);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return Hj(n,e)}(n,t),i=self.URL||self.webkitURL,s="string"!=typeof r&&i.createObjectURL(r);try{return yield function Hpe(n,e){return Hx.apply(this,arguments)}(s||r,e)}finally{s&&i.revokeObjectURL(s)}}),Vx.apply(this,arguments)}function Hx(){return Hx=j(function*(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(yield t.decode(),t):yield new Promise((r,i)=>{try{t.onload=()=>r(t),t.onerror=s=>i(new Error("Could not load image ".concat(n,": ").concat(s)))}catch(s){i(s)}})}),Hx.apply(this,arguments)}const zpe={};let Gj=!0;function zx(){return zx=j(function*(n,e,t){let r;r=jx(t)?yield zj(n,e,t):Hj(n,t);const i=e&&e.imagebitmap;return yield function Wpe(n){return Gx.apply(this,arguments)}(r,i)}),zx.apply(this,arguments)}function Gx(){return Gx=j(function*(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if((function $pe(n){for(const e in n||zpe)return!1;return!0}(e)||!Gj)&&(e=null),e)try{return yield createImageBitmap(n,e)}catch(t){console.warn(t),Gj=!1}return yield createImageBitmap(n)}),Gx.apply(this,arguments)}const oo=!1,Rp=!0;function Wj(n){const e=Op(n);return function Qpe(n){const e=Op(n);return e.byteLength>=24&&2303741511===e.getUint32(0,oo)?{mimeType:"image/png",width:e.getUint32(16,oo),height:e.getUint32(20,oo)}:null}(e)||function nge(n){const e=Op(n);if(!(e.byteLength>=3&&65496===e.getUint16(0,oo)&&255===e.getUint8(2)))return null;const{tableMarkers:r,sofMarkers:i}=function rge(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,oo);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,oo),width:e.getUint16(s+7,oo)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,oo)}return null}(e)||function ege(n){const e=Op(n);return e.byteLength>=10&&1195984440===e.getUint32(0,oo)?{mimeType:"image/gif",width:e.getUint16(6,Rp),height:e.getUint16(8,Rp)}:null}(e)||function tge(n){const e=Op(n);return e.byteLength>=14&&16973===e.getUint16(0,oo)&&e.getUint32(2,Rp)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Rp),height:e.getUint32(22,Rp)}:null}(e)||function Jpe(n){const t=function qpe(n){return function Kpe(n,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=function Zpe(n){return[...n].map(e=>e.charCodeAt(0))}(e);for(let i=0;i<r.length;++i)if(r[i]!==n[i+t])return!1;return!0}(n,"ftyp",4)&&96&n[8]?function Xpe(n){switch(function Ype(n,e,t){return String.fromCharCode(...n.slice(e,t))}(n,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}(n):null}(new Uint8Array(n instanceof DataView?n.buffer:n));return t?{mimeType:t.mimeType,width:0,height:0}:null}(e)}function Op(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}function Wx(){return Wx=j(function*(n,e){const{mimeType:t}=Wj(n)||{},r=globalThis._parseImageNode;return Lj(r),yield r(n,t)}),Wx.apply(this,arguments)}function $x(){return $x=j(function*(n,e,t){const i=((e=e||{}).image||{}).type||"auto",{url:s}=t||{},o=function oge(n){switch(n){case"auto":case"data":return function Bpe(){if(Bx)return"imagebitmap";if(Lx)return"image";if(Ux)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function Lpe(n){switch(n){case"auto":return Bx||Lx||Ux;case"imagebitmap":return Bx;case"image":return Lx;case"data":return Ux;default:throw new Error("@loaders.gl/images: image ".concat(n," not supported in this environment"))}}(n),n}}(i);let a;switch(o){case"imagebitmap":a=yield function Gpe(n,e,t){return zx.apply(this,arguments)}(n,e,s);break;case"image":a=yield zj(n,e,s);break;case"data":a=yield function ige(n,e){return Wx.apply(this,arguments)}(n,e);break;default:Lj(!1)}return"data"===i&&(a=function jj(n){switch(Uj(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}(a)),a}),$x.apply(this,arguments)}const $j={id:"image",module:"images",name:"Images",version:"3.4.15",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:function sge(n,e,t){return $x.apply(this,arguments)},tests:[n=>!!Wj(new DataView(n))],options:{image:{type:"auto",decode:!0}}},cge={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function age(n){const e=n[0],t=n[n.length-1];return"{"===e&&"}"===t||"["===e&&"]"===t},parseTextSync:JSON.parse},Pp="8.8.27",ov=globalThis.deck&&globalThis.deck.VERSION;if(ov&&ov!==Pp)throw new Error("deck.gl - multiple versions detected: ".concat(ov," vs ").concat(Pp));ov||(Je.log(1,"deck.gl ".concat(Pp))(),globalThis.deck={...globalThis.deck,VERSION:Pp,version:Pp,log:Je,_registerLoggers:function Nhe(n){JT=n}},Aj([cge,[$j,{imagebitmap:{premultiplyAlpha:"none"}}]]));const lge=globalThis.deck,av=globalThis;function qj(n){if(!n&&!Js())return"Node";if(X2(n))return"Electron";const t=n||(typeof navigator<"u"?navigator:{}).userAgent||"";if(t.indexOf("Edge")>-1)return"Edge";const r=-1!==t.indexOf("MSIE "),i=-1!==t.indexOf("Trident/");return r||i?"IE":av.chrome?"Chrome":av.safari?"Safari":av.mozInnerScreenX?"Firefox":"Unknown"}class cv extends Jo{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const r=Xe(e),i=T3(e,"TIMER_QUERY");let s=r||i;for(const o of t)switch(o){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:te(!1)}return s}constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):t++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return cv.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const Xj=Js()&&typeof document<"u";let vge=0;class bge{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{onCreateContext:t=m=>c3(m),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:o=()=>{},onError:a,gl:c=null,glOptions:l={},debug:u=!1,createFramebuffer:d=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:f=!0,stats:p=fl.get("animation-loop-".concat(vge++))}=e;let{useDevicePixels:g=!0}=e;"useDevicePixelRatio"in e&&(ue.deprecated("useDevicePixelRatio","useDevicePixels")(),g=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:o,onError:a,gl:c,glOptions:l,debug:u,createFramebuffer:d},this.gl=c,this.needsRedraw=null,this.timeline=null,this.stats=p,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:f,useDevicePixels:g}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return te("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=cv.isSupported(this.gl,["timers"])?new cv(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),!1!==r&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}toDataURL(){var e=this;return j(function*(){return e.setNeedsRedraw("toDataURL"),yield e.waitForRender(),e.gl.canvas.toDataURL()})()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):t}setViewParameters(){return ue.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Xj?new Promise((e,t)=>{Xj&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):function yge(n){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):function _ge(n){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}(e)}_renderFrame(){this.display?this.display._renderFrame(...arguments):this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?OT(this.props.gl,e):this.onCreateContext(e),!qy(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(function fue(n){Ko(n,MT)})(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const r=this.props.onAddHTML(t);r&&(t.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&t>0&&(r=e/t),{width:e,height:t,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function yue(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n.canvas){const r=function pue(n){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(n)?n<=0?1:n:n?e:1}(e.useDevicePixels);return void function Cue(n,e,t){let r="width"in t?t.width:n.canvas.clientWidth,i="height"in t?t.height:n.canvas.clientHeight;(!r||!i)&&(ue.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=n.canvas.width||1,i=n.canvas.height||1),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{};const s=n.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),c=Math.floor(i*o);n.canvas.width=a,n.canvas.height=c,(n.drawingBufferWidth!==a||n.drawingBufferHeight!==c)&&(ue.warn("Device pixel ratio clamped")(),o=Math.min(n.drawingBufferWidth/r,n.drawingBufferHeight/i),n.canvas.width=Math.floor(r*o),n.canvas.height=Math.floor(i*o)),Object.assign(n.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}(n,r,e)}const t=n.getExtension("STACKGL_resize_drawingbuffer");t&&"width"in e&&"height"in e&&t.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new xn(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var lv=Qe(511);const wge={mousedown:1,mousemove:2,mouseup:4};(function Cge(n){const e=n.prototype.handler;n.prototype.handler=function(r){const i=this.store;r.button>0&&"pointerdown"===r.type&&(function Ege(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return!0;return!1}(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}})(lv.PointerEventInput),function Age(n){n.prototype.handler=function(t){let r=wge[t.type];1&r&&t.button>=0&&(this.pressed=!0),2&r&&0===t.buttons&&(r=4),this.pressed&&(4&r&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}(lv.MouseInput);const Tge=lv.Manager,ao=lv;class uv{constructor(e,t,r){this.element=e,this.callback=t,this.options={enable:!0,...r}}}const xge=ao?[[ao.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[ao.Rotate,{enable:!1}],[ao.Pinch,{enable:!1}],[ao.Swipe,{enable:!1}],[ao.Pan,{threshold:0,enable:!1}],[ao.Press,{enable:!1}],[ao.Tap,{event:"doubletap",taps:2,enable:!1}],[ao.Tap,{event:"anytap",enable:!1}],[ao.Tap,{enable:!1}]]:null,Kj={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Sge={doubletap:["tap"]},Ige={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Xx={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Mge={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},Jj={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Dge=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Fd=typeof window<"u"?window:global;typeof global<"u"?global:window,typeof document<"u"&&document;let Yx=!1;try{Fd.addEventListener("test",null,{get passive(){return Yx=!0,!0}}),Fd.removeEventListener("test",null)}catch{Yx=!1}const Rge=-1!==Dge.indexOf("firefox"),{WHEEL_EVENTS:Oge}=Xx,eV=4.000244140625;class kge extends uv{constructor(e,t,r){super(e,t,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;Fd.WheelEvent&&(Rge&&i.deltaMode===Fd.WheelEvent.DOM_DELTA_PIXEL&&(s/=Fd.devicePixelRatio),i.deltaMode===Fd.WheelEvent.DOM_DELTA_LINE&&(s*=40)),0!==s&&s%eV==0&&(s=Math.floor(s/eV)),i.shiftKey&&s&&(s*=.25),this.callback({type:"wheel",center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(Oge),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,!!Yx&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}}const{MOUSE_EVENTS:Fge}=Xx,tV="pointermove",nV="pointerover",rV="pointerout",iV="pointerenter",sV="pointerleave";class Lge extends uv{constructor(e,t,r){super(e,t,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(Fge),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===tV&&(this.enableMoveEvent=t),e===nV&&(this.enableOverEvent=t),e===rV&&(this.enableOutEvent=t),e===iV&&(this.enableEnterEvent=t),e===sV&&(this.enableLeaveEvent=t)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this._emit(nV,e)}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this._emit(rV,e)}handleEnterEvent(e){this.enableEnterEvent&&"mouseenter"===e.type&&this._emit(iV,e)}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this._emit(sV,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.buttons&&(this.pressed=!1),this.pressed||this._emit(tV,e);break;case"mouseup":this.pressed=!1}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const{KEY_EVENTS:Bge}=Xx,oV="keydown";class Uge extends uv{constructor(e,t,r){super(e,t,r),this.handleEvent=i=>{const s=i.target||i.srcElement;"INPUT"===s.tagName&&"text"===s.type||"TEXTAREA"===s.tagName||(this.enableDownEvent&&"keydown"===i.type&&this.callback({type:oV,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&"keyup"===i.type&&this.callback({type:"keyup",srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Bge),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===oV&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}}const cV="contextmenu";class jge extends uv{constructor(e,t,r){super(e,t,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:cV,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===cV&&(this.options.enable=t)}}const Vge={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};function Xge(n){const e=Vge[n.srcEvent.type];if(!e)return null;const{buttons:t,button:r}=n.srcEvent;let i=!1,s=!1,o=!1;return 2===e?(i=!!(1&t),s=!!(4&t),o=!!(2&t)):(i=0===r,s=1===r,o=2===r),{leftButton:i,middleButton:s,rightButton:o}}function Yge(n,e){const t=n.center;if(!t)return null;const r=e.getBoundingClientRect();return{center:t,offsetCenter:{x:(t.x-r.left-e.clientLeft)/(r.width/e.offsetWidth||1),y:(t.y-r.top-e.clientTop)/(r.height/e.offsetHeight||1)}}}const Kx={srcElement:"root",priority:0};class Zge{constructor(e){this.handleEvent=t=>{if(this.isEmpty())return;const r=this._normalizeEvent(t);let i=t.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,r,i=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let c=Kx;"string"==typeof r||r&&r.addEventListener?c={...Kx,srcElement:r}:r&&(c={...Kx,...r});let l=a.get(c.srcElement);l||(l=[],a.set(c.srcElement,l));const u={type:e,handler:t,srcElement:c.srcElement,priority:c.priority};i&&(u.once=!0),s&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let d=l.length-1;for(;d>=0&&!(l[d].priority>=u.priority);)d--;l.splice(d+1,0,u)}remove(e,t){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.type===e&&o.handler===t){r.splice(s,1);const a=i.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&i.delete(o.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,t){const r=this.handlersByElement.get(t);if(r){let i=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,i=!0},a=[];for(let c=0;c<r.length;c++){const{type:l,handler:u,once:d}=r[c];if(u({...e,type:l,stopPropagation:s,stopImmediatePropagation:o}),d&&a.push(r[c]),i)break}for(let c=0;c<a.length;c++){const{type:l,handler:u}=a[c];this.remove(l,u)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return{...e,...Xge(e),...Yge(e,t),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t}}}const Kge={events:null,recognizers:null,recognizerOptions:{},Manager:Tge,touchAction:"none",tabIndex:0};class Jge{constructor(e=null,t){this._onBasicInput=i=>{const{srcEvent:s}=i,o=Ige[s.type];o&&this.manager.emit(o,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...Kge,...t},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this;this.manager=new(0,t.Manager)(e,{touchAction:t.touchAction,recognizers:t.recognizers||xge}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(Kj).forEach(i=>{const s=this.manager.get(i);s&&Kj[i].forEach(o=>{s.recognizeWith(o)})});for(const i in t.recognizerOptions){const s=this.manager.get(i);if(s){const o=t.recognizerOptions[i];delete o.enable,s.set(o)}}this.wheelInput=new kge(e,this._onOtherEvent,{enable:!1}),this.moveInput=new Lge(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Uge(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new jge(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,r){this._addEventHandler(e,t,r,!1)}once(e,t,r){this._addEventHandler(e,t,r,!0)}watch(e,t,r){this._addEventHandler(e,t,r,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==t){i.set({enable:t});const s=Sge[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=r.get(o);t?(a.requireFailure(e),i.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,r,i,s){if("string"!=typeof e){r=t;for(const u in e)this._addEventHandler(u,e[u],r,i,s);return}const{manager:o,events:a}=this,c=Jj[e]||e;let l=a.get(c);l||(l=new Zge(this),a.set(c,l),l.recognizerName=Mge[c]||c,o&&o.on(c,l.handleEvent)),l.add(e,t,r,i,s),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:r}=this,s=r.get(Jj[e]||e);if(s&&(s.remove(e,t),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const c of r.values())if(c.recognizerName===o&&!c.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function _l(){}const dV={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:_l,onResize:_l,onViewStateChange:_l,onInteractionStateChange:_l,onBeforeRender:_l,onAfterRender:_l,onLoad:_l,onError:n=>Je.error(n.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:({isDragging:n})=>n?"grabbing":"grab",getTooltip:null,debug:!1,drawPickingColors:!1};class Jx{constructor(e){w(this,"props",void 0),w(this,"width",0),w(this,"height",0),w(this,"userData",{}),w(this,"canvas",null),w(this,"viewManager",null),w(this,"layerManager",null),w(this,"effectManager",null),w(this,"deckRenderer",null),w(this,"deckPicker",null),w(this,"eventManager",null),w(this,"tooltip",null),w(this,"metrics",void 0),w(this,"animationLoop",void 0),w(this,"stats",void 0),w(this,"viewState",void 0),w(this,"cursorState",void 0),w(this,"_needsRedraw",void 0),w(this,"_pickRequest",void 0),w(this,"_lastPointerDownInfo",null),w(this,"_metricsCounter",void 0),w(this,"_onPointerMove",t=>{const{_pickRequest:r}=this;if("pointerleave"===t.type)r.x=-1,r.y=-1,r.radius=0;else{if(t.leftButton||t.rightButton)return;{const i=t.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=t}),w(this,"_onEvent",t=>{const r=MU[t.type],i=t.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:a}=o,c=a&&(a[r.handler]||a.props[r.handler]),l=this.props[r.handler];let u=!1;c&&(u=c.call(a,o,t)),!u&&l&&l(o,t)}),w(this,"_onPointerDown",t=>{const r=t.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...dV,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Je.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===qj()&&Je.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new PT({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&dp.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,t,r,i,s,o,a,c;this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(e=this.layerManager)||void 0===e||e.finalize(),this.layerManager=null,null===(t=this.viewManager)||void 0===t||t.finalize(),this.viewManager=null,null===(r=this.effectManager)||void 0===r||r.finalize(),this.effectManager=null,null===(i=this.deckRenderer)||void 0===i||i.finalize(),this.deckRenderer=null,null===(s=this.deckPicker)||void 0===s||s.finalize(),this.deckPicker=null,null===(o=this.eventManager)||void 0===o||o.destroy(),this.eventManager=null,null===(a=this.tooltip)||void 0===a||a.remove(),this.tooltip=null,this.props.canvas||this.props.gl||!this.canvas||(null===(c=this.canvas.parentElement)||void 0===c||c.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Je.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Je.removed("onLayerClick","onClick")(),e.initialViewState&&!Cd(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||r||i||s||o,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return null!==this.viewManager}getViews(){return sr(this.viewManager),this.viewManager.views}getViewports(e){return sr(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_pick(e,t,r){sr(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(t).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;return"string"==typeof t&&(t=document.getElementById(t),sr(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:r}=e;if(t||0===t){const s=Number.isFinite(t)?"".concat(t,"px"):t;this.canvas.style.width=s}if(r||0===r){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=(null===(i=e.style)||void 0===i?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const t=e.clientWidth||e.width,r=e.clientHeight||e.height;var i;t===this.width&&r===this.height||(this.width=t,this.height=r,null===(i=this.viewManager)||void 0===i||i.setProps({width:t,height:r}),this.props.onResize({width:t,height:r}))}_createAnimationLoop(e){const{width:t,height:r,gl:i,glOptions:s,debug:o,onError:a,onBeforeRender:c,onAfterRender:l,useDevicePixels:u}=e;return new bge({width:t,height:r,useDevicePixels:u,autoResizeViewport:!1,gl:i,onCreateContext:d=>c3({...s,...d,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:d=>this._setGLContext(d.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:c,onAfterRender:l,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Oj({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,o=!1;for(const a of r){var t;s=a,o=(null===(t=a.layer)||void 0===t?void 0:t.onHover(a,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,OT(e,{enable:!0,copyState:!0})),this.tooltip=new Ppe(this.canvas),Ko(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new K3;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new Jge(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in MU)this.eventManager.on(i,this._onEvent);this.viewManager=new ape({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new ope(e,{deck:this,stats:this.stats,viewport:r,timeline:t}),this.effectManager=new bpe,this.deckRenderer=new Tpe(e),this.deckPicker=new Rpe(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:r}=this.layerManager.context;Ko(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects(),...t}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),Je.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:t},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const r=fl.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}function ta(n={}){const{connector:e=()=>new fe,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return s=>{let o,a,c,l=0,u=!1,d=!1;const h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=c=void 0,u=d=!1},p=()=>{const g=o;f(),g?.unsubscribe()};return bt((g,m)=>{l++,!d&&!u&&h();const y=c=c??e();m.add(()=>{l--,0===l&&!d&&!u&&(a=Qx(p,i))}),y.subscribe(m),!o&&l>0&&(o=new wa({next:v=>y.next(v),error:v=>{d=!0,h(),a=Qx(f,t,v),y.error(v)},complete:()=>{u=!0,h(),a=Qx(f,r),y.complete()}}),rr(g).subscribe(o))})(s)}}function Qx(n,e,...t){if(!0===e)return void n();if(!1===e)return;const r=new wa({next:()=>{r.unsubscribe(),n()}});return rr(e(...t)).subscribe(r)}w(Jx,"defaultProps",dV),w(Jx,"VERSION",lge.VERSION);class eS{constructor(e,t){w(this,"opts",void 0),w(this,"source",void 0),this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:r}=this.source,{size:i}=t;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const o=t.elementOffset||0;for(let a=0;a<i;++a)s[a]=r[o+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function dv(n){return n.stride||n.size*n.bytesPerElement}function hV(n,e){e.offset&&Je.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=dv(n),s=(void 0!==e.vertexOffset?e.vertexOffset:n.vertexOffset||0)*t+(e.elementOffset||0)*n.bytesPerElement+(n.offset||0);return{...e,offset:s,stride:t}}class tme{constructor(e,t,r){w(this,"gl",void 0),w(this,"id",void 0),w(this,"size",void 0),w(this,"settings",void 0),w(this,"value",void 0),w(this,"doublePrecision",void 0),w(this,"_buffer",void 0),w(this,"state",void 0),this.gl=e,this.id=t.id||"",this.size=t.size||1;const i=t.logicalType||t.type,s=5130===i;let a,{defaultValue:o}=t;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0),a=s?5126:!i&&t.isIndexed?e&&zT(e,"ELEMENT_INDEX_UINT32")?5125:5123:i||5126;let c=function Qge(n){switch(n){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(i||a||5126);this.doublePrecision=s,s&&!1===t.fp64&&(c=Float32Array),this.value=null,this.settings={...t,defaultType:c,defaultValue:o,logicalType:i,type:a,size:this.size,bytesPerElement:c.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new Pt(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*dv(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),dp.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=function eme(n,e){const t=hV(n,e);return{high:t,low:{...t,offset:t.offset+4*n.size}}}(this.getAccessor(),t||{});return r[e]=new eS(this,s.high),r["".concat(e,"64Low")]=i?new eS(this,s.low):new Float32Array(this.size),r}if(t){const r=hV(this.getAccessor(),t);return{[e]:new eS(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:r,size:i}=this,s=r*i;if(t&&s&&t.length>=s){const o=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let c=0;c<s;)for(let l=0;l<i;l++){const u=t[c++];u<o[l]&&(o[l]=u),u>a[l]&&(a[l]=u)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let r;r=ArrayBuffer.isView(e)?{value:e}:e instanceof Pt?{buffer:e}:e;const i={...this.settings,...r};if(t.bufferAccessor=i,t.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),t.constant&&this._areValuesEqual(s,this.value))return!1;t.externalBuffer=null,t.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;t.externalBuffer=s,t.constant=!1,this.value=r.value||null;const o=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(o?2:1),i.stride=dv(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;t.externalBuffer=null,t.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=dv(i);const{buffer:o,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=nT(s,i));const c=s.byteLength+a+2*i.stride;o.byteLength<c&&o.reallocate(c),o.setAccessor(null),o.subData({data:s,offset:a}),i.type=r.type||o.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const t=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?nT(t,{size:this.size,startIndex:r,endIndex:i}):t.subarray(r,i),offset:r*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,t=!1){const{state:r}=this,i=r.allocatedValue,s=dp.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),t&&i&&o.subData({data:i instanceof Float64Array?nT(i,this):i,offset:a})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=t.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));!(t instanceof r)&&this.settings.normalized&&!("normalized"in e)&&Je.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(e).map(t=>t/255);case 5123:return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return t[r]=e,t;if(!e)return t[r]=i[0],t;switch(s){case 4:t[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:t[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:t[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:t[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=s;for(;--o>=0;)t[r+o]=Number.isFinite(e[o])?e[o]:i[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==t[i])return!1;return!0}}const fV=[],pV=[];function hv(n,e=0,t=1/0){let r=fV;const i={index:-1,data:n,target:[]};return n?"function"==typeof n[Symbol.iterator]?r=n:n.length>0&&(pV.length=n.length,r=pV):r=fV,(e>0||Number.isFinite(t))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,t),i.index=e-1),{iterable:r,objectInfo:i}}function gV(n){return n&&n[Symbol.asyncIterator]}const rme=[],fv=[[0,1/0]];function tS(n){const{source:e,target:t,start:r=0,size:i,getData:s}=n,a=e.length,c=(n.end||t.length)-r;if(a>c)return void t.set(e.subarray(0,c),r);if(t.set(e,r),!s)return;let l=a;for(;l<c;){const u=s(l,e);for(let d=0;d<i;d++)t[r+l]=u[d]||0,l++}}const ome={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function mV(n,e){if(!n)return null;Number.isFinite(n)&&(n={type:"interpolation",duration:n});const t=n.type||"interpolation";return{...ome[t],...e,...n,type:t}}function _V(n,e){const t=e.getBuffer();return t?[t,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function yV(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(n,'"'))}}function vV(n){n.push(n.shift())}function nS(n,e){const{doublePrecision:t,settings:r,value:i,size:s}=n,o=t&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*o}function bV({buffer:n,numInstances:e,attribute:t,fromLength:r,fromStartIndices:i,getData:s=o=>o}){const o=t.doublePrecision&&t.value instanceof Float64Array?2:1,a=t.size*o,c=t.byteOffset,l=t.startIndices,u=i&&l,d=nS(t,e),h=t.isConstant;if(!u&&r>=d)return;const f=h?t.value:t.getBuffer().getData({srcByteOffset:c});if(t.settings.normalized&&!h){const y=s;s=(v,_)=>t.normalizeConstant(y(v,_))}const p=h?(y,v)=>s(f,v):(y,v)=>s(f.subarray(y,y+a),v),g=n.getData({length:r}),m=new Float32Array(d);(function sme({source:n,target:e,size:t,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return tS({source:n,target:e,size:t,getData:r}),e;let o=0,a=0;const c=r&&((u,d)=>r(u+a,d)),l=Math.min(i.length,s.length);for(let u=1;u<l;u++){const d=i[u]*t,h=s[u]*t;tS({source:n.subarray(o,d),target:e,start:a,end:h,size:t,getData:c}),o=d,a=h}a<e.length&&tS({source:[],target:e,start:a,size:t,getData:c})})({source:g,target:m,sourceStartIndices:i,targetStartIndices:l,size:a,getData:p}),n.byteLength<m.byteLength+c&&n.reallocate(m.byteLength+c),n.subData({data:m,offset:c})}class rS extends tme{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:fv}),w(this,"constant",!1),this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,r=this.settings.transition;return mV(Array.isArray(t)?e[t.find(s=>e[s])]:e[t],r)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:r=0,endRow:i=1/0}=t;this.state.updateRanges=function ime(n,e){if(n===fv||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],r=n.length;let i=0;for(let s=0;s<r;s++){const o=n[s];o[1]<e[0]?(t.push(o),i=s+1):o[0]>e[1]?t.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return t.splice(i,0,e),t}(this.state.updateRanges,[r,i])}else this.state.updateRanges=fv}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=rme}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:r}=this;return!r.noAlloc&&!!r.update&&(super.allocate(e,t.updateRanges!==fv),!0)}updateBuffer({numInstances:e,data:t,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let c=!0;if(o){for(const[l,u]of s)o.call(i,this,{data:t,startRow:l,endRow:u,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[l,u]of s){const d=Number.isFinite(l)?this.getVertexOffset(l):0,h=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:d,endOffset:h})}this._checkAttributeArray()}else c=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),c}setConstantValue(e){return void 0!==e&&"function"!=typeof e&&(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;return sr(ArrayBuffer.isView(o.value),"invalid ".concat(i.accessor)),r.binaryAccessor=function nme(n,e){const{size:t,stride:r,offset:i,startIndices:s,nested:o}=e,a=n.BYTES_PER_ELEMENT,c=r?r/a:t,l=i?i/a:0,u=Math.floor((n.length-l)/c);return(d,{index:h,target:f})=>{if(!s){const y=h*c+l;for(let v=0;v<t;v++)f[v]=n[y+v];return f}const p=s[h],g=s[h+1]||u;let m;if(o){m=new Array(g-p);for(let y=p;y<g;y++){const v=y*c+l;f=new Array(t);for(let _=0;_<t;_++)f[_]=n[v+_];m[y-p]=f}}else if(c===t)m=n.subarray(p*t+l,g*t+l);else{m=new n.constructor((g-p)*t);let y=0;for(let v=p;v<g;v++){const _=v*c+l;for(let E=0;E<t;E++)m[y++]=n[_+E]}}return m}}(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:t,nested:!!o.size&&o.size!==this.size}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const r in e)Object.assign(t,super.getShaderAttributes(r,e[r]));return t}_autoUpdater(e,{data:t,startRow:r,endRow:i,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:c,value:l,size:u,startIndices:d}=e,{accessor:h,transform:f}=a,p=c.binaryAccessor||("function"==typeof h?h:s[h]);sr("function"==typeof p,'accessor "'.concat(h,'" is not a function'));let g=e.getVertexOffset(r);const{iterable:m,objectInfo:y}=hv(t,r,i);for(const v of m){y.index++;let _=p(v,y);if(f&&(_=f.call(this,_)),d){const E=(y.index<d.length-1?d[y.index+1]:o)-d[y.index];if(_&&Array.isArray(_[0])){let T=g;for(const I of _)e._normalizeValue(I,l,T),T+=u}else _&&_.length>u?l.set(_,g):(e._normalizeValue(_,y.target,0),khe({target:l,source:y.target,start:g,count:E}));g+=E*u}else e._normalizeValue(_,l,g),g+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!e.noAlloc&&"function"!=typeof e.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let r=!0;switch(t){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}const wV="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",cme="#version 300 es\n".concat(wV);function EV(n,e){e=Array.isArray(e)?e:[e];const t=n.replace(/^\s+/,"").split(/\s+/),[r,i,s]=t;return e.includes(r)&&i&&s?{qualifier:r,type:i,name:s.split(";")[0]}:null}function CV(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{version:e=100,input:t,inputType:r,output:i}=n;if(!t)return 300===e?cme:e>300?"#version ".concat(e,"\n").concat(wV):"void main() {gl_FragColor = vec4(0);}";const s=function dme(n,e){switch(e){case"float":return"vec4(".concat(n,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(n,", 0.0, 1.0)");case"vec3":return"vec4(".concat(n,", 1.0)");case"vec4":return n;default:return Ci(!1),null}}(t,r);return e>=300?"#version ".concat(e," ").concat(300===e?"es":"","\nin ").concat(r," ").concat(t,";\nout vec4 ").concat(i,";\nvoid main() {\n  ").concat(i," = ").concat(s,";\n}"):"varying ".concat(r," ").concat(t,";\nvoid main() {\n  gl_FragColor = ").concat(s,";\n}")}class AV extends Jo{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Xe(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Er(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Sd(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:o}=this._getBufferParams(t);return r<0?(this.unused[e]=i,ue.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=t,this.bindOnUse||this._bindBuffer(r,i,o,s),this)}begin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,r,i;return e instanceof Pt?i=e:(i=e.buffer,r=e.byteSize,t=e.byteOffset),(void 0!==t||void 0!==r)&&(t=t||0,r=r||i.byteLength-t),{buffer:i,byteOffset:t,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t){let i=arguments.length>3?arguments[3]:void 0;const s=t&&t.handle;return s&&void 0!==i?this.gl.bindBufferRange(35982,e,s,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i):this.gl.bindBufferBase(35982,e,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class hme{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=t;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(){this._setupBuffers(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],r=e?t[e]:null;return r?r instanceof Pt?r:r.buffer:null}getData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyingName:t}=e,r=this.getBuffer(t);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&te(Xe(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap)i in t&&(r[this.feedbackMap[i]]=i);Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if("string"==typeof s){const o=t[s],{byteLength:a,usage:c,accessor:l}=o;r[i]=this._createNewBuffer(i,{byteLength:a,usage:c,accessor:l})}}return r}_setupBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:r})}_setupTransformFeedback(e,t){let{model:r}=t;const{program:i}=r;e.transformFeedback=new AV(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:t,feedbackBuffers:r})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];t[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],te(r[s]instanceof Pt)}return{sourceBuffers:t,feedbackBuffers:r}}_createNewBuffer(e,t){const r=new Pt(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}function TV(n){let e=100;const t=n.match(/[^\s]+/g);if(t.length>=2&&"#version"===t[0]){const r=parseInt(t[1],10);Number.isFinite(r)&&(e=r)}return e}const fme={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},pv="transform_uSize_",xV="transform_position";const wme={10241:9728,10240:9728,10242:33071,10243:33071};class Cme{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},t,e.attributes),a=Object.assign({},e.uniforms),c=Object.assign({},e.parameters);let l=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const d in this.samplerTextureMap)a[d]=r[this.samplerTextureMap[d]];this._setSourceTextureParameters();const u=function mme(n){let{sourceTextureMap:e,targetTextureVarying:t,targetTexture:r}=n;const i={};let s,o;t&&(({width:s,height:o}=r),i["".concat(pv).concat(t)]=[s,o]);for(const a in e)({width:s,height:o}=e[a]),i["".concat(pv).concat(a)]=[s,o];return i}({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,u)}return this.hasTargetTexture&&(l=!1,c.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:a,discard:l,parameters:c}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(){this._setupTextures(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{framebuffer:t}=this.bindings[this.currentIndex],r=Yy(t);if(!e)return r;const i=r.constructor,s=function ume(n){switch(n){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Ci(!1),null}}(this.targetTextureType),o=new i(r.length*s/4);let a=0;for(let c=0;c<r.length;c+=4)for(let l=0;l<s;l++)o[a++]=r[c+l];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{_targetTextureVarying:t,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:r}=e;if(r instanceof or)return r;const i=t[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!=typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new Pt(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:t,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:t,targetTexture:r})}}_updateBinding(e,t){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:c}=e;c?(c.update({attachments:{36064:s},resizeAttachments:!1}),c.resize({width:o,height:a})):e.framebuffer=new xn(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const r in t)t[r].setParameters(wme)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);return t[this._swapTexture]=e.targetTexture,{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=function Wue(n,e){te(n instanceof or||n instanceof zue||n instanceof Gue);const t=n.constructor,{gl:r,width:i,height:s,format:o,type:a,dataFormat:c,border:l,mipmaps:u}=n;return new t(r,Object.assign({width:i,height:s,format:o,type:a,dataFormat:c,border:l,mipmaps:u},e))}(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceTextures:t,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:c}=function gme(n){let{vs:e,sourceTextureMap:t,targetTextureVarying:r,targetTexture:i}=n,o=Object.keys(t).length,a=null;const c={};let l=e,u={};if(o>0||r){const d=l.split("\n"),h=d.slice();if(d.forEach((f,p,g)=>{if(o>0){const m=function bme(n,e){const t={},r=function _me(n){return EV(n,["attribute","in"])}(n);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const o="// ".concat(n," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:c,uniformDeclerations:l}=function yme(n){const e="".concat("transform_uSampler_").concat(n),t="".concat(pv).concat(n);return{samplerName:e,sizeName:t,uniformDeclerations:"  uniform sampler2D ".concat(e,";\n  uniform vec2 ").concat(t,";")}}(s),u=function lme(n){switch(n){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Ci(!1),null}}(i),d="  ".concat(i," ").concat(s," = transform_getInput(").concat(a,", ").concat(c,").").concat(u,";\n");return t[a]=s,{updatedLine:o,inject:{"vs:#decl":l,"vs:#main-start":d},samplerTextureMap:t}}return null}(f,t);if(m){const{updatedLine:y,inject:v}=m;h[p]=y,u=TT([u,v]),Object.assign(c,m.samplerTextureMap),o--}}r&&!a&&(a=function vme(n,e){const t=EV(n,["varying","out"]);return t&&t.name===e?t.type:null}(f,r))}),r){te(i);const f="".concat(pv).concat(r),p="uniform vec2 ".concat(f,";\n"),g="     vec2 ".concat(xV," = transform_getPos(").concat(f,");\n     gl_Position = vec4(").concat(xV,", 0, 1.);\n");u=TT([u,{"vs:#decl":p,"vs:#main-start":g}])}l=h.join("\n")}return{vs:l,targetTextureType:a,inject:u,samplerTextureMap:c}}({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),l=TT([e.inject||{},a]);return this.targetTextureType=o,this.samplerTextureMap=c,{vs:i,fs:e._fs||CV({version:TV(i),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[fme].concat(e.modules||[]):e.modules,uniforms:s,inject:l}}}let gv=null;class xi extends Jo{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero||Xe(e)||"Chrome"===qj()}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new xi(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return xi.MAX_ATTRIBUTES=xi.MAX_ATTRIBUTES||e.getParameter(34921),xi.MAX_ATTRIBUTES}static setConstant(e,t,r){switch(r.constructor){case Float32Array:xi._setConstantFloatArray(e,t,r);break;case Int32Array:xi._setConstantIntArray(e,t,r);break;case Uint32Array:xi._setConstantUintArray(e,t,r);break;default:te(!1)}}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,Object.assign({},t,{id:t.id||t.program&&t.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return xi.getMaxAttributes(this.gl)}initialize(){return this.setProps(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return te(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,t,r){if(34963===t.target)return this.setElementBuffer(t,r);const{size:i,type:s,stride:o,offset:a,normalized:c,integer:l,divisor:u}=r,{gl:d,gl2:h}=this;return e=Number(e),this.bind(()=>{d.bindBuffer(34962,t.handle),l?(te(Xe(d)),h.vertexAttribIPointer(e,i,s,o,a)):d.vertexAttribPointer(e,i,s,c,o,a),d.enableVertexAttribArray(e),h.vertexAttribDivisor(e,u||0)}),this}enable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!t&&0===e&&!xi.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t){const r=this._normalizeConstantArrayValue(t),i=r.byteLength*e,s=r.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new Pt(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(r,this.bufferValue),o){const a=function Tme(n,e){const t=function Ame(n){return(!gv||gv.byteLength<n)&&(gv=new ArrayBuffer(n)),gv}(n.BYTES_PER_ELEMENT*e);return new n(t,0,e)}(t.constructor,s);(function xme(n){let{target:e,source:t,start:r=0,count:i=1}=n;const s=t.length,o=i*s;let a=0;for(let c=r;a<s;a++)e[c++]=t[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o)})({target:a,source:r,start:0,count:s}),this.buffer.subData(a),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}static _setConstantFloatArray(e,t,r){switch(r.length){case 1:e.vertexAttrib1fv(t,r);break;case 2:e.vertexAttrib2fv(t,r);break;case 3:e.vertexAttrib3fv(t,r);break;case 4:e.vertexAttrib4fv(t,r);break;default:te(!1)}}static _setConstantIntArray(e,t,r){switch(te(Xe(e)),r.length){case 1:e.vertexAttribI1iv(t,r);break;case 2:e.vertexAttribI2iv(t,r);break;case 3:e.vertexAttribI3iv(t,r);break;case 4:e.vertexAttribI4iv(t,r);break;default:te(!1)}}static _setConstantUintArray(e,t,r){switch(te(Xe(e)),r.length){case 1:e.vertexAttribI1uiv(t,r);break;case 2:e.vertexAttribI2uiv(t,r);break;case 3:e.vertexAttribI3uiv(t,r);break;case 4:e.vertexAttribI4uiv(t,r);break;default:te(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,t){let{location:r}=t;return te(Number.isFinite(r)),this.bind(()=>34373===e?this.gl.getVertexAttribOffset(r,e):this.gl.getVertexAttrib(r,e))}}const Mme=/^(.+)__LOCATION_([0-9]+)$/,Dme=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Rme{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.id=t.id||t.program&&t.program.id,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new xi(e),h3(this,"VertexArray","v6.0",Dme),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const t in e)this._setAttribute(t,e[t]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===t.target)return this.setElementBuffer(t,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,t,t.accessor,r);return i>=0&&(this.values[i]=t,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,t,s)),this}setConstant(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},r));return i>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[i]=t,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new Pt(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof Pt&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof Pt&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),i=r()}),i}_resolveLocationAndAccessor(e,t,r,i){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=t,ue.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const c=this._getAttributeInfo(a||o);if(!c)return s;const u=ci.resolve(c.accessor,this.accessors[o]||{},r,i),{size:d,type:h}=u;return te(Number.isFinite(d)&&Number.isFinite(h)),{location:o,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const r=Mme.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,t){if(t instanceof Pt)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof Pt)this.setBuffer(e,t[0],t[1]);else if(ArrayBuffer.isView(t)||Array.isArray(t))this.setConstant(e,t);else{if(!(t.buffer instanceof Pt))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(e,t.buffer,t)}}_setConstantAttributes(e,t){const r=Math.max(0|e,0|t);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,t){if(xi.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const r=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,t){xi.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const r=this.values[t],i=this.accessors[t];if(!r)return;const{divisor:s}=i,o=s>0;if(e.isInstanced=e.isInstanced||o,r instanceof Pt){const a=r;if(o){const c=a.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,c)}else{const c=a.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,c)}}}setElements(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ue.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function Np(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{isInteger:r=!1}=e;if(Array.isArray(n)||ArrayBuffer.isView(n))return function Ome(n,e){const{maxElts:t=16,size:r=1}=e;let i="[";for(let o=0;o<n.length&&o<t;++o)o>0&&(i+=",".concat(o%r==0?" ":"")),i+=Np(n[o],e);const s=n.length>t?"...":"]";return"".concat(i).concat(s)}(n,e);if(!Number.isFinite(n))return String(n);if(Math.abs(n)<1e-16)return r?"0":"0.";if(r||Math.abs(n)>100&&Math.abs(n)<1e4)return n.toFixed(0);const i=n.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function SV(n,e,t,r){const{gl:i}=n;if(!e)return{[r]:"null","Format ":"N/A"};let l,u,d,s="NOT PROVIDED",o=1,a=0,c=0;if(t&&(s=t.type,o=t.size,s=String(s).replace("Array",""),l=-1!==s.indexOf("nt")),e instanceof Pt){const h=e,{data:f,changed:p}=h.getDebugData();let g;return u=p?"*":"",d=f,c=h.byteLength,a=c/f.BYTES_PER_ELEMENT/o,t?g="".concat(t.divisor>0?"I ":"P "," ").concat(a," (x").concat(o,"=").concat(c," bytes ").concat(sc(i,s),")"):(l=!0,g="".concat(c," bytes")),{[r]:"".concat(u).concat(Np(d,{size:o,isInteger:l})),"Format ":g}}return d=e,o=e.length,s=String(e.constructor.name).replace("Array",""),l=-1!==s.indexOf("nt"),{[r]:"".concat(Np(d,{size:o,isInteger:l})," (constant)"),"Format ":"".concat(o,"x").concat(s," (constant)")}}function Nme(n,e){const{type:t,size:r}=e,i=U3(t,r);return i?"".concat(n," (").concat(i.name,")"):n}function IV(n){let{header:e="Uniforms",program:t,uniforms:r,undefinedOnly:i=!1}=n;te(t);const o=".*Matrix",c={},l=Object.keys(t._uniformSetters).sort();let u=0;for(const f of l)!f.match(".*_.*")&&!f.match(o)&&iS({table:c,header:e,uniforms:r,uniformName:f,undefinedOnly:i})&&u++;for(const f of l)f.match(o)&&iS({table:c,header:e,uniforms:r,uniformName:f,undefinedOnly:i})&&u++;for(const f of l)c[f]||iS({table:c,header:e,uniforms:r,uniformName:f,undefinedOnly:i})&&u++;let d=0;const h={};if(!i)for(const f in r){const p=r[f];c[f]||(d++,h[f]={Type:"NOT USED: ".concat(p),[e]:Np(p)})}return{table:c,count:u,unusedTable:h,unusedCount:d}}function iS(n){let{table:e,header:t,uniforms:r,uniformName:i,undefinedOnly:s}=n;const o=r[i],a=function kme(n){return null!=n}(o);return!(s&&a||(e[i]={[t]:a?Np(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},0))}function MV(n){const{type:e,size:t}=n.accessor,r=U3(e,t);return r?"".concat(r.name," ").concat(n.name):n.name}const Lme={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function Ume(n,e){const{attributeMap:t=Lme}=e||{};return t&&t[n]||n}function jme(n,e){let t;switch(n){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":t="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":t="vectors"}switch(t){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}te(Number.isFinite(e.size),"attribute ".concat(n," needs size"))}const DV=()=>{},zme={};class Bd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{id:r=ai("model")}=t;te(qy(e)),this.id=r,this.gl=e,this.id=t.id||ai("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||Ip.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u}=e;this.programProps={program:t,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},te(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u}=e;this.programProps={program:t,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return te(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return te(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function Bme(n,e,t){const r={};let i=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=Ume(s,t);if("indices"===s)i=o;else if(o.constant)r[a]=o.value;else{const c=o.value,l={...o};delete l.value,r[a]=[new Pt(n,c),l],jme(s,l)}}if(i){const s=i.value||i;te(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:void 0===i.isIndexed||i.isIndexed};r.indices=[new Pt(n,{data:s,target:34963}),o]}return r}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Sd(e))return this;const t={};for(const r in e){const i=e[r];t[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(t),this}setUniforms(){return Object.assign(this.uniforms,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return jT(this.program.gl,e),this}draw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._checkProgram();const{moduleSettings:t=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:c=this.vertexArray}=e;let l;this.setAttributes(s),this.updateModuleSettings(t),this.setUniforms(i),ue.priority>=2&&(l=this._logDrawCallStart(2));const u=this.vertexArray.getDrawParams(),{isIndexed:d=u.isIndexed,indexType:h=u.indexType,indexOffset:f=u.indexOffset,vertexArrayInstanced:p=u.isInstanced}=this.props;p&&!this.isInstanced&&ue.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:g,instanceCount:m}=this,{onBeforeRender:y=DV,onAfterRender:v=DV}=this.props;y(),this.program.setUniforms(this.uniforms);const _=this.program.draw(Object.assign(zme,e,{logPriority:l,uniforms:null,framebuffer:r,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:c,transformFeedback:o,isIndexed:d,indexType:h,isInstanced:g,instanceCount:m,offset:d?f:0}));return v(),ue.priority>=2&&this._logDrawCallEnd(l,c,r),_}transform(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{discard:t=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),t&&(s=Object.assign({},s,{35977:t})),i.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(o=>o.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ue.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:o,defines:a,varyings:c,bufferMode:l,transpileToGLSL100:u}=this.programProps;t=this.programManager.get({vs:r,fs:i,modules:s,inject:o,defines:a,varyings:c,bufferMode:l,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}te(t instanceof V3,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Rme(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof Pt&&t.delete()}}_setAnimationProps(e){this.animated&&te(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Sd(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new AV(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),ue.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:ue.level<=2})(),e}_logDrawCallEnd(e,t,r,i){if(void 0===e)return;const s=function Pme(n){let{vertexArray:e,header:t="Attributes"}=n;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=SV(e,e.elements,null,t));const i=e.values;for(const s in i){const o=e._getAttributeInfo(s);if(o){let a="".concat(s,": ").concat(o.name);const c=e.accessors[o.location];c&&(a="".concat(s,": ").concat(Nme(o.name,c))),r[a]=SV(e,i[s],c,t)}}return r}({vertexArray:t,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:c}=IV({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:l,count:u}=IV({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});u>0&&ue.log("MISSING UNIFORMS",Object.keys(l))(),c>0&&ue.log("UNUSED UNIFORMS",Object.keys(a))();const d=function Fme(n){const e={},t="Accessors for ".concat(n.id);for(const r of n.attributeInfos)if(r){const i=MV(r);e["in ".concat(i)]={[t]:JSON.stringify(r.accessor)}}for(const r of n.varyingInfos)if(r){const i=MV(r);e["out ".concat(i)]={[t]:JSON.stringify(r.accessor)}}return e}(this.vertexArray.configuration);ue.table(e,s)(),ue.table(e,o)(),ue.table(e+1,d)(),i&&i.log({logLevel:2,message:"Rendered to ".concat(i.id)}),ue.groupEnd(2)()}}class sS{static isSupported(e){return Xe(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:r}=this;e&&e.delete(),t&&t.delete(),r&&r.delete()}run(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{clearRenderTarget:t=!0}=e,r=this._updateDrawOptions(e);t&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of t)e=e||r.swap();te(e,"Nothing to swap")}getBuffer(){return this.bufferTransform&&this.bufferTransform.getBuffer(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)}getData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of t){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of t)r.update(e)}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new Bd(t,Object.assign({},e,{fs:e.fs||CV({version:TV(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)t=i.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function Gme(n){return!(Sd(n.feedbackBuffers)&&Sd(n.feedbackMap)&&!(n.varyings&&n.varyings.length>0))})(t)&&(this.bufferTransform=new hme(e,t)),function Wme(n){return!(Sd(n._sourceTextures)&&!n._targetTexture&&!n._targetTextureVarying)}(t)&&(this.textureTransform=new Cme(e,t)),te(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)t=Object.assign(t,i.getDrawOptions(t));return t}}const Qme={interpolation:class $me{constructor({gl:e,attribute:t,timeline:r}){w(this,"gl",void 0),w(this,"type","interpolation"),w(this,"attributeInTransition",void 0),w(this,"settings",void 0),w(this,"attribute",void 0),w(this,"transition",void 0),w(this,"currentStartIndices",void 0),w(this,"currentLength",void 0),w(this,"transform",void 0),w(this,"buffers",void 0),this.gl=e,this.transition=new _p(r),this.attribute=t,this.attributeInTransition=new rS(e,t.settings),this.currentStartIndices=t.startIndices,this.currentLength=0,this.transform=function Xme(n,e){const t=yV(e.size);return new sS(n,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:t},varyings:["vCurrent"]})}(e,t);const i={byteLength:0,usage:35050};this.buffers=[new Pt(e,i),new Pt(e,i)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0)return void this.transition.cancel();this.settings=e;const{buffers:i,attribute:s}=this;vV(i);const o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)bV({buffer:a,...o});this.currentStartIndices=s.startIndices,this.currentLength=nS(s,t),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:_V(0,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:t,easing:r}=this.settings,{time:i}=this.transition;let s=i/t;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}},spring:class Yme{constructor({gl:e,attribute:t,timeline:r}){w(this,"gl",void 0),w(this,"type","spring"),w(this,"attributeInTransition",void 0),w(this,"settings",void 0),w(this,"attribute",void 0),w(this,"transition",void 0),w(this,"currentStartIndices",void 0),w(this,"currentLength",void 0),w(this,"texture",void 0),w(this,"framebuffer",void 0),w(this,"transform",void 0),w(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new _p(r),this.attribute=t,this.attributeInTransition=new rS(e,{...t.settings,normalized:!1}),this.currentStartIndices=t.startIndices,this.currentLength=0,this.texture=function Kme(n){return new or(n,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function Jme(n,e){return new xn(n,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function Zme(n,e,t){const r=yV(e.size);return new sS(n,{framebuffer:t,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}(e,t,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new Pt(e,i),new Pt(e,i),new Pt(e,i)]}get inProgress(){return this.transition.inProgress}start(e,t){const{buffers:i,attribute:s}=this,o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)bV({buffer:a,...o});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=nS(s,t),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:_V(0,s)}})}update(){const{buffers:e,transform:t,framebuffer:r,transition:i}=this;if(!i.update())return!1;const o=this.settings;return t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:o.stiffness,damping:o.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),vV(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),Yy(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}};class e_e{constructor(e,{id:t,timeline:r}){w(this,"id",void 0),w(this,"isSupported",void 0),w(this,"gl",void 0),w(this,"timeline",void 0),w(this,"transitions",void 0),w(this,"needsRedraw",void 0),w(this,"numInstances",void 0),this.id=t,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=sS.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],o=s.getTransitionSetting(t);o&&this._updateAttribute(i,s,o)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(t))&&this._removeTransition(i)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const r=this.transitions[t];r.inProgress&&(e[t]=r.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported)return void Je.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();i&&this._removeTransition(e);const o=Qme[r.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,gl:this.gl}):(Je.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const RV="attributeManager.invalidate";class o_e{constructor(e,{id:t="attribute-manager",stats:r,timeline:i}={}){w(this,"id",void 0),w(this,"gl",void 0),w(this,"attributes",void 0),w(this,"updateTriggers",void 0),w(this,"needsRedraw",void 0),w(this,"userData",void 0),w(this,"stats",void 0),w(this,"attributeTransitionManager",void 0),this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new e_e(e,{id:"".concat(t,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const t of e)void 0!==this.attributes[t]&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const r=this._invalidateTrigger(e,t);Ar(RV,this,e,r)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);Ar(RV,this,"all")}update({data:e,numInstances:t,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}){let c=!1;Ar("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const l in this.attributes){const u=this.attributes[l],d=u.settings.accessor;u.startIndices=r,u.numInstances=t,s[l]&&Je.removed("props.".concat(l),"data.attributes.".concat(l))(),u.setExternalBuffer(o[l])||u.setBinaryValue("string"==typeof d?o[d]:void 0,e.startIndices)||"string"==typeof d&&!o[d]&&u.setConstantValue(s[d])||u.needsUpdate()&&(c=!0,this._updateAttribute({attribute:u,numInstances:t,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||u.needsRedraw()}c&&Ar("attributeManager.updateEnd",this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in t){const o=t[s];o.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=o)}return i}getShaderAttributes(e,t={}){e||(e=this.getAttributes());const r={};for(const i in e)t[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,t={}){for(const r in e)this.attributes[r]=this._createAttribute(r,e[r],t);this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,r){const i={...t,id:e,size:(t.isIndexed?1:t.size)||1,divisor:r.instanced?1:t.divisor||0};return new rS(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:r}=e;Ar("attribute.updateStart",t),t.constant?t.setConstantValue(t.value):(t.allocate(r)&&Ar("attribute.allocate",t,r),t.updateBuffer(e)&&(this.needsRedraw=!0,Ar("attribute.updateEnd",t,r)))}}function PV(n,e,t,r,i){const s=e-n;return(t-e)*i+-s*r+s+e}function NV(n,e){if(Array.isArray(n)){let t=0;for(let r=0;r<n.length;r++){const i=n[r]-e[r];t+=i*i}return Math.sqrt(t)}return Math.abs(n-e)}const u_e={interpolation:class a_e extends _p{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:r,duration:i,easing:s}}=this,o=s(e/i);this._value=My(t,r,o)}},spring:class l_e extends _p{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=function c_e(n,e,t,r,i){if(Array.isArray(t)){const s=[];for(let o=0;o<t.length;o++)s[o]=PV(n[o],e[o],t[o],r,i);return s}return PV(n,e,t,r,i)}(s,o,t,r,i);const c=NV(a,t),l=NV(a,o);c<1e-5&&l<1e-5&&(a=t,this.end()),this._prevValue=o,this._currValue=a}}};class d_e{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,r,i){const{transitions:s}=this;if(s.has(e)){const c=s.get(e),{value:l=c.settings.fromValue}=c;t=l,this.remove(e)}if(!(i=mV(i)))return;const o=u_e[i.type];if(!o)return void Je.error("unsupported transition type '".concat(i.type,"'"))();const a=new o(this.timeline);a.start({...i,fromValue:t,toValue:r}),s.set(e,a)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,r]of this.transitions)r.update(),e[t]=r.value,r.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function p_e(n,e){if(!n.transitions)return!1;const t={},r=aS(n);let i=!1;for(const s in n.transitions){const o=r[s],a=o&&o.type;("number"===a||"color"===a||"array"===a)&&oS(n[s],e[s],o)&&(t[s]=!0,i=!0)}return!!i&&t}function kV({newProps:n,oldProps:e,ignoreProps:t={},propTypes:r={},triggerName:i="props"}){if(e===n)return!1;if("object"!=typeof n||null===n||"object"!=typeof e||null===e)return"".concat(i," changed shallowly");for(const s of Object.keys(n))if(!(s in t)){if(!(s in e))return"".concat(i,".").concat(s," added");const o=oS(n[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in t)){if(!(s in n))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(n,s)){const o=oS(n[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}}return!1}function oS(n,e,t){let r=t&&t.equal;return r&&!r(n,e,t)||!r&&(r=n&&e&&n.equals,r&&!r.call(n,e))?"changed deeply":r||e===n?null:"changed shallowly"}function __e(n,e){if(null===e)return!0;const t=e.extensions,{extensions:r}=n;if(r===t)return!1;if(!t||!r||r.length!==t.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(t[i]))return!0;return!1}function FV(n,e,t){let r=n.updateTriggers[t];r=r??{};let i=e.updateTriggers[t];return i=i??{},kV({oldProps:i,newProps:r,triggerName:t})}function aS(n){const e=n[tv],t=e&&e.constructor;return t?t._propTypes:{}}function C_e(n,e){if(!e)return n;const t={...n,...e};if("defines"in e&&(t.defines={...n.defines,...e.defines}),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(r=>"project64"===r.name))){const r=t.modules.findIndex(i=>"project32"===i.name);r>=0&&t.modules.splice(r,1)}if("inject"in e)if(n.inject){const r={...n.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];t.inject=r}else t.inject=e.inject;return t}function cS(n,e,t=!1){const r=e.projectPosition(n);if(t&&e instanceof uc){const[i,s,o=0]=n,a=e.getDistanceScales([i,s]);r[2]=o*a.unitsPerMeter[2]}return r}function LV(n,{viewport:e,modelMatrix:t,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,c=0]=n;switch(t&&([o,a,c]=pp([],[o,a,c,1],t)),r){case st.LNGLAT:return cS([o,a,c],e,s);case st.LNGLAT_OFFSETS:return cS([o+i[0],a+i[1],c+(i[2]||0)],e,s);case st.METER_OFFSETS:return cS(vU(i,[o,a,c]),e,s);default:return e.isGeospatial?[o+i[0],a+i[1],c+i[2]]:e.projectPosition([o,a,c])}}const x_e={10241:9987,10240:9729,10242:33071,10243:33071},lS={},M_e={boolean:{validate:(n,e)=>!0,equal:(n,e,t)=>!!n==!!e},number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},color:{validate:(n,e)=>e.optional&&!n||Fp(n)&&(3===n.length||4===n.length),equal:(n,e,t)=>uS(n,e)},accessor:{validate(n,e){const t=mv(n);return"function"===t||t===mv(e.value)},equal:(n,e,t)=>"function"==typeof e||uS(n,e)},array:{validate:(n,e)=>e.optional&&!n||Fp(n),equal:(n,e,t)=>t.compare?uS(n,e):n===e},object:{equal:(n,e,t)=>t.compare?Cd(n,e):n===e},function:{validate:(n,e)=>e.optional&&!n||"function"==typeof n,equal:(n,e,t)=>!t.compare||n===e},data:{transform:(n,e,t)=>{const{dataTransform:r}=t.props;return r&&n?r(n):n}},image:{transform:(n,e,t)=>function S_e(n,e){const t=n.context&&n.context.gl;if(!t||!e)return null;if(e instanceof or)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let r=null;e.compressed&&(r={10241:e.data.length>1?9985:9729});const i=new or(t,{...e,parameters:{...x_e,...r,...n.props.textureParameters}});return lS[i.id]=!0,i}(t,n),release:n=>{!function I_e(n){!n||!(n instanceof or)||lS[n.id]&&(n.delete(),delete lS[n.id])}(n)}}};function uS(n,e){if(n===e)return!0;if(!Fp(n)||!Fp(e))return!1;const t=n.length;if(t!==e.length)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function R_e(n,e){switch(mv(e)){case"object":return kp(n,e);case"array":return kp(n,{type:"array",value:e,compare:!1});case"boolean":return kp(n,{type:"boolean",value:e});case"number":return kp(n,{type:"number",value:e});case"function":return kp(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function kp(n,e){return"type"in e?{name:n,...M_e[e.type],...e}:"value"in e?{name:n,type:mv(e.value),...e}:{name:n,type:"object",value:e}}function Fp(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function mv(n){return Fp(n)?"array":null===n?"null":typeof n}function BV(n){return _v(n,"_mergedDefaultProps")||(function P_e(n){if(!n.prototype)return;const t=Object.getPrototypeOf(n),r=BV(t),s=function D_e(n){const e={},t={},r={};for(const[i,s]of Object.entries(n)){const o=s?.deprecatedFor;if(o)r[i]=Array.isArray(o)?o:[o];else{const a=R_e(i,s);e[i]=a,t[i]=a.value}}return{propTypes:e,defaultProps:t,deprecatedProps:r}}(_v(n,"defaultProps")||{}),o=function N_e(n,e,t){const r=Object.create(null);Object.assign(r,e,n);const i=function B_e(n){const e=_v(n,"layerName")||_v(n,"componentName");return e||Je.once(0,"".concat(n.name,".componentName not specified"))(),e||n.name}(t);return delete n.id,Object.defineProperties(r,{id:{writable:!0,value:i}}),r}(s.defaultProps,r,n),a={...t._propTypes,...s.propTypes};!function F_e(n,e){const t={},r={};for(const i in e){const s=e[i],{name:o,value:a}=s;s.async&&(t[o]=a,r[o]=L_e(o))}n[Pd]=t,n[ml]={},Object.defineProperties(n,r)}(o,a);const c={...t._deprecatedProps,...s.deprecatedProps};(function k_e(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(t);for(const s of e[t])UV(this,s)||(this[s]=r);Je.deprecated(i,e[t].join("/"))()}})})(o,c),n._mergedDefaultProps=o,n._propTypes=a,n._deprecatedProps=c}(n),n._mergedDefaultProps)}function L_e(n){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||gV(e)?this[ml][n]=e:this[ac][n]=e},get(){if(this[ac]){if(n in this[ac])return this[ac][n]||this[Pd][n];if(n in this[ml]){const e=this[tv]&&this[tv].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[Pd][n]}}return this[Pd][n]}}}function UV(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function _v(n,e){return UV(n,e)&&n[e]}let U_e=0;class dS{constructor(...e){w(this,"id",void 0),w(this,"props",void 0),w(this,"count",void 0),this.props=function O_e(n,e){const t=BV(n.constructor),r=Object.create(t);r[tv]=n,r[ml]={},r[ac]={};for(let i=0;i<e.length;++i){const s=e[i];for(const o in s)r[o]=s[o]}return Object.freeze(r),r}(this,e),this.id=this.props.id,this.count=U_e++}clone(e){const{props:t}=this,r={};for(const i in t[Pd])i in t[ac]?r[i]=t[ac][i]:i in t[ml]&&(r[i]=t[ml][i]);return new this.constructor({...t,...r,...e})}}w(dS,"componentName","Component"),w(dS,"defaultProps",{});const j_e=Object.freeze({});class V_e{constructor(e){w(this,"component",void 0),w(this,"onAsyncPropUpdated",void 0),w(this,"asyncProps",void 0),w(this,"oldProps",void 0),w(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps||j_e}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return!!(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){const t=e[ac]||{},r=e[ml]||e,i=e[Pd]||{};for(const s in t){const o=t[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o),t[s]=this.getAsyncProp(s)}for(const s in r){const o=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if("string"==typeof t&&(t=this._fetch(e,t)),t instanceof Promise)return void this._watchPromise(e,t);if(gV(t))return void this._resolveAsyncIterable(e,t);this._setPropValue(e,t)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const r=this.asyncProps[e];return t!==r.resolvedValue&&t!==r.lastValue&&(r.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(t=this._postProcessValue(r,t),r.resolvedValue=t,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,t,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&void 0!==t&&(this._freezeAsyncOldProps(),i.resolvedValue=t,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;t.then(s=>{s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s)}).catch(s=>{this._onError(e,s)})}}_resolveAsyncIterable(e,t){var r=this;return j(function*(){if("data"!==e)return void r._setPropValue(e,t);const i=r.asyncProps[e];if(!i)return;i.pendingLoadCount++;const s=i.pendingLoadCount;let o=[],a=0;var u,c=!1,l=!1;try{for(var h,d=vx(t);c=!(h=yield d.next()).done;c=!1){const f=h.value;{const{dataTransform:p}=r.component.props;o=p?p(f,o):o.concat(f),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:a,endRow:o.length}]}),a=o.length,r._setAsyncPropValue(e,o,s)}}}catch(f){l=!0,u=f}finally{try{c&&null!=d.return&&(yield d.return())}finally{if(l)throw u}}r._onResolve(e,o)})()}_postProcessValue(e,t){const r=e.type;return r&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(t,r,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const i=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}class H_e extends V_e{constructor({attributeManager:e,layer:t}){super(t),w(this,"attributeManager",void 0),w(this,"needsRedraw",void 0),w(this,"needsUpdate",void 0),w(this,"subLayers",void 0),w(this,"usesPickingColorCache",void 0),w(this,"changeFlags",void 0),w(this,"viewport",void 0),w(this,"uniformTransitions",void 0),w(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}_fetch(e,t){const r=this.component.props.fetch;return r?r(t,{propName:e,layer:this.layer}):super._fetch(e,t)}_onResolve(e,t){const r=this.component.props.onDataLoad;"data"===e&&r&&r(t,{propName:e,layer:this.layer})}_onError(e,t){this.layer.raiseError(t,"loading ".concat(e," of ").concat(this.layer))}}const jV=2**24-1,X_e=Object.freeze([]),Y_e=ev(({oldViewport:n,viewport:e})=>n.equals(e));let co=new Uint8ClampedArray(0);const Z_e={data:{type:"data",value:X_e,async:!0},dataComparator:{type:"function",value:null,compare:!1,optional:!0},_dataDiff:{type:"function",value:n=>n&&n.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=t.context;var a;i=i||t.getLoadOptions(),r=r||t.props.loaders,s&&(i={...i,fetch:{...null===(a=i)||void 0===a?void 0:a.fetch,signal:s}});let c=o.contains(n);return!c&&!i&&(o.add({resourceId:n,data:Dp(n,r),persistent:!1}),c=!0),c?o.subscribe({resourceId:n,onChange:l=>{var u;return null===(u=t.internalState)||void 0===u?void 0:u.reloadAsyncProp(e,l)},consumerId:t.id,requestId:e}):Dp(n,r,i)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:st.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,100*-n],compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class yl extends dS{constructor(...e){super(...e),w(this,"internalState",null),w(this,"lifecycle","Awaiting state"),w(this,"context",void 0),w(this,"state",void 0),w(this,"parent",null)}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}project(e){sr(this.internalState);const t=this.internalState.viewport||this.context.viewport,r=LV(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,o]=wU(r,t.pixelProjectionMatrix);return 2===e.length?[i,s]:[i,s,o]}unproject(e){return sr(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){return sr(this.internalState),function T_e(n,e){const{viewport:t,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function A_e(n){const{viewport:e,modelMatrix:t,coordinateOrigin:r}=n;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=n;return i===st.DEFAULT&&(i=e.isGeospatial?st.LNGLAT:st.CARTESIAN),void 0===s&&(s=i),void 0===o&&(o=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:t,fromCoordinateSystem:s,fromCoordinateOrigin:o}}(e),{geospatialOrigin:c,shaderCoordinateOrigin:l,offsetMode:u}=Y3(t,r,i),d=LV(n,{viewport:t,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:u});u&&function fae(n,e,t){n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2]}(d,d,t.projectPosition(c||l));return d}(e,{viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...t})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const t of this.getModels())t.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===st.DEFAULT||e===st.LNGLAT||e===st.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,t=[]){return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){sr(e instanceof Uint8Array);const[t,r,i]=e;return t+256*r+65536*i-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function b_e(n){if(!function E_e(n){return null!==n&&"object"==typeof n}(n))throw new Error("count(): argument not an object");if("function"==typeof n.count)return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(function w_e(n){return null!==n&&"object"==typeof n&&n.constructor===Object}(n))return Object.keys(n).length;throw new Error("count(): argument not a container")}(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;const t=this.getAttributeManager();if(!t)return null;const{positions:r,instancePositions:i}=t.attributes;return null===(e=r||i)||void 0===e?void 0:e.getBounds()}getShaders(e){for(const t of this.props.extensions)e=C_e(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&t)if(Array.isArray(r))for(const c of r)t.invalidateAll(c);else t.invalidateAll();const{props:i,oldProps:s}=e,o=Number.isInteger(s.highlightedObjectIndex)||s.pickable,a=Number.isInteger(i.highlightedObjectIndex)||i.pickable;if(o!==a&&t){const{pickingColors:c,instancePickingColors:l}=t.attributes,u=c||l;u&&(a&&u.constant&&(u.constant=!1,t.invalidate(u.id)),!u.value&&!a&&(u.constant=!0,u.value=[0,0,0]))}}finalizeState(e){for(const r of this.getModels())r.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e)}getPickingInfo({info:e}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,t){var r,i,s,o;t&&(e.message="".concat(t,": ").concat(e.message)),null!==(r=(i=this.props).onError)&&void 0!==r&&r.call(i,e)||null===(s=this.context)||void 0===s||null===(o=s.onError)||void 0===o||o.call(s,e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var e;return(null===(e=this.internalState)||void 0===e?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,(!t||!Y_e({oldViewport:t,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const t=this.getAttributeManager();t&&("all"===e?t.invalidateAll():t.invalidate(e))}updateAttributes(e){for(const t of this.getModels())this._setModelAttributes(t,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:t.data,numInstances:r,startIndices:i,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),r=Object.create(this.props);for(const i in t)Object.defineProperty(r,i,{value:t[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:t}){if(e.constant)return;const r=Math.floor(co.length/3);if(this.internalState.usesPickingColorCache=!0,r<t){t>jV&&Je.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),co=dp.allocate(co,t,{size:3,copy:!0,maxCount:Math.max(t,jV)});const i=Math.floor(co.length/3),s=[];for(let o=r;o<i;o++)this.encodePickingColor(o,s),co[3*o+0]=s[0],co[3*o+1]=s[1],co[3*o+2]=s[2]}e.value=co.subarray(0,3*t)}_setModelAttributes(e,t){const s=this.getAttributeManager().getShaderAttributes(t,e.userData.excludeAttributes||{});e.setAttributes(s)}disablePickingIndex(e){this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:r}=this.getAttributeManager().attributes,i=t||r;if(!i)return;const s=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(o-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,r=e||t;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==co.buffer&&(r.value=co.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){sr(!this.internalState),sr(Number.isFinite(this.props.coordinateSystem)),Ar("layer.initialize",this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new H_e({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Je.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.layer=this,this.internalState.uniformTransitions=new d_e(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Ar("layer.matched",this,this===e);const{state:t,internalState:r}=e;this!==e&&(this.internalState=r,this.internalState.layer=this,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Ar("layer.update",this,e),!e)return;const t=this.props,r=this.context,i=this.internalState,s=r.viewport,o=this._updateUniformTransition();i.propsInTransition=o,r.viewport=i.viewport||s,this.props=o;try{const a=this._getUpdateParams(),c=this.getModels();if(r.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const u of this.props.extensions)u.updateState.call(this,a,u);const l=this.getModels()[0]!==c[0];this._postUpdate(a,l)}finally{r.viewport=s,this.props=t,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Ar("layer.finalize",this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,e)}_drawLayer({moduleParameters:e=null,uniforms:t={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i,t.opacity=Math.pow(this.props.opacity,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,c=a&&a(t)||[0,0];Ko(s.gl,{polygonOffset:c}),$i(s.gl,r,()=>{const l={moduleParameters:e,uniforms:t,parameters:r,context:s};for(const u of this.props.extensions)u.draw.call(this,l,u);this.draw(l)})}finally{this.props=i}}getChangeFlags(){var e;return null===(e=this.internalState)||void 0===e?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const i in e)if(e[i]){let s=!1;if("dataChanged"===i){const o=e[i],a=t[i];o&&Array.isArray(a)&&(t.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0)}t[i]||(t[i]=e[i],s=!0),s&&Ar("layer.changeFlag",this,i,e)}const r=!!(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=r,t.somethingChanged=r||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){const r=function f_e(n,e){const t=kV({newProps:n,oldProps:e,propTypes:aS(n),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=function g_e(n,e){if(null===e)return"oldProps is null, initial diff";let t=!1;const{dataComparator:r,_dataDiff:i}=n;return r?r(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&i&&(t=i(n.data,e.data)||t),t}(n,e);let i=!1;return r||(i=function m_e(n,e){if(null===e)return{all:!0};if("all"in n.updateTriggers&&FV(n,e,"all"))return{all:!0};const t={};let r=!1;for(const i in n.updateTriggers)"all"!==i&&FV(n,e,i)&&(t[i]=!0,r=!0);return!!r&&t}(n,e)),{dataChanged:r,propsChanged:t,updateTriggersChanged:i,extensionsChanged:__e(n,e),transitionsChanged:p_e(n,e)}}(e,t);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,t[s],e[s],null===(i=e.transitions)||void 0===i?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){!function h_e(n){const e=aS(n);for(const t in e){const r=e[t],{validate:i}=r;if(i&&!i(n[t],r))throw new Error("Invalid prop ".concat(t,": ").concat(n[t]))}}(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&"function"==typeof r&&(t.pickingHighlightColor=r(e)),this.setModuleParameters(t),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new o_e(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s?.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:c}=r;if(t||i.autoHighlight!==o||i.highlightedObjectIndex!==a||i.highlightColor!==c){const l={};o||(l.pickingSelectedColor=null),Array.isArray(c)&&(l.pickingHighlightColor=c),(t||a!==i.highlightedObjectIndex)&&(l.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(l)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags;const r=this.getAttributeManager(),i=!!r&&r.getNeedsRedraw(e);return t=t||i,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}w(yl,"defaultProps",Z_e),w(yl,"layerName","Layer");class hS extends yl{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:t}=e;return t&&t.__source&&t.__source.parent&&t.__source.parent.id===this.id&&(e.object=t.__source.object,e.index=t.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||t}getSubLayerRow(e,t,r){return e.__source={parent:this,object:t,index:r},e}getSubLayerAccessor(e){if("function"==typeof e){const t={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(t.index=r.__source.index,e(r.__source.object,t)):e(r,i)}return e}getSubLayerProps(e={}){var t;const{opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:c,autoHighlight:l,highlightColor:u,coordinateSystem:d,coordinateOrigin:h,wrapLongitude:f,positionFormat:p,modelMatrix:g,extensions:m,fetch:y,operation:v,_subLayerProps:_}=this.props,E={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:c,autoHighlight:l,highlightColor:u,coordinateSystem:d,coordinateOrigin:h,wrapLongitude:f,positionFormat:p,modelMatrix:g,extensions:m,fetch:y,operation:v},T=_&&e.id&&_[e.id],I=T&&T.updateTriggers,D=e.id||"sublayer";if(T){const M=this.constructor._propTypes,k=e.type?e.type._propTypes:{};for(const B in T){const L=k[B]||M[B];L&&"accessor"===L.type&&(T[B]=this.getSubLayerAccessor(T[B]))}}Object.assign(E,e,T),E.id="".concat(this.props.id,"-").concat(D),E.updateTriggers={all:null===(t=this.props.updateTriggers)||void 0===t?void 0:t.all,...e.updateTriggers,...I};for(const M of m){const k=M.getSubLayerProps.call(this,M);k&&Object.assign(E,k,{updateTriggers:Object.assign(E.updateTriggers,k.updateTriggers)})}return E}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();i&&(r=QT(this.renderLayers(),Boolean),this.internalState.subLayers=r),Ar("compositeLayer.renderLayers",this,i,r);for(const s of r)s.parent=this}}w(hS,"layerName","CompositeLayer");const yv={name:"project32",dependencies:[XT],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},J_e={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},vv={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:#decl":"\nuniform bool picking_uAttribute;\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function Q_e(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J_e;const e={};if(void 0!==n.pickingSelectedColor)if(n.pickingSelectedColor){const t=n.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=t}else e.picking_uSelectedColorValid=0;if(n.pickingHighlightColor){const t=Array.from(n.pickingHighlightColor,r=>r/255);Number.isFinite(t[3])||(t[3]=1),e.picking_uHighlightColor=t}return void 0!==n.pickingActive&&(e.picking_uActive=!!n.pickingActive,e.picking_uAttribute=!!n.pickingAttribute),e}},VV={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class dc{static get DRAW_MODE(){return VV}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=ai("geometry"),drawMode:r=VV.TRIANGLES,attributes:i={},indices:s=null,vertexCount:o=null}=e;this.id=t,this.drawMode=0|r,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,te(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),("POSITION"===r||"positions"===r)&&!i.size&&(i.size=3),"indices"===r?(te(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let r=1/0;for(const i in e){const s=e[i],{value:o,size:a,constant:c}=s;!c&&o&&a>=1&&(r=Math.min(r,o.length/a))}return te(Number.isFinite(r)),r}}const HV=()=>{},zV={10241:9987,10240:9729,10242:33071,10243:33071};function iye(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function sye(n,e,t,r){return t===e.width&&r===e.height?e:(n.canvas.height=r,n.canvas.width=t,n.clearRect(0,0,n.canvas.width,n.canvas.height),n.drawImage(e,0,0,e.width,e.height,0,0,t,r),n.canvas)}function Lp(n){return n&&(n.id||n.url)}function GV(n,e,t){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r];n[Lp(i)]={...i,x:s,y:t}}}class lye{constructor(e,{onUpdate:t=HV,onError:r=HV}){w(this,"gl",void 0),w(this,"onUpdate",void 0),w(this,"onError",void 0),w(this,"_loadOptions",null),w(this,"_texture",null),w(this,"_externalTexture",null),w(this,"_mapping",{}),w(this,"_textureParameters",null),w(this,"_pendingCount",0),w(this,"_autoPacking",!1),w(this,"_xOffset",0),w(this,"_yOffset",0),w(this,"_rowHeight",0),w(this,"_buffer",4),w(this,"_canvasWidth",1024),w(this,"_canvasHeight",0),w(this,"_canvas",null),this.gl=e,this.onUpdate=t,this.onError=r}finalize(){var e;null===(e=this._texture)||void 0===e||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?Lp(e):e;return this._mapping[t]||{}}setProps({loadOptions:e,autoPacking:t,iconAtlas:r,iconMapping:i,textureParameters:s}){var o;e&&(this._loadOptions=e),void 0!==t&&(this._autoPacking=t),i&&(this._mapping=i),r&&(null===(o=this._texture)||void 0===o||o.delete(),this._texture=null,this._externalTexture=r),s&&(this._textureParameters=s)}get isLoaded(){return 0===this._pendingCount}packIcons(e,t){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(function cye(n,e,t){if(!n||!e)return null;t=t||{};const r={},{iterable:i,objectInfo:s}=hv(n);for(const o of i){s.index++;const a=e(o,s),c=Lp(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!r[c]&&(!t[c]||a.url!==t[c].url)&&(r[c]={...a,source:o,sourceIndex:s.index})}return r}(e,t,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:o,rowHeight:a,canvasHeight:c}=function aye({icons:n,buffer:e,mapping:t={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let c=0;c<n.length;c++){const l=n[c];if(!t[Lp(l)]){const{height:d,width:h}=l;r+h+e>o&&(GV(t,a,i),r=0,i=s+i+e,s=0,a=[]),a.push({icon:l,xOffset:r}),r=r+h+e,s=Math.max(s,d)}}return a.length>0&&GV(t,a,i),{mapping:t,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:o,canvasHeight:iye(s+i+e)}}({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=i,this._xOffset=s,this._yOffset=o,this._canvasHeight=c,this._texture||(this._texture=new or(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||zV})),this._texture.height!==this._canvasHeight&&(this._texture=function oye(n,e,t,r){const i=n.width,s=n.height,o=new or(n.gl,{width:e,height:t,parameters:r});return function que(n,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:s=0,targetInternalFormat:o=6408}=t;let{targetX:a,targetY:c,targetZ:l,width:u,height:d}=t;const{framebuffer:h,deleteFramebuffer:f}=Ap(n);te(h);const{gl:p,handle:g}=h,m=typeof a<"u"||typeof c<"u"||typeof l<"u";a=a||0,c=c||0,l=l||0;const y=p.bindFramebuffer(36160,g);te(e);let v=null;if(e instanceof pl&&(v=e,u=Number.isFinite(u)?u:v.width,d=Number.isFinite(d)?d:v.height,v.bind(0),e=v.target),m)switch(e){case 3553:case 34067:p.copyTexSubImage2D(e,s,a,c,r,i,u,d);break;case 35866:case 32879:Er(p).copyTexSubImage3D(e,s,a,c,l,r,i,u,d)}else p.copyTexImage2D(e,s,o,r,i,u,d,0);v&&v.unbind(),p.bindFramebuffer(36160,y||null),f&&h.delete()}(n,o,{targetY:0,width:i,height:s}),n.delete(),o}(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||zV)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const t=this._canvas.getContext("2d");for(const r of e)this._pendingCount++,Dp(r.url,$j,this._loadOptions).then(i=>{const s=Lp(r),{x:o,y:a,width:c,height:l}=this._mapping[s],u=sye(t,i,c,l);this._texture.setSubImageData({data:u,x:o,y:a,width:c,height:l}),this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const WV=[0,0,0,255],uye={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:n=>n.position},getIcon:{type:"accessor",value:n=>n.icon},getColor:{type:"accessor",value:WV},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class fS extends yl{constructor(...e){super(...e),w(this,"state",void 0)}getShaders(){return super.getShaders({vs:'#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  // convert size in meters to pixels, then scaled and clamp\n \n  // project meters to pixels and clamp to limits \n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n\n  // scale icon height to match instanceSize\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n\n  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n',fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n\n  // if colorMode == 0, use pixel color from the texture\n  // if colorMode == 1 or rendering picking buffer, use texture as transparency mask\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  // Take the global opacity and the alpha from vColor into account for the alpha component\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[yv,vv]})}initializeState(){this.state={iconManager:new lye(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:WV},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:t,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:c,getIcon:l,textureParameters:u}=t,{iconManager:d}=this.state,h=o||this.internalState.isAsyncPropLoading("iconAtlas");if(d.setProps({loadOptions:t.loadOptions,autoPacking:!h,iconAtlas:o,iconMapping:h?a:null,textureParameters:u}),h?r.iconMapping!==t.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&d.packIcons(c,l),i.extensionsChanged){var f;const{gl:p}=this.context;null===(f=this.state.model)||void 0===f||f.delete(),this.state.model=this._getModel(p),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:t,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:c}=this.state,l=c.getTexture();l&&this.state.model.setUniforms(e).setUniforms({iconsTexture:l,iconsTextureDim:[l.width,l.height],sizeUnits:Vy[s],sizeScale:t,sizeMinPixels:r,sizeMaxPixels:i,billboard:o,alphaCutoff:a}).draw()}_getModel(e){return new Bd(e,{...this.getShaders(),id:this.props.id,geometry:new dc({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var t;const r=null===(t=this.getCurrentLayer())||void 0===t?void 0:t.props.onIconError;r?r(e):Je.error(e.error.message)()}getInstanceOffset(e){const{width:t,height:r,anchorX:i=t/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[t/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:t,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[t,r,i,s]}}w(fS,"defaultProps",uye),w(fS,"layerName","IconLayer");const qV=[];class pS extends fS{constructor(...e){super(...e),w(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n\n    // if enable sdf (signed distance fields)\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n\n    // Take the global opacity and the alpha from color into account for the alpha component\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(t,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:t,oldProps:r}=e;let{outlineColor:i}=t;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!t.sdf&&t.outlineWidth&&Je.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:t,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state;e.uniforms={...e.uniforms,buffer:.75,outlineBuffer:i?Math.max(r,.75*(1-i)):-1,gamma:r,sdf:!!t,outlineColor:s},super.draw(e)}getInstanceOffset(e){return e?Array.from(e).flatMap(t=>super.getInstanceOffset(t)):qV}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(t=>super.getInstanceIconFrame(t)):qV}}w(pS,"defaultProps",{getIconOffsets:{type:"accessor",value:n=>n.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}}),w(pS,"layerName","MultiIconLayer");var fye=Qe(772),pye=Qe.n(fye);const mye=[];function _ye(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function XV(n,e,t,r){let i=0;for(let o=e;o<t;o++){var s;i+=(null===(s=r[n[o]])||void 0===s?void 0:s.width)||0}return i}function YV(n,e,t,r,i,s){let o=e,a=0;for(let c=e;c<t;c++){const l=XV(n,c,c+1,i);a+l>r&&(o<c&&s.push(c),o=c,a=0),a+=l}return a}function bye(n,e,t,r,i=0,s){void 0===s&&(s=n.length);const o=[];return"break-all"===e?YV(n,i,s,t,r,o):function vye(n,e,t,r,i,s){let o=e,a=e,c=e,l=0;for(let u=e;u<t;u++)if((" "===n[u]||" "===n[u+1]||u+1===t)&&(c=u+1),c>a){let d=XV(n,a,c,i);l+d>r&&(o<a&&(s.push(a),o=a,l=0),d>r&&(d=YV(n,a,c,r,i,s),o=s[s.length-1])),a=c,l+=d}}(n,i,s,t,r,o),o}function wye(n,e,t,r,i,s){let o=0,a=0;for(let c=e;c<t;c++){const l=n[c],u=r[l];u?(a||(a=u.height),i[c]=o+u.width/2,o+=u.width):(Je.warn("Missing character: ".concat(l," (").concat(l.codePointAt(0),")"))(),i[c]=o,o+=32)}s[0]=o,s[1]=a}function ZV(n,e,t,r,i){const s=Array.from(n),o=s.length,a=new Array(o),c=new Array(o),l=new Array(o),u=("break-word"===t||"break-all"===t)&&isFinite(r)&&r>0,d=[0,0],h=[0,0];let f=0,p=0,g=0;for(let m=0;m<=o;m++){const y=s[m];if(("\n"===y||m===o)&&(g=m),g>p){const v=u?bye(s,t,r,i,p,g):mye;for(let _=0;_<=v.length;_++){const E=0===_?p:v[_-1],T=_<v.length?v[_]:g;wye(s,E,T,i,a,h);for(let I=E;I<T;I++)c[I]=f+h[1]/2,l[I]=h[0];f+=h[1]*e,d[0]=Math.max(d[0],h[0])}p=g}"\n"===y&&(a[p]=0,c[p]=0,l[p]=0,p++)}return d[1]=f,{x:a,y:c,rowWidth:l,size:d}}class KV{constructor(e=5){w(this,"limit",void 0),w(this,"_cache",{}),w(this,"_order",[]),this.limit=e}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const t=this._order.indexOf(e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}const Bp={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function Cye(){const n=[];for(let e=32;e<128;e++)n.push(String.fromCharCode(e));return n}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1};let bv=new KV(3);function xye(n,e){for(let t=0;t<n.length;t++)e.data[4*t+3]=n[t]}function tH(n,e,t,r){n.font="".concat(r," ").concat(t,"px ").concat(e),n.fillStyle="#000",n.textBaseline="alphabetic",n.textAlign="left"}class Iye{constructor(){w(this,"props",{...Bp}),w(this,"_key",void 0),w(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return 1.2}setProps(e={}){Object.assign(this.props,e);const t=this._key;this._key=this._getKey();const r=function Tye(n,e){let t;t="string"==typeof e?new Set(Array.from(e)):new Set(e);const r=bv.get(n);if(!r)return t;for(const i in r.mapping)t.has(i)&&t.delete(i);return t}(this._key,this.props.characterSet),i=bv.get(this._key);if(i&&0===r.size)return void(this._key!==t&&(this._atlas=i));const s=this._generateFontAtlas(this._key,r,i);this._atlas=s,bv.set(this._key,s)}_generateFontAtlas(e,t,r){const{fontFamily:i,fontWeight:s,fontSize:o,buffer:a,sdf:c,radius:l,cutoff:u}=this.props;let d=r&&r.data;d||(d=document.createElement("canvas"),d.width=1024);const h=d.getContext("2d");tH(h,i,o,s);const{mapping:f,canvasHeight:p,xOffset:g,yOffset:m}=function yye({characterSet:n,getFontWidth:e,fontHeight:t,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:o=0,yOffset:a=0}){let c=0,l=o;for(const d of n)if(!s[d]){const h=e(d);l+h+2*r>i&&(l=0,c++),s[d]={x:l+r,y:a+c*(t+2*r)+r,width:h,height:t},l+=h+2*r}const u=t+2*r;return{mapping:s,xOffset:l,yOffset:a+c*u,canvasHeight:_ye(a+(c+1)*u)}}({getFontWidth:y=>h.measureText(y).width,fontHeight:1.2*o,buffer:a,characterSet:t,maxCanvasWidth:1024,...r&&{mapping:r.mapping,xOffset:r.xOffset,yOffset:r.yOffset}});if(d.height!==p){const y=h.getImageData(0,0,d.width,d.height);d.height=p,h.putImageData(y,0,0)}if(tH(h,i,o,s),c){const y=new(pye())(o,a,l,u,i,s),v=h.getImageData(0,0,y.size,y.size);for(const _ of t)xye(y.draw(_),v),h.putImageData(v,f[_].x-a,f[_].y+a)}else for(const y of t)h.fillText(y,f[y].x,f[y].y+.9*o);return{xOffset:g,yOffset:m,mapping:f,data:d,width:d.width,height:d.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:r,buffer:i,sdf:s,radius:o,cutoff:a}=this.props;return s?"".concat(e," ").concat(t," ").concat(r," ").concat(i," ").concat(o," ").concat(a):"".concat(e," ").concat(t," ").concat(r," ").concat(i)}}const Rye={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:n=>n.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class gS extends yl{constructor(...e){super(...e),w(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n\n  // convert size in meters to pixels, then scaled and clamp\n\n  // project meters to pixels and clamp to limits\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Apply opacity to instance color, or return instance picking color\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[yv,vv]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:t}=e;if(t.extensionsChanged){var r;const{gl:i}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:t,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:c}=this.props;c.length<4&&(c=[c[0],c[1],c[0],c[1]]),this.state.model.setUniforms(e).setUniforms({billboard:t,stroked:!!a,padding:c,sizeUnits:Vy[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:o}).draw()}_getModel(e){return new Bd(e,{...this.getShaders(),id:this.props.id,geometry:new dc({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}w(gS,"defaultProps",Rye),w(gS,"layerName","TextBackgroundLayer");const nH={start:1,middle:0,end:-1},rH={top:1,center:0,bottom:-1},mS=[0,0,0,255],Oye={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:mS},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:Bp.characterSet},fontFamily:Bp.fontFamily,fontWeight:Bp.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:mS},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:n=>n.text},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:mS},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class _S extends hS{constructor(...e){super(...e),w(this,"state",void 0),w(this,"getBoundingRect",(t,r)=>{const i=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:c,getTextAnchor:l,getAlignmentBaseline:u}=this.props,d=s(t,r)||"",{size:[h,f]}=ZV(d,c,o,a,i);return[(nH["function"==typeof l?l(t,r):l]-1)*h/2,(rH["function"==typeof u?u(t,r):u]-1)*f/2,h,f]}),w(this,"getIconOffsets",(t,r)=>{const i=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:c,getTextAnchor:l,getAlignmentBaseline:u}=this.props,d=s(t,r)||"",{x:h,y:f,rowWidth:p,size:[g,m]}=ZV(d,c,o,a,i),y=nH["function"==typeof l?l(t,r):l],v=rH["function"==typeof u?u(t,r):u],_=h.length,E=new Array(2*_);let T=0;for(let I=0;I<_;I++)E[T++]=(y-1)*g/2+(1-y)*(g-p[I])/2+h[I],E[T++]=(v-1)*m/2+f[I];return E})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new Iye}}updateState(e){const{props:t,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||t.lineHeight!==r.lineHeight||t.wordBreak!==r.wordBreak||t.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:t,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,o={...e,characterSet:s,fontFamily:t,fontWeight:r};if(!i.mapping)return i.setProps(o),!0;for(const a in o)if(o[a]!==i.props[a])return i.setProps(o),!0;return!1}_updateText(){var e;const{data:t,characterSet:r}=this.props,i=null===(e=t.attributes)||void 0===e?void 0:e.getText;let a,{getText:s}=this.props,o=t.startIndices;const c="auto"===r&&new Set;if(i&&o){const{texts:l,characterCount:u}=function Eye({value:n,length:e,stride:t,offset:r,startIndices:i,characterSet:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:1,c=r?r/o:0,l=i[e]||Math.ceil((n.length-c)/a),u=s&&new Set,d=new Array(e);let h=n;if(a>1||c>0){h=new(0,n.constructor)(l);for(let p=0;p<l;p++)h[p]=n[p*a+c]}for(let f=0;f<e;f++){const m=h.subarray(i[f],i[f+1]||l);d[f]=String.fromCodePoint.apply(null,m),u&&m.forEach(u.add,u)}if(u)for(const f of u)s.add(String.fromCodePoint(f));return{texts:d,characterCount:l}}({...ArrayBuffer.isView(i)?{value:i}:i,length:t.length,startIndices:o,characterSet:c});a=u,s=(d,{index:h})=>l[h]}else{const{iterable:l,objectInfo:u}=hv(t);o=[0],a=0;for(const d of l){u.index++;const h=Array.from(s(d,u)||"");c&&h.forEach(c.add,c),a+=h.length,o.push(a)}}this.setState({getText:s,startIndices:o,numInstances:a,characterSet:c||r})}renderLayers(){const{startIndices:e,numInstances:t,getText:r,fontAtlasManager:{scale:i,texture:s,mapping:o},styleVersion:a}=this.state,{data:c,_dataDiff:l,getPosition:u,getColor:d,getSize:h,getAngle:f,getPixelOffset:p,getBackgroundColor:g,getBorderColor:m,getBorderWidth:y,backgroundPadding:v,background:_,billboard:E,fontSettings:T,outlineWidth:I,outlineColor:D,sizeScale:M,sizeUnits:k,sizeMinPixels:B,sizeMaxPixels:L,transitions:z,updateTriggers:R}=this.props,F=this.getSubLayerClass("characters",pS),W=this.getSubLayerClass("background",gS);return[_&&new W({getFillColor:g,getLineColor:m,getLineWidth:y,padding:v,getPosition:u,getSize:h,getAngle:f,getPixelOffset:p,billboard:E,sizeScale:M/this.state.fontAtlasManager.props.fontSize,sizeUnits:k,sizeMinPixels:B,sizeMaxPixels:L,transitions:z&&{getPosition:z.getPosition,getAngle:z.getAngle,getSize:z.getSize,getFillColor:z.getBackgroundColor,getLineColor:z.getBorderColor,getLineWidth:z.getBorderWidth,getPixelOffset:z.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:R.getPosition,getAngle:R.getAngle,getSize:R.getSize,getFillColor:R.getBackgroundColor,getLineColor:R.getBorderColor,getLineWidth:R.getBorderWidth,getPixelOffset:R.getPixelOffset,getBoundingRect:{getText:R.getText,getTextAnchor:R.getTextAnchor,getAlignmentBaseline:R.getAlignmentBaseline,styleVersion:a}}}),{data:c.attributes&&c.attributes.background?{length:c.length,attributes:c.attributes.background}:c,_dataDiff:l,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new F({sdf:T.sdf,smoothing:Number.isFinite(T.smoothing)?T.smoothing:Bp.smoothing,outlineWidth:I,outlineColor:D,iconAtlas:s,iconMapping:o,getPosition:u,getColor:d,getSize:h,getAngle:f,getPixelOffset:p,billboard:E,sizeScale:M*i,sizeUnits:k,sizeMinPixels:B*i,sizeMaxPixels:L*i,transitions:z&&{getPosition:z.getPosition,getAngle:z.getAngle,getColor:z.getColor,getSize:z.getSize,getPixelOffset:z.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:R.getText,getPosition:R.getPosition,getAngle:R.getAngle,getColor:R.getColor,getSize:R.getSize,getPixelOffset:R.getPixelOffset,getIconOffsets:{getText:R.getText,getTextAnchor:R.getTextAnchor,getAlignmentBaseline:R.getAlignmentBaseline,styleVersion:a}}}),{data:c,_dataDiff:l,startIndices:e,numInstances:t,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){!function Sye(n){Je.assert(Number.isFinite(n)&&n>=3,"Invalid cache limit"),bv=new KV(n)}(e)}}w(_S,"defaultProps",Oye),w(_S,"layerName","TextLayer");const iH="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",Pye={lightSources:{}};function yS(){let{color:n=[0,0,0],intensity:e=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.map(t=>t*e/255)}const vS={name:"lights",vs:iH,fs:iH,getUniforms:function sH(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pye;if("lightSources"in n){const{ambientLight:e,pointLights:t,directionalLights:r}=n.lightSources||{};return e||t&&t.length>0||r&&r.length>0?Object.assign({},function Nye(n){let{ambientLight:e,pointLights:t=[],directionalLights:r=[]}=n;const i={};return i["lighting_uAmbientLight.color"]=e?yS(e):[0,0,0],t.forEach((s,o)=>{i["lighting_uPointLight[".concat(o,"].color")]=yS(s),i["lighting_uPointLight[".concat(o,"].position")]=s.position,i["lighting_uPointLight[".concat(o,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=t.length,r.forEach((s,o)=>{i["lighting_uDirectionalLight[".concat(o,"].color")]=yS(s),i["lighting_uDirectionalLight[".concat(o,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}({ambientLight:e,pointLights:t,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in n){const e={pointLights:[],directionalLights:[]};for(const t of n.lights||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights.push(t);break;case"point":e.pointLights.push(t)}return sH({lightSources:e})}return{}},defines:{MAX_LIGHTS:3}},kye={};const Lye={name:"phong-lighting",dependencies:[vS],fs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_FRAGMENT:1},getUniforms:function aH(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kye;if(!("material"in n))return{};const{material:e}=n;return e?function Fye(n){const{ambient:e=.35,diffuse:t=.6,shininess:r=32,specularColor:i=[30,30,30]}=n;return{lighting_uAmbient:e,lighting_uDiffuse:t,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}(e):{lighting_uEnabled:!1}}},bS=Math.PI/180,wv=new Float32Array(16),cH=new Float32Array(12);function lH(n,e,t){const r=e[0]*bS,i=e[1]*bS,s=e[2]*bS,o=Math.sin(s),a=Math.sin(r),c=Math.sin(i),l=Math.cos(s),u=Math.cos(r),d=Math.cos(i),h=t[0],f=t[1],p=t[2];n[0]=h*d*u,n[1]=h*c*u,n[2]=h*-a,n[3]=f*(-c*l+d*a*o),n[4]=f*(d*l+c*a*o),n[5]=f*u*o,n[6]=p*(c*o+d*a*l),n[7]=p*(-d*o+c*a*l),n[8]=p*u*l}function uH(n){return n[0]=n[0],n[1]=n[1],n[2]=n[2],n[3]=n[4],n[4]=n[5],n[5]=n[6],n[6]=n[8],n[7]=n[9],n[8]=n[10],n[9]=n[12],n[10]=n[13],n[11]=n[14],n.subarray(0,12)}const dH={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(n,{startRow:e,endRow:t}){const{data:r,getOrientation:i,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,c=Array.isArray(a),l=c&&16===a.length,u=Array.isArray(s),d=Array.isArray(i),h=Array.isArray(o),f=l||!c&&!!a(r[0]);n.constant=f?l:d&&u&&h;const p=n.value;if(n.constant){let g;f?(wv.set(a),g=uH(wv)):(g=cH,lH(g,i,s),g.set(o,9)),n.value=new Float32Array(g)}else{let g=e*n.size;const{iterable:m,objectInfo:y}=hv(r,e,t);for(const v of m){let _;y.index++,f?(wv.set(l?a:a(v,y)),_=uH(wv)):(_=cH,lH(_,d?i:i(v,y),u?s:s(v,y)),_.set(h?o:o(v,y),9)),p[g++]=_[0],p[g++]=_[1],p[g++]=_[2],p[g++]=_[3],p[g++]=_[4],p[g++]=_[5],p[g++]=_[6],p[g++]=_[7],p[g++]=_[8],p[g++]=_[9],p[g++]=_[10],p[g++]=_[11]}}}};function hH(n,e){return e===st.CARTESIAN||e===st.METER_OFFSETS||e===st.DEFAULT&&!n.isGeospatial}function fH(n,e){(n.COLOR_0||n.colors)&&e||(n.colors={constant:!0,value:new Float32Array([1,1,1])}),Je.assert(n.positions||n.POSITION,'no "postions" or "POSITION" attribute in mesh')}function jye(n,e){if(n.attributes)return fH(n.attributes,e),n instanceof dc?n:new dc(n);if(n.positions||n.POSITION)return fH(n,e),new dc({attributes:n});throw Error("Invalid mesh")}class wS extends yl{constructor(...e){super(...e),w(this,"state",void 0)}getShaders(){const e=!Xe(this.context.gl),t={};return zT(this.context.gl,"GLSL_DERIVATIVES")&&(t.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\n\n// Scale the model\nuniform float sizeScale;\nuniform bool composeModelMatrix;\n\n// Primitive attributes\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\n\n// Instance attributes\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\n\n// Outputs to fragment shader\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    // using instancePositions as world coordinates\n    // when using globe mode, this branch does not re-orient the model to align with the surface of the earth\n    // call project_normal before setting position to avoid rotation\n    normals_commonspace = project_normal(instanceModelMatrix * normals);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n    geometry.position = position_commonspace;\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n    geometry.position = position_commonspace;\n    normals_commonspace = project_normal(instanceModelMatrix * normals);\n  }\n\n  geometry.normal = normals_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n\n// NOTE(Tarek): This is necessary because\n// headless.gl reports the extension as\n// available but does not support it in\n// the shader.\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[yv,Lye,vv],transpileToGLSL100:e,defines:t})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:dH}),this.setState({emptyTexture:new or(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:t,oldProps:r,changeFlags:i}=e;if(t.mesh!==r.mesh||i.extensionsChanged){var s;if(null===(s=this.state.model)||void 0===s||s.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const o=t.mesh.attributes||t.mesh;this.setState({hasNormals:!(!o.NORMAL&&!o.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==r.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:t}=this.context,{sizeScale:r,coordinateSystem:i,_instanced:s}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:r,composeModelMatrix:!s||hH(t,i),flatShading:!this.state.hasNormals}).draw()}getModel(e){const t=new Bd(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:jye(e,this.props._useMeshColors),isInstanced:!0}),{texture:r}=this.props,{emptyTexture:i}=this.state;return t.setUniforms({sampler:r||i,hasTexture:!!r}),t}setTexture(e){const{emptyTexture:t,model:r}=this.state;r&&r.setUniforms({sampler:e||t,hasTexture:!!e})}}w(wS,"defaultProps",{mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}}),w(wS,"layerName","SimpleMeshLayer");const pH={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[vS]};class Ud{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t}=e;this.id=t||ai(this.constructor.name),this.display=!0,this.position=new wr,this.rotation=new wr,this.scale=new wr(1,1,1),this.matrix=new Ve,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}getBounds(){return null}setPosition(e){return te(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return te(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return te(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e){arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?this.matrix=e:this.matrix.copy(e)}setMatrixComponents(e){let{position:t,rotation:r,scale:i,update:s=!0}=e;return t&&this.setPosition(t),r&&this.setRotation(r),i&&this.setScale(i),s&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,r=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(r),this}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{position:t,rotation:r,scale:i}=e;return t&&this.setPosition(t),r&&this.setRotation(r),i&&this.setScale(i),this.updateMatrix(),this}getCoordinateUniforms(e,t){te(e),t=t||this.matrix;const r=new Ve(e).multiplyRight(t),i=r.invert(),s=i.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:r,worldInverseMatrix:i,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class Up extends Ud{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=Array.isArray(e)?{children:e}:e;const{children:t=[]}=e;ue.assert(t.every(r=>r instanceof Ud),"every child must an instance of ScenegraphNode"),super(e),this.children=t}add(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(const i of t)Array.isArray(i)?this.add(...i):this.children.push(i);return this}remove(e){const t=this.children,r=t.indexOf(e);return r>-1&&t.splice(r,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}getBounds(){const e=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse((t,r)=>{let{worldMatrix:i}=r;const s=t.getBounds();if(!s)return;const[o,a]=s,c=new wr(o).add(a).divide([2,2,2]);i.transformAsPoint(c,c);const l=new wr(a).subtract(o).divide([2,2,2]);i.transformAsVector(l,l);for(let u=0;u<8;u++){const d=new wr(1&u?-1:1,2&u?-1:1,4&u?-1:1).multiply(l).add(c);for(let h=0;h<3;h++)e[0][h]=Math.min(e[0][h],d[h]),e[1][h]=Math.max(e[1][h],d[h])}}),Number.isFinite(e[0][0])?e:null}traverse(e){let{worldMatrix:t=new Ve}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=new Ve(t).multiplyRight(this.matrix);for(const i of this.children)i instanceof Up?i.traverse(e,{worldMatrix:r}):e(i,{worldMatrix:r})}}let Ev;class ES extends rU{static get ZERO(){return Ev||(Ev=new ES(0,0,0,0),Object.freeze(Ev)),Ev}constructor(e=0,t=0,r=0,i=0){super(-0,-0,-0,-0),Xo(e)&&1===arguments.length?this.copy(e):(wn.debug&&(Bt(e),Bt(t),Bt(r),Bt(i)),this[0]=e,this[1]=t,this[2]=r,this[3]=i)}set(e,t,r,i){return this[0]=e,this[1]=t,this[2]=r,this[3]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return wn.debug&&(Bt(e.x),Bt(e.y),Bt(e.z),Bt(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=Bt(e)}get w(){return this[3]}set w(e){this[3]=Bt(e)}transform(e){return eT(this,this,e),this.check()}transformByMatrix3(e){return function xae(n,e,t){const r=e[0],i=e[1],s=e[2];n[0]=t[0]*r+t[3]*i+t[6]*s,n[1]=t[1]*r+t[4]*i+t[7]*s,n[2]=t[2]*r+t[5]*i+t[8]*s,n[3]=e[3]}(this,this,e),this.check()}transformByMatrix2(e){return function Tae(n,e,t){const r=e[0],i=e[1];n[0]=t[0]*r+t[2]*i,n[1]=t[1]*r+t[3]*i,n[2]=e[2],n[3]=e[3]}(this,this,e),this.check()}transformByQuaternion(e){return aU(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}function gH(){var n=new oi(4);return oi!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function mH(n,e,t){t*=.5;var r=Math.sin(t);return n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=Math.cos(t),n}function _H(n,e,t){var r=e[0],i=e[1],s=e[2],o=e[3],a=t[0],c=t[1],l=t[2],u=t[3];return n[0]=r*u+o*a+i*l-s*c,n[1]=i*u+o*c+s*a-r*l,n[2]=s*u+o*l+r*c-i*a,n[3]=o*u-r*a-i*c-s*l,n}var vH=pU,nve=function(){var n=iU(),e=sU(1,0,0),t=sU(0,1,0);return function(r,i,s){var o=oU(i,s);return o<-.999999?(Ry(n,e,i),function hae(n){return Math.hypot(n[0],n[1],n[2])}(n)<1e-6&&Ry(n,t,i),function gae(n,e){var t=e[0],r=e[1],i=e[2],s=t*t+r*r+i*i;s>0&&(s=1/Math.sqrt(s)),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s}(n,n),mH(r,n,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Ry(n,i,s),r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=1+o,function nce(n,e){var t=e[0],r=e[1],i=e[2],s=e[3],o=t*t+r*r+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=r*o,n[2]=i*o,n[3]=s*o,n}(r,r))}}();gH(),gH(),function Hye(){var n=new oi(9);oi!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1}();const rve=[0,0,0,1],sve={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ove={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function EH(n){if(!n._animation){const e=ove[n.componentType],t=sve[n.type],r=t*n.count,{buffer:i,byteOffset:s}=n.bufferView.data,o=new e(i,s+(n.byteOffset||0),r);if(1===t)n._animation=Array.from(o);else{const a=[];for(let c=0;c<o.length;c+=t)a.push(Array.from(o.slice(c,c+t)));n._animation=a}}return n._animation}const ave=new Ve,CS=new class ive extends QA{constructor(e=0,t=0,r=0,i=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,r,i)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,r,i){return this[0]=e,this[1]=t,this[2]=r,this[3]=i,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return function yH(n,e){var r,t=e[0]+e[4]+e[8];if(t>0)r=Math.sqrt(t+1),n[3]=.5*r,n[0]=(e[5]-e[7])*(r=.5/r),n[1]=(e[6]-e[2])*r,n[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var s=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*s+s]-e[3*o+o]+1),n[i]=.5*r,n[3]=(e[3*s+o]-e[3*o+s])*(r=.5/r),n[s]=(e[3*s+i]+e[3*i+s])*r,n[o]=(e[3*o+i]+e[3*i+o])*r}return n}(this,e),this.check()}fromAxisRotation(e,t){return mH(this,e,t),this.check()}identity(){return function zye(n){n[0]=0,n[1]=0,n[2]=0,n[3]=1}(this),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Bt(e)}get y(){return this[1]}set y(e){this[1]=Bt(e)}get z(){return this[2]}set z(e){this[2]=Bt(e)}get w(){return this[3]}set w(e){this[3]=Bt(e)}len(){return function ece(n){return Math.hypot(n[0],n[1],n[2],n[3])}(this)}lengthSquared(){return function tce(n){var e=n[0],t=n[1],r=n[2],i=n[3];return e*e+t*t+r*r+i*i}(this)}dot(e){return function rce(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]}(this,e)}rotationTo(e,t){return nve(this,e,t),this.check()}add(e){return function Qae(n,e,t){n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3]}(this,this,e),this.check()}calculateW(){return function qye(n,e){var t=e[0],r=e[1],i=e[2];n[0]=t,n[1]=r,n[2]=i,n[3]=Math.sqrt(Math.abs(1-t*t-r*r-i*i))}(this,this),this.check()}conjugate(){return function Kye(n,e){n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3]}(this,this),this.check()}invert(){return function Zye(n,e){var t=e[0],r=e[1],i=e[2],s=e[3],o=t*t+r*r+i*i+s*s,a=o?1/o:0;n[0]=-t*a,n[1]=-r*a,n[2]=-i*a,n[3]=s*a}(this,this),this.check()}lerp(e,t,r){return void 0===r?this.lerp(this,e,t):(function ice(n,e,t,r){var i=e[0],s=e[1],o=e[2],a=e[3];n[0]=i+r*(t[0]-i),n[1]=s+r*(t[1]-s),n[2]=o+r*(t[2]-o),n[3]=a+r*(t[3]-a)}(this,e,t,r),this.check())}multiplyRight(e){return _H(this,this,e),this.check()}multiplyLeft(e){return _H(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return function Gye(n,e,t){t*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(t),c=Math.cos(t);n[0]=r*c+o*a,n[1]=i*c+s*a,n[2]=s*c-i*a,n[3]=o*c-r*a}(this,this,e),this.check()}rotateY(e){return function Wye(n,e,t){t*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(t),c=Math.cos(t);n[0]=r*c-s*a,n[1]=i*c+o*a,n[2]=s*c+r*a,n[3]=o*c-i*a}(this,this,e),this.check()}rotateZ(e){return function $ye(n,e,t){t*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(t),c=Math.cos(t);n[0]=r*c+i*a,n[1]=i*c-r*a,n[2]=s*c+o*a,n[3]=o*c-s*a}(this,this,e),this.check()}scale(e){return vH(this,this,e),this.check()}slerp(e,t,r){let i,s,o;switch(arguments.length){case 1:({start:i=rve,target:s,ratio:o}=e);break;case 2:i=this,s=e,o=t;break;default:i=e,s=t,o=r}return function Cv(n,e,t,r){var h,f,p,g,m,i=e[0],s=e[1],o=e[2],a=e[3],c=t[0],l=t[1],u=t[2],d=t[3];return(f=i*c+s*l+o*u+a*d)<0&&(f=-f,c=-c,l=-l,u=-u,d=-d),1-f>Qs?(h=Math.acos(f),p=Math.sin(h),g=Math.sin((1-r)*h)/p,m=Math.sin(r*h)/p):(g=1-r,m=r),n[0]=g*i+m*c,n[1]=g*s+m*l,n[2]=g*o+m*u,n[3]=g*a+m*d,n}(this,i,s,o),this.check()}transformVector4(e,t=new ES){return function sce(n,e,t){var r=e[0],i=e[1],s=e[2],o=t[0],a=t[1],c=t[2],l=t[3],u=l*r+a*s-c*i,d=l*i+c*r-o*s,h=l*s+o*i-a*r,f=-o*r-a*i-c*s;n[0]=u*l+f*-o+d*-c-h*-a,n[1]=d*l+f*-a+h*-o-u*-c,n[2]=h*l+f*-c+u*-a-d*-o,n[3]=e[3]}(t,e,this),Dy(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}};class fve{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const r=(e/1e3-this.startTime)*this.speed;this.channels.forEach(i=>{let{sampler:s,target:o,path:a}=i;(function hve(n,e,t,r){let{input:i,interpolation:s,output:o}=e;const c=n%i[i.length-1],l=i.findIndex(f=>f>=c),u=Math.max(0,l-1);if(!Array.isArray(t[r]))switch(r){case"translation":t[r]=[0,0,0];break;case"rotation":t[r]=[0,0,0,1];break;case"scale":t[r]=[1,1,1];break;default:ue.warn("Bad animation path ".concat(r))()}te(t[r].length===o[u].length);const d=i[u],h=i[l];switch(s){case"STEP":!function dve(n,e,t){for(let r=0;r<t.length;r++)n[e][r]=t[r]}(t,r,o[u]);break;case"LINEAR":h>d&&function lve(n,e,t,r,i){if("rotation"===e){CS.slerp({start:t,target:r,ratio:i});for(let s=0;s<CS.length;s++)n[e][s]=CS[s]}else for(let s=0;s<t.length;s++)n[e][s]=i*r[s]+(1-i)*t[s]}(t,r,o[u],o[l],(c-d)/(h-d));break;case"CUBICSPLINE":h>d&&function uve(n,e,t){let{p0:r,outTangent0:i,inTangent1:s,p1:o,tDiff:a,ratio:c}=t;for(let l=0;l<n[e].length;l++){const u=i[l]*a,d=s[l]*a;n[e][l]=(2*Math.pow(c,3)-3*Math.pow(c,2)+1)*r[l]+(Math.pow(c,3)-2*Math.pow(c,2)+c)*u+(-2*Math.pow(c,3)+3*Math.pow(c,2))*o[l]+(Math.pow(c,3)-Math.pow(c,2))*d}}(t,r,{p0:o[3*u+1],outTangent0:o[3*u+2],inTangent1:o[3*l+0],p1:o[3*l+1],tDiff:h-d,ratio:(c-d)/(h-d)});break;default:ue.warn("Interpolation ".concat(s," not supported"))()}})(r,s,o,a),function cve(n,e){if(e.matrix.identity(),n.translation&&e.matrix.translate(n.translation),n.rotation){const t=ave.fromQuaternion(n.rotation);e.matrix.multiplyRight(t)}n.scale&&e.matrix.scale(n.scale)}(o,o._node)})}}class pve{constructor(e){this.animations=e.animations.map((t,r)=>{const i=t.name||"Animation-".concat(r),s=t.samplers.map(a=>{let{input:c,interpolation:l="LINEAR",output:u}=a;return{input:EH(e.accessors[c]),interpolation:l,output:EH(e.accessors[u])}}),o=t.channels.map(a=>{let{sampler:c,target:l}=a;return{sampler:s[c],target:e.nodes[l.node],path:l.path}});return new fve({name:i,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}class gve extends Ud{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t),this.onBeforeRender=null,this.AfterRender=null,e instanceof Bd?(this.model=e,this._setModelNodeProps(t)):this.model=new Bd(e,t),this.bounds=null,this.managedResources=t.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}getBounds(){return this.bounds}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(e){this.model.setProps(e)}}class mve{constructor(e,t){let{attributes:r,material:i,pbrDebug:s,imageBasedLightingEnvironment:o,lights:a,useTangents:c}=t;this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},zT(e,"GLSL_TEXTURE_LOD")&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],o&&(this.uniforms.u_DiffuseEnvSampler=o.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=o.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=o.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),s&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(r.NORMAL,"HAS_NORMALS"),this.defineIfPresent(r.TANGENT&&c,"HAS_TANGENTS"),this.defineIfPresent(r.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(o,"USE_IBL"),this.defineIfPresent(a,"USE_LIGHTS"),this.defineIfPresent(s,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const c=new or(this.gl,{id:e.name||e.id,parameters:{...i,...a},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...o});this.uniforms[t]=c,this.defineIfPresent(r,r),this.generatedTextures.push(c)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:r=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,r]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=!!e.unlit,e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(ue.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach(e=>e.delete())}}function CH(n,e){return Xe(n)?"#version 300 es\n".concat(e):e}const bve={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},wve={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class Eve{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.options=Object.assign({},wve,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(r=>this.createScene(r))}createAnimator(){return Array.isArray(this.gltf.animations)?new pve(this.gltf):null}createScene(e){const r=(e.nodes||[]).map(s=>this.createNode(s));return new Up({id:e.name||e.id,children:r})}createNode(e){if(!e._node){const r=(e.children||[]).map(s=>this.createNode(s));e.mesh&&r.push(this.createMesh(e.mesh));const i=new Up({id:e.name||e.id,children:r});if(e.matrix)i.setMatrix(e.matrix);else{if(i.matrix.identity(),e.translation&&i.matrix.translate(e.translation),e.rotation){const s=(new Ve).fromQuaternion(e.rotation);i.matrix.multiplyRight(s)}e.scale&&i.matrix.scale(e.scale)}e._node=i}return e._node}createMesh(e){if(!e._mesh){const r=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),i=new Up({id:e.name||e.id,children:r});e._mesh=i}return e._mesh}getVertexCount(e){ue.warn("getVertexCount() not found")()}createPrimitive(e,t,r){const i=function vve(n,e){const{id:t,drawMode:r,vertexCount:i,attributes:s,modelOptions:o}=e,a=new mve(n,e);ue.info(4,"createGLTFModel defines: ",a.defines)();const c=[];c.push(...a.generatedTextures),c.push(...Object.values(s).map(u=>u.buffer));const l=new gve(n,{id:t,drawMode:r,vertexCount:i,modules:[pH],parameters:a.parameters,vs:CH(n,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:CH(n,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:c,...o,defines:{...a.defines,...o.defines}});return l.setProps({attributes:s}),l.setUniforms(a.uniforms),l}(this.gl,Object.assign({id:e.name||"".concat(r.name||r.id,"-primitive-").concat(t),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options));return i.bounds=[e.attributes.POSITION.min,e.attributes.POSITION.max],i}createAttributes(e,t){const r={};return Object.keys(e).forEach(i=>{r[i]=this.createAccessor(e[i],this.createBuffer(e[i],this.gl.ARRAY_BUFFER))}),t&&(r.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),ue.info(4,"glTF Attributes",{attributes:e,indices:t,generated:r})(),r}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:r}=e;return r.lumaBuffers||(r.lumaBuffers={}),r.lumaBuffers[t]||(r.lumaBuffers[t]=new Pt(this.gl,{id:"from-".concat(r.id),data:r.data||e.value,target:t})),r.lumaBuffers[t]}createAccessor(e,t){return new ci({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:bve[e.type]})}createSampler(e){return e}needsPOT(){return!1}}var jp=Qe(435);const AS={};function vl(n){return TS.apply(this,arguments)}function TS(){return TS=j(function*(n,e=null,t={}){return e&&(n=function Sve(n,e,t){if(n.startsWith("http"))return n;const r=t.modules||{};return r[n]?r[n]:lc?t.CDN?(ro(t.CDN.startsWith("http")),"".concat(t.CDN,"/").concat(e,"@").concat("3.2.13","/dist/libs/").concat(n)):hx?"../src/libs/".concat(n):"modules/".concat(e,"/src/libs/").concat(n):"modules/".concat(e,"/dist/libs/").concat(n)}(n,e,t)),AS[n]=AS[n]||function Ive(n){return xS.apply(this,arguments)}(n),yield AS[n]}),TS.apply(this,arguments)}function xS(){return xS=j(function*(n){if(n.endsWith("wasm"))return yield(yield fetch(n)).arrayBuffer();if(!lc)try{return jp&&jp.requireFromFile&&(yield jp.requireFromFile(n))}catch{return null}return hx?importScripts(n):function Mve(n,e){if(!lc)return jp.requireFromString&&jp.requireFromString(n,e);if(hx)return eval.call(cfe,n),null;const t=document.createElement("script");t.id=e;try{t.appendChild(document.createTextNode(n))}catch{t.text=n}return document.body.appendChild(t),null}(yield(yield fetch(n)).text(),n)}),xS.apply(this,arguments)}const Dve="https://unpkg.com/@loaders.gl/textures@".concat("3.2.13","/dist/libs/basis_encoder.wasm"),Rve="https://unpkg.com/@loaders.gl/textures@".concat("3.2.13","/dist/libs/basis_encoder.js");let SS,DS;function TH(n){return IS.apply(this,arguments)}function IS(){return IS=j(function*(n){const e=n.modules||{};return e.basis?e.basis:(SS=SS||function Ove(n){return MS.apply(this,arguments)}(n),yield SS)}),IS.apply(this,arguments)}function MS(){return MS=j(function*(n){let e=null,t=null;return[e,t]=yield Promise.all([yield vl("basis_transcoder.js","textures",n),yield vl("basis_transcoder.wasm","textures",n)]),e=e||globalThis.BASIS,yield function Pve(n,e){const t={};return e&&(t.wasmBinary=e),new Promise(r=>{n(t).then(i=>{const{BasisFile:s,initializeBasis:o}=i;o(),r({BasisFile:s})})})}(e,t)}),MS.apply(this,arguments)}function xH(n){return RS.apply(this,arguments)}function RS(){return RS=j(function*(n){const e=n.modules||{};return e.basisEncoder?e.basisEncoder:(DS=DS||function Nve(n){return OS.apply(this,arguments)}(n),yield DS)}),RS.apply(this,arguments)}function OS(){return OS=j(function*(n){let e=null,t=null;return[e,t]=yield Promise.all([yield vl(Rve,"textures",n),yield vl(Dve,"textures",n)]),e=e||globalThis.BASIS,yield function kve(n,e){const t={};return e&&(t.wasmBinary=e),new Promise(r=>{n(t).then(i=>{const{BasisFile:s,KTX2File:o,initializeBasis:a,BasisEncoder:c}=i;a(),r({BasisFile:s,KTX2File:o,BasisEncoder:c})})})}(e,t)}),OS.apply(this,arguments)}const Fve=["","WEBKIT_","MOZ_"],SH={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let Av=null;var PS,Tv,NS,xv,MH,kS,DH,RH;new Uint8Array([0]),function(n){n[n.NONE=0]="NONE",n[n.BASISLZ=1]="BASISLZ",n[n.ZSTD=2]="ZSTD",n[n.ZLIB=3]="ZLIB"}(PS||(PS={})),function(n){n[n.BASICFORMAT=0]="BASICFORMAT"}(Tv||(Tv={})),function(n){n[n.UNSPECIFIED=0]="UNSPECIFIED",n[n.ETC1S=163]="ETC1S",n[n.UASTC=166]="UASTC"}(NS||(NS={})),function(n){n[n.UNSPECIFIED=0]="UNSPECIFIED",n[n.SRGB=1]="SRGB"}(xv||(xv={})),function(n){n[n.UNSPECIFIED=0]="UNSPECIFIED",n[n.LINEAR=1]="LINEAR",n[n.SRGB=2]="SRGB",n[n.ITU=3]="ITU",n[n.NTSC=4]="NTSC",n[n.SLOG=5]="SLOG",n[n.SLOG2=6]="SLOG2"}(MH||(MH={})),function(n){n[n.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",n[n.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(kS||(kS={})),function(n){n[n.RGB=0]="RGB",n[n.RRR=3]="RRR",n[n.GGG=4]="GGG",n[n.AAA=15]="AAA"}(DH||(DH={})),function(n){n[n.RGB=0]="RGB",n[n.RGBA=3]="RGBA",n[n.RRR=4]="RRR",n[n.RRRG=5]="RRRG"}(RH||(RH={}));const Si=[171,75,84,88,32,50,48,187,13,10,26,10],Hve={etc1:{basisFormat:0,compressed:!0,format:36196},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:33776},bc3:{basisFormat:3,compressed:!0,format:33779},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:35840},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:35842},"astc-4x4":{basisFormat:10,compressed:!0,format:37808},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};function LS(){return LS=j(function*(n,e){if("auto"===e.basis.containerFormat){if(function Vve(n){const e=new Uint8Array(n);return!(e.byteLength<Si.length||e[0]!==Si[0]||e[1]!==Si[1]||e[2]!==Si[2]||e[3]!==Si[3]||e[4]!==Si[4]||e[5]!==Si[5]||e[6]!==Si[6]||e[7]!==Si[7]||e[8]!==Si[8]||e[9]!==Si[9]||e[10]!==Si[10]||e[11]!==Si[11])}(n))return NH((yield xH(e)).KTX2File,n,e);const{BasisFile:t}=yield TH(e);return BS(t,n,e)}if("encoder"===e.basis.module){const t=yield xH(e);return"ktx2"===e.basis.containerFormat?NH(t.KTX2File,n,e):BS(t.BasisFile,n,e)}{const{BasisFile:r}=yield TH(e);return BS(r,n,e)}}),LS.apply(this,arguments)}function BS(n,e,t){const r=new n(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("Failed to start basis transcoding");const i=r.getNumImages(),s=[];for(let o=0;o<i;o++){const a=r.getNumLevels(o),c=[];for(let l=0;l<a;l++)c.push(Gve(r,o,l,t));s.push(c)}return s}finally{r.close(),r.delete()}}function Gve(n,e,t,r){const i=n.getImageWidth(e,t),s=n.getImageHeight(e,t),o=n.getHasAlpha(),{compressed:a,format:c,basisFormat:l}=kH(r,o),u=n.getImageTranscodedSizeInBytes(e,t,l),d=new Uint8Array(u);if(!n.transcodeImage(d,e,t,l,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:s,data:d,compressed:a,format:c,hasAlpha:o}}function NH(n,e,t){const r=new n(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("failed to start KTX2 transcoding");const i=r.getLevels(),s=[];for(let o=0;o<i;o++){s.push(Wve(r,o,t));break}return[s]}finally{r.close(),r.delete()}}function Wve(n,e,t){const{alphaFlag:r,height:i,width:s}=n.getImageLevelInfo(e,0,0),{compressed:o,format:a,basisFormat:c}=kH(t,r),l=n.getImageTranscodedSizeInBytes(e,0,0,c),u=new Uint8Array(l);if(!n.transcodeImage(u,e,0,0,c,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:s,height:i,data:u,compressed:o,hasAlpha:r,format:a}}function kH(n,e){let t=n&&n.basis&&n.basis.format;return"auto"===t&&(t=FH()),"object"==typeof t&&(t=e?t.alpha:t.noAlpha),t=t.toLowerCase(),Hve[t]}function FH(){const n=function Lve(n){if(!Av){n=n||function Bve(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}()||void 0,Av=new Set;for(const e of Fve)for(const t in SH)n&&n.getExtension("".concat(e).concat(t))&&Av.add(SH[t])}return Av}();return n.has("astc")?"astc-4x4":n.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:n.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:n.has("etc1")?"etc1":n.has("etc2")?"etc2":"rgb565"}const $ve={name:"Basis",id:"basis",module:"textures",version:"3.2.13",worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}},parse:function zve(n,e){return LS.apply(this,arguments)}};function bl(n,e){if(!n)throw new Error(e||"loader assertion failed.")}typeof self<"u"&&self,typeof window<"u"&&window,typeof global<"u"&&global,typeof document<"u"&&document;const Iv=!("object"==typeof process&&"[object process]"===String(process)&&!process.browser),LH=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:Xve}=(LH&&parseFloat(LH[1]),globalThis),US=typeof Image<"u",jS=typeof ImageBitmap<"u",VS=!!Iv||!!Xve;function BH(n){const e=function jH(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&n instanceof Image?"image":n&&"object"==typeof n&&n.data&&n.width&&n.height?"data":null}(n);if(!e)throw new Error("Not an image");return e}const Kve=/^data:image\/svg\+xml/,Jve=/\.svg((\?|#).*)?$/;function HS(n){return n&&(Kve.test(n)||Jve.test(n))}function VH(n,e){if(HS(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}function HH(n,e,t){return zS.apply(this,arguments)}function zS(){return zS=j(function*(n,e,t){const r=function Qve(n,e){if(HS(e)){let r=(new TextDecoder).decode(n);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return VH(n,e)}(n,t),i=self.URL||self.webkitURL,s="string"!=typeof r&&i.createObjectURL(r);try{return yield function ebe(n,e){return GS.apply(this,arguments)}(s||r,e)}finally{s&&i.revokeObjectURL(s)}}),zS.apply(this,arguments)}function GS(){return GS=j(function*(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(yield t.decode(),t):yield new Promise((r,i)=>{try{t.onload=()=>r(t),t.onerror=s=>i(new Error("Could not load image ".concat(n,": ").concat(s)))}catch(s){i(s)}})}),GS.apply(this,arguments)}const tbe={};let zH=!0;function WS(){return WS=j(function*(n,e,t){let r;r=HS(t)?yield HH(n,e,t):VH(n,t);const i=e&&e.imagebitmap;return yield function rbe(n){return $S.apply(this,arguments)}(r,i)}),WS.apply(this,arguments)}function $S(){return $S=j(function*(n,e=null){if((function ibe(n){for(const e in n||tbe)return!1;return!0}(e)||!zH)&&(e=null),e)try{return yield createImageBitmap(n,e)}catch(t){console.warn(t),zH=!1}return yield createImageBitmap(n)}),$S.apply(this,arguments)}const uo=!1,Hp=!0;function qS(n){const e=zp(n);return function sbe(n){const e=zp(n);return e.byteLength>=24&&2303741511===e.getUint32(0,uo)?{mimeType:"image/png",width:e.getUint32(16,uo),height:e.getUint32(20,uo)}:null}(e)||function cbe(n){const e=zp(n);if(!(e.byteLength>=3&&65496===e.getUint16(0,uo)&&255===e.getUint8(2)))return null;const{tableMarkers:r,sofMarkers:i}=function lbe(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,uo);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,uo),width:e.getUint16(s+7,uo)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,uo)}return null}(e)||function obe(n){const e=zp(n);return e.byteLength>=10&&1195984440===e.getUint32(0,uo)?{mimeType:"image/gif",width:e.getUint16(6,Hp),height:e.getUint16(8,Hp)}:null}(e)||function abe(n){const e=zp(n);return e.byteLength>=14&&16973===e.getUint16(0,uo)&&e.getUint32(2,Hp)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Hp),height:e.getUint32(22,Hp)}:null}(e)}function zp(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}function XS(){return XS=j(function*(n,e){const{mimeType:t}=qS(n)||{},r=globalThis._parseImageNode;return bl(r),yield r(n,t)}),XS.apply(this,arguments)}function YS(){return YS=j(function*(n,e,t){const i=((e=e||{}).image||{}).type||"auto",{url:s}=t||{},o=function hbe(n){switch(n){case"auto":case"data":return function Zve(){if(jS)return"imagebitmap";if(US)return"image";if(VS)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function Yve(n){switch(n){case"auto":return jS||US||VS;case"imagebitmap":return jS;case"image":return US;case"data":return VS;default:throw new Error("@loaders.gl/images: image ".concat(n," not supported in this environment"))}}(n),n}}(i);let a;switch(o){case"imagebitmap":a=yield function nbe(n,e,t){return WS.apply(this,arguments)}(n,e,s);break;case"image":a=yield HH(n,e,s);break;case"data":a=yield function ube(n,e){return XS.apply(this,arguments)}(n,e);break;default:bl(!1)}return"data"===i&&(a=function UH(n){switch(BH(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}(a)),a}),YS.apply(this,arguments)}const fbe={id:"image",module:"images",name:"Images",version:"3.2.13",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function dbe(n,e,t){return YS.apply(this,arguments)},tests:[n=>!!qS(new DataView(n))],options:{image:{type:"auto",decode:!0}}};function GH(n,e,t){if(n.byteLength<=e+t)return"";const r=new DataView(n);let i="";for(let s=0;s<t;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}function WH(n,e,t){const r=void 0!==t?new Uint8Array(n).subarray(e,e+t):new Uint8Array(n).subarray(e);return new Uint8Array(r).buffer}function Ii(n,e){if(!n)throw new Error(e||"assert failed: gltf")}function $H(n,e){if(n.startsWith("data:")||n.startsWith("http:")||n.startsWith("https:"))return n;const r=e.baseUri||e.uri;if(!r)throw new Error("'baseUri' must be provided to resolve relative url ".concat(n));return r.substr(0,r.lastIndexOf("/")+1)+n}function Gp(n,e){return bl(n>=0),bl(e>0),n+(e-1)&~(e-1)}function mbe(n,e,t){let r;return r=n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer||n.arrayBuffer,n.byteOffset,n.byteLength),e.set(r,t),t+Gp(r.byteLength,4)}const XH=["SCALAR","VEC2","VEC3","VEC4"],_be=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],ybe=new Map(_be),vbe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},bbe={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},wbe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function YH(n){return XH[n-1]||XH[0]}function ZH(n){const e=ybe.get(n.constructor);if(!e)throw new Error("Illegal typed array");return e}function KH(n,e){const t=wbe[n.componentType],r=vbe[n.type],s=n.count*r,o=n.count*r*bbe[n.componentType];return Ii(o>=0&&o<=e.byteLength),{ArrayType:t,length:s,byteLength:o}}const Ebe={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class qi{constructor(e){w(this,"gltf",void 0),w(this,"sourceBuffers",void 0),w(this,"byteLength",void 0),this.gltf=e||{json:{...Ebe},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){return this.getUsedExtensions().find(i=>i===e)?(this.json.extensions||{})[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(r=>r===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if("object"==typeof t)return t;const r=this.json[e]&&this.json[e][t];if(!r)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(t,"]"));return r}getTypedArrayForBufferView(e){e=this.getBufferView(e);const r=this.gltf.buffers[e.buffer];return Ii(r),new Uint8Array(r.arrayBuffer,(e.byteOffset||0)+r.byteOffset,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),i=this.getBuffer(t.buffer).data,{ArrayType:s,length:o}=KH(e,t);return new s(i,t.byteOffset+e.byteOffset,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),i=this.getBuffer(t.buffer).data;return new Uint8Array(i,t.byteOffset||0,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,r){return e.extensions=e.extensions||{},e.extensions[t]=r,this.registerUsedExtension(t),this}setObjectExtension(e,t,r){(e.extensions||{})[t]=r}removeObjectExtension(e,t){const r=e.extensions||{},i=r[t];return delete r[t],i}addExtension(e,t={}){return Ii(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e,t={}){return Ii(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(t=>t===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(t=>t===e)||this.json.extensionsRequired.push(e)}removeExtension(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:r}=e;this.json.nodes=this.json.nodes||[];const i={mesh:t};return r&&(i.matrix=r),this.json.nodes.push(i),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:r,material:i,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(r){const c=this._addIndices(r);a.primitives[0].indices=c}return Number.isFinite(i)&&(a.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const r={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(r),this.json.meshes.length-1}addImage(e,t){const r=qS(e),i=t||r?.mimeType,o={bufferView:this.addBufferView(e),mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const t=e.byteLength;Ii(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const r={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=Gp(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(r),this.json.bufferViews.length-1}addAccessor(e,t){const r={bufferView:e,type:YH(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(r),this.json.accessors.length-1}addBinaryBuffer(e,t={size:3}){const r=this.addBufferView(e);let i={min:t.min,max:t.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(e,t.size));const s={size:t.size,componentType:ZH(e),count:Math.round(e.length/t.size),min:i.min,max:i.max};return this.addAccessor(r,Object.assign(s,t))}addTexture(e){const{imageIndex:t}=e,r={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(r),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;this.gltf.buffers=[];const r=this.byteLength,i=new ArrayBuffer(r),s=new Uint8Array(i);let o=0;for(const a of this.sourceBuffers||[])o=mbe(a,s,o);null!==(e=this.json)&&void 0!==e&&null!==(t=e.buffers)&&void 0!==t&&t[0]?this.json.buffers[0].byteLength=r:this.json.buffers=[{byteLength:r}],this.gltf.binary=i,this.sourceBuffers=[i]}_removeStringFromArray(e,t){let r=!0;for(;r;){const i=e.indexOf(t);i>-1?e.splice(i,1):r=!1}}_addAttributes(e={}){const t={};for(const r in e){const i=e[r],s=this._getGltfAttributeName(r),o=this.addBinaryBuffer(i.value,i);t[s]=o}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const r={min:null,max:null};if(e.length<t)return r;r.min=[],r.max=[];const i=e.subarray(0,t);for(const s of i)r.min.push(s),r.max.push(s);for(let s=t;s<e.length;s+=t)for(let o=0;o<t;o++)r.min[0+o]=Math.min(r.min[0+o],e[s+o]),r.max[0+o]=Math.max(r.max[0+o],e[s+o]);return r}}const xbe=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),Sbe=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),JH={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Ibe={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};function QS(){return QS=j(function*(n,e,t,r,i,s="NONE"){const o=yield function Mv(){return tI.apply(this,arguments)}();!function Dv(n,e,t,r,i,s,o){const a=n.exports.sbrk,c=r+3&-4,l=a(c*i),u=a(s.length),d=new Uint8Array(n.exports.memory.buffer);d.set(s,u);const h=e(l,r,i,u,s.length);if(0===h&&o&&o(l,c,i),t.set(d.subarray(l,l+r*i)),a(l-a(0)),0!==h)throw new Error("Malformed buffer data: ".concat(h))}(o,o.exports[Ibe[i]],n,e,t,r,o.exports[JH[s||"NONE"]])}),QS.apply(this,arguments)}let eI;function tI(){return tI=j(function*(){return eI||(eI=function Dbe(){return nI.apply(this,arguments)}()),eI}),tI.apply(this,arguments)}function nI(){return nI=j(function*(){let n="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB";WebAssembly.validate(xbe)&&(n="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",console.log("Warning: meshopt_decoder is using experimental SIMD support"));const e=yield WebAssembly.instantiate(function Rbe(n){const e=new Uint8Array(n.length);for(let r=0;r<n.length;++r){const i=n.charCodeAt(r);e[r]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let t=0;for(let r=0;r<n.length;++r)e[t++]=e[r]<60?Sbe[e[r]]:64*(e[r]-60)+e[++r];return e.buffer.slice(0,t)}(n),{});return yield e.instance.exports.__wasm_call_ctors(),e.instance}),nI.apply(this,arguments)}const rI="EXT_meshopt_compression",Obe=rI;function Pbe(n,e){return iI.apply(this,arguments)}function iI(){return iI=j(function*(n,e){var t;const r=new qi(n);if(null==e||null===(t=e.gltf)||void 0===t||!t.decompressMeshes)return;const i=[];for(const s of n.json.bufferViews||[])i.push(Nbe(r,s));yield Promise.all(i),r.removeExtension(rI)}),iI.apply(this,arguments)}function Nbe(n,e){return sI.apply(this,arguments)}function sI(){return sI=j(function*(n,e){const t=n.getObjectExtension(e,rI);if(t){const{byteOffset:r=0,byteLength:i=0,byteStride:s,count:o,mode:a,filter:c="NONE",buffer:l}=t,u=n.gltf.buffers[l],d=new Uint8Array(u.arrayBuffer,u.byteOffset+r,i),h=new Uint8Array(n.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);return yield function Mbe(n,e,t,r,i){return QS.apply(this,arguments)}(h,o,s,d,a,c),h}return null}),sI.apply(this,arguments)}const kbe=["image/png","image/jpeg","image/gif"],oI={};const Vd="EXT_texture_webp",Ube=Vd;function jbe(n,e){const t=new qi(n);if(!function Fbe(n){return void 0===oI[n]&&(oI[n]=function Lbe(n){switch(n){case"image/webp":return function Bbe(){if(!Iv)return!1;try{return 0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")}catch{return!1}}();case"image/svg":return Iv;default:if(!Iv){const{_parseImageNode:e}=globalThis;return!!e&&kbe.includes(n)}return!0}}(n)),oI[n]}("image/webp")){if(t.getRequiredExtensions().includes(Vd))throw new Error("gltf: Required extension ".concat(Vd," not supported by browser"));return}const{json:r}=t;for(const i of r.textures||[]){const s=t.getObjectExtension(i,Vd);s&&(i.source=s.source),t.removeObjectExtension(i,Vd)}t.removeExtension(Vd)}const Rv="KHR_texture_basisu",Vbe=Rv;function Hbe(n,e){const t=new qi(n),{json:r}=t;for(const i of r.textures||[]){const s=t.getObjectExtension(i,Rv);s&&(i.source=s.source),t.removeObjectExtension(i,Rv)}t.removeExtension(Rv)}const ez={name:"Draco",id:"draco",module:"draco",shapes:["mesh"],version:"3.2.13",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};class Ov{constructor(e,t,r=!1,i=new Map){w(this,"name",void 0),w(this,"type",void 0),w(this,"nullable",void 0),w(this,"metadata",void 0),this.name=e,this.type=t,this.nullable=r,this.metadata=i}get typeId(){return this.type&&this.type.typeId}clone(){return new Ov(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let ct,tz,nz,rz,iz,sz,oz,az,cz;!function(n){n[n.NONE=0]="NONE",n[n.Null=1]="Null",n[n.Int=2]="Int",n[n.Float=3]="Float",n[n.Binary=4]="Binary",n[n.Utf8=5]="Utf8",n[n.Bool=6]="Bool",n[n.Decimal=7]="Decimal",n[n.Date=8]="Date",n[n.Time=9]="Time",n[n.Timestamp=10]="Timestamp",n[n.Interval=11]="Interval",n[n.List=12]="List",n[n.Struct=13]="Struct",n[n.Union=14]="Union",n[n.FixedSizeBinary=15]="FixedSizeBinary",n[n.FixedSizeList=16]="FixedSizeList",n[n.Map=17]="Map",n[n.Dictionary=-1]="Dictionary",n[n.Int8=-2]="Int8",n[n.Int16=-3]="Int16",n[n.Int32=-4]="Int32",n[n.Int64=-5]="Int64",n[n.Uint8=-6]="Uint8",n[n.Uint16=-7]="Uint16",n[n.Uint32=-8]="Uint32",n[n.Uint64=-9]="Uint64",n[n.Float16=-10]="Float16",n[n.Float32=-11]="Float32",n[n.Float64=-12]="Float64",n[n.DateDay=-13]="DateDay",n[n.DateMillisecond=-14]="DateMillisecond",n[n.TimestampSecond=-15]="TimestampSecond",n[n.TimestampMillisecond=-16]="TimestampMillisecond",n[n.TimestampMicrosecond=-17]="TimestampMicrosecond",n[n.TimestampNanosecond=-18]="TimestampNanosecond",n[n.TimeSecond=-19]="TimeSecond",n[n.TimeMillisecond=-20]="TimeMillisecond",n[n.TimeMicrosecond=-21]="TimeMicrosecond",n[n.TimeNanosecond=-22]="TimeNanosecond",n[n.DenseUnion=-23]="DenseUnion",n[n.SparseUnion=-24]="SparseUnion",n[n.IntervalDayTime=-25]="IntervalDayTime",n[n.IntervalYearMonth=-26]="IntervalYearMonth"}(ct||(ct={}));class Xi{static isNull(e){return e&&e.typeId===ct.Null}static isInt(e){return e&&e.typeId===ct.Int}static isFloat(e){return e&&e.typeId===ct.Float}static isBinary(e){return e&&e.typeId===ct.Binary}static isUtf8(e){return e&&e.typeId===ct.Utf8}static isBool(e){return e&&e.typeId===ct.Bool}static isDecimal(e){return e&&e.typeId===ct.Decimal}static isDate(e){return e&&e.typeId===ct.Date}static isTime(e){return e&&e.typeId===ct.Time}static isTimestamp(e){return e&&e.typeId===ct.Timestamp}static isInterval(e){return e&&e.typeId===ct.Interval}static isList(e){return e&&e.typeId===ct.List}static isStruct(e){return e&&e.typeId===ct.Struct}static isUnion(e){return e&&e.typeId===ct.Union}static isFixedSizeBinary(e){return e&&e.typeId===ct.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===ct.FixedSizeList}static isMap(e){return e&&e.typeId===ct.Map}static isDictionary(e){return e&&e.typeId===ct.Dictionary}get typeId(){return ct.NONE}compareTo(e){return this===e}}Symbol,Symbol,tz=Symbol.toStringTag;class hc extends Xi{constructor(e,t){super(),w(this,"isSigned",void 0),w(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=t}get typeId(){return ct.Int}get[tz](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class Gbe extends hc{constructor(){super(!0,8)}}class Wbe extends hc{constructor(){super(!0,16)}}class $be extends hc{constructor(){super(!0,32)}}class qbe extends hc{constructor(){super(!1,8)}}class Xbe extends hc{constructor(){super(!1,16)}}class Ybe extends hc{constructor(){super(!1,32)}}nz=Symbol.toStringTag;class cI extends Xi{constructor(e){super(),w(this,"precision",void 0),this.precision=e}get typeId(){return ct.Float}get[nz](){return"Float"}toString(){return"Float".concat(this.precision)}}class Zbe extends cI{constructor(){super(32)}}class Kbe extends cI{constructor(){super(64)}}Symbol,Symbol,rz=Symbol.toStringTag,iz=Symbol.toStringTag,sz=Symbol.toStringTag,oz=Symbol.toStringTag,az=Symbol.toStringTag;class Jbe extends Xi{constructor(e,t){super(),w(this,"listSize",void 0),w(this,"children",void 0),this.listSize=e,this.children=[t]}get typeId(){return ct.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[az](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}cz=Symbol.toStringTag;class Hd{constructor(e,t){w(this,"fields",void 0),w(this,"metadata",void 0),function n0e(n,e){if(!n)throw new Error(e||"loader assertion failed.")}(Array.isArray(e)),function r0e(n){const e={};for(const t of n)e[t.name]&&console.warn("Schema: duplicated field name",t.name,t),e[t.name]=!0}(e),this.fields=e,this.metadata=t||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let t=0;t<this.fields.length;++t)if(!this.fields[t].compareTo(e.fields[t]))return!1;return!0}select(...e){const t=Object.create(null);for(const i of e)t[i]=!0;const r=this.fields.filter(i=>t[i.name]);return new Hd(r,this.metadata)}selectAt(...e){const t=e.map(r=>this.fields[r]).filter(Boolean);return new Hd(t,this.metadata)}assign(e){let t,r=this.metadata;if(e instanceof Hd){const o=e;t=o.fields,r=fz(fz(new Map,this.metadata),o.metadata)}else t=e;const i=Object.create(null);for(const o of this.fields)i[o.name]=o;for(const o of t)i[o.name]=o;const s=Object.values(i);return new Hd(s,r)}}function fz(n,e){return new Map([...n||new Map,...e||new Map])}function pz(n,e,t){return function hz(n,e,t){const r=function Qbe(n){switch(n.constructor){case Int8Array:return new Gbe;case Uint8Array:return new qbe;case Int16Array:return new Wbe;case Uint16Array:return new Xbe;case Int32Array:return new $be;case Uint32Array:return new Ybe;case Float32Array:return new Zbe;case Float64Array:return new Kbe;default:throw new Error("array type not supported")}}(e.value),i=t||function t0e(n){const e=new Map;return"byteOffset"in n&&e.set("byteOffset",n.byteOffset.toString(10)),"byteStride"in n&&e.set("byteStride",n.byteStride.toString(10)),"normalized"in n&&e.set("normalized",n.normalized.toString()),e}(e);return new Ov(n,new Jbe(e.size,new Ov("value",r)),!1,i)}(n,e,t?gz(t.metadata):void 0)}function gz(n){const e=new Map;for(const t in n)e.set("".concat(t,".string"),JSON.stringify(n[t]));return e}const mz={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},o0e={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class c0e{constructor(e){w(this,"draco",void 0),w(this,"decoder",void 0),w(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,t={}){const r=new this.draco.DecoderBuffer;r.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const i=this.decoder.GetEncodedGeometryType(r),s=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(i){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(r,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(r,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const h="DRACO decompression failed: ".concat(o.error_msg());throw new Error(h)}const a=this._getDracoLoaderData(s,i,t),c=this._getMeshData(s,a,t),l=function zbe(n){let e=1/0,t=1/0,r=1/0,i=-1/0,s=-1/0,o=-1/0;const a=n.POSITION?n.POSITION.value:[],c=a&&a.length;for(let l=0;l<c;l+=3){const u=a[l],d=a[l+1],h=a[l+2];e=u<e?u:e,t=d<t?d:t,r=h<r?h:r,i=u>i?u:i,s=d>s?d:s,o=h>o?h:o}return[[e,t,r],[i,s,o]]}(c.attributes),u=function i0e(n,e,t){const r=gz(e.metadata),i=[],s=function s0e(n){const e={};for(const t in n){const r=n[t];e[r.name||"undefined"]=r}return e}(e.attributes);for(const o in n){const c=pz(o,n[o],s[o]);i.push(c)}if(t){const o=pz("indices",t);i.push(o)}return new Hd(i,r)}(c.attributes,a,c.indices);return{loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:l},...c,schema:u}}finally{this.draco.destroy(r),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,t,r){const i=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,r);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:i,attributes:s}}_getDracoAttributes(e,t){const r={};for(let i=0;i<e.num_attributes();i++){const s=this.decoder.GetAttribute(e,i),o=this._getAttributeMetadata(e,i);r[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:i,metadata:o};const a=this._getQuantizationTransform(s,t);a&&(r[s.unique_id()].quantization_transform=a);const c=this._getOctahedronTransform(s,t);c&&(r[s.unique_id()].octahedron_transform=c)}return r}_getMeshData(e,t,r){const i=this._getMeshAttributes(t,e,r);if(!i.POSITION)throw new Error("DRACO: No position attribute found.");return e instanceof this.draco.Mesh?"triangle-strip"===r.topology?{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(e),size:1}}:{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(e),size:1}}:{topology:"point-list",mode:0,attributes:i}}_getMeshAttributes(e,t,r){const i={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,r);s.name=o;const{value:a,size:c}=this._getAttributeValues(t,s);i[o]={value:a,size:c,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return i}_getTriangleListIndices(e){const r=3*e.num_faces(),i=4*r,s=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(e,i,s),new Uint32Array(this.draco.HEAPF32.buffer,s,r).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),function d0e(n){const e=n.size(),t=new Int32Array(e);for(let r=0;r<e;r++)t[r]=n.GetValue(r);return t}(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const r=o0e[t.data_type],i=t.num_components,o=e.num_points()*i,a=o*r.BYTES_PER_ELEMENT,c=function l0e(n,e){switch(e){case Float32Array:return n.DT_FLOAT32;case Int8Array:return n.DT_INT8;case Int16Array:return n.DT_INT16;case Int32Array:return n.DT_INT32;case Uint8Array:return n.DT_UINT8;case Uint16Array:return n.DT_UINT16;case Uint32Array:return n.DT_UINT32;default:return n.DT_INVALID}}(this.draco,r);let l;const u=this.draco._malloc(a);try{const d=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,d,c,a,u),l=new r(this.draco.HEAPF32.buffer,u,o).slice()}finally{this.draco._free(u)}return{value:l,size:i}}_deduceAttributeName(e,t){const r=e.unique_id;for(const[o,a]of Object.entries(t.extraAttributes||{}))if(a===r)return o;const i=e.attribute_type;for(const o in mz)if(this.draco[o]===i)return mz[o];const s=t.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:"CUSTOM_ATTRIBUTE_".concat(r)}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const r=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(r)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},r=this.metadataQuerier.NumEntries(e);for(let i=0;i<r;i++){const s=this.metadataQuerier.GetEntryName(e,i);t[s]=this._getDracoMetadataField(e,s)}return t}_getDracoMetadataField(e,t){const r=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,r);const i=function u0e(n){const e=n.size(),t=new Int32Array(e);for(let r=0;r<e;r++)t[r]=n.GetValue(r);return t}(r);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:i}}finally{this.draco.destroy(r)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:r=[]}=e,i=[...t,...r];for(const s of i)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,t){const{quantizedAttributes:r=[]}=t,i=e.attribute_type();if(r.map(o=>this.decoder[o]).includes(i)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:r=[]}=t,i=e.attribute_type();if(r.map(o=>this.decoder[o]).includes(i)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}const Nv="1.4.1",h0e="https://www.gstatic.com/draco/versioned/decoders/".concat(Nv,"/draco_decoder.js"),f0e="https://www.gstatic.com/draco/versioned/decoders/".concat(Nv,"/draco_wasm_wrapper.js"),p0e="https://www.gstatic.com/draco/versioned/decoders/".concat(Nv,"/draco_decoder.wasm");let Wp;function dI(){return dI=j(function*(n){const e=n.modules||{};return Wp=e.draco3d?Wp||e.draco3d.createDecoderModule({}).then(t=>({draco:t})):Wp||function _0e(n){return fI.apply(this,arguments)}(n),yield Wp}),dI.apply(this,arguments)}function fI(){return fI=j(function*(n){let e,t;return"js"===(n.draco&&n.draco.decoderType)?e=yield vl(h0e,"draco",n):[e,t]=yield Promise.all([yield vl(f0e,"draco",n),yield vl(p0e,"draco",n)]),e=e||globalThis.DracoDecoderModule,yield function y0e(n,e){const t={};return e&&(t.wasmBinary=e),new Promise(r=>{n({...t,onModuleLoaded:i=>r({draco:i})})})}(e,t)}),fI.apply(this,arguments)}"https://raw.githubusercontent.com/google/draco/".concat(Nv,"/javascript/draco_encoder.js");const gI={...ez,parse:function b0e(n,e){return mI.apply(this,arguments)}};function mI(){return mI=j(function*(n,e){const{draco:t}=yield function m0e(n){return dI.apply(this,arguments)}(e),r=new c0e(t);try{return r.parseSync(n,e?.draco)}finally{r.destroy()}}),mI.apply(this,arguments)}function _z(n){const{buffer:e,size:t,count:r}=function E0e(n){let e=n,t=1,r=0;return n&&n.value&&(e=n.value,t=n.size||1),e&&(ArrayBuffer.isView(e)||(e=function C0e(n,e,t=!1){return n?Array.isArray(n)?new e(n):!t||n instanceof e?n:new e(n):null}(e,Float32Array)),r=e.length/t),{buffer:e,size:t,count:r}}(n);return{value:e,size:t,byteOffset:0,count:r,type:YH(t),componentType:ZH(e)}}const wl="KHR_draco_mesh_compression",A0e=wl;function T0e(n,e,t){const r=new qi(n);for(const i of yz(r))r.getObjectExtension(i,wl)}function x0e(n,e,t){return _I.apply(this,arguments)}function _I(){return _I=j(function*(n,e,t){var r;if(null==e||null===(r=e.gltf)||void 0===r||!r.decompressMeshes)return;const i=new qi(n),s=[];for(const o of yz(i))i.getObjectExtension(o,wl)&&s.push(I0e(i,o,e,t));yield Promise.all(s),i.removeExtension(wl)}),_I.apply(this,arguments)}function S0e(n,e={}){const t=new qi(n);for(const r of t.json.meshes||[])M0e(r),t.addRequiredExtension(wl)}function I0e(n,e,t,r){return yI.apply(this,arguments)}function yI(){return yI=j(function*(n,e,t,r){const i=n.getObjectExtension(e,wl);if(!i)return;const s=n.getTypedArrayForBufferView(i.bufferView),o=WH(s.buffer,s.byteOffset),{parse:a}=r,c={...t};delete c["3d-tiles"];const l=yield a(o,gI,c,r),u=function w0e(n){const e={};for(const t in n)if("indices"!==t){const i=_z(n[t]);e[t]=i}return e}(l.attributes);for(const[d,h]of Object.entries(u))if(d in e.attributes){const p=n.getAccessor(e.attributes[d]);null!=p&&p.min&&null!=p&&p.max&&(h.min=p.min,h.max=p.max)}e.attributes=u,l.indices&&(e.indices=_z(l.indices)),function D0e(n){if(!n.attributes&&Object.keys(n.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}(e)}),yI.apply(this,arguments)}function M0e(n,e,t=4,r,i){var s;if(!r.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=r.DracoWriter.encodeSync({attributes:n}),a=null==i||null===(s=i.parseSync)||void 0===s?void 0:s.call(i,{attributes:n}),c=r._addFauxAttributes(a.attributes),l=r.addBufferView(o);return{primitives:[{attributes:c,mode:t,extensions:{[wl]:{bufferView:l,attributes:c}}}]}}function*yz(n){for(const e of n.json.meshes||[])for(const t of e.primitives)yield t}const El="KHR_lights_punctual",R0e=El;function O0e(n){return vI.apply(this,arguments)}function vI(){return vI=j(function*(n){const e=new qi(n),{json:t}=e,r=e.getExtension(El);r&&(e.json.lights=r.lights,e.removeExtension(El));for(const i of t.nodes||[]){const s=e.getObjectExtension(i,El);s&&(i.light=s.light),e.removeObjectExtension(i,El)}}),vI.apply(this,arguments)}function P0e(n){return bI.apply(this,arguments)}function bI(){return bI=j(function*(n){const e=new qi(n),{json:t}=e;if(t.lights){const r=e.addExtension(El);Ii(!r.lights),r.lights=t.lights,delete t.lights}if(e.json.lights){for(const r of e.json.lights)e.addObjectExtension(r.node,El,r);delete e.json.lights}}),bI.apply(this,arguments)}const qp="KHR_materials_unlit",N0e=qp;function k0e(n){return wI.apply(this,arguments)}function wI(){return wI=j(function*(n){const e=new qi(n),{json:t}=e;e.removeExtension(qp);for(const r of t.materials||[])r.extensions&&r.extensions.KHR_materials_unlit&&(r.unlit=!0),e.removeObjectExtension(r,qp)}),wI.apply(this,arguments)}function F0e(n){const e=new qi(n),{json:t}=e;if(e.materials)for(const r of t.materials||[])r.unlit&&(delete r.unlit,e.addObjectExtension(r,qp,{}),e.addExtension(qp))}const Xp="KHR_techniques_webgl",L0e=Xp;function B0e(n){return EI.apply(this,arguments)}function EI(){return EI=j(function*(n){const e=new qi(n),{json:t}=e,r=e.getExtension(Xp);if(r){const i=function j0e(n,e){const{programs:t=[],shaders:r=[],techniques:i=[]}=n,s=new TextDecoder;return r.forEach(o=>{if(!Number.isFinite(o.bufferView))throw new Error("KHR_techniques_webgl: no shader code");o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView))}),t.forEach(o=>{o.fragmentShader=r[o.fragmentShader],o.vertexShader=r[o.vertexShader]}),i.forEach(o=>{o.program=t[o.program]}),i}(r,e);for(const s of t.materials||[]){const o=e.getObjectExtension(s,Xp);o&&(s.technique=Object.assign({},o,i[o.technique]),s.technique.values=V0e(s.technique,e)),e.removeObjectExtension(s,Xp)}e.removeExtension(Xp)}}),EI.apply(this,arguments)}function U0e(n,e){return CI.apply(this,arguments)}function CI(){return(CI=j(function*(n,e){})).apply(this,arguments)}function V0e(n,e){const t=Object.assign({},n.values);return Object.keys(n.uniforms||{}).forEach(r=>{n.uniforms[r].value&&!(r in t)&&(t[r]=n.uniforms[r].value)}),Object.keys(t).forEach(r=>{"object"==typeof t[r]&&void 0!==t[r].index&&(t[r].texture=e.getTexture(t[r].index))}),t}const vz=[yn,kt,rn,zn,_e,ut,xe];function AI(){return AI=j(function*(n,e={},t){const r=vz.filter(s=>bz(s.name,e));for(const s of r){var i;yield null===(i=s.decode)||void 0===i?void 0:i.call(s,n,e,t)}}),AI.apply(this,arguments)}function bz(n,e){var t;const r=(null==e||null===(t=e.gltf)||void 0===t?void 0:t.excludeExtensions)||{};return!(n in r&&!r[n])}const TI="KHR_binary_glTF",wz={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},W0e={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class $0e{constructor(){w(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),w(this,"json",void 0)}normalize(e,t){this.json=e.json;const r=e.json;switch(r.asset&&r.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn("glTF: Unknown version ".concat(r.asset.version))}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(r),this._convertTopLevelObjectsToArrays(r),function G0e(n){const e=new qi(n),{json:t}=e;for(const r of t.images||[]){const i=e.getObjectExtension(r,TI);i&&Object.assign(r,i),e.removeObjectExtension(r,TI)}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,e.removeExtension(TI)}(e),this._convertObjectIdsToArrayIndices(r),this._updateObjects(r),this._updateMaterial(r)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in wz)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const r=e[t];if(r&&!Array.isArray(r)){e[t]=[];for(const i in r){const s=r[i];s.id=s.id||i;const o=e[t].length;e[t].push(s),this.idToIndexMap[t][i]=o}}}_convertObjectIdsToArrayIndices(e){for(const t in wz)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:r,indices:i,material:s}=t;for(const o in r)r[o]=this._convertIdToIndex(r[o],"accessor");i&&(t.indices=this._convertIdToIndex(i,"accessor")),s&&(t.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(t=>this._convertIdToIndex(t,"node"))),e.meshes&&(e.meshes=e.meshes.map(t=>this._convertIdToIndex(t,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(e,t){e[t]||(console.warn("gltf v1: json doesn't contain attribute ".concat(t)),e[t]=[]);for(const r of e[t])for(const i in r){const o=this._convertIdToIndex(r[i],i);r[i]=o}}_convertIdToIndex(e,t){const r=W0e[t];if(r in this.idToIndexMap){const i=this.idToIndexMap[r][e];if(!Number.isFinite(i))throw new Error("gltf v1: failed to resolve ".concat(t," with id ").concat(e));return i}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){for(const s of e.materials){var t,r,i;s.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const o=(null===(t=s.values)||void 0===t?void 0:t.tex)||(null===(r=s.values)||void 0===r?void 0:r.texture2d_0)||(null===(i=s.values)||void 0===i?void 0:i.diffuseTex),a=e.textures.findIndex(c=>c.id===o);-1!==a&&(s.pbrMetallicRoughness.baseColorTexture={index:a})}}}const X0e={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Y0e={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Yi_TEXTURE_MAG_FILTER=10240,Yi_TEXTURE_MIN_FILTER=10241,Yi_TEXTURE_WRAP_S=10242,Yi_TEXTURE_WRAP_T=10243,Z0e={magFilter:10240,minFilter:10241,wrapS:10242,wrapT:10243},K0e={[Yi_TEXTURE_MAG_FILTER]:9729,[Yi_TEXTURE_MIN_FILTER]:9986,[Yi_TEXTURE_WRAP_S]:10497,[Yi_TEXTURE_WRAP_T]:10497};class ewe{constructor(){w(this,"baseUri",""),w(this,"json",{}),w(this,"buffers",[]),w(this,"images",[])}postProcess(e,t={}){const{json:r,buffers:i=[],images:s=[],baseUri:o=""}=e;return Ii(r),this.baseUri=o,this.json=r,this.buffers=i,this.images=s,this._resolveTree(this.json,t),this.json}_resolveTree(e,t={}){e.bufferViews&&(e.bufferViews=e.bufferViews.map((r,i)=>this._resolveBufferView(r,i))),e.images&&(e.images=e.images.map((r,i)=>this._resolveImage(r,i))),e.samplers&&(e.samplers=e.samplers.map((r,i)=>this._resolveSampler(r,i))),e.textures&&(e.textures=e.textures.map((r,i)=>this._resolveTexture(r,i))),e.accessors&&(e.accessors=e.accessors.map((r,i)=>this._resolveAccessor(r,i))),e.materials&&(e.materials=e.materials.map((r,i)=>this._resolveMaterial(r,i))),e.meshes&&(e.meshes=e.meshes.map((r,i)=>this._resolveMesh(r,i))),e.nodes&&(e.nodes=e.nodes.map((r,i)=>this._resolveNode(r,i))),e.skins&&(e.skins=e.skins.map((r,i)=>this._resolveSkin(r,i))),e.scenes&&(e.scenes=e.scenes.map((r,i)=>this._resolveScene(r,i))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,t){if("object"==typeof t)return t;const r=this.json[e]&&this.json[e][t];return r||console.warn("glTF file error: Could not find ".concat(e,"[").concat(t,"]")),r}_resolveScene(e,t){return e.id=e.id||"scene-".concat(t),e.nodes=(e.nodes||[]).map(r=>this.getNode(r)),e}_resolveNode(e,t){return e.id=e.id||"node-".concat(t),e.children&&(e.children=e.children.map(r=>this.getNode(r))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((r,i)=>{const s=this.getMesh(i);return r.id=s.id,r.primitives=r.primitives.concat(s.primitives),r},{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,t){return e.id=e.id||"skin-".concat(t),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,t){return e.id=e.id||"mesh-".concat(t),e.primitives&&(e.primitives=e.primitives.map(r=>{const i=(r={...r}).attributes;r.attributes={};for(const s in i)r.attributes[s]=this.getAccessor(i[s]);return void 0!==r.indices&&(r.indices=this.getAccessor(r.indices)),void 0!==r.material&&(r.material=this.getMaterial(r.material)),r})),e}_resolveMaterial(e,t){if(e.id=e.id||"material-".concat(t),e.normalTexture&&(e.normalTexture={...e.normalTexture},e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture={...e.occlustionTexture},e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture={...e.emmisiveTexture},e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness={...e.pbrMetallicRoughness};const r=e.pbrMetallicRoughness;r.baseColorTexture&&(r.baseColorTexture={...r.baseColorTexture},r.baseColorTexture.texture=this.getTexture(r.baseColorTexture.index)),r.metallicRoughnessTexture&&(r.metallicRoughnessTexture={...r.metallicRoughnessTexture},r.metallicRoughnessTexture.texture=this.getTexture(r.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,t){if(e.id=e.id||"accessor-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=function J0e(n){return Y0e[n]}(e.componentType),e.components=function Q0e(n){return X0e[n]}(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const r=e.bufferView.buffer,{ArrayType:i,byteLength:s}=KH(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+r.byteOffset;let a=r.arrayBuffer.slice(o,o+s);e.bufferView.byteStride&&(a=this._getValueFromInterleavedBuffer(r,o,e.bufferView.byteStride,e.bytesPerElement,e.count)),e.value=new i(a)}return e}_getValueFromInterleavedBuffer(e,t,r,i,s){const o=new Uint8Array(s*i);for(let a=0;a<s;a++){const c=t+a*r;o.set(new Uint8Array(e.arrayBuffer.slice(c,c+i)),a*i)}return o.buffer}_resolveTexture(e,t){return e.id=e.id||"texture-".concat(t),e.sampler="sampler"in e?this.getSampler(e.sampler):K0e,e.source=this.getImage(e.source),e}_resolveSampler(e,t){e.id=e.id||"sampler-".concat(t),e.parameters={};for(const r in e){const i=this._enumSamplerParameter(r);void 0!==i&&(e.parameters[i]=e[r])}return e}_enumSamplerParameter(e){return Z0e[e]}_resolveImage(e,t){e.id=e.id||"image-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));const r=this.images[t];return r&&(e.image=r),e}_resolveBufferView(e,t){const r=e.buffer,i={id:"bufferView-".concat(t),...e,buffer:this.buffers[r]};let o=this.buffers[r].byteOffset||0;return"byteOffset"in e&&(o+=e.byteOffset),i.data=new Uint8Array(this.buffers[r].arrayBuffer,o,e.byteLength),i}_resolveCamera(e,t){return e.id=e.id||"camera-".concat(t),e}}const Ez=1735152710,zd=!0;function SI(n,e,t,r){const i=new Uint8Array(e.buffer,t,r),o=new TextDecoder("utf8").decode(i);return n.json=JSON.parse(o),Gp(r,4)}function II(n,e,t,r){return n.header.hasBinChunk=!0,n.binChunks.push({byteOffset:t,byteLength:r,arrayBuffer:e.buffer}),Gp(r,4)}function MI(){return MI=j(function*(n,e,t=0,r,i){var s,o,a,c;(function pwe(n,e,t,r){if(r.uri&&(n.baseUri=r.uri),e instanceof ArrayBuffer&&!function cwe(n,e=0,t={}){const r=new DataView(n),{magic:i=Ez}=t,s=r.getUint32(e,!1);return s===i||s===Ez}(e,t,r)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)n.json=function gbe(n){try{return JSON.parse(n)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(function pbe(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?GH(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?GH(n,0,e):""}(n),'"'))}}(e);else if(e instanceof ArrayBuffer){const o={};t=function lwe(n,e,t=0,r={}){const i=new DataView(e),s=function awe(n,e=0){return"".concat(String.fromCharCode(n.getUint8(e+0))).concat(String.fromCharCode(n.getUint8(e+1))).concat(String.fromCharCode(n.getUint8(e+2))).concat(String.fromCharCode(n.getUint8(e+3)))}(i,t+0),o=i.getUint32(t+4,zd),a=i.getUint32(t+8,zd);switch(Object.assign(n,{header:{byteOffset:t,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),t+=12,n.version){case 1:return function uwe(n,e,t){bl(n.header.byteLength>20);const r=e.getUint32(t+0,zd),i=e.getUint32(t+4,zd);return t+=8,bl(0===i),SI(n,e,t,r),(t+=r)+II(n,e,t,n.header.byteLength)}(n,i,t);case 2:return function dwe(n,e,t,r){return bl(n.header.byteLength>20),function hwe(n,e,t,r){for(;t+8<=n.header.byteLength;){const i=e.getUint32(t+0,zd),s=e.getUint32(t+4,zd);switch(t+=8,s){case 1313821514:SI(n,e,t,i);break;case 5130562:II(n,e,t,i);break;case 0:r.strict||SI(n,e,t,i);break;case 1:r.strict||II(n,e,t,i)}t+=Gp(i,4)}}(n,e,t,r),t+n.header.byteLength}(n,i,t,{});default:throw new Error("Invalid GLB version ".concat(n.version,". Only supports v1 and v2."))}}(o,e,t,r.glb),Ii("glTF"===o.type,"Invalid GLB magic string ".concat(o.type)),n._glb=o,n.json=o.json}else Ii(!1,"GLTF: must be ArrayBuffer or string");if(n.buffers=new Array((n.json.buffers||[]).length).fill(null),n._glb&&n._glb.header.hasBinChunk){const{binChunks:o}=n._glb;n.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}n.images=new Array((n.json.images||[]).length).fill({})})(n,e,t,r),function q0e(n,e={}){(new $0e).normalize(n,e)}(n,{normalize:null==r||null===(s=r.gltf)||void 0===s?void 0:s.normalize}),function H0e(n,e={},t){const r=vz.filter(s=>bz(s.name,e));for(const s of r){var i;null===(i=s.preprocess)||void 0===i||i.call(s,n,e,t)}}(n,r,i);const l=[];if(null!=r&&null!==(o=r.gltf)&&void 0!==o&&o.loadBuffers&&n.json.buffers&&(yield function gwe(n,e,t){return DI.apply(this,arguments)}(n,r,i)),null!=r&&null!==(a=r.gltf)&&void 0!==a&&a.loadImages){const d=function mwe(n,e,t){return RI.apply(this,arguments)}(n,r,i);l.push(d)}const u=function z0e(n){return AI.apply(this,arguments)}(n,r,i);return l.push(u),yield Promise.all(l),null!=r&&null!==(c=r.gltf)&&void 0!==c&&c.postProcess?function twe(n,e){return(new ewe).postProcess(n,e)}(n,r):n}),MI.apply(this,arguments)}function DI(){return DI=j(function*(n,e,t){const r=n.json.buffers||[];for(let o=0;o<r.length;++o){const a=r[o];if(a.uri){var i,s;const{fetch:c}=t;Ii(c);const l=$H(a.uri,e),u=yield null==t||null===(i=t.fetch)||void 0===i?void 0:i.call(t,l),d=yield null==u||null===(s=u.arrayBuffer)||void 0===s?void 0:s.call(u);n.buffers[o]={arrayBuffer:d,byteOffset:0,byteLength:d.byteLength},delete a.uri}else null===n.buffers[o]&&(n.buffers[o]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength})}}),DI.apply(this,arguments)}function RI(){return RI=j(function*(n,e,t){const r=function _we(n){const e=new Set,t=n.json.textures||[];for(const r of t)void 0!==r.source&&e.add(r.source);return Array.from(e).sort()}(n),i=n.json.images||[],s=[];for(const o of r)s.push(ywe(n,i[o],o,e,t));return yield Promise.all(s)}),RI.apply(this,arguments)}function ywe(n,e,t,r,i){return OI.apply(this,arguments)}function OI(){return OI=j(function*(n,e,t,r,i){const{fetch:s,parse:o}=i;let a;if(e.uri&&!e.hasOwnProperty("bufferView")){const l=$H(e.uri,r);a=yield(yield s(l)).arrayBuffer()}if(Number.isFinite(e.bufferView)){const l=function qH(n,e,t){const r=n.bufferViews[t];Ii(r);const s=e[r.buffer];return Ii(s),new Uint8Array(s.arrayBuffer,(r.byteOffset||0)+s.byteOffset,r.byteLength)}(n.json,n.buffers,e.bufferView);a=WH(l.buffer,l.byteOffset,l.byteLength)}Ii(a,"glTF image has no data");let c=yield o(a,[fbe,$ve],{mimeType:e.mimeType,basis:r.basis||{format:FH()}},i);c&&c[0]&&(c={compressed:!0,mipmaps:!1,width:c[0].width,height:c[0].height,data:c[0]}),n.images=n.images||[],n.images[t]=c}),OI.apply(this,arguments)}const Gd={name:"glTF",id:"gltf",module:"gltf",version:"3.2.13",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function vwe(n){return PI.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function PI(){return PI=j(function*(n,e={},t){(e={...Gd.options,...e}).gltf={...Gd.options.gltf,...e.gltf};const{byteOffset:r=0}=e;return yield function fwe(n,e){return MI.apply(this,arguments)}({},n,r,e,t)}),PI.apply(this,arguments)}function NI(){return NI=j(function*(n){const e=[];return n.scenes.forEach(t=>{t.traverse(r=>{Object.values(r.model.getUniforms()).forEach(i=>{!1===i.loaded&&e.push(i)})})}),yield function wwe(n){return kI.apply(this,arguments)}(()=>e.some(t=>!t.loaded))}),NI.apply(this,arguments)}function kI(){return kI=j(function*(n){for(;n();)yield new Promise(e=>requestAnimationFrame(e))}),kI.apply(this,arguments)}const Cz=[255,255,255,255],Awe={scenegraph:{type:"object",value:null,async:!0},getScene:n=>n&&n.scenes?"object"==typeof n.scene?n.scene:n.scenes[n.scene||0]:n,getAnimator:n=>n&&n.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:Cz},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[Gd]};class FI extends yl{constructor(...e){super(...e),w(this,"state",void 0)}getShaders(){const e=[yv,vv];return"pbr"===this.props._lighting&&e.push(pH),{vs:"#version 300 es\n\n// Instance attributes\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\n\n// Uniforms\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\n\n// Attributes\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\n\n// Varying\nout vec4 vColor;\n\n// MODULE_PBR contains all the varying definitions needed\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\n\n// Main\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  vec3 normal = vec3(0.0, 0.0, 1.0);\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;\n    #endif\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    // using instancePositions as world coordinates\n    // when using globe mode, this branch does not re-orient the model to align with the surface of the earth\n    // call project_normal before setting position to avoid rotation\n    geometry.normal = project_normal(normal);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n    geometry.normal = project_normal(normal);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    // set PBR data\n    pbr_vPosition = geometry.position.xyz;\n    #ifdef HAS_NORMALS\n      pbr_vNormal = geometry.normal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n\n// Uniforms\nuniform float opacity;\n\n// Varying\nin vec4 vColor;\n\nout vec4 fragmentColor;\n\n// MODULE_PBR contains all the varying definitions needed\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:e}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:Cz,transition:!0},instanceModelMatrix:dH})}updateState(e){super.updateState(e);const{props:t,oldProps:r}=e;t.scenegraph!==r.scenegraph?this._updateScenegraph():t._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,t._animations)}finalizeState(e){super.finalizeState(e),this._deleteScenegraph()}_updateScenegraph(){const e=this.props,{gl:t}=this.context;let r=null;if(e.scenegraph instanceof Ud)r={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){const a=e.scenegraph,c=function Cve(n,e,t){const r=new Eve(n,t);return{scenes:r.instantiate(e),animator:r.createAnimator()}}(t,a,this._getModelOptions());r={gltf:a,...c},function bwe(n){return NI.apply(this,arguments)}(c).then(()=>this.setNeedsRedraw())}else e.scenegraph&&(Je.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=e.scenegraph);const i={layer:this,gl:t},s=e.getScene(r,i),o=e.getAnimator(r,i);s instanceof Ud?(this._deleteScenegraph(),this._applyAllAttributes(s),this._applyAnimationsProp(s,o,e._animations),this.setState({scenegraph:s,animator:o})):null!==s&&Je.warn("invalid scenegraph:",s)()}_applyAllAttributes(e){if(this.state.attributesAvailable){const t=this.getAttributeManager().getAttributes();e.traverse(r=>{this._setModelAttributes(r.model,t)})}}_applyAnimationsProp(e,t,r){if(!e||!t||!r)return;const i=t.getAnimations();Object.keys(r).sort().forEach(s=>{const o=r[s];if("*"===s)i.forEach(a=>{Object.assign(a,o)});else if(Number.isFinite(Number(s))){const a=Number(s);a>=0&&a<i.length?Object.assign(i[a],o):Je.warn("animation ".concat(s," not found"))()}else{const a=i.find(({name:c})=>c===s);a?Object.assign(a,o):Je.warn("animation ".concat(s," not found"))()}})}_deleteScenegraph(){const{scenegraph:e}=this.state;e instanceof Ud&&e.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:e}=this.props;let t=null;return e&&(t="function"==typeof e?e({gl:this.context.gl,layer:this}):e),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:t,modelOptions:{isInstanced:!0,transpileToGLSL100:!Xe(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(e){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(t=>{this._setModelAttributes(t.model,e)})}draw({moduleParameters:e=null,parameters:t={},context:r}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:i}=this.context,{sizeScale:s,sizeMinPixels:o,sizeMaxPixels:a,opacity:c,coordinateSystem:l}=this.props,u=this.getNumInstances();this.state.scenegraph.traverse((d,{worldMatrix:h})=>{d.model.setInstanceCount(u),d.updateModuleSettings(e),d.draw({parameters:t,uniforms:{sizeScale:s,opacity:c,sizeMinPixels:o,sizeMaxPixels:a,composeModelMatrix:hH(i,l),sceneModelMatrix:h,u_Camera:d.model.getUniforms().project_uCameraPosition}})})}}w(FI,"defaultProps",Awe),w(FI,"layerName","ScenegraphLayer");class Twe extends dc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=ai("sphere-geometry")}=e,{indices:r,attributes:i}=function xwe(n){const{nlat:e=10,nlong:t=10}=n;let{radius:r=1}=n;const o=Math.PI-0,l=2*Math.PI-0,u=(e+1)*(t+1);if("number"==typeof r){const y=r;r=(v,_,E,T,I)=>y}const d=new Float32Array(3*u),h=new Float32Array(3*u),f=new Float32Array(2*u),g=new(u>65535?Uint32Array:Uint16Array)(e*t*6);for(let y=0;y<=e;y++)for(let v=0;v<=t;v++){const _=v/t,E=y/e,T=v+y*(t+1),I=2*T,D=3*T,M=l*_,k=o*E,B=Math.sin(M),L=Math.cos(M),z=Math.sin(k),F=L*z,W=Math.cos(k),G=B*z,we=r(F,W,G,_,E);d[D+0]=we*F,d[D+1]=we*W,d[D+2]=we*G,h[D+0]=F,h[D+1]=W,h[D+2]=G,f[I+0]=_,f[I+1]=1-E}const m=t+1;for(let y=0;y<t;y++)for(let v=0;v<e;v++){const _=6*(y*e+v);g[_+0]=v*m+y,g[_+1]=v*m+y+1,g[_+2]=(v+1)*m+y,g[_+3]=(v+1)*m+y,g[_+4]=v*m+y+1,g[_+5]=(v+1)*m+y+1}return{indices:{size:1,value:g},attributes:{POSITION:{size:3,value:d},NORMAL:{size:3,value:h},TEXCOORD_0:{size:2,value:f}}}}(e);super({...e,id:t,indices:r,attributes:{...i,...e.attributes}})}}const Swe={x:[2,0,1],y:[0,1,2],z:[1,2,0]};class Az extends dc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=ai("truncated-code-geometry")}=e,{indices:r,attributes:i}=function Iwe(n){const{bottomRadius:e=0,topRadius:t=0,height:r=1,nradial:i=10,nvertical:s=10,verticalAxis:o="y",topCap:a=!1,bottomCap:c=!1}=n,l=(a?2:0)+(c?2:0),u=(i+1)*(s+1+l),d=Math.atan2(e-t,r),h=Math.sin,f=Math.cos,p=Math.PI,g=f(d),m=h(d),y=a?-2:0,v=s+(c?2:0),_=i+1,E=new Uint16Array(i*(s+l)*6),T=Swe[o],I=new Float32Array(3*u),D=new Float32Array(3*u),M=new Float32Array(2*u);let k=0,B=0;for(let L=y;L<=v;L++){let F,z=L/s,R=r*z;L<0?(R=0,z=1,F=e):L>s?(R=r,z=1,F=t):F=e+L/s*(t-e),(-2===L||L===s+2)&&(F=0,z=0),R-=r/2;for(let W=0;W<_;W++){const G=h(W*p*2/i),we=f(W*p*2/i);I[k+T[0]]=G*F,I[k+T[1]]=R,I[k+T[2]]=we*F,D[k+T[0]]=L<0||L>s?0:G*g,D[k+T[1]]=L<0?-1:L>s?1:m,D[k+T[2]]=L<0||L>s?0:we*g,M[B+0]=W/i,M[B+1]=z,B+=2,k+=3}}for(let L=0;L<s+l;L++)for(let z=0;z<i;z++){const R=6*(L*i+z);E[R+0]=_*(L+0)+0+z,E[R+1]=_*(L+0)+1+z,E[R+2]=_*(L+1)+1+z,E[R+3]=_*(L+0)+0+z,E[R+4]=_*(L+1)+1+z,E[R+5]=_*(L+1)+0+z}return{indices:E,attributes:{POSITION:{size:3,value:I},NORMAL:{size:3,value:D},TEXCOORD_0:{size:2,value:M}}}}(e);super({...e,id:t,indices:r,attributes:{...i,...e.attributes}})}}class Mwe extends Az{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=ai("cone-geometry"),radius:r=1,cap:i=!0}=e;super({...e,id:t,topRadius:0,topCap:!!i,bottomCap:!!i,bottomRadius:r})}}class Dwe extends Az{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=ai("cylinder-geometry"),radius:r=1}=e;super({...e,id:t,bottomRadius:r,topRadius:r})}}const Rwe=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Owe=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),Pwe=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),Nwe=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),kwe={POSITION:{size:3,value:new Float32Array(Owe)},NORMAL:{size:3,value:new Float32Array(Pwe)},TEXCOORD_0:{size:2,value:new Float32Array(Nwe)}};class Fwe extends dc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=ai("cube-geometry")}=e;super({...e,id:t,indices:{size:1,value:new Uint16Array(Rwe)},attributes:{...kwe,...e.attributes}})}}function Fv(n,e,t){e||(e=new Ve(Ve.IDENTITY));const r=new Ve(Ve.IDENTITY);if(!n)return!0;if(n.matrix)r.copy(n.matrix);else{if(r.identity(),n.translation&&r.translate(n.translation),n.rotation){const s=new Ve(Ve.IDENTITY).fromQuaternion(n.rotation);r.multiplyRight(s)}n.scale&&r.scale(n.scale)}const i=new Ve(e).multiplyRight(r);if(!1===t(n,i,e))return!1;for(const s of n.nodes||n.children||[])if(!1===Fv(s,i,t))return!1;return!0}function Tz(){Aj([ez,Gd])}function xz(n,e){const t=e.nodes?.find(r=>r.name===n);if(t){let r=!1;for(const i of e.scenes)r||Fv(i,new Ve(Ve.IDENTITY),(s,o)=>s!==t||(s.matrix=o,s.translation=void 0,s.rotation=void 0,s.scale=void 0,r=!0,!1));return e.scene={id:n,name:n,nodes:[t]},e.scenes=[e.scene],{scene:e.scene,scenes:e.scenes}}return e}function Sz(n,e){return LI.apply(this,arguments)}function LI(){return LI=j(function*(n,e){const t=n.scenegraph;let r;r=e?e[t]||(e[t]=fetch(t).then(s=>s.blob())):fetch(t);const i=yield sv(r,Gd,{DracoLoader:gI,gltf:{decompressMeshes:!0,postProcess:!0}});return i.nodes||console.log("WARNING: Empty Scene",t,i),xz(n.scenegraphNode,i)}),LI.apply(this,arguments)}function Lwe(n,e){return BI.apply(this,arguments)}function BI(){return BI=j(function*(n,e){return xz(n,yield e)}),BI.apply(this,arguments)}class xs{constructor(e){void 0===e&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e){void 0===e&&(e=new b);const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t){void 0===t&&(t=new b);const r=this.elements,i=e.x,s=e.y,o=e.z;return t.x=r[0]*i+r[1]*s+r[2]*o,t.y=r[3]*i+r[4]*s+r[5]*o,t.z=r[6]*i+r[7]*s+r[8]*o,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t){void 0===t&&(t=new xs);const r=this.elements,i=e.elements,s=t.elements,o=r[0],a=r[1],c=r[2],l=r[3],u=r[4],d=r[5],h=r[6],f=r[7],p=r[8],g=i[0],m=i[1],y=i[2],v=i[3],_=i[4],E=i[5],T=i[6],I=i[7],D=i[8];return s[0]=o*g+a*v+c*T,s[1]=o*m+a*_+c*I,s[2]=o*y+a*E+c*D,s[3]=l*g+u*v+d*T,s[4]=l*m+u*_+d*I,s[5]=l*y+u*E+d*D,s[6]=h*g+f*v+p*T,s[7]=h*m+f*_+p*I,s[8]=h*y+f*E+p*D,t}scale(e,t){void 0===t&&(t=new xs);const r=this.elements,i=t.elements;for(let s=0;3!==s;s++)i[3*s+0]=e.x*r[3*s+0],i[3*s+1]=e.y*r[3*s+1],i[3*s+2]=e.z*r[3*s+2];return t}solve(e,t){void 0===t&&(t=new b);const s=[];let o,a;for(o=0;o<12;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+4*a]=this.elements[o+3*a];s[3]=e.x,s[7]=e.y,s[11]=e.z;let c=3;const l=c;let u,h;do{if(o=l-c,0===s[o+4*o])for(a=o+1;a<l;a++)if(0!==s[o+4*a]){u=4;do{h=4-u,s[h+4*o]+=s[h+4*a]}while(--u);break}if(0!==s[o+4*o])for(a=o+1;a<l;a++){const f=s[o+4*a]/s[o+4*o];u=4;do{h=4-u,s[h+4*a]=h<=o?0:s[h+4*a]-s[h+4*o]*f}while(--u)}}while(--c);if(t.z=s[11]/s[10],t.y=(s[7]-s[6]*t.z)/s[5],t.x=(s[3]-s[2]*t.z-s[1]*t.y)/s[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw`Could not solve equation! Got x=[${t.toString()}], b=[${e.toString()}], A=[${this.toString()}]`;return t}e(e,t,r){if(void 0===r)return this.elements[t+3*e];this.elements[t+3*e]=r}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let r=0;r<9;r++)e+=this.elements[r]+",";return e}reverse(e){void 0===e&&(e=new xs);const i=Bwe;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)i[s+6*o]=this.elements[s+3*o];i[3]=1,i[9]=0,i[15]=0,i[4]=0,i[10]=1,i[16]=0,i[5]=0,i[11]=0,i[17]=1;let a=3;const c=a;let l,d;do{if(s=c-a,0===i[s+6*s])for(o=s+1;o<c;o++)if(0!==i[s+6*o]){l=6;do{d=6-l,i[d+6*s]+=i[d+6*o]}while(--l);break}if(0!==i[s+6*s])for(o=s+1;o<c;o++){const h=i[s+6*o]/i[s+6*s];l=6;do{d=6-l,i[d+6*o]=d<=s?0:i[d+6*o]-i[d+6*s]*h}while(--l)}}while(--a);s=2;do{o=s-1;do{const h=i[s+6*o]/i[s+6*s];l=6;do{d=6-l,i[d+6*o]=i[d+6*o]-i[d+6*s]*h}while(--l)}while(o--)}while(--s);s=2;do{const h=1/i[s+6*s];l=6;do{d=6-l,i[d+6*s]=i[d+6*s]*h}while(--l)}while(s--);s=2;do{o=2;do{if(d=i[3+o+6*s],isNaN(d)||d===1/0)throw`Could not reverse! A=[${this.toString()}]`;e.e(s,o,d)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const t=e.x,r=e.y,i=e.z,s=e.w,o=t+t,a=r+r,c=i+i,l=t*o,u=t*a,d=t*c,h=r*a,f=r*c,p=i*c,g=s*o,m=s*a,y=s*c,v=this.elements;return v[0]=1-(h+p),v[1]=u-y,v[2]=d+m,v[3]=u+y,v[4]=1-(l+p),v[5]=f-g,v[6]=d-m,v[7]=f+g,v[8]=1-(l+h),this}transpose(e){void 0===e&&(e=new xs);const t=this.elements,r=e.elements;let i;return r[0]=t[0],r[4]=t[4],r[8]=t[8],i=t[1],r[1]=t[3],r[3]=i,i=t[2],r[2]=t[6],r[6]=i,i=t[5],r[5]=t[7],r[7]=i,e}}const Bwe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class b{constructor(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),this.x=e,this.y=t,this.z=r}cross(e,t){void 0===t&&(t=new b);const r=e.x,i=e.y,s=e.z,o=this.x,a=this.y,c=this.z;return t.x=a*s-c*i,t.y=c*r-o*s,t.z=o*i-a*r,t}set(e,t,r){return this.x=e,this.y=t,this.z=r,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new b(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new b(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new xs([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,r=this.z,i=Math.sqrt(e*e+t*t+r*r);if(i>0){const s=1/i;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return i}unit(e){void 0===e&&(e=new b);const t=this.x,r=this.y,i=this.z;let s=Math.sqrt(t*t+r*r+i*i);return s>0?(s=1/s,e.x=t*s,e.y=r*s,e.z=i*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,r=this.z;return Math.sqrt(e*e+t*t+r*r)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,r=this.y,i=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-t)*(s-t)+(o-r)*(o-r)+(a-i)*(a-i))}distanceSquared(e){const t=this.x,r=this.y,i=this.z,s=e.x,o=e.y,a=e.z;return(s-t)*(s-t)+(o-r)*(o-r)+(a-i)*(a-i)}scale(e,t){void 0===t&&(t=new b);const i=this.y,s=this.z;return t.x=e*this.x,t.y=e*i,t.z=e*s,t}vmul(e,t){return void 0===t&&(t=new b),t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,r){return void 0===r&&(r=new b),r.x=this.x+e*t.x,r.y=this.y+e*t.y,r.z=this.z+e*t.z,r}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e){return void 0===e&&(e=new b),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const r=this.length();if(r>0){const i=Uwe,s=1/r;i.set(this.x*s,this.y*s,this.z*s);const o=jwe;Math.abs(i.x)<.9?(o.set(1,0,0),i.cross(o,e)):(o.set(0,1,0),i.cross(o,e)),i.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,r){const i=this.x,s=this.y,o=this.z;r.x=i+(e.x-i)*t,r.y=s+(e.y-s)*t,r.z=o+(e.z-o)*t}almostEquals(e,t){return void 0===t&&(t=1e-6),!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e){return void 0===e&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(Iz),Iz.almostEquals(e,t)}clone(){return new b(this.x,this.y,this.z)}}b.ZERO=new b(0,0,0),b.UNIT_X=new b(1,0,0),b.UNIT_Y=new b(0,1,0),b.UNIT_Z=new b(0,0,1);const Uwe=new b,jwe=new b,Iz=new b;class Ut{constructor(e){void 0===e&&(e={}),this.lowerBound=new b,this.upperBound=new b,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,r,i){const s=this.lowerBound,o=this.upperBound,a=r;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let c=1;c<e.length;c++){let l=e[c];a&&(a.vmult(l,Mz),l=Mz),l.x>o.x&&(o.x=l.x),l.x<s.x&&(s.x=l.x),l.y>o.y&&(o.y=l.y),l.y<s.y&&(s.y=l.y),l.z>o.z&&(o.z=l.z),l.z<s.z&&(s.z=l.z)}return t&&(t.vadd(s,s),t.vadd(o,o)),i&&(s.x-=i,s.y-=i,s.z-=i,o.x+=i,o.y+=i,o.z+=i),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new Ut).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,r=this.upperBound,i=e.lowerBound,s=e.upperBound;return(i.x<=r.x&&r.x<=s.x||t.x<=s.x&&s.x<=r.x)&&(i.y<=r.y&&r.y<=s.y||t.y<=s.y&&s.y<=r.y)&&(i.z<=r.z&&r.z<=s.z||t.z<=s.z&&s.z<=r.z)}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,r=this.upperBound,i=e.lowerBound,s=e.upperBound;return t.x<=i.x&&r.x>=s.x&&t.y<=i.y&&r.y>=s.y&&t.z<=i.z&&r.z>=s.z}getCorners(e,t,r,i,s,o,a,c){const l=this.lowerBound,u=this.upperBound;e.copy(l),t.set(u.x,l.y,l.z),r.set(u.x,u.y,l.z),i.set(l.x,u.y,u.z),s.set(u.x,l.y,u.z),o.set(l.x,u.y,l.z),a.set(l.x,l.y,u.z),c.copy(u)}toLocalFrame(e,t){const r=Dz;this.getCorners(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]);for(let h=0;8!==h;h++){const f=r[h];e.pointToLocal(f,f)}return t.setFromPoints(r)}toWorldFrame(e,t){const r=Dz;this.getCorners(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]);for(let h=0;8!==h;h++){const f=r[h];e.pointToWorld(f,f)}return t.setFromPoints(r)}overlapsRay(e){const{direction:t,from:r}=e,i=1/t.x,s=1/t.y,o=1/t.z,a=(this.lowerBound.x-r.x)*i,c=(this.upperBound.x-r.x)*i,l=(this.lowerBound.y-r.y)*s,u=(this.upperBound.y-r.y)*s,d=(this.lowerBound.z-r.z)*o,h=(this.upperBound.z-r.z)*o,f=Math.max(Math.max(Math.min(a,c),Math.min(l,u)),Math.min(d,h)),p=Math.min(Math.min(Math.max(a,c),Math.max(l,u)),Math.max(d,h));return!(p<0||f>p)}}const Mz=new b,Dz=[new b,new b,new b,new b,new b,new b,new b,new b];class Oz{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const r=this._listeners;return void 0===r[e]&&(r[e]=[]),r[e].includes(t)||r[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const r=this._listeners;return!(void 0===r[e]||!r[e].includes(t))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const r=this._listeners;if(void 0===r[e])return this;const i=r[e].indexOf(t);return-1!==i&&r[e].splice(i,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const r=this._listeners[e.type];if(void 0!==r){e.target=this;for(let i=0,s=r.length;i<s;i++)r[i].call(this,e)}return this}}class _n{constructor(e,t,r,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===i&&(i=1),this.x=e,this.y=t,this.z=r,this.w=i}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const r=Math.sin(.5*t);return this.x=e.x*r,this.y=e.y*r,this.z=e.z*r,this.w=Math.cos(.5*t),this}toAxisAngle(e){void 0===e&&(e=new b),this.normalize();const t=2*Math.acos(this.w),r=Math.sqrt(1-this.w*this.w);return r<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/r,e.y=this.y/r,e.z=this.z/r),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const r=Vwe;e.tangents(r,Hwe),this.setFromAxisAngle(r,Math.PI)}else{const r=e.cross(t);this.x=r.x,this.y=r.y,this.z=r.z,this.w=Math.sqrt(e.length()**2*t.length()**2)+e.dot(t),this.normalize()}return this}mult(e,t){void 0===t&&(t=new _n);const r=this.x,i=this.y,s=this.z,o=this.w,a=e.x,c=e.y,l=e.z,u=e.w;return t.x=r*u+o*a+i*l-s*c,t.y=i*u+o*c+s*a-r*l,t.z=s*u+o*l+r*c-i*a,t.w=o*u-r*a-i*c-s*l,t}inverse(e){void 0===e&&(e=new _n);const t=this.x,r=this.y,i=this.z,s=this.w;this.conjugate(e);const o=1/(t*t+r*r+i*i+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e){return void 0===e&&(e=new _n),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t){void 0===t&&(t=new b);const r=e.x,i=e.y,s=e.z,o=this.x,a=this.y,c=this.z,l=this.w,u=l*r+a*s-c*i,d=l*i+c*r-o*s,h=l*s+o*i-a*r,f=-o*r-a*i-c*s;return t.x=u*l+f*-o+d*-c-h*-a,t.y=d*l+f*-a+h*-o-u*-c,t.z=h*l+f*-c+u*-a-d*-o,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t){let r,i,s;void 0===t&&(t="YZX");const o=this.x,a=this.y,c=this.z,l=this.w;if("YZX"!==t)throw new Error(`Euler order ${t} not supported yet.`);{const u=o*a+c*l;if(u>.499&&(r=2*Math.atan2(o,l),i=Math.PI/2,s=0),u<-.499&&(r=-2*Math.atan2(o,l),i=-Math.PI/2,s=0),void 0===r){const d=o*o,f=c*c;r=Math.atan2(2*a*l-2*o*c,1-a*a*2-2*f),i=Math.asin(2*u),s=Math.atan2(2*o*l-2*a*c,1-2*d-2*f)}}e.y=r,e.z=i,e.x=s}setFromEuler(e,t,r,i){void 0===i&&(i="XYZ");const s=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(r/2),c=Math.sin(e/2),l=Math.sin(t/2),u=Math.sin(r/2);return"XYZ"===i?(this.x=c*o*a+s*l*u,this.y=s*l*a-c*o*u,this.z=s*o*u+c*l*a,this.w=s*o*a-c*l*u):"YXZ"===i?(this.x=c*o*a+s*l*u,this.y=s*l*a-c*o*u,this.z=s*o*u-c*l*a,this.w=s*o*a+c*l*u):"ZXY"===i?(this.x=c*o*a-s*l*u,this.y=s*l*a+c*o*u,this.z=s*o*u+c*l*a,this.w=s*o*a-c*l*u):"ZYX"===i?(this.x=c*o*a-s*l*u,this.y=s*l*a+c*o*u,this.z=s*o*u-c*l*a,this.w=s*o*a+c*l*u):"YZX"===i?(this.x=c*o*a+s*l*u,this.y=s*l*a+c*o*u,this.z=s*o*u-c*l*a,this.w=s*o*a-c*l*u):"XZY"===i&&(this.x=c*o*a-s*l*u,this.y=s*l*a-c*o*u,this.z=s*o*u+c*l*a,this.w=s*o*a+c*l*u),this}clone(){return new _n(this.x,this.y,this.z,this.w)}slerp(e,t,r){void 0===r&&(r=new _n);const i=this.x,s=this.y,o=this.z,a=this.w;let h,f,p,g,m,c=e.x,l=e.y,u=e.z,d=e.w;return f=i*c+s*l+o*u+a*d,f<0&&(f=-f,c=-c,l=-l,u=-u,d=-d),1-f>1e-6?(h=Math.acos(f),p=Math.sin(h),g=Math.sin((1-t)*h)/p,m=Math.sin(t*h)/p):(g=1-t,m=t),r.x=g*i+m*c,r.y=g*s+m*l,r.z=g*o+m*u,r.w=g*a+m*d,r}integrate(e,t,r,i){void 0===i&&(i=new _n);const s=e.x*r.x,o=e.y*r.y,a=e.z*r.z,c=this.x,l=this.y,u=this.z,d=this.w,h=.5*t;return i.x+=h*(s*d+o*u-a*l),i.y+=h*(o*d+a*c-s*u),i.z+=h*(a*d+s*l-o*c),i.w+=h*(-s*c-o*l-a*u),i}}const Vwe=new b,Hwe=new b,zwe={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let se=(()=>{class n{constructor(t){void 0===t&&(t={}),this.id=n.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(t,r){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(t,r,i,s){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}return n.idCounter=0,n.types=zwe,n})();class lt{constructor(e){void 0===e&&(e={}),this.position=new b,this.quaternion=new _n,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return lt.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return lt.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t){return void 0===t&&(t=new b),this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,r,i){return void 0===i&&(i=new b),r.vsub(e,i),t.conjugate(Pz),Pz.vmult(i,i),i}static pointToWorldFrame(e,t,r,i){return void 0===i&&(i=new b),t.vmult(r,i),i.vadd(e,i),i}static vectorToWorldFrame(e,t,r){return void 0===r&&(r=new b),e.vmult(t,r),r}static vectorToLocalFrame(e,t,r,i){return void 0===i&&(i=new b),t.w*=-1,t.vmult(r,i),t.w*=-1,i}}const Pz=new _n;class pc extends se{constructor(e){void 0===e&&(e={});const{vertices:t=[],faces:r=[],normals:i=[],axes:s,boundingSphereRadius:o}=e;super({type:se.types.CONVEXPOLYHEDRON}),this.vertices=t,this.faces=r,this.faceNormals=i,0===this.faceNormals.length&&this.computeNormals(),o?this.boundingSphereRadius=o:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=s?s.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,r=this.uniqueEdges;r.length=0;const i=new b;for(let s=0;s!==e.length;s++){const o=e[s],a=o.length;for(let c=0;c!==a;c++){t[o[c]].vsub(t[o[(c+1)%a]],i),i.normalize();let u=!1;for(let d=0;d!==r.length;d++)if(r[d].almostEquals(i)||r[d].almostEquals(i)){u=!0;break}u||r.push(i.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let i=0;i<this.faces[e].length;i++)if(!this.vertices[this.faces[e][i]])throw new Error(`Vertex ${this.faces[e][i]} not found!`);const t=this.faceNormals[e]||new b;if(this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t,t.dot(this.vertices[this.faces[e][0]])<0){console.error(`.faceNormals[${e}] = Vec3(${t.toString()}) looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.`);for(let i=0;i<this.faces[e].length;i++)console.warn(`.vertices[${this.faces[e][i]}] = Vec3(${this.vertices[this.faces[e][i]].toString()})`)}}}getFaceNormal(e,t){const r=this.faces[e];pc.computeNormal(this.vertices[r[0]],this.vertices[r[1]],this.vertices[r[2]],t)}static computeNormal(e,t,r,i){const s=new b,o=new b;t.vsub(e,o),r.vsub(t,s),s.cross(o,i),i.isZero()||i.normalize()}clipAgainstHull(e,t,r,i,s,o,a,c,l){const u=new b;let d=-1,h=-Number.MAX_VALUE;for(let p=0;p<r.faces.length;p++){u.copy(r.faceNormals[p]),s.vmult(u,u);const g=u.dot(o);g>h&&(h=g,d=p)}const f=[];for(let p=0;p<r.faces[d].length;p++){const g=r.vertices[r.faces[d][p]],m=new b;m.copy(g),s.vmult(m,m),i.vadd(m,m),f.push(m)}d>=0&&this.clipFaceAgainstHull(o,e,t,f,a,c,l)}findSeparatingAxis(e,t,r,i,s,o,a,c){const l=new b,u=new b,d=new b,h=new b,f=new b,p=new b;let g=Number.MAX_VALUE;const m=this;if(m.uniqueAxes)for(let y=0;y!==m.uniqueAxes.length;y++){r.vmult(m.uniqueAxes[y],l);const v=m.testSepAxis(l,e,t,r,i,s);if(!1===v)return!1;v<g&&(g=v,o.copy(l))}else{const y=a?a.length:m.faces.length;for(let v=0;v<y;v++){l.copy(m.faceNormals[a?a[v]:v]),r.vmult(l,l);const E=m.testSepAxis(l,e,t,r,i,s);if(!1===E)return!1;E<g&&(g=E,o.copy(l))}}if(e.uniqueAxes)for(let y=0;y!==e.uniqueAxes.length;y++){s.vmult(e.uniqueAxes[y],u);const v=m.testSepAxis(u,e,t,r,i,s);if(!1===v)return!1;v<g&&(g=v,o.copy(u))}else{const y=c?c.length:e.faces.length;for(let v=0;v<y;v++){u.copy(e.faceNormals[c?c[v]:v]),s.vmult(u,u);const E=m.testSepAxis(u,e,t,r,i,s);if(!1===E)return!1;E<g&&(g=E,o.copy(u))}}for(let y=0;y!==m.uniqueEdges.length;y++){r.vmult(m.uniqueEdges[y],h);for(let v=0;v!==e.uniqueEdges.length;v++)if(s.vmult(e.uniqueEdges[v],f),h.cross(f,p),!p.almostZero()){p.normalize();const _=m.testSepAxis(p,e,t,r,i,s);if(!1===_)return!1;_<g&&(g=_,o.copy(p))}}return i.vsub(t,d),d.dot(o)>0&&o.negate(o),!0}testSepAxis(e,t,r,i,s,o){pc.project(this,e,r,i,UI),pc.project(t,e,s,o,jI);const c=UI[0],l=UI[1],u=jI[0],d=jI[1];if(c<d||u<l)return!1;const h=c-d,f=u-l;return h<f?h:f}calculateLocalInertia(e,t){const r=new b,i=new b;this.computeLocalAABB(i,r);const s=r.x-i.x,o=r.y-i.y,a=r.z-i.z;t.x=1/12*e*(2*o*2*o+2*a*2*a),t.y=1/12*e*(2*s*2*s+2*a*2*a),t.z=1/12*e*(2*o*2*o+2*s*2*s)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,t,r,i,s,o,a){const c=new b,l=new b,u=new b,d=new b,h=new b,f=new b,p=new b,g=new b,m=this,v=i,_=[];let E=-1,T=Number.MAX_VALUE;for(let B=0;B<m.faces.length;B++){c.copy(m.faceNormals[B]),r.vmult(c,c);const L=c.dot(e);L<T&&(T=L,E=B)}if(E<0)return;const I=m.faces[E];I.connectedFaces=[];for(let B=0;B<m.faces.length;B++)for(let L=0;L<m.faces[B].length;L++)-1!==I.indexOf(m.faces[B][L])&&B!==E&&-1===I.connectedFaces.indexOf(B)&&I.connectedFaces.push(B);const D=I.length;for(let B=0;B<D;B++){const L=m.vertices[I[B]];L.vsub(m.vertices[I[(B+1)%D]],l),u.copy(l),r.vmult(u,u),t.vadd(u,u),d.copy(this.faceNormals[E]),r.vmult(d,d),t.vadd(d,d),u.cross(d,h),h.negate(h),f.copy(L),r.vmult(f,f),t.vadd(f,f);const R=I.connectedFaces[B];p.copy(this.faceNormals[R]);const F=this.getPlaneConstantOfFace(R);g.copy(p),r.vmult(g,g);const W=F-g.dot(t);for(this.clipFaceAgainstPlane(v,_,g,W);v.length;)v.shift();for(;_.length;)v.push(_.shift())}p.copy(this.faceNormals[E]);const M=this.getPlaneConstantOfFace(E);g.copy(p),r.vmult(g,g);const k=M-g.dot(t);for(let B=0;B<v.length;B++){let L=g.dot(v[B])+k;L<=s&&(console.log(`clamped: depth=${L} to minDist=${s}`),L=s),L<=o&&L<=1e-6&&a.push({point:v[B],normal:g,depth:L})}}clipFaceAgainstPlane(e,t,r,i){let s,o;const a=e.length;if(a<2)return t;let c=e[e.length-1],l=e[0];s=r.dot(c)+i;for(let u=0;u<a;u++){if(l=e[u],o=r.dot(l)+i,s<0)if(o<0){const d=new b;d.copy(l),t.push(d)}else{const d=new b;c.lerp(l,s/(s-o),d),t.push(d)}else if(o<0){const d=new b;c.lerp(l,s/(s-o),d),t.push(d),t.push(l)}c=l,s=o}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new b);const r=this.vertices,i=this.worldVertices;for(let s=0;s!==this.vertices.length;s++)t.vmult(r[s],i[s]),e.vadd(i[s],i[s]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const r=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let i=0;i<this.vertices.length;i++){const s=r[i];s.x<e.x?e.x=s.x:s.x>t.x&&(t.x=s.x),s.y<e.y?e.y=s.y:s.y>t.y&&(t.y=s.y),s.z<e.z?e.z=s.z:s.z>t.z&&(t.z=s.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new b);const r=this.faceNormals,i=this.worldFaceNormals;for(let s=0;s!==t;s++)e.vmult(r[s],i[s]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let r=0;r!==t.length;r++){const i=t[r].lengthSquared();i>e&&(e=i)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,r,i){const s=this.vertices;let o,a,c,l,u,d,h=new b;for(let f=0;f<s.length;f++)h.copy(s[f]),t.vmult(h,h),e.vadd(h,h),(void 0===o||h.x<o)&&(o=h.x),(void 0===l||h.x>l)&&(l=h.x),(void 0===a||h.y<a)&&(a=h.y),(void 0===u||h.y>u)&&(u=h.y),(void 0===c||h.z<c)&&(c=h.z),(void 0===d||h.z>d)&&(d=h.z);r.set(o,a,c),i.set(l,u,d)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e){void 0===e&&(e=new b);const t=this.vertices;for(let r=0;r<t.length;r++)e.vadd(t[r],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const r=this.vertices.length,i=this.vertices;if(t){for(let s=0;s<r;s++){const o=i[s];t.vmult(o,o)}for(let s=0;s<this.faceNormals.length;s++){const o=this.faceNormals[s];t.vmult(o,o)}}if(e)for(let s=0;s<r;s++){const o=i[s];o.vadd(e,o)}}pointIsInside(e){const t=this.vertices,r=this.faces,i=this.faceNormals,o=new b;this.getAveragePointLocal(o);for(let a=0;a<this.faces.length;a++){let c=i[a];const l=t[r[a][0]],u=new b;e.vsub(l,u);const d=c.dot(u),h=new b;o.vsub(l,h);const f=c.dot(h);if(d<0&&f>0||d>0&&f<0)return!1}return-1}static project(e,t,r,i,s){const o=e.vertices.length,a=Wwe;let c=0,l=0;const u=$we,d=e.vertices;u.setZero(),lt.vectorToLocalFrame(r,i,t,a),lt.pointToLocalFrame(r,i,u,u);const h=u.dot(a);l=c=d[0].dot(a);for(let f=1;f<o;f++){const p=d[f].dot(a);p>c&&(c=p),p<l&&(l=p)}if(l-=h,c-=h,l>c){const f=l;l=c,c=f}s[0]=c,s[1]=l}}const UI=[],jI=[],Wwe=(new b,new b),$we=new b;class Lv extends se{constructor(e){super({type:se.types.BOX}),this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,r=this.halfExtents.z,i=b,s=[new i(-e,-t,-r),new i(e,-t,-r),new i(e,t,-r),new i(-e,t,-r),new i(-e,-t,r),new i(e,-t,r),new i(e,t,r),new i(-e,t,r)],a=[new i(0,0,1),new i(0,1,0),new i(1,0,0)],c=new pc({vertices:s,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:a});this.convexPolyhedronRepresentation=c,c.material=this.material}calculateLocalInertia(e,t){return void 0===t&&(t=new b),Lv.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,r){const i=e;r.x=1/12*t*(2*i.y*2*i.y+2*i.z*2*i.z),r.y=1/12*t*(2*i.x*2*i.x+2*i.z*2*i.z),r.z=1/12*t*(2*i.y*2*i.y+2*i.x*2*i.x)}getSideNormals(e,t){const r=e,i=this.halfExtents;if(r[0].set(i.x,0,0),r[1].set(0,i.y,0),r[2].set(0,0,i.z),r[3].set(-i.x,0,0),r[4].set(0,-i.y,0),r[5].set(0,0,-i.z),void 0!==t)for(let s=0;s!==r.length;s++)t.vmult(r[s],r[s]);return r}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,r){const i=this.halfExtents,s=[[i.x,i.y,i.z],[-i.x,i.y,i.z],[-i.x,-i.y,i.z],[-i.x,-i.y,-i.z],[i.x,-i.y,-i.z],[i.x,i.y,-i.z],[-i.x,i.y,-i.z],[i.x,-i.y,i.z]];for(let o=0;o<s.length;o++)gc.set(s[o][0],s[o][1],s[o][2]),t.vmult(gc,gc),e.vadd(gc,gc),r(gc.x,gc.y,gc.z)}calculateWorldAABB(e,t,r,i){const s=this.halfExtents;ho[0].set(s.x,s.y,s.z),ho[1].set(-s.x,s.y,s.z),ho[2].set(-s.x,-s.y,s.z),ho[3].set(-s.x,-s.y,-s.z),ho[4].set(s.x,-s.y,-s.z),ho[5].set(s.x,s.y,-s.z),ho[6].set(-s.x,s.y,-s.z),ho[7].set(s.x,-s.y,s.z);const o=ho[0];t.vmult(o,o),e.vadd(o,o),i.copy(o),r.copy(o);for(let a=1;a<8;a++){const c=ho[a];t.vmult(c,c),e.vadd(c,c);const l=c.x,u=c.y,d=c.z;l>i.x&&(i.x=l),u>i.y&&(i.y=u),d>i.z&&(i.z=d),l<r.x&&(r.x=l),u<r.y&&(r.y=u),d<r.z&&(r.z=d)}}}const gc=new b,ho=[new b,new b,new b,new b,new b,new b,new b,new b];class de extends Oz{constructor(e){void 0===e&&(e={}),super(),this.id=de.idCounter++,this.index=-1,this.world=null,this.vlambda=new b,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new b,this.previousPosition=new b,this.interpolatedPosition=new b,this.initPosition=new b,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new b,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new b,this.force=new b;const t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?de.STATIC:de.DYNAMIC,typeof e.type==typeof de.STATIC&&(this.type=e.type),this.allowSleep=!(typeof e.allowSleep<"u")||e.allowSleep,this.sleepState=de.AWAKE,this.sleepSpeedLimit=typeof e.sleepSpeedLimit<"u"?e.sleepSpeedLimit:.1,this.sleepTimeLimit=typeof e.sleepTimeLimit<"u"?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new b,this.quaternion=new _n,this.initQuaternion=new _n,this.previousQuaternion=new _n,this.interpolatedQuaternion=new _n,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new b,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new b,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new b,this.invInertia=new b,this.invInertiaWorld=new xs,this.invMassSolve=0,this.invInertiaSolve=new b,this.invInertiaWorldSolve=new xs,this.fixedRotation=typeof e.fixedRotation<"u"&&e.fixedRotation,this.angularDamping=typeof e.angularDamping<"u"?e.angularDamping:.01,this.linearFactor=new b(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new b(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new Ut,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new b,this.isTrigger=!!e.isTrigger,e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=de.AWAKE,this.wakeUpAfterNarrowphase=!1,e===de.SLEEPING&&this.dispatchEvent(de.wakeupEvent)}sleep(){this.sleepState=de.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,r=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),i=this.sleepSpeedLimit**2;t===de.AWAKE&&r<i?(this.sleepState=de.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(de.sleepyEvent)):t===de.SLEEPY&&r>i?this.wakeUp():t===de.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(de.sleepEvent))}}updateSolveMassProperties(){this.sleepState===de.SLEEPING||this.type===de.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t){return void 0===t&&(t=new b),e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t){return void 0===t&&(t=new b),this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t){return void 0===t&&(t=new b),this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t){return void 0===t&&(t=new b),this.quaternion.vmult(e,t),t}addShape(e,t,r){const i=new b,s=new _n;return t&&i.copy(t),r&&s.copy(r),this.shapes.push(e),this.shapeOffsets.push(i),this.shapeOrientations.push(s),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,r=e.length;let i=0;for(let s=0;s!==r;s++){const o=e[s];o.updateBoundingSphereRadius();const a=t[s].length(),c=o.boundingSphereRadius;a+c>i&&(i=a+c)}this.boundingRadius=i}updateAABB(){const e=this.shapes,t=this.shapeOffsets,r=this.shapeOrientations,i=e.length,s=qwe,o=Xwe,a=this.quaternion,c=this.aabb,l=Ywe;for(let u=0;u!==i;u++){const d=e[u];a.vmult(t[u],s),s.vadd(this.position,s),a.mult(r[u],o),d.calculateWorldAABB(s,o,l.lowerBound,l.upperBound),0===u?c.copy(l):c.extend(l)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const r=Zwe,i=Kwe;r.setRotationFromQuaternion(this.quaternion),r.transpose(i),r.scale(t,r),r.mmult(i,this.invInertiaWorld)}}applyForce(e,t){if(void 0===t&&(t=new b),this.type!==de.DYNAMIC)return;this.sleepState===de.SLEEPING&&this.wakeUp();const r=Qwe;t.cross(e,r),this.force.vadd(e,this.force),this.torque.vadd(r,this.torque)}applyLocalForce(e,t){if(void 0===t&&(t=new b),this.type!==de.DYNAMIC)return;const r=eEe,i=tEe;this.vectorToWorldFrame(e,r),this.vectorToWorldFrame(t,i),this.applyForce(r,i)}applyTorque(e){this.type===de.DYNAMIC&&(this.sleepState===de.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t){if(void 0===t&&(t=new b),this.type!==de.DYNAMIC)return;this.sleepState===de.SLEEPING&&this.wakeUp();const r=t,i=nEe;i.copy(e),i.scale(this.invMass,i),this.velocity.vadd(i,this.velocity);const s=rEe;r.cross(e,s),this.invInertiaWorld.vmult(s,s),this.angularVelocity.vadd(s,this.angularVelocity)}applyLocalImpulse(e,t){if(void 0===t&&(t=new b),this.type!==de.DYNAMIC)return;const r=iEe,i=sEe;this.vectorToWorldFrame(e,r),this.vectorToWorldFrame(t,i),this.applyImpulse(r,i)}updateMassProperties(){const e=oEe;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,r=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),Lv.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!r?1/t.x:0,t.y>0&&!r?1/t.y:0,t.z>0&&!r?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const r=new b;return e.vsub(this.position,r),this.angularVelocity.cross(r,t),this.velocity.vadd(t,t),t}integrate(e,t,r){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==de.DYNAMIC&&this.type!==de.KINEMATIC||this.sleepState===de.SLEEPING)return;const i=this.velocity,s=this.angularVelocity,o=this.position,a=this.force,c=this.torque,l=this.quaternion,d=this.invInertiaWorld,h=this.linearFactor,f=this.invMass*e;i.x+=a.x*f*h.x,i.y+=a.y*f*h.y,i.z+=a.z*f*h.z;const p=d.elements,g=this.angularFactor,m=c.x*g.x,y=c.y*g.y,v=c.z*g.z;s.x+=e*(p[0]*m+p[1]*y+p[2]*v),s.y+=e*(p[3]*m+p[4]*y+p[5]*v),s.z+=e*(p[6]*m+p[7]*y+p[8]*v),o.x+=i.x*e,o.y+=i.y*e,o.z+=i.z*e,l.integrate(this.angularVelocity,e,this.angularFactor,l),t&&(r?l.normalizeFast():l.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}de.idCounter=0,de.COLLIDE_EVENT_NAME="collide",de.DYNAMIC=1,de.STATIC=2,de.KINEMATIC=4,de.AWAKE=0,de.SLEEPY=1,de.SLEEPING=2,de.wakeupEvent={type:"wakeup"},de.sleepyEvent={type:"sleepy"},de.sleepEvent={type:"sleep"};const qwe=new b,Xwe=new _n,Ywe=new Ut,Zwe=new xs,Kwe=new xs,Qwe=(new xs,new b),eEe=new b,tEe=new b,nEe=new b,rEe=new b,iEe=new b,sEe=new b,oEe=new b;new b,new b,new _n,new b,new b,new b,new b;class Yp{constructor(){this.rayFromWorld=new b,this.rayToWorld=new b,this.hitNormalWorld=new b,this.hitPointWorld=new b,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,r,i,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(r),this.hitPointWorld.copy(i),this.shape=s,this.body=o,this.distance=a}}let Nz,kz,Fz,Lz,Bz,Uz,jz;Nz=se.types.SPHERE,kz=se.types.PLANE,Fz=se.types.BOX,Lz=se.types.CYLINDER,Bz=se.types.CONVEXPOLYHEDRON,Uz=se.types.HEIGHTFIELD,jz=se.types.TRIMESH;class Sn{get[Nz](){return this._intersectSphere}get[kz](){return this._intersectPlane}get[Fz](){return this._intersectBox}get[Lz](){return this._intersectConvex}get[Bz](){return this._intersectConvex}get[Uz](){return this._intersectHeightfield}get[jz](){return this._intersectTrimesh}constructor(e,t){void 0===e&&(e=new b),void 0===t&&(t=new b),this.from=e.clone(),this.to=t.clone(),this.direction=new b,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=Sn.ANY,this.result=new Yp,this.hasHit=!1,this.callback=r=>{}}intersectWorld(e,t){return this.mode=t.mode||Sn.ANY,this.result=t.result||new Yp,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=typeof t.collisionFilterMask<"u"?t.collisionFilterMask:-1,this.collisionFilterGroup=typeof t.collisionFilterGroup<"u"?t.collisionFilterGroup:-1,this.checkCollisionResponse=!(typeof t.checkCollisionResponse<"u")||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(Vz),WI.length=0,e.broadphase.aabbQuery(e,Vz,WI),this.intersectBodies(WI),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const r=this.checkCollisionResponse;if(r&&!e.collisionResponse||!(this.collisionFilterGroup&e.collisionFilterMask)||!(e.collisionFilterGroup&this.collisionFilterMask))return;const i=fEe,s=pEe;for(let o=0,a=e.shapes.length;o<a;o++){const c=e.shapes[o];if((!r||c.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],i),i.vadd(e.position,i),this.intersectShape(c,s,i,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let r=0,i=e.length;!this.result.shouldStop&&r<i;r++)this.intersectBody(e[r])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,r,i){if(function DEe(n,e,t){t.vsub(n,Cl);const r=Cl.dot(e);return e.scale(r,Uv),Uv.vadd(n,Uv),t.distanceTo(Uv)}(this.from,this.direction,r)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,t,r,i,e)}_intersectBox(e,t,r,i,s){return this._intersectConvex(e.convexPolyhedronRepresentation,t,r,i,s)}_intersectPlane(e,t,r,i,s){const o=this.from,a=this.to,c=this.direction,l=new b(0,0,1);t.vmult(l,l);const u=new b;o.vsub(r,u);const d=u.dot(l);if(a.vsub(r,u),d*u.dot(l)>0||o.distanceTo(a)<d)return;const f=l.dot(c);if(Math.abs(f)<this.precision)return;const p=new b,g=new b,m=new b;o.vsub(r,p);const y=-l.dot(p)/f;c.scale(y,g),o.vadd(g,m),this.reportIntersection(l,m,s,i,-1)}getAABB(e){const{lowerBound:t,upperBound:r}=e,i=this.to,s=this.from;t.x=Math.min(i.x,s.x),t.y=Math.min(i.y,s.y),t.z=Math.min(i.z,s.z),r.x=Math.max(i.x,s.x),r.y=Math.max(i.y,s.y),r.z=Math.max(i.z,s.z)}_intersectHeightfield(e,t,r,i,s){const o=gEe;o.from.copy(this.from),o.to.copy(this.to),lt.pointToLocalFrame(r,t,o.from,o.from),lt.pointToLocalFrame(r,t,o.to,o.to),o.updateDirection();const a=mEe;let c,l,u,d;c=l=0,u=d=e.data.length-1;const h=new Ut;o.getAABB(h),e.getIndexOfPosition(h.lowerBound.x,h.lowerBound.y,a,!0),c=Math.max(c,a[0]),l=Math.max(l,a[1]),e.getIndexOfPosition(h.upperBound.x,h.upperBound.y,a,!0),u=Math.min(u,a[0]+1),d=Math.min(d,a[1]+1);for(let f=c;f<u;f++)for(let p=l;p<d;p++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(f,p,h),h.overlapsRay(o)){if(e.getConvexTrianglePillar(f,p,!1),lt.pointToWorldFrame(r,t,e.pillarOffset,Bv),this._intersectConvex(e.pillarConvex,t,Bv,i,s,Hz),this.result.shouldStop)return;e.getConvexTrianglePillar(f,p,!0),lt.pointToWorldFrame(r,t,e.pillarOffset,Bv),this._intersectConvex(e.pillarConvex,t,Bv,i,s,Hz)}}}_intersectSphere(e,t,r,i,s){const o=this.from,a=this.to,l=(a.x-o.x)**2+(a.y-o.y)**2+(a.z-o.z)**2,u=2*((a.x-o.x)*(o.x-r.x)+(a.y-o.y)*(o.y-r.y)+(a.z-o.z)*(o.z-r.z)),h=u**2-4*l*((o.x-r.x)**2+(o.y-r.y)**2+(o.z-r.z)**2-e.radius**2),f=_Ee,p=yEe;if(!(h<0))if(0===h)o.lerp(a,h,f),f.vsub(r,p),p.normalize(),this.reportIntersection(p,f,s,i,-1);else{const g=(-u-Math.sqrt(h))/(2*l),m=(-u+Math.sqrt(h))/(2*l);if(g>=0&&g<=1&&(o.lerp(a,g,f),f.vsub(r,p),p.normalize(),this.reportIntersection(p,f,s,i,-1)),this.result.shouldStop)return;m>=0&&m<=1&&(o.lerp(a,m,f),f.vsub(r,p),p.normalize(),this.reportIntersection(p,f,s,i,-1))}}_intersectConvex(e,t,r,i,s,o){const a=vEe,c=zz,l=o&&o.faceList||null,u=e.faces,d=e.vertices,h=e.faceNormals,f=this.direction,p=this.from,m=p.distanceTo(this.to),y=l?l.length:u.length,v=this.result;for(let _=0;!v.shouldStop&&_<y;_++){const E=l?l[_]:_,T=u[E],I=h[E],D=t,M=r;c.copy(d[T[0]]),D.vmult(c,c),c.vadd(M,c),c.vsub(p,c),D.vmult(I,a);const k=f.dot(a);if(Math.abs(k)<this.precision)continue;const B=a.dot(c)/k;if(!(B<0)){f.scale(B,li),li.vadd(p,li),Ss.copy(d[T[0]]),D.vmult(Ss,Ss),M.vadd(Ss,Ss);for(let L=1;!v.shouldStop&&L<T.length-1;L++){fo.copy(d[T[L]]),po.copy(d[T[L+1]]),D.vmult(fo,fo),D.vmult(po,po),M.vadd(fo,fo),M.vadd(po,po);const z=li.distanceTo(p);!Sn.pointInTriangle(li,Ss,fo,po)&&!Sn.pointInTriangle(li,fo,Ss,po)||z>m||this.reportIntersection(a,li,s,i,E)}}}}_intersectTrimesh(e,t,r,i,s,o){const a=EEe,c=IEe,l=MEe,u=zz,d=CEe,h=AEe,f=TEe,p=SEe,g=xEe,m=e.indices,y=this.from,v=this.to,_=this.direction;l.position.copy(r),l.quaternion.copy(t),lt.vectorToLocalFrame(r,t,_,d),lt.pointToLocalFrame(r,t,y,h),lt.pointToLocalFrame(r,t,v,f),f.x*=e.scale.x,f.y*=e.scale.y,f.z*=e.scale.z,h.x*=e.scale.x,h.y*=e.scale.y,h.z*=e.scale.z,f.vsub(h,d),d.normalize();const E=h.distanceSquared(f);e.tree.rayQuery(this,l,c);for(let T=0,I=c.length;!this.result.shouldStop&&T!==I;T++){const D=c[T];e.getNormal(D,a),e.getVertex(m[3*D],Ss),Ss.vsub(h,u);const M=d.dot(a),k=a.dot(u)/M;if(k<0)continue;d.scale(k,li),li.vadd(h,li),e.getVertex(m[3*D+1],fo),e.getVertex(m[3*D+2],po);const B=li.distanceSquared(h);!Sn.pointInTriangle(li,fo,Ss,po)&&!Sn.pointInTriangle(li,Ss,fo,po)||B>E||(lt.vectorToWorldFrame(t,a,g),lt.pointToWorldFrame(r,t,li,p),this.reportIntersection(g,p,s,i,D))}c.length=0}reportIntersection(e,t,r,i,s){const o=this.from,a=this.to,c=o.distanceTo(t),l=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(l.hitFaceIndex=typeof s<"u"?s:-1,this.mode){case Sn.ALL:this.hasHit=!0,l.set(o,a,e,t,r,i,c),l.hasHit=!0,this.callback(l);break;case Sn.CLOSEST:(c<l.distance||!l.hasHit)&&(this.hasHit=!0,l.hasHit=!0,l.set(o,a,e,t,r,i,c));break;case Sn.ANY:this.hasHit=!0,l.hasHit=!0,l.set(o,a,e,t,r,i,c),l.shouldStop=!0}}static pointInTriangle(e,t,r,i){i.vsub(t,Cl),r.vsub(t,Zp),e.vsub(t,$I);const s=Cl.dot(Cl),o=Cl.dot(Zp),a=Cl.dot($I),c=Zp.dot(Zp),l=Zp.dot($I);let u,d;return(u=c*a-o*l)>=0&&(d=s*l-o*a)>=0&&u+d<s*c-o*o}}Sn.CLOSEST=1,Sn.ANY=2,Sn.ALL=4;const Vz=new Ut,WI=[],Zp=new b,$I=new b,fEe=new b,pEe=new _n,li=new b,Ss=new b,fo=new b,po=new b;new b,new Yp;const Hz={faceList:[0]},Bv=new b,gEe=new Sn,mEe=[],_Ee=new b,yEe=new b,vEe=new b,zz=(new b,new b,new b),EEe=new b,CEe=new b,AEe=new b,TEe=new b,xEe=new b,SEe=new b;new Ut;const IEe=[],MEe=new lt,Cl=new b,Uv=new b;new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new Sn,new b,new b,new b,new b(1,0,0),new b(0,1,0),new b(0,0,1),new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new Ut,new b,new Ut,new b,new b,new b,new b,new b,new b,new b,new Ut,new b,new lt,new Ut,new b,new b,new b,new b,new b,new _n,new _n,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new Ut,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new _n,new b,new b,new b,new b,new b,new b,new b,new b,new b,new Ut,new Sn;const jn=globalThis.performance||{};if(!jn.now){let n=Date.now();jn.timing&&jn.timing.navigationStart&&(n=jn.timing.navigationStart),jn.now=()=>Date.now()-n}function KI(){return KI=j(function*(n){console.log("Starting Collisioning");const e=n.filter(o=>!o.scenegraph&&"wireframe"!==o.geometry).map(o=>{const a=new Ve(o.transformMatrix),c=a.transformAsPoint([-1,-1,-1],[]),l=a.transformAsPoint([1,1,1],[]);return{"@id":o["@id"],name:o.tooltip,entityId:o.entityId,bbox:new Ut({lowerBound:new b(...c.map((u,d)=>Math.min(u,l[d]))),upperBound:new b(...l.map((u,d)=>Math.max(u,c[d])))})}}),t=[];for(const o of n.filter(a=>!!a.scenegraph)){const a=yield Dp(o.scenegraph,Gd,{DracoLoader:gI,decompress:!0,postProcess:!0});for(const c of a.scenes??[])Fv(c,new Ve(o.transformMatrix),(l,u)=>{if(l.mesh&&l.mesh.primitives&&l.mesh.primitives.length>0)for(const d of l.mesh.primitives)if(d.attributes.POSITION&&d.attributes.POSITION.min){const h=u.transformAsPoint(d.attributes.POSITION.min,[]),f=u.transformAsPoint(d.attributes.POSITION.max,[]);t.push({"@id":o["@id"],name:l.name,entityId:o.entityId,bbox:new Ut({lowerBound:new b(...h.map((p,g)=>Math.min(p,f[g]))),upperBound:new b(...f.map((p,g)=>Math.max(p,h[g])))}),gltf:a})}return!0})}const r=[],i=[];for(const o of e){const a=[];for(const c of t)o.bbox.overlaps(c.bbox)&&a.push({"@id":c["@id"],name:c.name});a.length>0?r.push({"@id":o.entityId,name:o.name,hits:a}):i.push(o)}console.log({sourceBoxes:e,targetBoxes:t,report:r,sad:i,maxHits:Math.max(...r.map(o=>o.hits.length))});const s=[];for(const o of r){s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":"","Hit Name":""});for(const a of o.hits)s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":a["@id"],"Hit Name":a.name})}return console.log(s),r}),KI.apply(this,arguments)}function JI(n,e,t){if(e&&0!==e.length){let r;switch(t.geometry){case"sphere":r=new Twe;break;case"cone":r=new Mwe;break;case"cylinder":r=new Dwe;break;default:r=new Fwe}return new wS({id:n,pickable:!0,autoHighlight:!1,highlightColor:[30,136,229,255],coordinateSystem:st.CARTESIAN,data:e,mesh:r,wireframe:!1,getColor:i=>i.color||[255,255,255,229.5],getTransformMatrix:i=>i.transformMatrix,...t})}}function gG(n,e,t){if(e&&0!==e.length)return new _S({id:n,pickable:!0,data:e.map(r=>({...r,position:new Ve(r.transformMatrix).getTranslation()})),getText:r=>r.text,getPosition:r=>r.position,getColor:r=>r.color,...t})}new b;let kTe=(()=>{class n extends hS{static layerName="BodyUILayer";static gltfCache={};initializeState(){const{data:t}=this.props;this.setState({data:t??[],zoomOpacity:.8,doCollisions:!1}),Tz()}renderLayers(){const t=this.state,r={sphere:[],cone:[],cylinder:[],cube:[],text:[],wireframe:[],scenegraph:[]};for(const o of t.data){const a=o.geometry??"cube";o.scenegraph?r.scenegraph.push(o):void 0!==r[a]&&r[a].push(o)}const i={};for(const o of r.scenegraph)o.scenegraph&&o.scenegraphNode&&!Object.prototype.hasOwnProperty.call(i,o.scenegraph)&&(i[o.scenegraph]=Sz({scenegraph:o.scenegraph},n.gltfCache));const s=[];for(const[o,a]of Object.entries(r))if("scenegraph"===o)for(const c of a)s.push(new FI({id:"models-"+c["@id"],opacity:c.zoomBasedOpacity?t.zoomOpacity:c.opacity??1,pickable:!c.unpickable,coordinateSystem:st.CARTESIAN,data:[c],scenegraph:c.scenegraphNode?Lwe(c.scenegraphNode,i[c.scenegraph]):c.scenegraph,_lighting:c._lighting,getTransformMatrix:c.transformMatrix,getColor:c.color??[0,255,0,127.5],parameters:{depthMask:!c.zoomBasedOpacity&&(void 0===c.opacity||1===c.opacity)}}));else"text"===o?(s.push(gG("text",a.filter(c=>c.unpickable),{pickable:!1})),s.push(gG("textPickable",a.filter(c=>!c.unpickable),{pickable:!0}))):"wireframe"===o?s.push(JI(o,a,{wireframe:!0,pickable:!1,geometry:o})):(s.push(JI(o,a.filter(c=>c.unpickable),{wireframe:!1,pickable:!1,geometry:o})),s.push(JI(`${o}Pickable`,a.filter(c=>!c.unpickable),{wireframe:!1,pickable:!0,geometry:o})));return t.doCollisions&&function NTe(n){KI.apply(this,arguments)}(t.data),s.filter(o=>!!o)}getPickingInfo(t){return t.info}}return n})();function mG(n,e=[]){for(const t of n.nodes||n.children||[])e.push(t.name),mG(t,e);return e}function QI(){return QI=j(function*(n,e,t,r){Tz();const i=yield Sz({scenegraph:n,scenegraphNode:t},r),s={},o=[];e=new Ve(e??Ve.IDENTITY);for(const a of i.scenes)Fv(a,e,(c,l)=>{const u={"@id":c.name||c.id,"@type":"ProcessedNode",transformMatrix:new Ve(l),geometry:"wireframe",node:c};if(o.push({"@id":`GLTF:${u["@id"]}`,"@type":"GLTFNode",scenegraph:n,scenegraphNode:u["@id"],transformMatrix:new Ve(e||Ve.IDENTITY),tooltip:c.name||c.id,color:[255,255,255,255],_lighting:"pbr",zoomBasedOpacity:!0,node:c}),c.mesh&&c.mesh.primitives&&c.mesh.primitives.length>0)for(const d of c.mesh.primitives)if(d.attributes.POSITION&&d.attributes.POSITION.min){const h=l.transformAsPoint(d.attributes.POSITION.min,[]),f=l.transformAsPoint(d.attributes.POSITION.max,[]);u.bbox=new Ut({lowerBound:new b(...h.map((p,g)=>Math.min(p,f[g]))),upperBound:new b(...f.map((p,g)=>Math.max(p,h[g])))})}return s[u["@id"]]=u,!0});for(const a of Object.values(s).filter(c=>!c.bbox)){for(const c of mG(a.node).map(l=>s[l]).filter(l=>l.bbox))a.bbox?a.bbox.extend(c.bbox):a.bbox=c.bbox.clone();a.bbox||delete s[a["@id"]]}for(const a of Object.values(s)){const c=a.bbox.lowerBound,d=(a.size=a.bbox.upperBound.clone().vsub(c)).clone().vmul(new b(.5,.5,.5)),h=a.center=c.clone().vadd(d);a.transformMatrix=new Ve(Ve.IDENTITY).translate(h.toArray()).scale(d.toArray())}for(const a of o)s[a["@id"]]=a;return s}),QI.apply(this,arguments)}class LTe{deckProps;deck;bodyUILayer=new kTe({});nodeClickSubject=new fe;nodeHoverStartSubject=new fe;nodeHoverStopSubject=new fe;sceneRotationSubject=new Qt([0,0]);nodeDragStartSubject=new fe;nodeDragSubject=new fe;nodeDragEndSubject=new fe;nodeClick$=this.nodeClickSubject.pipe(ta());nodeHoverStart$=this.nodeHoverStartSubject.pipe(ta());nodeHoverStop$=this.nodeHoverStopSubject.pipe(ta());sceneRotation$=this.sceneRotationSubject.pipe(ta());nodeDragStart$=this.nodeDragStartSubject.pipe(ta());nodeDrag$=this.nodeDragSubject.pipe(ta());nodeDragEnd$=this.nodeDragEndSubject.pipe(ta());cursor;lastHovered;constructor(e){this.deckProps=e;const t={...e,views:["orthographic"===e.camera?new mT({flipY:!1,near:-1e3}):new NU({orbitAxis:"Y"})],controller:e.interactive??!0,layers:[this.bodyUILayer],onHover:this._onHover,onClick:this._onClick,onViewStateChange:this._onViewStateChange,onDragStart:this._onDragStart,onDrag:this._onDrag,onDragEnd:this._onDragEnd,getCursor:r=>this.cursor??(r.isDragging?"grabbing":"grab")};e.legacyLighting&&(t.effects=[new KT({ambientLight:new H3({color:[255,255,255],intensity:10})})]),this.deck=new Jx(t),this.deck.setProps({viewState:{orbitAxis:"Y",minRotationX:e.minRotationX??-15,maxRotationX:e.maxRotationX??15,target:e.target??[.5,.5,0],rotationX:0,rotationOrbit:e.rotation??0,zoom:e.zoom??9.5,camera:e.camera}}),e.rotation&&this.sceneRotationSubject.next([e.rotation,0])}initialize(){var e=this;return j(function*(){for(;!e.bodyUILayer.state;)yield new Promise(t=>{setTimeout(t,200)})})()}finalize(){this.deck.finalize()}setScene(e){if(e?.length>0){let t=this.bodyUILayer.state.zoomOpacity,r=!1;for(const i of e)i.zoomToOnLoad&&(this.zoomTo(i),r=!0);t=r?.05:t,this.deckProps.debugSceneNodeProcessing?this.debugSceneNodeProcessing(e,t):this.bodyUILayer.setState({data:e,zoomOpacity:t})}}debugSceneNodeProcessing(e,t){const r="https://hubmapconsortium.github.io/ccf-3d-reference-object-library/VH_Female/United/VHF_United_Color.glb",i=new Ve([.076,0,0,0,0,.076,16875389974302382e-33,0,0,-16875389974302382e-33,.076,0,.49,.034,.11,1]);(function FTe(n,e,t,r){return QI.apply(this,arguments)})(r,i,"VHF_Kidney_L_Low1").then(s=>{console.log("results",s),console.log("data",e),(e=e.concat(Object.values(s))).push({"@id":"TEST","@type":"TEST",scenegraph:r,scenegraphNode:"VHF_Kidney_R_Low",transformMatrix:i,color:[255,255,255,200],_lighting:"pbr",zoomBasedOpacity:!1}),this.bodyUILayer.setState({data:e,zoomOpacity:t})})}zoomTo(e){const t=new Ve(e.transformMatrix);this.deck.setProps({viewState:{...this.deck.props.viewState,target:t.getTranslation(),rotationX:0,rotationOrbit:0,zoom:11.5}})}setRotation(e){this.deck.setProps({viewState:{...this.deck.props.viewState,rotationOrbit:e}})}setRotationX(e){this.deck.setProps({viewState:{...this.deck.props.viewState,rotationX:e}})}setZoom(e){this.deck.setProps({viewState:{...this.deck.props.viewState,zoom:e}})}setTarget(e){this.deck.setProps({viewState:{...this.deck.props.viewState,target:e}})}setInteractive(e){this.deck.setProps({controller:e})}_onHover=e=>{const{lastHovered:t}=this;this.cursor=e.picked?"pointer":void 0,e.picked&&e.object?.["@id"]?t!==e.object&&(t&&this.nodeHoverStopSubject.next(t),this.lastHovered=e.object,this.nodeHoverStartSubject.next(e.object)):t&&(this.nodeHoverStopSubject.next(t),this.lastHovered=void 0)};_onClick=(e,t)=>{e.picked&&e.object?.["@id"]&&this.nodeClickSubject.next({node:e.object,ctrlClick:t?.srcEvent?.ctrlKey??void 0})};_onViewStateChange=e=>{if(e.interactionState?.isZooming){const t=this.bodyUILayer.state,r=Math.min(Math.max(1-(e.viewState.zoom-8.9)/2,.05),1);t.zoomOpacity!==r&&this.bodyUILayer.setState({data:t.data,zoomOpacity:r})}this.deck.setProps({viewState:{...e.viewState}}),this.sceneRotationSubject.next([e.viewState.rotationOrbit,e.viewState.rotationX])};_onDragStart=(e,t)=>{this._dragEvent(e,t,this.nodeDragStartSubject)};_onDrag=(e,t)=>{this._dragEvent(e,t,this.nodeDragSubject)};_onDragEnd=(e,t)=>{this._dragEvent(e,t,this.nodeDragEndSubject)};_dragEvent(e,t,r){e?.object?.["@id"]&&r.next({node:e.object,info:e,e:t})}}var ot;!function(n){n.assertEqual=i=>i,n.assertIs=function e(i){},n.assertNever=function t(i){throw new Error},n.arrayToEnum=i=>{const s={};for(const o of i)s[o]=o;return s},n.getValidEnumValues=i=>{const s=n.objectKeys(i).filter(a=>"number"!=typeof i[i[a]]),o={};for(const a of s)o[a]=i[a];return n.objectValues(o)},n.objectValues=i=>n.objectKeys(i).map(function(s){return i[s]}),n.objectKeys="function"==typeof Object.keys?i=>Object.keys(i):i=>{const s=[];for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&s.push(o);return s},n.find=(i,s)=>{for(const o of i)if(s(o))return o},n.isInteger="function"==typeof Number.isInteger?i=>Number.isInteger(i):i=>"number"==typeof i&&isFinite(i)&&Math.floor(i)===i,n.joinValues=function r(i,s=" | "){return i.map(o=>"string"==typeof o?`'${o}'`:o).join(s)},n.jsonStringifyReplacer=(i,s)=>"bigint"==typeof s?s.toString():s}(ot||(ot={}));var _G=function(n){return n.mergeShapes=(e,t)=>({...e,...t}),n}(_G||{});const ae=ot.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),aa=n=>{switch(typeof n){case"undefined":return ae.undefined;case"string":return ae.string;case"number":return isNaN(n)?ae.nan:ae.number;case"boolean":return ae.boolean;case"function":return ae.function;case"bigint":return ae.bigint;case"symbol":return ae.symbol;case"object":return Array.isArray(n)?ae.array:null===n?ae.null:n.then&&"function"==typeof n.then&&n.catch&&"function"==typeof n.catch?ae.promise:typeof Map<"u"&&n instanceof Map?ae.map:typeof Set<"u"&&n instanceof Set?ae.set:typeof Date<"u"&&n instanceof Date?ae.date:ae.object;default:return ae.unknown}},q=ot.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);let ca=(()=>{class n extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(o){return o.message},i={_errors:[]},s=o=>{for(const a of o.issues)if("invalid_union"===a.code)a.unionErrors.map(s);else if("invalid_return_type"===a.code)s(a.returnTypeError);else if("invalid_arguments"===a.code)s(a.argumentsError);else if(0===a.path.length)i._errors.push(r(a));else{let c=i,l=0;for(;l<a.path.length;){const u=a.path[l];l===a.path.length-1?(c[u]=c[u]||{_errors:[]},c[u]._errors.push(r(a))):c[u]=c[u]||{_errors:[]},c=c[u],l++}}};return s(this),i}static assert(t){if(!(t instanceof n))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ot.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(t=r=>r.message){const r={},i=[];for(const s of this.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(t(s))):i.push(t(s));return{formErrors:i,fieldErrors:r}}get formErrors(){return this.flatten()}}return n.create=e=>new n(e),n})();const Xd=(n,e)=>{let t;switch(n.code){case q.invalid_type:t=n.received===ae.undefined?"Required":`Expected ${n.expected}, received ${n.received}`;break;case q.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,ot.jsonStringifyReplacer)}`;break;case q.unrecognized_keys:t=`Unrecognized key(s) in object: ${ot.joinValues(n.keys,", ")}`;break;case q.invalid_union:t="Invalid input";break;case q.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${ot.joinValues(n.options)}`;break;case q.invalid_enum_value:t=`Invalid enum value. Expected ${ot.joinValues(n.options)}, received '${n.received}'`;break;case q.invalid_arguments:t="Invalid function arguments";break;case q.invalid_return_type:t="Invalid function return type";break;case q.invalid_date:t="Invalid date";break;case q.invalid_string:"object"==typeof n.validation?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,"number"==typeof n.validation.position&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:ot.assertNever(n.validation):t="regex"!==n.validation?`Invalid ${n.validation}`:"Invalid";break;case q.too_small:t="array"===n.type?`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:"string"===n.type?`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:"number"===n.type?`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:"date"===n.type?`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:"Invalid input";break;case q.too_big:t="array"===n.type?`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:"string"===n.type?`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:"number"===n.type?`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:"bigint"===n.type?`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:"date"===n.type?`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:"Invalid input";break;case q.custom:t="Invalid input";break;case q.invalid_intersection_types:t="Intersection results could not be merged";break;case q.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case q.not_finite:t="Number must be finite";break;default:t=e.defaultError,ot.assertNever(n)}return{message:t}};let yG=Xd;function Xv(){return yG}const Yv=n=>{const{data:e,path:t,errorMaps:r,issueData:i}=n,s=[...t,...i.path||[]],o={...i,path:s};if(void 0!==i.message)return{...i,path:s,message:i.message};let a="";const c=r.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...i,path:s,message:a}};function re(n,e){const t=Xv(),r=Yv({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===Xd?void 0:Xd].filter(i=>!!i)});n.common.issues.push(r)}class Tr{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const i of t){if("aborted"===i.status)return Re;"dirty"===i.status&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static mergeObjectAsync(e,t){return j(function*(){const r=[];for(const i of t){const s=yield i.key,o=yield i.value;r.push({key:s,value:o})}return Tr.mergeObjectSync(e,r)})()}static mergeObjectSync(e,t){const r={};for(const i of t){const{key:s,value:o}=i;if("aborted"===s.status||"aborted"===o.status)return Re;"dirty"===s.status&&e.dirty(),"dirty"===o.status&&e.dirty(),"__proto__"!==s.value&&(typeof o.value<"u"||i.alwaysSet)&&(r[s.value]=o.value)}return{status:e.value,value:r}}}const Re=Object.freeze({status:"aborted"}),Yd=n=>({status:"dirty",value:n}),zr=n=>({status:"valid",value:n}),eM=n=>"aborted"===n.status,tM=n=>"dirty"===n.status,Sl=n=>"valid"===n.status,rg=n=>typeof Promise<"u"&&n instanceof Promise;function Zv(n,e,t,r){if("a"===t&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?r:"a"===t?r.call(n):r?r.value:e.get(n)}function vG(n,e,t,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(n,t):i?i.value=t:e.set(n,t),t}"function"==typeof SuppressedError&&SuppressedError;var ig,sg,ge=function(n){return n.errToObj=e=>"string"==typeof e?{message:e}:e||{},n.toString=e=>"string"==typeof e?e:e?.message,n}(ge||{});class mo{constructor(e,t,r,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const bG=(n,e)=>{if(Sl(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new ca(n.common.issues);return this._error=t,this._error}}};function Be(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:i}=n;if(e&&(t||r))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return e?{errorMap:e,description:i}:{errorMap:(o,a)=>{var c,l;const{message:u}=n;return"invalid_enum_value"===o.code?{message:u??a.defaultError}:typeof a.data>"u"?{message:null!==(c=u??r)&&void 0!==c?c:a.defaultError}:"invalid_type"!==o.code?{message:a.defaultError}:{message:null!==(l=u??t)&&void 0!==l?l:a.defaultError}},description:i}}class Ge{get description(){return this._def.description}_getType(e){return aa(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:aa(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Tr,ctx:{common:e.parent.common,data:e.data,parsedType:aa(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(rg(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const i={common:{issues:[],async:null!==(r=t?.async)&&void 0!==r&&r,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:aa(e)},s=this._parseSync({data:e,path:i.path,parent:i});return bG(i,s)}"~validate"(e){var t,r;const i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:aa(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:i});return Sl(s)?{value:s.value}:{issues:i.common.issues}}catch(s){!(null===(r=null===(t=s?.message)||void 0===t?void 0:t.toLowerCase())||void 0===r)&&r.includes("encountered")&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:i}).then(s=>Sl(s)?{value:s.value}:{issues:i.common.issues})}parseAsync(e,t){var r=this;return j(function*(){const i=yield r.safeParseAsync(e,t);if(i.success)return i.data;throw i.error})()}safeParseAsync(e,t){var r=this;return j(function*(){const i={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:r._def.errorMap,parent:null,data:e,parsedType:aa(e)},s=r._parse({data:e,path:i.path,parent:i}),o=yield rg(s)?s:Promise.resolve(s);return bG(i,o)})()}refine(e,t){const r=i=>"string"==typeof t||typeof t>"u"?{message:t}:"function"==typeof t?t(i):t;return this._refinement((i,s)=>{const o=e(i),a=()=>s.addIssue({code:q.custom,...r(i)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>!!c||(a(),!1)):!!o||(a(),!1)})}refinement(e,t){return this._refinement((r,i)=>!!e(r)||(i.addIssue("function"==typeof t?t(r,i):t),!1))}_refinement(e){return new Ml({schema:this,typeName:Oe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return _c.create(this,this._def)}nullable(){return eh.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ag.create(this)}promise(){return eb.create(this,this._def)}or(e){return lM.create([this,e],this._def)}and(e){return dM.create(this,e,this._def)}transform(e){return new Ml({...Be(this._def),schema:this,typeName:Oe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new pM({...Be(this._def),innerType:this,defaultValue:t,typeName:Oe.ZodDefault})}brand(){return new mM({typeName:Oe.ZodBranded,type:this,...Be(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new gM({...Be(this._def),innerType:this,catchValue:t,typeName:Oe.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return ug.create(this,e)}readonly(){return _M.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const VTe=/^c[^\s-]{8,}$/i,HTe=/^[0-9a-z]+$/,zTe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,GTe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,WTe=/^[a-z0-9_-]{21}$/i,$Te=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,qTe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,XTe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let nM;const ZTe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,KTe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,JTe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,QTe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,exe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,txe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,wG="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",nxe=new RegExp(`^${wG}$`);function EG(n){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return n.precision?e=`${e}\\.\\d{${n.precision}}`:null==n.precision&&(e=`${e}(\\.\\d+)?`),e}function rxe(n){return new RegExp(`^${EG(n)}$`)}function CG(n){let e=`${wG}T${EG(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function ixe(n,e){return!(("v4"!==e&&e||!ZTe.test(n))&&("v6"!==e&&e||!JTe.test(n)))}function sxe(n,e){if(!$Te.test(n))return!1;try{const[t]=n.split("."),r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),i=JSON.parse(atob(r));return!("object"!=typeof i||null===i||!i.typ||!i.alg||e&&i.alg!==e)}catch{return!1}}function oxe(n,e){return!(("v4"!==e&&e||!KTe.test(n))&&("v6"!==e&&e||!QTe.test(n)))}let Kv=(()=>{class n extends Ge{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==ae.string){const o=this._getOrReturnCtx(t);return re(o,{code:q.invalid_type,expected:ae.string,received:o.parsedType}),Re}const i=new Tr;let s;for(const o of this._def.checks)if("min"===o.kind)t.data.length<o.value&&(s=this._getOrReturnCtx(t,s),re(s,{code:q.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),i.dirty());else if("max"===o.kind)t.data.length>o.value&&(s=this._getOrReturnCtx(t,s),re(s,{code:q.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),i.dirty());else if("length"===o.kind){const a=t.data.length>o.value,c=t.data.length<o.value;(a||c)&&(s=this._getOrReturnCtx(t,s),a?re(s,{code:q.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):c&&re(s,{code:q.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),i.dirty())}else if("email"===o.kind)XTe.test(t.data)||(s=this._getOrReturnCtx(t,s),re(s,{validation:"email",code:q.invalid_string,message:o.message}),i.dirty());else if("emoji"===o.kind)nM||(nM=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),nM.test(t.data)||(s=this._getOrReturnCtx(t,s),re(s,{validation:"emoji",code:q.invalid_string,message:o.message}),i.dirty());else if("uuid"===o.kind)GTe.test(t.data)||(s=this._getOrReturnCtx(t,s),re(s,{validation:"uuid",code:q.invalid_string,message:o.message}),i.dirty());else if("nanoid"===o.kind)WTe.test(t.data)||(s=this._getOrReturnCtx(t,s),re(s,{validation:"nanoid",code:q.invalid_string,message:o.message}),i.dirty());else if("cuid"===o.kind)VTe.test(t.data)||(s=this._getOrReturnCtx(t,s),re(s,{validation:"cuid",code:q.invalid_string,message:o.message}),i.dirty());else if("cuid2"===o.kind)HTe.test(t.data)||(s=this._getOrReturnCtx(t,s),re(s,{validation:"cuid2",code:q.invalid_string,message:o.message}),i.dirty());else if("ulid"===o.kind)zTe.test(t.data)||(s=this._getOrReturnCtx(t,s),re(s,{validation:"ulid",code:q.invalid_string,message:o.message}),i.dirty());else if("url"===o.kind)try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),re(s,{validation:"url",code:q.invalid_string,message:o.message}),i.dirty()}else"regex"===o.kind?(o.regex.lastIndex=0,o.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),re(s,{validation:"regex",code:q.invalid_string,message:o.message}),i.dirty())):"trim"===o.kind?t.data=t.data.trim():"includes"===o.kind?t.data.includes(o.value,o.position)||(s=this._getOrReturnCtx(t,s),re(s,{code:q.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),i.dirty()):"toLowerCase"===o.kind?t.data=t.data.toLowerCase():"toUpperCase"===o.kind?t.data=t.data.toUpperCase():"startsWith"===o.kind?t.data.startsWith(o.value)||(s=this._getOrReturnCtx(t,s),re(s,{code:q.invalid_string,validation:{startsWith:o.value},message:o.message}),i.dirty()):"endsWith"===o.kind?t.data.endsWith(o.value)||(s=this._getOrReturnCtx(t,s),re(s,{code:q.invalid_string,validation:{endsWith:o.value},message:o.message}),i.dirty()):"datetime"===o.kind?CG(o).test(t.data)||(s=this._getOrReturnCtx(t,s),re(s,{code:q.invalid_string,validation:"datetime",message:o.message}),i.dirty()):"date"===o.kind?nxe.test(t.data)||(s=this._getOrReturnCtx(t,s),re(s,{code:q.invalid_string,validation:"date",message:o.message}),i.dirty()):"time"===o.kind?rxe(o).test(t.data)||(s=this._getOrReturnCtx(t,s),re(s,{code:q.invalid_string,validation:"time",message:o.message}),i.dirty()):"duration"===o.kind?qTe.test(t.data)||(s=this._getOrReturnCtx(t,s),re(s,{validation:"duration",code:q.invalid_string,message:o.message}),i.dirty()):"ip"===o.kind?ixe(t.data,o.version)||(s=this._getOrReturnCtx(t,s),re(s,{validation:"ip",code:q.invalid_string,message:o.message}),i.dirty()):"jwt"===o.kind?sxe(t.data,o.alg)||(s=this._getOrReturnCtx(t,s),re(s,{validation:"jwt",code:q.invalid_string,message:o.message}),i.dirty()):"cidr"===o.kind?oxe(t.data,o.version)||(s=this._getOrReturnCtx(t,s),re(s,{validation:"cidr",code:q.invalid_string,message:o.message}),i.dirty()):"base64"===o.kind?exe.test(t.data)||(s=this._getOrReturnCtx(t,s),re(s,{validation:"base64",code:q.invalid_string,message:o.message}),i.dirty()):"base64url"===o.kind?txe.test(t.data)||(s=this._getOrReturnCtx(t,s),re(s,{validation:"base64url",code:q.invalid_string,message:o.message}),i.dirty()):ot.assertNever(o);return{status:i.value,value:t.data}}_regex(t,r,i){return this.refinement(s=>t.test(s),{validation:r,code:q.invalid_string,...ge.errToObj(i)})}_addCheck(t){return new n({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...ge.errToObj(t)})}url(t){return this._addCheck({kind:"url",...ge.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...ge.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...ge.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...ge.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...ge.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...ge.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...ge.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...ge.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...ge.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...ge.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...ge.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...ge.errToObj(t)})}datetime(t){var r,i;return this._addCheck("string"==typeof t?{kind:"datetime",precision:null,offset:!1,local:!1,message:t}:{kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:null!==(r=t?.offset)&&void 0!==r&&r,local:null!==(i=t?.local)&&void 0!==i&&i,...ge.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return this._addCheck("string"==typeof t?{kind:"time",precision:null,message:t}:{kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,...ge.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",...ge.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...ge.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r?.position,...ge.errToObj(r?.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...ge.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...ge.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...ge.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...ge.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...ge.errToObj(r)})}nonempty(t){return this.min(1,ge.errToObj(t))}trim(){return new n({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new n({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new n({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>"datetime"===t.kind)}get isDate(){return!!this._def.checks.find(t=>"date"===t.kind)}get isTime(){return!!this._def.checks.find(t=>"time"===t.kind)}get isDuration(){return!!this._def.checks.find(t=>"duration"===t.kind)}get isEmail(){return!!this._def.checks.find(t=>"email"===t.kind)}get isURL(){return!!this._def.checks.find(t=>"url"===t.kind)}get isEmoji(){return!!this._def.checks.find(t=>"emoji"===t.kind)}get isUUID(){return!!this._def.checks.find(t=>"uuid"===t.kind)}get isNANOID(){return!!this._def.checks.find(t=>"nanoid"===t.kind)}get isCUID(){return!!this._def.checks.find(t=>"cuid"===t.kind)}get isCUID2(){return!!this._def.checks.find(t=>"cuid2"===t.kind)}get isULID(){return!!this._def.checks.find(t=>"ulid"===t.kind)}get isIP(){return!!this._def.checks.find(t=>"ip"===t.kind)}get isCIDR(){return!!this._def.checks.find(t=>"cidr"===t.kind)}get isBase64(){return!!this._def.checks.find(t=>"base64"===t.kind)}get isBase64url(){return!!this._def.checks.find(t=>"base64url"===t.kind)}get minLength(){let t=null;for(const r of this._def.checks)"min"===r.kind&&(null===t||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)"max"===r.kind&&(null===t||r.value<t)&&(t=r.value);return t}}return n.create=e=>{var t;return new n({checks:[],typeName:Oe.ZodString,coerce:null!==(t=e?.coerce)&&void 0!==t&&t,...Be(e)})},n})();function axe(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=t>r?t:r;return parseInt(n.toFixed(i).replace(".",""))%parseInt(e.toFixed(i).replace(".",""))/Math.pow(10,i)}let rM=(()=>{class n extends Ge{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==ae.number){const o=this._getOrReturnCtx(t);return re(o,{code:q.invalid_type,expected:ae.number,received:o.parsedType}),Re}let i;const s=new Tr;for(const o of this._def.checks)"int"===o.kind?ot.isInteger(t.data)||(i=this._getOrReturnCtx(t,i),re(i,{code:q.invalid_type,expected:"integer",received:"float",message:o.message}),s.dirty()):"min"===o.kind?(o.inclusive?t.data<o.value:t.data<=o.value)&&(i=this._getOrReturnCtx(t,i),re(i,{code:q.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):"max"===o.kind?(o.inclusive?t.data>o.value:t.data>=o.value)&&(i=this._getOrReturnCtx(t,i),re(i,{code:q.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):"multipleOf"===o.kind?0!==axe(t.data,o.value)&&(i=this._getOrReturnCtx(t,i),re(i,{code:q.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):"finite"===o.kind?Number.isFinite(t.data)||(i=this._getOrReturnCtx(t,i),re(i,{code:q.not_finite,message:o.message}),s.dirty()):ot.assertNever(o);return{status:s.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,ge.toString(r))}gt(t,r){return this.setLimit("min",t,!1,ge.toString(r))}lte(t,r){return this.setLimit("max",t,!0,ge.toString(r))}lt(t,r){return this.setLimit("max",t,!1,ge.toString(r))}setLimit(t,r,i,s){return new n({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:ge.toString(s)}]})}_addCheck(t){return new n({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:ge.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ge.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ge.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ge.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ge.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:ge.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:ge.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ge.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ge.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)"min"===r.kind&&(null===t||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)"max"===r.kind&&(null===t||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>"int"===t.kind||"multipleOf"===t.kind&&ot.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const i of this._def.checks){if("finite"===i.kind||"int"===i.kind||"multipleOf"===i.kind)return!0;"min"===i.kind?(null===r||i.value>r)&&(r=i.value):"max"===i.kind&&(null===t||i.value<t)&&(t=i.value)}return Number.isFinite(r)&&Number.isFinite(t)}}return n.create=e=>new n({checks:[],typeName:Oe.ZodNumber,coerce:e?.coerce||!1,...Be(e)}),n})(),iM=(()=>{class n extends Ge{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==ae.bigint)return this._getInvalidInput(t);let i;const s=new Tr;for(const o of this._def.checks)"min"===o.kind?(o.inclusive?t.data<o.value:t.data<=o.value)&&(i=this._getOrReturnCtx(t,i),re(i,{code:q.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):"max"===o.kind?(o.inclusive?t.data>o.value:t.data>=o.value)&&(i=this._getOrReturnCtx(t,i),re(i,{code:q.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):"multipleOf"===o.kind?t.data%o.value!==BigInt(0)&&(i=this._getOrReturnCtx(t,i),re(i,{code:q.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):ot.assertNever(o);return{status:s.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return re(r,{code:q.invalid_type,expected:ae.bigint,received:r.parsedType}),Re}gte(t,r){return this.setLimit("min",t,!0,ge.toString(r))}gt(t,r){return this.setLimit("min",t,!1,ge.toString(r))}lte(t,r){return this.setLimit("max",t,!0,ge.toString(r))}lt(t,r){return this.setLimit("max",t,!1,ge.toString(r))}setLimit(t,r,i,s){return new n({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:ge.toString(s)}]})}_addCheck(t){return new n({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ge.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ge.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ge.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ge.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:ge.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)"min"===r.kind&&(null===t||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)"max"===r.kind&&(null===t||r.value<t)&&(t=r.value);return t}}return n.create=e=>{var t;return new n({checks:[],typeName:Oe.ZodBigInt,coerce:null!==(t=e?.coerce)&&void 0!==t&&t,...Be(e)})},n})(),sM=(()=>{class n extends Ge{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==ae.boolean){const i=this._getOrReturnCtx(t);return re(i,{code:q.invalid_type,expected:ae.boolean,received:i.parsedType}),Re}return zr(t.data)}}return n.create=e=>new n({typeName:Oe.ZodBoolean,coerce:e?.coerce||!1,...Be(e)}),n})(),oM=(()=>{class n extends Ge{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==ae.date){const o=this._getOrReturnCtx(t);return re(o,{code:q.invalid_type,expected:ae.date,received:o.parsedType}),Re}if(isNaN(t.data.getTime()))return re(this._getOrReturnCtx(t),{code:q.invalid_date}),Re;const i=new Tr;let s;for(const o of this._def.checks)"min"===o.kind?t.data.getTime()<o.value&&(s=this._getOrReturnCtx(t,s),re(s,{code:q.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),i.dirty()):"max"===o.kind?t.data.getTime()>o.value&&(s=this._getOrReturnCtx(t,s),re(s,{code:q.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),i.dirty()):ot.assertNever(o);return{status:i.value,value:new Date(t.data.getTime())}}_addCheck(t){return new n({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:ge.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:ge.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)"min"===r.kind&&(null===t||r.value>t)&&(t=r.value);return null!=t?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)"max"===r.kind&&(null===t||r.value<t)&&(t=r.value);return null!=t?new Date(t):null}}return n.create=e=>new n({checks:[],coerce:e?.coerce||!1,typeName:Oe.ZodDate,...Be(e)}),n})(),AG=(()=>{class n extends Ge{_parse(t){if(this._getType(t)!==ae.symbol){const i=this._getOrReturnCtx(t);return re(i,{code:q.invalid_type,expected:ae.symbol,received:i.parsedType}),Re}return zr(t.data)}}return n.create=e=>new n({typeName:Oe.ZodSymbol,...Be(e)}),n})(),aM=(()=>{class n extends Ge{_parse(t){if(this._getType(t)!==ae.undefined){const i=this._getOrReturnCtx(t);return re(i,{code:q.invalid_type,expected:ae.undefined,received:i.parsedType}),Re}return zr(t.data)}}return n.create=e=>new n({typeName:Oe.ZodUndefined,...Be(e)}),n})(),cM=(()=>{class n extends Ge{_parse(t){if(this._getType(t)!==ae.null){const i=this._getOrReturnCtx(t);return re(i,{code:q.invalid_type,expected:ae.null,received:i.parsedType}),Re}return zr(t.data)}}return n.create=e=>new n({typeName:Oe.ZodNull,...Be(e)}),n})(),Jv=(()=>{class n extends Ge{constructor(){super(...arguments),this._any=!0}_parse(t){return zr(t.data)}}return n.create=e=>new n({typeName:Oe.ZodAny,...Be(e)}),n})(),og=(()=>{class n extends Ge{constructor(){super(...arguments),this._unknown=!0}_parse(t){return zr(t.data)}}return n.create=e=>new n({typeName:Oe.ZodUnknown,...Be(e)}),n})(),Il=(()=>{class n extends Ge{_parse(t){const r=this._getOrReturnCtx(t);return re(r,{code:q.invalid_type,expected:ae.never,received:r.parsedType}),Re}}return n.create=e=>new n({typeName:Oe.ZodNever,...Be(e)}),n})(),TG=(()=>{class n extends Ge{_parse(t){if(this._getType(t)!==ae.undefined){const i=this._getOrReturnCtx(t);return re(i,{code:q.invalid_type,expected:ae.void,received:i.parsedType}),Re}return zr(t.data)}}return n.create=e=>new n({typeName:Oe.ZodVoid,...Be(e)}),n})(),ag=(()=>{class n extends Ge{_parse(t){const{ctx:r,status:i}=this._processInputParams(t),s=this._def;if(r.parsedType!==ae.array)return re(r,{code:q.invalid_type,expected:ae.array,received:r.parsedType}),Re;if(null!==s.exactLength){const a=r.data.length>s.exactLength.value,c=r.data.length<s.exactLength.value;(a||c)&&(re(r,{code:a?q.too_big:q.too_small,minimum:c?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),i.dirty())}if(null!==s.minLength&&r.data.length<s.minLength.value&&(re(r,{code:q.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),i.dirty()),null!==s.maxLength&&r.data.length>s.maxLength.value&&(re(r,{code:q.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),i.dirty()),r.common.async)return Promise.all([...r.data].map((a,c)=>s.type._parseAsync(new mo(r,a,r.path,c)))).then(a=>Tr.mergeArray(i,a));const o=[...r.data].map((a,c)=>s.type._parseSync(new mo(r,a,r.path,c)));return Tr.mergeArray(i,o)}get element(){return this._def.type}min(t,r){return new n({...this._def,minLength:{value:t,message:ge.toString(r)}})}max(t,r){return new n({...this._def,maxLength:{value:t,message:ge.toString(r)}})}length(t,r){return new n({...this._def,exactLength:{value:t,message:ge.toString(r)}})}nonempty(t){return this.min(1,t)}}return n.create=(e,t)=>new n({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Oe.ZodArray,...Be(t)}),n})();function Zd(n){if(n instanceof Kd){const e={};for(const t in n.shape)e[t]=_c.create(Zd(n.shape[t]));return new Kd({...n._def,shape:()=>e})}return n instanceof ag?new ag({...n._def,type:Zd(n.element)}):n instanceof _c?_c.create(Zd(n.unwrap())):n instanceof eh?eh.create(Zd(n.unwrap())):n instanceof Jd?Jd.create(n.items.map(e=>Zd(e))):n}let Kd=(()=>{class n extends Ge{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const t=this._def.shape(),r=ot.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==ae.object){const u=this._getOrReturnCtx(t);return re(u,{code:q.invalid_type,expected:ae.object,received:u.parsedType}),Re}const{status:i,ctx:s}=this._processInputParams(t),{shape:o,keys:a}=this._getCached(),c=[];if(!(this._def.catchall instanceof Il&&"strip"===this._def.unknownKeys))for(const u in s.data)a.includes(u)||c.push(u);const l=[];for(const u of a)l.push({key:{status:"valid",value:u},value:o[u]._parse(new mo(s,s.data[u],s.path,u)),alwaysSet:u in s.data});if(this._def.catchall instanceof Il){const u=this._def.unknownKeys;if("passthrough"===u)for(const d of c)l.push({key:{status:"valid",value:d},value:{status:"valid",value:s.data[d]}});else if("strict"===u)c.length>0&&(re(s,{code:q.unrecognized_keys,keys:c}),i.dirty());else if("strip"!==u)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const d of c)l.push({key:{status:"valid",value:d},value:u._parse(new mo(s,s.data[d],s.path,d)),alwaysSet:d in s.data})}return s.common.async?Promise.resolve().then(j(function*(){const u=[];for(const d of l){const h=yield d.key,f=yield d.value;u.push({key:h,value:f,alwaysSet:d.alwaysSet})}return u})).then(u=>Tr.mergeObjectSync(i,u)):Tr.mergeObjectSync(i,l)}get shape(){return this._def.shape()}strict(t){return new n({...this._def,unknownKeys:"strict",...void 0!==t?{errorMap:(r,i)=>{var s,o,a,c;const l=null!==(a=null===(o=(s=this._def).errorMap)||void 0===o?void 0:o.call(s,r,i).message)&&void 0!==a?a:i.defaultError;return"unrecognized_keys"===r.code?{message:null!==(c=ge.errToObj(t).message)&&void 0!==c?c:l}:{message:l}}}:{}})}strip(){return new n({...this._def,unknownKeys:"strip"})}passthrough(){return new n({...this._def,unknownKeys:"passthrough"})}extend(t){return new n({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new n({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Oe.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new n({...this._def,catchall:t})}pick(t){const r={};return ot.objectKeys(t).forEach(i=>{t[i]&&this.shape[i]&&(r[i]=this.shape[i])}),new n({...this._def,shape:()=>r})}omit(t){const r={};return ot.objectKeys(this.shape).forEach(i=>{t[i]||(r[i]=this.shape[i])}),new n({...this._def,shape:()=>r})}deepPartial(){return Zd(this)}partial(t){const r={};return ot.objectKeys(this.shape).forEach(i=>{const s=this.shape[i];r[i]=t&&!t[i]?s:s.optional()}),new n({...this._def,shape:()=>r})}required(t){const r={};return ot.objectKeys(this.shape).forEach(i=>{if(t&&!t[i])r[i]=this.shape[i];else{let o=this.shape[i];for(;o instanceof _c;)o=o._def.innerType;r[i]=o}}),new n({...this._def,shape:()=>r})}keyof(){return IG(ot.objectKeys(this.shape))}}return n.create=(e,t)=>new n({shape:()=>e,unknownKeys:"strip",catchall:Il.create(),typeName:Oe.ZodObject,...Be(t)}),n.strictCreate=(e,t)=>new n({shape:()=>e,unknownKeys:"strict",catchall:Il.create(),typeName:Oe.ZodObject,...Be(t)}),n.lazycreate=(e,t)=>new n({shape:e,unknownKeys:"strip",catchall:Il.create(),typeName:Oe.ZodObject,...Be(t)}),n})(),lM=(()=>{class n extends Ge{_parse(t){const{ctx:r}=this._processInputParams(t),i=this._def.options;if(r.common.async)return Promise.all(i.map(function(){var o=j(function*(a){const c={...r,common:{...r.common,issues:[]},parent:null};return{result:yield a._parseAsync({data:r.data,path:r.path,parent:c}),ctx:c}});return function(a){return o.apply(this,arguments)}}())).then(function s(o){for(const c of o)if("valid"===c.result.status)return c.result;for(const c of o)if("dirty"===c.result.status)return r.common.issues.push(...c.ctx.common.issues),c.result;const a=o.map(c=>new ca(c.ctx.common.issues));return re(r,{code:q.invalid_union,unionErrors:a}),Re});{let o;const a=[];for(const l of i){const u={...r,common:{...r.common,issues:[]},parent:null},d=l._parseSync({data:r.data,path:r.path,parent:u});if("valid"===d.status)return d;"dirty"===d.status&&!o&&(o={result:d,ctx:u}),u.common.issues.length&&a.push(u.common.issues)}if(o)return r.common.issues.push(...o.ctx.common.issues),o.result;const c=a.map(l=>new ca(l));return re(r,{code:q.invalid_union,unionErrors:c}),Re}}get options(){return this._def.options}}return n.create=(e,t)=>new n({options:e,typeName:Oe.ZodUnion,...Be(t)}),n})();const la=n=>n instanceof hM?la(n.schema):n instanceof Ml?la(n.innerType()):n instanceof fM?[n.value]:n instanceof mc?n.options:n instanceof lg?ot.objectValues(n.enum):n instanceof pM?la(n._def.innerType):n instanceof aM?[void 0]:n instanceof cM?[null]:n instanceof _c?[void 0,...la(n.unwrap())]:n instanceof eh?[null,...la(n.unwrap())]:n instanceof mM||n instanceof _M?la(n.unwrap()):n instanceof gM?la(n._def.innerType):[];class Qv extends Ge{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ae.object)return re(t,{code:q.invalid_type,expected:ae.object,received:t.parsedType}),Re;const r=this.discriminator,s=this.optionsMap.get(t.data[r]);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(re(t,{code:q.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Re)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const i=new Map;for(const s of t){const o=la(s.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(i.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);i.set(a,s)}}return new Qv({typeName:Oe.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...Be(r)})}}function uM(n,e){const t=aa(n),r=aa(e);if(n===e)return{valid:!0,data:n};if(t===ae.object&&r===ae.object){const i=ot.objectKeys(e),s=ot.objectKeys(n).filter(a=>-1!==i.indexOf(a)),o={...n,...e};for(const a of s){const c=uM(n[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}if(t===ae.array&&r===ae.array){if(n.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<n.length;s++){const c=uM(n[s],e[s]);if(!c.valid)return{valid:!1};i.push(c.data)}return{valid:!0,data:i}}return t===ae.date&&r===ae.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}let dM=(()=>{class n extends Ge{_parse(t){const{status:r,ctx:i}=this._processInputParams(t),s=(o,a)=>{if(eM(o)||eM(a))return Re;const c=uM(o.value,a.value);return c.valid?((tM(o)||tM(a))&&r.dirty(),{status:r.value,value:c.data}):(re(i,{code:q.invalid_intersection_types}),Re)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([o,a])=>s(o,a)):s(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}return n.create=(e,t,r)=>new n({left:e,right:t,typeName:Oe.ZodIntersection,...Be(r)}),n})(),Jd=(()=>{class n extends Ge{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==ae.array)return re(i,{code:q.invalid_type,expected:ae.array,received:i.parsedType}),Re;if(i.data.length<this._def.items.length)return re(i,{code:q.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Re;!this._def.rest&&i.data.length>this._def.items.length&&(re(i,{code:q.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const o=[...i.data].map((a,c)=>{const l=this._def.items[c]||this._def.rest;return l?l._parse(new mo(i,a,i.path,c)):null}).filter(a=>!!a);return i.common.async?Promise.all(o).then(a=>Tr.mergeArray(r,a)):Tr.mergeArray(r,o)}get items(){return this._def.items}rest(t){return new n({...this._def,rest:t})}}return n.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new n({items:e,typeName:Oe.ZodTuple,rest:null,...Be(t)})},n})();class cg extends Ge{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ae.object)return re(r,{code:q.invalid_type,expected:ae.object,received:r.parsedType}),Re;const i=[],s=this._def.keyType,o=this._def.valueType;for(const a in r.data)i.push({key:s._parse(new mo(r,a,r.path,a)),value:o._parse(new mo(r,r.data[a],r.path,a)),alwaysSet:a in r.data});return r.common.async?Tr.mergeObjectAsync(t,i):Tr.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,r){return new cg(t instanceof Ge?{keyType:e,valueType:t,typeName:Oe.ZodRecord,...Be(r)}:{keyType:Kv.create(),valueType:e,typeName:Oe.ZodRecord,...Be(t)})}}let xG=(()=>{class n extends Ge{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==ae.map)return re(i,{code:q.invalid_type,expected:ae.map,received:i.parsedType}),Re;const s=this._def.keyType,o=this._def.valueType,a=[...i.data.entries()].map(([c,l],u)=>({key:s._parse(new mo(i,c,i.path,[u,"key"])),value:o._parse(new mo(i,l,i.path,[u,"value"]))}));if(i.common.async){const c=new Map;return Promise.resolve().then(j(function*(){for(const l of a){const u=yield l.key,d=yield l.value;if("aborted"===u.status||"aborted"===d.status)return Re;("dirty"===u.status||"dirty"===d.status)&&r.dirty(),c.set(u.value,d.value)}return{status:r.value,value:c}}))}{const c=new Map;for(const l of a){const u=l.key,d=l.value;if("aborted"===u.status||"aborted"===d.status)return Re;("dirty"===u.status||"dirty"===d.status)&&r.dirty(),c.set(u.value,d.value)}return{status:r.value,value:c}}}}return n.create=(e,t,r)=>new n({valueType:t,keyType:e,typeName:Oe.ZodMap,...Be(r)}),n})(),SG=(()=>{class n extends Ge{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==ae.set)return re(i,{code:q.invalid_type,expected:ae.set,received:i.parsedType}),Re;const s=this._def;null!==s.minSize&&i.data.size<s.minSize.value&&(re(i,{code:q.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),null!==s.maxSize&&i.data.size>s.maxSize.value&&(re(i,{code:q.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());const o=this._def.valueType;function a(l){const u=new Set;for(const d of l){if("aborted"===d.status)return Re;"dirty"===d.status&&r.dirty(),u.add(d.value)}return{status:r.value,value:u}}const c=[...i.data.values()].map((l,u)=>o._parse(new mo(i,l,i.path,u)));return i.common.async?Promise.all(c).then(l=>a(l)):a(c)}min(t,r){return new n({...this._def,minSize:{value:t,message:ge.toString(r)}})}max(t,r){return new n({...this._def,maxSize:{value:t,message:ge.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}return n.create=(e,t)=>new n({valueType:e,minSize:null,maxSize:null,typeName:Oe.ZodSet,...Be(t)}),n})();class Qd extends Ge{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ae.function)return re(t,{code:q.invalid_type,expected:ae.function,received:t.parsedType}),Re;function r(a,c){return Yv({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Xv(),Xd].filter(l=>!!l),issueData:{code:q.invalid_arguments,argumentsError:c}})}function i(a,c){return Yv({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Xv(),Xd].filter(l=>!!l),issueData:{code:q.invalid_return_type,returnTypeError:c}})}const s={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof eb){const a=this;return zr(j(function*(...c){const l=new ca([]),u=yield a._def.args.parseAsync(c,s).catch(f=>{throw l.addIssue(r(c,f)),l}),d=yield Reflect.apply(o,this,u);return yield a._def.returns._def.type.parseAsync(d,s).catch(f=>{throw l.addIssue(i(d,f)),l})}))}{const a=this;return zr(function(...c){const l=a._def.args.safeParse(c,s);if(!l.success)throw new ca([r(c,l.error)]);const u=Reflect.apply(o,this,l.data),d=a._def.returns.safeParse(u,s);if(!d.success)throw new ca([i(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Qd({...this._def,args:Jd.create(e).rest(og.create())})}returns(e){return new Qd({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new Qd({args:e||Jd.create([]).rest(og.create()),returns:t||og.create(),typeName:Oe.ZodFunction,...Be(r)})}}let hM=(()=>{class n extends Ge{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}return n.create=(e,t)=>new n({getter:e,typeName:Oe.ZodLazy,...Be(t)}),n})(),fM=(()=>{class n extends Ge{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return re(r,{received:r.data,code:q.invalid_literal,expected:this._def.value}),Re}return{status:"valid",value:t.data}}get value(){return this._def.value}}return n.create=(e,t)=>new n({value:e,typeName:Oe.ZodLiteral,...Be(t)}),n})();function IG(n,e){return new mc({values:n,typeName:Oe.ZodEnum,...Be(e)})}class mc extends Ge{constructor(){super(...arguments),ig.set(this,void 0)}_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e);return re(t,{expected:ot.joinValues(this._def.values),received:t.parsedType,code:q.invalid_type}),Re}if(Zv(this,ig,"f")||vG(this,ig,new Set(this._def.values),"f"),!Zv(this,ig,"f").has(e.data)){const t=this._getOrReturnCtx(e);return re(t,{received:t.data,code:q.invalid_enum_value,options:this._def.values}),Re}return zr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return mc.create(e,{...this._def,...t})}exclude(e,t=this._def){return mc.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}ig=new WeakMap,mc.create=IG;class lg extends Ge{constructor(){super(...arguments),sg.set(this,void 0)}_parse(e){const t=ot.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ae.string&&r.parsedType!==ae.number){const i=ot.objectValues(t);return re(r,{expected:ot.joinValues(i),received:r.parsedType,code:q.invalid_type}),Re}if(Zv(this,sg,"f")||vG(this,sg,new Set(ot.getValidEnumValues(this._def.values)),"f"),!Zv(this,sg,"f").has(e.data)){const i=ot.objectValues(t);return re(r,{received:r.data,code:q.invalid_enum_value,options:i}),Re}return zr(e.data)}get enum(){return this._def.values}}sg=new WeakMap,lg.create=(n,e)=>new lg({values:n,typeName:Oe.ZodNativeEnum,...Be(e)});let eb=(()=>{class n extends Ge{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ae.promise&&!1===r.common.async)return re(r,{code:q.invalid_type,expected:ae.promise,received:r.parsedType}),Re;const i=r.parsedType===ae.promise?r.data:Promise.resolve(r.data);return zr(i.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}return n.create=(e,t)=>new n({type:e,typeName:Oe.ZodPromise,...Be(t)}),n})(),Ml=(()=>{class n extends Ge{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Oe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){var r=this;const{status:i,ctx:s}=this._processInputParams(t),o=this._def.effect||null,a={addIssue:c=>{re(s,c),c.fatal?i.abort():i.dirty()},get path(){return s.path}};if(a.addIssue=a.addIssue.bind(a),"preprocess"===o.type){const c=o.transform(s.data,a);if(s.common.async)return Promise.resolve(c).then(function(){var l=j(function*(u){if("aborted"===i.value)return Re;const d=yield r._def.schema._parseAsync({data:u,path:s.path,parent:s});return"aborted"===d.status?Re:"dirty"===d.status||"dirty"===i.value?Yd(d.value):d});return function(u){return l.apply(this,arguments)}}());{if("aborted"===i.value)return Re;const l=this._def.schema._parseSync({data:c,path:s.path,parent:s});return"aborted"===l.status?Re:"dirty"===l.status||"dirty"===i.value?Yd(l.value):l}}if("refinement"===o.type){const c=l=>{const u=o.refinement(l,a);if(s.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(!1===s.common.async){const l=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return"aborted"===l.status?Re:("dirty"===l.status&&i.dirty(),c(l.value),{status:i.value,value:l.value})}return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(l=>"aborted"===l.status?Re:("dirty"===l.status&&i.dirty(),c(l.value).then(()=>({status:i.value,value:l.value}))))}if("transform"===o.type){if(!1===s.common.async){const c=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Sl(c))return c;const l=o.transform(c.value,a);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:i.value,value:l}}return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(c=>Sl(c)?Promise.resolve(o.transform(c.value,a)).then(l=>({status:i.value,value:l})):c)}ot.assertNever(o)}}return n.create=(e,t,r)=>new n({schema:e,typeName:Oe.ZodEffects,effect:t,...Be(r)}),n.createWithPreprocess=(e,t,r)=>new n({schema:t,effect:{type:"preprocess",transform:e},typeName:Oe.ZodEffects,...Be(r)}),n})(),_c=(()=>{class n extends Ge{_parse(t){return this._getType(t)===ae.undefined?zr(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}return n.create=(e,t)=>new n({innerType:e,typeName:Oe.ZodOptional,...Be(t)}),n})(),eh=(()=>{class n extends Ge{_parse(t){return this._getType(t)===ae.null?zr(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}return n.create=(e,t)=>new n({innerType:e,typeName:Oe.ZodNullable,...Be(t)}),n})(),pM=(()=>{class n extends Ge{_parse(t){const{ctx:r}=this._processInputParams(t);let i=r.data;return r.parsedType===ae.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}return n.create=(e,t)=>new n({innerType:e,typeName:Oe.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...Be(t)}),n})(),gM=(()=>{class n extends Ge{_parse(t){const{ctx:r}=this._processInputParams(t),i={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return rg(s)?s.then(o=>({status:"valid",value:"valid"===o.status?o.value:this._def.catchValue({get error(){return new ca(i.common.issues)},input:i.data})})):{status:"valid",value:"valid"===s.status?s.value:this._def.catchValue({get error(){return new ca(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}return n.create=(e,t)=>new n({innerType:e,typeName:Oe.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...Be(t)}),n})(),MG=(()=>{class n extends Ge{_parse(t){if(this._getType(t)!==ae.nan){const i=this._getOrReturnCtx(t);return re(i,{code:q.invalid_type,expected:ae.nan,received:i.parsedType}),Re}return{status:"valid",value:t.data}}}return n.create=e=>new n({typeName:Oe.ZodNaN,...Be(e)}),n})();const cxe=Symbol("zod_brand");class mM extends Ge{_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.type._parse({data:t.data,path:t.path,parent:t})}unwrap(){return this._def.type}}class ug extends Ge{_parse(e){var t=this;const{status:r,ctx:i}=this._processInputParams(e);if(i.common.async)return function(){var o=j(function*(){const a=yield t._def.in._parseAsync({data:i.data,path:i.path,parent:i});return"aborted"===a.status?Re:"dirty"===a.status?(r.dirty(),Yd(a.value)):t._def.out._parseAsync({data:a.value,path:i.path,parent:i})});return function(){return o.apply(this,arguments)}}()();{const s=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return"aborted"===s.status?Re:"dirty"===s.status?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:i.path,parent:i})}}static create(e,t){return new ug({in:e,out:t,typeName:Oe.ZodPipeline})}}let _M=(()=>{class n extends Ge{_parse(t){const r=this._def.innerType._parse(t),i=s=>(Sl(s)&&(s.value=Object.freeze(s.value)),s);return rg(r)?r.then(s=>i(s)):i(r)}unwrap(){return this._def.innerType}}return n.create=(e,t)=>new n({innerType:e,typeName:Oe.ZodReadonly,...Be(t)}),n})();function DG(n,e){const t="function"==typeof n?n(e):"string"==typeof n?{message:n}:n;return"string"==typeof t?{message:t}:t}function RG(n,e={},t){return n?Jv.create().superRefine((r,i)=>{var s,o;const a=n(r);if(a instanceof Promise)return a.then(c=>{var l,u;if(!c){const d=DG(e,r),h=null===(u=null!==(l=d.fatal)&&void 0!==l?l:t)||void 0===u||u;i.addIssue({code:"custom",...d,fatal:h})}});if(!a){const c=DG(e,r),l=null===(o=null!==(s=c.fatal)&&void 0!==s?s:t)||void 0===o||o;i.addIssue({code:"custom",...c,fatal:l})}}):Jv.create()}const lxe={object:Kd.lazycreate};var Oe=function(n){return n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly",n}(Oe||{});const OG=Kv.create,PG=rM.create,dxe=MG.create,hxe=iM.create,NG=sM.create,fxe=oM.create,pxe=AG.create,gxe=aM.create,mxe=cM.create,_xe=Jv.create,yxe=og.create,vxe=Il.create,bxe=TG.create,wxe=ag.create,Exe=Kd.create,Cxe=Kd.strictCreate,Axe=lM.create,Txe=Qv.create,xxe=dM.create,Sxe=Jd.create,Ixe=cg.create,Mxe=xG.create,Dxe=SG.create,Rxe=Qd.create,Oxe=hM.create,Pxe=fM.create,Nxe=mc.create,kxe=lg.create,Fxe=eb.create,kG=Ml.create,Lxe=_c.create,Bxe=eh.create,Uxe=Ml.createWithPreprocess,jxe=ug.create;var xr=Object.freeze({__proto__:null,defaultErrorMap:Xd,setErrorMap:function UTe(n){yG=n},getErrorMap:Xv,makeIssue:Yv,EMPTY_PATH:[],addIssueToContext:re,ParseStatus:Tr,INVALID:Re,DIRTY:Yd,OK:zr,isAborted:eM,isDirty:tM,isValid:Sl,isAsync:rg,get util(){return ot},get objectUtil(){return _G},ZodParsedType:ae,getParsedType:aa,ZodType:Ge,datetimeRegex:CG,ZodString:Kv,ZodNumber:rM,ZodBigInt:iM,ZodBoolean:sM,ZodDate:oM,ZodSymbol:AG,ZodUndefined:aM,ZodNull:cM,ZodAny:Jv,ZodUnknown:og,ZodNever:Il,ZodVoid:TG,ZodArray:ag,ZodObject:Kd,ZodUnion:lM,ZodDiscriminatedUnion:Qv,ZodIntersection:dM,ZodTuple:Jd,ZodRecord:cg,ZodMap:xG,ZodSet:SG,ZodFunction:Qd,ZodLazy:hM,ZodLiteral:fM,ZodEnum:mc,ZodNativeEnum:lg,ZodPromise:eb,ZodEffects:Ml,ZodTransformer:Ml,ZodOptional:_c,ZodNullable:eh,ZodDefault:pM,ZodCatch:gM,ZodNaN:MG,BRAND:cxe,ZodBranded:mM,ZodPipeline:ug,ZodReadonly:_M,custom:RG,Schema:Ge,ZodSchema:Ge,late:lxe,get ZodFirstPartyTypeKind(){return Oe},coerce:{string:n=>Kv.create({...n,coerce:!0}),number:n=>rM.create({...n,coerce:!0}),boolean:n=>sM.create({...n,coerce:!0}),bigint:n=>iM.create({...n,coerce:!0}),date:n=>oM.create({...n,coerce:!0})},any:_xe,array:wxe,bigint:hxe,boolean:NG,date:fxe,discriminatedUnion:Txe,effect:kG,enum:Nxe,function:Rxe,instanceof:(n,e={message:`Input not instance of ${n.name}`})=>RG(t=>t instanceof n,e),intersection:xxe,lazy:Oxe,literal:Pxe,map:Mxe,nan:dxe,nativeEnum:kxe,never:vxe,null:mxe,nullable:Bxe,number:PG,object:Exe,oboolean:()=>NG().optional(),onumber:()=>PG().optional(),optional:Lxe,ostring:()=>OG().optional(),pipeline:jxe,preprocess:Uxe,promise:Fxe,record:Ixe,set:Dxe,strictObject:Cxe,string:OG,symbol:pxe,transformer:kG,tuple:Sxe,undefined:gxe,union:Axe,unknown:yxe,void:bxe,NEVER:Re,ZodIssueCode:q,quotelessJson:n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:ca});function yM(n){try{if("string"==typeof n)return JSON.parse(n)}catch{}return n}const Vxe=xr.object({}).passthrough().refine(n=>!0),Hxe=xr.array(Vxe),FG=xr.preprocess(yM,xr.union([xr.literal(""),xr.string().url(),Hxe])),LG=(FG.parse.bind(FG),xr.preprocess(yM,xr.tuple([xr.number(),xr.number(),xr.number()]))),BG=(LG.parse.bind(LG),xr.preprocess(yM,xr.object({x:xr.number(),y:xr.number(),z:xr.number()})));BG.parse.bind(BG);const zxe=["bodyCanvas"];let Gxe=(()=>{class n{clsName="ccf-body-ui";get scene(){return this._scene}set scene(t){this._scene=t,this.bodyUI?.setScene(t)}get rotation(){return this._rotation}set rotation(t){this._rotation=t,this.bodyUI?.setRotation(t)}get rotationX(){return this._rotationX}set rotationX(t){this._rotationX=t,this.bodyUI?.setRotationX(t)}get zoom(){return this._zoom}set zoom(t){this._zoom=t,this.bodyUI?.setZoom(t)}get target(){return this._target}set target(t){this._target=t,this.bodyUI?.setTarget(t)}get bounds(){return this._bounds}set bounds(t){this._bounds=t,this.zoomToBounds(t)}get camera(){return this._camera}set camera(t){this._camera=t}rotationChange=new ze;nodeDrag=new ze;nodeClick=new ze;nodeHoverStart=new ze;nodeHoverStop=new ze;initialized=new ze;get interactive(){return this._interactive}set interactive(t){this._interactive=t,this.bodyUI&&this.recreateBodyUI()}_interactive=!0;_rotation=0;_rotationX=0;_zoom=9.5;_target=[0,0,0];_bounds;_scene=[];subscriptions=[];_camera;bodyUI;bodyCanvas;ngAfterViewInit(){this.setupBodyUI()}zoomToBounds(t,r={x:48,y:48}){if(this.bodyCanvas){const{width:i,height:s}=this.bodyCanvas.nativeElement,o=window.devicePixelRatio,a=Math.min(Math.log2((i-r.x)/o/t.x),Math.log2((s-r.y)/o/t.y));this.zoom=a}}setupBodyUI(){var t=this;return j(function*(){const r=t.bodyCanvas.nativeElement,i=new LTe({id:"body-ui",canvas:r,zoom:t.zoom,target:[0,0,0],rotation:0,minRotationX:-75,maxRotationX:75,interactive:t.interactive,camera:t.camera});r.addEventListener("contextmenu",s=>s.preventDefault()),yield i.initialize(),t.bodyUI=i,window.bodyUI=i,t.scene?.length>0&&t.bodyUI.setScene(t.scene),t.bounds&&t.zoomToBounds(t.bounds),t.target&&t.bodyUI.setTarget(t.target),t.subscriptions=[t.bodyUI.sceneRotation$.subscribe(s=>t.rotationChange.next(s)),t.bodyUI.nodeDrag$.subscribe(s=>t.nodeDrag.emit(s)),t.bodyUI.nodeClick$.subscribe(s=>t.nodeClick.emit(s)),t.bodyUI.nodeHoverStart$.subscribe(s=>t.nodeHoverStart.emit(s)),t.bodyUI.nodeHoverStop$.subscribe(s=>t.nodeHoverStop.emit(s))],t.initialized.emit()})()}recreateBodyUI(){this.clearSubscriptions(),this.bodyUI.finalize(),this.setupBodyUI()}clearSubscriptions(){this.subscriptions.forEach(t=>t.unsubscribe()),this.subscriptions=[]}ngOnDestroy(){this.clearSubscriptions()}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["ccf-body-ui"]],viewQuery:function(r,i){if(1&r&&nl(zxe,5,fn),2&r){let s;Vo(s=Ho())&&(i.bodyCanvas=s.first)}},hostVars:2,hostBindings:function(r,i){2&r&&k_(i.clsName)},inputs:{scene:"scene",rotation:"rotation",rotationX:"rotationX",zoom:"zoom",target:"target",bounds:"bounds",camera:"camera",interactive:"interactive"},outputs:{rotationChange:"rotationChange",nodeDrag:"nodeDrag",nodeClick:"nodeClick",nodeHoverStart:"nodeHoverStart",nodeHoverStop:"nodeHoverStop",initialized:"initialized"},standalone:!1,decls:2,vars:0,consts:[["bodyCanvas",""],[1,"body-ui"]],template:function(r,i){1&r&&Ks(0,"canvas",1,0)},styles:["[_nghost-%COMP%]{height:100%;width:100%;display:block}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{position:relative!important;background-color:#000;border-radius:.5rem}"],changeDetection:0})}return n})();function th(n){return!0===n}function ui(n){return null===n||typeof n>"u"}function Gr(n){return!ui(n)}function vM(n){return!!n}function zG(n){return ui(n)?n:JSON.parse(JSON.stringify(n))}function GG(n){return Gr(n)&&"object"==typeof n&&function bM(n){return"[object Object]"===Object.prototype.toString.call(n)}(n)}new P("Maximum number of autocomplete options displayed",{providedIn:"root",factory:()=>10}),Qe(123),[{src:"app:skin",organ:"Skin",name:"Skin",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002097"},{src:"app:brain",organ:"Brain",name:"Brain",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000955"},{disabled:!0,src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002509"},{disabled:!0,src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000970"},{src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004548"},{src:"app:eye",organ:"Eye",name:"Eye, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004549"},{disabled:!0,src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0003889"},{src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001303"},{src:"app:fallopian-tube-right",organ:"Fallopian Tube",name:"Fallopian Tube, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001302"},{src:"app:heart",organ:"Heart",name:"Heart",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000948"},{disabled:!0,src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002113"},{src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004538"},{src:"app:kidney-right",organ:"Kidney",name:"Kidney, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004539"},{disabled:!0,src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001465"},{src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.org/sig/ont/fma/fma24978"},{src:"app:knee",organ:"Knee",name:"Knee, R",side:"right",hasSex:!0,id:"http://purl.org/sig/ont/fma/fma24977"},{src:"app:liver",organ:"Liver",name:"Liver",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002107"},{disabled:!0,src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002048"},{src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001004"},{disabled:!0,src:"app:mammary-gland",organ:"Mammary Gland",name:"Mammary Gland, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001911"},{src:"app:mammary-gland",organ:"Mammary Gland",name:"Mammary Gland, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma57991"},{src:"app:mammary-gland",organ:"Mammary Gland",name:"Mammary Gland, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma57987"},{src:"app:manubrium",organ:"Manubrium",name:"Manubrium",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_2001553"},{disabled:!0,src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000992"},{disabled:!0,src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma7214"},{src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0002119"},{disabled:!0,src:"app:ovary-right",organ:"Ovary",name:"Ovary, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma7213"},{src:"app:ovary-right",organ:"Ovary",name:"Ovary, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0002118"},{src:"app:larynx",organ:"Larynx",name:"Larynx",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001737"},{src:"app:main-bronchus",organ:"Main Bronchus",name:"Main Bronchus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002182"},{disabled:!0,src:"app:palatine-tonsil",organ:"Palatine Tonsil",name:"Palatine Tonsil, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002373"},{src:"app:palatine-tonsil",organ:"Palatine Tonsil",name:"Palatine Tonsil, L",side:"left",hasSex:!0,id:"http://purl.org/sig/ont/fma/fma54974"},{src:"app:palatine-tonsil",organ:"Palatine Tonsil",name:"Palatine Tonsil, R",side:"right",hasSex:!0,id:"http://purl.org/sig/ont/fma/fma54973"},{src:"app:pancreas",organ:"Pancreas",name:"Pancreas",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001264"},{src:"app:pelvis-f",organ:"Pelvis",name:"Pelvis",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001270"},{src:"app:placenta",organ:"Placenta",name:"Placenta",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001987"},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0002367",disabled:!0},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0000079"},{src:"app:renal-pelvis-left",organ:"Renal Pelvis",name:"Renal Pelvis, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0018115"},{src:"app:renal-pelvis-right",organ:"Renal Pelvis",name:"Renal Pelvis, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0018116"},{src:"app:small-intestine",organ:"Small Intestine",name:"Small Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002108"},{src:"app:sternum",organ:"Sternum",name:"Sternum",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000975"},{src:"app:large-intestine",organ:"Large Intestine",name:"Large Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000059"},{src:"app:spinal-cord",organ:"Spinal Cord",name:"Spinal Cord",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002240"},{src:"app:spleen",organ:"Spleen",name:"Spleen",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002106"},{src:"app:thymus",organ:"Thymus",name:"Thymus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002370"},{src:"app:trachea",organ:"Trachea",name:"Trachea",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0003126"},{disabled:!0,src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000056"},{src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001223"},{src:"app:ureter-right",organ:"Ureter",name:"Ureter, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001222"},{src:"app:bladder",organ:"Urinary Bladder",name:"Urinary Bladder",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001255"},{src:"app:uterus",organ:"Uterus",name:"Uterus",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000995"},{src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004537"},{disabled:!0,src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002049"}].sort((n,e)=>n.name.localeCompare(e.name)).filter(n=>!0!==n.disabled);const{isArray:gSe}=Array,{getPrototypeOf:mSe,prototype:_Se,keys:ySe}=Object;function qG(n){if(1===n.length){const e=n[0];if(gSe(e))return{args:e,keys:null};if(function vSe(n){return n&&"object"==typeof n&&mSe(n)===_Se}(e)){const t=ySe(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}const{isArray:bSe}=Array;function wM(n){return he(e=>function wSe(n,e){return bSe(e)?n(...e):n(e)}(n,e))}function XG(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function sb(...n){const e=GB(n),{args:t,keys:r}=qG(n),i=new Se(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let c=o,l=o;for(let u=0;u<o;u++){let d=!1;rr(t[u]).subscribe(_t(s,h=>{d||(d=!0,l--),a[u]=h},()=>c--,void 0,()=>{(!c||!d)&&(l||s.next(r?XG(r,a):a),s.complete())}))}});return e?i.pipe(wM(e)):i}function ie(...n){return Ln(n,tp(n))}function yc(n,e){const t=dt(n)?n:()=>n,r=i=>i.error(t());return new Se(e?i=>e.schedule(r,0,i):r)}function nh(n){return bt((e,t)=>{let r=!1;e.subscribe(_t(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function _o(n){return bt((e,t)=>{let s,r=null,i=!1;r=e.subscribe(_t(t,void 0,void 0,o=>{s=rr(n(o,_o(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function ua(n){return bt((e,t)=>{rr(n).subscribe(_t(t,()=>t.complete(),eu)),!t.closed&&e.subscribe(t)})}function Dl(n){return bt((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Mi(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=n??1/0,ta({connector:()=>new Wo(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function rh(n,e=Ni){return n=n??ESe,bt((t,r)=>{let i,s=!0;t.subscribe(_t(r,o=>{const a=e(o);(s||!n(i,a))&&(s=!1,i=a,r.next(o))}))})}function ESe(n,e){return n===e}function Vn(n){return n<=0?()=>si:bt((e,t)=>{let r=0;e.subscribe(_t(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}const da="NGXS_META",YG="NGXS_OPTIONS_META",EM="NGXS_SELECTOR_META";function ZG(n){if(!n.hasOwnProperty(da)){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,da,{value:e})}return hg(n)}function hg(n){return n[da]}function JG(n){return n[EM]}function CM(n,e=Object.is){let t=null,r=null;function i(){return function CSe(n,e,t){if(null===e||null===t||e.length!==t.length)return!1;const r=e.length;for(let i=0;i<r;i++)if(!n(e[i],t[i]))return!1;return!0}(e,t,arguments)||(r=n.apply(null,arguments)),t=arguments,r}return i.reset=function(){t=null,r=null},i}let ASe=(()=>{class n{static{this._value={}}static set(t){this._value=t}static pop(){const t=this._value;return this._value={},t}}return n})();const QG=new P("",{providedIn:"root",factory:()=>ASe.pop()});let e4=(()=>{class n extends Wo{constructor(){super(1)}bootstrap(){this.next(!0),this.complete()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const t4=new P(""),n4=new P("");function r4(n){const e=[];let t=!1;return function(...i){if(t)e.unshift(i);else{for(t=!0,n(...i);e.length>0;){const s=e.pop();s&&n(...s)}t=!1}}}class TSe extends fe{constructor(){super(...arguments),this._orderedNext=r4(e=>super.next(e))}next(e){this._orderedNext(e)}}class xSe extends Qt{constructor(e){super(e),this._orderedNext=r4(t=>super.next(t)),this._currentValue=e}getValue(){return this._currentValue}next(e){this._currentValue=e,this._orderedNext(e)}}function s4(n){return e=>new Se(t=>e.subscribe({next(r){n(()=>t.next(r))},error(r){n(()=>t.error(r))},complete(){n(()=>t.complete())}}))}let AM=(()=>{class n extends xSe{constructor(){super({}),this.state=function q2(n,e){const t=!e?.manualCleanup;t&&!e?.injector&&Pc();const r=t?e?.injector?.get(hs)??A(hs):null,i=function Aoe(n=Object.is){return(e,t)=>1===e.kind&&1===t.kind&&n(e.value,t.value)}(e?.equal);let s;s=Oa(e?.requireSync?{kind:0}:{kind:1,value:e?.initialValue},{equal:i});const o=n.subscribe({next:a=>s.set({kind:1,value:a}),error:a=>{if(e?.rejectErrors)throw a;s.set({kind:2,error:a})}});if(e?.requireSync&&0===s().kind)throw new V(601,!1);return r?.onDestroy(o.unsubscribe.bind(o)),ol(()=>{const a=s();switch(a.kind){case 1:return a.value;case 2:throw a.error;case 0:throw new V(601,!1)}},{equal:e?.equal})}(this.pipe(s4(ii)),{manualCleanup:!0,requireSync:!0})}ngOnDestroy(){this.complete()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function qt(n,e,t){const r=dt(n)||e||t?{next:n,error:e,complete:t}:n;return r?bt((i,s)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let a=!0;i.subscribe(_t(s,c=>{var l;null===(l=r.next)||void 0===l||l.call(r,c),s.next(c)},()=>{var c;a=!1,null===(c=r.complete)||void 0===c||c.call(r),s.complete()},c=>{var l;a=!1,null===(l=r.error)||void 0===l||l.call(r,c),s.error(c)},()=>{var c,l;a&&(null===(c=r.unsubscribe)||void 0===c||c.call(r)),null===(l=r.finalize)||void 0===l||l.call(r)}))}):Ni}function fg(...n){return function SSe(){return ay(1)}()(Ln(n,tp(n)))}function vc(...n){const e=tp(n);return bt((t,r)=>{(e?fg(n,t,e):fg(n,t)).subscribe(r)})}let o4=(()=>{class n{static{this.type="@@INIT"}}return n})(),a4=(()=>{class n{static{this.type="@@UPDATE_STATE"}constructor(t){this.addedStates=t}}return n})();const TM=new P("");function MSe(n){return!!n.prototype.handle}function Rl(n){return n.constructor?.type||n.type}const c4=(n,e,t)=>{n={...n};const r=e.split("."),i=r.length-1;return r.reduce((s,o,a)=>(s[o]=a===i?t:Array.isArray(s[o])?s[o].slice():{...s[o]},s&&s[o]),n),n},xM=(n,e)=>e.split(".").reduce((t,r)=>t&&t[r],n);let RSe=(()=>{class n{enter(t){return t()}leave(t){return t()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),f4=(()=>{class n{constructor(){this._ngZone=A(ye),this._isServer=UA(A(ko))}enter(t){return this._isServer?this.runInsideAngular(t):this.runOutsideAngular(t)}leave(t){return this.runInsideAngular(t)}runInsideAngular(t){return ye.isInAngularZone()?t():this._ngZone.run(t)}runOutsideAngular(t){return ye.isInAngularZone()?this._ngZone.runOutsideAngular(t):t()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const p4=new P(""),USe=new P("",{providedIn:"root",factory:()=>{const n=A(ye),e=A(pm),t=e.get(p4);return e.get(t||(n instanceof ye?f4:RSe))}});let g4=(()=>{class n{constructor(){this._executionStrategy=A(USe)}enter(t){return this._executionStrategy.enter(t)}leave(t){return this._executionStrategy.leave(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function ab(n){return s4(e=>n.leave(e))}let m4=(()=>{class n extends TSe{constructor(){super(),this.dispatched$=new fe,this.pipe(gt(t=>"DISPATCHED"===t.status)).subscribe(t=>{this.dispatched$.next(t)})}ngOnDestroy(){this.complete()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),IM=(()=>{class n{constructor(){this.plugins=[],this._parentManager=A(n,{optional:!0,skipSelf:!0}),this._pluginHandlers=A(TM,{optional:!0}),this.registerHandlers()}get _rootPlugins(){return this._parentManager?.plugins||this.plugins}registerHandlers(){const t=this.getPluginHandlers();this._rootPlugins.push(...t)}getPluginHandlers(){return(this._pluginHandlers||[]).map(r=>r.handle?r.handle.bind(r):r)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const MM=new WeakMap;let _4=!1;let y4=(()=>{class n extends fe{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Bi(n)))(i||n)}})()}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),WSe=(()=>{class n{constructor(){this._ngZone=A(ye),this._actions=A(m4),this._actionResults=A(y4),this._pluginManager=A(IM),this._stateStream=A(AM),this._ngxsExecutionStrategy=A(g4),this._injector=A(pt)}dispatch(t){return this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(t)).pipe(function GSe(n){return e=>{let t=e.subscribe({error:r=>{n.runOutsideAngular(()=>{queueMicrotask(()=>{t&&function HSe(n){const e=MM.get(n);e&&e()}(r)})})}});return new Se(r=>(t?.unsubscribe(),t=null,e.subscribe(r)))}}(this._ngZone),ab(this._ngxsExecutionStrategy))}dispatchByEvents(t){return Array.isArray(t)?0===t.length?ie(void 0):sb(t.map(r=>this.dispatchSingle(r))).pipe(he(()=>{})):this.dispatchSingle(t)}dispatchSingle(t){const r=this._stateStream.getValue();return v4(this._injector,[...this._pluginManager.plugins,(s,o)=>{s!==r&&this._stateStream.next(s);const a=this.getActionResultStream(o);return a.subscribe(c=>this._actions.next(c)),this._actions.next({action:o,status:"DISPATCHED"}),this.createDispatchObservable(a)}])(r,t).pipe(Mi())}getActionResultStream(t){return this._actionResults.pipe(gt(r=>r.action===t&&"DISPATCHED"!==r.status),Vn(1),Mi())}createDispatchObservable(t){return t.pipe(Cn(r=>{switch(r.status){case"SUCCESSFUL":return ie(this._stateStream.getValue());case"ERRORED":return yc(()=>r.error);default:return ie()}}),Mi())}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const v4=(n,e)=>(...t)=>{const r=e.shift();return gi(n,()=>r(...t,(...i)=>v4(n,e)(...i)))},b4=new P(""),w4=new P(""),E4=new P("");let pg=(()=>{class n{constructor(){this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=f4,this.selectorOptions={injectContainerState:!1,suppressErrors:!1}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:()=>(()=>{const t=new n,r=A(E4);return{...t,...r,selectorOptions:{...t.selectorOptions,...r.selectorOptions}}})(),providedIn:"root"})}}return n})();class $Se{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}}let gg=(()=>{class n{constructor(){this._stateStream=A(AM),this._dispatcher=A(WSe),this._config=A(pg)}getRootStateOperations(){return{getState:()=>this._stateStream.getValue(),setState:r=>this._stateStream.next(r),dispatch:r=>this._dispatcher.dispatch(r)}}setStateToTheCurrentWithNew(t){const r=this.getRootStateOperations(),i=r.getState();r.setState({...i,...t.defaults})}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function A4(n){const e=JG(n)||hg(n);return e&&e.makeRootSelector||(()=>n)}function T4(n){return e=>{for(let t=0;t<n.length;t++){if(!e)return;e=e[n[t]]}return e}}function x4(n){const e=n;let t="store."+e[0],r=0;const i=e.length;let s=t;for(;++r<i;)s=s+" && "+(t=t+"."+e[r]);return new Function("store","return "+s+";")}const JSe=new P("",{providedIn:"root",factory:()=>A(pg).compatibility?.strictContentSecurityPolicy?T4:x4});let rIe=(()=>{class n{constructor(){this._actionTypeToHandlersMap=new Map}ngOnDestroy(){this._actionTypeToHandlersMap.clear()}get(t){return this._actionTypeToHandlersMap.get(t)}register(t,r){const i=this._actionTypeToHandlersMap.get(t)??new Set;return i.add(r),this._actionTypeToHandlersMap.set(t,i),()=>{this._actionTypeToHandlersMap.get(t).delete(r)}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();new RegExp("^[a-zA-Z0-9_]+$");let cIe=(()=>{class n{constructor(){this._ngZone=A(ye),this._errorHandler=A(ei)}handleError(t,r){this._ngZone.runOutsideAngular(()=>this._errorHandler.handleError(t))}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),DM=(()=>{class n{constructor(){this._internalStateOperations=A(gg)}createStateContext(t){const r=this._internalStateOperations.getRootStateOperations();return{getState:()=>D4(r.getState(),t),patchState(i){const s=r.getState(),o=function lIe(n){return e=>{const t={...e};for(const r in n)t[r]=n[r];return t}}(i);M4(r,s,o,t)},setState(i){const s=r.getState();!function ob(n){return"function"==typeof n}(i)?I4(r,s,i,t):M4(r,s,i,t)},dispatch:i=>r.dispatch(i)}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function I4(n,e,t,r){const i=c4(e,r,t);return n.setState(i),i}function M4(n,e,t,r){return I4(n,e,t(D4(e,r)),r)}function D4(n,e){return xM(n,e)}function uIe(...n){return function ih(n,e,t=hIe){const r=function fIe(n){return n.reduce((e,t)=>(e[Rl(t)]=!0,e),{})}(n),i=e&&function pIe(n){return n.reduce((e,t)=>(e[t]=!0,e),{})}(e);return function(s){return s.pipe(function dIe(n,e){return gt(t=>{const r=Rl(t.action);return n[r]&&(!e||e[t.status])})}(r,i),t())}}(n,["DISPATCHED"])}function hIe(){return he(n=>n.action)}function gIe(n){let e=void 0===n?{}:n;return n&&(Array.isArray(n)?e=n.slice():"object"==typeof n&&(e={...n})),e}let cb=(()=>{class n{constructor(){this._injector=A(pt),this._config=A(pg),this._stateContextFactory=A(DM),this._actions=A(m4),this._actionResults=A(y4),this._initialState=A(QG,{optional:!0}),this._actionRegistry=A(rIe),this._propGetter=A(JSe),this._actionsSubscription=null,this._ngxsUnhandledErrorHandler=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=CM(()=>{const t=this,r=t._propGetter;return{getStateGetter(o){let a=function i(o){const a=t._statePaths[o];return a?r(a.split(".")):null}(o);return a||((...c)=>(a||(a=function i(o){const a=t._statePaths[o];return a?r(a.split(".")):null}(o)),a?a(...c):void 0))},getSelectorOptions:o=>({...t._config.selectorOptions,...o||{}})}})}ngOnDestroy(){this._actionsSubscription?.unsubscribe()}add(t){const{newStates:r}=this.addToStatesMap(t);if(!r.length)return[];const i=function QSe(n){const e=t=>n.find(i=>i===t)[da].name;return n.reduce((t,r)=>{const{name:i,children:s}=r[da];return t[i]=(s||[]).map(e),t},{})}(r),s=function nIe(n){const e=[],t={},r=(i,s=[])=>{Array.isArray(s)||(s=[]),s.push(i),t[i]=!0,n[i].forEach(o=>{t[o]||r(o,s.slice(0))}),e.indexOf(i)<0&&e.push(i)};return Object.keys(n).forEach(i=>r(i)),e.reverse()}(i),o=function tIe(n,e={}){const t=(r,i)=>{for(const s in r)if(r.hasOwnProperty(s)&&r[s].indexOf(i)>=0){const o=t(r,s);return null!==o?`${o}.${s}`:s}return null};for(const r in n)if(n.hasOwnProperty(r)){const i=t(n,r);e[r]=i?`${i}.${r}`:r}return e}(i),a=function eIe(n){return n.reduce((e,t)=>(e[t[da].name]=t,e),{})}(r),c=[];for(const l of s){const u=a[l],d=o[l],h=u[da];this.addRuntimeInfoToMeta(h,d);const f={name:l,path:d,isInitialised:!1,actions:h.actions,instance:A(u),defaults:gIe(h.defaults)};this.hasBeenMountedAndBootstrapped(l,d)||c.push(f),this._states.push(f),this.hydrateActionMetasMap(f)}return c}addAndReturnDefaults(t){const i=this.add(t||[]);return{defaults:i.reduce((o,a)=>c4(o,a.path,a.defaults),{}),states:i}}connectActionHandlers(){this._actionsSubscription=this._actions.pipe(gt(t=>"DISPATCHED"===t.status),Cn(t=>{const r=t.action;return this.invokeActions(r).pipe(he(()=>({action:r,status:"SUCCESSFUL"})),nh({action:r,status:"CANCELED"}),_o(i=>{const s=this._ngxsUnhandledErrorHandler||=this._injector.get(cIe),o=function zSe(n,e){if(null!==n&&"object"==typeof n){let t=!1;MM.set(n,()=>{t||(t=!0,e())})}return n}(i,()=>s.handleError(i,{action:r}));return ie({action:r,status:"ERRORED",error:o})}))})).subscribe(t=>this._actionResults.next(t))}invokeActions(t){const r=Rl(t),i=[];let s=!1;const o=this._actionRegistry.get(r);if(o)for(const a of o){let c;try{c=a(t)}catch(l){c=yc(()=>l)}i.push(c),s=!0}return i.length||i.push(ie(void 0)),sb(i)}addToStatesMap(t){const r=[],i=this._statesByName;for(const s of t){const o=hg(s).name;!i[o]&&(r.push(s),i[o]=s)}return{newStates:r}}addRuntimeInfoToMeta(t,r){this._statePaths[t.name]=r,t.path=r}hasBeenMountedAndBootstrapped(t,r){const i=void 0!==xM(this._initialState,r);return this._statesByName[t]&&i}hydrateActionMetasMap({path:t,actions:r,instance:i}){const{dispatched$:s}=this._actions;for(const o of Object.keys(r)){const a=r[o].map(c=>{const l=!!c.options.cancelUncompleted;return u=>{const d=this._stateContextFactory.createStateContext(t);let h=i[c.fn](d,u);if(Jc(h)&&(h=Ln(h)),Cs(h)){if(h=h.pipe(Cn(f=>Jc(f)?Ln(f):Cs(f)?f:ie(f)),nh(void 0)),l){const f=s.pipe(uIe(u));h=h.pipe(ua(f))}h=h.pipe(Dl(()=>{d.setState=O4,d.patchState=O4}))}else h=ie(void 0);return h}});for(const c of a)this._actionRegistry.register(o,c)}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function O4(){}let Zi=(()=>{class n{constructor(){this._stateStream=A(AM),this._internalStateOperations=A(gg),this._config=A(pg),this._internalExecutionStrategy=A(g4),this._stateFactory=A(cb),this._selectableStateStream=this._stateStream.pipe(ab(this._internalExecutionStrategy),Mi({bufferSize:1,refCount:!0})),this.initStateStream()}dispatch(t){return this._internalStateOperations.getRootStateOperations().dispatch(t)}select(t){const r=this.getStoreBoundSelectorFn(t);return this._selectableStateStream.pipe(he(r),_o(i=>this._config.selectorOptions.suppressErrors&&i instanceof TypeError?ie(void 0):yc(i)),rh(),ab(this._internalExecutionStrategy))}selectOnce(t){return this.select(t).pipe(Vn(1))}selectSnapshot(t){return this.getStoreBoundSelectorFn(t)(this._stateStream.getValue())}selectSignal(t){const r=this.getStoreBoundSelectorFn(t);return ol(()=>r(this._stateStream.state()))}subscribe(t){return this._selectableStateStream.pipe(ab(this._internalExecutionStrategy)).subscribe(t)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(t){this._internalStateOperations.getRootStateOperations().setState(t)}getStoreBoundSelectorFn(t){return A4(t)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(){const t=A(QG),r=this._stateStream.value;(!r||0===Object.keys(r).length)&&this._stateStream.next(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const P4=new P("");let lb=(()=>{class n{static{this.store=null}static{this.config=null}constructor(t,r){n.store=t,n.config=r}ngOnDestroy(){n.store=null,n.config=null}static{this.\u0275fac=function(r){return new(r||n)(X(Zi),X(pg))}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),N4=(()=>{class n{constructor(){this._store=A(Zi),this._internalStateOperations=A(gg),this._stateContextFactory=A(DM),this._appBootstrappedState=A(e4),this._destroy$=new Wo(1)}ngOnDestroy(){this._destroy$.next()}ngxsBootstrap(t,r){this._internalStateOperations.getRootStateOperations().dispatch(t).pipe(gt(()=>!!r),qt(()=>this._invokeInitOnStates(r.states)),Cn(()=>this._appBootstrappedState),gt(i=>!!i),ua(this._destroy$)).subscribe(()=>this._invokeBootstrapOnStates(r.states))}_invokeInitOnStates(t){for(const r of t){const i=r.instance;i.ngxsOnChanges&&this._store.select(s=>xM(s,r.path)).pipe(vc(void 0),bt((n,e)=>{let t,r=!1;n.subscribe(_t(e,i=>{const s=t;t=i,r&&e.next([s,i]),r=!0}))}),ua(this._destroy$)).subscribe(([s,o])=>{const a=new $Se(s,o,!r.isInitialised);i.ngxsOnChanges(a)}),i.ngxsOnInit&&i.ngxsOnInit(this._getStateContext(r)),r.isInitialised=!0}}_invokeBootstrapOnStates(t){for(const r of t){const i=r.instance;i.ngxsAfterBootstrap&&i.ngxsAfterBootstrap(this._getStateContext(r))}}_getStateContext(t){return this._stateContextFactory.createStateContext(t.path)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();new P(""),new P("");let vIe=(()=>{class n{constructor(){!function k4(){(function VSe(){if(_4)return;const n=ns.onUnhandledError;ns.onUnhandledError=function(e){const t=MM.get(e);if(t)t();else{if(!n)throw e;n.call(this,e)}},_4=!0})(),(A(P4,{optional:!0})||[]).forEach(o=>o());const e=A(cb),t=A(gg);A(Zi),A(lb);const r=A(b4,{optional:!0})||[],i=A(N4),s=e.addAndReturnDefaults(r);t.setStateToTheCurrentWithNew(s),e.connectActionHandlers(),i.ngxsBootstrap(new o4,s)}()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=ji({type:n})}static{this.\u0275inj=fi({})}}return n})(),bIe=(()=>{class n{constructor(){!function F4(){A(Zi);const n=A(gg),e=A(cb),t=A(w4,{optional:!0})||[],r=A(N4),i=t.reduce((o,a)=>o.concat(a),[]),s=e.addAndReturnDefaults(i);s.states.length&&(n.setStateToTheCurrentWithNew(s),r.ngxsBootstrap(new a4(s.defaults),s))}()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=ji({type:n})}static{this.\u0275inj=fi({})}}return n})();function U4(n,e){return[...n,{provide:b4,useValue:n},{provide:Zu,useFactory:()=>{const t=A(e4);return()=>t.bootstrap()},multi:!0},{provide:E4,useValue:e},{provide:p4,useValue:e.executionStrategy}]}function j4(n){return[IM,...n,{provide:w4,multi:!0,useValue:n}]}let wIe=(()=>{class n{static forRoot(t=[],r={}){return{ngModule:vIe,providers:U4(t,r)}}static forFeature(t=[]){return{ngModule:bIe,providers:j4(t)}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=ji({type:n})}static{this.\u0275inj=fi({})}}return n})();function RM(n,e){return(t,r,i)=>{const s=ZG(t.constructor),o=Array.isArray(n)?n:[n];for(const a of o){const c=a.type;s.actions[c]||(s.actions[c]=[]),s.actions[c].push({fn:r,options:e||{},type:c})}}}function OM(n){return e=>{const t=e,r=ZG(t),i=Object.getPrototypeOf(t),s=function EIe(n,e){return{...n[YG]||{},...e}}(i,n);(function CIe(n){const{meta:e,inheritedStateClass:t,optionsWithInheritance:r}=n,{children:i,defaults:s,name:o}=r,a="string"==typeof o?o:o&&o.getName()||null;t.hasOwnProperty(da)&&(e.actions={...e.actions,...(t[da]||{}).actions}),e.children=i,e.defaults=s,e.name=a})({meta:r,inheritedStateClass:i,optionsWithInheritance:s}),t[YG]=s}}function ub(n,...e){return function(t,r){const i=r.toString(),s=`__${i}__selector`,o=function xIe(n,e,t=[]){return e=e||function SIe(n){const e=n.length-1;return 36===n.charCodeAt(e)?n.slice(0,e):n}(n),"string"==typeof e?function KSe(n,e){return e?.compatibility?.strictContentSecurityPolicy?T4(n):x4(n)}(t.length?[e,...t]:e.split("."),lb.config):e}(i,n,e);Object.defineProperties(t,{[s]:{writable:!0,enumerable:!1,configurable:!0},[i]:{enumerable:!0,configurable:!0,get(){return this[s]||(this[s]=function TIe(n){return lb.store||function BSe(){throw new Error("You have forgotten to import the NGXS module!")}(),lb.store.select(n)}(o))}}})}}const db_getOptions=n=>n&&n.NGXS_SELECTOR_OPTIONS_META||{};function IIe(n,e){const t=function KG(n){return n.hasOwnProperty(EM)||Object.defineProperty(n,EM,{value:{makeRootSelector:null,originalFn:null,containerClass:null,selectorName:null,getSelectorOptions:()=>({})}}),JG(n)}(n);t.originalFn=n;let r=()=>({});e&&(t.containerClass=e.containerClass,t.selectorName=e.selectorName||null,r=e.getSelectorOptions||r);const i={...t};return t.getSelectorOptions=()=>function MIe(n,e){return{...db_getOptions(n.containerClass)||{},...db_getOptions(n.originalFn)||{},...n.getSelectorOptions()||{},...e}}(i,r()),t}function mg(n,e,t){const r=function XSe(n,e){const t=e&&e.containerClass,i=CM(function(){const o=n.apply(t,arguments);return"function"==typeof o?CM.apply(null,[o]):o});return Object.setPrototypeOf(i,n),i}(e,t),i=IIe(e,t);return i.makeRootSelector=function qSe(n,e,t){return r=>{const{argumentSelectorFunctions:i,selectorOptions:s}=function YSe(n,e,t=[]){const r=e.getSelectorOptions(),i=n.getSelectorOptions(r),o=function ZSe(n=[],e,t){const r=[];return t&&(e.injectContainerState||0===n.length)&&hg(t)&&r.push(t),r.push(...n),r}(t,i,e.containerClass).map(a=>A4(a)(n));return{selectorOptions:i,argumentSelectorFunctions:o}}(r,n,e),{suppressErrors:o}=s;return function(c){const l=i.map(u=>u(c));try{return t(...l)}catch(u){if(o&&u instanceof TypeError)return;throw u}}}}(i,n,r),r}function sh(n){return(e,t,r)=>{r||=Object.getOwnPropertyDescriptor(e,t);const i=r?.value,s=mg(n,i,{containerClass:e,selectorName:t.toString(),getSelectorOptions:()=>({})});return{configurable:!0,get:()=>s,originalFn:i}}}function OIe(n){return Bs([MSe(n)?{provide:TM,useClass:n,multi:!0}:{provide:TM,useValue:n,multi:!0},{provide:Dr,useValue:()=>A(IM),multi:!0}])}const z4="NGXS_DATA_META",PM="NGXS_META",G4="NGXS_ARGUMENT_REGISTRY_META";function W4(n=LIe){return bt((e,t)=>{let r=!1;e.subscribe(_t(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function LIe(){return new gd}let $4=(()=>{class n{constructor(t){this.subscription=null,this.sequence$=new Qt(0),t&&(this.subscription=t.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){this.sequence$.next(0),this.subscription?.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}static{this.\u0275fac=function(r){return new(r||n)(X(Zi,8))}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac})}}return n})();function _g(n){return n[z4]}let Di=(()=>{class n{static{this.store=null}static{this.computed=null}static{this.context=null}static{this.factory=null}static{this.ngZone=null}static{this.injector=null}constructor(t,r,i){n.store=t.get(Zi),n.ngZone=t.get(ye),n.factory=r,n.context=i,n.computed=t.get($4),n.injector=t}static{this.\u0275fac=function(r){return new(r||n)(X(pt),X(t4),X(n4))}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac})}}return n})();class Zn{static{this.statesCachedMeta=new Map}constructor(){Zn.statesCachedMeta.clear()}static createStateContext(e){return Di.context.createStateContext(e)}static ensureMappedState(e){if(ui(Di.factory)||ui(e))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return(Gr(e.name)?Zn.statesCachedMeta.get(e.name):null)||Zn.ensureMeta(e)}static getRepositoryByInstance(e){const r=_g(Zn.getStateClassByInstance(e))??null;if(ui(r))throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return r}static getStateClassByInstance(e){return(e??{}).constructor}static clearMetaByInstance(e){const t=Zn.getRepositoryByInstance(e);t.stateMeta.actions={},t.operations={}}static createPayload(e,t){const r={},i=Array.from(e);for(const[s,o]of i.entries()){const a=t?.getPayloadTypeByIndex(s);Gr(a)&&(r[a]=o)}return Object.keys(r).length>0?r:null}static createAction(e,t,r){const i=Zn.createPayload(t,r),s=function jIe(n){return class{constructor(t){if(t)for(const r of Object.keys(t))this[r]=t[r]}static get type(){return n}}}(e);return new s(i)}static ensureMeta(e){const t=Gr(e.name)?Di.factory._states?.find(r=>r.name===e.name):null;return Gr(t)&&Gr(e.name)&&Zn.statesCachedMeta.set(e.name,t),t}static{this.\u0275fac=function(t){return new(t||Zn)}}static{this.\u0275prov=U({token:Zn,factory:Zn.\u0275fac})}}new class VIe{constructor(){this.subject=new Wo(1)}init(){this.subject.next()}onInit(e){this.subject.pipe(function ha(n,e){const t=arguments.length>=2;return r=>r.pipe(n?gt((i,s)=>n(i,s,r)):Ni,Vn(1),t?nh(e):W4(()=>new gd))}()).subscribe(e)}reset(){this.subject.complete(),this.subject=new Wo(1)}};class zIe extends Error{constructor(e){super(`Child states can only be added to an object. Cannot convert ${Gr(e?.constructor)?e.constructor.name:e} to PlainObject`)}}function q4(n){return n.NGXS_OPTIONS_META??{name:""}}function X4(n){const e=q4(n),t=e.children??[],i=zG(void 0===e.defaults?{}:e.defaults);if(t.length>0){if(GG(i))return function GIe(n,e){return e.reduce((t,r)=>{const i=q4(r);if(function dg(n){const e="string"==typeof n?n.trim():n;return[void 0,null,NaN,"",1/0].includes(e)}(i.name))throw new Error("State name not provided in class");return t[i.name.toString()]=X4(r),t},n??{})}(i,t);throw new zIe(i)}return i}function Y4(){return"__NGXS_COMPUTED_OPTION__"}function Z4(n){return n.__NGXS_COMPUTED_OPTION__??null}function K4(){return Di?.computed?.sequenceValue??0}function qIe(n){let e=!1;return Cs(n)&&(e=!0),e}function NM(n){return n[G4]}class XIe extends Error{constructor(e,t){super(`An argument with the name '${e}' already exists in the method '${t}'`)}}class YIe{constructor(){this.payloadMap=new Map,this.argumentMap=new Map}getPayloadTypeByIndex(e){return this.payloadMap.get(e)??null}getArgumentNameByIndex(e){return this.argumentMap.get(e)??null}createPayloadType(e,t,r){this.checkDuplicateName(e,t),this.payloadMap.set(r,e),this.payloadMap.set(e,e)}createArgumentName(e,t,r){this.checkDuplicateName(e,t),this.argumentMap.set(r,e),this.argumentMap.set(e,e)}checkDuplicateName(e,t){if(vM(this.argumentMap.has(e))||vM(this.payloadMap.has(e)))throw new XIe(e,t)}}function tMe(n){return{enumerable:!0,configurable:!0,get(){const e=_g(n),t=Zn.ensureMappedState(e.stateMeta);return Zn.createStateContext(t.path)}}}const aMe={dataActionSubscribeRequired:!0},cMe=new P("NGXS_DATA_CONFIG",{providedIn:"root",factory:()=>aMe});let lMe=(()=>{class n{constructor(t,r){this.accessor=t,this.injector=r}static forRoot(t=[]){return{ngModule:n,providers:[Zn,Di,$4,Bs([{provide:n4,useExisting:DM},{provide:t4,useExisting:cb}]),...t]}}static{this.\u0275fac=function(r){return new(r||n)(X(Zn,2),X(Di,2))}}static{this.\u0275mod=ji({type:n})}static{this.\u0275inj=fi({})}}return n})();function J4(){return(n,e,t)=>{!function UIe(n,e){if(!function cSe(n,e){let t=n,r=!1;if(GG(t))for(;null!==t;){if(th(t?.hasOwnProperty(e))){r=!!Object.getOwnPropertyDescriptor(t,e)?.get;break}t=Object.getPrototypeOf(t)}return r}(n,e?.toString()))throw new Error(`The method must be a getter for the computed decorator to work properly.\nExample: \n@Computed() get ${e.toString()}() { \n\t .. \n}`)}(n,e);const r=t.get;return t.get=function(...i){const s=function $Ie(n){return ui(Z4(n))&&Object.defineProperties(n,{[Y4()]:{enumerable:!0,configurable:!0,value:new WeakMap}}),Z4(n)}(this),o=s?.get(r);if(th(o?.isObservable))return o?.value;if(ui(o)||o.sequenceId!==K4()){s.delete(r);const c=r.apply(this,i);return s.set(r,{value:c,sequenceId:K4(),isObservable:qIe(c)}),c}return o?.value},t}}const uMe={cancelUncompleted:!0,insideZone:!1,subscribeRequired:!0};function fb(n={}){const e=function dMe(n){const e=Di?.injector?.get(cMe,void 0,Ke.Optional),t={...uMe};return Gr(e)&&void 0!==e?.dataActionSubscribeRequired&&(t.subscribeRequired=e.dataActionSubscribeRequired),{...t,...n}}(n);return(t,r,i)=>{!function BIe(n,e){if(n.hasOwnProperty("prototype"))throw new Error("Cannot support static methods with @DataAction()");if(void 0===e)throw new Error("@DataAction() can only decorate a method implementation")}(t,i);const s=i.value,o=r.toString();return i.value=function(...a){const c=this;let l=null;const u=Zn.getRepositoryByInstance(c),d=u.operations;let h=d[o];const f=ui(h),p=u.stateMeta,g=NM(s);if(f){const E=function oMe(n){return String(n).replaceAll(/\/\/.*$/gm,"").replaceAll(/\s+/g,"").replaceAll(/\/\*[^*/]*\*\//g,"").split("){",1)?.[0]?.replace(/^[^(]*\(/,"").replaceAll(/=[^,]+/g,"").split(",").filter(Boolean)??[]}(s),T=function HIe(n){const{statePath:e,argumentsNames:t,methodName:r,argumentRegistry:i}=n;let s="";for(let o=0;o<t.length;o++)Gr(i?.getArgumentNameByIndex(o))?s+=i?.getArgumentNameByIndex(o):Gr(i?.getPayloadTypeByIndex(o))?s+=i?.getPayloadTypeByIndex(o):s+=`$arg${o}`,o!==t.length-1&&(s+=", ");return`@${e.replaceAll(".","/")}.${r}(${s})`}({statePath:p.path,methodName:o,argumentsNames:E,argumentRegistry:g});h=d[o]={type:T,options:{cancelUncompleted:e.cancelUncompleted??!1}},p.actions[h.type]=[{type:h.type,options:h.options,fn:h.type}]}const m=Zn.ensureMappedState(p);m.instance[h.type]=()=>(th(e.insideZone)?Di.ngZone?.run(()=>{l=s.apply(c,a)}):l=s.apply(c,a),Cs(l)&&th(e.subscribeRequired)?ie(null).pipe(he(()=>l)):l),f&&Di.factory.hydrateActionMetasMap({...m,actions:{[h.type]:m.actions[h.type]}});const v=Zn.createAction(h.type,a,g),_=Di.store.dispatch(v);return Cs(l)?function WIe(n,e){return sb([n,e]).pipe(he(t=>t.pop()))}(_,l):l},i}}function Q4(n){return(e,t,r)=>{const i=n.trim();if(!i)throw new Error("Payload name should be initialized");(function ZIe(n,e){const t=n[e];return ui(NM(t))&&Object.defineProperties(t,{[G4]:{enumerable:!0,configurable:!0,value:new YIe}}),NM(t)})(e,t).createPayloadType(i,t,r)}}function e8(){return n=>{const e=function sMe(n){if(function Kxe(n){return!vM(n)}(n.hasOwnProperty(PM))){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,PM,{value:e})}return function iMe(n){return n?.[PM]}(n)}(n);if(ui(e.name))throw new Error("@StateRepository should be add before decorator @State");!function QIe(n,e){(function JIe(n){const e=_g(n)??null;return(ui(e)||e?.stateClass!==n)&&function KIe(n){Object.defineProperty(n,z4,{writable:!0,configurable:!0,enumerable:!0,value:{stateMeta:null,operations:{},stateClass:n}})}(n),_g(n)}(n)).stateMeta=e}(n,e),function fMe(n,e,t){Object.defineProperties(n.prototype,{name:{enumerable:!0,configurable:!0,value:e.name},initialState:{enumerable:!0,configurable:!0,get:()=>zG(t)},context:tMe(n)})}(n,e,X4(n)),function nMe(n){const t=_g(n)?.stateMeta?.name??null;if(Gr(t)){const r=`__${t}__selector`;Object.defineProperties(n.prototype,{[r]:{writable:!0,enumerable:!1,configurable:!0},state$:{enumerable:!0,configurable:!0,get(){if(Gr(this[r]))return this[r];if(ui(Di.store))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return this[r]=Di.store.select(n).pipe(he(i=>i),Mi({refCount:!0,bufferSize:1})),this[r]}}})}}(n)}}let pMe=(()=>{class n{constructor(){this._dirty=!0,this.browserStorageEvents$=new fe,this.isInitialised=!1,this.isBootstrapped=!1}get dirty(){return this._dirty}set dirty(t){this._dirty=t}ngxsOnChanges(t){this.dirty&&this.isBootstrapped&&(this.dirty=!1,this.ngxsDataDoCheck?.())}ngxsOnInit(){this.isInitialised=!0}ngxsAfterBootstrap(){this.isBootstrapped=!0,this.dirty&&(this.dirty=!1,this.ngxsDataDoCheck?.())}markAsDirtyAfterReset(){this.dirty=!0,this.ngxsDataAfterReset?.()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac})}}return n})(),t8=(()=>{class n extends pMe{get snapshot(){return this.getState()}get ctx(){return function rMe(n){if(!n)throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return{...n,getState:()=>n.getState(),setState(e){n.setState(e)},patchState(e){n.patchState(e)}}}(this.context)}patchState(t){this.ctx.patchState(t)}setState(t){this.ctx.setState(t)}reset(){this.ctx.setState(this.initialState),this.markAsDirtyAfterReset()}getState(){return this.ctx.getState()}dispatch(t){return this.ctx.dispatch(t)}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Bi(n)))(i||n)}})()}static{this.\u0275prov=U({token:n,factory:n.\u0275fac})}}return Ye([J4()],n.prototype,"snapshot",null),Ye([fb(),yA(0,Q4("patchValue"))],n.prototype,"patchState",null),Ye([fb(),yA(0,Q4("stateValue"))],n.prototype,"setState",null),Ye([fb()],n.prototype,"reset",null),n})();function n8(...n){const e=n.length;if(0===e)throw new Error("list of properties cannot be empty.");return he(t=>{let r=t;for(let i=0;i<e;i++){const s=r?.[n[i]];if(!(typeof s<"u"))return;r=s}return r})}let bc=class Xg extends t8{optionCache=new Map;get config$(){return this.state$.pipe(function gMe(){return gt(n=>null!=n)}(),Mi(1))}setConfig(e){this.setState(e)}patchConfig(e){this.patchState(e)}getProperty(e){return this.config$.pipe(n8(...e),rh(),Mi(1))}getOption(...e){const t=this.getPathKey(e);if(this.optionCache.has(t))return this.optionCache.get(t)??ie();const r=this.config$.pipe(n8(...e),rh(),Mi(1));return this.optionCache.set(t,r),r}getPathKey(e){return`${e.length}:${e.join(".")}`}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Bi(Xg)))(r||Xg)}})();static \u0275prov=U({token:Xg,factory:Xg.\u0275fac})};Ye([J4(),Q("design:type",Se),Q("design:paramtypes",[])],bc.prototype,"config$",null),bc=Ye([e8(),OM({name:"globalConfig",defaults:null})],bc);const r8="ALLOW_TELEMETRY",_Me=i8();function i8(){const n=localStorage.getItem(r8);return null===n?void 0:"true"===n.toLowerCase()}let kM=class Yg extends t8{setAllowTelemetry(e){const t=i8();localStorage.setItem(r8,e.toString()),this.ctx.patchState({allowTelemetry:e}),(void 0!==t||!1===e)&&location.reload()}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Bi(Yg)))(r||Yg)}})();static \u0275prov=U({token:Yg,factory:Yg.\u0275fac})};function Ol(...n){const e=tp(n),t=GB(n),{args:r,keys:i}=qG(n);if(0===r.length)return Ln([],e);const s=new Se(function yMe(n,e,t=Ni){return r=>{s8(e,()=>{const{length:i}=n,s=new Array(i);let o=i,a=i;for(let c=0;c<i;c++)s8(e,()=>{const l=Ln(n[c],e);let u=!1;l.subscribe(_t(r,d=>{s[c]=d,u||(u=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,e,i?o=>XG(i,o):Ni));return t?s.pipe(wM(t)):s}function s8(n,e,t){n?$o(t,n,e):e()}function pb(n){return new Se(e=>{rr(n()).subscribe(e)})}function gb(){return bt((n,e)=>{let t=null;n._refCount++;const r=_t(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}Ye([fb(),Q("design:type",Function),Q("design:paramtypes",[Boolean]),Q("design:returntype",void 0)],kM.prototype,"setAllowTelemetry",null),kM=Ye([e8(),OM({name:"tracking",defaults:{allowTelemetry:_Me}})],kM);class LM extends Se{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Ea(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Mt;const t=this.getSubject();e.add(this.source.subscribe(_t(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Mt.EMPTY)}return e}refCount(){return gb()(this)}}Error;const lD=new P("ngx-google-analytics-settings",{factory:()=>({trackingCode:"",enableTracing:!1})}),uD=new P("ngx-window",{providedIn:"root",factory:()=>{const{defaultView:n}=A(vt);if(!n)throw new Error("Window is not available");return n}}),ORe=new P("ngx-data-layer",{providedIn:"root",factory:()=>function RRe(n){return n?n.dataLayer=n.dataLayer||[]:null}(A(uD))}),c9=new P("ngx-gtag-fn",{providedIn:"root",factory:()=>function PRe(n,e){return n?n.gtag=n.gtag||function(){e.push(arguments)}:null}(A(uD),A(ORe))});let dD=(()=>{class n{constructor(t,r,i){this.settings=t,this._document=r,this._gtag=i}get document(){return this._document}throw(t){this.settings.enableTracing&&console&&console.error&&console.error(t)}toKeyValue(t){return t.size>0?Array.from(t).reduce((r,[i,s])=>Object.defineProperty(r,i,{value:s,enumerable:!0}),{}):void 0}gtag(...t){try{this._gtag(...t.filter(r=>void 0!==r))}catch(r){this.throw(r)}}event(t,r,i,s,o,a){try{const c=new Map;r&&c.set("event_category",r),i&&c.set("event_label",i),s&&c.set("value",s),void 0!==o&&c.set("interaction",o),a&&Object.entries(a).map(([u,d])=>c.set(u,d));const l=this.toKeyValue(c);l?this.gtag("event",t,l):this.gtag("event",t)}catch(c){this.throw(c)}}pageView(t,r,i,s){try{const o=new Map([["page_path",t]]);r&&o.set("page_title",r),(i||this.document)&&o.set("page_location",i||this.document.location.href),s&&Object.entries(s).map(([a,c])=>o.set(a,c)),this.gtag("config",this.settings.trackingCode,this.toKeyValue(o))}catch(o){this.throw(o)}}appView(t,r,i,s,o){try{const a=new Map([["screen_name",t],["app_name",r]]);i&&a.set("app_id",i),s&&a.set("app_version",s),o&&a.set("app_installer_id",o),this.gtag("event","screen_view",this.toKeyValue(a))}catch(a){this.throw(a)}}set(...t){try{this._gtag("set",...t)}catch(r){this.throw(r)}}exception(t,r){try{const i=new Map;t&&i.set("description",t),r&&i.set("fatal",r),this.toKeyValue(i)?this.gtag("event","exception",this.toKeyValue(i)):this.gtag("event","exception")}catch(i){this.throw(i)}}}return n.\u0275fac=function(t){return new(t||n)(X(lD),X(vt),X(c9))},n.\u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();new P("ngx-google-analytics-routing-settings",{factory:()=>({})}),new P("Key under which consent is stored",{providedIn:"root",factory:()=>"ALLOW_TELEMETRY"});class Nb{}class kb{}class lr{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const r=t.indexOf(":");if(r>0){const i=t.slice(0,r),s=t.slice(r+1).trim();this.addHeaderEntry(i,s)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.addHeaderEntry(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof lr?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new lr;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof lr?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(e.name,t);const i=("a"===e.op?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}addHeaderEntry(e,t){const r=e.toLowerCase();this.maybeSetNormalizedName(e,r),this.headers.has(r)?this.headers.get(r).push(t):this.headers.set(r,[t])}setHeaderEntries(e,t){const r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class VRe{encodeKey(e){return u9(e)}encodeValue(e){return u9(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const zRe=/%(\d[a-f0-9])/gi,GRe={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function u9(n){return encodeURIComponent(n).replace(zRe,(e,t)=>GRe[t]??e)}function Fb(n){return`${n}`}class tt{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new VRe,e.fromString){if(e.fromObject)throw new V(2805,!1);this.map=function HRe(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{const s=i.indexOf("="),[o,a]=-1==s?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=t.get(o)||[];c.push(a),t.set(o,c)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const r=e.fromObject[t],i=Array.isArray(r)?r.map(Fb):[Fb(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(r=>{const i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new tt({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Fb(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let r=this.map.get(e.param)||[];const i=r.indexOf(Fb(e.value));-1!==i&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Ze{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function d9(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function h9(n){return typeof Blob<"u"&&n instanceof Blob}function f9(n){return typeof FormData<"u"&&n instanceof FormData}const Pg="Content-Type",hD="X-Request-URL",p9="text/plain",g9="application/json",m9=`${g9}, ${p9}, */*`;class fh{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(e,t,r,i){let s;if(this.url=t,this.method=e.toUpperCase(),function WRe(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new lr,this.context??=new Ze,this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new tt,this.urlWithParams=t}serializeBody(){return null===this.body?null:"string"==typeof this.body||d9(this.body)||h9(this.body)||f9(this.body)||function $Re(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)?this.body:this.body instanceof tt?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||f9(this.body)?null:h9(this.body)?this.body.type||null:d9(this.body)?null:"string"==typeof this.body?p9:this.body instanceof tt?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?g9:null}clone(e={}){const t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=void 0!==e.body?e.body:this.body,a=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress;let l=e.headers||this.headers,u=e.params||this.params;const d=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((h,f)=>h.set(f,e.setHeaders[f]),l)),e.setParams&&(u=Object.keys(e.setParams).reduce((h,f)=>h.set(f,e.setParams[f]),u)),new fh(t,r,o,{params:u,headers:l,context:d,reportProgress:c,responseType:i,withCredentials:a,transferCache:s})}}var wo=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(wo||{});class fD{headers;status;statusText;url;ok;type;constructor(e,t=200,r="OK"){this.headers=e.headers||new lr,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class Bb extends fD{constructor(e={}){super(e)}type=wo.ResponseHeader;clone(e={}){return new Bb({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Ll extends fD{body;constructor(e={}){super(e),this.body=void 0!==e.body?e.body:null}type=wo.Response;clone(e={}){return new Ll({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class ph extends fD{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function pD(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}let Ds=(()=>{class n{handler;constructor(t){this.handler=t}request(t,r,i={}){let s;if(t instanceof fh)s=t;else{let c,l;c=i.headers instanceof lr?i.headers:new lr(i.headers),i.params&&(l=i.params instanceof tt?i.params:new tt({fromObject:i.params})),s=new fh(t,r,void 0!==i.body?i.body:null,{headers:c,context:i.context,params:l,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}const o=ie(s).pipe(function yg(n,e){return dt(e)?Cn(n,e,1):Cn(n,1)}(c=>this.handler.handle(c)));if(t instanceof fh||"events"===i.observe)return o;const a=o.pipe(gt(c=>c instanceof Ll));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(he(c=>{if(null!==c.body&&!(c.body instanceof ArrayBuffer))throw new V(2806,!1);return c.body}));case"blob":return a.pipe(he(c=>{if(null!==c.body&&!(c.body instanceof Blob))throw new V(2807,!1);return c.body}));case"text":return a.pipe(he(c=>{if(null!==c.body&&"string"!=typeof c.body)throw new V(2808,!1);return c.body}));default:return a.pipe(he(c=>c.body))}case"response":return a;default:throw new V(2809,!1)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:(new tt).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,pD(i,r))}post(t,r,i={}){return this.request("POST",t,pD(i,r))}put(t,r,i={}){return this.request("PUT",t,pD(i,r))}static \u0275fac=function(r){return new(r||n)(X(Nb))};static \u0275prov=U({token:n,factory:n.\u0275fac})}return n})();const v9=new P("");function b9(n,e){return e(n)}const Ng=new P(""),w9=new P(""),E9=new P("",{providedIn:"root",factory:()=>!0});let C9=(()=>{class n extends Nb{backend;injector;chain=null;pendingTasks=A(Gs);contributeToStability=A(E9);constructor(t,r){super(),this.backend=t,this.injector=r}handle(t){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(Ng),...this.injector.get(w9,[])]));this.chain=r.reduceRight((i,s)=>function QRe(n,e,t){return(r,i)=>gi(t,()=>e(r,s=>n(s,i)))}(i,s,this.injector),b9)}if(this.contributeToStability){const r=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(Dl(()=>this.pendingTasks.remove(r)))}return this.chain(t,r=>this.backend.handle(r))}static \u0275fac=function(r){return new(r||n)(X(kb),X(Qn))};static \u0275prov=U({token:n,factory:n.\u0275fac})}return n})();const o1e=/^\)\]\}',?\n/,a1e=RegExp(`^${hD}:`,"m");let T9=(()=>{class n{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new V(-2800,!1);const r=this.xhrFactory;return(r.\u0275loadImpl?Ln(r.\u0275loadImpl()):ie(null)).pipe(Bn(()=>new Se(s=>{const o=r.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((g,m)=>o.setRequestHeader(g,m.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept",m9),!t.headers.has(Pg)){const g=t.detectContentTypeHeader();null!==g&&o.setRequestHeader(Pg,g)}if(t.responseType){const g=t.responseType.toLowerCase();o.responseType="json"!==g?g:"text"}const a=t.serializeBody();let c=null;const l=()=>{if(null!==c)return c;const g=o.statusText||"OK",m=new lr(o.getAllResponseHeaders()),y=function c1e(n){return"responseURL"in n&&n.responseURL?n.responseURL:a1e.test(n.getAllResponseHeaders())?n.getResponseHeader(hD):null}(o)||t.url;return c=new Bb({headers:m,status:o.status,statusText:g,url:y}),c},u=()=>{let{headers:g,status:m,statusText:y,url:v}=l(),_=null;204!==m&&(_=typeof o.response>"u"?o.responseText:o.response),0===m&&(m=_?200:0);let E=m>=200&&m<300;if("json"===t.responseType&&"string"==typeof _){const T=_;_=_.replace(o1e,"");try{_=""!==_?JSON.parse(_):null}catch(I){_=T,E&&(E=!1,_={error:I,text:_})}}E?(s.next(new Ll({body:_,headers:g,status:m,statusText:y,url:v||void 0})),s.complete()):s.error(new ph({error:_,headers:g,status:m,statusText:y,url:v||void 0}))},d=g=>{const{url:m}=l(),y=new ph({error:g,status:o.status||0,statusText:o.statusText||"Unknown Error",url:m||void 0});s.error(y)};let h=!1;const f=g=>{h||(s.next(l()),h=!0);let m={type:wo.DownloadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),"text"===t.responseType&&o.responseText&&(m.partialText=o.responseText),s.next(m)},p=g=>{let m={type:wo.UploadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),s.next(m)};return o.addEventListener("load",u),o.addEventListener("error",d),o.addEventListener("timeout",d),o.addEventListener("abort",d),t.reportProgress&&(o.addEventListener("progress",f),null!==a&&o.upload&&o.upload.addEventListener("progress",p)),o.send(a),s.next({type:wo.Sent}),()=>{o.removeEventListener("error",d),o.removeEventListener("abort",d),o.removeEventListener("load",u),o.removeEventListener("timeout",d),t.reportProgress&&(o.removeEventListener("progress",f),null!==a&&o.upload&&o.upload.removeEventListener("progress",p)),o.readyState!==o.DONE&&o.abort()}})))}static \u0275fac=function(r){return new(r||n)(X(y2))};static \u0275prov=U({token:n,factory:n.\u0275fac})}return n})();const _D=new P(""),x9=new P("",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),S9=new P("",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class I9{}let d1e=(()=>{class n{doc;platform;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,r,i){this.doc=t,this.platform=r,this.cookieName=i}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=c2(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(r){return new(r||n)(X(vt),X(ko),X(x9))};static \u0275prov=U({token:n,factory:n.\u0275fac})}return n})();function h1e(n,e){const t=n.url.toLowerCase();if(!A(_D)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const r=A(I9).getToken(),i=A(S9);return null!=r&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,r)})),e(n)}function f1e(...n){const e=[Ds,T9,C9,{provide:Nb,useExisting:C9},{provide:kb,useFactory:()=>A(v9,{optional:!0})??A(T9)},{provide:Ng,useValue:h1e,multi:!0},{provide:_D,useValue:!0},{provide:I9,useClass:d1e}];for(const t of n)e.push(...t.\u0275providers);return Bs(e)}class vD{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const bD=new P("basePath");class gh{apiKeys;username;password;accessToken;basePath;withCredentials;encoder;encodeParam;credentials;constructor(e={}){this.apiKeys=e.apiKeys,this.username=e.username,this.password=e.password,this.accessToken=e.accessToken,this.basePath=e.basePath,this.withCredentials=e.withCredentials,this.encoder=e.encoder,this.encodeParam=e.encodeParam?e.encodeParam:t=>this.defaultEncodeParam(t),this.credentials=e.credentials?e.credentials:{}}selectHeaderContentType(e){if(0===e.length)return;const t=e.find(r=>this.isJsonMime(r));return void 0===t?e[0]:t}selectHeaderAccept(e){if(0===e.length)return;const t=e.find(r=>this.isJsonMime(r));return void 0===t?e[0]:t}isJsonMime(e){const t=new RegExp("^(application/json|[^;/ \t]+/[^;/ \t]+[+]json)[ \t]*(;.*)?$","i");return null!==e&&(t.test(e)||"application/json-patch+json"===e.toLowerCase())}lookupCredential(e){const t=this.credentials[e];return"function"==typeof t?t():t}defaultEncodeParam(e){const t="date-time"===e.dataFormat&&e.value instanceof Date?e.value.toISOString():e.value;return encodeURIComponent(String(t))}}let wD=(()=>{class n{httpClient;basePath="https://apps.humanatlas.io/api";defaultHeaders=new lr;configuration=new gh;encoder;constructor(t,r,i){this.httpClient=t,i&&(this.configuration=i),"string"!=typeof this.configuration.basePath&&("string"!=typeof r&&(r=this.basePath),this.configuration.basePath=r),this.encoder=this.configuration.encoder||new vD}addToHttpParams(t,r,i){return this.addToHttpParamsRecursive(t,r,i)}addToHttpParamsRecursive(t,r,i){if(null==r)return t;if("object"==typeof r)if(Array.isArray(r))r.forEach(s=>t=this.addToHttpParamsRecursive(t,s,i));else if(r instanceof Date){if(null==i)throw Error("key may not be null if value is Date");t=t.append(i,r.toISOString().substr(0,10))}else Object.keys(r).forEach(s=>t=this.addToHttpParamsRecursive(t,r[s],null!=i?`${i}.${s}`:s));else{if(null==i)throw Error("key may not be null if value is not object or array");t=t.append(i,r)}return t}aggregateResults(t,r="body",i=!1,s){const o=t.age,a=t.ageRange,c=t.bmi,l=t.bmiRange,u=t.cache,d=t.ontologyTerms,h=t.cellTypeTerms,f=t.consortiums,p=t.providers,g=t.sex,m=t.spatial,y=t.technologies,v=t.token;let _=new tt({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(M=>{_=this.addToHttpParams(_,M,"ontology-terms")}),h&&h.forEach(M=>{_=this.addToHttpParams(_,M,"cell-type-terms")}),f&&f.forEach(M=>{_=this.addToHttpParams(_,M,"consortiums")}),p&&p.forEach(M=>{_=this.addToHttpParams(_,M,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(M=>{_=this.addToHttpParams(_,M,"spatial")}),y&&y.forEach(M=>{_=this.addToHttpParams(_,M,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let E=this.defaultHeaders,T=s&&s.httpHeaderAccept;void 0===T&&(T=this.configuration.selectHeaderAccept(["application/json"])),void 0!==T&&(E=E.set("Accept",T));let I=s&&s.context;void 0===I&&(I=new Ze);let D="json";return T&&(D=T.startsWith("text")?"text":this.configuration.isJsonMime(T)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/aggregate-results`,{context:I,params:_,responseType:D,withCredentials:this.configuration.withCredentials,headers:E,observe:r,reportProgress:i})}anatomicalSystemsTreeModel(t,r="body",i=!1,s){const o=t.cache,a=t.token;let c=new tt({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ze);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/anatomical-systems-tree-model`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:i})}biomarkerTermOccurences(t,r="body",i=!1,s){const o=t.age,a=t.ageRange,c=t.bmi,l=t.bmiRange,u=t.cache,d=t.ontologyTerms,h=t.cellTypeTerms,f=t.consortiums,p=t.providers,g=t.sex,m=t.spatial,y=t.technologies,v=t.token;let _=new tt({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(M=>{_=this.addToHttpParams(_,M,"ontology-terms")}),h&&h.forEach(M=>{_=this.addToHttpParams(_,M,"cell-type-terms")}),f&&f.forEach(M=>{_=this.addToHttpParams(_,M,"consortiums")}),p&&p.forEach(M=>{_=this.addToHttpParams(_,M,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(M=>{_=this.addToHttpParams(_,M,"spatial")}),y&&y.forEach(M=>{_=this.addToHttpParams(_,M,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let E=this.defaultHeaders,T=s&&s.httpHeaderAccept;void 0===T&&(T=this.configuration.selectHeaderAccept(["application/json"])),void 0!==T&&(E=E.set("Accept",T));let I=s&&s.context;void 0===I&&(I=new Ze);let D="json";return T&&(D=T.startsWith("text")?"text":this.configuration.isJsonMime(T)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/biomarker-term-occurences`,{context:I,params:_,responseType:D,withCredentials:this.configuration.withCredentials,headers:E,observe:r,reportProgress:i})}biomarkerTreeModel(t,r="body",i=!1,s){const o=t.cache,a=t.token;let c=new tt({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ze);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/biomarker-tree-model`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:i})}cellTypeTermOccurences(t,r="body",i=!1,s){const o=t.age,a=t.ageRange,c=t.bmi,l=t.bmiRange,u=t.cache,d=t.ontologyTerms,h=t.cellTypeTerms,f=t.consortiums,p=t.providers,g=t.sex,m=t.spatial,y=t.technologies,v=t.token;let _=new tt({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(M=>{_=this.addToHttpParams(_,M,"ontology-terms")}),h&&h.forEach(M=>{_=this.addToHttpParams(_,M,"cell-type-terms")}),f&&f.forEach(M=>{_=this.addToHttpParams(_,M,"consortiums")}),p&&p.forEach(M=>{_=this.addToHttpParams(_,M,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(M=>{_=this.addToHttpParams(_,M,"spatial")}),y&&y.forEach(M=>{_=this.addToHttpParams(_,M,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let E=this.defaultHeaders,T=s&&s.httpHeaderAccept;void 0===T&&(T=this.configuration.selectHeaderAccept(["application/json"])),void 0!==T&&(E=E.set("Accept",T));let I=s&&s.context;void 0===I&&(I=new Ze);let D="json";return T&&(D=T.startsWith("text")?"text":this.configuration.isJsonMime(T)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/cell-type-term-occurences`,{context:I,params:_,responseType:D,withCredentials:this.configuration.withCredentials,headers:E,observe:r,reportProgress:i})}cellTypeTreeModel(t,r="body",i=!1,s){const o=t.cache,a=t.token;let c=new tt({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ze);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/cell-type-tree-model`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:i})}collisions(t,r="body",i=!1,s){const o=t.spatialEntity;if(null==o)throw new Error("Required parameter spatialEntity was null or undefined when calling collisions.");let a=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(a=a.set("Accept",c));let l=s&&s.context;void 0===l&&(l=new Ze);const d=this.configuration.selectHeaderContentType(["application/json"]);void 0!==d&&(a=a.set("Content-Type",d));let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/v1/collisions`,o,{context:l,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:r,reportProgress:i})}corridor(t,r="body",i=!1,s){const o=t.spatialEntity;if(null==o)throw new Error("Required parameter spatialEntity was null or undefined when calling corridor.");let a=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["model/gltf-binary","application/json"])),void 0!==c&&(a=a.set("Accept",c));let l=s&&s.context;void 0===l&&(l=new Ze);const d=this.configuration.selectHeaderContentType(["application/json"]);return void 0!==d&&(a=a.set("Content-Type",d)),this.httpClient.post(`${this.configuration.basePath}/v1/corridor`,o,{context:l,responseType:"blob",withCredentials:this.configuration.withCredentials,headers:a,observe:r,reportProgress:i})}dbStatus(t,r="body",i=!1,s){const o=t.token;let a=new tt({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"token"));let c=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(c=c.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Ze);let d="json";return l&&(d=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/db-status`,{context:u,params:a,responseType:d,withCredentials:this.configuration.withCredentials,headers:c,observe:r,reportProgress:i})}dsGraph(t,r="body",i=!1,s){const o=t.age,a=t.ageRange,c=t.bmi,l=t.bmiRange,u=t.cache,d=t.ontologyTerms,h=t.cellTypeTerms,f=t.consortiums,p=t.providers,g=t.sex,m=t.spatial,y=t.technologies,v=t.token;let _=new tt({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(M=>{_=this.addToHttpParams(_,M,"ontology-terms")}),h&&h.forEach(M=>{_=this.addToHttpParams(_,M,"cell-type-terms")}),f&&f.forEach(M=>{_=this.addToHttpParams(_,M,"consortiums")}),p&&p.forEach(M=>{_=this.addToHttpParams(_,M,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(M=>{_=this.addToHttpParams(_,M,"spatial")}),y&&y.forEach(M=>{_=this.addToHttpParams(_,M,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let E=this.defaultHeaders,T=s&&s.httpHeaderAccept;void 0===T&&(T=this.configuration.selectHeaderAccept(["application/json"])),void 0!==T&&(E=E.set("Accept",T));let I=s&&s.context;void 0===I&&(I=new Ze);let D="json";return T&&(D=T.startsWith("text")?"text":this.configuration.isJsonMime(T)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/ds-graph`,{context:I,params:_,responseType:D,withCredentials:this.configuration.withCredentials,headers:E,observe:r,reportProgress:i})}extractionSite(t,r="body",i=!1,s){const o=t.iri;if(null==o)throw new Error("Required parameter iri was null or undefined when calling extractionSite.");let a=new tt({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"iri"));let c=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(c=c.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Ze);let d="json";return l&&(d=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/extraction-site`,{context:u,params:a,responseType:d,withCredentials:this.configuration.withCredentials,headers:c,observe:r,reportProgress:i})}getSpatialPlacement(t,r="body",i=!1,s){const o=t.getSpatialPlacementRequest;if(null==o)throw new Error("Required parameter getSpatialPlacementRequest was null or undefined when calling getSpatialPlacement.");let a=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(a=a.set("Accept",c));let l=s&&s.context;void 0===l&&(l=new Ze);const d=this.configuration.selectHeaderContentType(["application/json"]);void 0!==d&&(a=a.set("Content-Type",d));let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/v1/get-spatial-placement`,o,{context:l,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:r,reportProgress:i})}gtexRuiLocations(t,r="body",i=!1,s){const o=t.cache;let a=new tt({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"cache"));let c=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(c=c.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Ze);let d="json";return l&&(d=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/gtex/rui_locations.jsonld`,{context:u,params:a,responseType:d,withCredentials:this.configuration.withCredentials,headers:c,observe:r,reportProgress:i})}hubmapRuiLocations(t,r="body",i=!1,s){const o=t.cache,a=t.token;let c=new tt({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ze);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/hubmap/rui_locations.jsonld`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:i})}mesh3dCellPopulation(t,r="body",i=!1,s){const o=t.mesh3dCellPopulationRequest;if(null==o)throw new Error("Required parameter mesh3dCellPopulationRequest was null or undefined when calling mesh3dCellPopulation.");let a=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["text/csv","application/json"])),void 0!==c&&(a=a.set("Accept",c));let l=s&&s.context;void 0===l&&(l=new Ze);const d=this.configuration.selectHeaderContentType(["application/json"]);return void 0!==d&&(a=a.set("Content-Type",d)),this.httpClient.post(`${this.configuration.basePath}/v1/mesh-3d-cell-population`,o,{context:l,responseType:"blob",withCredentials:this.configuration.withCredentials,headers:a,observe:r,reportProgress:i})}ontologyTermOccurences(t,r="body",i=!1,s){const o=t.age,a=t.ageRange,c=t.bmi,l=t.bmiRange,u=t.cache,d=t.ontologyTerms,h=t.cellTypeTerms,f=t.consortiums,p=t.providers,g=t.sex,m=t.spatial,y=t.technologies,v=t.token;let _=new tt({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(M=>{_=this.addToHttpParams(_,M,"ontology-terms")}),h&&h.forEach(M=>{_=this.addToHttpParams(_,M,"cell-type-terms")}),f&&f.forEach(M=>{_=this.addToHttpParams(_,M,"consortiums")}),p&&p.forEach(M=>{_=this.addToHttpParams(_,M,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(M=>{_=this.addToHttpParams(_,M,"spatial")}),y&&y.forEach(M=>{_=this.addToHttpParams(_,M,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let E=this.defaultHeaders,T=s&&s.httpHeaderAccept;void 0===T&&(T=this.configuration.selectHeaderAccept(["application/json"])),void 0!==T&&(E=E.set("Accept",T));let I=s&&s.context;void 0===I&&(I=new Ze);let D="json";return T&&(D=T.startsWith("text")?"text":this.configuration.isJsonMime(T)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/ontology-term-occurences`,{context:I,params:_,responseType:D,withCredentials:this.configuration.withCredentials,headers:E,observe:r,reportProgress:i})}ontologyTreeModel(t,r="body",i=!1,s){const o=t.cache,a=t.token;let c=new tt({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ze);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/ontology-tree-model`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:i})}providerNames(t,r="body",i=!1,s){const o=t.cache,a=t.token;let c=new tt({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ze);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/provider-names`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:i})}referenceOrganScene(t,r="body",i=!1,s){const o=t.organIri;if(null==o)throw new Error("Required parameter organIri was null or undefined when calling referenceOrganScene.");const a=t.age,c=t.ageRange,l=t.bmi,u=t.bmiRange,d=t.cache,h=t.ontologyTerms,f=t.cellTypeTerms,p=t.consortiums,g=t.providers,m=t.sex,y=t.spatial,v=t.technologies,_=t.token;let E=new tt({encoder:this.encoder});null!=a&&(E=this.addToHttpParams(E,a,"age")),null!=c&&(E=this.addToHttpParams(E,c,"age-range")),null!=l&&(E=this.addToHttpParams(E,l,"bmi")),null!=u&&(E=this.addToHttpParams(E,u,"bmi-range")),null!=d&&(E=this.addToHttpParams(E,d,"cache")),h&&h.forEach(k=>{E=this.addToHttpParams(E,k,"ontology-terms")}),f&&f.forEach(k=>{E=this.addToHttpParams(E,k,"cell-type-terms")}),null!=o&&(E=this.addToHttpParams(E,o,"organ-iri")),p&&p.forEach(k=>{E=this.addToHttpParams(E,k,"consortiums")}),g&&g.forEach(k=>{E=this.addToHttpParams(E,k,"providers")}),null!=m&&(E=this.addToHttpParams(E,m,"sex")),y&&y.forEach(k=>{E=this.addToHttpParams(E,k,"spatial")}),v&&v.forEach(k=>{E=this.addToHttpParams(E,k,"technologies")}),null!=_&&(E=this.addToHttpParams(E,_,"token"));let T=this.defaultHeaders,I=s&&s.httpHeaderAccept;void 0===I&&(I=this.configuration.selectHeaderAccept(["application/json"])),void 0!==I&&(T=T.set("Accept",I));let D=s&&s.context;void 0===D&&(D=new Ze);let M="json";return I&&(M=I.startsWith("text")?"text":this.configuration.isJsonMime(I)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/reference-organ-scene`,{context:D,params:E,responseType:M,withCredentials:this.configuration.withCredentials,headers:T,observe:r,reportProgress:i})}referenceOrgans(t,r="body",i=!1,s){const o=t.cache,a=t.token;let c=new tt({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ze);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/reference-organs`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:i})}ruiReferenceData(t="body",r=!1,i){let s=this.defaultHeaders,o=i&&i.httpHeaderAccept;void 0===o&&(o=this.configuration.selectHeaderAccept(["application/json"])),void 0!==o&&(s=s.set("Accept",o));let a=i&&i.context;void 0===a&&(a=new Ze);let c="json";return o&&(c=o.startsWith("text")?"text":this.configuration.isJsonMime(o)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/rui-reference-data`,{context:a,responseType:c,withCredentials:this.configuration.withCredentials,headers:s,observe:t,reportProgress:r})}scene(t,r="body",i=!1,s){const o=t.age,a=t.ageRange,c=t.bmi,l=t.bmiRange,u=t.cache,d=t.ontologyTerms,h=t.cellTypeTerms,f=t.consortiums,p=t.providers,g=t.sex,m=t.spatial,y=t.technologies,v=t.token;let _=new tt({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(M=>{_=this.addToHttpParams(_,M,"ontology-terms")}),h&&h.forEach(M=>{_=this.addToHttpParams(_,M,"cell-type-terms")}),f&&f.forEach(M=>{_=this.addToHttpParams(_,M,"consortiums")}),p&&p.forEach(M=>{_=this.addToHttpParams(_,M,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(M=>{_=this.addToHttpParams(_,M,"spatial")}),y&&y.forEach(M=>{_=this.addToHttpParams(_,M,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let E=this.defaultHeaders,T=s&&s.httpHeaderAccept;void 0===T&&(T=this.configuration.selectHeaderAccept(["application/json"])),void 0!==T&&(E=E.set("Accept",T));let I=s&&s.context;void 0===I&&(I=new Ze);let D="json";return T&&(D=T.startsWith("text")?"text":this.configuration.isJsonMime(T)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/scene`,{context:I,params:_,responseType:D,withCredentials:this.configuration.withCredentials,headers:E,observe:r,reportProgress:i})}sennetRuiLocations(t,r="body",i=!1,s){const o=t.cache,a=t.token;let c=new tt({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ze);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/sennet/rui_locations.jsonld`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:i})}sessionToken(t,r="body",i=!1,s){const o=t.sessionTokenRequest;if(null==o)throw new Error("Required parameter sessionTokenRequest was null or undefined when calling sessionToken.");let a=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(a=a.set("Accept",c));let l=s&&s.context;void 0===l&&(l=new Ze);const d=this.configuration.selectHeaderContentType(["application/json"]);void 0!==d&&(a=a.set("Content-Type",d));let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/v1/session-token`,o,{context:l,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:r,reportProgress:i})}sparql(t,r="body",i=!1,s){const o=t.query;if(null==o)throw new Error("Required parameter query was null or undefined when calling sparql.");const a=t.token,c=t.format;let l=new tt({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"query")),null!=a&&(l=this.addToHttpParams(l,a,"token")),null!=c&&(l=this.addToHttpParams(l,c,"format"));let u=this.defaultHeaders,d=s&&s.httpHeaderAccept;void 0===d&&(d=this.configuration.selectHeaderAccept(["application/json","text/csv"])),void 0!==d&&(u=u.set("Accept",d));let h=s&&s.context;void 0===h&&(h=new Ze);let f="json";return d&&(f=d.startsWith("text")?"text":this.configuration.isJsonMime(d)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/sparql`,{context:h,params:l,responseType:f,withCredentials:this.configuration.withCredentials,headers:u,observe:r,reportProgress:i})}sparqlPost(t,r="body",i=!1,s){const o=t.sparqlQueryRequest;if(null==o)throw new Error("Required parameter sparqlQueryRequest was null or undefined when calling sparqlPost.");const a=t.token,c=t.format;let l=new tt({encoder:this.encoder});null!=a&&(l=this.addToHttpParams(l,a,"token")),null!=c&&(l=this.addToHttpParams(l,c,"format"));let u=this.defaultHeaders,d=s&&s.httpHeaderAccept;void 0===d&&(d=this.configuration.selectHeaderAccept(["application/json","text/csv"])),void 0!==d&&(u=u.set("Accept",d));let h=s&&s.context;void 0===h&&(h=new Ze);const p=this.configuration.selectHeaderContentType(["application/json","application/x-www-form-urlencoded"]);void 0!==p&&(u=u.set("Content-Type",p));let g="json";return d&&(g=d.startsWith("text")?"text":this.configuration.isJsonMime(d)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/v1/sparql`,o,{context:h,params:l,responseType:g,withCredentials:this.configuration.withCredentials,headers:u,observe:r,reportProgress:i})}technologyNames(t,r="body",i=!1,s){const o=t.cache,a=t.token;let c=new tt({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ze);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/technology-names`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:r,reportProgress:i})}tissueBlocks(t,r="body",i=!1,s){const o=t.age,a=t.ageRange,c=t.bmi,l=t.bmiRange,u=t.cache,d=t.ontologyTerms,h=t.cellTypeTerms,f=t.consortiums,p=t.providers,g=t.sex,m=t.spatial,y=t.technologies,v=t.token;let _=new tt({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(M=>{_=this.addToHttpParams(_,M,"ontology-terms")}),h&&h.forEach(M=>{_=this.addToHttpParams(_,M,"cell-type-terms")}),f&&f.forEach(M=>{_=this.addToHttpParams(_,M,"consortiums")}),p&&p.forEach(M=>{_=this.addToHttpParams(_,M,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(M=>{_=this.addToHttpParams(_,M,"spatial")}),y&&y.forEach(M=>{_=this.addToHttpParams(_,M,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let E=this.defaultHeaders,T=s&&s.httpHeaderAccept;void 0===T&&(T=this.configuration.selectHeaderAccept(["application/json"])),void 0!==T&&(E=E.set("Accept",T));let I=s&&s.context;void 0===I&&(I=new Ze);let D="json";return T&&(D=T.startsWith("text")?"text":this.configuration.isJsonMime(T)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/tissue-blocks`,{context:I,params:_,responseType:D,withCredentials:this.configuration.withCredentials,headers:E,observe:r,reportProgress:i})}static \u0275fac=function(r){return new(r||n)(X(Ds),X(bD,8),X(gh,8))};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class O1e extends Mt{constructor(e,t){super()}schedule(e,t=0){return this}}const Ub={setInterval(n,e,...t){const{delegate:r}=Ub;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=Ub;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class ED extends O1e{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,r=0){return Ub.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&Ub.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i,r=!1;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Sc(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}class kg{constructor(e,t=kg.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}}kg.now=gA.now;class CD extends kg{constructor(e,t=kg.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}}const jb=new CD(ED),P1e=jb;function AD(n,e=jb){return bt((t,r)=>{let i=null,s=null,o=null;const a=()=>{if(i){i.unsubscribe(),i=null;const l=s;s=null,r.next(l)}};function c(){const l=o+n,u=e.now();if(u<l)return i=this.schedule(void 0,l-u),void r.add(i);a()}t.subscribe(_t(r,l=>{s=l,o=e.now(),i||(i=e.schedule(c,n),r.add(i))},()=>{a(),r.complete()},void 0,()=>{s=i=null}))})}function R9(){return bt((n,e)=>{n.subscribe(_t(e,eu))})}function O9(n){return he(()=>n)}function P9(n,e){return e?t=>fg(e.pipe(Vn(1),R9()),t.pipe(P9(n))):Cn((t,r)=>rr(n(t,r)).pipe(Vn(1),O9(t)))}function Vb(n=0,e,t=P1e){let r=-1;return null!=e&&(zB(e)?t=e:r=e),new Se(i=>{let s=function N1e(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){i.closed||(i.next(o++),0<=r?this.schedule(void 0,r):i.complete())},s)})}function N9(n,e=jb){const t=Vb(n,e);return P9(()=>t)}const B1e={connector:()=>new fe};function V1e(n,e,t,r){t&&!dt(t)&&(r=t);const i=dt(t)?t:void 0;return s=>function j1e(n,e){const t=dt(n)?n:()=>n;return dt(e)?function U1e(n,e=B1e){const{connector:t}=e;return bt((r,i)=>{const s=t();rr(n(function L1e(n){return new Se(e=>n.subscribe(e))}(s))).subscribe(i),i.add(r.subscribe(s))})}(e,{connector:t}):r=>new LM(r,t)}(new Wo(n,e,r),i)(s)}class H1e{}const G1e=(n,e)=>JSON.stringify(n)===JSON.stringify(e),W1e=n=>n.map(e=>void 0!==e?JSON.parse(JSON.stringify(e)):e),Rs={storageStrategy:class z1e extends H1e{constructor(){super(...arguments),this.cachePairs=[]}add(e,t,r){this.cachePairs.push(e)}addMany(e){this.cachePairs=e}updateAtIndex(e,t){Object.assign(this.cachePairs[e],t)}update(e,t){Object.assign(this.cachePairs[e],t)}getAll(){return this.cachePairs}removeAtIndex(e){this.cachePairs.splice(e,1)}remove(e){this.cachePairs.splice(e,1)}removeAll(){this.cachePairs.length=0}},globalCacheKey:"CACHE_STORAGE",promiseImplementation:Promise},$1e=new fe;function Oi(n={}){return function(e,t,r){const i=n.cacheKey||e.constructor.name+"#"+t,s=r.value;if(r&&r.value){let o=n.storageStrategy?new n.storageStrategy:new Rs.storageStrategy;const a=[];n.cacheModifier&&n.cacheModifier.subscribe(u=>o.addMany(u(o.getAll(i,this)),i,this)),al($1e.asObservable(),n.cacheBusterObserver?n.cacheBusterObserver:function Mre(n){return n?function Dre(n){return new Se(e=>n.schedule(()=>e.complete()))}(n):si}()).subscribe(u=>{o.removeAll(i,this),a.length=0}),n.cacheResolver=n.cacheResolver||Rs.cacheResolver||G1e,n.cacheHasher=n.cacheHasher||Rs.cacheHasher||W1e,r.value=function(...u){const d=o.getAll(i,this);let h=n.cacheHasher(u),f=d.find(g=>n.cacheResolver(g.parameters,h));const p=a.find(g=>n.cacheResolver(g.parameters,h));if((n.maxAge||Rs.maxAge)&&f&&f.created&&((new Date).getTime()-new Date(f.created).getTime()>(n.maxAge||Rs.maxAge)?(o.remove?o.remove(d.indexOf(f),f,i,this):o.removeAtIndex(d.indexOf(f),i,this),f=null):(n.slidingExpiration||Rs.slidingExpiration)&&(f.created=new Date,o.update?o.update(d.indexOf(f),f,i,this):o.updateAtIndex(d.indexOf(f),f,i,this))),f){const g=ie(f.response);return n.async?g.pipe(N9(0)):g}if(p)return p.response;{const g=s.call(this,...u).pipe(Dl(()=>{const m=a.find(y=>n.cacheResolver(y.parameters,h));a.splice(a.indexOf(m),1)}),qt(m=>{(!n.shouldCacheDecider||n.shouldCacheDecider(m))&&((!(n.maxCacheCount||Rs.maxCacheCount)||1===(n.maxCacheCount||Rs.maxCacheCount)||(n.maxCacheCount||Rs.maxCacheCount)&&(n.maxCacheCount||Rs.maxCacheCount)<d.length+1)&&(o.remove?o.remove(0,d[0],i,this):o.removeAtIndex(0,i,this)),o.add({parameters:h,response:m,created:n.maxAge||Rs.maxAge?new Date:null},i,this))}),V1e(1),gb());return a.push({parameters:h,response:g,created:new Date}),g}}}return r}}const TD=new fe,mh={cacheBusterObserver:TD},Ul={cacheBusterObserver:TD,maxCacheCount:4};function k9(n,e,t){return n?{min:n[0]>e?n[0]:void 0,max:n[1]<t?n[1]:void 0}:void 0}function q1e(n){return n.map(e=>({...e,transformMatrix:new Ve(e.transformMatrix??[])}))}function X1e(n){return{age:k9(n?.ageRange,1,110),bmi:k9(n?.bmiRange,13,83),sex:n?.sex?.toLowerCase(),ontologyTerms:n?.ontologyTerms,cellTypeTerms:n?.cellTypeTerms,biomarkerTerms:n?.biomarkerTerms,consortiums:n?.consortiums,providers:n?.tmc,technologies:n?.technologies,spatial:n?.spatialSearches}}function Y1e(n,e){return n.remoteApiEndpoint===e.remoteApiEndpoint&&n.token===e.token&&(void 0!==n.token||n.filter===e.filter&&n.dataSources===e.dataSources)}class ur{api=A(wD);globalConfig=A(bc);config$=this.globalConfig.config$.pipe(he(n=>n),rh(Y1e),AD(10),Bn(e=>this.getSessionToken(e)),qt(()=>TD.next(null)),Mi(1));constructor(){this.config$.subscribe()}getDatabaseStatus(){return this.doRequest(e=>this.api.dbStatus(e))}getProviderNames(){return this.doRequest(e=>this.api.providerNames(e))}getDatasetTechnologyNames(){return this.doRequest(e=>this.api.technologyNames(e))}getOntologyTreeModel(){return this.doRequest(e=>this.api.ontologyTreeModel(e),void 0,{},n=>n)}getCellTypeTreeModel(){return this.doRequest(e=>this.api.cellTypeTreeModel(e),void 0,{},n=>n)}getBiomarkerTreeModel(){return this.doRequest(e=>this.api.biomarkerTreeModel(e),void 0,{},n=>n)}getReferenceOrgans(){return this.doRequest(e=>this.api.referenceOrgans(e),void 0,{},n=>n)}getTissueBlockResults(e){return this.doRequest(t=>this.api.tissueBlocks(t),e,{},n=>n)}getAggregateResults(e){return this.doRequest(t=>this.api.aggregateResults(t),e)}getOntologyTermOccurences(e){return this.doRequest(t=>this.api.ontologyTermOccurences(t),e)}getCellTypeTermOccurences(e){return this.doRequest(t=>this.api.cellTypeTermOccurences(t),e)}getBiomarkerTermOccurences(e){return this.doRequest(t=>this.api.biomarkerTermOccurences(t),e)}getScene(e){return this.doRequest(t=>this.api.scene(t),e,{},q1e)}getReferenceOrganScene(e,t){return this.doRequest(r=>this.api.referenceOrganScene(r),t,{organIri:e})}doRequest(e,t,r,i){const{api:s,config$:o}=this,a={...X1e(t),...r};return o.pipe(AD(50),Vn(1),qt(({remoteApiEndpoint:c,token:l})=>{s.configuration.basePath=c,l&&(a.token=l)}),Bn(()=>e(a)),he(c=>i?i(c):c))}getSessionToken(e){if(e.token)return ie(e);const{remoteApiEndpoint:t,dataSources:r=[],filter:i}=e;if(0===r.length&&void 0===i)return ie(e);const{api:s}=this,o={dataSources:r,filter:i};return s.configuration.basePath=t,s.sessionToken({sessionTokenRequest:o}).pipe(Bn(({token:a})=>this.ensureDatabaseReady(a)),he(a=>({...e,token:a})))}ensureDatabaseReady(e){return ie(void 0).pipe(function k1e(n){let t,e=1/0;return null!=n&&("object"==typeof n?({count:e=1/0,delay:t}=n):e=n),e<=0?()=>si:bt((r,i)=>{let o,s=0;const a=()=>{if(o?.unsubscribe(),o=null,null!=t){const l="number"==typeof t?Vb(t):rr(t(s)),u=_t(i,()=>{u.unsubscribe(),c()});l.subscribe(u)}else c()},c=()=>{let l=!1;o=r.subscribe(_t(i,void 0,()=>{++s<e?o?a():l=!0:i.complete()})),l&&a()};c()})}({delay:()=>this.api.dbStatus({token:e}).pipe(gt(r=>"Ready"!==r.status),Bn(r=>ie(void 0).pipe(N9(r.checkback??0))))}),R9(),function F1e(...n){return e=>fg(e,ie(...n))}(e))}static \u0275fac=function(t){return new(t||ur)};static \u0275prov=U({token:ur,factory:ur.\u0275fac,providedIn:"root"})}Ye([Oi(mh),Q("design:type",Function),Q("design:paramtypes",[]),Q("design:returntype",Se)],ur.prototype,"getProviderNames",null),Ye([Oi(mh),Q("design:type",Function),Q("design:paramtypes",[]),Q("design:returntype",Se)],ur.prototype,"getDatasetTechnologyNames",null),Ye([Oi(mh),Q("design:type",Function),Q("design:paramtypes",[]),Q("design:returntype",Se)],ur.prototype,"getOntologyTreeModel",null),Ye([Oi(mh),Q("design:type",Function),Q("design:paramtypes",[]),Q("design:returntype",Se)],ur.prototype,"getCellTypeTreeModel",null),Ye([Oi(mh),Q("design:type",Function),Q("design:paramtypes",[]),Q("design:returntype",Se)],ur.prototype,"getBiomarkerTreeModel",null),Ye([Oi(mh),Q("design:type",Function),Q("design:paramtypes",[]),Q("design:returntype",Se)],ur.prototype,"getReferenceOrgans",null),Ye([Oi(Ul),Q("design:type",Function),Q("design:paramtypes",[Object]),Q("design:returntype",Se)],ur.prototype,"getTissueBlockResults",null),Ye([Oi(Ul),Q("design:type",Function),Q("design:paramtypes",[Object]),Q("design:returntype",Se)],ur.prototype,"getAggregateResults",null),Ye([Oi(Ul),Q("design:type",Function),Q("design:paramtypes",[Object]),Q("design:returntype",Se)],ur.prototype,"getOntologyTermOccurences",null),Ye([Oi(Ul),Q("design:type",Function),Q("design:paramtypes",[Object]),Q("design:returntype",Se)],ur.prototype,"getCellTypeTermOccurences",null),Ye([Oi(Ul),Q("design:type",Function),Q("design:paramtypes",[Object]),Q("design:returntype",Se)],ur.prototype,"getBiomarkerTermOccurences",null),Ye([Oi(Ul),Q("design:type",Function),Q("design:paramtypes",[Object]),Q("design:returntype",Se)],ur.prototype,"getScene",null),Ye([Oi(Ul),Q("design:type",Function),Q("design:paramtypes",[String,Object]),Q("design:returntype",Se)],ur.prototype,"getReferenceOrganScene",null);class F9 extends Error{constructor(){super(...arguments),this.message="NgxsDispatchPluginModule is not imported"}}class tOe{constructor(){this.cancelUncompleted$=new fe}cancelPreviousAction(){this.cancelUncompleted$.next()}}const xD="\u0275fac",L9=Symbol("InjectorInstance"),B9=Symbol("FactoryHasBeenDecorated");function U9(n,e){const t=n[L9];return t?t.get(e):null}const iOe={cancelUncompleted:!1};function j9(n=iOe){return(e,t,r)=>{let i;const s=function nOe(n){return n?new tOe:null}(n.cancelUncompleted);function o(){null!==s&&s.cancelPreviousAction();const a=U9(this,Zi)||function Q1e(){throw new F9}(),c=U9(this,ye)||function eOe(){throw new F9}(),l=i.apply(this,arguments);return c.runOutsideAngular(()=>function J1e(n,e,t){return Jc(e)?function K1e(n,e){return e.then(t=>(n.dispatch(t),t))}(n,e):Cs(e)?function Z1e(n,e,t){return null!==t&&(e=e.pipe(ua(t.cancelUncompleted$))),e.subscribe({next:r=>n.dispatch(r)}),e}(n,e,t):(n.dispatch(e),e)}(a,l,s))}"function"==typeof r?.value?(i=r.value,r.value=o):Object.defineProperty(e,t,{set:a=>i=a,get:()=>o}),function rOe(n){if(B9 in n.constructor.prototype)return;const e=n.constructor;"function"==typeof e[xD]&&function SD(n){const e=n[xD];if("function"!=typeof e)return;const t=n.\u0275prov||n.\u0275pipe||n.\u0275cmp||n.\u0275dir,r=()=>{const i=e();return i[L9]=pe(pm),i};t&&(t.factory=r),Object.defineProperty(n,xD,{get:()=>r})}(e),n.constructor.prototype[B9]=!0}(e)}}let V9=(()=>class n{static type="[CallToAction] Learn More"})(),H9=(()=>class n{static type="[CallToAction] Open Dialog"})(),z9=(()=>class n{static type="[CallToAction] Close Dialog"})();function G9(n,e=0){return function sOe(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):2===arguments.length?e:0}function W9(n){return Array.isArray(n)?n:[n]}function In(n){return null==n?"":"string"==typeof n?n:`${n}px`}function yh(n){return n instanceof fn?n.nativeElement:n}const Lg={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:r}=Lg;r&&(e=r.requestAnimationFrame,t=r.cancelAnimationFrame);const i=e(s=>{t=void 0,n(s)});return new Mt(()=>t?.(i))},requestAnimationFrame(...n){const{delegate:e}=Lg;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=Lg;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0};new class aOe extends CD{flush(e){let t;this._active=!0,e?t=e.id:(t=this._scheduled,this._scheduled=void 0);const{actions:r}=this;let i;e=e||r.shift();do{if(i=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,i){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw i}}}(class oOe extends ED{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,r=0){return null!==r&&r>0?super.requestAsyncId(e,t,r):(e.actions.push(this),e._scheduled||(e._scheduled=Lg.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,r=0){var i;if(null!=r?r>0:this.delay>0)return super.recycleAsyncId(e,t,r);const{actions:s}=e;null!=t&&t===e._scheduled&&(null===(i=s[s.length-1])||void 0===i?void 0:i.id)!==t&&(Lg.cancelAnimationFrame(t),e._scheduled=void 0)}});let ID,lOe=1;const Hb={};function $9(n){return n in Hb&&(delete Hb[n],!0)}const uOe={setImmediate(n){const e=lOe++;return Hb[e]=!0,ID||(ID=Promise.resolve()),ID.then(()=>$9(e)&&n()),e},clearImmediate(n){$9(n)}},{setImmediate:dOe,clearImmediate:hOe}=uOe,zb={setImmediate(...n){const{delegate:e}=zb;return(e?.setImmediate||dOe)(...n)},clearImmediate(n){const{delegate:e}=zb;return(e?.clearImmediate||hOe)(n)},delegate:void 0};new class pOe extends CD{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:r}=this;let i;e=e||r.shift();do{if(i=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,i){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw i}}}(class fOe extends ED{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,r=0){return null!==r&&r>0?super.requestAsyncId(e,t,r):(e.actions.push(this),e._scheduled||(e._scheduled=zb.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,r=0){var i;if(null!=r?r>0:this.delay>0)return super.recycleAsyncId(e,t,r);const{actions:s}=e;null!=t&&(null===(i=s[s.length-1])||void 0===i?void 0:i.id)!==t&&(zb.clearImmediate(t),e._scheduled===t&&(e._scheduled=void 0))}});function q9(n,e=jb){return function mOe(n){return bt((e,t)=>{let r=!1,i=null,s=null,o=!1;const a=()=>{if(s?.unsubscribe(),s=null,r){r=!1;const l=i;i=null,t.next(l)}o&&t.complete()},c=()=>{s=null,o&&t.complete()};e.subscribe(_t(t,l=>{r=!0,i=l,s||rr(n(l)).subscribe(s=_t(t,a,c))},()=>{o=!0,(!r||!s||s.closed)&&t.complete()}))})}(()=>Vb(n,e))}let MD;try{MD=typeof Intl<"u"&&Intl.v8BreakIterator}catch{MD=!1}let Bg,pa=(()=>{class n{_platformId=A(ko);isBrowser=this._platformId?Ka(this._platformId):"object"==typeof document&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!(!window.chrome&&!MD)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function DD(n){return function _Oe(){if(null==Bg&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Bg=!0}))}finally{Bg=Bg||!1}return Bg}()?n:!!n.capture}var Eo=function(n){return n[n.NORMAL=0]="NORMAL",n[n.NEGATED=1]="NEGATED",n[n.INVERTED=2]="INVERTED",n}(Eo||{});let Gb,jl,RD;function Y9(){if(null==jl){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return jl=!1,jl;if("scrollBehavior"in document.documentElement.style)jl=!0;else{const n=Element.prototype.scrollTo;jl=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return jl}function Ug(){if("object"!=typeof document||!document)return Eo.NORMAL;if(null==Gb){const n=document.createElement("div"),e=n.style;n.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),r=t.style;r.width="2px",r.height="1px",n.appendChild(t),document.body.appendChild(n),Gb=Eo.NORMAL,0===n.scrollLeft&&(n.scrollLeft=1,Gb=0===n.scrollLeft?Eo.NEGATED:Eo.INVERTED),n.remove()}return Gb}function OD(){let n=typeof document<"u"&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const e=n.shadowRoot.activeElement;if(e===n)break;n=e}return n}function Ac(n){return n.composedPath?n.composedPath()[0]:n.target}function Z9(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Vl(n,e,t,r,i){const s=parseInt(RL.major),o=parseInt(RL.minor);return s>19||19===s&&o>0||0===s&&0===o?n.listen(e,t,r,i):(e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)})}const bOe=new P("cdk-dir-doc",{providedIn:"root",factory:function wOe(){return A(vt)}}),EOe=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Wb=(()=>{class n{value="ltr";change=new ze;constructor(){const t=A(bOe,{optional:!0});t&&(this.value=function COe(n){const e=n?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?EOe.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),K9=(()=>{class n{_ngZone=A(ye);_platform=A(pa);_renderer=A(Bo).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new fe;_scrolledCount=0;scrollContainers=new Map;register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const r=this.scrollContainers.get(t);r&&(r.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new Se(r=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));const i=t>0?this._scrolled.pipe(q9(t)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{i.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):ie()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((t,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(t,r){const i=this.getAncestorScrollContainers(t);return this.scrolled(r).pipe(gt(s=>!s||i.indexOf(s)>-1))}getAncestorScrollContainers(t){const r=[];return this.scrollContainers.forEach((i,s)=>{this._scrollableContainsElement(s,t)&&r.push(s)}),r}_scrollableContainsElement(t,r){let i=yh(r),s=t.getElementRef().nativeElement;do{if(i==s)return!0}while(i=i.parentElement);return!1}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),TOe=(()=>{class n{elementRef=A(fn);scrollDispatcher=A(K9);ngZone=A(ye);dir=A(Wb,{optional:!0});_scrollElement=this.elementRef.nativeElement;_destroyed=new fe;_renderer=A(Zc);_cleanupScroll;_elementScrolled=new fe;constructor(){}ngOnInit(){this._cleanupScroll=this.ngZone.runOutsideAngular(()=>this._renderer.listen(this._scrollElement,"scroll",t=>this._elementScrolled.next(t))),this.scrollDispatcher.register(this)}ngOnDestroy(){this._cleanupScroll?.(),this._elementScrolled.complete(),this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const r=this.elementRef.nativeElement,i=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=i?t.end:t.start),null==t.right&&(t.right=i?t.start:t.end),null!=t.bottom&&(t.top=r.scrollHeight-r.clientHeight-t.bottom),i&&Ug()!=Eo.NORMAL?(null!=t.left&&(t.right=r.scrollWidth-r.clientWidth-t.left),Ug()==Eo.INVERTED?t.left=t.right:Ug()==Eo.NEGATED&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=r.scrollWidth-r.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const r=this.elementRef.nativeElement;Y9()?r.scrollTo(t):(null!=t.top&&(r.scrollTop=t.top),null!=t.left&&(r.scrollLeft=t.left))}measureScrollOffset(t){const r="left",i="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const o=this.dir&&"rtl"==this.dir.value;return"start"==t?t=o?i:r:"end"==t&&(t=o?r:i),o&&Ug()==Eo.INVERTED?t==r?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:o&&Ug()==Eo.NEGATED?t==r?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==r?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}static \u0275fac=function(r){return new(r||n)};static \u0275dir=et({type:n,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]})}return n})(),J9=(()=>{class n{_platform=A(pa);_listeners;_viewportSize;_change=new fe;_document=A(vt,{optional:!0});constructor(){const t=A(ye),r=A(Bo).createRenderer(null,null);t.runOutsideAngular(()=>{if(this._platform.isBrowser){const i=s=>this._change.next(s);this._listeners=[r.listen("window","resize",i),r.listen("window","orientationchange",i)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(t=>t()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:r,height:i}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+i,right:t.left+r,height:i,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,r=this._getWindow(),i=t.documentElement,s=i.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||r.scrollY||i.scrollTop||0,left:-s.left||t.body.scrollLeft||r.scrollX||i.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(q9(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class PD{_attachedHost;attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class ND extends PD{component;viewContainerRef;injector;componentFactoryResolver;projectableNodes;constructor(e,t,r,i,s){super(),this.component=e,this.viewContainerRef=t,this.injector=r,this.projectableNodes=s}}class kD extends PD{templateRef;viewContainerRef;context;injector;constructor(e,t,r,i){super(),this.templateRef=e,this.viewContainerRef=t,this.context=r,this.injector=i}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class SOe extends PD{element;constructor(e){super(),this.element=e instanceof fn?e.nativeElement:e}}class FD{_attachedPortal;_disposeFn;_isDisposed=!1;hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof ND?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof kD?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof SOe?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}attachDomPortal=null;detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class IOe extends FD{outletElement;_appRef;_defaultInjector;_document;constructor(e,t,r,i,s){super(),this.outletElement=e,this._appRef=r,this._defaultInjector=i,this._document=s}attachComponentPortal(e){let t;if(e.viewContainerRef){const r=e.injector||e.viewContainerRef.injector,i=r.get(Uo,null,{optional:!0})||void 0;t=e.viewContainerRef.createComponent(e.component,{index:e.viewContainerRef.length,injector:r,ngModuleRef:i,projectableNodes:e.projectableNodes||void 0}),this.setDisposeFn(()=>t.destroy())}else t=pA(e.component,{elementInjector:e.injector||this._defaultInjector||pt.NULL,environmentInjector:this._appRef.injector,projectableNodes:e.projectableNodes||void 0}),this._appRef.attachView(t.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(t.hostView),t.destroy()});return this.outletElement.appendChild(this._getComponentRootNode(t)),this._attachedPortal=e,t}attachTemplatePortal(e){let t=e.viewContainerRef,r=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return r.rootNodes.forEach(i=>this.outletElement.appendChild(i)),r.detectChanges(),this.setDisposeFn(()=>{let i=t.indexOf(r);-1!==i&&t.remove(i)}),this._attachedPortal=e,r}attachDomPortal=e=>{const t=e.element,r=this._document.createComment("dom-portal");t.parentNode.insertBefore(r,t),this.outletElement.appendChild(t),this._attachedPortal=e,super.setDisposeFn(()=>{r.parentNode&&r.parentNode.replaceChild(t,r)})};dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let $b=(()=>{class n extends FD{_moduleRef=A(Uo,{optional:!0});_document=A(vt);_viewContainerRef=A(Lr);_isInitialized=!1;_attachedRef;constructor(){super()}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}attached=new ze;get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);const r=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,i=r.createComponent(t.component,{index:r.length,injector:t.injector||r.injector,projectableNodes:t.projectableNodes||void 0,ngModuleRef:this._moduleRef||void 0});return r!==this._viewContainerRef&&this._getRootNode().appendChild(i.hostView.rootNodes[0]),super.setDisposeFn(()=>i.destroy()),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}attachTemplatePortal(t){t.setAttachedHost(this);const r=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=r,this.attached.emit(r),r}attachDomPortal=t=>{const r=t.element,i=this._document.createComment("dom-portal");t.setAttachedHost(this),r.parentNode.insertBefore(i,r),this._getRootNode().appendChild(r),this._attachedPortal=t,super.setDisposeFn(()=>{i.parentNode&&i.parentNode.replaceChild(r,i)})};_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}static \u0275fac=function(r){return new(r||n)};static \u0275dir=et({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[0,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[jo]})}return n})();const qb=new WeakMap;let jg=(()=>{class n{_appRef;_injector=A(pt);_environmentInjector=A(Qn);load(t){const r=this._appRef=this._appRef||this._injector.get(nr);let i=qb.get(r);i||(i={loaders:new Set,refs:[]},qb.set(r,i),r.onDestroy(()=>{qb.get(r)?.refs.forEach(s=>s.destroy()),qb.delete(r)})),i.loaders.has(t)||(i.loaders.add(t),i.refs.push(pA(t,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),MOe=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["ng-component"]],exportAs:["cdkVisuallyHidden"],decls:0,vars:0,template:function(r,i){},styles:[".cdk-visually-hidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl] .cdk-visually-hidden{left:auto;right:0}"],encapsulation:2,changeDetection:0})}return n})();function LD(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}let a6=(()=>{class n{_platform=A(pa);constructor(){}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function XOe(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const r=function qOe(n){try{return n.frameElement}catch{return null}}(function nPe(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(t));if(r&&(-1===l6(r)||!this.isVisible(r)))return!1;let i=t.nodeName.toLowerCase(),s=l6(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===i||"object"===i||this._platform.WEBKIT&&this._platform.IOS&&!function ePe(n){let e=n.nodeName.toLowerCase(),t="input"===e&&n.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===i?!!t.hasAttribute("controls")&&-1!==s:"video"===i?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,r){return function tPe(n){return!function ZOe(n){return function JOe(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function YOe(n){let e=n.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(n)||function KOe(n){return function QOe(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||c6(n))}(t)&&!this.isDisabled(t)&&(r?.ignoreVisibility||this.isVisible(t))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function c6(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let e=n.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function l6(n){if(!c6(n))return null;const e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class u6{_element;_checker;_ngZone;_document;_injector;_startAnchor;_endAnchor;_hasAttached=!1;startAnchorListener=()=>this.focusLastTabbableElement();endAnchorListener=()=>this.focusFirstTabbableElement();get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_enabled=!0;constructor(e,t,r,i,s=!1,o){this._element=e,this._checker=t,this._ngZone=r,this._document=i,this._injector=o,s||this.attachAnchors()}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const r=this._getFirstTabbableElement(t);return r?.focus(e),!!r}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let r=0;r<t.length;r++){const i=t[r].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[r]):null;if(i)return i}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let r=t.length-1;r>=0;r--){const i=t[r].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[r]):null;if(i)return i}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._injector?nf(e,{injector:this._injector}):setTimeout(e)}}let rPe=(()=>{class n{_checker=A(a6);_ngZone=A(ye);_document=A(vt);_injector=A(pt);constructor(){A(jg).load(MOe)}create(t,r=!1){return new u6(t,this._checker,this._ngZone,this._document,r,this._injector)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const iPe=new P("cdk-input-modality-detector-options"),sPe={ignoreKeys:[18,17,224,91,16]},BD={passive:!0,capture:!0};let oPe=(()=>{class n{_platform=A(pa);_listenerCleanups;modalityDetected;modalityChanged;get mostRecentModality(){return this._modality.value}_mostRecentTarget=null;_modality=new Qt(null);_options;_lastTouchMs=0;_onKeydown=t=>{this._options?.ignoreKeys?.some(r=>r===t.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Ac(t))};_onMousedown=t=>{Date.now()-this._lastTouchMs<650||(this._modality.next(function d6(n){return 0===n.buttons||0===n.detail}(t)?"keyboard":"mouse"),this._mostRecentTarget=Ac(t))};_onTouchstart=t=>{!function h6(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}(t)?(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Ac(t)):this._modality.next("keyboard")};constructor(){const t=A(ye),r=A(vt),i=A(iPe,{optional:!0});if(this._options={...sPe,...i},this.modalityDetected=this._modality.pipe(function a9(n){return gt((e,t)=>n<=t)}(1)),this.modalityChanged=this.modalityDetected.pipe(rh()),this._platform.isBrowser){const s=A(Bo).createRenderer(null,null);this._listenerCleanups=t.runOutsideAngular(()=>[Vl(s,r,"keydown",this._onKeydown,BD),Vl(s,r,"mousedown",this._onMousedown,BD),Vl(s,r,"touchstart",this._onTouchstart,BD)])}}ngOnDestroy(){this._modality.complete(),this._listenerCleanups?.forEach(t=>t())}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Xb=function(n){return n[n.IMMEDIATE=0]="IMMEDIATE",n[n.EVENTUAL=1]="EVENTUAL",n}(Xb||{});const cPe=new P("cdk-focus-monitor-default-options"),Yb=DD({passive:!0,capture:!0});let p6=(()=>{class n{_ngZone=A(ye);_platform=A(pa);_inputModalityDetector=A(oPe);_origin=null;_lastFocusOrigin;_windowFocused=!1;_windowFocusTimeoutId;_originTimeoutId;_originFromTouchInteraction=!1;_elementInfo=new Map;_monitoredElementCount=0;_rootNodeFocusListenerCount=new Map;_detectionMode;_windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)};_document=A(vt,{optional:!0});_stopInputModalityDetector=new fe;constructor(){const t=A(cPe,{optional:!0});this._detectionMode=t?.detectionMode||Xb.IMMEDIATE}_rootNodeFocusAndBlurListener=t=>{for(let i=Ac(t);i;i=i.parentElement)"focus"===t.type?this._onFocus(t,i):this._onBlur(t,i)};monitor(t,r=!1){const i=yh(t);if(!this._platform.isBrowser||1!==i.nodeType)return ie();const s=function vOe(n){if(function yOe(){if(null==RD){const n=typeof document<"u"?document.head:null;RD=!(!n||!n.createShadowRoot&&!n.attachShadow)}return RD}()){const e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(i)||this._getDocument(),o=this._elementInfo.get(i);if(o)return r&&(o.checkChildren=!0),o.subject;const a={checkChildren:r,subject:new fe,rootNode:s};return this._elementInfo.set(i,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const r=yh(t),i=this._elementInfo.get(r);i&&(i.subject.complete(),this._setClasses(r),this._elementInfo.delete(r),this._removeGlobalListeners(i))}focusVia(t,r,i){const s=yh(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,c])=>this._originChanged(a,r,c)):(this._setOrigin(r),"function"==typeof s.focus&&s.focus(i))}ngOnDestroy(){this._elementInfo.forEach((t,r)=>this.stopMonitoring(r))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return this._detectionMode===Xb.EVENTUAL||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,r){t.classList.toggle("cdk-focused",!!r),t.classList.toggle("cdk-touch-focused","touch"===r),t.classList.toggle("cdk-keyboard-focused","keyboard"===r),t.classList.toggle("cdk-mouse-focused","mouse"===r),t.classList.toggle("cdk-program-focused","program"===r)}_setOrigin(t,r=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&r,this._detectionMode===Xb.IMMEDIATE&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,r){const i=this._elementInfo.get(r),s=Ac(t);!i||!i.checkChildren&&r!==s||this._originChanged(r,this._getFocusOrigin(s),i)}_onBlur(t,r){const i=this._elementInfo.get(r);!i||i.checkChildren&&t.relatedTarget instanceof Node&&r.contains(t.relatedTarget)||(this._setClasses(r),this._emitOrigin(i,null))}_emitOrigin(t,r){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(r))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const r=t.rootNode,i=this._rootNodeFocusListenerCount.get(r)||0;i||this._ngZone.runOutsideAngular(()=>{r.addEventListener("focus",this._rootNodeFocusAndBlurListener,Yb),r.addEventListener("blur",this._rootNodeFocusAndBlurListener,Yb)}),this._rootNodeFocusListenerCount.set(r,i+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(ua(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const r=t.rootNode;if(this._rootNodeFocusListenerCount.has(r)){const i=this._rootNodeFocusListenerCount.get(r);i>1?this._rootNodeFocusListenerCount.set(r,i-1):(r.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Yb),r.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Yb),this._rootNodeFocusListenerCount.delete(r))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,r,i){this._setClasses(t,r),this._emitOrigin(i,r),this._lastFocusOrigin=r}_getClosestElementsInfo(t){const r=[];return this._elementInfo.forEach((i,s)=>{(s===t||i.checkChildren&&s.contains(t))&&r.push([s,i])}),r}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:r,mostRecentModality:i}=this._inputModalityDetector;if("mouse"!==i||!r||r===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let o=0;o<s.length;o++)if(s[o].contains(r))return!0;return!1}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const UD={};let bh=(()=>{class n{_appId=A(Pa);getId(t){return"ng"!==this._appId&&(t+=this._appId),UD.hasOwnProperty(t)||(UD[t]=0),`${t}${UD[t]++}`}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const g6=Y9();class uPe{_viewportRuler;_previousHTMLStyles={top:"",left:""};_previousScrollPosition;_isEnabled=!1;_document;constructor(e,t){this._viewportRuler=e,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=In(-this._previousScrollPosition.left),e.style.top=In(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,r=e.style,i=this._document.body.style,s=r.scrollBehavior||"",o=i.scrollBehavior||"";this._isEnabled=!1,r.left=this._previousHTMLStyles.left,r.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),g6&&(r.scrollBehavior=i.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),g6&&(r.scrollBehavior=s,i.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,r=this._viewportRuler.getViewportSize();return t.scrollHeight>r.height||t.scrollWidth>r.width}}class dPe{_scrollDispatcher;_ngZone;_viewportRuler;_config;_scrollSubscription=null;_overlayRef;_initialScrollPosition;constructor(e,t,r,i){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=r,this._config=i}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0).pipe(gt(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}_detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}class m6{enable(){}disable(){}attach(){}}function jD(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function _6(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class hPe{_scrollDispatcher;_viewportRuler;_ngZone;_config;_scrollSubscription=null;_overlayRef;constructor(e,t,r,i){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=r,this._config=i}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:r,height:i}=this._viewportRuler.getViewportSize();jD(t,[{width:r,height:i,bottom:i,right:r,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let fPe=(()=>{class n{_scrollDispatcher=A(K9);_viewportRuler=A(J9);_ngZone=A(ye);_document=A(vt);constructor(){}noop=()=>new m6;close=t=>new dPe(this._scrollDispatcher,this._ngZone,this._viewportRuler,t);block=()=>new uPe(this._viewportRuler,this._document);reposition=t=>new hPe(this._scrollDispatcher,this._viewportRuler,this._ngZone,t);static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class y6{positionStrategy;scrollStrategy=new m6;panelClass="";hasBackdrop=!1;backdropClass="cdk-overlay-dark-backdrop";width;height;minWidth;minHeight;maxWidth;maxHeight;direction;disposeOnNavigation=!1;constructor(e){if(e){const t=Object.keys(e);for(const r of t)void 0!==e[r]&&(this[r]=e[r])}}}class pPe{connectionPair;scrollableViewProperties;constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let v6=(()=>{class n{_attachedOverlays=[];_document=A(vt);_isAttached;constructor(){}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const r=this._attachedOverlays.indexOf(t);r>-1&&this._attachedOverlays.splice(r,1),0===this._attachedOverlays.length&&this.detach()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),gPe=(()=>{class n extends v6{_ngZone=A(ye);_renderer=A(Bo).createRenderer(null,null);_cleanupKeydown;add(t){super.add(t),this._isAttached||(this._ngZone.runOutsideAngular(()=>{this._cleanupKeydown=this._renderer.listen("body","keydown",this._keydownListener)}),this._isAttached=!0)}detach(){this._isAttached&&(this._cleanupKeydown?.(),this._isAttached=!1)}_keydownListener=t=>{const r=this._attachedOverlays;for(let i=r.length-1;i>-1;i--)if(r[i]._keydownEvents.observers.length>0){this._ngZone.run(()=>r[i]._keydownEvents.next(t));break}};static \u0275fac=(()=>{let t;return function(i){return(t||(t=Bi(n)))(i||n)}})();static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),mPe=(()=>{class n extends v6{_platform=A(pa);_ngZone=A(ye);_renderer=A(Bo).createRenderer(null,null);_cursorOriginalValue;_cursorStyleIsSet=!1;_pointerDownEventTarget;_cleanups;add(t){if(super.add(t),!this._isAttached){const r=this._document.body,i={capture:!0};this._cleanups=this._ngZone.runOutsideAngular(()=>[Vl(this._renderer,r,"pointerdown",this._pointerDownListener,i),Vl(this._renderer,r,"click",this._clickListener,i),Vl(this._renderer,r,"auxclick",this._clickListener,i),Vl(this._renderer,r,"contextmenu",this._clickListener,i)]),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){this._isAttached&&(this._cleanups?.forEach(t=>t()),this._cleanups=void 0,this._platform.IOS&&this._cursorStyleIsSet&&(this._document.body.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1)}_pointerDownListener=t=>{this._pointerDownEventTarget=Ac(t)};_clickListener=t=>{const r=Ac(t),i="click"===t.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:r;this._pointerDownEventTarget=null;const s=this._attachedOverlays.slice();for(let o=s.length-1;o>-1;o--){const a=s[o];if(a._outsidePointerEvents.observers.length<1||!a.hasAttached())continue;if(b6(a.overlayElement,r)||b6(a.overlayElement,i))break;const c=a._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>c.next(t)):c.next(t)}};static \u0275fac=(()=>{let t;return function(i){return(t||(t=Bi(n)))(i||n)}})();static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function b6(n,e){const t=typeof ShadowRoot<"u"&&ShadowRoot;let r=e;for(;r;){if(r===n)return!0;r=t&&r instanceof ShadowRoot?r.host:r.parentNode}return!1}let w6=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["ng-component"]],hostAttrs:["cdk-overlay-style-loader",""],decls:0,vars:0,template:function(r,i){},styles:[".cdk-overlay-container,.cdk-global-overlay-wrapper{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container{position:fixed}@layer cdk-overlay{.cdk-overlay-container{z-index:1000}}.cdk-overlay-container:empty{display:none}.cdk-global-overlay-wrapper{display:flex;position:absolute}@layer cdk-overlay{.cdk-global-overlay-wrapper{z-index:1000}}.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box;display:flex;max-width:100%;max-height:100%}@layer cdk-overlay{.cdk-overlay-pane{z-index:1000}}.cdk-overlay-backdrop{position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:auto;-webkit-tap-highlight-color:rgba(0,0,0,0);opacity:0}@layer cdk-overlay{.cdk-overlay-backdrop{z-index:1000;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}}.cdk-overlay-backdrop-showing{opacity:1}@media(forced-colors: active){.cdk-overlay-backdrop-showing{opacity:.6}}@layer cdk-overlay{.cdk-overlay-dark-backdrop{background:rgba(0,0,0,.32)}}.cdk-overlay-transparent-backdrop{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing,.cdk-high-contrast-active .cdk-overlay-transparent-backdrop{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation{transition:none}.cdk-overlay-connected-position-bounding-box{position:absolute;display:flex;flex-direction:column;min-width:1px;min-height:1px}@layer cdk-overlay{.cdk-overlay-connected-position-bounding-box{z-index:1000}}.cdk-global-scrollblock{position:fixed;width:100%;overflow-y:scroll}"],encapsulation:2,changeDetection:0})}return n})(),VD=(()=>{class n{_platform=A(pa);_containerElement;_document=A(vt);_styleLoader=A(jg);constructor(){}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._loadStyles(),this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||Z9()){const i=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<i.length;s++)i[s].remove()}const r=this._document.createElement("div");r.classList.add(t),Z9()?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}_loadStyles(){this._styleLoader.load(w6)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class _Pe{_renderer;_ngZone;element;_cleanupClick;_cleanupTransitionEnd;_fallbackTimeout;constructor(e,t,r,i){this._renderer=t,this._ngZone=r,this.element=e.createElement("div"),this.element.classList.add("cdk-overlay-backdrop"),this._cleanupClick=t.listen(this.element,"click",i)}detach(){this._ngZone.runOutsideAngular(()=>{const e=this.element;clearTimeout(this._fallbackTimeout),this._cleanupTransitionEnd?.(),this._cleanupTransitionEnd=this._renderer.listen(e,"transitionend",this.dispose),this._fallbackTimeout=setTimeout(this.dispose,500),e.style.pointerEvents="none",e.classList.remove("cdk-overlay-backdrop-showing")})}dispose=()=>{clearTimeout(this._fallbackTimeout),this._cleanupClick?.(),this._cleanupTransitionEnd?.(),this._cleanupClick=this._cleanupTransitionEnd=this._fallbackTimeout=void 0,this.element.remove()}}class HD{_portalOutlet;_host;_pane;_config;_ngZone;_keyboardDispatcher;_document;_location;_outsideClickDispatcher;_animationsDisabled;_injector;_renderer;_backdropClick=new fe;_attachments=new fe;_detachments=new fe;_positionStrategy;_scrollStrategy;_locationChanges=Mt.EMPTY;_backdropRef=null;_previousHostParent;_keydownEvents=new fe;_outsidePointerEvents=new fe;_renders=new fe;_afterRenderRef;_afterNextRenderRef;constructor(e,t,r,i,s,o,a,c,l,u=!1,d,h){this._portalOutlet=e,this._host=t,this._pane=r,this._config=i,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=c,this._outsideClickDispatcher=l,this._animationsDisabled=u,this._injector=d,this._renderer=h,i.scrollStrategy&&(this._scrollStrategy=i.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=i.positionStrategy,this._afterRenderRef=ii(()=>function qw(n,e){!e?.injector&&Pc();const t=e?.injector??A(pt);return _i("NgAfterRender"),yO(n,t,e,!1)}(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropRef?.element||null}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=nf(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._backdropRef?.dispose(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=this._backdropRef=null,e&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=In(this._config.width),e.height=In(this._config.height),e.minWidth=In(this._config.minWidth),e.minHeight=In(this._config.minHeight),e.maxWidth=In(this._config.maxWidth),e.maxHeight=In(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropRef?.dispose(),this._backdropRef=new _Pe(this._document,this._renderer,this._ngZone,t=>{this._backdropClick.next(t)}),this._animationsDisabled&&this._backdropRef.element.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropRef.element,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropRef.element,this._host),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this._backdropRef?.element.classList.add(e))}):this._backdropRef.element.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){this._animationsDisabled?(this._backdropRef?.dispose(),this._backdropRef=null):this._backdropRef?.detach()}_toggleClasses(e,t,r){const i=W9(t||[]).filter(s=>!!s);i.length&&(r?e.classList.add(...i):e.classList.remove(...i))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{const e=this._renders.pipe(ua(al(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e?.disable(),e?.detach?.()}}const E6="cdk-overlay-connected-position-bounding-box",yPe=/([A-Za-z%]+)$/;class vPe{_viewportRuler;_document;_platform;_overlayContainer;_overlayRef;_isInitialRender;_lastBoundingBoxSize={width:0,height:0};_isPushed=!1;_canPush=!0;_growAfterOpen=!1;_hasFlexibleDimensions=!0;_positionLocked=!1;_originRect;_overlayRect;_viewportRect;_containerRect;_viewportMargin=0;_scrollables=[];_preferredPositions=[];_origin;_pane;_isDisposed;_boundingBox;_lastPosition;_lastScrollVisibility;_positionChanges=new fe;_resizeSubscription=Mt.EMPTY;_offsetX=0;_offsetY=0;_transformOriginSelector;_appliedPanelClasses=[];_previousPushAmount;positionChanges=this._positionChanges;get positions(){return this._preferredPositions}constructor(e,t,r,i,s){this._viewportRuler=t,this._document=r,this._platform=i,this._overlayContainer=s,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add(E6),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,r=this._viewportRect,i=this._containerRect,s=[];let o;for(let a of this._preferredPositions){let c=this._getOriginPoint(e,i,a),l=this._getOverlayPoint(c,t,a),u=this._getOverlayFit(l,t,r,a);if(u.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,c);this._canFitWithFlexibleDimensions(u,l,r)?s.push({position:a,origin:c,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(c,a)}):(!o||o.overlayFit.visibleArea<u.visibleArea)&&(o={overlayFit:u,overlayPoint:l,originPoint:c,position:a,overlayRect:t})}if(s.length){let a=null,c=-1;for(const l of s){const u=l.boundingBoxRect.width*l.boundingBoxRect.height*(l.position.weight||1);u>c&&(c=u,a=l)}return this._isPushed=!1,void this._applyPosition(a.position,a.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Hl(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(E6),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,r){let i,s;if("center"==r.originX)i=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;i="start"==r.originX?o:a}return t.left<0&&(i-=t.left),s="center"==r.originY?e.top+e.height/2:"top"==r.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:i,y:s}}_getOverlayPoint(e,t,r){let i,s;return i="center"==r.overlayX?-t.width/2:"start"===r.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==r.overlayY?-t.height/2:"top"==r.overlayY?0:-t.height,{x:e.x+i,y:e.y+s}}_getOverlayFit(e,t,r,i){const s=A6(t);let{x:o,y:a}=e,c=this._getOffset(i,"x"),l=this._getOffset(i,"y");c&&(o+=c),l&&(a+=l);let h=0-a,f=a+s.height-r.height,p=this._subtractOverflows(s.width,0-o,o+s.width-r.width),g=this._subtractOverflows(s.height,h,f),m=p*g;return{visibleArea:m,isCompletelyWithinViewport:s.width*s.height===m,fitsInViewportVertically:g===s.height,fitsInViewportHorizontally:p==s.width}}_canFitWithFlexibleDimensions(e,t,r){if(this._hasFlexibleDimensions){const i=r.bottom-t.y,s=r.right-t.x,o=C6(this._overlayRef.getConfig().minHeight),a=C6(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=o&&o<=i)&&(e.fitsInViewportHorizontally||null!=a&&a<=s)}return!1}_pushOverlayOnScreen(e,t,r){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const i=A6(t),s=this._viewportRect,o=Math.max(e.x+i.width-s.width,0),a=Math.max(e.y+i.height-s.height,0),c=Math.max(s.top-r.top-e.y,0),l=Math.max(s.left-r.left-e.x,0);let u=0,d=0;return u=i.width<=s.width?l||-o:e.x<this._viewportMargin?s.left-r.left-e.x:0,d=i.height<=s.height?c||-a:e.y<this._viewportMargin?s.top-r.top-e.y:0,this._previousPushAmount={x:u,y:d},{x:e.x+u,y:e.y+d}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._positionChanges.observers.length){const r=this._getScrollVisibility();if(e!==this._lastPosition||!this._lastScrollVisibility||!function bPe(n,e){return n===e||n.isOriginClipped===e.isOriginClipped&&n.isOriginOutsideView===e.isOriginOutsideView&&n.isOverlayClipped===e.isOverlayClipped&&n.isOverlayOutsideView===e.isOverlayOutsideView}(this._lastScrollVisibility,r)){const i=new pPe(e,r);this._positionChanges.next(i)}this._lastScrollVisibility=r}this._lastPosition=e,this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let r,i=e.overlayY;r="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${r} ${i}`}_calculateBoundingBoxRect(e,t){const r=this._viewportRect,i=this._isRtl();let s,o,a,u,d,h;if("top"===t.overlayY)o=e.y,s=r.height-o+this._viewportMargin;else if("bottom"===t.overlayY)a=r.height-e.y+2*this._viewportMargin,s=r.height-a+this._viewportMargin;else{const f=Math.min(r.bottom-e.y+r.top,e.y),p=this._lastBoundingBoxSize.height;s=2*f,o=e.y-f,s>p&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-p/2)}if("end"===t.overlayX&&!i||"start"===t.overlayX&&i)h=r.width-e.x+2*this._viewportMargin,u=e.x-this._viewportMargin;else if("start"===t.overlayX&&!i||"end"===t.overlayX&&i)d=e.x,u=r.right-e.x;else{const f=Math.min(r.right-e.x+r.left,e.x),p=this._lastBoundingBoxSize.width;u=2*f,d=e.x-f,u>p&&!this._isInitialRender&&!this._growAfterOpen&&(d=e.x-p/2)}return{top:o,left:d,bottom:a,right:h,width:u,height:s}}_setBoundingBoxStyles(e,t){const r=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(r.height=Math.min(r.height,this._lastBoundingBoxSize.height),r.width=Math.min(r.width,this._lastBoundingBoxSize.width));const i={};if(this._hasExactPosition())i.top=i.left="0",i.bottom=i.right=i.maxHeight=i.maxWidth="",i.width=i.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;i.height=In(r.height),i.top=In(r.top),i.bottom=In(r.bottom),i.width=In(r.width),i.left=In(r.left),i.right=In(r.right),i.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",i.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(i.maxHeight=In(s)),o&&(i.maxWidth=In(o))}this._lastBoundingBoxSize=r,Hl(this._boundingBox.style,i)}_resetBoundingBoxStyles(){Hl(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Hl(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const r={},i=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(i){const u=this._viewportRuler.getViewportScrollPosition();Hl(r,this._getExactOverlayY(t,e,u)),Hl(r,this._getExactOverlayX(t,e,u))}else r.position="static";let a="",c=this._getOffset(t,"x"),l=this._getOffset(t,"y");c&&(a+=`translateX(${c}px) `),l&&(a+=`translateY(${l}px)`),r.transform=a.trim(),o.maxHeight&&(i?r.maxHeight=In(o.maxHeight):s&&(r.maxHeight="")),o.maxWidth&&(i?r.maxWidth=In(o.maxWidth):s&&(r.maxWidth="")),Hl(this._pane.style,r)}_getExactOverlayY(e,t,r){let i={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,r)),"bottom"===e.overlayY?i.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":i.top=In(s.y),i}_getExactOverlayX(e,t,r){let o,i={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,r)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?i.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":i.left=In(s.x),i}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),r=this._scrollables.map(i=>i.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:_6(e,r),isOriginOutsideView:jD(e,r),isOverlayClipped:_6(t,r),isOverlayOutsideView:jD(t,r)}}_subtractOverflows(e,...t){return t.reduce((r,i)=>r-Math.max(i,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,r=this._viewportRuler.getViewportScrollPosition();return{top:r.top+this._viewportMargin,left:r.left+this._viewportMargin,right:r.left+e-this._viewportMargin,bottom:r.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&W9(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof fn)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,r=e.height||0;return{top:e.y,bottom:e.y+r,left:e.x,right:e.x+t,height:r,width:t}}}function Hl(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function C6(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(yPe);return t&&"px"!==t?null:parseFloat(e)}return n||null}function A6(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const T6="cdk-global-overlay-wrapper";class wPe{_overlayRef;_cssPosition="static";_topOffset="";_bottomOffset="";_alignItems="";_xPosition="";_xOffset="";_width="";_height="";_isDisposed=!1;attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(T6),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,r=this._overlayRef.getConfig(),{width:i,height:s,maxWidth:o,maxHeight:a}=r,c=!("100%"!==i&&"100vw"!==i||o&&"100%"!==o&&"100vw"!==o),l=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a),u=this._xPosition,d=this._xOffset,h="rtl"===this._overlayRef.getConfig().direction;let f="",p="",g="";c?g="flex-start":"center"===u?(g="center",h?p=d:f=d):h?"left"===u||"end"===u?(g="flex-end",f=d):("right"===u||"start"===u)&&(g="flex-start",p=d):"left"===u||"start"===u?(g="flex-start",f=d):("right"===u||"end"===u)&&(g="flex-end",p=d),e.position=this._cssPosition,e.marginLeft=c?"0":f,e.marginTop=l?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=c?"0":p,t.justifyContent=g,t.alignItems=l?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,r=t.style;t.classList.remove(T6),r.justifyContent=r.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let EPe=(()=>{class n{_viewportRuler=A(J9);_document=A(vt);_platform=A(pa);_overlayContainer=A(VD);constructor(){}global(){return new wPe}flexibleConnectedTo(t){return new vPe(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Tc=(()=>{class n{scrollStrategies=A(fPe);_overlayContainer=A(VD);_positionBuilder=A(EPe);_keyboardDispatcher=A(gPe);_injector=A(pt);_ngZone=A(ye);_document=A(vt);_directionality=A(Wb);_location=A(hd);_outsideClickDispatcher=A(mPe);_animationsModuleType=A(Pw,{optional:!0});_idGenerator=A(bh);_renderer=A(Bo).createRenderer(null,null);_appRef;_styleLoader=A(jg);constructor(){}create(t){this._styleLoader.load(w6);const r=this._createHostElement(),i=this._createPaneElement(r),s=this._createPortalOutlet(i),o=new y6(t);return o.direction=o.direction||this._directionality.value,new HD(s,r,i,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType,this._injector.get(Qn),this._renderer)}position(){return this._positionBuilder}_createPaneElement(t){const r=this._document.createElement("div");return r.id=this._idGenerator.getId("cdk-overlay-"),r.classList.add("cdk-overlay-pane"),t.appendChild(r),r}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(nr)),new IOe(t,null,this._appRef,this._injector,this._document)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function TPe(n,e){}class Vg{viewContainerRef;injector;id;role="dialog";panelClass="";hasBackdrop=!0;backdropClass="";disableClose=!1;width="";height="";minWidth;minHeight;maxWidth;maxHeight;positionStrategy;data=null;direction;ariaDescribedBy=null;ariaLabelledBy=null;ariaLabel=null;ariaModal=!1;autoFocus="first-tabbable";restoreFocus=!0;scrollStrategy;closeOnNavigation=!0;closeOnDestroy=!0;closeOnOverlayDetachments=!0;componentFactoryResolver;providers;container;templateContext}let x6=(()=>{class n extends FD{_elementRef=A(fn);_focusTrapFactory=A(rPe);_config;_interactivityChecker=A(a6);_ngZone=A(ye);_overlayRef=A(HD);_focusMonitor=A(p6);_renderer=A(Zc);_platform=A(pa);_document=A(vt,{optional:!0});_portalOutlet;_focusTrap=null;_elementFocusedBeforeDialogWasOpened=null;_closeInteractionType=null;_ariaLabelledByQueue=[];_changeDetectorRef=A(vs);_injector=A(pt);_isDestroyed=!1;constructor(){super(),this._config=A(Vg,{optional:!0})||new Vg,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(t){this._ariaLabelledByQueue.push(t),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(t){const r=this._ariaLabelledByQueue.indexOf(t);r>-1&&(this._ariaLabelledByQueue.splice(r,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._isDestroyed=!0,this._restoreFocus()}attachComponentPortal(t){this._portalOutlet.hasAttached();const r=this._portalOutlet.attachComponentPortal(t);return this._contentAttached(),r}attachTemplatePortal(t){this._portalOutlet.hasAttached();const r=this._portalOutlet.attachTemplatePortal(t);return this._contentAttached(),r}attachDomPortal=t=>{this._portalOutlet.hasAttached();const r=this._portalOutlet.attachDomPortal(t);return this._contentAttached(),r};_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(t,r){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const i=()=>{s(),o(),t.removeAttribute("tabindex")},s=this._renderer.listen(t,"blur",i),o=this._renderer.listen(t,"mousedown",i)})),t.focus(r)}_focusByCssSelector(t,r){let i=this._elementRef.nativeElement.querySelector(t);i&&this._forceFocus(i,r)}_trapFocus(){this._isDestroyed||nf(()=>{const t=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||t.focus();break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElement()||this._focusDialogContainer();break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}},{injector:this._injector})}_restoreFocus(){const t=this._config.restoreFocus;let r=null;if("string"==typeof t?r=this._document.querySelector(t):"boolean"==typeof t?r=t?this._elementFocusedBeforeDialogWasOpened:null:t&&(r=t),this._config.restoreFocus&&r&&"function"==typeof r.focus){const i=OD(),s=this._elementRef.nativeElement;(!i||i===this._document.body||i===s||s.contains(i))&&(this._focusMonitor?(this._focusMonitor.focusVia(r,this._closeInteractionType),this._closeInteractionType=null):r.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const t=this._elementRef.nativeElement,r=OD();return t===r||t.contains(r)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=OD()))}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["cdk-dialog-container"]],viewQuery:function(r,i){if(1&r&&nl($b,7),2&r){let s;Vo(s=Ho())&&(i._portalOutlet=s.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(r,i){2&r&&ms("id",i._config.id||null)("role",i._config.role)("aria-modal",i._config.ariaModal)("aria-labelledby",i._config.ariaLabel?null:i._ariaLabelledByQueue[0])("aria-label",i._config.ariaLabel)("aria-describedby",i._config.ariaDescribedBy||null)},features:[jo],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(r,i){1&r&&gs(0,TPe,0,0,"ng-template",0)},dependencies:[$b],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2})}return n})();class zD{overlayRef;config;componentInstance;componentRef;containerInstance;disableClose;closed=new fe;backdropClick;keydownEvents;outsidePointerEvents;id;_detachSubscription;constructor(e,t){this.overlayRef=e,this.config=t,this.disableClose=t.disableClose,this.backdropClick=e.backdropClick(),this.keydownEvents=e.keydownEvents(),this.outsidePointerEvents=e.outsidePointerEvents(),this.id=t.id,this.keydownEvents.subscribe(r=>{27===r.keyCode&&!this.disableClose&&!LD(r)&&(r.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=e.detachments().subscribe(()=>{!1!==t.closeOnOverlayDetachments&&this.close()})}close(e,t){if(this.containerInstance){const r=this.closed;this.containerInstance._closeInteractionType=t?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),r.next(e),r.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(e="",t=""){return this.overlayRef.updateSize({width:e,height:t}),this}addPanelClass(e){return this.overlayRef.addPanelClass(e),this}removePanelClass(e){return this.overlayRef.removePanelClass(e),this}}const S6=new P("DialogScrollStrategy",{providedIn:"root",factory:()=>{const n=A(Tc);return()=>n.scrollStrategies.block()}}),xPe=new P("DialogData"),SPe=new P("DefaultDialogConfig");let MPe=(()=>{class n{_overlay=A(Tc);_injector=A(pt);_defaultOptions=A(SPe,{optional:!0});_parentDialog=A(n,{optional:!0,skipSelf:!0});_overlayContainer=A(VD);_idGenerator=A(bh);_openDialogsAtThisLevel=[];_afterAllClosedAtThisLevel=new fe;_afterOpenedAtThisLevel=new fe;_ariaHiddenElements=new Map;_scrollStrategy=A(S6);get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}afterAllClosed=pb(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(vc(void 0)));constructor(){}open(t,r){(r={...this._defaultOptions||new Vg,...r}).id=r.id||this._idGenerator.getId("cdk-dialog-"),r.id&&this.getDialogById(r.id);const s=this._getOverlayConfig(r),o=this._overlay.create(s),a=new zD(o,r),c=this._attachContainer(o,a,r);return a.containerInstance=c,this._attachDialogContent(t,a,c,r),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(a),a.closed.subscribe(()=>this._removeOpenDialog(a,!0)),this.afterOpened.next(a),a}closeAll(){GD(this.openDialogs,t=>t.close())}getDialogById(t){return this.openDialogs.find(r=>r.id===t)}ngOnDestroy(){GD(this._openDialogsAtThisLevel,t=>{!1===t.config.closeOnDestroy&&this._removeOpenDialog(t,!1)}),GD(this._openDialogsAtThisLevel,t=>t.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(t){const r=new y6({positionStrategy:t.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,width:t.width,height:t.height,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(r.backdropClass=t.backdropClass),r}_attachContainer(t,r,i){const s=i.injector||i.viewContainerRef?.injector,o=[{provide:Vg,useValue:i},{provide:zD,useValue:r},{provide:HD,useValue:t}];let a;i.container?"function"==typeof i.container?a=i.container:(a=i.container.type,o.push(...i.container.providers(i))):a=x6;const c=new ND(a,i.viewContainerRef,pt.create({parent:s||this._injector,providers:o}));return t.attach(c).instance}_attachDialogContent(t,r,i,s){if(t instanceof ps){const o=this._createInjector(s,r,i,void 0);let a={$implicit:s.data,dialogRef:r};s.templateContext&&(a={...a,..."function"==typeof s.templateContext?s.templateContext():s.templateContext}),i.attachTemplatePortal(new kD(t,null,a,o))}else{const o=this._createInjector(s,r,i,this._injector),a=i.attachComponentPortal(new ND(t,s.viewContainerRef,o));r.componentRef=a,r.componentInstance=a.instance}}_createInjector(t,r,i,s){const o=t.injector||t.viewContainerRef?.injector,a=[{provide:xPe,useValue:t.data},{provide:zD,useValue:r}];return t.providers&&("function"==typeof t.providers?a.push(...t.providers(r,t,i)):a.push(...t.providers)),t.direction&&(!o||!o.get(Wb,null,{optional:!0}))&&a.push({provide:Wb,useValue:{value:t.direction,change:ie()}}),pt.create({parent:o||s,providers:a})}_removeOpenDialog(t,r){const i=this.openDialogs.indexOf(t);i>-1&&(this.openDialogs.splice(i,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((s,o)=>{s?o.setAttribute("aria-hidden",s):o.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),r&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const r=t.parentElement.children;for(let i=r.length-1;i>-1;i--){const s=r[i];s!==t&&"SCRIPT"!==s.nodeName&&"STYLE"!==s.nodeName&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function GD(n,e){let t=n.length;for(;t--;)e(n[t])}function DPe(n,e){}class I6{viewContainerRef;injector;id;role="dialog";panelClass="";hasBackdrop=!0;backdropClass="";disableClose=!1;width="";height="";minWidth;minHeight;maxWidth;maxHeight;position;data=null;direction;ariaDescribedBy=null;ariaLabelledBy=null;ariaLabel=null;ariaModal=!1;autoFocus="first-tabbable";restoreFocus=!0;delayFocusTrap=!0;scrollStrategy;closeOnNavigation=!0;componentFactoryResolver;enterAnimationDuration;exitAnimationDuration}const WD="mdc-dialog--open",M6="mdc-dialog--opening",D6="mdc-dialog--closing";let R6=(()=>{class n extends x6{_animationMode=A(Pw,{optional:!0});_animationStateChanged=new ze;_animationsEnabled="NoopAnimations"!==this._animationMode;_actionSectionCount=0;_hostElement=this._elementRef.nativeElement;_enterAnimationDuration=this._animationsEnabled?P6(this._config.enterAnimationDuration)??150:0;_exitAnimationDuration=this._animationsEnabled?P6(this._config.exitAnimationDuration)??75:0;_animationTimer=null;_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(O6,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(M6,WD)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(WD),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(WD),this._animationsEnabled?(this._hostElement.style.setProperty(O6,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(D6)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(t){this._actionSectionCount+=t,this._changeDetectorRef.markForCheck()}_finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)};_finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})};_clearAnimationClasses(){this._hostElement.classList.remove(M6,D6)}_waitForAnimationToComplete(t,r){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(r,t)}_requestAnimationFrame(t){this._ngZone.runOutsideAngular(()=>{"function"==typeof requestAnimationFrame?requestAnimationFrame(t):t()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(t){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:t})}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}attachComponentPortal(t){const r=super.attachComponentPortal(t);return r.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),r}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Bi(n)))(i||n)}})();static \u0275cmp=nn({type:n,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(r,i){2&r&&(U_("id",i._config.id),ms("aria-modal",i._config.ariaModal)("role",i._config.role)("aria-labelledby",i._config.ariaLabel?null:i._ariaLabelledByQueue[0])("aria-label",i._config.ariaLabel)("aria-describedby",i._config.ariaDescribedBy||null),bi("_mat-animation-noopable",!i._animationsEnabled)("mat-mdc-dialog-container-with-actions",i._actionSectionCount>0))},features:[jo],decls:3,vars:0,consts:[[1,"mat-mdc-dialog-inner-container","mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(r,i){1&r&&(It(0,"div",0)(1,"div",1),gs(2,DPe,0,0,"ng-template",2),Ot()())},dependencies:[$b],styles:['.mat-mdc-dialog-container{width:100%;height:100%;display:block;box-sizing:border-box;max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;outline:0}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 560px);min-width:var(--mat-dialog-container-min-width, 280px)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, calc(100vw - 32px))}}.mat-mdc-dialog-inner-container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;transition:opacity linear var(--mat-dialog-transition-duration, 0ms);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mdc-dialog--closing .mat-mdc-dialog-inner-container{transition:opacity 75ms linear;transform:none}.mdc-dialog--open .mat-mdc-dialog-inner-container{opacity:1}._mat-animation-noopable .mat-mdc-dialog-inner-container{transition:none}.mat-mdc-dialog-surface{display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;width:100%;height:100%;position:relative;overflow-y:auto;outline:0;transform:scale(0.8);transition:transform var(--mat-dialog-transition-duration, 0ms) cubic-bezier(0, 0, 0.2, 1);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;box-shadow:var(--mat-dialog-container-elevation-shadow, none);border-radius:var(--mdc-dialog-container-shape, var(--mat-sys-corner-extra-large, 4px));background-color:var(--mdc-dialog-container-color, var(--mat-sys-surface, white))}[dir=rtl] .mat-mdc-dialog-surface{text-align:right}.mdc-dialog--open .mat-mdc-dialog-surface,.mdc-dialog--closing .mat-mdc-dialog-surface{transform:none}._mat-animation-noopable .mat-mdc-dialog-surface{transition:none}.mat-mdc-dialog-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mat-mdc-dialog-title{display:block;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:var(--mat-dialog-headline-padding, 6px 24px 13px)}.mat-mdc-dialog-title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mat-mdc-dialog-title{text-align:right}.mat-mdc-dialog-container .mat-mdc-dialog-title{color:var(--mdc-dialog-subhead-color, var(--mat-sys-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mdc-dialog-subhead-font, var(--mat-sys-headline-small-font, inherit));line-height:var(--mdc-dialog-subhead-line-height, var(--mat-sys-headline-small-line-height, 1.5rem));font-size:var(--mdc-dialog-subhead-size, var(--mat-sys-headline-small-size, 1rem));font-weight:var(--mdc-dialog-subhead-weight, var(--mat-sys-headline-small-weight, 400));letter-spacing:var(--mdc-dialog-subhead-tracking, var(--mat-sys-headline-small-tracking, 0.03125em))}.mat-mdc-dialog-content{display:block;flex-grow:1;box-sizing:border-box;margin:0;overflow:auto;max-height:65vh}.mat-mdc-dialog-content>:first-child{margin-top:0}.mat-mdc-dialog-content>:last-child{margin-bottom:0}.mat-mdc-dialog-container .mat-mdc-dialog-content{color:var(--mdc-dialog-supporting-text-color, var(--mat-sys-on-surface-variant, rgba(0, 0, 0, 0.6)));font-family:var(--mdc-dialog-supporting-text-font, var(--mat-sys-body-medium-font, inherit));line-height:var(--mdc-dialog-supporting-text-line-height, var(--mat-sys-body-medium-line-height, 1.5rem));font-size:var(--mdc-dialog-supporting-text-size, var(--mat-sys-body-medium-size, 1rem));font-weight:var(--mdc-dialog-supporting-text-weight, var(--mat-sys-body-medium-weight, 400));letter-spacing:var(--mdc-dialog-supporting-text-tracking, var(--mat-sys-body-medium-tracking, 0.03125em))}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px 0)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0);padding:var(--mat-dialog-actions-padding, 16px 24px);justify-content:var(--mat-dialog-actions-alignment, flex-end)}@media(forced-colors: active){.mat-mdc-dialog-actions{border-top-color:CanvasText}}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}.mat-mdc-dialog-component-host{display:contents}'],encapsulation:2})}return n})();const O6="--mat-dialog-transition-duration";function P6(n){return null==n?null:"number"==typeof n?n:n.endsWith("ms")?G9(n.substring(0,n.length-2)):n.endsWith("s")?1e3*G9(n.substring(0,n.length-1)):"0"===n?0:null}var Zb=function(n){return n[n.OPEN=0]="OPEN",n[n.CLOSING=1]="CLOSING",n[n.CLOSED=2]="CLOSED",n}(Zb||{});class Kb{_ref;_containerInstance;componentInstance;componentRef;disableClose;id;_afterOpened=new fe;_beforeClosed=new fe;_result;_closeFallbackTimeout;_state=Zb.OPEN;_closeInteractionType;constructor(e,t,r){this._ref=e,this._containerInstance=r,this.disableClose=t.disableClose,this.id=e.id,e.addPanelClass("mat-mdc-dialog-panel"),r._animationStateChanged.pipe(gt(i=>"opened"===i.state),Vn(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),r._animationStateChanged.pipe(gt(i=>"closed"===i.state),Vn(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),al(this.backdropClick(),this.keydownEvents().pipe(gt(i=>27===i.keyCode&&!this.disableClose&&!LD(i)))).subscribe(i=>{this.disableClose||(i.preventDefault(),function N6(n,e,t){return n._closeInteractionType=e,n.close(t)}(this,"keydown"===i.type?"keyboard":"mouse"))})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(gt(t=>"closing"===t.state),Vn(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=Zb.CLOSING,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(e){let t=this._ref.config.positionStrategy;return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._ref.updatePosition(),this}updateSize(e="",t=""){return this._ref.updateSize(e,t),this}addPanelClass(e){return this._ref.addPanelClass(e),this}removePanelClass(e){return this._ref.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=Zb.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const k6=new P("MatMdcDialogData"),PPe=new P("mat-mdc-dialog-default-options"),F6=new P("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{const n=A(Tc);return()=>n.scrollStrategies.block()}});let Jb=(()=>{class n{_overlay=A(Tc);_defaultOptions=A(PPe,{optional:!0});_scrollStrategy=A(F6);_parentDialog=A(n,{optional:!0,skipSelf:!0});_idGenerator=A(bh);_dialog=A(MPe);_openDialogsAtThisLevel=[];_afterAllClosedAtThisLevel=new fe;_afterOpenedAtThisLevel=new fe;dialogConfigClass=I6;_dialogRefConstructor;_dialogContainerType;_dialogDataToken;get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}afterAllClosed=pb(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(vc(void 0)));constructor(){this._dialogRefConstructor=Kb,this._dialogContainerType=R6,this._dialogDataToken=k6}open(t,r){let i;(r={...this._defaultOptions||new I6,...r}).id=r.id||this._idGenerator.getId("mat-mdc-dialog-"),r.scrollStrategy=r.scrollStrategy||this._scrollStrategy();const s=this._dialog.open(t,{...r,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:r},{provide:Vg,useValue:r}]},templateContext:()=>({dialogRef:i}),providers:(o,a,c)=>(i=new this._dialogRefConstructor(o,r,c),i.updatePosition(r?.position),[{provide:this._dialogContainerType,useValue:c},{provide:this._dialogDataToken,useValue:a.data},{provide:this._dialogRefConstructor,useValue:i}])});return i.componentRef=s.componentRef,i.componentInstance=s.componentInstance,this.openDialogs.push(i),this.afterOpened.next(i),i.afterClosed().subscribe(()=>{const o=this.openDialogs.indexOf(i);o>-1&&(this.openDialogs.splice(o,1),this.openDialogs.length||this._getAfterAllClosed().next())}),i}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(r=>r.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(t){let r=t.length;for(;r--;)t[r].close()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),L6=(()=>{class n{_dialogRef=A(Kb,{optional:!0});_elementRef=A(fn);_dialog=A(Jb);constructor(){}ngOnInit(){this._dialogRef||(this._dialogRef=function B6(n,e){let t=n.nativeElement.parentElement;for(;t&&!t.classList.contains("mat-mdc-dialog-container");)t=t.parentElement;return t?e.find(r=>r.id===t.id):null}(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{this._onAdd()})}ngOnDestroy(){this._dialogRef?._containerInstance&&Promise.resolve().then(()=>{this._onRemove()})}static \u0275fac=function(r){return new(r||n)};static \u0275dir=et({type:n})}return n})(),$D=(()=>{class n extends L6{id=A(bh).getId("mat-mdc-dialog-title-");_onAdd(){this._dialogRef._containerInstance?._addAriaLabelledBy?.(this.id)}_onRemove(){this._dialogRef?._containerInstance?._removeAriaLabelledBy?.(this.id)}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Bi(n)))(i||n)}})();static \u0275dir=et({type:n,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-mdc-dialog-title","mdc-dialog__title"],hostVars:1,hostBindings:function(r,i){2&r&&U_("id",i.id)},inputs:{id:"id"},exportAs:["matDialogTitle"],features:[jo]})}return n})(),qD=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=et({type:n,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-mdc-dialog-content","mdc-dialog__content"],features:[JN([TOe])]})}return n})();let U6=(()=>{class n{http;panelContent=new Qt({content:[],infoTitle:"",videoID:""});constructor(t){this.http=t}updateData(t,r,i){this.http.get(t,{responseType:"text"}).subscribe(s=>{const o={content:this.parseMarkdown(s),infoTitle:i,videoID:r};this.panelContent.next(o)})}parseMarkdown(t){const r=[],i=t.split("# ");for(const s of i)if(s.length){const o=s.includes("\n\n")?"\n\n":"\r\n\r\n",a=s.split(o);r.push({title:a[0],content:a.splice(1).join(o)})}return r}static \u0275fac=function(r){return new(r||n)(X(Ds))};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const LPe=["*"];let Qb;function Hg(n){return function BPe(){if(void 0===Qb&&(Qb=null,typeof window<"u")){const n=window;void 0!==n.trustedTypes&&(Qb=n.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return Qb}()?.createHTML(n)||n}function j6(n){return Error(`Unable to find icon with the name "${n}"`)}function V6(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function H6(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class zl{url;svgText;options;svgElement;constructor(e,t,r){this.url=e,this.svgText=t,this.options=r}}let e0=(()=>{class n{_httpClient;_sanitizer;_errorHandler;_document;_svgIconConfigs=new Map;_iconSetConfigs=new Map;_cachedIconsByUrl=new Map;_inProgressUrlFetches=new Map;_fontCssClassesByAlias=new Map;_resolvers=[];_defaultFontSetClass=["material-icons","mat-ligature-font"];constructor(t,r,i,s){this._httpClient=t,this._sanitizer=r,this._errorHandler=s,this._document=i}addSvgIcon(t,r,i){return this.addSvgIconInNamespace("",t,r,i)}addSvgIconLiteral(t,r,i){return this.addSvgIconLiteralInNamespace("",t,r,i)}addSvgIconInNamespace(t,r,i,s){return this._addSvgIconConfig(t,r,new zl(i,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,r,i,s){const o=this._sanitizer.sanitize(tr.HTML,i);if(!o)throw H6(i);const a=Hg(o);return this._addSvgIconConfig(t,r,new zl("",a,s))}addSvgIconSet(t,r){return this.addSvgIconSetInNamespace("",t,r)}addSvgIconSetLiteral(t,r){return this.addSvgIconSetLiteralInNamespace("",t,r)}addSvgIconSetInNamespace(t,r,i){return this._addSvgIconSetConfig(t,new zl(r,null,i))}addSvgIconSetLiteralInNamespace(t,r,i){const s=this._sanitizer.sanitize(tr.HTML,r);if(!s)throw H6(r);const o=Hg(s);return this._addSvgIconSetConfig(t,new zl("",o,i))}registerFontClassAlias(t,r=t){return this._fontCssClassesByAlias.set(t,r),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const r=this._sanitizer.sanitize(tr.RESOURCE_URL,t);if(!r)throw V6(t);const i=this._cachedIconsByUrl.get(r);return i?ie(t0(i)):this._loadSvgIconFromConfig(new zl(t,null)).pipe(qt(s=>this._cachedIconsByUrl.set(r,s)),he(s=>t0(s)))}getNamedSvgIcon(t,r=""){const i=z6(r,t);let s=this._svgIconConfigs.get(i);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(r,t),s)return this._svgIconConfigs.set(i,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(r);return o?this._getSvgFromIconSetConfigs(t,o):yc(j6(i))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?ie(t0(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(he(r=>t0(r)))}_getSvgFromIconSetConfigs(t,r){const i=this._extractIconWithNameFromAnySet(t,r);return i?ie(i):sb(r.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(_o(a=>{const l=`Loading icon set URL: ${this._sanitizer.sanitize(tr.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(l)),ie(null)})))).pipe(he(()=>{const o=this._extractIconWithNameFromAnySet(t,r);if(!o)throw j6(t);return o}))}_extractIconWithNameFromAnySet(t,r){for(let i=r.length-1;i>=0;i--){const s=r[i];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,t,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(qt(r=>t.svgText=r),he(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?ie(null):this._fetchIcon(t).pipe(qt(r=>t.svgText=r))}_extractSvgIconFromSet(t,r,i){const s=t.querySelector(`[id="${r}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,i);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),i);const a=this._svgElementFromString(Hg("<svg></svg>"));return a.appendChild(o),this._setSvgAttributes(a,i)}_svgElementFromString(t){const r=this._document.createElement("DIV");r.innerHTML=t;const i=r.querySelector("svg");if(!i)throw Error("<svg> tag not found");return i}_toSvgElement(t){const r=this._svgElementFromString(Hg("<svg></svg>")),i=t.attributes;for(let s=0;s<i.length;s++){const{name:o,value:a}=i[s];"id"!==o&&r.setAttribute(o,a)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&r.appendChild(t.childNodes[s].cloneNode(!0));return r}_setSvgAttributes(t,r){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),r&&r.viewBox&&t.setAttribute("viewBox",r.viewBox),t}_fetchIcon(t){const{url:r,options:i}=t,s=i?.withCredentials??!1;if(!this._httpClient)throw function UPe(){return Error("Could not find HttpClient for use with Angular Material icons. Please add provideHttpClient() to your providers.")}();if(null==r)throw Error(`Cannot fetch icon from URL "${r}".`);const o=this._sanitizer.sanitize(tr.RESOURCE_URL,r);if(!o)throw V6(r);const a=this._inProgressUrlFetches.get(o);if(a)return a;const c=this._httpClient.get(o,{responseType:"text",withCredentials:s}).pipe(he(l=>Hg(l)),Dl(()=>this._inProgressUrlFetches.delete(o)),ta());return this._inProgressUrlFetches.set(o,c),c}_addSvgIconConfig(t,r,i){return this._svgIconConfigs.set(z6(t,r),i),this}_addSvgIconSetConfig(t,r){const i=this._iconSetConfigs.get(t);return i?i.push(r):this._iconSetConfigs.set(t,[r]),this}_svgElementFromConfig(t){if(!t.svgElement){const r=this._svgElementFromString(t.svgText);this._setSvgAttributes(r,t.options),t.svgElement=r}return t.svgElement}_getIconConfigFromResolvers(t,r){for(let i=0;i<this._resolvers.length;i++){const s=this._resolvers[i](r,t);if(s)return VPe(s)?new zl(s.url,null,s.options):new zl(s,null)}}static \u0275fac=function(r){return new(r||n)(X(Ds,8),X(op),X(vt,8),X(ei))};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function t0(n){return n.cloneNode(!0)}function z6(n,e){return n+":"+e}function VPe(n){return!(!n.url||!n.options)}const HPe=new P("MAT_ICON_DEFAULT_OPTIONS"),zPe=new P("mat-icon-location",{providedIn:"root",factory:function GPe(){const n=A(vt),e=n?n.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),G6=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],WPe=G6.map(n=>`[${n}]`).join(", "),$Pe=/^url\(['"]?#(.*?)['"]?\)$/;let W6=(()=>{class n{_elementRef=A(fn);_iconRegistry=A(e0);_location=A(zPe);_errorHandler=A(ei);_defaultColor;get color(){return this._color||this._defaultColor}set color(t){this._color=t}_color;inline=!1;get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}_svgIcon;get fontSet(){return this._fontSet}set fontSet(t){const r=this._cleanupFontValue(t);r!==this._fontSet&&(this._fontSet=r,this._updateFontIconClasses())}_fontSet;get fontIcon(){return this._fontIcon}set fontIcon(t){const r=this._cleanupFontValue(t);r!==this._fontIcon&&(this._fontIcon=r,this._updateFontIconClasses())}_fontIcon;_previousFontSetClass=[];_previousFontIconClass;_svgName;_svgNamespace;_previousPath;_elementsWithExternalReferences;_currentIconFetch=Mt.EMPTY;constructor(){const t=A(new M1("aria-hidden"),{optional:!0}),r=A(HPe,{optional:!0});r&&(r.color&&(this.color=this._defaultColor=r.color),r.fontSet&&(this.fontSet=r.fontSet)),t||this._elementRef.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];const r=t.split(":");switch(r.length){case 1:return["",r[0]];case 2:return r;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const r=this._location.getPathname();r!==this._previousPath&&(this._previousPath=r,this._prependPathToReferences(r))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const r=this._location.getPathname();this._previousPath=r,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(r),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let r=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();r--;){const i=t.childNodes[r];(1!==i.nodeType||"svg"===i.nodeName.toLowerCase())&&i.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,r=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(i=>i.length>0);this._previousFontSetClass.forEach(i=>t.classList.remove(i)),r.forEach(i=>t.classList.add(i)),this._previousFontSetClass=r,this.fontIcon!==this._previousFontIconClass&&!r.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const r=this._elementsWithExternalReferences;r&&r.forEach((i,s)=>{i.forEach(o=>{s.setAttribute(o.name,`url('${t}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(t){const r=t.querySelectorAll(WPe),i=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<r.length;s++)G6.forEach(o=>{const a=r[s],c=a.getAttribute(o),l=c?c.match($Pe):null;if(l){let u=i.get(a);u||(u=[],i.set(a,u)),u.push({name:o,value:l[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[r,i]=this._splitIconName(t);r&&(this._svgNamespace=r),i&&(this._svgName=i),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(i,r).pipe(Vn(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${r}:${i}! ${s.message}`))})}}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(r,i){2&r&&(ms("data-mat-icon-type",i._usingFontIcon()?"font":"svg")("data-mat-icon-name",i._svgName||i.fontIcon)("data-mat-icon-namespace",i._svgNamespace||i.fontSet)("fontIcon",i._usingFontIcon()?i.fontIcon:null),k_(i.color?"mat-"+i.color:""),bi("mat-icon-inline",i.inline)("mat-icon-no-color","primary"!==i.color&&"accent"!==i.color&&"warn"!==i.color))},inputs:{color:"color",inline:[2,"inline","inline",bs],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],ngContentSelectors:LPe,decls:1,vars:0,template:function(r,i){1&r&&(Wa(),br(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color, inherit)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}return n})(),$6=(()=>{class n{_listeners=[];notify(t,r){for(let i of this._listeners)i(t,r)}listen(t){return this._listeners.push(t),()=>{this._listeners=this._listeners.filter(r=>t!==r)}}ngOnDestroy(){this._listeners=[]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const q6=new P("CdkAccordion");let XPe=(()=>{class n{accordion=A(q6,{optional:!0,skipSelf:!0});_changeDetectorRef=A(vs);_expansionDispatcher=A($6);_openCloseAllSubscription=Mt.EMPTY;closed=new ze;opened=new ze;destroyed=new ze;expandedChange=new ze;id=A(bh).getId("cdk-accordion-child-");get expanded(){return this._expanded}set expanded(t){this._expanded!==t&&(this._expanded=t,this.expandedChange.emit(t),t?(this.opened.emit(),this._expansionDispatcher.notify(this.id,this.accordion?this.accordion.id:this.id)):this.closed.emit(),this._changeDetectorRef.markForCheck())}_expanded=!1;disabled=!1;_removeUniqueSelectionListener=()=>{};constructor(){}ngOnInit(){this._removeUniqueSelectionListener=this._expansionDispatcher.listen((t,r)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===r&&this.id!==t&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(t=>{this.disabled||(this.expanded=t)})}static \u0275fac=function(r){return new(r||n)};static \u0275dir=et({type:n,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:[2,"expanded","expanded",bs],disabled:[2,"disabled","disabled",bs]},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],features:[YC([{provide:q6,useValue:void 0}])]})}return n})(),eNe=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["structural-styles"]],decls:0,vars:0,template:function(r,i){},styles:['.mat-focus-indicator{position:relative}.mat-focus-indicator::before{top:0;left:0;right:0;bottom:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-focus-indicator-display, none);border-width:var(--mat-focus-indicator-border-width, 3px);border-style:var(--mat-focus-indicator-border-style, solid);border-color:var(--mat-focus-indicator-border-color, transparent);border-radius:var(--mat-focus-indicator-border-radius, 4px)}.mat-focus-indicator:focus::before{content:""}@media(forced-colors: active){html{--mat-focus-indicator-display: block}}'],encapsulation:2,changeDetection:0})}return n})();const oNe=["body"],aNe=["bodyWrapper"],cNe=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],lNe=["mat-expansion-panel-header","*","mat-action-row"];function uNe(n,e){}const dNe=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],hNe=["mat-panel-title","mat-panel-description","*"];function fNe(n,e){1&n&&(It(0,"span",1),lw(),It(1,"svg",2),Ks(2,"path",3),Ot()())}const Q6=new P("MAT_ACCORDION"),e5=new P("MAT_EXPANSION_PANEL");let pNe=(()=>{class n{_template=A(ps);_expansionPanel=A(e5,{optional:!0});constructor(){}static \u0275fac=function(r){return new(r||n)};static \u0275dir=et({type:n,selectors:[["ng-template","matExpansionPanelContent",""]]})}return n})();const t5=new P("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS");let n5=(()=>{class n extends XPe{_viewContainerRef=A(Lr);_animationsDisabled="NoopAnimations"===A(Pw,{optional:!0});_document=A(vt);_ngZone=A(ye);_elementRef=A(fn);_renderer=A(Zc);_cleanupTransitionEnd;get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(t){this._hideToggle=t}_hideToggle=!1;get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(t){this._togglePosition=t}_togglePosition;afterExpand=new ze;afterCollapse=new ze;_inputChanges=new fe;accordion=A(Q6,{optional:!0,skipSelf:!0});_lazyContent;_body;_bodyWrapper;_portal;_headerId=A(bh).getId("mat-expansion-panel-header-");constructor(){super();const t=A(t5,{optional:!0});this._expansionDispatcher=A($6),t&&(this.hideToggle=t.hideToggle)}_hasSpacing(){return!!this.accordion&&this.expanded&&"default"===this.accordion.displayMode}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this._lazyContent._expansionPanel===this&&this.opened.pipe(vc(null),gt(()=>this.expanded&&!this._portal),Vn(1)).subscribe(()=>{this._portal=new kD(this._lazyContent._template,this._viewContainerRef)}),this._setupAnimationEvents()}ngOnChanges(t){this._inputChanges.next(t)}ngOnDestroy(){super.ngOnDestroy(),this._cleanupTransitionEnd?.(),this._inputChanges.complete()}_containsFocus(){if(this._body){const t=this._document.activeElement,r=this._body.nativeElement;return t===r||r.contains(t)}return!1}_transitionEndListener=({target:t,propertyName:r})=>{t===this._bodyWrapper?.nativeElement&&"grid-template-rows"===r&&this._ngZone.run(()=>{this.expanded?this.afterExpand.emit():this.afterCollapse.emit()})};_setupAnimationEvents(){this._ngZone.runOutsideAngular(()=>{this._animationsDisabled?(this.opened.subscribe(()=>this._ngZone.run(()=>this.afterExpand.emit())),this.closed.subscribe(()=>this._ngZone.run(()=>this.afterCollapse.emit()))):setTimeout(()=>{const t=this._elementRef.nativeElement;this._cleanupTransitionEnd=this._renderer.listen(t,"transitionend",this._transitionEndListener),t.classList.add("mat-expansion-panel-animations-enabled")},200)})}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["mat-expansion-panel"]],contentQueries:function(r,i,s){if(1&r&&HC(s,pNe,5),2&r){let o;Vo(o=Ho())&&(i._lazyContent=o.first)}},viewQuery:function(r,i){if(1&r&&(nl(oNe,5),nl(aNe,5)),2&r){let s;Vo(s=Ho())&&(i._body=s.first),Vo(s=Ho())&&(i._bodyWrapper=s.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:4,hostBindings:function(r,i){2&r&&bi("mat-expanded",i.expanded)("mat-expansion-panel-spacing",i._hasSpacing())},inputs:{hideToggle:[2,"hideToggle","hideToggle",bs],togglePosition:"togglePosition"},outputs:{afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],features:[YC([{provide:Q6,useValue:void 0},{provide:e5,useExisting:n}]),jo,us],ngContentSelectors:lNe,decls:9,vars:4,consts:[["bodyWrapper",""],["body",""],[1,"mat-expansion-panel-content-wrapper"],["role","region",1,"mat-expansion-panel-content",3,"id"],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(r,i){1&r&&(Wa(cNe),br(0),It(1,"div",2,0)(3,"div",3,1)(5,"div",4),br(6,1),gs(7,uNe,0,0,"ng-template",5),Ot(),br(8,2),Ot()()),2&r&&(Yn(),ms("inert",i.expanded?null:""),Yn(2),Br("id",i.id),ms("aria-labelledby",i._headerId),Yn(4),Br("cdkPortalOutlet",i._portal))},dependencies:[$b],styles:[".mat-expansion-panel{box-sizing:content-box;display:block;margin:0;overflow:hidden;position:relative;background:var(--mat-expansion-container-background-color, var(--mat-sys-surface));color:var(--mat-expansion-container-text-color, var(--mat-sys-on-surface));border-radius:var(--mat-expansion-container-shape, 12px)}.mat-expansion-panel.mat-expansion-panel-animations-enabled{transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-expansion-panel:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:var(--mat-expansion-container-shape, 12px);border-top-left-radius:var(--mat-expansion-container-shape, 12px)}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:var(--mat-expansion-container-shape, 12px);border-bottom-left-radius:var(--mat-expansion-container-shape, 12px)}@media(forced-colors: active){.mat-expansion-panel{outline:solid 1px}}.mat-expansion-panel-content-wrapper{display:grid;grid-template-rows:0fr;grid-template-columns:100%}.mat-expansion-panel-animations-enabled .mat-expansion-panel-content-wrapper{transition:grid-template-rows 225ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-expansion-panel.mat-expanded>.mat-expansion-panel-content-wrapper{grid-template-rows:1fr}@supports not (grid-template-rows: 0fr){.mat-expansion-panel-content-wrapper{height:0}.mat-expansion-panel.mat-expanded>.mat-expansion-panel-content-wrapper{height:auto}}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible;min-height:0;visibility:hidden;font-family:var(--mat-expansion-container-text-font, var(--mat-sys-body-large-font));font-size:var(--mat-expansion-container-text-size, var(--mat-sys-body-large-size));font-weight:var(--mat-expansion-container-text-weight, var(--mat-sys-body-large-weight));line-height:var(--mat-expansion-container-text-line-height, var(--mat-sys-body-large-line-height));letter-spacing:var(--mat-expansion-container-text-tracking, var(--mat-sys-body-large-tracking))}.mat-expansion-panel-animations-enabled .mat-expansion-panel-content{transition:visibility 190ms linear}.mat-expansion-panel.mat-expanded>.mat-expansion-panel-content-wrapper>.mat-expansion-panel-content{visibility:visible}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px;border-top-color:var(--mat-expansion-actions-divider-color, var(--mat-sys-outline))}.mat-action-row .mat-button-base,.mat-action-row .mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row .mat-button-base,[dir=rtl] .mat-action-row .mat-mdc-button-base{margin-left:0;margin-right:8px}"],encapsulation:2,changeDetection:0})}return n})(),gNe=(()=>{class n{panel=A(n5,{host:!0});_element=A(fn);_focusMonitor=A(p6);_changeDetectorRef=A(vs);_parentChangeSubscription=Mt.EMPTY;constructor(){A(jg).load(eNe);const t=this.panel,r=A(t5,{optional:!0}),i=A(new M1("tabindex"),{optional:!0}),s=t.accordion?t.accordion._stateChanges.pipe(gt(o=>!(!o.hideToggle&&!o.togglePosition))):si;this.tabIndex=parseInt(i||"")||0,this._parentChangeSubscription=al(t.opened,t.closed,s,t._inputChanges.pipe(gt(o=>!!(o.hideToggle||o.disabled||o.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),t.closed.pipe(gt(()=>t._containsFocus())).subscribe(()=>this._focusMonitor.focusVia(this._element,"program")),r&&(this.expandedHeight=r.expandedHeight,this.collapsedHeight=r.collapsedHeight)}expandedHeight;collapsedHeight;tabIndex=0;get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){const t=this._isExpanded();return t&&this.expandedHeight?this.expandedHeight:!t&&this.collapsedHeight?this.collapsedHeight:null}_keydown(t){switch(t.keyCode){case 32:case 13:LD(t)||(t.preventDefault(),this._toggle());break;default:return void(this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(t))}}focus(t,r){t?this._focusMonitor.focusVia(this._element,t,r):this._element.nativeElement.focus(r)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(t=>{t&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:13,hostBindings:function(r,i){1&r&&wi("click",function(){return i._toggle()})("keydown",function(o){return i._keydown(o)}),2&r&&(ms("id",i.panel._headerId)("tabindex",i.disabled?-1:i.tabIndex)("aria-controls",i._getPanelId())("aria-expanded",i._isExpanded())("aria-disabled",i.panel.disabled),Lf("height",i._getHeaderHeight()),bi("mat-expanded",i._isExpanded())("mat-expansion-toggle-indicator-after","after"===i._getTogglePosition())("mat-expansion-toggle-indicator-before","before"===i._getTogglePosition()))},inputs:{expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight",tabIndex:[2,"tabIndex","tabIndex",t=>null==t?0:sy(t)]},ngContentSelectors:hNe,decls:5,vars:3,consts:[[1,"mat-content"],[1,"mat-expansion-indicator"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-hidden","true","focusable","false"],["d","M480-345 240-585l56-56 184 184 184-184 56 56-240 240Z"]],template:function(r,i){1&r&&(Wa(dNe),It(0,"span",0),br(1),br(2,1),br(3,2),Ot(),gs(4,fNe,3,0,"span",1)),2&r&&(bi("mat-content-hide-toggle",!i._showToggle()),Yn(4),PC(i._showToggle()?4:-1))},styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;height:var(--mat-expansion-header-collapsed-state-height, 48px);font-family:var(--mat-expansion-header-text-font, var(--mat-sys-title-medium-font));font-size:var(--mat-expansion-header-text-size, var(--mat-sys-title-medium-size));font-weight:var(--mat-expansion-header-text-weight, var(--mat-sys-title-medium-weight));line-height:var(--mat-expansion-header-text-line-height, var(--mat-sys-title-medium-line-height));letter-spacing:var(--mat-expansion-header-text-tracking, var(--mat-sys-title-medium-tracking))}.mat-expansion-panel-animations-enabled .mat-expansion-panel-header{transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-expansion-panel-header::before{border-radius:inherit}.mat-expansion-panel-header.mat-expanded{height:var(--mat-expansion-header-expanded-state-height, 64px)}.mat-expansion-panel-header[aria-disabled=true]{color:var(--mat-expansion-header-disabled-state-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-header-hover-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent))}@media(hover: none){.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-container-background-color, var(--mat-sys-surface))}}.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-keyboard-focused,.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-program-focused{background:var(--mat-expansion-header-focus-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent))}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-content.mat-content-hide-toggle{margin-right:8px}[dir=rtl] .mat-content.mat-content-hide-toggle{margin-right:0;margin-left:8px}.mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-left:24px;margin-right:0}[dir=rtl] .mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-right:24px;margin-left:0}.mat-expansion-panel-header-title{color:var(--mat-expansion-header-text-color, var(--mat-sys-on-surface))}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;flex-basis:0;margin-right:16px;align-items:center}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-title,.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-description{color:inherit}.mat-expansion-panel-header-description{flex-grow:2;color:var(--mat-expansion-header-description-color, var(--mat-sys-on-surface-variant))}.mat-expansion-panel-animations-enabled .mat-expansion-indicator{transition:transform 225ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-expansion-panel-header.mat-expanded .mat-expansion-indicator{transform:rotate(180deg)}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle;color:var(--mat-expansion-header-indicator-color, var(--mat-sys-on-surface-variant));display:var(--mat-expansion-legacy-header-indicator-display, none)}.mat-expansion-indicator svg{width:24px;height:24px;margin:0 -8px;vertical-align:middle;fill:var(--mat-expansion-header-indicator-color, var(--mat-sys-on-surface-variant));display:var(--mat-expansion-header-indicator-display, inline-block)}@media(forced-colors: active){.mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}}'],encapsulation:2,changeDetection:0})}return n})();function r5(n,e,t){return t?r5(n,e).pipe(wM(t)):new Se(r=>{const i=(...o)=>r.next(1===o.length?o[0]:o),s=n(i);return dt(e)?()=>e(i,s):void 0})}const mNe=["youtubeContainer"];function _Ne(n,e){if(1&n){const t=B_();It(0,"youtube-player-placeholder",2),wi("click",function(){return Ma(t),Da(Ga()._load(!0))}),Ot()}if(2&n){const t=Ga();Br("videoId",t.videoId)("width",t.width)("height",t.height)("isLoading",t._isLoading)("buttonLabel",t.placeholderButtonLabel)("quality",t.placeholderImageQuality)}}let yNe=(()=>{class n{videoId;width;height;isLoading;buttonLabel;quality;_getBackgroundImage(){let t;return t="low"===this.quality?`https://i.ytimg.com/vi/${this.videoId}/hqdefault.jpg`:"high"===this.quality?`https://i.ytimg.com/vi/${this.videoId}/maxresdefault.jpg`:`https://i.ytimg.com/vi_webp/${this.videoId}/sddefault.webp`,`url(${t})`}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["youtube-player-placeholder"]],hostAttrs:[1,"youtube-player-placeholder"],hostVars:8,hostBindings:function(r,i){2&r&&(Lf("background-image",i._getBackgroundImage())("width",i.width,"px")("height",i.height,"px"),bi("youtube-player-placeholder-loading",i.isLoading))},inputs:{videoId:"videoId",width:"width",height:"height",isLoading:"isLoading",buttonLabel:"buttonLabel",quality:"quality"},decls:4,vars:1,consts:[["type","button",1,"youtube-player-placeholder-button"],["height","100%","version","1.1","viewBox","0 0 68 48","focusable","false","aria-hidden","true"],["d","M66.52,7.74c-0.78-2.93-2.49-5.41-5.42-6.19C55.79,.13,34,0,34,0S12.21,.13,6.9,1.55 C3.97,2.33,2.27,4.81,1.48,7.74C0.06,13.05,0,24,0,24s0.06,10.95,1.48,16.26c0.78,2.93,2.49,5.41,5.42,6.19 C12.21,47.87,34,48,34,48s21.79-0.13,27.1-1.55c2.93-0.78,4.64-3.26,5.42-6.19C67.94,34.95,68,24,68,24S67.94,13.05,66.52,7.74z","fill","#f00"],["d","M 45,24 27,14 27,34","fill","#fff"]],template:function(r,i){1&r&&(It(0,"button",0),lw(),It(1,"svg",1),Ks(2,"path",2)(3,"path",3),Ot()()),2&r&&ms("aria-label",i.buttonLabel)},styles:[".youtube-player-placeholder{display:flex;align-items:center;justify-content:center;width:100%;overflow:hidden;cursor:pointer;background-color:#000;background-position:center center;background-size:cover;transition:box-shadow 300ms ease;box-shadow:inset 0 120px 90px -90px rgba(0,0,0,.8)}:fullscreen .youtube-player-placeholder{min-width:100vw;min-height:100vh}.youtube-player-placeholder-button{transition:opacity 300ms ease;-moz-appearance:none;-webkit-appearance:none;background:none;border:none;padding:0;display:flex}.youtube-player-placeholder-button svg{width:68px;height:48px}.youtube-player-placeholder-loading{box-shadow:none}.youtube-player-placeholder-loading .youtube-player-placeholder-button{opacity:0}"],encapsulation:2,changeDetection:0})}return n})();const vNe=new P("YOUTUBE_PLAYER_CONFIG");function a5(n){return null==n?n:sy(n,0)}var Co=function(n){return n[n.UNSTARTED=-1]="UNSTARTED",n[n.ENDED=0]="ENDED",n[n.PLAYING=1]="PLAYING",n[n.PAUSED=2]="PAUSED",n[n.BUFFERING=3]="BUFFERING",n[n.CUED=5]="CUED",n}(Co||{});let bNe=(()=>{class n{_ngZone=A(ye);_nonce=A(Nw,{optional:!0});_changeDetectorRef=A(vs);_elementRef=A(fn);_player;_pendingPlayer;_existingApiReadyCallback;_pendingPlayerState;_destroyed=new fe;_playerChanges=new Qt(void 0);_isLoading=!1;_hasPlaceholder=!0;_isBrowser;videoId;get height(){return this._height}set height(t){this._height=null==t||isNaN(t)?390:t}_height=390;get width(){return this._width}set width(t){this._width=null==t||isNaN(t)?640:t}_width=640;startSeconds;endSeconds;suggestedQuality;playerVars;disableCookies=!1;loadApi;disablePlaceholder=!1;showBeforeIframeApiLoads=!1;placeholderButtonLabel;placeholderImageQuality;ready=new ze;stateChange=this._getLazyEmitter("onStateChange");error=this._getLazyEmitter("onError");apiChange=this._getLazyEmitter("onApiChange");playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange");playbackRateChange=this._getLazyEmitter("onPlaybackRateChange");youtubeContainer;constructor(){const t=A(ko),r=A(vNe,{optional:!0});this.loadApi=r?.loadApi??!0,this.disablePlaceholder=!!r?.disablePlaceholder,this.placeholderButtonLabel=r?.placeholderButtonLabel||"Play video",this.placeholderImageQuality=r?.placeholderImageQuality||"standard",this._isBrowser=Ka(t)}ngAfterViewInit(){this._conditionallyLoad()}ngOnChanges(t){this._shouldRecreatePlayer(t)?this._conditionallyLoad():this._player&&((t.width||t.height)&&this._setSize(),t.suggestedQuality&&this._setQuality(),(t.startSeconds||t.endSeconds||t.suggestedQuality)&&this._cuePlayer())}ngOnDestroy(){this._pendingPlayer?.destroy(),this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():(this._getPendingState().playbackState=Co.PLAYING,this._load(!0))}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=Co.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=Co.CUED}seekTo(t,r){this._player?this._player.seekTo(t,r):this._getPendingState().seek={seconds:t,allowSeekAhead:r}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(t){this._player?this._player.setVolume(t):this._getPendingState().volume=t}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(t){if(this._player)return this._player.setPlaybackRate(t);this._getPendingState().playbackRate=t}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:Co.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}requestFullscreen(t){var r=this;return j(function*(){const i=r._elementRef.nativeElement;return i.requestFullscreen?i.requestFullscreen(t):Promise.reject(new Error("Fullscreen API not supported by browser."))})()}_load(t){this._isBrowser&&(window.YT&&window.YT.Player?this._createPlayer(t):(this.loadApi&&(this._isLoading=!0,function wNe(n){if(YD)return;const t=document.createElement("script"),r=i=>{t.removeEventListener("load",r),t.removeEventListener("error",r),"error"===i.type&&(YD=!1)};t.addEventListener("load",r),t.addEventListener("error",r),t.src="https://www.youtube.com/iframe_api",t.async=!0,n&&t.setAttribute("nonce",n),YD=!0,document.body.appendChild(t)}(this._nonce)),this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback?.(),this._ngZone.run(()=>this._createPlayer(t))}))}_conditionallyLoad(){this._shouldShowPlaceholder()?1===this.playerVars?.autoplay&&this._load(!0):this._load(!1)}_shouldShowPlaceholder(){return!this.disablePlaceholder&&(!this._isBrowser||this._hasPlaceholder&&!!this.videoId&&!this._player)}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_shouldRecreatePlayer(t){const r=t.videoId||t.playerVars||t.disableCookies||t.disablePlaceholder;return!!r&&!r.isFirstChange()}_createPlayer(t){if(this._player?.destroy(),this._pendingPlayer?.destroy(),typeof YT>"u"||!this.videoId&&!this.playerVars?.list)return;const r=this._ngZone.runOutsideAngular(()=>new YT.Player(this.youtubeContainer.nativeElement,{videoId:this.videoId,host:this.disableCookies?"https://www.youtube-nocookie.com":void 0,width:this.width,height:this.height,playerVars:t?{...this.playerVars||{},autoplay:1}:this.playerVars})),i=s=>{this._ngZone.run(()=>{this._isLoading=!1,this._hasPlaceholder=!1,this._player=r,this._pendingPlayer=void 0,r.removeEventListener("onReady",i),this._playerChanges.next(r),this.ready.emit(s),this._setSize(),this._setQuality(),this._pendingPlayerState&&(this._applyPendingPlayerState(r,this._pendingPlayerState),this._pendingPlayerState=void 0);const o=r.getPlayerState();o===Co.UNSTARTED||o===Co.CUED||null==o?this._cuePlayer():t&&this.startSeconds&&this.startSeconds>0&&r.seekTo(this.startSeconds,!0),this._changeDetectorRef.markForCheck()})};this._pendingPlayer=r,r.addEventListener("onReady",i)}_applyPendingPlayerState(t,r){const{playbackState:i,playbackRate:s,volume:o,muted:a,seek:c}=r;switch(i){case Co.PLAYING:t.playVideo();break;case Co.PAUSED:t.pauseVideo();break;case Co.CUED:t.stopVideo()}null!=s&&t.setPlaybackRate(s),null!=o&&t.setVolume(o),null!=a&&(a?t.mute():t.unMute()),null!=c&&t.seekTo(c.seconds,c.allowSeekAhead)}_cuePlayer(){this._player&&this.videoId&&this._player.cueVideoById({videoId:this.videoId,startSeconds:this.startSeconds,endSeconds:this.endSeconds,suggestedQuality:this.suggestedQuality})}_setSize(){this._player?.setSize(this.width,this.height)}_setQuality(){this._player&&this.suggestedQuality&&this._player.setPlaybackQuality(this.suggestedQuality)}_getLazyEmitter(t){return this._playerChanges.pipe(Bn(r=>r?r5(i=>{r.addEventListener(t,i)},i=>{try{r?.removeEventListener?.(t,i)}catch{}}):ie()),r=>new Se(i=>r.subscribe({next:s=>this._ngZone.run(()=>i.next(s)),error:s=>i.error(s),complete:()=>i.complete()})),ua(this._destroyed))}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["youtube-player"]],viewQuery:function(r,i){if(1&r&&nl(mNe,7),2&r){let s;Vo(s=Ho())&&(i.youtubeContainer=s.first)}},inputs:{videoId:"videoId",height:[2,"height","height",sy],width:[2,"width","width",sy],startSeconds:[2,"startSeconds","startSeconds",a5],endSeconds:[2,"endSeconds","endSeconds",a5],suggestedQuality:"suggestedQuality",playerVars:"playerVars",disableCookies:[2,"disableCookies","disableCookies",bs],loadApi:[2,"loadApi","loadApi",bs],disablePlaceholder:[2,"disablePlaceholder","disablePlaceholder",bs],showBeforeIframeApiLoads:[2,"showBeforeIframeApiLoads","showBeforeIframeApiLoads",bs],placeholderButtonLabel:"placeholderButtonLabel",placeholderImageQuality:"placeholderImageQuality"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},features:[us],decls:4,vars:3,consts:[["youtubeContainer",""],[3,"videoId","width","height","isLoading","buttonLabel","quality"],[3,"click","videoId","width","height","isLoading","buttonLabel","quality"]],template:function(r,i){1&r&&(gs(0,_Ne,1,6,"youtube-player-placeholder",1),It(1,"div"),Ks(2,"div",null,0),Ot()),2&r&&(PC(i._shouldShowPlaceholder()?0:-1),Yn(),Lf("display",i._shouldShowPlaceholder()?"none":""))},dependencies:[yNe],styles:["youtube-player:fullscreen,youtube-player:fullscreen iframe{min-width:100vw;min-height:100vh}"],encapsulation:2,changeDetection:0})}return n})(),YD=!1;let Gl={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function c5(n){Gl=n}const Gg={exec:()=>null};function Ct(n,e=""){let t="string"==typeof n?n:n.source;const r={replace:(i,s)=>{let o="string"==typeof s?s:s.source;return o=o.replace(Wr.caret,"$1"),t=t.replace(i,o),r},getRegex:()=>new RegExp(t,e)};return r}const Wr={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[\t ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},Wg=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,KD=/(?:[*+-]|\d{1,9}[.)])/,l5=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,u5=Ct(l5).replace(/bull/g,KD).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),xNe=Ct(l5).replace(/bull/g,KD).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),JD=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,QD=/(?!\s*\])(?:\\.|[^\[\]\\])+/,INe=Ct(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",QD).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),MNe=Ct(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,KD).getRegex(),n0="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",eR=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,DNe=Ct("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",eR).replace("tag",n0).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),d5=Ct(JD).replace("hr",Wg).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",n0).getRegex(),tR={blockquote:Ct(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",d5).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:INe,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:Wg,html:DNe,lheading:u5,list:MNe,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:d5,table:Gg,text:/^[^\n]+/},h5=Ct("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Wg).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",n0).getRegex(),RNe={...tR,lheading:xNe,table:h5,paragraph:Ct(JD).replace("hr",Wg).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",h5).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",n0).getRegex()},ONe={...tR,html:Ct("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",eR).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Gg,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ct(JD).replace("hr",Wg).replace("heading"," *#{1,6} *[^\n]").replace("lheading",u5).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},f5=/^( {2,}|\\)\n(?!\s*$)/,r0=/[\p{P}\p{S}]/u,nR=/[\s\p{P}\p{S}]/u,p5=/[^\s\p{P}\p{S}]/u,FNe=Ct(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,nR).getRegex(),g5=/(?!~)[\p{P}\p{S}]/u,m5=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,jNe=Ct(m5,"u").replace(/punct/g,r0).getRegex(),VNe=Ct(m5,"u").replace(/punct/g,g5).getRegex(),_5="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",HNe=Ct(_5,"gu").replace(/notPunctSpace/g,p5).replace(/punctSpace/g,nR).replace(/punct/g,r0).getRegex(),zNe=Ct(_5,"gu").replace(/notPunctSpace/g,/(?:[^\s\p{P}\p{S}]|~)/u).replace(/punctSpace/g,/(?!~)[\s\p{P}\p{S}]/u).replace(/punct/g,g5).getRegex(),GNe=Ct("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,p5).replace(/punctSpace/g,nR).replace(/punct/g,r0).getRegex(),WNe=Ct(/\\(punct)/,"gu").replace(/punct/g,r0).getRegex(),$Ne=Ct(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),qNe=Ct(eR).replace("(?:--\x3e|$)","--\x3e").getRegex(),XNe=Ct("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",qNe).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),s0=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,YNe=Ct(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",s0).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),y5=Ct(/^!?\[(label)\]\[(ref)\]/).replace("label",s0).replace("ref",QD).getRegex(),v5=Ct(/^!?\[(ref)\](?:\[\])?/).replace("ref",QD).getRegex(),rR={_backpedal:Gg,anyPunctuation:WNe,autolink:$Ne,blockSkip:/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,br:f5,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:Gg,emStrongLDelim:jNe,emStrongRDelimAst:HNe,emStrongRDelimUnd:GNe,escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,link:YNe,nolink:v5,punctuation:FNe,reflink:y5,reflinkSearch:Ct("reflink|nolink(?!\\()","g").replace("reflink",y5).replace("nolink",v5).getRegex(),tag:XNe,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:Gg},KNe={...rR,link:Ct(/^!?\[(label)\]\((.*?)\)/).replace("label",s0).getRegex(),reflink:Ct(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",s0).getRegex()},iR={...rR,emStrongRDelimAst:zNe,emStrongLDelim:VNe,url:Ct(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},JNe={...iR,br:Ct(f5).replace("{2,}","*").getRegex(),text:Ct(iR.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},o0={normal:tR,gfm:RNe,pedantic:ONe},$g={normal:rR,gfm:iR,breaks:JNe,pedantic:KNe},QNe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},b5=n=>QNe[n];function Ao(n,e){if(e){if(Wr.escapeTest.test(n))return n.replace(Wr.escapeReplace,b5)}else if(Wr.escapeTestNoEncode.test(n))return n.replace(Wr.escapeReplaceNoEncode,b5);return n}function w5(n){try{n=encodeURI(n).replace(Wr.percentDecode,"%")}catch{return null}return n}function E5(n,e){const r=n.replace(Wr.findPipe,(s,o,a)=>{let c=!1,l=o;for(;--l>=0&&"\\"===a[l];)c=!c;return c?"|":" |"}).split(Wr.splitPipe);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(Wr.slashPipe,"|");return r}function qg(n,e,t){const r=n.length;if(0===r)return"";let i=0;for(;i<r&&n.charAt(r-i-1)===e;)i++;return n.slice(0,r-i)}function C5(n,e,t,r,i){const s=e.href,o=e.title||null,a=n[1].replace(i.other.outputLinkReplace,"$1");if("!"!==n[0].charAt(0)){r.state.inLink=!0;const c={type:"link",raw:t,href:s,title:o,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,c}return{type:"image",raw:t,href:s,title:o,text:a}}class a0{options;rules;lexer;constructor(e){this.options=e||Gl}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const r=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:qg(r,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const r=t[0],i=function tke(n,e,t){const r=n.match(t.other.indentCodeCompensation);if(null===r)return e;const i=r[1];return e.split("\n").map(s=>{const o=s.match(t.other.beginningSpace);if(null===o)return s;const[a]=o;return a.length>=i.length?s.slice(i.length):s}).join("\n")}(r,t[3]||"",this.rules);return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:i}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(this.rules.other.endingHash.test(r)){const i=qg(r,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(r=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:qg(t[0],"\n")}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let r=qg(t[0],"\n").split("\n"),i="",s="";const o=[];for(;r.length>0;){let a=!1;const c=[];let l;for(l=0;l<r.length;l++)if(this.rules.other.blockquoteStart.test(r[l]))c.push(r[l]),a=!0;else{if(a)break;c.push(r[l])}r=r.slice(l);const u=c.join("\n"),d=u.replace(this.rules.other.blockquoteSetextReplace,"\n    $1").replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}\n${u}`:u,s=s?`${s}\n${d}`:d;const h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,o,!0),this.lexer.state.top=h,0===r.length)break;const f=o.at(-1);if("code"===f?.type)break;if("blockquote"===f?.type){const p=f,g=p.raw+"\n"+r.join("\n"),m=this.blockquote(g);o[o.length-1]=m,i=i.substring(0,i.length-p.raw.length)+m.raw,s=s.substring(0,s.length-p.text.length)+m.text;break}if("list"!==f?.type);else{const p=f,g=p.raw+"\n"+r.join("\n"),m=this.list(g);o[o.length-1]=m,i=i.substring(0,i.length-f.raw.length)+m.raw,s=s.substring(0,s.length-p.raw.length)+m.raw,r=g.substring(o.at(-1).raw.length).split("\n")}}return{type:"blockquote",raw:i,tokens:o,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim();const i=r.length>1,s={type:"list",raw:"",ordered:i,start:i?+r.slice(0,-1):"",loose:!1,items:[]};r=i?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=i?r:"[*+-]");const o=this.rules.other.listItemRegex(r);let a=!1;for(;e;){let l=!1,u="",d="";if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;u=t[0],e=e.substring(u.length);let h=t[2].split("\n",1)[0].replace(this.rules.other.listReplaceTabs,v=>" ".repeat(3*v.length)),f=e.split("\n",1)[0],p=!h.trim(),g=0;if(this.options.pedantic?(g=2,d=h.trimStart()):p?g=t[1].length+1:(g=t[2].search(this.rules.other.nonSpaceChar),g=g>4?1:g,d=h.slice(g),g+=t[1].length),p&&this.rules.other.blankLine.test(f)&&(u+=f+"\n",e=e.substring(f.length+1),l=!0),!l){const v=this.rules.other.nextBulletRegex(g),_=this.rules.other.hrRegex(g),E=this.rules.other.fencesBeginRegex(g),T=this.rules.other.headingBeginRegex(g),I=this.rules.other.htmlBeginRegex(g);for(;e;){const D=e.split("\n",1)[0];let M;if(f=D,this.options.pedantic?(f=f.replace(this.rules.other.listReplaceNesting,"  "),M=f):M=f.replace(this.rules.other.tabCharGlobal,"    "),E.test(f)||T.test(f)||I.test(f)||v.test(f)||_.test(f))break;if(M.search(this.rules.other.nonSpaceChar)>=g||!f.trim())d+="\n"+M.slice(g);else{if(p||h.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||E.test(h)||T.test(h)||_.test(h))break;d+="\n"+f}!p&&!f.trim()&&(p=!0),u+=D+"\n",e=e.substring(D.length+1),h=M.slice(g)}}s.loose||(a?s.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(a=!0));let y,m=null;this.options.gfm&&(m=this.rules.other.listIsTask.exec(d),m&&(y="[ ] "!==m[0],d=d.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:u,task:!!m,checked:y,loose:!1,text:d,tokens:[]}),s.raw+=u}const c=s.items.at(-1);if(!c)return;c.raw=c.raw.trimEnd(),c.text=c.text.trimEnd(),s.raw=s.raw.trimEnd();for(let l=0;l<s.items.length;l++)if(this.lexer.state.top=!1,s.items[l].tokens=this.lexer.blockTokens(s.items[l].text,[]),!s.loose){const u=s.items[l].tokens.filter(h=>"space"===h.type),d=u.length>0&&u.some(h=>this.rules.other.anyLine.test(h.raw));s.loose=d}if(s.loose)for(let l=0;l<s.items.length;l++)s.items[l].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const r=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:i,title:s}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const r=E5(t[1]),i=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split("\n"):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(r.length===i.length){for(const a of i)this.rules.other.tableAlignRight.test(a)?o.align.push("right"):this.rules.other.tableAlignCenter.test(a)?o.align.push("center"):this.rules.other.tableAlignLeft.test(a)?o.align.push("left"):o.align.push(null);for(let a=0;a<r.length;a++)o.header.push({text:r[a],tokens:this.lexer.inline(r[a]),header:!0,align:o.align[a]});for(const a of s)o.rows.push(E5(a,o.header.length).map((c,l)=>({text:c,tokens:this.lexer.inline(c),header:!1,align:o.align[l]})));return o}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const r="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const r=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;const o=qg(r.slice(0,-1),"\\");if((r.length-o.length)%2==0)return}else{const o=function eke(n,e){if(-1===n.indexOf(e[1]))return-1;let t=0;for(let r=0;r<n.length;r++)if("\\"===n[r])r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return-1}(t[2],"()");if(o>-1){const c=(0===t[0].indexOf("!")?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,c).trim(),t[3]=""}}let i=t[2],s="";if(this.options.pedantic){const o=this.rules.other.pedanticHrefTitle.exec(i);o&&(i=o[1],s=o[3])}else s=t[3]?t[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(i=this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?i.slice(1):i.slice(1,-1)),C5(t,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const s=t[(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," ").toLowerCase()];if(!s){const o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return C5(r,s,r[0],this.lexer,this.rules)}}emStrong(e,t,r=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!(!i||i[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!i[1]&&!i[2]||!r||this.rules.inline.punctuation.exec(r))){const o=[...i[0]].length-1;let a,c,l=o,u=0;const d="*"===i[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,t=t.slice(-1*e.length+o);null!=(i=d.exec(t));){if(a=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!a)continue;if(c=[...a].length,i[3]||i[4]){l+=c;continue}if((i[5]||i[6])&&o%3&&!((o+c)%3)){u+=c;continue}if(l-=c,l>0)continue;c=Math.min(c,c+l+u);const h=[...i[0]][0].length,f=e.slice(0,o+i.index+h+c);if(Math.min(o,c)%2){const g=f.slice(1,-1);return{type:"em",raw:f,text:g,tokens:this.lexer.inlineTokens(g)}}const p=f.slice(2,-2);return{type:"strong",raw:f,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(this.rules.other.newLineCharGlobal," ");const i=this.rules.other.nonSpaceChar.test(r),s=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return i&&s&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:t[0],text:r}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let r,i;return"@"===t[2]?(r=t[1],i="mailto:"+r):(r=t[1],i=r),{type:"link",raw:t[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let r,i;if("@"===t[2])r=t[0],i="mailto:"+r;else{let s;do{s=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??""}while(s!==t[0]);r=t[0],i="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],escaped:this.lexer.state.inRawBlock}}}class Ji{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Gl,this.options.tokenizer=this.options.tokenizer||new a0,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:Wr,block:o0.normal,inline:$g.normal};this.options.pedantic?(t.block=o0.pedantic,t.inline=$g.pedantic):this.options.gfm&&(t.block=o0.gfm,t.inline=this.options.breaks?$g.breaks:$g.gfm),this.tokenizer.rules=t}static get rules(){return{block:o0,inline:$g}}static lex(e,t){return new Ji(t).lex(e)}static lexInline(e,t){return new Ji(t).inlineTokens(e)}lex(e){e=e.replace(Wr.carriageReturn,"\n"),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],r=!1){for(this.options.pedantic&&(e=e.replace(Wr.tabCharGlobal,"    ").replace(Wr.spaceLine,""));e;){let i;if(this.options.extensions?.block?.some(o=>!!(i=o.call({lexer:this},e,t))&&(e=e.substring(i.raw.length),t.push(i),!0)))continue;if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length);const o=t.at(-1);1===i.raw.length&&void 0!==o?o.raw+="\n":t.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length);const o=t.at(-1);"paragraph"===o?.type||"text"===o?.type?(o.raw+="\n"+i.raw,o.text+="\n"+i.text,this.inlineQueue.at(-1).src=o.text):t.push(i);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length);const o=t.at(-1);"paragraph"===o?.type||"text"===o?.type?(o.raw+="\n"+i.raw,o.text+="\n"+i.raw,this.inlineQueue.at(-1).src=o.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),t.push(i);continue}let s=e;if(this.options.extensions?.startBlock){let o=1/0;const a=e.slice(1);let c;this.options.extensions.startBlock.forEach(l=>{c=l.call({lexer:this},a),"number"==typeof c&&c>=0&&(o=Math.min(o,c))}),o<1/0&&o>=0&&(s=e.substring(0,o+1))}if(this.state.top&&(i=this.tokenizer.paragraph(s))){const o=t.at(-1);r&&"paragraph"===o?.type?(o.raw+="\n"+i.raw,o.text+="\n"+i.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):t.push(i),r=s.length!==e.length,e=e.substring(i.raw.length)}else if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length);const o=t.at(-1);"text"===o?.type?(o.raw+="\n"+i.raw,o.text+="\n"+i.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):t.push(i)}else if(e){const o="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(o);break}throw new Error(o)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r=e,i=null;if(this.tokens.links){const a=Object.keys(this.tokens.links);if(a.length>0)for(;null!=(i=this.tokenizer.rules.inline.reflinkSearch.exec(r));)a.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(i=this.tokenizer.rules.inline.blockSkip.exec(r));)r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(i=this.tokenizer.rules.inline.anyPunctuation.exec(r));)r=r.slice(0,i.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let s=!1,o="";for(;e;){let a;if(s||(o=""),s=!1,this.options.extensions?.inline?.some(l=>!!(a=l.call({lexer:this},e,t))&&(e=e.substring(a.raw.length),t.push(a),!0)))continue;if(a=this.tokenizer.escape(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.tag(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.link(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(a.raw.length);const l=t.at(-1);"text"===a.type&&"text"===l?.type?(l.raw+=a.raw,l.text+=a.text):t.push(a);continue}if(a=this.tokenizer.emStrong(e,r,o)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.codespan(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.br(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.del(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.autolink(e)){e=e.substring(a.raw.length),t.push(a);continue}if(!this.state.inLink&&(a=this.tokenizer.url(e))){e=e.substring(a.raw.length),t.push(a);continue}let c=e;if(this.options.extensions?.startInline){let l=1/0;const u=e.slice(1);let d;this.options.extensions.startInline.forEach(h=>{d=h.call({lexer:this},u),"number"==typeof d&&d>=0&&(l=Math.min(l,d))}),l<1/0&&l>=0&&(c=e.substring(0,l+1))}if(a=this.tokenizer.inlineText(c)){e=e.substring(a.raw.length),"_"!==a.raw.slice(-1)&&(o=a.raw.slice(-1)),s=!0;const l=t.at(-1);"text"===l?.type?(l.raw+=a.raw,l.text+=a.text):t.push(a)}else if(e){const l="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(l);break}throw new Error(l)}}return t}}class Wl{options;parser;constructor(e){this.options=e||Gl}space(e){return""}code({text:e,lang:t,escaped:r}){const i=(t||"").match(Wr.notSpaceStart)?.[0],s=e.replace(Wr.endingNewline,"")+"\n";return i?'<pre><code class="language-'+Ao(i)+'">'+(r?s:Ao(s,!0))+"</code></pre>\n":"<pre><code>"+(r?s:Ao(s,!0))+"</code></pre>\n"}blockquote({tokens:e}){return`<blockquote>\n${this.parser.parse(e)}</blockquote>\n`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>\n`}hr(e){return"<hr>\n"}list(e){const t=e.ordered,r=e.start;let i="";for(let a=0;a<e.items.length;a++)i+=this.listitem(e.items[a]);const s=t?"ol":"ul";return"<"+s+(t&&1!==r?' start="'+r+'"':"")+">\n"+i+"</"+s+">\n"}listitem(e){let t="";if(e.task){const r=this.checkbox({checked:!!e.checked});e.loose?"paragraph"===e.tokens[0]?.type?(e.tokens[0].text=r+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&"text"===e.tokens[0].tokens[0].type&&(e.tokens[0].tokens[0].text=r+" "+Ao(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>\n`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>\n`}table(e){let t="",r="";for(let s=0;s<e.header.length;s++)r+=this.tablecell(e.header[s]);t+=this.tablerow({text:r});let i="";for(let s=0;s<e.rows.length;s++){const o=e.rows[s];r="";for(let a=0;a<o.length;a++)r+=this.tablecell(o[a]);i+=this.tablerow({text:r})}return i&&(i=`<tbody>${i}</tbody>`),"<table>\n<thead>\n"+t+"</thead>\n"+i+"</table>\n"}tablerow({text:e}){return`<tr>\n${e}</tr>\n`}tablecell(e){const t=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+t+`</${r}>\n`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Ao(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:r}){const i=this.parser.parseInline(r),s=w5(e);if(null===s)return i;let o='<a href="'+(e=s)+'"';return t&&(o+=' title="'+Ao(t)+'"'),o+=">"+i+"</a>",o}image({href:e,title:t,text:r}){const i=w5(e);if(null===i)return Ao(r);let s=`<img src="${e=i}" alt="${r}"`;return t&&(s+=` title="${Ao(t)}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Ao(e.text)}}class sR{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class Qi{options;renderer;textRenderer;constructor(e){this.options=e||Gl,this.options.renderer=this.options.renderer||new Wl,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new sR}static parse(e,t){return new Qi(t).parse(e)}static parseInline(e,t){return new Qi(t).parseInline(e)}parse(e,t=!0){let r="";for(let i=0;i<e.length;i++){const s=e[i];if(this.options.extensions?.renderers?.[s.type]){const a=s,c=this.options.extensions.renderers[a.type].call({parser:this},a);if(!1!==c||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){r+=c||"";continue}}const o=s;switch(o.type){case"space":r+=this.renderer.space(o);continue;case"hr":r+=this.renderer.hr(o);continue;case"heading":r+=this.renderer.heading(o);continue;case"code":r+=this.renderer.code(o);continue;case"table":r+=this.renderer.table(o);continue;case"blockquote":r+=this.renderer.blockquote(o);continue;case"list":r+=this.renderer.list(o);continue;case"html":r+=this.renderer.html(o);continue;case"paragraph":r+=this.renderer.paragraph(o);continue;case"text":{let a=o,c=this.renderer.text(a);for(;i+1<e.length&&"text"===e[i+1].type;)a=e[++i],c+="\n"+this.renderer.text(a);r+=t?this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c,escaped:!0}]}):c;continue}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}parseInline(e,t=this.renderer){let r="";for(let i=0;i<e.length;i++){const s=e[i];if(this.options.extensions?.renderers?.[s.type]){const a=this.options.extensions.renderers[s.type].call({parser:this},s);if(!1!==a||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){r+=a||"";continue}}const o=s;switch(o.type){case"escape":case"text":r+=t.text(o);break;case"html":r+=t.html(o);break;case"link":r+=t.link(o);break;case"image":r+=t.image(o);break;case"strong":r+=t.strong(o);break;case"em":r+=t.em(o);break;case"codespan":r+=t.codespan(o);break;case"br":r+=t.br(o);break;case"del":r+=t.del(o);break;default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}}class c0{options;block;constructor(e){this.options=e||Gl}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Ji.lex:Ji.lexInline}provideParser(){return this.block?Qi.parse:Qi.parseInline}}const $l=new class nke{defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=Qi;Renderer=Wl;TextRenderer=sR;Lexer=Ji;Tokenizer=a0;Hooks=c0;constructor(...e){this.use(...e)}walkTokens(e,t){let r=[];for(const i of e)switch(r=r.concat(t.call(this,i)),i.type){case"table":{const s=i;for(const o of s.header)r=r.concat(this.walkTokens(o.tokens,t));for(const o of s.rows)for(const a of o)r=r.concat(this.walkTokens(a.tokens,t));break}case"list":r=r.concat(this.walkTokens(i.items,t));break;default:{const s=i;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(o=>{const a=s[o].flat(1/0);r=r.concat(this.walkTokens(a,t))}):s.tokens&&(r=r.concat(this.walkTokens(s.tokens,t)))}}return r}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const i={...r};if(i.async=this.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const o=t.renderers[s.name];t.renderers[s.name]=o?function(...a){let c=s.renderer.apply(this,a);return!1===c&&(c=o.apply(this,a)),c}:s.renderer}if("tokenizer"in s){if(!s.level||"block"!==s.level&&"inline"!==s.level)throw new Error("extension level must be 'block' or 'inline'");const o=t[s.level];o?o.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&("block"===s.level?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:"inline"===s.level&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),i.extensions=t),r.renderer){const s=this.defaults.renderer||new Wl(this.defaults);for(const o in r.renderer){if(!(o in s))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;const c=r.renderer[o],l=s[o];s[o]=(...u)=>{let d=c.apply(s,u);return!1===d&&(d=l.apply(s,u)),d||""}}i.renderer=s}if(r.tokenizer){const s=this.defaults.tokenizer||new a0(this.defaults);for(const o in r.tokenizer){if(!(o in s))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const c=r.tokenizer[o],l=s[o];s[o]=(...u)=>{let d=c.apply(s,u);return!1===d&&(d=l.apply(s,u)),d}}i.tokenizer=s}if(r.hooks){const s=this.defaults.hooks||new c0;for(const o in r.hooks){if(!(o in s))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;const c=r.hooks[o],l=s[o];s[o]=c0.passThroughHooks.has(o)?u=>{if(this.defaults.async)return Promise.resolve(c.call(s,u)).then(h=>l.call(s,h));const d=c.call(s,u);return l.call(s,d)}:(...u)=>{let d=c.apply(s,u);return!1===d&&(d=l.apply(s,u)),d}}i.hooks=s}if(r.walkTokens){const s=this.defaults.walkTokens,o=r.walkTokens;i.walkTokens=function(a){let c=[];return c.push(o.call(this,a)),s&&(c=c.concat(s.call(this,a))),c}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Ji.lex(e,t??this.defaults)}parser(e,t){return Qi.parse(e,t??this.defaults)}parseMarkdown(e){return(r,i)=>{const s={...i},o={...this.defaults,...s},a=this.onError(!!o.silent,!!o.async);if(!0===this.defaults.async&&!1===s.async)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof r>"u"||null===r)return a(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof r)return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=e);const c=o.hooks?o.hooks.provideLexer():e?Ji.lex:Ji.lexInline,l=o.hooks?o.hooks.provideParser():e?Qi.parse:Qi.parseInline;if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(r):r).then(u=>c(u,o)).then(u=>o.hooks?o.hooks.processAllTokens(u):u).then(u=>o.walkTokens?Promise.all(this.walkTokens(u,o.walkTokens)).then(()=>u):u).then(u=>l(u,o)).then(u=>o.hooks?o.hooks.postprocess(u):u).catch(a);try{o.hooks&&(r=o.hooks.preprocess(r));let u=c(r,o);o.hooks&&(u=o.hooks.processAllTokens(u)),o.walkTokens&&this.walkTokens(u,o.walkTokens);let d=l(u,o);return o.hooks&&(d=o.hooks.postprocess(d)),d}catch(u){return a(u)}}}onError(e,t){return r=>{if(r.message+="\nPlease report this to https://github.com/markedjs/marked.",e){const i="<p>An error occurred:</p><pre>"+Ao(r.message+"",!0)+"</pre>";return t?Promise.resolve(i):i}if(t)return Promise.reject(r);throw r}}};function mt(n,e){return $l.parse(n,e)}mt.options=mt.setOptions=function(n){return $l.setOptions(n),c5(mt.defaults=$l.defaults),mt},mt.getDefaults=function ZD(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}},mt.defaults=Gl,mt.use=function(...n){return $l.use(...n),c5(mt.defaults=$l.defaults),mt},mt.walkTokens=function(n,e){return $l.walkTokens(n,e)},mt.parseInline=$l.parseInline,mt.Parser=Qi,mt.parser=Qi.parse,mt.Renderer=Wl,mt.TextRenderer=sR,mt.Lexer=Ji,mt.lexer=Ji.lex,mt.Tokenizer=a0,mt.Hooks=c0,mt.parse=mt;const rke=["*"];let A5=(()=>{class n{constructor(){this._buttonClick$=new fe,this.copied$=this._buttonClick$.pipe(Bn(()=>al(ie(!0),Vb(3e3).pipe(O9(!1)))),rh(),Mi(1)),this.copiedText$=this.copied$.pipe(vc(!1),he(t=>t?"Copied":"Copy"))}onCopyToClipboardClick(){this._buttonClick$.next()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=nn({type:n,selectors:[["markdown-clipboard"]],decls:4,vars:7,consts:[[1,"markdown-clipboard-button",3,"click"]],template:function(r,i){1&r&&(It(0,"button",0),qa(1,"async"),wi("click",function(){return i.onCopyToClipboardClick()}),$a(2),qa(3,"async"),Ot()),2&r&&(bi("copied",Xa(1,3,i.copied$)),Yn(2),rl(Xa(3,5,i.copiedText$)))},dependencies:[by],encapsulation:2,changeDetection:0})}}return n})();const oke=new P("CLIPBOARD_OPTIONS");var oR=function(n){return n.CommandLine="command-line",n.LineHighlight="line-highlight",n.LineNumbers="line-numbers",n}(oR||{});const T5=new P("MARKED_EXTENSIONS"),cke=new P("MARKED_OPTIONS"),lke=new P("MERMAID_OPTIONS"),x5=new P("SECURITY_CONTEXT");let aR=(()=>{class n{get options(){return this._options}set options(t){this._options={...this.DEFAULT_MARKED_OPTIONS,...t}}get renderer(){return this.options.renderer}set renderer(t){this.options.renderer=t}constructor(t,r,i,s,o,a,c,l){this.clipboardOptions=t,this.extensions=r,this.mermaidOptions=s,this.platform=o,this.securityContext=a,this.http=c,this.sanitizer=l,this.DEFAULT_MARKED_OPTIONS={renderer:new Wl},this.DEFAULT_KATEX_OPTIONS={delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\begin{CD}",right:"\\end{CD}",display:!0},{left:"\\[",right:"\\]",display:!0}]},this.DEFAULT_MERMAID_OPTIONS={startOnLoad:!1},this.DEFAULT_CLIPBOARD_OPTIONS={buttonComponent:void 0},this.DEFAULT_PARSE_OPTIONS={decodeHtml:!1,inline:!1,emoji:!1,mermaid:!1,markedOptions:void 0,disableSanitizer:!1},this.DEFAULT_RENDER_OPTIONS={clipboard:!1,clipboardOptions:void 0,katex:!1,katexOptions:void 0,mermaid:!1,mermaidOptions:void 0},this._reload$=new fe,this.reload$=this._reload$.asObservable(),this.options=i}parse(t,r=this.DEFAULT_PARSE_OPTIONS){const{decodeHtml:i,inline:s,emoji:o,mermaid:a,disableSanitizer:c}=r,l={...this.options,...r.markedOptions},u=l.renderer||this.renderer||new Wl;this.extensions&&(this.renderer=this.extendsRendererForExtensions(u)),a&&(this.renderer=this.extendsRendererForMermaid(u));const d=this.trimIndentation(t),h=i?this.decodeHtml(d):d,f=o?this.parseEmoji(h):h,p=this.parseMarked(f,l,s);return(c?p:this.sanitizer.sanitize(this.securityContext,p))||""}render(t,r=this.DEFAULT_RENDER_OPTIONS,i){const{clipboard:s,clipboardOptions:o,katex:a,katexOptions:c,mermaid:l,mermaidOptions:u}=r;a&&this.renderKatex(t,{...this.DEFAULT_KATEX_OPTIONS,...c}),l&&this.renderMermaid(t,{...this.DEFAULT_MERMAID_OPTIONS,...this.mermaidOptions,...u}),s&&this.renderClipboard(t,i,{...this.DEFAULT_CLIPBOARD_OPTIONS,...this.clipboardOptions,...o}),this.highlight(t)}reload(){this._reload$.next()}getSource(t){if(!this.http)throw new Error("[ngx-markdown] When using the `src` attribute you *have to* pass the `HttpClient` as a parameter of the `forRoot` method. See README for more information");return this.http.get(t,{responseType:"text"}).pipe(he(r=>this.handleExtension(t,r)))}highlight(t){if(!Ka(this.platform)||typeof Prism>"u"||typeof Prism.highlightAllUnder>"u")return;t||(t=document);const r=t.querySelectorAll('pre code:not([class*="language-"])');Array.prototype.forEach.call(r,i=>i.classList.add("language-none")),Prism.highlightAllUnder(t)}decodeHtml(t){if(!Ka(this.platform))return t;const r=document.createElement("textarea");return r.innerHTML=t,r.value}extendsRendererForExtensions(t){const r=t;return!0===r.\u0275NgxMarkdownRendererExtendedForExtensions||(this.extensions?.length>0&&mt.use(...this.extensions),r.\u0275NgxMarkdownRendererExtendedForExtensions=!0),t}extendsRendererForMermaid(t){const r=t;if(!0===r.\u0275NgxMarkdownRendererExtendedForMermaid)return t;const i=t.code;return t.code=s=>"mermaid"===s.lang?`<div class="mermaid">${s.text}</div>`:i(s),r.\u0275NgxMarkdownRendererExtendedForMermaid=!0,t}handleExtension(t,r){const i=t.lastIndexOf("://"),s=i>-1?t.substring(i+4):t,o=s.lastIndexOf("/"),a=o>-1?s.substring(o+1).split("?")[0]:"",c=a.lastIndexOf("."),l=c>-1?a.substring(c+1):"";return l&&"md"!==l?"```"+l+"\n"+r+"\n```":r}parseMarked(t,r,i=!1){if(r.renderer){const s={...r.renderer};delete s.\u0275NgxMarkdownRendererExtendedForExtensions,delete s.\u0275NgxMarkdownRendererExtendedForMermaid,delete r.renderer,mt.use({renderer:s})}return i?mt.parseInline(t,r):mt.parse(t,r)}parseEmoji(t){if(!Ka(this.platform))return t;if(typeof joypixels>"u"||typeof joypixels.shortnameToUnicode>"u")throw new Error("[ngx-markdown] When using the `emoji` attribute you *have to* include Emoji-Toolkit files to `angular.json` or use imports. See README for more information");return joypixels.shortnameToUnicode(t)}renderKatex(t,r){if(Ka(this.platform)){if(typeof katex>"u"||typeof renderMathInElement>"u")throw new Error("[ngx-markdown] When using the `katex` attribute you *have to* include KaTeX files to `angular.json` or use imports. See README for more information");renderMathInElement(t,r)}}renderClipboard(t,r,i){if(!Ka(this.platform))return;if(typeof ClipboardJS>"u")throw new Error("[ngx-markdown] When using the `clipboard` attribute you *have to* include Clipboard files to `angular.json` or use imports. See README for more information");if(!r)throw new Error("[ngx-markdown] When using the `clipboard` attribute you *have to* provide the `viewContainerRef` parameter to `MarkdownService.render()` function");const{buttonComponent:s,buttonTemplate:o}=i,a=t.querySelectorAll("pre");for(let c=0;c<a.length;c++){const l=a.item(c),u=document.createElement("div");u.style.position="relative",l.parentNode.insertBefore(u,l),u.appendChild(l);const d=document.createElement("div");let h,f;if(d.classList.add("markdown-clipboard-toolbar"),d.style.position="absolute",d.style.top=".5em",d.style.right=".5em",d.style.zIndex="1",u.insertAdjacentElement("beforeend",d),u.onmouseenter=()=>d.classList.add("hover"),u.onmouseleave=()=>d.classList.remove("hover"),s){const p=r.createComponent(s);h=p.hostView,p.changeDetectorRef.markForCheck()}else if(o)h=r.createEmbeddedView(o);else{const p=r.createComponent(A5);h=p.hostView,p.changeDetectorRef.markForCheck()}h.rootNodes.forEach(p=>{d.appendChild(p),f=new ClipboardJS(p,{text:()=>l.innerText})}),h.onDestroy(()=>f.destroy())}}renderMermaid(t,r=this.DEFAULT_MERMAID_OPTIONS){if(!Ka(this.platform))return;if(typeof mermaid>"u"||typeof mermaid.initialize>"u")throw new Error("[ngx-markdown] When using the `mermaid` attribute you *have to* include Mermaid files to `angular.json` or use imports. See README for more information");const i=t.querySelectorAll(".mermaid");0!==i.length&&(mermaid.initialize(r),mermaid.run({nodes:i}))}trimIndentation(t){if(!t)return"";let r;return t.split("\n").map(i=>{let s=r;return i.length>0&&(s=isNaN(s)?i.search(/\S|$/):Math.min(i.search(/\S|$/),s)),isNaN(r)&&(r=s),s?i.substring(s):i}).join("\n")}static{this.\u0275fac=function(r){return new(r||n)(X(oke,8),X(T5,8),X(cke,8),X(lke,8),X(ko),X(x5),X(Ds,8),X(op))}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac})}}return n})(),S5=(()=>{class n{get disableSanitizer(){return this._disableSanitizer}set disableSanitizer(t){this._disableSanitizer=this.coerceBooleanProperty(t)}get inline(){return this._inline}set inline(t){this._inline=this.coerceBooleanProperty(t)}get clipboard(){return this._clipboard}set clipboard(t){this._clipboard=this.coerceBooleanProperty(t)}get emoji(){return this._emoji}set emoji(t){this._emoji=this.coerceBooleanProperty(t)}get katex(){return this._katex}set katex(t){this._katex=this.coerceBooleanProperty(t)}get mermaid(){return this._mermaid}set mermaid(t){this._mermaid=this.coerceBooleanProperty(t)}get lineHighlight(){return this._lineHighlight}set lineHighlight(t){this._lineHighlight=this.coerceBooleanProperty(t)}get lineNumbers(){return this._lineNumbers}set lineNumbers(t){this._lineNumbers=this.coerceBooleanProperty(t)}get commandLine(){return this._commandLine}set commandLine(t){this._commandLine=this.coerceBooleanProperty(t)}constructor(t,r,i){this.element=t,this.markdownService=r,this.viewContainerRef=i,this.error=new ze,this.load=new ze,this.ready=new ze,this._clipboard=!1,this._commandLine=!1,this._disableSanitizer=!1,this._emoji=!1,this._inline=!1,this._katex=!1,this._lineHighlight=!1,this._lineNumbers=!1,this._mermaid=!1,this.destroyed$=new fe}ngOnChanges(){this.loadContent()}loadContent(){null==this.data?null==this.src||this.handleSrc():this.handleData()}ngAfterViewInit(){!this.data&&!this.src&&this.handleTransclusion(),this.markdownService.reload$.pipe(ua(this.destroyed$)).subscribe(()=>this.loadContent())}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}render(t,r=!1){var i=this;return j(function*(){const s={decodeHtml:r,inline:i.inline,emoji:i.emoji,mermaid:i.mermaid,disableSanitizer:i.disableSanitizer},o={clipboard:i.clipboard,clipboardOptions:i.getClipboardOptions(),katex:i.katex,katexOptions:i.katexOptions,mermaid:i.mermaid,mermaidOptions:i.mermaidOptions},a=yield i.markdownService.parse(t,s);i.element.nativeElement.innerHTML=a,i.handlePlugins(),i.markdownService.render(i.element.nativeElement,o,i.viewContainerRef),i.ready.emit()})()}coerceBooleanProperty(t){return null!=t&&"false"!=`${String(t)}`}getClipboardOptions(){if(this.clipboardButtonComponent||this.clipboardButtonTemplate)return{buttonComponent:this.clipboardButtonComponent,buttonTemplate:this.clipboardButtonTemplate}}handleData(){this.render(this.data)}handleSrc(){this.markdownService.getSource(this.src).subscribe({next:t=>{this.render(t).then(()=>{this.load.emit(t)})},error:t=>this.error.emit(t)})}handleTransclusion(){this.render(this.element.nativeElement.innerHTML,!0)}handlePlugins(){this.commandLine&&(this.setPluginClass(this.element.nativeElement,oR.CommandLine),this.setPluginOptions(this.element.nativeElement,{dataFilterOutput:this.filterOutput,dataHost:this.host,dataPrompt:this.prompt,dataOutput:this.output,dataUser:this.user})),this.lineHighlight&&this.setPluginOptions(this.element.nativeElement,{dataLine:this.line,dataLineOffset:this.lineOffset}),this.lineNumbers&&(this.setPluginClass(this.element.nativeElement,oR.LineNumbers),this.setPluginOptions(this.element.nativeElement,{dataStart:this.start}))}setPluginClass(t,r){const i=t.querySelectorAll("pre");for(let s=0;s<i.length;s++){const o=r instanceof Array?r:[r];i.item(s).classList.add(...o)}}setPluginOptions(t,r){const i=t.querySelectorAll("pre");for(let s=0;s<i.length;s++)Object.keys(r).forEach(o=>{const a=r[o];if(a){const c=this.toLispCase(o);i.item(s).setAttribute(c,a.toString())}})}toLispCase(t){const r=t.match(/([A-Z])/g);if(!r)return t;let i=t.toString();for(let s=0,o=r.length;s<o;s++)i=i.replace(new RegExp(r[s]),"-"+r[s].toLowerCase());return"-"===i.slice(0,1)&&(i=i.slice(1)),i}static{this.\u0275fac=function(r){return new(r||n)(pe(fn),pe(aR),pe(Lr))}}static{this.\u0275cmp=nn({type:n,selectors:[["markdown"],["","markdown",""]],inputs:{data:"data",src:"src",disableSanitizer:"disableSanitizer",inline:"inline",clipboard:"clipboard",clipboardButtonComponent:"clipboardButtonComponent",clipboardButtonTemplate:"clipboardButtonTemplate",emoji:"emoji",katex:"katex",katexOptions:"katexOptions",mermaid:"mermaid",mermaidOptions:"mermaidOptions",lineHighlight:"lineHighlight",line:"line",lineOffset:"lineOffset",lineNumbers:"lineNumbers",start:"start",commandLine:"commandLine",filterOutput:"filterOutput",host:"host",prompt:"prompt",output:"output",user:"user"},outputs:{error:"error",load:"load",ready:"ready"},features:[us],ngContentSelectors:rke,decls:1,vars:0,template:function(r,i){1&r&&(Wa(),br(0))},encapsulation:2})}}return n})();function vke(n,e){if(1&n&&(It(0,"div",16),Ks(1,"youtube-player",17),Ot()),2&n){const t=Ga(3);Yn(),jC("videoId",t.videoID)}}function bke(n,e){if(1&n&&(It(0,"mat-expansion-panel",11)(1,"mat-expansion-panel-header")(2,"h2",12),$a(3),Ot()(),It(4,"div",13),Ks(5,"markdown",14),gs(6,vke,2,1,"div",15),Ot()()),2&n){const t=Ga(),r=t.$implicit,i=t.index;Br("expanded",0===i),Yn(3),rl(r.title),Yn(2),bi("first",0===i),Br("data",r.content),Yn(),Br("ngIf",0===i)}}function wke(n,e){if(1&n&&(It(0,"div",9),gs(1,bke,7,6,"mat-expansion-panel",10),Ot()),2&n){const t=e.$implicit;Yn(),Br("ngIf",t)}}let Eke=(()=>{class n{dialogRef;data;documentationContents;infoTitle;videoID;constructor(t,r){this.dialogRef=t,this.data=r,this.documentationContents=r.content||[],this.infoTitle=r.title||"",this.videoID=r.videoID}ngOnInit(){const t=document.createElement("script");t.src="https://www.youtube.com/iframe_api",document.body.appendChild(t)}close(){document.getElementsByClassName("modal-animated")[0]?.classList.add("modal-animate-fade-out"),setTimeout(()=>{this.dialogRef.close()},250)}static \u0275fac=function(r){return new(r||n)(pe(Kb),pe(k6))};static \u0275cmp=nn({type:n,selectors:[["ccf-info-dialog"]],standalone:!1,decls:11,vars:2,consts:[[1,"about","wrapper"],[1,"container"],[1,"content"],[1,"header"],["mat-dialog-title","",1,"title"],[1,"close"],[1,"material-icons","close-icon",3,"click"],[1,"mat-typography","dialog-content"],["class","panel",4,"ngFor","ngForOf"],[1,"panel"],[3,"expanded",4,"ngIf"],[3,"expanded"],[1,"no-header-margin"],[1,"top-padding"],[1,"variable-binding",3,"data"],["class","video-player",4,"ngIf"],[1,"video-player"],[3,"videoId"]],template:function(r,i){1&r&&(It(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),$a(5),Ot(),It(6,"div",5)(7,"mat-icon",6),wi("click",function(){return i.close()}),$a(8,"clear"),Ot()()(),It(9,"mat-dialog-content",7),gs(10,wke,2,1,"div",8),Ot()()()()),2&r&&(Yn(5),rl(i.infoTitle),Yn(5),Br("ngForOf",i.documentationContents))},dependencies:[d2,NA,$D,qD,W6,n5,gNe,bNe,S5],styles:[".mat-dialog-container{padding:0}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:1.5rem;text-align:left}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;height:3rem;margin-bottom:2.25rem;position:relative}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.5rem;margin-bottom:1rem}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{cursor:pointer;height:3rem;width:3rem;line-height:3rem;text-align:center;transition:.6s}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.5rem;margin:0 auto;line-height:3rem;height:3rem;justify-self:center;display:flex}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1rem;margin-top:0;margin-bottom:.5rem}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]{margin-bottom:1.5rem}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .no-header-margin[_ngcontent-%COMP%]{font-weight:300;margin-bottom:0}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .top-padding[_ngcontent-%COMP%]{display:flex}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .top-padding[_ngcontent-%COMP%]   markdown[_ngcontent-%COMP%]     ul{margin-top:0;padding-left:1.5rem}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]{height:50rem;min-height:10rem;padding:0 1.5rem}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding[_ngcontent-%COMP%]{font-weight:300;display:flex}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding.first[_ngcontent-%COMP%]{padding-right:1rem;width:73%}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding[_ngcontent-%COMP%]     ul{margin:0}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding[_ngcontent-%COMP%]     img{margin-left:1rem;float:right}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .video-player[_ngcontent-%COMP%]{position:relative;width:50%}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .video-player[_ngcontent-%COMP%]     iframe{width:100%;height:100%}"],changeDetection:0})}return n})();class es{static storage=(()=>{let e;try{e=window.localStorage;const t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&e&&0!==e.length?e:void 0}})();get length(){return es.storage?.length??0}key(e){return es.storage?.key(e)??null}getItem(e,t){return es.storage?.getItem(e)??t??null}setItem(e,t){try{return es.storage?.setItem(e,t),!0}catch{return!1}}removeItem(e){es.storage?.removeItem(e)}clear(){es.storage?.clear()}static \u0275fac=function(t){return new(t||es)};static \u0275prov=U({token:es,factory:es.\u0275fac,providedIn:"root"})}var l0;const I5="callToActionPopupShown";let ts=class h0{static{l0=this}dialog;ga;storage;infoService;http;static callToActionComponent;static ctaDatePassed(e,t=Date.now){return+t()>+new Date(e)}constructor(e,t,r,i,s){this.dialog=e,this.ga=t,this.storage=r,this.infoService=i,this.http=s}ngxsOnInit(e){const{expirationDate:t,popupShown:r}=e.getState(),i=this.storage.getItem(I5,`${r}`),s=l0.ctaDatePassed(t);"true"!==i&&!s&&e.dispatch(new H9)}getDialogData(){return this.http.get("assets/docs/SPATIAL_SEARCH_README.md",{responseType:"text"}).pipe(he(e=>this.infoService.parseMarkdown(e)))}launchLearnMore(e){this.dialog.open(Eke,{autoFocus:!1,panelClass:"modal-animated",width:"72rem",data:{title:"Spatial Search",content:e,videoID:"UfxMpzatowE"}})}learnMore(e){return this.dialog.closeAll(),this.ga.event("open_learn_more","call_to_action"),this.getDialogData().pipe(qt(t=>this.launchLearnMore(t)))}open(e){this.dialog.open(l0.callToActionComponent,{autoFocus:!1,panelClass:"modal-animated",width:"30.75rem",height:"36.688rem"}),this.ga.event("open","call_to_action"),this.storage.setItem(I5,"true"),e.patchState({popupShown:!0})}close(e){this.dialog.closeAll(),this.ga.event("close","call_to_action")}static \u0275fac=function(t){return new(t||h0)(X(Jb),X(dD),X(es),X(U6),X(Ds))};static \u0275prov=U({token:h0,factory:h0.\u0275fac})};Ye([RM(V9),Q("design:type",Function),Q("design:paramtypes",[Object]),Q("design:returntype",Se)],ts.prototype,"learnMore",null),Ye([RM(H9),Q("design:type",Function),Q("design:paramtypes",[Object]),Q("design:returntype",void 0)],ts.prototype,"open",null),Ye([RM(z9),Q("design:type",Function),Q("design:paramtypes",[Object]),Q("design:returntype",void 0)],ts.prototype,"close",null),ts=l0=Ye([OM({name:"callToAction",defaults:{title:"New to the Exploration User Interface",message:"Spatial Search has arrived!",callToAction:"Learn More",imageUrl:"assets/images/spatial_search.gif",expirationDate:"Dec 1, 2022",popupShown:!1}}),Q("design:paramtypes",[Jb,dD,es,U6,Ds])],ts);class To{static title(e){return e.title}static message(e){return e.message}static callToAction(e){return e.callToAction}static imageUrl(e){return e.imageUrl}static expirationDate(e){return e.expirationDate}static popupShown(e){return e.popupShown}}Ye([sh([ts]),Q("design:type",Function),Q("design:paramtypes",[Object]),Q("design:returntype",String)],To,"title",null),Ye([sh([ts]),Q("design:type",Function),Q("design:paramtypes",[Object]),Q("design:returntype",String)],To,"message",null),Ye([sh([ts]),Q("design:type",Function),Q("design:paramtypes",[Object]),Q("design:returntype",String)],To,"callToAction",null),Ye([sh([ts]),Q("design:type",Function),Q("design:paramtypes",[Object]),Q("design:returntype",String)],To,"imageUrl",null),Ye([sh([ts]),Q("design:type",Function),Q("design:paramtypes",[Object]),Q("design:returntype",String)],To,"expirationDate",null),Ye([sh([ts]),Q("design:type",Function),Q("design:paramtypes",[Object]),Q("design:returntype",Boolean)],To,"popupShown",null);let M5=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=et({type:n,selectors:[["","mat-card-sm-image",""],["","matCardImageSmall",""]],hostAttrs:[1,"mat-mdc-card-sm-image","mdc-card__media"]})}return n})(),Uke=(()=>{class n{clsName="ccf-call-to-action";infoTitle;imageUrl;message;callToAction;callToActionClicked=new ze;closeClicked=new ze;close(){this.closeClicked.emit()}onDialogButtonClick(){this.callToActionClicked.emit()}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["ccf-call-to-action"]],hostVars:2,hostBindings:function(r,i){2&r&&k_(i.clsName)},inputs:{infoTitle:"infoTitle",imageUrl:"imageUrl",message:"message",callToAction:"callToAction"},outputs:{callToActionClicked:"callToActionClicked",closeClicked:"closeClicked"},standalone:!1,decls:13,vars:4,consts:[[1,"rui-about","wrapper"],[1,"container"],[1,"content"],[1,"first-row"],["mat-dialog-title","",1,"title"],[1,"cta-mat-icon","material-icons","close-icon",3,"click"],["mat-card-sm-image","","alt","preview","layout-fill","",1,"cta-image",3,"src"],[1,"mat-typography","dialog-content"],[1,"message"],["mat-button","",1,"mat-button",3,"click","text"]],template:function(r,i){1&r&&(It(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"p",4),$a(5),Ot(),It(6,"mat-icon",5),wi("click",function(){return i.close()}),$a(7,"clear"),Ot()(),Ks(8,"img",6),It(9,"mat-dialog-content",7)(10,"div",8),$a(11),Ot(),It(12,"a",9),wi("click",function(){return i.onDialogButtonClick()}),Ot()()()()()),2&r&&(Yn(5),rl(i.infoTitle),Yn(3),Br("src",i.imageUrl,hE),Yn(3),rl(i.message),Yn(),Br("text",i.callToAction))},dependencies:[W6,$D,qD,M5],styles:["[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{display:block;align-content:center;padding-left:1.6rem;padding-right:1.6rem;border-radius:.25rem}[_nghost-%COMP%]   .info-button-wrapper[_ngcontent-%COMP%]{border-radius:.25rem;padding:.6rem;transition:.6s}[_nghost-%COMP%]   .info-button-wrapper[_ngcontent-%COMP%]   .ccf-info-button[_ngcontent-%COMP%]{cursor:pointer;transition:color .6s;font-size:1.2rem;vertical-align:sub}[_nghost-%COMP%]   .first-row[_ngcontent-%COMP%]{display:flex;width:100%;line-height:.9rem}[_nghost-%COMP%]   .first-row[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:7rem;padding-left:.2rem;font-size:.875rem;padding-top:.75rem}[_nghost-%COMP%]   .first-row[_ngcontent-%COMP%]   .cta-mat-icon[_ngcontent-%COMP%]{height:30%;line-height:3.4rem}[_nghost-%COMP%]   .message[_ngcontent-%COMP%]{padding:.5rem}[_nghost-%COMP%]   .cta-image[_ngcontent-%COMP%]{align-self:center;object-fit:cover;width:100%;border-radius:.25rem}[_nghost-%COMP%]   .mat-button[_ngcontent-%COMP%]{background-color:#444a65;font-size:.75rem;position:relative;margin-bottom:1rem;width:100%;height:2rem;color:#fff}"],changeDetection:0})}return n})();class xo{title$;message$;callToAction$;imageUrl$;close=()=>new z9;learnMore=()=>new V9;static \u0275fac=function(t){return new(t||xo)};static \u0275cmp=nn({type:xo,selectors:[["ccf-call-to-action-behavior"]],standalone:!1,decls:5,vars:12,consts:[[3,"callToActionClicked","closeClicked","infoTitle","message","callToAction","imageUrl"]],template:function(t,r){if(1&t&&(It(0,"ccf-call-to-action",0),qa(1,"async"),qa(2,"async"),qa(3,"async"),qa(4,"async"),wi("callToActionClicked",function(){return r.learnMore()})("closeClicked",function(){return r.close()}),Ot()),2&t){let i,s,o,a;Br("infoTitle",null!==(i=Xa(1,4,r.title$))&&void 0!==i?i:"")("message",null!==(s=Xa(2,6,r.message$))&&void 0!==s?s:"")("callToAction",null!==(o=Xa(3,8,r.callToAction$))&&void 0!==o?o:"")("imageUrl",null!==(a=Xa(4,10,r.imageUrl$))&&void 0!==a?a:"")}},dependencies:[Uke,by],encapsulation:2,changeDetection:0})}Ye([ub(To.title),Q("design:type",Se)],xo.prototype,"title$",void 0),Ye([ub(To.message),Q("design:type",Se)],xo.prototype,"message$",void 0),Ye([ub(To.callToAction),Q("design:type",Se)],xo.prototype,"callToAction$",void 0),Ye([ub(To.imageUrl),Q("design:type",Se)],xo.prototype,"imageUrl$",void 0),Ye([j9(),Q("design:type",Object)],xo.prototype,"close",void 0),Ye([j9(),Q("design:type",Object)],xo.prototype,"learnMore",void 0),ts.callToActionComponent=xo,new Set(Object.keys({q:[0,0,1],e:[0,0,-1],w:[0,1,0],s:[0,-1,0],a:[-1,0,0],d:[1,0,0]}));const Vke={initialConfig:{},parse:{},rename:{}};class Hke{configState;options;storedChanges={};constructor(e,t){this.configState=e,this.options={...Vke,...t}}addChanges(e){this.storedChanges={...this.storedChanges,...e}}applyChanges(e,t={}){void 0===e&&(e=this.storedChanges,this.storedChanges={});const{configState:r,options:{initialConfig:i}}=this,o={...i,...r.snapshot,...t};for(const[a,c]of Object.entries(e))this.processChange(a,c,o);r.setConfig(o)}processChange(e,t,r){const{options:{parse:i,rename:s}}=this,o=s[e]??e,a=t.currentValue,c=i[e]??i[o];if(null==a)delete r[o];else if(c)try{r[o]=c(a)}catch(l){console.warn(`Failed to parse ${e} = ${a} (${typeof a})`,l.message)}else r[o]=a}}let zke=(()=>{class n{configState;cdr;options;initialized=!1;configManager;_init;constructor(t,r,i={}){this.configState=t,this.cdr=r,this.options=i,this.configManager=new Hke(this.configState,this.options)}ngOnInit(){this._init=setTimeout(()=>this.initialize(),this.options.initialDelay??0)}ngOnDestroy(){this._init&&clearTimeout(this._init)}ngOnChanges(t){this.configManager.addChanges(t),this.initialized&&this.configManager.applyChanges()}initialize(){this._init=void 0,!this.initialized&&(this.configManager.applyChanges(),this.initialized=!0,this.cdr.markForCheck())}static \u0275fac=function(r){!function mN(){throw new Error("invalid")}()};static \u0275dir=et({type:n,features:[us]})}return n})();const cR_dbOptions={dataSources:["https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/kpmp/data/rui_locations.jsonld","https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/sparc/data/rui_locations.jsonld"],hubmapDataService:"search-api",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"https://search.api.hubmapconsortium.org/v3/entities/search",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"},Xke=[173,255,47,229.5];let Qke=(()=>{class n{configState=A(bc);api=A(wD);data$=this.configState.getOption("data");zoomToID$=this.configState.getOption("zoomToID").pipe(he(t=>`http://purl.org/ccf/1.5/entity/${t}`));highlightID$=this.configState.getOption("highlightID").pipe(he(t=>`http://purl.org/ccf/1.5/entity/${t}`));referenceOrgans$=this.api.referenceOrgans({});scene$=Ol([this.data$,this.referenceOrgans$]).pipe(Bn(([t,r])=>this.chooseScene(t,r)));organs$=this.configState.getOption("data").pipe(he(t=>this.selectOrgans(t)),Mi(1));filteredOrgans$=Ol([this.organs$,this.referenceOrgans$]).pipe(he(([t,r])=>this.getNeededReferenceOrgans(r,t)),Mi(1));filteredScene$=Ol([this.scene$,this.organs$,this.referenceOrgans$]).pipe(he(([t,r,i])=>this.filterSceneNodes(t,r,i)),function Zke(n,e){const t=n.pipe(vc(""));return r=>Ol([r,t]).pipe(he(([i,s])=>i.map(o=>function Yke(n,e,t){return n.entityId!==e?n:{...n,color:t}}(o,s,e))))}(this.highlightID$,Xke),function Jke(n){const e=n.pipe(vc(""));return t=>Ol([t,e]).pipe(he(([r,i])=>r.map(s=>function Kke(n,e){return n.entityId!==e?n:{...n,zoomToOnLoad:!0}}(s,i))))}(this.zoomToID$),Mi(1));chooseScene(t,r){const i=t?.map(this.getPlacementTarget)??[];if(new Set(i).size>1)return this.api.scene({});if(r){const o=r.find(a=>a["@id"]===i[0]);if(o)return this.api.referenceOrganScene({organIri:o.representation_of??"",ontologyTerms:[o.reference_organ??""],sex:o.sex})}return ie([])}selectOrgans(t){return new Set(t?.map(this.getPlacementTarget))}filterSceneNodes(t,r,i){const s=this.getNeededReferenceOrgans(i,r),o=this.getNeededSkins(s),a=new Set([...r,...o]);return t.filter(c=>!c.reference_organ||a.has(c.reference_organ))}getNeededReferenceOrgans(t,r){return t.filter(i=>r.has(i.reference_organ??""))}getNeededSkins(t){if(1===t.length)return[];const r=new Set;return t.forEach(i=>{"Female"===i.sex?r.add("http://purl.org/ccf/latest/ccf.owl#VHFSkin"):"Male"===i.sex&&r.add("http://purl.org/ccf/latest/ccf.owl#VHMSkin")}),[...r]}getPlacementTarget(t){return t["http://purl.org/ccf/latest/ccf-entity.owl#has_spatial_entity"]?.placement.target}static \u0275fac=function(r){return new(r||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const eFe=["bodyUI"],tFe=()=>[];let nFe=(()=>{class n{bodyUI;onMouseEnter=new ze;onMouseLeave=new ze;onClick=new ze;configState=A(bc);sceneSource=A(Qke);cdr=A(vs);data$=this.configState.getOption("data");organs$=this.sceneSource.filteredOrgans$;scene$=this.sceneSource.filteredScene$.pipe(qt(t=>this.reset()));reset(){var t=this;return j(function*(){const{bodyUI:r}=t;yield new Promise(o=>{setTimeout(o,200)});const i=yield function Gke(n,e){const t="object"==typeof e;return new Promise((r,i)=>{let o,s=!1;n.subscribe({next:a=>{o=a,s=!0},error:i,complete:()=>{s?r(o):t?r(e.defaultValue):i(new gd)}})})}(t.organs$.pipe(Vn(1))),s=!!r.scene?.find(o=>o.zoomToOnLoad);if(r.rotation=0,r.rotationX=0,!s)if(i&&1===i.length){const{x_dimension:o,y_dimension:a,z_dimension:c}=i[0];r.bounds={x:1.25*o/1e3,y:1.25*a/1e3,z:1.25*c/1e3},r.target=[o/1e3/2,a/1e3/2,c/1e3/2]}else r.bounds={x:2.2,y:2,z:.4},r.target=[0,0,0];t.cdr.detectChanges()})()}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["ccf-root"]],viewQuery:function(r,i){if(1&r&&nl(eFe,7),2&r){let s;Vo(s=Ho())&&(i.bodyUI=s.first)}},outputs:{onMouseEnter:"onMouseEnter",onMouseLeave:"onMouseLeave",onClick:"onClick"},standalone:!1,decls:3,vars:5,consts:[["bodyUI",""],["camera","perspective",1,"body-ui",3,"nodeClick","nodeHoverStart","nodeHoverStop","scene","interactive"]],template:function(r,i){if(1&r){const s=B_();It(0,"ccf-body-ui",1,0),qa(2,"async"),wi("nodeClick",function(a){return Ma(s),Da(i.onClick.emit(a))})("nodeHoverStart",function(a){return Ma(s),Da(i.onMouseEnter.emit(a))})("nodeHoverStop",function(a){return Ma(s),Da(i.onMouseLeave.emit(a))}),Ot()}if(2&r){let s;Br("scene",null!==(s=Xa(2,2,i.scene$))&&void 0!==s?s:function lL(n,e,t){const r=Nr()+n,i=N();return i[r]===ke?Xs(i,r,t?e.call(t):e()):function Pf(n,e){return n[e]}(i,r)}(4,tFe))("interactive",!0)}},dependencies:[Gxe,by],styles:[".body-ui[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0})}return n})();function rFe(n,e){if(1&n){const t=B_();It(0,"ccf-root",1),wi("onMouseEnter",function(i){return Ma(t),Da(Ga().onMouseEnter.emit(i))})("onMouseLeave",function(i){return Ma(t),Da(Ga().onMouseLeave.emit(i))})("onClick",function(i){return Ma(t),Da(Ga().onClick.emit(i))}),Ot()}}function iFe(n){return"string"==typeof n&&(n=JSON.parse(n)),n.map(e=>({"@id":`http://purl.org/ccf/1.5/entity/${e.id}`,"@type":"http://purl.org/ccf/latest/ccf-entity.owl#Sample","http://purl.org/ccf/latest/ccf-entity.owl#has_spatial_entity":e.rui_location}))}let sFe=(()=>{class n extends zke{data;highlightID;zoomToID;onMouseEnter=new ze;onMouseLeave=new ze;onClick=new ze;constructor(t,r){super(t,r,{initialDelay:10,initialConfig:{...cR_dbOptions,...globalThis.dbOptions},parse:{data:iFe}})}static \u0275fac=function(r){return new(r||n)(pe(bc),pe(vs))};static \u0275cmp=nn({type:n,selectors:[["ccf-root-wc"]],inputs:{data:"data",highlightID:"highlightID",zoomToID:"zoomToID"},outputs:{onMouseEnter:"onMouseEnter",onMouseLeave:"onMouseLeave",onClick:"onClick"},standalone:!1,features:[jo],decls:1,vars:1,consts:[[3,"onMouseEnter","onMouseLeave","onClick",4,"ngIf"],[3,"onMouseEnter","onMouseLeave","onClick"]],template:function(r,i){1&r&&gs(0,rFe,1,0,"ccf-root",0),2&r&&Br("ngIf",i.initialized)},dependencies:[NA,nFe],encapsulation:2,changeDetection:0})}return n})();class oFe{constructor(e){this.options=e,this.options=this.options||{},this.logger=e.logger||console}startGroup(e){const t=this.options.collapsed?this.logger.groupCollapsed:this.logger.group;try{t.call(this.logger,e)}catch{console.log(e)}}endGroup(){try{this.logger.groupEnd()}catch{this.logger.log("\u2014\u2014 log end \u2014\u2014")}}logGrey(e,t){this.log(e,"color: #9E9E9E; font-weight: bold",t)}logGreen(e,t){this.log(e,"color: #4CAF50; font-weight: bold",t)}logRedish(e,t){this.log(e,"color: #FD8182; font-weight: bold",t)}log(e,t,r){this.logger.log("%c "+e,t,r)}}const u0=(n,e)=>((n,e)=>new Array(e+1).join("0"))(0,e-n.toString().length)+n;class lFe{constructor(e,t,r){this.action=e,this.store=t,this.logWriter=r}dispatched(e){const t=Rl(this.action),r=function cFe(n){return u0(n.getHours(),2)+":"+u0(n.getMinutes(),2)+":"+u0(n.getSeconds(),2)+"."+u0(n.getMilliseconds(),3)}(new Date);this.logWriter.startGroup(`action ${t} @ ${r}`),this._hasPayload(this.action)&&this.logWriter.logGrey("payload",{...this.action}),this.logWriter.logGrey("prev state",e)}completed(e){this.logWriter.logGreen("next state",e),this.logWriter.endGroup()}errored(e){this.logWriter.logRedish("next state after error",this.store.snapshot()),this.logWriter.logRedish("error",e),this.logWriter.endGroup()}_hasPayload(e){return this._getNonEmptyProperties(e).length>0}_getNonEmptyProperties(e){return Object.keys(e).map(i=>e[i]).filter(i=>void 0!==i)}}const lR=new P("NGXS_LOGGER_PLUGIN_OPTIONS");let D5=(()=>{class n{constructor(){this._options=A(lR),this._injector=A(pt)}handle(t,r,i){if(this._options.disabled||this._skipLogging(t,r))return i(t,r);this._logWriter||=new oFe(this._options),this._store||=this._injector.get(Zi);const s=new lFe(r,this._store,this._logWriter);return s.dispatched(t),i(t,r).pipe(qt(o=>{s.completed(o)}),_o(o=>{throw s.errored(o),o}))}_skipLogging(t,r){return!gi(this._injector,()=>this._options.filter(r,t))}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=U({token:n,factory:n.\u0275fac})}}return n})();const d0=new P("LOGGER_USER_OPTIONS");function R5(n){return{logger:console,collapsed:!1,disabled:!1,filter:()=>!0,...n}}let uFe=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[OIe(D5),{provide:d0,useValue:t},{provide:lR,useFactory:R5,deps:[d0]}]}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=ji({type:n})}static{this.\u0275inj=fi({})}}return n})();const dFe=[bc];let hFe=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=ji({type:n});static \u0275inj=fi({imports:[lMe.forRoot(),wIe.forRoot(dFe,{developmentMode:!1}),uFe.forRoot({disabled:true})]})}return n})();!function Loe(){KA.apply(this,arguments)}("ccf-body-ui-wc",sFe,{providers:[TR((()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=ji({type:n});static \u0275inj=fi({providers:[f1e()],imports:[goe,hFe,Boe]})}return n})())]})},772:hr=>{"use strict";hr.exports=Qe,hr.exports.default=Qe;var Hn=1e20;function Qe(_e,ut,xe,We,j,Fe){this.fontSize=_e||24,this.buffer=void 0===ut?3:ut,this.cutoff=We||.25,this.fontFamily=j||"sans-serif",this.fontWeight=Fe||"normal",this.radius=xe||8;var Z=this.size=this.fontSize+2*this.buffer,J=Z+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Z,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(J*J),this.gridInner=new Float64Array(J*J),this.f=new Float64Array(J),this.z=new Float64Array(J+1),this.v=new Uint16Array(J),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(Z/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function rn(_e,ut,xe,We,j,Fe){for(var Z=0;Z<ut;Z++)zn(_e,Z,ut,xe,We,j,Fe);for(var J=0;J<xe;J++)zn(_e,J*ut,1,ut,We,j,Fe)}function zn(_e,ut,xe,We,j,Fe,Z){var J,ne,be,ee;for(Fe[0]=0,Z[0]=-Hn,Z[1]=Hn,J=0;J<We;J++)j[J]=_e[ut+J*xe];for(J=1,ne=0,be=0;J<We;J++){do{be=(j[J]-j[ee=Fe[ne]]+J*J-ee*ee)/(J-ee)/2}while(be<=Z[ne]&&--ne>-1);Fe[++ne]=J,Z[ne]=be,Z[ne+1]=Hn}for(J=0,ne=0;J<We;J++){for(;Z[ne+1]<J;)ne++;_e[ut+J*xe]=j[ee=Fe[ne]]+(J-ee)*(J-ee)}}Qe.prototype._draw=function(_e,ut){var Fe,Z,J,ne,be,ee,le,jt,Dn,xe=this.ctx.measureText(_e),We=xe.width,j=2*this.buffer;ut&&this.useMetrics?(be=Math.floor(xe.actualBoundingBoxAscent),jt=this.buffer+Math.ceil(xe.actualBoundingBoxAscent),ee=this.buffer,le=this.buffer,Fe=(Z=Math.min(this.size,Math.ceil(xe.actualBoundingBoxRight-xe.actualBoundingBoxLeft)))+j,J=(ne=Math.min(this.size-ee,Math.ceil(xe.actualBoundingBoxAscent+xe.actualBoundingBoxDescent)))+j,this.ctx.textBaseline="alphabetic"):(Fe=Z=this.size,J=ne=this.size,be=19*this.fontSize/24,ee=le=0,jt=this.middle,this.ctx.textBaseline="middle"),Z&&ne&&(this.ctx.clearRect(le,ee,Z,ne),this.ctx.fillText(_e,this.buffer,jt),Dn=this.ctx.getImageData(le,ee,Z,ne));var nt=new Uint8ClampedArray(Fe*J);return function yn(_e,ut,xe,We,j,Fe,Z){Fe.fill(Hn,0,ut*xe),Z.fill(0,0,ut*xe);for(var J=(ut-We)/2,ne=0;ne<j;ne++)for(var be=0;be<We;be++){var ee=(ne+J)*ut+be+J,le=_e.data[4*(ne*We+be)+3]/255;if(1===le)Fe[ee]=0,Z[ee]=Hn;else if(0===le)Fe[ee]=Hn,Z[ee]=0;else{var jt=Math.max(0,.5-le),Dn=Math.max(0,le-.5);Fe[ee]=jt*jt,Z[ee]=Dn*Dn}}}(Dn,Fe,J,Z,ne,this.gridOuter,this.gridInner),rn(this.gridOuter,Fe,J,this.f,this.v,this.z),rn(this.gridInner,Fe,J,this.f,this.v,this.z),function kt(_e,ut,xe,We,j,Fe,Z){for(var J=0;J<ut*xe;J++){var ne=Math.sqrt(We[J])-Math.sqrt(j[J]);_e[J]=Math.round(255-255*(ne/Fe+Z))}}(nt,Fe,J,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:nt,metrics:{width:Z,height:ne,sdfWidth:Fe,sdfHeight:J,top:be,left:0,advance:We}}},Qe.prototype.draw=function(_e){return this._draw(_e,!1).data},Qe.prototype.drawWithMetrics=function(_e){return this._draw(_e,!0)}}},hr=>{hr(hr.s=738)}]);