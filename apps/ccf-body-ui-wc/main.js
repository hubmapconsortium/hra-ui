(self.webpackChunkccf_body_ui_wc=self.webpackChunkccf_body_ui_wc||[]).push([[792],{772:ti=>{"use strict";ti.exports=qe,ti.exports.default=qe;var Pn=1e20;function qe(fe,rt,be,ke,ve,De){this.fontSize=fe||24,this.buffer=void 0===rt?3:rt,this.cutoff=ke||.25,this.fontFamily=ve||"sans-serif",this.fontWeight=De||"normal",this.radius=be||8;var te=this.size=this.fontSize+2*this.buffer,K=te+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=te,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(K*K),this.gridInner=new Float64Array(K*K),this.f=new Float64Array(K),this.z=new Float64Array(K+1),this.v=new Uint16Array(K),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(te/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function $t(fe,rt,be,ke,ve,De){for(var te=0;te<rt;te++)Nn(fe,te,rt,be,ke,ve,De);for(var K=0;K<be;K++)Nn(fe,K*rt,1,rt,ke,ve,De)}function Nn(fe,rt,be,ke,ve,De,te){var K,H,Ue,Ke;for(De[0]=0,te[0]=-Pn,te[1]=Pn,K=0;K<ke;K++)ve[K]=fe[rt+K*be];for(K=1,H=0,Ue=0;K<ke;K++){do{Ue=(ve[K]-ve[Ke=De[H]]+K*K-Ke*Ke)/(K-Ke)/2}while(Ue<=te[H]&&--H>-1);De[++H]=K,te[H]=Ue,te[H+1]=Pn}for(K=0,H=0;K<ke;K++){for(;te[H+1]<K;)H++;fe[rt+K*be]=ve[Ke=De[H]]+(K-Ke)*(K-Ke)}}qe.prototype._draw=function(fe,rt){var De,te,K,H,Ue,Ke,ce,ft,qt,be=this.ctx.measureText(fe),ke=be.width,ve=2*this.buffer;rt&&this.useMetrics?(Ue=Math.floor(be.actualBoundingBoxAscent),ft=this.buffer+Math.ceil(be.actualBoundingBoxAscent),Ke=this.buffer,ce=this.buffer,De=(te=Math.min(this.size,Math.ceil(be.actualBoundingBoxRight-be.actualBoundingBoxLeft)))+ve,K=(H=Math.min(this.size-Ke,Math.ceil(be.actualBoundingBoxAscent+be.actualBoundingBoxDescent)))+ve,this.ctx.textBaseline="alphabetic"):(De=te=this.size,K=H=this.size,Ue=19*this.fontSize/24,Ke=ce=0,ft=this.middle,this.ctx.textBaseline="middle"),te&&H&&(this.ctx.clearRect(ce,Ke,te,H),this.ctx.fillText(fe,this.buffer,ft),qt=this.ctx.getImageData(ce,Ke,te,H));var gt=new Uint8ClampedArray(De*K);return function Kt(fe,rt,be,ke,ve,De,te){De.fill(Pn,0,rt*be),te.fill(0,0,rt*be);for(var K=(rt-ke)/2,H=0;H<ve;H++)for(var Ue=0;Ue<ke;Ue++){var Ke=(H+K)*rt+Ue+K,ce=fe.data[4*(H*ke+Ue)+3]/255;if(1===ce)De[Ke]=0,te[Ke]=Pn;else if(0===ce)De[Ke]=Pn,te[Ke]=0;else{var ft=Math.max(0,.5-ce),qt=Math.max(0,ce-.5);De[Ke]=ft*ft,te[Ke]=qt*qt}}}(qt,De,K,te,H,this.gridOuter,this.gridInner),$t(this.gridOuter,De,K,this.f,this.v,this.z),$t(this.gridInner,De,K,this.f,this.v,this.z),function xt(fe,rt,be,ke,ve,De,te){for(var K=0;K<rt*be;K++){var H=Math.sqrt(ke[K])-Math.sqrt(ve[K]);fe[K]=Math.round(255-255*(H/De+te))}}(gt,De,K,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:gt,metrics:{width:te,height:H,sdfWidth:De,sdfHeight:K,top:Ue,left:0,advance:ke}}},qe.prototype.draw=function(fe){return this._draw(fe,!1).data},qe.prototype.drawWithMetrics=function(fe){return this._draw(fe,!0)}},237:(ti,Pn,qe)=>{"use strict";var Kt={};qe.r(Kt),qe.d(Kt,{decode:()=>txe,name:()=>exe});var xt={};qe.r(xt),qe.d(xt,{name:()=>axe,preprocess:()=>cxe});var $t={};qe.r($t),qe.d($t,{name:()=>lxe,preprocess:()=>uxe});var Nn={};qe.r(Nn),qe.d(Nn,{decode:()=>Xxe,encode:()=>Yxe,name:()=>$xe,preprocess:()=>qxe});var fe={};qe.r(fe),qe.d(fe,{decode:()=>eIe,encode:()=>tIe,name:()=>Qxe});var rt={};qe.r(rt),qe.d(rt,{decode:()=>iIe,encode:()=>rIe,name:()=>nIe});var be={};function ke(t,e){return Object.is(t,e)}qe.r(be),qe.d(be,{decode:()=>oIe,encode:()=>aIe,name:()=>sIe});let ve=null,De=!1,te=1;const K=Symbol("SIGNAL");function H(t){const e=ve;return ve=t,e}const ft={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function qt(t){if(De)throw new Error("");if(null===ve)return;ve.consumerOnSignalRead(t);const e=ve.nextProducerIndex++;zt(ve),e<ve.producerNode.length&&ve.producerNode[e]!==t&&mt(ve)&&Oe(ve.producerNode[e],ve.producerIndexOfThis[e]),ve.producerNode[e]!==t&&(ve.producerNode[e]=t,ve.producerIndexOfThis[e]=mt(ve)?Ae(t,ve,e):0),ve.producerLastReadVersion[e]=t.version}function vn(t){if((!mt(t)||t.dirty)&&(t.dirty||t.lastCleanEpoch!==te)){if(!t.producerMustRecompute(t)&&!J(t))return t.dirty=!1,void(t.lastCleanEpoch=te);t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=te}}function Ki(t){if(void 0===t.liveConsumerNode)return;const e=De;De=!0;try{for(const n of t.liveConsumerNode)n.dirty||_i(n)}finally{De=e}}function kn(){return!1!==ve?.consumerAllowSignalWrites}function _i(t){t.dirty=!0,Ki(t),t.consumerMarkedDirty?.(t)}function yi(t){return t&&(t.nextProducerIndex=0),H(t)}function Y(t,e){if(H(e),t&&void 0!==t.producerNode&&void 0!==t.producerIndexOfThis&&void 0!==t.producerLastReadVersion){if(mt(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Oe(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function J(t){zt(t);for(let e=0;e<t.producerNode.length;e++){const n=t.producerNode[e],i=t.producerLastReadVersion[e];if(i!==n.version||(vn(n),i!==n.version))return!0}return!1}function we(t){if(zt(t),mt(t))for(let e=0;e<t.producerNode.length;e++)Oe(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Ae(t,e,n){if(It(t),0===t.liveConsumerNode.length&&Jt(t))for(let i=0;i<t.producerNode.length;i++)t.producerIndexOfThis[i]=Ae(t.producerNode[i],t,i);return t.liveConsumerIndexOfThis.push(n),t.liveConsumerNode.push(e)-1}function Oe(t,e){if(It(t),1===t.liveConsumerNode.length&&Jt(t))for(let i=0;i<t.producerNode.length;i++)Oe(t.producerNode[i],t.producerIndexOfThis[i]);const n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){const i=t.liveConsumerIndexOfThis[e],r=t.liveConsumerNode[e];zt(r),r.producerIndexOfThis[i]=e}}function mt(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function zt(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function It(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function Jt(t){return void 0!==t.producerNode}const Un=Symbol("UNSET"),Fn=Symbol("COMPUTING"),st=Symbol("ERRORED"),ni={...ft,value:Un,dirty:!0,error:null,equal:ke,producerMustRecompute:t=>t.value===Un||t.value===Fn,producerRecomputeValue(t){if(t.value===Fn)throw new Error("Detected cycle in computations.");const e=t.value;t.value=Fn;const n=yi(t);let i;try{i=t.computation()}catch(r){i=st,t.error=r}finally{Y(t,n)}e!==Un&&e!==st&&i!==st&&t.equal(e,i)?t.value=e:(t.value=i,t.version++)}};let Qp=function Ji(){throw new Error};function _l(){Qp()}let yl=null;function jn(t,e){kn()||_l(),t.equal(t.value,e)||(t.value=e,function Qa(t){t.version++,function gt(){te++}(),Ki(t),yl?.()}(t))}const Za={...ft,equal:ke,value:void 0};function Fe(t){return"function"==typeof t}function Ko(t){const n=t(i=>{Error.call(i),i.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const ii=Ko(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function El(t,e){if(t){const n=t.indexOf(e);0<=n&&t.splice(n,1)}}class bt{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const s of n)s.remove(this);else n.remove(this);const{initialTeardown:i}=this;if(Fe(i))try{i()}catch(s){e=s instanceof ii?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{ng(s)}catch(o){e=e??[],o instanceof ii?e=[...e,...o.errors]:e.push(o)}}if(e)throw new ii(e)}}add(e){var n;if(e&&e!==this)if(this.closed)ng(e);else{if(e instanceof bt){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}}_hasParent(e){const{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){const{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&El(n,e)}remove(e){const{_finalizers:n}=this;n&&El(n,e),e instanceof bt&&e._removeParent(this)}}bt.EMPTY=(()=>{const t=new bt;return t.closed=!0,t})();const eg=bt.EMPTY;function tg(t){return t instanceof bt||t&&"closed"in t&&Fe(t.remove)&&Fe(t.add)&&Fe(t.unsubscribe)}function ng(t){Fe(t)?t():t.unsubscribe()}const Er={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},tc={setTimeout(t,e,...n){const{delegate:i}=tc;return i?.setTimeout?i.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){const{delegate:e}=tc;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Pd(t){tc.setTimeout(()=>{const{onUnhandledError:e}=Er;if(!e)throw t;e(t)})}function nc(){}const wl=Ld("C",void 0,void 0);function Ld(t,e,n){return{kind:t,value:e,error:n}}let lo=null;function Al(t){if(Er.useDeprecatedSynchronousErrorHandling){const e=!lo;if(e&&(lo={errorThrown:!1,error:null}),t(),e){const{errorThrown:n,error:i}=lo;if(lo=null,n)throw i}}else t()}class Jo extends bt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,tg(e)&&e.add(this)):this.destination=Db}static create(e,n,i){return new uo(e,n,i)}next(e){this.isStopped?Bd(function Sb(t){return Ld("N",t,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Bd(function Nd(t){return Ld("E",void 0,t)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Bd(wl,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Ib=Function.prototype.bind;function Fd(t,e){return Ib.call(t,e)}class ig{constructor(e){this.partialObserver=e}next(e){const{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(i){Zo(i)}}error(e){const{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(i){Zo(i)}else Zo(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Zo(n)}}}class uo extends Jo{constructor(e,n,i){let r;if(super(),Fe(e)||!e)r={next:e??void 0,error:n??void 0,complete:i??void 0};else{let s;this&&Er.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Fd(e.next,s),error:e.error&&Fd(e.error,s),complete:e.complete&&Fd(e.complete,s)}):r=e}this.destination=new ig(r)}}function Zo(t){Er.useDeprecatedSynchronousErrorHandling?function xb(t){Er.useDeprecatedSynchronousErrorHandling&&lo&&(lo.errorThrown=!0,lo.error=t)}(t):Pd(t)}function Bd(t,e){const{onStoppedNotification:n}=Er;n&&tc.setTimeout(()=>n(t,e))}const Db={closed:!0,next:nc,error:function Mb(t){throw t},complete:nc},Cl="function"==typeof Symbol&&Symbol.observable||"@@observable";function ps(t){return t}let ge=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){const i=new t;return i.source=this,i.operator=n,i}subscribe(n,i,r){const s=function og(t){return t&&t instanceof Jo||function Ob(t){return t&&Fe(t.next)&&Fe(t.error)&&Fe(t.complete)}(t)&&tg(t)}(n)?n:new uo(n,i,r);return Al(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(i){n.error(i)}}forEach(n,i){return new(i=sg(i))((r,s)=>{const o=new uo({next:a=>{try{n(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(n){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(n)}[Cl](){return this}pipe(...n){return function rg(t){return 0===t.length?ps:1===t.length?t[0]:function(n){return t.reduce((i,r)=>r(i),n)}}(n)(this)}toPromise(n){return new(n=sg(n))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return t.create=e=>new t(e),t})();function sg(t){var e;return null!==(e=t??Er.Promise)&&void 0!==e?e:Promise}const kd=Ko(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let de=(()=>{class t extends ge{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const i=new Ud(this,this);return i.operator=n,i}_throwIfClosed(){if(this.closed)throw new kd}next(n){Al(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(n)}})}error(n){Al(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:i}=this;for(;i.length;)i.shift().error(n)}})}complete(){Al(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:i,isStopped:r,observers:s}=this;return i||r?eg:(this.currentObservers=null,s.push(n),new bt(()=>{this.currentObservers=null,El(s,n)}))}_checkFinalizedStatuses(n){const{hasError:i,thrownError:r,isStopped:s}=this;i?n.error(r):s&&n.complete()}asObservable(){const n=new ge;return n.source=this,n}}return t.create=(e,n)=>new Ud(e,n),t})();class Ud extends de{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===i||i.call(n,e)}error(e){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===i||i.call(n,e)}complete(){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===n||n.call(e)}_subscribe(e){var n,i;return null!==(i=null===(n=this.source)||void 0===n?void 0:n.subscribe(e))&&void 0!==i?i:eg}}class on extends de{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){const{hasError:e,thrownError:n,_value:i}=this;if(e)throw n;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function Vd(t){return Fe(t?.lift)}function _t(t){return e=>{if(Vd(e))return e.lift(function(n){try{return t(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function ot(t,e,n,i,r){return new ag(t,e,n,i,r)}class ag extends Jo{constructor(e,n,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function se(t,e){return _t((n,i)=>{let r=0;n.subscribe(ot(i,s=>{i.next(t.call(e,s,r++))}))})}typeof navigator<"u"&&navigator,typeof navigator<"u"&&!/Opera/.test(navigator.userAgent)&&navigator,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||navigator),typeof navigator<"u"&&!/Opera|WebKit/.test(navigator.userAgent)&&navigator,typeof navigator<"u"&&navigator;const sD="https://g.co/ng/security#xss";class $ extends Error{constructor(e,n){super(function Il(t,e){return`NG0${Math.abs(t)}${e?": "+e:""}`}(e,n)),this.code=e}}function po(t){return{toString:t}.toString()}const Dl="__parameters__";function Ol(t,e,n){return po(()=>{const i=function Ub(t){return function(...n){if(t){const i=t(...n);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(c,l,u){const d=c.hasOwnProperty(Dl)?c[Dl]:Object.defineProperty(c,Dl,{value:[]})[Dl];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),c}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}const Et=globalThis;function yt(t){for(let e in t)if(t[e]===yt)return e;throw Error("Could not find renamed property on target object.")}function b9(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function wn(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(wn).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function Vb(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const E9=yt({__forward_ref__:yt});function jb(t){return t.__forward_ref__=jb,t.toString=function(){return wn(this())},t}function Ce(t){return _g(t)?t():t}function _g(t){return"function"==typeof t&&t.hasOwnProperty(E9)&&t.__forward_ref__===jb}function V(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function tr(t){return{providers:t.providers||[],imports:t.imports||[]}}function yg(t){return lD(t,bg)||lD(t,uD)}function lD(t,e){return t.hasOwnProperty(e)?t[e]:null}function vg(t){return t&&(t.hasOwnProperty(Hb)||t.hasOwnProperty(x9))?t[Hb]:null}const bg=yt({\u0275prov:yt}),Hb=yt({\u0275inj:yt}),uD=yt({ngInjectableDef:yt}),x9=yt({ngInjectorDef:yt});class L{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=V({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function qb(t){return t&&!!t.\u0275providers}const qd=yt({\u0275cmp:yt}),Xb=yt({\u0275dir:yt}),Yb=yt({\u0275pipe:yt}),go=yt({\u0275fac:yt}),Xd=yt({__NG_ELEMENT_ID__:yt}),fD=yt({__NG_ENV_ID__:yt});function Ie(t){return"string"==typeof t?t:null==t?"":String(t)}function Kb(t,e){throw new $(-201,!1)}var We=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(We||{});let Jb;function pD(){return Jb}function Oi(t){const e=Jb;return Jb=t,e}function gD(t,e,n){const i=yg(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:n&We.Optional?null:void 0!==e?e:void Kb()}const Yd={},Zb="__NG_DI_FLAG__",Eg="ngTempTokenPath",P9=/\n/gm,mD="__source";let Pl;function ia(t){const e=Pl;return Pl=t,e}function F9(t,e=We.Default){if(void 0===Pl)throw new $(-203,!1);return null===Pl?gD(t,void 0,e):Pl.get(t,e&We.Optional?null:void 0,e)}function D(t,e=We.Default){return(pD()||F9)(Ce(t),e)}function O(t,e=We.Default){return D(t,wg(e))}function wg(t){return typeof t>"u"||"number"==typeof t?t:(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Qb(t){const e=[];for(let n=0;n<t.length;n++){const i=Ce(t[n]);if(Array.isArray(i)){if(0===i.length)throw new $(900,!1);let r,s=We.Default;for(let o=0;o<i.length;o++){const a=i[o],c=B9(a);"number"==typeof c?-1===c?r=a.token:s|=c:r=a}e.push(D(r,s))}else e.push(D(i))}return e}function Kd(t,e){return t[Zb]=e,t.prototype[Zb]=e,t}function B9(t){return t[Zb]}const Nl=Kd(Ol("Optional"),8),Ag=Kd(Ol("SkipSelf"),4);function sc(t,e){return t.hasOwnProperty(go)?t[go]:null}function Ll(t,e){t.forEach(n=>Array.isArray(n)?Ll(n,e):e(n))}function yD(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Cg(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function nr(t,e,n){let i=Fl(t,e);return i>=0?t[1|i]=n:(i=~i,function vD(t,e,n,i){let r=t.length;if(r==e)t.push(n,i);else if(1===r)t.push(i,t[0]),t[0]=n;else{for(r--,t.push(t[r-1],t[r]);r>e;)t[r]=t[r-2],r--;t[e]=n,t[e+1]=i}}(t,i,e,n)),i}function t0(t,e){const n=Fl(t,e);if(n>=0)return t[1|n]}function Fl(t,e){return function bD(t,e,n){let i=0,r=t.length>>n;for(;r!==i;){const s=i+(r-i>>1),o=t[s<<n];if(e===o)return s<<n;o>e?r=s:i=s+1}return~(r<<n)}(t,e,1)}const gs={},et=[],ir=new L(""),Sg=new L("",-1),n0=new L("");class xg{get(e,n=Yd){if(n===Yd){const i=new Error(`NullInjectorError: No provider for ${wn(e)}!`);throw i.name="NullInjectorError",i}return n}}var Ig=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Ig||{}),qr=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(qr||{}),ra=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(ra||{});function G9(t,e,n){let i=t.length;for(;;){const r=t.indexOf(e,n);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||t.charCodeAt(r+s)<=32)return r}n=r+1}}function r0(t,e,n){let i=0;for(;i<n.length;){const r=n[i];if("number"==typeof r){if(0!==r)break;i++;const s=n[i++],o=n[i++],a=n[i++];t.setAttribute(e,o,a,s)}else{const s=r,o=n[++i];wD(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),i++}}return i}function ED(t){return 3===t||4===t||6===t}function wD(t){return 64===t.charCodeAt(0)}function Jd(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?n=r:0===n||AD(t,n,r,null,-1===n||2===n?e[++i]:null)}}return t}function AD(t,e,n,i,r){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const a=t[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<t.length;){const a=t[s];if("number"==typeof a)break;if(a===n){if(null===i)return void(null!==r&&(t[s+1]=r));if(i===t[s+1])return void(t[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),null!==i&&t.splice(s++,0,i),null!==r&&t.splice(s++,0,r)}const CD="ng-template";function W9(t,e,n,i){let r=0;if(i){for(;r<e.length&&"string"==typeof e[r];r+=2)if("class"===e[r]&&-1!==G9(e[r+1].toLowerCase(),n,0))return!0}else if(s0(t))return!1;if(r=e.indexOf(1,r),r>-1){let s;for(;++r<e.length&&"string"==typeof(s=e[r]);)if(s.toLowerCase()===n)return!0}return!1}function s0(t){return 4===t.type&&t.value!==CD}function $9(t,e,n){return e===(4!==t.type||n?t.value:CD)}function q9(t,e,n){let i=4;const r=t.attrs,s=null!==r?function K9(t){for(let e=0;e<t.length;e++)if(ED(t[e]))return e;return t.length}(r):0;let o=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!o)if(4&i){if(i=2|1&i,""!==c&&!$9(t,c,n)||""===c&&1===e.length){if(Xr(i))return!1;o=!0}}else if(8&i){if(null===r||!W9(t,r,c,n)){if(Xr(i))return!1;o=!0}}else{const l=e[++a],u=X9(c,r,s0(t),n);if(-1===u){if(Xr(i))return!1;o=!0;continue}if(""!==l){let d;if(d=u>s?"":r[u+1].toLowerCase(),2&i&&l!==d){if(Xr(i))return!1;o=!0}}}}else{if(!o&&!Xr(i)&&!Xr(c))return!1;if(o&&Xr(c))continue;o=!1,i=c|1&i}}return Xr(i)||o}function Xr(t){return!(1&t)}function X9(t,e,n,i){if(null===e)return-1;let r=0;if(i||!n){let s=!1;for(;r<e.length;){const o=e[r];if(o===t)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function J9(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const i=t[n];if("number"==typeof i)return-1;if(i===e)return n;n++}return-1}(e,t)}function TD(t,e,n=!1){for(let i=0;i<e.length;i++)if(q9(t,e[i],n))return!0;return!1}function Z9(t,e){e:for(let n=0;n<e.length;n++){const i=e[n];if(t.length===i.length){for(let r=0;r<t.length;r++)if(t[r]!==i[r])continue e;return!0}}return!1}function SD(t,e){return t?":not("+e.trim()+")":e}function Q9(t){let e=t[0],n=1,i=2,r="",s=!1;for(;n<t.length;){let o=t[n];if("string"==typeof o)if(2&i){const a=t[++n];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Xr(o)&&(e+=SD(s,r),r=""),i=o,s=s||!Xr(i);n++}return""!==r&&(e+=SD(s,r)),e}function an(t){return po(()=>{const e=ID(t),n={...e,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Ig.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||qr.Emulated,styles:t.styles||et,_:null,schemas:t.schemas||null,tView:null,id:""};MD(n);const i=t.dependencies;return n.directiveDefs=Mg(i,!1),n.pipeDefs=Mg(i,!0),n.id=function o5(t){let e=0;const n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const r of n)e=Math.imul(31,e)+r.charCodeAt(0)|0;return e+=2147483648,"c"+e}(n),n})}function n5(t){return je(t)||An(t)}function r5(t){return null!==t}function Tr(t){return po(()=>({type:t.type,bootstrap:t.bootstrap||et,declarations:t.declarations||et,imports:t.imports||et,exports:t.exports||et,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function xD(t,e){if(null==t)return gs;const n={};for(const i in t)if(t.hasOwnProperty(i)){const r=t[i];let s,o,a=ra.None;Array.isArray(r)?(a=r[0],s=r[1],o=r[2]??s):(s=r,o=r),e?(n[s]=a!==ra.None?[i,a]:i,e[s]=o):n[s]=i}return n}function Xe(t){return po(()=>{const e=ID(t);return MD(e),e})}function ri(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function je(t){return t[qd]||null}function An(t){return t[Xb]||null}function zn(t){return t[Yb]||null}function ID(t){const e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||gs,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||et,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:xD(t.inputs,e),outputs:xD(t.outputs),debugInfo:null}}function MD(t){t.features?.forEach(e=>e(t))}function Mg(t,e){if(!t)return null;const n=e?zn:n5;return()=>("function"==typeof t?t():t).map(i=>n(i)).filter(r5)}function DD(...t){return{\u0275providers:o0(0,t),\u0275fromNgModule:!0}}function o0(t,...e){const n=[],i=new Set;let r;const s=o=>{n.push(o)};return Ll(e,o=>{const a=o;Dg(a,s,[],i)&&(r||=[],r.push(a))}),void 0!==r&&RD(r,s),n}function RD(t,e){for(let n=0;n<t.length;n++){const{ngModule:i,providers:r}=t[n];a0(r,s=>{e(s,i)})}}function Dg(t,e,n,i){if(!(t=Ce(t)))return!1;let r=null,s=vg(t);const o=!s&&je(t);if(s||o){if(o&&!o.standalone)return!1;r=t}else{const c=t.ngModule;if(s=vg(c),!s)return!1;r=c}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const c="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of c)Dg(l,e,n,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;i.add(r);try{Ll(s.imports,u=>{Dg(u,e,n,i)&&(l||=[],l.push(u))})}finally{}void 0!==l&&RD(l,e)}if(!a){const l=sc(r)||(()=>new r);e({provide:r,useFactory:l,deps:et},r),e({provide:n0,useValue:r,multi:!0},r),e({provide:ir,useValue:()=>D(r),multi:!0},r)}const c=s.providers;if(null!=c&&!a){const l=t;a0(c,u=>{e(u,l)})}}}return r!==t&&void 0!==t.providers}function a0(t,e){for(let n of t)qb(n)&&(n=n.\u0275providers),Array.isArray(n)?a0(n,e):e(n)}const a5=yt({provide:String,useValue:yt});function c0(t){return null!==t&&"object"==typeof t&&a5 in t}function oc(t){return"function"==typeof t}const l0=new L(""),Rg={},l5={};let u0;function Og(){return void 0===u0&&(u0=new xg),u0}class oi{}class Bl extends oi{get destroyed(){return this._destroyed}constructor(e,n,i,r){super(),this.parent=n,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,h0(e,o=>this.processProvider(o)),this.records.set(Sg,kl(void 0,this)),r.has("environment")&&this.records.set(oi,kl(void 0,this));const s=this.records.get(l0);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(n0,et,We.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;const e=H(null);try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();const n=this._onDestroyHooks;this._onDestroyHooks=[];for(const i of n)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),H(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const n=ia(this),i=Oi(void 0);try{return e()}finally{ia(n),Oi(i)}}get(e,n=Yd,i=We.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(fD))return e[fD](this);i=wg(i);const s=ia(this),o=Oi(void 0);try{if(!(i&We.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function p5(t){return"function"==typeof t||"object"==typeof t&&t instanceof L}(e)&&yg(e);c=l&&this.injectableDefInScope(l)?kl(d0(e),Rg):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(i&We.Self?Og():this.parent).get(e,n=i&We.Optional&&n===Yd?null:n)}catch(a){if("NullInjectorError"===a.name){if((a[Eg]=a[Eg]||[]).unshift(wn(e)),s)throw a;return function k9(t,e,n,i){const r=t[Eg];throw e[mD]&&r.unshift(e[mD]),t.message=function U9(t,e,n,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let r=wn(e);if(Array.isArray(e))r=e.map(wn).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):wn(a)))}r=`{${s.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${t.replace(P9,"\n  ")}`}("\n"+t.message,r,n,i),t.ngTokenPath=r,t[Eg]=null,t}(a,e,"R3InjectorError",this.source)}throw a}finally{Oi(o),ia(s)}}resolveInjectorInitializers(){const e=H(null),n=ia(this),i=Oi(void 0);try{const s=this.get(ir,et,We.Self);for(const o of s)o()}finally{ia(n),Oi(i),H(e)}}toString(){const e=[],n=this.records;for(const i of n.keys())e.push(wn(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new $(205,!1)}processProvider(e){let n=oc(e=Ce(e))?e:Ce(e&&e.provide);const i=function d5(t){return c0(t)?kl(void 0,t.useValue):kl(ND(t),Rg)}(e);if(!oc(e)&&!0===e.multi){let r=this.records.get(n);r||(r=kl(void 0,Rg,!0),r.factory=()=>Qb(r.multi),this.records.set(n,r)),n=e,r.multi.push(e)}this.records.set(n,i)}hydrate(e,n){const i=H(null);try{return n.value===Rg&&(n.value=l5,n.value=n.factory()),"object"==typeof n.value&&n.value&&function f5(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{H(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;const n=Ce(e.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){const n=this._onDestroyHooks.indexOf(e);-1!==n&&this._onDestroyHooks.splice(n,1)}}function d0(t){const e=yg(t),n=null!==e?e.factory:sc(t);if(null!==n)return n;if(t instanceof L)throw new $(204,!1);if(t instanceof Function)return function u5(t){if(t.length>0)throw new $(204,!1);const n=function S9(t){return t&&(t[bg]||t[uD])||null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new $(204,!1)}function ND(t,e,n){let i;if(oc(t)){const r=Ce(t);return sc(r)||d0(r)}if(c0(t))i=()=>Ce(t.useValue);else if(function PD(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...Qb(t.deps||[]));else if(function OD(t){return!(!t||!t.useExisting)}(t))i=()=>D(Ce(t.useExisting));else{const r=Ce(t&&(t.useClass||t.provide));if(!function h5(t){return!!t.deps}(t))return sc(r)||d0(r);i=()=>new r(...Qb(t.deps))}return i}function kl(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function h0(t,e){for(const n of t)Array.isArray(n)?h0(n,e):n&&qb(n)?h0(n.\u0275providers,e):e(n)}function ms(t,e){t instanceof Bl&&t.assertNotDestroyed();const i=ia(t),r=Oi(void 0);try{return e()}finally{ia(i),Oi(r)}}function LD(){return void 0!==pD()||null!=function L9(){return Pl}()}function Qd(t){if(!LD())throw new $(-203,!1)}const Gt=0,X=1,me=2,cn=3,Yr=4,Gn=5,vi=6,Vl=7,Pt=8,ln=9,_s=10,Te=11,th=12,BD=13,jl=14,Wt=15,ac=16,Hl=17,mo=18,zl=19,kD=20,oa=21,Ng=22,Sr=23,ue=25,p0=1,ys=7,Gl=9,Qt=10;var Fg=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(Fg||{});function Tn(t){return Array.isArray(t)&&"object"==typeof t[p0]}function ai(t){return Array.isArray(t)&&!0===t[p0]}function g0(t){return!!(4&t.flags)}function cc(t){return t.componentOffset>-1}function Bg(t){return!(1&~t.flags)}function Kr(t){return!!t.template}function ih(t){return!!(512&t[me])}class zD{constructor(e,n,i){this.previousValue=e,this.currentValue=n,this.firstChange=i}isFirstChange(){return this.firstChange}}function GD(t,e,n,i){null!==e?e.applyValueToInputSignal(e,i):t[n]=i}function xr(){return WD}function WD(t){return t.type.prototype.ngOnChanges&&(t.setInput=x5),S5}function S5(){const t=qD(this),e=t?.current;if(e){const n=t.previous;if(n===gs)t.previous=e;else for(let i in e)n[i]=e[i];t.current=null,this.ngOnChanges(e)}}function x5(t,e,n,i,r){const s=this.declaredInputs[i],o=qD(t)||function I5(t,e){return t[$D]=e}(t,{previous:gs,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new zD(l&&l.currentValue,n,c===gs),GD(t,e,r,n)}xr.ngInherit=!0;const $D="__ngSimpleChanges__";function qD(t){return t[$D]||null}const vs=function(t,e,n){},XD="svg";function tt(t){for(;Array.isArray(t);)t=t[Gt];return t}function rh(t,e){return tt(e[t])}function bi(t,e){return tt(e[t.index])}function sh(t,e){return t.data[e]}function rr(t,e){const n=e[t];return Tn(n)?n:n[Gt]}function b0(t){return!(128&~t[me])}function Ir(t,e){return null==e?null:t[e]}function KD(t){t[Hl]=0}function JD(t){1024&t[me]||(t[me]|=1024,b0(t)&&kg(t))}function oh(t){return!!(9216&t[me]||t[Sr]?.dirty)}function E0(t){t[_s].changeDetectionScheduler?.notify(7),64&t[me]&&(t[me]|=1024),oh(t)&&kg(t)}function kg(t){t[_s].changeDetectionScheduler?.notify(0);let e=_o(t);for(;null!==e&&!(8192&e[me])&&(e[me]|=8192,b0(e));)e=_o(e)}function Ug(t,e){if(!(256&~t[me]))throw new $(911,!1);null===t[oa]&&(t[oa]=[]),t[oa].push(e)}function _o(t){const e=t[cn];return ai(e)?e[cn]:e}const Se={lFrame:d1(null),bindingsEnabled:!0,skipHydrationRootTNode:null};let QD=!1;function e1(){return Se.bindingsEnabled}function uc(){return null!==Se.skipHydrationRootTNode}function B(){return Se.lFrame.lView}function Be(){return Se.lFrame.tView}function bs(t){return Se.lFrame.contextLView=t,t[Pt]}function Es(t){return Se.lFrame.contextLView=null,t}function vt(){let t=t1();for(;null!==t&&64===t.type;)t=t.parent;return t}function t1(){return Se.lFrame.currentTNode}function Jr(t,e){const n=Se.lFrame;n.currentTNode=t,n.isParent=e}function C0(){return Se.lFrame.isParent}function T0(){Se.lFrame.isParent=!1}function s1(){return QD}function o1(t){QD=t}function Ei(){const t=Se.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function Zr(){return Se.lFrame.bindingIndex++}function vo(t){const e=Se.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function H5(t,e){const n=Se.lFrame;n.bindingIndex=n.bindingRootIndex=t,S0(e)}function S0(t){Se.lFrame.currentDirectiveIndex=t}function I0(){return Se.lFrame.currentQueryIndex}function jg(t){Se.lFrame.currentQueryIndex=t}function G5(t){const e=t[X];return 2===e.type?e.declTNode:1===e.type?t[Gn]:null}function l1(t,e,n){if(n&We.SkipSelf){let r=e,s=t;for(;!(r=r.parent,null!==r||n&We.Host||(r=G5(s),null===r||(s=s[jl],10&r.type))););if(null===r)return!1;e=r,t=s}const i=Se.lFrame=u1();return i.currentTNode=e,i.lView=t,!0}function M0(t){const e=u1(),n=t[X];Se.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function u1(){const t=Se.lFrame,e=null===t?null:t.child;return null===e?d1(t):e}function d1(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function h1(){const t=Se.lFrame;return Se.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const f1=h1;function D0(){const t=h1();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Wn(){return Se.lFrame.selectedIndex}function dc(t){Se.lFrame.selectedIndex=t}function Nt(){const t=Se.lFrame;return sh(t.tView,t.selectedIndex)}function R0(){Se.lFrame.currentNamespace=XD}let g1=!0;function ch(){return g1}function ws(t){g1=t}function Hg(t,e){for(let n=e.directiveStart,i=e.directiveEnd;n<i;n++){const s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),l&&((t.viewHooks??=[]).push(n,l),(t.viewCheckHooks??=[]).push(n,l)),null!=u&&(t.destroyHooks??=[]).push(n,u)}}function zg(t,e,n){m1(t,e,3,n)}function Gg(t,e,n,i){(3&t[me])===n&&m1(t,e,n,i)}function O0(t,e){let n=t[me];(3&n)===e&&(n&=16383,n+=1,t[me]=n)}function m1(t,e,n,i){const s=i??-1,o=e.length-1;let a=0;for(let c=void 0!==i?65535&t[Hl]:0;c<o;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=i&&a>=i)break}else e[c]<0&&(t[Hl]+=65536),(a<s||-1==s)&&(K5(t,n,e,c),t[Hl]=(4294901760&t[Hl])+c+2),c++}function _1(t,e){vs(4,t,e);const n=H(null);try{e.call(t)}finally{H(n),vs(5,t,e)}}function K5(t,e,n,i){const r=n[i]<0,s=n[i+1],a=t[r?-n[i]:n[i]];r?t[me]>>14<t[Hl]>>16&&(3&t[me])===e&&(t[me]+=16384,_1(a,s)):_1(a,s)}const Wl=-1;class lh{constructor(e,n,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=i}}const N0={};class hc{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,i){i=wg(i);const r=this.injector.get(e,N0,i);return r!==N0||n===N0?r:this.parentInjector.get(e,n,i)}}function L0(t){return t!==Wl}function uh(t){return 32767&t}function dh(t,e){let n=function eW(t){return t>>16}(t),i=e;for(;n>0;)i=i[jl],n--;return i}let F0=!0;function Wg(t){const e=F0;return F0=t,e}const v1=255,b1=5;let nW=0;const As={};function $g(t,e){const n=E1(t,e);if(-1!==n)return n;const i=e[X];i.firstCreatePass&&(t.injectorIndex=e.length,B0(i.data,t),B0(e,null),B0(i.blueprint,null));const r=qg(t,e),s=t.injectorIndex;if(L0(r)){const o=uh(r),a=dh(r,e),c=a[X].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=r,s}function B0(t,e){t.push(0,0,0,0,0,0,0,0,e)}function E1(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function qg(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,i=null,r=e;for(;null!==r;){if(i=I1(r),null===i)return Wl;if(n++,r=r[jl],-1!==i.injectorIndex)return i.injectorIndex|n<<16}return Wl}function k0(t,e,n){!function iW(t,e,n){let i;"string"==typeof n?i=n.charCodeAt(0)||0:n.hasOwnProperty(Xd)&&(i=n[Xd]),null==i&&(i=n[Xd]=nW++);const r=i&v1;e.data[t+(r>>b1)]|=1<<r}(t,e,n)}function w1(t,e,n){if(n&We.Optional||void 0!==t)return t;Kb()}function A1(t,e,n,i){if(n&We.Optional&&void 0===i&&(i=null),!(n&(We.Self|We.Host))){const r=t[ln],s=Oi(void 0);try{return r?r.get(e,i,n&We.Optional):gD(e,i,n&We.Optional)}finally{Oi(s)}}return w1(i,0,n)}function C1(t,e,n,i=We.Default,r){if(null!==t){if(2048&e[me]&&!(i&We.Self)){const o=function cW(t,e,n,i,r){let s=t,o=e;for(;null!==s&&null!==o&&2048&o[me]&&!(512&o[me]);){const a=T1(s,o,n,i|We.Self,As);if(a!==As)return a;let c=s.parent;if(!c){const l=o[kD];if(l){const u=l.get(n,As,i);if(u!==As)return u}c=I1(o),o=o[jl]}s=c}return r}(t,e,n,i,As);if(o!==As)return o}const s=T1(t,e,n,i,As);if(s!==As)return s}return A1(e,n,i,r)}function T1(t,e,n,i,r){const s=function oW(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(Xd)?t[Xd]:void 0;return"number"==typeof e?e>=0?e&v1:aW:e}(n);if("function"==typeof s){if(!l1(e,t,i))return i&We.Host?w1(r,0,i):A1(e,n,i,r);try{let o;if(o=s(i),null!=o||i&We.Optional)return o;Kb()}finally{f1()}}else if("number"==typeof s){let o=null,a=E1(t,e),c=Wl,l=i&We.Host?e[Wt][Gn]:null;for((-1===a||i&We.SkipSelf)&&(c=-1===a?qg(t,e):e[a+8],c!==Wl&&x1(i,!1)?(o=e[X],a=uh(c),e=dh(c,e)):a=-1);-1!==a;){const u=e[X];if(S1(s,a,u.data)){const d=sW(a,e,n,o,i,l);if(d!==As)return d}c=e[a+8],c!==Wl&&x1(i,e[X].data[a+8]===l)&&S1(s,a,e)?(o=u,a=uh(c),e=dh(c,e)):a=-1}}return r}function sW(t,e,n,i,r,s){const o=e[X],a=o.data[t+8],u=Xg(a,o,n,null==i?cc(a)&&F0:i!=o&&!!(3&a.type),r&We.Host&&s===a);return null!==u?fc(e,o,u,a):As}function Xg(t,e,n,i,r){const s=t.providerIndexes,o=e.data,a=1048575&s,c=t.directiveStart,u=s>>20,h=r?a+u:t.directiveEnd;for(let f=i?a:a+u;f<h;f++){const p=o[f];if(f<c&&n===p||f>=c&&p.type===n)return f}if(r){const f=o[c];if(f&&Kr(f)&&f.type===n)return c}return null}function fc(t,e,n,i){let r=t[n];const s=e.data;if(function J5(t){return t instanceof lh}(r)){const o=r;o.resolving&&function D9(t,e){throw e&&e.join(" > "),new $(-200,t)}(function ct(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Ie(t)}(s[n]));const a=Wg(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Oi(o.injectImpl):null;l1(t,i,We.Default);try{r=t[n]=o.factory(void 0,s,t,i),e.firstCreatePass&&n>=i.directiveStart&&function Y5(t,e,n){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=WD(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}r&&(n.preOrderHooks??=[]).push(0-t,r),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}(n,s[n],e)}finally{null!==l&&Oi(l),Wg(a),o.resolving=!1,f1()}}return r}function S1(t,e,n){return!!(n[e+(t>>b1)]&1<<t)}function x1(t,e){return!(t&We.Self||t&We.Host&&e)}class Sn{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,i){return C1(this._tNode,this._lView,e,wg(i),n)}}function aW(){return new Sn(vt(),B())}function Cs(t){return po(()=>{const e=t.prototype.constructor,n=e[go]||U0(e),i=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){const s=r[go]||U0(r);if(s&&s!==n)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function U0(t){return _g(t)?()=>{const e=U0(Ce(t));return e&&e()}:sc(t)}function I1(t){const e=t[X],n=e.type;return 2===n?e.declTNode:1===n?t[Gn]:null}function pc(t){return function rW(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const i=n.length;let r=0;for(;r<i;){const s=n[r];if(ED(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof n[r];)r++;else{if(s===e)return n[r+1];r+=2}}}return null}(vt(),t)}function P1(t,e=null,n=null,i){const r=function N1(t,e=null,n=null,i,r=new Set){const s=[n||et,DD(t)];return i=i||("object"==typeof t?void 0:wn(t)),new Bl(s,e||Og(),i||null,r)}(t,e,n,i);return r.resolveInjectorInitializers(),r}class lt{static#e=this.THROW_IF_NOT_FOUND=Yd;static#t=this.NULL=new xg;static create(e,n){if(Array.isArray(e))return P1({name:""},n,e,"");{const i=e.name??"";return P1({name:i},e.parent,e.providers,i)}}static#n=this.\u0275prov=V({token:lt,providedIn:"any",factory:()=>D(Sg)});static#i=this.__NG_ELEMENT_ID__=-1}new L("").__NG_ELEMENT_ID__=t=>{const e=vt();if(null===e)throw new $(204,!1);if(2&e.type)return e.value;if(t&We.Optional)return null;throw new $(204,!1)};function j0(t){return t.ngOriginalError}const F1=!0;let gc=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=yW;static#t=this.__NG_ENV_ID__=n=>n}return t})();class _W extends gc{constructor(e){super(),this._lView=e}onDestroy(e){return Ug(this._lView,e),()=>function w0(t,e){if(null===t[oa])return;const n=t[oa].indexOf(e);-1!==n&&t[oa].splice(n,1)}(this._lView,e)}}function yW(){return new _W(B())}let aa=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new on(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static#e=this.\u0275prov=V({token:t,providedIn:"root",factory:()=>new t})}return t})();const Pe=class vW extends de{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,LD()&&(this.destroyRef=O(gc,{optional:!0})??void 0,this.pendingTasks=O(aa,{optional:!0})??void 0)}emit(e){const n=H(null);try{super.next(e)}finally{H(n)}}subscribe(e,n,i){let r=e,s=n||(()=>null),o=i;if(e&&"object"==typeof e){const c=e;r=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),r&&(r=this.wrapInTimeout(r)),o&&(o=this.wrapInTimeout(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof bt&&e.add(a),a}wrapInTimeout(e){return n=>{const i=this.pendingTasks?.add();setTimeout(()=>{e(n),void 0!==i&&this.pendingTasks?.remove(i)})}}};function Kg(...t){}function B1(t){let e,n;function i(){t=Kg;try{void 0!==n&&"function"==typeof cancelAnimationFrame&&cancelAnimationFrame(n),void 0!==e&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{t(),i()}),"function"==typeof requestAnimationFrame&&(n=requestAnimationFrame(()=>{t(),i()})),()=>i()}function k1(t){return queueMicrotask(()=>t()),()=>{t=Kg}}const H0="isAngularZone",Jg=H0+"_ID";let bW=0;class _e{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Pe(!1),this.onMicrotaskEmpty=new Pe(!1),this.onStable=new Pe(!1),this.onError=new Pe(!1);const{enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:s=F1}=e;if(typeof Zone>"u")throw new $(908,!1);Zone.assertZonePatched();const o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&i,o.shouldCoalesceRunChangeDetection=r,o.callbackScheduled=!1,o.scheduleInRootZone=s,function AW(t){const e=()=>{!function wW(t){function e(){B1(()=>{t.callbackScheduled=!1,G0(t),t.isCheckStableRunning=!0,z0(t),t.isCheckStableRunning=!1})}t.isCheckStableRunning||t.callbackScheduled||(t.callbackScheduled=!0,t.scheduleInRootZone?Zone.root.run(()=>{e()}):t._outer.run(()=>{e()}),G0(t))}(t)},n=bW++;t._inner=t._inner.fork({name:"angular",properties:{[H0]:!0,[Jg]:n,[Jg+n]:!0},onInvokeTask:(i,r,s,o,a,c)=>{if(function CW(t){return j1(t,"__ignore_ng_zone__")}(c))return i.invokeTask(s,o,a,c);try{return U1(t),i.invokeTask(s,o,a,c)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||t.shouldCoalesceRunChangeDetection)&&e(),V1(t)}},onInvoke:(i,r,s,o,a,c,l)=>{try{return U1(t),i.invoke(s,o,a,c,l)}finally{t.shouldCoalesceRunChangeDetection&&!t.callbackScheduled&&!function TW(t){return j1(t,"__scheduler_tick__")}(c)&&e(),V1(t)}},onHasTask:(i,r,s,o)=>{i.hasTask(s,o),r===s&&("microTask"==o.change?(t._hasPendingMicrotasks=o.microTask,G0(t),z0(t)):"macroTask"==o.change&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(i,r,s,o)=>(i.handleError(s,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}(o)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get(H0)}static assertInAngularZone(){if(!_e.isInAngularZone())throw new $(909,!1)}static assertNotInAngularZone(){if(_e.isInAngularZone())throw new $(909,!1)}run(e,n,i){return this._inner.run(e,n,i)}runTask(e,n,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,EW,Kg,Kg);try{return s.runTask(o,n,i)}finally{s.cancelTask(o)}}runGuarded(e,n,i){return this._inner.runGuarded(e,n,i)}runOutsideAngular(e){return this._outer.run(e)}}const EW={};function z0(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function G0(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&!0===t.callbackScheduled)}function U1(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function V1(t){t._nesting--,z0(t)}class W0{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Pe,this.onMicrotaskEmpty=new Pe,this.onStable=new Pe,this.onError=new Pe}run(e,n,i){return e.apply(n,i)}runGuarded(e,n,i){return e.apply(n,i)}runOutsideAngular(e){return e()}runTask(e,n,i,r){return e.apply(n,i)}}function j1(t,e){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0]?.data?.[e]}class Ni{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&j0(e);for(;n&&j0(n);)n=j0(n);return n||null}}const xW=new L("",{providedIn:"root",factory:()=>{const t=O(_e),e=O(Ni);return n=>t.runOutsideAngular(()=>e.handleError(n))}});function MW(){return Xl(vt(),B())}function Xl(t,e){return new en(bi(t,e))}let en=(()=>{class t{constructor(n){this.nativeElement=n}static#e=this.__NG_ELEMENT_ID__=MW}return t})();function z1(t){return t instanceof en?t.nativeElement:t}function DW(){return this._results[Symbol.iterator]()}class Yl{static#e=Symbol.iterator;get changes(){return this._changes??=new Pe}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const n=Yl.prototype;n[Symbol.iterator]||(n[Symbol.iterator]=DW)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,n){return this._results.reduce(e,n)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,n){this.dirty=!1;const i=function Pi(t){return t.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function z9(t,e,n){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],s=e[i];if(n&&(r=n(r),s=n(s)),s!==r)return!1}return!0}(this._results,i,n))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}function fh(t){return!(128&~t.flags)}const q0=new Map;let OW=0;const Zg="__ngContext__";function ci(t,e){Tn(e)?(t[Zg]=e[zl],function NW(t){q0.set(t[zl],t)}(e)):t[Zg]=e}function Q1(t){return tR(t[th])}function eR(t){return tR(t[Yr])}function tR(t){for(;null!==t&&!ai(t);)t=t[Yr];return t}let Y0;const Jl=new L("",{providedIn:"root",factory:()=>ZW}),ZW="ng",lR=new L(""),Mr=new L("",{providedIn:"platform",factory:()=>"unknown"}),gh=new L(""),K0=new L("",{providedIn:"root",factory:()=>function ca(){if(void 0!==Y0)return Y0;if(typeof document<"u")return document;throw new $(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let uR=()=>null;function iE(t,e,n=!1){return uR(t,e,n)}const yR=new L("",{providedIn:"root",factory:()=>!1});let am;function eu(t){return function cE(){if(void 0===am&&(am=null,Et.trustedTypes))try{am=Et.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return am}()?.createHTML(t)||t}class _c{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${sD})`}}class h$ extends _c{getTypeName(){return"HTML"}}class f$ extends _c{getTypeName(){return"Style"}}class p$ extends _c{getTypeName(){return"Script"}}class g$ extends _c{getTypeName(){return"URL"}}class m$ extends _c{getTypeName(){return"ResourceURL"}}function sr(t){return t instanceof _c?t.changingThisBreaksApplicationSecurity:t}function Ts(t,e){const n=function _$(t){return t instanceof _c&&t.getTypeName()||null}(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${sD})`)}return n===e}class A${constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const n=(new window.DOMParser).parseFromString(eu(e),"text/html").body;return null===n?this.inertDocumentHelper.getInertBodyElement(e):(n.firstChild?.remove(),n)}catch{return null}}}class C${constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const n=this.inertDocument.createElement("template");return n.innerHTML=eu(e),n}}const S$=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function lm(t){return(t=String(t)).match(S$)?t:"unsafe:"+t}function bo(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function Eh(...t){const e={};for(const n of t)for(const i in n)n.hasOwnProperty(i)&&(e[i]=!0);return e}const TR=bo("area,br,col,hr,img,wbr"),SR=bo("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),xR=bo("rp,rt"),uE=Eh(TR,Eh(SR,bo("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Eh(xR,bo("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Eh(xR,SR)),dE=bo("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),IR=Eh(dE,bo("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),bo("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),x$=bo("script,style,template");class I${constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let n=e.firstChild,i=!0,r=[];for(;n;)if(n.nodeType===Node.ELEMENT_NODE?i=this.startElement(n):n.nodeType===Node.TEXT_NODE?this.chars(n.nodeValue):this.sanitizedSomething=!0,i&&n.firstChild)r.push(n),n=R$(n);else for(;n;){n.nodeType===Node.ELEMENT_NODE&&this.endElement(n);let s=D$(n);if(s){n=s;break}n=r.pop()}return this.buf.join("")}startElement(e){const n=MR(e).toLowerCase();if(!uE.hasOwnProperty(n))return this.sanitizedSomething=!0,!x$.hasOwnProperty(n);this.buf.push("<"),this.buf.push(n);const i=e.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),o=s.name,a=o.toLowerCase();if(!IR.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=s.value;dE[a]&&(c=lm(c)),this.buf.push(" ",o,'="',RR(c),'"')}return this.buf.push(">"),!0}endElement(e){const n=MR(e).toLowerCase();uE.hasOwnProperty(n)&&!TR.hasOwnProperty(n)&&(this.buf.push("</"),this.buf.push(n),this.buf.push(">"))}chars(e){this.buf.push(RR(e))}}function D$(t){const e=t.nextSibling;if(e&&t!==e.previousSibling)throw DR(e);return e}function R$(t){const e=t.firstChild;if(e&&function M$(t,e){return(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}(t,e))throw DR(e);return e}function MR(t){const e=t.nodeName;return"string"==typeof e?e:"FORM"}function DR(t){return new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`)}const O$=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,P$=/([^\#-~ |!])/g;function RR(t){return t.replace(/&/g,"&amp;").replace(O$,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(P$,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let um;function OR(t,e){let n=null;try{um=um||function CR(t){const e=new C$(t);return function T$(){try{return!!(new window.DOMParser).parseFromString(eu(""),"text/html")}catch{return!1}}()?new A$(e):e}(t);let i=e?String(e):"";n=um.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=n.innerHTML,n=um.getInertBodyElement(i)}while(i!==s);return eu((new I$).sanitizeChildren(hE(n)||n))}finally{if(n){const i=hE(n)||n;for(;i.firstChild;)i.firstChild.remove()}}}function hE(t){return"content"in t&&function N$(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var $n=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}($n||{});function fE(t){const e=function wh(){const t=B();return t&&t[_s].sanitizer}();return e?e.sanitize($n.URL,t)||"":Ts(t,"URL")?sr(t):lm(Ie(t))}function Fi(t){return"browser"===(t??O(lt)).get(Mr)}var la=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(la||{});let mE;function _E(t,e){return mE(t,e)}function nu(t,e,n,i,r){if(null!=i){let s,o=!1;ai(i)?s=i:Tn(i)&&(o=!0,i=i[Gt]);const a=tt(i);0===t&&null!==n?null==r?qR(e,n,a):yc(e,n,a,r||null,!0):1===t&&null!==n?yc(e,n,a,r||null,!0):2===t?function Ch(t,e,n){t.removeChild(null,e,n)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function uq(t,e,n,i,r){const s=n[ys];s!==tt(n)&&nu(e,t,i,s,r);for(let a=Qt;a<n.length;a++){const c=n[a];mm(c[X],c,t,e,i,s)}}(e,t,s,n,r)}}function fm(t,e,n){return t.createElement(e,n)}function GR(t,e){e[_s].changeDetectionScheduler?.notify(8),mm(t,e,e[Te],2,null,null)}function WR(t,e){const n=t[Gl],i=e[cn];(Tn(i)||e[Wt]!==i[cn][Wt])&&(t[me]|=Fg.HasTransplantedViews),null===n?t[Gl]=[e]:n.push(e)}function bE(t,e){const n=t[Gl],i=n.indexOf(e);n.splice(i,1)}function Ah(t,e){if(t.length<=Qt)return;const n=Qt+e,i=t[n];if(i){const r=i[ac];null!==r&&r!==t&&bE(r,i),e>0&&(t[n-1][Yr]=i[Yr]);const s=Cg(t,Qt+e);!function nq(t,e){GR(t,e),e[Gt]=null,e[Gn]=null}(i[X],i);const o=s[mo];null!==o&&o.detachView(s[X]),i[cn]=null,i[Yr]=null,i[me]&=-129}return i}function pm(t,e){if(!(256&e[me])){const n=e[Te];n.destroyNode&&mm(t,e,n,3,null,null),function rq(t){let e=t[th];if(!e)return EE(t[X],t);for(;e;){let n=null;if(Tn(e))n=e[th];else{const i=e[Qt];i&&(n=i)}if(!n){for(;e&&!e[Yr]&&e!==t;)Tn(e)&&EE(e[X],e),e=e[cn];null===e&&(e=t),Tn(e)&&EE(e[X],e),n=e&&e[Yr]}e=n}}(e)}}function EE(t,e){if(256&e[me])return;const n=H(null);try{e[me]&=-129,e[me]|=256,e[Sr]&&we(e[Sr]),function aq(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let i=0;i<n.length;i+=2){const r=e[n[i]];if(!(r instanceof lh)){const s=n[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],c=s[o+1];vs(4,a,c);try{c.call(a)}finally{vs(5,a,c)}}else{vs(4,r,s);try{s.call(r)}finally{vs(5,r,s)}}}}}(t,e),function oq(t,e){const n=t.cleanup,i=e[Vl];if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const o=n[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else n[s].call(i[n[s+1]]);null!==i&&(e[Vl]=null);const r=e[oa];if(null!==r){e[oa]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(t,e),1===e[X].type&&e[Te].destroy();const i=e[ac];if(null!==i&&ai(e[cn])){i!==e[cn]&&bE(i,e);const r=e[mo];null!==r&&r.detachView(t)}!function LW(t){q0.delete(t[zl])}(e)}finally{H(n)}}function wE(t,e,n){return function $R(t,e,n){let i=e;for(;null!==i&&168&i.type;)i=(e=i).parent;if(null===i)return n[Gt];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=t.data[i.directiveStart+r];if(s===qr.None||s===qr.Emulated)return null}return bi(i,n)}}(t,e.parent,n)}function yc(t,e,n,i,r){t.insertBefore(e,n,i,r)}function qR(t,e,n){t.appendChild(e,n)}function XR(t,e,n,i,r){null!==i?yc(t,e,n,i,r):qR(t,e,n)}function AE(t,e){return t.parentNode(e)}function YR(t,e,n){return JR(t,e,n)}let CE,JR=function KR(t,e,n){return 40&t.type?bi(t,n):null};function gm(t,e,n,i){const r=wE(t,i,e),s=e[Te],a=YR(i.parent||e[Gn],i,e);if(null!=r)if(Array.isArray(n))for(let c=0;c<n.length;c++)XR(s,r,n[c],a,!1);else XR(s,r,n,a,!1);void 0!==CE&&CE(s,i,e,n,r)}function vc(t,e){if(null!==e){const n=e.type;if(3&n)return bi(e,t);if(4&n)return TE(-1,t[e.index]);if(8&n){const i=e.child;if(null!==i)return vc(t,i);{const r=t[e.index];return ai(r)?TE(-1,r):tt(r)}}if(128&n)return vc(t,e.next);if(32&n)return _E(e,t)()||tt(t[e.index]);{const i=QR(t,e);return null!==i?Array.isArray(i)?i[0]:vc(_o(t[Wt]),i):vc(t,e.next)}}return null}function QR(t,e){return null!==e?t[Wt][Gn].projection[e.projection]:null}function TE(t,e){const n=Qt+t+1;if(n<e.length){const i=e[n],r=i[X].firstChild;if(null!==r)return vc(i,r)}return e[ys]}function SE(t,e,n,i,r,s,o){for(;null!=n;){if(128===n.type){n=n.next;continue}const a=i[n.index],c=n.type;if(o&&0===e&&(a&&ci(tt(a),i),n.flags|=2),32&~n.flags)if(8&c)SE(t,e,n.child,i,r,s,!1),nu(e,t,r,a,s);else if(32&c){const l=_E(n,i);let u;for(;u=l();)nu(e,t,r,u,s);nu(e,t,r,a,s)}else 16&c?tO(t,e,i,n,r,s):nu(e,t,r,a,s);n=o?n.projectionNext:n.next}}function mm(t,e,n,i,r,s){SE(n,i,t.firstChild,e,r,s,!1)}function tO(t,e,n,i,r,s){const o=n[Wt],c=o[Gn].projection[i.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)nu(e,t,r,c[l],s);else{let l=c;const u=o[cn];fh(i)&&(l.flags|=128),SE(t,e,l,u,r,s,!0)}}function nO(t,e,n){""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function iO(t,e,n){const{mergedAttrs:i,classes:r,styles:s}=n;null!==i&&r0(t,e,i),null!==r&&nO(t,e,r),null!==s&&function hq(t,e,n){t.setAttribute(e,"style",n)}(t,e,s)}const Me={};function qn(t=1){rO(Be(),B(),Wn()+t,!1)}function rO(t,e,n,i){if(!i)if(3&~e[me]){const s=t.preOrderHooks;null!==s&&Gg(e,s,0,n)}else{const s=t.preOrderCheckHooks;null!==s&&zg(e,s,n)}dc(n)}function j(t,e=We.Default){const n=B();return null===n?D(t,e):C1(vt(),n,Ce(t),e)}function oO(t,e,n,i,r,s){const o=H(null);try{let a=null;r&ra.SignalBased&&(a=e[i][K]),null!==a&&void 0!==a.transformFn&&(s=a.transformFn(s)),r&ra.HasDecoratorInputTransform&&(s=t.inputTransforms[i].call(e,s)),null!==t.setInput?t.setInput(e,a,s,n,i):GD(e,a,i,s)}finally{H(o)}}function _m(t,e,n,i,r,s,o,a,c,l,u){const d=e.blueprint.slice();return d[Gt]=r,d[me]=204|i,(null!==l||t&&2048&t[me])&&(d[me]|=2048),KD(d),d[cn]=d[jl]=t,d[Pt]=n,d[_s]=o||t&&t[_s],d[Te]=a||t&&t[Te],d[ln]=c||t&&t[ln]||null,d[Gn]=s,d[zl]=function PW(){return OW++}(),d[vi]=u,d[kD]=l,d[Wt]=2==e.type?t[Wt]:d,d}function bc(t,e,n,i,r){let s=t.data[e];if(null===s)s=function xE(t,e,n,i,r){const s=t1(),o=C0(),c=t.data[e]=function bq(t,e,n,i,r,s){let o=e?e.injectorIndex:-1,a=0;return uc()&&(a|=128),{type:n,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,e,i,r);return null===t.firstChild&&(t.firstChild=c),null!==s&&(o?null==s.child&&null!==c.parent&&(s.child=c):null===s.next&&(s.next=c,c.prev=s)),c}(t,e,n,i,r),function j5(){return Se.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=n,s.value=i,s.attrs=r;const o=function ah(){const t=Se.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Jr(s,!0),s}function Th(t,e,n,i){if(0===n)return-1;const r=e.length;for(let s=0;s<n;s++)e.push(i),t.blueprint.push(i),t.data.push(null);return r}function aO(t,e,n,i,r){const s=Wn(),o=2&i;try{dc(-1),o&&e.length>ue&&rO(t,e,ue,!1),vs(o?2:0,r),n(i,r)}finally{dc(s),vs(o?3:1,r)}}function IE(t,e,n){if(g0(e)){const i=H(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}finally{H(i)}}}function ME(t,e,n){e1()&&(function xq(t,e,n,i){const r=n.directiveStart,s=n.directiveEnd;cc(n)&&function Nq(t,e,n){const i=bi(e,t),r=cO(n);let o=16;n.signals?o=4096:n.onPush&&(o=64);const a=ym(t,_m(t,r,null,o,i,e,null,t[_s].rendererFactory.createRenderer(i,n),null,null,null));t[e.index]=a}(e,n,t.data[r+n.componentOffset]),t.firstCreatePass||$g(n,e),ci(i,e);const o=n.initialInputs;for(let a=r;a<s;a++){const c=t.data[a],l=fc(e,t,a,n);ci(l,e),null!==o&&Lq(0,a-r,l,c,0,o),Kr(c)&&(rr(n.index,e)[Pt]=fc(e,t,a,n))}}(t,e,n,bi(n,e)),!(64&~n.flags)&&fO(t,e,n))}function DE(t,e,n=bi){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?n(e,t):t[o];t[r++]=a}}}function cO(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=RE(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function RE(t,e,n,i,r,s,o,a,c,l,u){const d=ue+i,h=d+r,f=function pq(t,e){const n=[];for(let i=0;i<e;i++)n.push(i<t?null:Me);return n}(d,h),p="function"==typeof l?l():l;return f[X]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}let lO=()=>null;function uO(t,e,n,i,r){for(let s in e){if(!e.hasOwnProperty(s))continue;const o=e[s];if(void 0===o)continue;i??={};let a,c=ra.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(null!==r){if(!r.hasOwnProperty(s))continue;l=r[s]}0===t?dO(i,n,l,a,c):dO(i,n,l,a)}return i}function dO(t,e,n,i,r){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,i):s=t[n]=[e,i],void 0!==r&&s.push(r)}function Bi(t,e,n,i,r,s,o,a){const c=bi(e,n);let u,l=e.inputs;!a&&null!=l&&(u=l[i])?(FE(t,n,u,i,r),cc(e)&&function Aq(t,e){const n=rr(e,t);16&n[me]||(n[me]|=64)}(n,e.index)):3&e.type&&(i=function wq(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(c,i,r))}function OE(t,e,n,i){if(e1()){const r=null===i?null:{"":-1},s=function Mq(t,e){const n=t.directiveRegistry;let i=null,r=null;if(n)for(let s=0;s<n.length;s++){const o=n[s];if(TD(e,o.selectors,!1))if(i||(i=[]),Kr(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),PE(t,e,a.length)}else i.unshift(o),PE(t,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(t,n);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&hO(t,e,n,o,r,a),r&&function Dq(t,e,n){if(e){const i=t.localNames=[];for(let r=0;r<e.length;r+=2){const s=n[e[r+1]];if(null==s)throw new $(-301,!1);i.push(e[r],s)}}}(n,i,r)}n.mergedAttrs=Jd(n.mergedAttrs,n.attrs)}function hO(t,e,n,i,r,s){for(let l=0;l<i.length;l++)k0($g(n,e),t,i[l].type);!function Oq(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}(n,t.data.length,i.length);for(let l=0;l<i.length;l++){const u=i[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=Th(t,e,i.length,null);for(let l=0;l<i.length;l++){const u=i[l];n.mergedAttrs=Jd(n.mergedAttrs,u.hostAttrs),Pq(t,n,e,c,u),Rq(c,u,r),null!==u.contentQueries&&(n.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(n.flags|=64);const d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}!function Eq(t,e,n){const r=e.directiveEnd,s=t.data,o=e.attrs,a=[];let c=null,l=null;for(let u=e.directiveStart;u<r;u++){const d=s[u],h=n?n.get(d):null,p=h?h.outputs:null;c=uO(0,d.inputs,u,c,h?h.inputs:null),l=uO(1,d.outputs,u,l,p);const g=null===c||null===o||s0(e)?null:Fq(c,u,o);a.push(g)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(t,n,s)}function fO(t,e,n){const i=n.directiveStart,r=n.directiveEnd,s=n.index,o=function z5(){return Se.lFrame.currentDirectiveIndex}();try{dc(s);for(let a=i;a<r;a++){const c=t.data[a],l=e[a];S0(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&Iq(c,l)}}finally{dc(-1),S0(o)}}function Iq(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function PE(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function Rq(t,e,n){if(n){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)n[e.exportAs[i]]=t;Kr(e)&&(n[""]=t)}}function Pq(t,e,n,i,r){t.data[i]=r;const s=r.factory||(r.factory=sc(r.type)),o=new lh(s,Kr(r),j);t.blueprint[i]=o,n[i]=o,function Tq(t,e,n,i,r){const s=r.hostBindings;if(s){let o=t.hostBindingOpCodes;null===o&&(o=t.hostBindingOpCodes=[]);const a=~e.index;(function Sq(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(o)!=a&&o.push(a),o.push(n,i,s)}}(t,e,i,Th(t,n,r.hostVars,Me),r)}function Ss(t,e,n,i,r,s){const o=bi(t,e);!function NE(t,e,n,i,r,s,o){if(null==s)t.removeAttribute(e,r,n);else{const a=null==o?Ie(s):o(s,i||"",r);t.setAttribute(e,r,a,n)}}(e[Te],o,s,t.value,n,i,r)}function Lq(t,e,n,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)oO(i,n,o[a++],o[a++],o[a++],o[a++])}function Fq(t,e,n){let i=null,r=0;for(;r<n.length;){const s=n[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(t.hasOwnProperty(s)){null===i&&(i=[]);const o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){i.push(s,o[a+1],o[a+2],n[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function pO(t,e,n,i){return[t,!0,0,e,null,i,null,n,null,null]}function gO(t,e){const n=t.contentQueries;if(null!==n){const i=H(null);try{for(let r=0;r<n.length;r+=2){const o=n[r+1];if(-1!==o){const a=t.data[o];jg(n[r]),a.contentQueries(2,e[o],o)}}}finally{H(i)}}}function ym(t,e){return t[th]?t[BD][Yr]=e:t[th]=e,t[BD]=e,e}function LE(t,e,n){jg(0);const i=H(null);try{e(t,n)}finally{H(i)}}function mO(t){return t[Vl]??=[]}function _O(t){return t.cleanup??=[]}function vm(t,e){const n=t[ln],i=n?n.get(Ni,null):null;i&&i.handleError(e)}function FE(t,e,n,i,r){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],c=n[s++];oO(t.data[o],e[o],i,a,c,r)}}function Bq(t,e){const n=rr(e,t),i=n[X];!function kq(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(i,n);const r=n[Gt];null!==r&&null===n[vi]&&(n[vi]=iE(r,n[ln])),BE(i,n,n[Pt])}function BE(t,e,n){M0(e);try{const i=t.viewQuery;null!==i&&LE(1,i,n);const r=t.template;null!==r&&aO(t,e,r,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[mo]?.finishViewCreation(t),t.staticContentQueries&&gO(t,e),t.staticViewQueries&&LE(2,t.viewQuery,n);const s=t.components;null!==s&&function Uq(t,e){for(let n=0;n<e.length;n++)Bq(t,e[n])}(e,s)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{e[me]&=-5,D0()}}function iu(t,e,n,i){const r=H(null);try{const s=e.tView,c=_m(t,s,n,4096&t[me]?4096:16,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null);c[ac]=t[e.index];const u=t[mo];return null!==u&&(c[mo]=u.createEmbeddedView(s)),BE(s,c,n),c}finally{H(r)}}function Ec(t,e){return!e||null===e.firstChild||fh(t)}function ru(t,e,n,i=!0){const r=e[X];if(function sq(t,e,n,i){const r=Qt+i,s=n.length;i>0&&(n[r-1][Yr]=e),i<s-Qt?(e[Yr]=n[r],yD(n,Qt+i,e)):(n.push(e),e[Yr]=null),e[cn]=n;const o=e[ac];null!==o&&n!==o&&WR(o,e);const a=e[mo];null!==a&&a.insertView(t),E0(e),e[me]|=128}(r,e,t,n),i){const o=TE(n,t),a=e[Te],c=AE(a,t[ys]);null!==c&&function iq(t,e,n,i,r,s){i[Gt]=r,i[Gn]=e,mm(t,i,n,1,r,s)}(r,t[Gn],a,e,c,o)}const s=e[vi];null!==s&&null!==s.firstChild&&(s.firstChild=null)}function Sh(t,e,n,i,r=!1){for(;null!==n;){if(128===n.type){n=r?n.projectionNext:n.next;continue}const s=e[n.index];null!==s&&i.push(tt(s)),ai(s)&&bO(s,i);const o=n.type;if(8&o)Sh(t,e,n.child,i);else if(32&o){const a=_E(n,e);let c;for(;c=a();)i.push(c)}else if(16&o){const a=QR(e,n);if(Array.isArray(a))i.push(...a);else{const c=_o(e[Wt]);Sh(c[X],c,a,i,!0)}}n=r?n.projectionNext:n.next}return i}function bO(t,e){for(let n=Qt;n<t.length;n++){const i=t[n],r=i[X].firstChild;null!==r&&Sh(i[X],i,r,e)}t[ys]!==t[Gt]&&e.push(t[ys])}let EO=[];const zq={...ft,consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{kg(t.lView)},consumerOnSignalRead(){this.lView[Sr]=this}},Wq={...ft,consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{let e=_o(t.lView);for(;e&&!wO(e[X]);)e=_o(e);e&&JD(e)},consumerOnSignalRead(){this.lView[Sr]=this}};function wO(t){return 2!==t.type}const $q=100;function bm(t,e=!0,n=0){const i=t[_s],r=i.rendererFactory;r.begin?.();try{!function qq(t,e){const n=s1();try{o1(!0),UE(t,e);let i=0;for(;oh(t);){if(i===$q)throw new $(103,!1);i++,UE(t,1)}}finally{o1(n)}}(t,n)}catch(o){throw e&&vm(t,o),o}finally{r.end?.(),i.inlineEffectRunner?.flush()}}function Xq(t,e,n,i){const r=e[me];if(!(256&~r))return;e[_s].inlineEffectRunner?.flush(),M0(e);let a=!0,c=null,l=null;wO(t)?(l=function Vq(t){return t[Sr]??function jq(t){const e=EO.pop()??Object.create(zq);return e.lView=t,e}(t)}(e),c=yi(l)):null===function Ue(){return ve}()?(a=!1,l=function Gq(t){const e=t[Sr]??Object.create(Wq);return e.lView=t,e}(e),c=yi(l)):e[Sr]&&(we(e[Sr]),e[Sr]=null);try{KD(e),function a1(t){return Se.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&aO(t,e,n,2,i);const u=!(3&~r);if(u){const f=t.preOrderCheckHooks;null!==f&&zg(e,f,null)}else{const f=t.preOrderHooks;null!==f&&Gg(e,f,0,null),O0(e,0)}if(function Yq(t){for(let e=Q1(t);null!==e;e=eR(e)){if(!(e[me]&Fg.HasTransplantedViews))continue;const n=e[Gl];for(let i=0;i<n.length;i++)JD(n[i])}}(e),CO(e,0),null!==t.contentQueries&&gO(t,e),u){const f=t.contentCheckHooks;null!==f&&zg(e,f)}else{const f=t.contentHooks;null!==f&&Gg(e,f,1),O0(e,1)}!function fq(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let i=0;i<n.length;i++){const r=n[i];if(r<0)dc(~r);else{const s=r,o=n[++i],a=n[++i];H5(o,s),a(2,e[s])}}}finally{dc(-1)}}(t,e);const d=t.components;null!==d&&SO(e,d,0);const h=t.viewQuery;if(null!==h&&LE(2,h,i),u){const f=t.viewCheckHooks;null!==f&&zg(e,f)}else{const f=t.viewHooks;null!==f&&Gg(e,f,2),O0(e,2)}if(!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),e[Ng]){for(const f of e[Ng])f();e[Ng]=null}e[me]&=-73}catch(u){throw kg(e),u}finally{null!==l&&(Y(l,c),a&&function Hq(t){t.lView[Sr]!==t&&(t.lView=null,EO.push(t))}(l)),D0()}}function CO(t,e){for(let n=Q1(t);null!==n;n=eR(n))for(let i=Qt;i<n.length;i++)TO(n[i],e)}function Kq(t,e,n){TO(rr(e,t),n)}function TO(t,e){b0(t)&&UE(t,e)}function UE(t,e){const i=t[X],r=t[me],s=t[Sr];let o=!!(0===e&&16&r);if(o||=!!(64&r&&0===e),o||=!!(1024&r),o||=!(!s?.dirty||!J(s)),o||=!1,s&&(s.dirty=!1),t[me]&=-9217,o)Xq(i,t,i.template,t[Pt]);else if(8192&r){CO(t,1);const a=i.components;null!==a&&SO(t,a,1)}}function SO(t,e,n){for(let i=0;i<e.length;i++)Kq(t,e[i],n)}function xh(t,e){const n=s1()?64:1088;for(t[_s].changeDetectionScheduler?.notify(e);t;){t[me]|=n;const i=_o(t);if(ih(t)&&!i)return t;t=i}return null}class Ih{get rootNodes(){const e=this._lView,n=e[X];return Sh(n,e,n.firstChild,[])}constructor(e,n,i=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Pt]}set context(e){this._lView[Pt]=e}get destroyed(){return!(256&~this._lView[me])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[cn];if(ai(e)){const n=e[8],i=n?n.indexOf(this):-1;i>-1&&(Ah(e,i),Cg(n,i))}this._attachedToViewContainer=!1}pm(this._lView[X],this._lView)}onDestroy(e){Ug(this._lView,e)}markForCheck(){xh(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[me]&=-129}reattach(){E0(this._lView),this._lView[me]|=128}detectChanges(){this._lView[me]|=1024,bm(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new $(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const e=ih(this._lView),n=this._lView[ac];null!==n&&!e&&bE(n,this._lView),GR(this._lView[X],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new $(902,!1);this._appRef=e;const n=ih(this._lView),i=this._lView[ac];null!==i&&!n&&WR(i,this._lView),E0(this._lView)}}let Qr=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=Qq}return t})();const Jq=Qr,Zq=class extends Jq{constructor(e,n,i){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,i){const r=iu(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:n,dehydratedView:i});return new Ih(r)}};function Qq(){return Em(vt(),B())}function Em(t,e){return 4&t.type?new Zq(e,t,Xl(t,e)):null}let qO=()=>null;function Ac(t,e){return qO(t,e)}class ou{}const Fh=new L("",{providedIn:"root",factory:()=>!1}),XO=new L(""),KE=new L("");class WX{}class YO{}class qX{resolveComponentFactory(e){throw function $X(t){const e=Error(`No component factory found for ${wn(t)}.`);return e.ngComponent=t,e}(e)}}class ua{static#e=this.NULL=new qX}class JE{}let YX=(()=>{class t{static#e=this.\u0275prov=V({token:t,providedIn:"root",factory:()=>null})}return t})();const JO=new Set;function wi(t){JO.has(t)||(JO.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}var Ai=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(Ai||{});const ZO={destroy(){}};function Im(t,e){!e&&Qd();const n=e?.injector??O(lt);return Fi(n)?(wi("NgAfterNextRender"),eP(t,n,!0,e?.phase??Ai.MixedReadWrite)):ZO}function eP(t,e,n,i){const r=function KX(t,e){if(t instanceof Function)switch(e){case Ai.EarlyRead:return{earlyRead:t};case Ai.Write:return{write:t};case Ai.MixedReadWrite:return{mixedReadWrite:t};case Ai.Read:return{read:t}}return t}(t,i),s=e.get(Mm),o=s.handler??=new ZX,a=[],c=[],l=()=>{for(const f of c)o.unregister(f);u()},u=e.get(gc).onDestroy(l);let d=0;const h=(f,p)=>{if(!p)return;const g=n?(...y)=>(d--,d<1&&l(),p(...y)):p,m=ms(e,()=>new JX(f,a,g));o.register(m),c.push(m),d++};return h(Ai.EarlyRead,r.earlyRead),h(Ai.Write,r.write),h(Ai.MixedReadWrite,r.mixedReadWrite),h(Ai.Read,r.read),{destroy:l}}class JX{constructor(e,n,i){this.phase=e,this.pipelinedArgs=n,this.callbackFn=i,this.zone=O(_e),this.errorHandler=O(Ni,{optional:!0}),O(ou,{optional:!0})?.notify(6)}invoke(){try{const e=this.zone.runOutsideAngular(()=>this.callbackFn.apply(null,this.pipelinedArgs));this.pipelinedArgs.splice(0,this.pipelinedArgs.length,e)}catch(e){this.errorHandler?.handleError(e)}}}class ZX{constructor(){this.executingCallbacks=!1,this.buckets={[Ai.EarlyRead]:new Set,[Ai.Write]:new Set,[Ai.MixedReadWrite]:new Set,[Ai.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(const e of Object.values(this.buckets))for(const n of e)n.invoke();this.executingCallbacks=!1;for(const e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(const e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}}let Mm=(()=>{class t{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){const n=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const i of n)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#e=this.\u0275prov=V({token:t,providedIn:"root",factory:()=>new t})}return t})();function Rm(t,e,n){let i=n?t.styles:null,r=n?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=Vb(r,a):2==s&&(i=Vb(i,a+": "+e[++o]+";"))}n?t.styles=i:t.stylesWithoutHost=i,n?t.classes=r:t.classesWithoutHost=r}class iP extends ua{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=je(e);return new Uh(n,this.ngModule)}}function rP(t,e){const n=[];for(const i in t){if(!t.hasOwnProperty(i))continue;const r=t[i];if(void 0===r)continue;const s=Array.isArray(r),o=s?r[0]:r;n.push(e?{propName:o,templateName:i,isSignal:!!((s?r[1]:ra.None)&ra.SignalBased)}:{propName:o,templateName:i})}return n}class Uh extends YO{get inputs(){const e=this.componentDef,n=e.inputTransforms,i=rP(e.inputs,!0);if(null!==n)for(const r of i)n.hasOwnProperty(r.propName)&&(r.transform=n[r.propName]);return i}get outputs(){return rP(this.componentDef.outputs,!1)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function e5(t){return t.map(Q9).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,i,r){const s=H(null);try{let o=(r=r||this.ngModule)instanceof oi?r:r?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const a=o?new hc(e,o):e,c=a.get(JE,null);if(null===c)throw new $(407,!1);const l=a.get(YX,null),h={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:a.get(Mm,null),changeDetectionScheduler:a.get(ou,null)},f=c.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",g=i?function gq(t,e,n,i){const s=i.get(yR,!1)||n===qr.ShadowDom,o=t.selectRootElement(e,s);return function mq(t){lO(t)}(o),o}(f,i,this.componentDef.encapsulation,a):fm(f,p,function tY(t){const e=t.toLowerCase();return"svg"===e?XD:"math"===e?"math":null}(p));let m=512;this.componentDef.signals?m|=4096:this.componentDef.onPush||(m|=16);let y=null;null!==g&&(y=iE(g,a,!0));const v=RE(0,null,null,1,0,null,null,null,null,null,null),_=_m(null,v,null,m,null,null,h,f,a,null,y);let w,C;M0(_);try{const S=this.componentDef;let M,x=null;S.findHostDirectiveDefs?(M=[],x=new Map,S.findHostDirectiveDefs(S,M,x),M.push(S)):M=[S];const N=function iY(t,e){const n=t[X],i=ue;return t[i]=e,bc(n,i,2,"#host",null)}(_,g),U=function rY(t,e,n,i,r,s,o){const a=r[X];!function sY(t,e,n,i){for(const r of t)e.mergedAttrs=Jd(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Rm(e,e.mergedAttrs,!0),null!==n&&iO(i,n,e))}(i,t,e,o);let c=null;null!==e&&(c=iE(e,r[ln]));const l=s.rendererFactory.createRenderer(e,n);let u=16;n.signals?u=4096:n.onPush&&(u=64);const d=_m(r,cO(n),null,u,r[t.index],t,s,l,null,null,c);return a.firstCreatePass&&PE(a,t,i.length-1),ym(r,d),r[t.index]=d}(N,g,S,M,_,h,f);C=sh(v,ue),g&&function aY(t,e,n,i){if(i)r0(t,n,["ng-version","18.2.1"]);else{const{attrs:r,classes:s}=function t5(t){const e=[],n=[];let i=1,r=2;for(;i<t.length;){let s=t[i];if("string"==typeof s)2===r?""!==s&&e.push(s,t[++i]):8===r&&n.push(s);else{if(!Xr(r))break;r=s}i++}return{attrs:e,classes:n}}(e.selectors[0]);r&&r0(t,n,r),s&&s.length>0&&nO(t,n,s.join(" "))}}(f,S,g,i),void 0!==n&&function cY(t,e,n){const i=t.projection=[];for(let r=0;r<e.length;r++){const s=n[r];i.push(null!=s?Array.from(s):null)}}(C,this.ngContentSelectors,n),w=function oY(t,e,n,i,r,s){const o=vt(),a=r[X],c=bi(o,r);hO(a,r,o,n,null,i);for(let u=0;u<n.length;u++)ci(fc(r,a,o.directiveStart+u,o),r);fO(a,r,o),c&&ci(c,r);const l=fc(r,a,o.directiveStart+o.componentOffset,o);if(t[Pt]=r[Pt]=l,null!==s)for(const u of s)u(l,e);return IE(a,o,r),l}(U,S,M,x,_,[lY]),BE(v,_,null)}finally{D0()}return new nY(this.componentType,w,Xl(C,_),_,C)}finally{H(s)}}}class nY extends WX{constructor(e,n,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Ih(r,void 0,!1),this.componentType=e}setInput(e,n){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;const s=this._rootLView;FE(s[X],s,r,e,n),this.previousInputValues.set(e,n),xh(rr(this._tNode.index,s),1)}}get injector(){return new Sn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function lY(){const t=vt();Hg(B()[X],t)}let Ci=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=uY}return t})();function uY(){return aP(vt(),B())}const dY=Ci,sP=class extends dY{constructor(e,n,i){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=i}get element(){return Xl(this._hostTNode,this._hostLView)}get injector(){return new Sn(this._hostTNode,this._hostLView)}get parentInjector(){const e=qg(this._hostTNode,this._hostLView);if(L0(e)){const n=dh(e,this._hostLView),i=uh(e);return new Sn(n[X].data[i+8],n)}return new Sn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=oP(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-Qt}createEmbeddedView(e,n,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const o=Ac(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,r,Ec(this._hostTNode,o)),a}createComponent(e,n,i,r,s){const o=e&&!function eh(t){return"function"==typeof t}(e);let a;if(o)a=n;else{const p=n||{};a=p.index,i=p.injector,r=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}const c=o?e:new Uh(je(e)),l=i||this.parentInjector;if(!s&&null==c.ngModule){const g=(o?l:this.parentInjector).get(oi,null);g&&(s=g)}const u=je(c.componentType??{}),d=Ac(this._lContainer,u?.id??null),f=c.create(l,r,d?.firstChild??null,s);return this.insertImpl(f.hostView,a,Ec(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,i){const r=e._lView;if(function O5(t){return ai(t[cn])}(r)){const a=this.indexOf(e);if(-1!==a)this.detach(a);else{const c=r[cn],l=new sP(c,c[Gn],c[cn]);l.detach(l.indexOf(e))}}const s=this._adjustIndex(n),o=this._lContainer;return ru(o,r,s,i),e.attachToViewContainerRef(),yD(tw(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=oP(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),i=Ah(this._lContainer,n);i&&(Cg(tw(this._lContainer),n),pm(i[X],i))}detach(e){const n=this._adjustIndex(e,-1),i=Ah(this._lContainer,n);return i&&null!=Cg(tw(this._lContainer),n)?new Ih(i):null}_adjustIndex(e,n=0){return e??this.length+n}};function oP(t){return t[8]}function tw(t){return t[8]||(t[8]=[])}function aP(t,e){let n;const i=e[t.index];return ai(i)?n=i:(n=pO(i,e,null,t),e[t.index]=n,ym(e,n)),cP(n,e,t,i),new sP(n,t,e)}let cP=function uP(t,e,n,i){if(t[ys])return;let r;r=8&n.type?tt(i):function hY(t,e){const n=t[Te],i=n.createComment(""),r=bi(e,t);return yc(n,AE(n,r),i,function cq(t,e){return t.nextSibling(e)}(n,r),!1),i}(e,n),t[ys]=r},nw=()=>!1;class iw{constructor(e){this.queryList=e,this.matches=null}clone(){return new iw(this.queryList)}setDirty(){this.queryList.setDirty()}}class rw{constructor(e=[]){this.queries=e}createEmbeddedView(e){const n=e.queries;if(null!==n){const i=null!==e.contentQueries?e.contentQueries[0]:n.length,r=[];for(let s=0;s<i;s++){const o=n.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new rw(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let n=0;n<this.queries.length;n++)null!==lw(e,n).matches&&this.queries[n].setDirty()}}class dP{constructor(e,n,i=null){this.flags=n,this.read=i,this.predicate="string"==typeof e?function bY(t){return t.split(",").map(e=>e.trim())}(e):e}}class sw{constructor(e=[]){this.queries=e}elementStart(e,n){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,n)}elementEnd(e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(e)}embeddedTView(e){let n=null;for(let i=0;i<this.length;i++){const r=null!==n?n.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==n?n.push(s):n=[s])}return null!==n?new sw(n):null}template(e,n){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,n)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class ow{constructor(e,n=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(e,n){this.isApplyingToNode(n)&&this.matchTNode(e,n)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,n){this.elementStart(e,n)}embeddedTView(e,n){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,n),new ow(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1&~this.metadata.flags){const n=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==n;)i=i.parent;return n===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,n){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,n,mY(n,s)),this.matchTNodeWithReadOption(e,n,Xg(n,e,s,!1,!1))}else i===Qr?4&n.type&&this.matchTNodeWithReadOption(e,n,-1):this.matchTNodeWithReadOption(e,n,Xg(n,e,i,!1,!1))}matchTNodeWithReadOption(e,n,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===en||r===Ci||r===Qr&&4&n.type)this.addMatch(n.index,-2);else{const s=Xg(n,e,r,!1,!1);null!==s&&this.addMatch(n.index,s)}else this.addMatch(n.index,i)}}addMatch(e,n){null===this.matches?this.matches=[e,n]:this.matches.push(e,n)}}function mY(t,e){const n=t.localNames;if(null!==n)for(let i=0;i<n.length;i+=2)if(n[i]===e)return n[i+1];return null}function yY(t,e,n,i){return-1===n?function _Y(t,e){return 11&t.type?Xl(t,e):4&t.type?Em(t,e):null}(e,t):-2===n?function vY(t,e,n){return n===en?Xl(e,t):n===Qr?Em(e,t):n===Ci?aP(e,t):void 0}(t,e,i):fc(t,t[X],n,e)}function hP(t,e,n,i){const r=e[mo].queries[i];if(null===r.matches){const s=t.data,o=n.matches,a=[];for(let c=0;null!==o&&c<o.length;c+=2){const l=o[c];a.push(l<0?null:yY(e,s[l],o[c+1],n.metadata.read))}r.matches=a}return r.matches}function aw(t,e,n,i){const r=t.queries.getByIndex(n),s=r.matches;if(null!==s){const o=hP(t,e,r,n);for(let a=0;a<s.length;a+=2){const c=s[a];if(c>0)i.push(o[a/2]);else{const l=s[a+1],u=e[-c];for(let d=Qt;d<u.length;d++){const h=u[d];h[ac]===h[cn]&&aw(h[X],h,l,i)}if(null!==u[Gl]){const d=u[Gl];for(let h=0;h<d.length;h++){const f=d[h];aw(f[X],f,l,i)}}}}}return i}function fP(t,e,n){const i=new Yl(!(4&~n));return function vq(t,e,n,i){const r=mO(e);r.push(n),t.firstCreatePass&&_O(t).push(i,r.length-1)}(t,e,i,i.destroy),(e[mo]??=new rw).queries.push(new iw(i))-1}function mP(t,e,n){null===t.queries&&(t.queries=new sw),t.queries.track(new ow(e,n))}function lw(t,e){return t.queries.getByIndex(e)}function _P(t,e){const n=t[X],i=lw(n,e);return i.crossesNgTemplate?aw(n,t,e,[]):hP(n,t,i,e)}function uw(t,e){wi("NgSignals");const n=function Vn(t){const e=Object.create(Za);e.value=t;const n=()=>(qt(e),e.value);return n[K]=e,n}(t),i=n[K];return e?.equal&&(i.equal=e.equal),n.set=r=>jn(i,r),n.update=r=>function vl(t,e){kn()||_l(),jn(t,e(t.value))}(i,r),n.asReadonly=yP.bind(n),n}function yP(){const t=this[K];if(void 0===t.readonlyFn){const e=()=>this();e[K]=t,t.readonlyFn=e}return t.readonlyFn}function wo(t){let e=function DP(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),n=!0;const i=[t];for(;e;){let r;if(Kr(t))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new $(903,!1);r=e.\u0275dir}if(r){if(n){i.push(r);const o=t;o.inputs=Pm(t.inputs),o.inputTransforms=Pm(t.inputTransforms),o.declaredInputs=Pm(t.declaredInputs),o.outputs=Pm(t.outputs);const a=r.hostBindings;a&&LY(t,a);const c=r.viewQuery,l=r.contentQueries;if(c&&PY(t,c),l&&NY(t,l),RY(t,r),b9(t.outputs,r.outputs),Kr(r)&&r.data.animation){const u=t.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(t),a===wo&&(n=!1)}}e=Object.getPrototypeOf(e)}!function OY(t){let e=0,n=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Jd(r.hostAttrs,n=Jd(n,r.hostAttrs))}}(i)}function RY(t,e){for(const n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;const i=e.inputs[n];if(void 0!==i&&(t.inputs[n]=i,t.declaredInputs[n]=e.declaredInputs[n],null!==e.inputTransforms)){const r=Array.isArray(i)?i[0]:i;if(!e.inputTransforms.hasOwnProperty(r))continue;t.inputTransforms??={},t.inputTransforms[r]=e.inputTransforms[r]}}}function Pm(t){return t===gs?{}:t===et?[]:t}function PY(t,e){const n=t.viewQuery;t.viewQuery=n?(i,r)=>{e(i,r),n(i,r)}:e}function NY(t,e){const n=t.contentQueries;t.contentQueries=n?(i,r,s)=>{e(i,r,s),n(i,r,s)}:e}function LY(t,e){const n=t.hostBindings;t.hostBindings=n?(i,r)=>{e(i,r),n(i,r)}:e}function RP(t){const e=n=>{const i=(Array.isArray(t)?t:t()).map(r=>"function"==typeof r?{directive:Ce(r),inputs:gs,outputs:gs}:{directive:Ce(r.directive),inputs:PP(r.inputs),outputs:PP(r.outputs)});null===n.hostDirectives?(n.findHostDirectiveDefs=OP,n.hostDirectives=i):n.hostDirectives.unshift(...i)};return e.ngInherit=!0,e}function OP(t,e,n){if(null!==t.hostDirectives)for(const i of t.hostDirectives){const r=An(i.directive);UY(r.declaredInputs,i.inputs),OP(r,e,n),n.set(r,i),e.push(r)}}function PP(t){if(void 0===t||0===t.length)return gs;const e={};for(let n=0;n<t.length;n+=2)e[t[n]]=t[n+1];return e}function UY(t,e){for(const n in e)e.hasOwnProperty(n)&&(t[e[n]]=t[n])}function Cc(t){const e=t.inputConfig,n={};for(const i in e)if(e.hasOwnProperty(i)){const r=e[i];Array.isArray(r)&&r[3]&&(n[i]=r[3])}t.inputTransforms=n}class Tc{}class FP extends Tc{constructor(e){super(),this.componentFactoryResolver=new iP(this),this.instance=null;const n=new Bl([...e.providers,{provide:Tc,useValue:this},{provide:ua,useValue:this.componentFactoryResolver}],e.parent||Og(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function Nm(t){return!!function gw(t){return null!==t&&("function"==typeof t||"object"==typeof t)}(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function xs(t,e,n){return t[e]=n}function tn(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function zh(t,e,n,i,r,s,o,a,c,l){const u=n+ue,d=e.firstCreatePass?function $Y(t,e,n,i,r,s,o,a,c){const l=e.consts,u=bc(e,t,4,o||null,a||null);OE(e,n,u,Ir(l,c)),Hg(e,u);const d=u.tView=RE(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,e,t,i,r,s,o,a,c):e.data[u];Jr(d,!1);const h=BP(e,t,d,n);ch()&&gm(e,t,h,d),ci(h,t);const f=pO(h,t,h,d);return t[u]=f,ym(t,f),function lP(t,e,n){return nw(t,e,n)}(f,d,t),Bg(d)&&ME(e,t,d),null!=c&&DE(t,d,l),d}function es(t,e,n,i,r,s,o,a){const c=B(),l=Be();return zh(c,l,t,e,n,i,r,Ir(l.consts,s),o,a),es}let BP=function kP(t,e,n,i){return ws(!0),e[Te].createComment("")};function Is(t,e,n,i){const r=B();return tn(r,Zr(),e)&&(Be(),Ss(Nt(),r,t,e,n,i)),Is}function mu(t,e,n,i){return tn(t,Zr(),n)?e+Ie(n)+i:Me}function jm(t,e){return t<<17|e<<2}function pa(t){return t>>17&32767}function Sw(t){return 2|t}function Ic(t){return(131068&t)>>2}function xw(t,e){return-131069&t|e<<2}function Iw(t){return 1|t}function gN(t,e,n,i){const r=t[n+1],s=null===e;let o=i?pa(r):Ic(r),a=!1;for(;0!==o&&(!1===a||s);){const l=t[o+1];RK(t[o],e)&&(a=!0,t[o+1]=i?Iw(l):Sw(l)),o=i?pa(l):Ic(l)}a&&(t[n+1]=i?Sw(r):Iw(r))}function RK(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&Fl(t,e)>=0}const xn={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function mN(t){return t.substring(xn.key,xn.keyEnd)}function _N(t,e){const n=xn.textEnd;return n===e?-1:(e=xn.keyEnd=function LK(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}(t,xn.key=e,n),Cu(t,e,n))}function Cu(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function li(t,e,n){const i=B();return tn(i,Zr(),e)&&Bi(Be(),Nt(),i,t,e,i[Te],n,!1),li}function Mw(t,e,n,i,r){const o=r?"class":"style";FE(t,n,e.inputs[o],o,i)}function qh(t,e,n){return ts(t,e,n,!1),qh}function cr(t,e){return ts(t,e,null,!0),cr}function Hm(t){!function ns(t,e,n,i){const r=Be(),s=vo(2);r.firstUpdatePass&&AN(r,null,s,i);const o=B();if(n!==Me&&tn(o,s,n)){const a=r.data[Wn()];if(xN(a,i)&&!wN(r,s)){let c=i?a.classesWithoutHost:a.stylesWithoutHost;null!==c&&(n=Vb(c,n||"")),Mw(r,a,o,n,i)}else!function WK(t,e,n,i,r,s,o,a){r===Me&&(r=et);let c=0,l=0,u=0<r.length?r[0]:null,d=0<s.length?s[0]:null;for(;null!==u||null!==d;){const h=c<r.length?r[c+1]:void 0,f=l<s.length?s[l+1]:void 0;let g,p=null;u===d?(c+=2,l+=2,h!==f&&(p=d,g=f)):null===d||null!==u&&u<d?(c+=2,p=u):(l+=2,p=d,g=f),null!==p&&TN(t,e,n,i,p,g,o,a),u=c<r.length?r[c]:null,d=l<s.length?s[l]:null}}(r,a,o,o[Te],o[s+1],o[s+1]=function zK(t,e,n){if(null==n||""===n)return et;const i=[],r=sr(n);if(Array.isArray(r))for(let s=0;s<r.length;s++)t(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&t(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(t,e,n),i,s)}}(GK,Ds,t,!0)}function Ds(t,e){for(let n=function PK(t){return function vN(t){xn.key=0,xn.keyEnd=0,xn.value=0,xn.valueEnd=0,xn.textEnd=t.length}(t),_N(t,Cu(t,0,xn.textEnd))}(e);n>=0;n=_N(e,n))nr(t,mN(e),!0)}function ts(t,e,n,i){const r=B(),s=Be(),o=vo(2);s.firstUpdatePass&&AN(s,t,o,i),e!==Me&&tn(r,o,e)&&TN(s,s.data[Wn()],r,r[Te],t,r[o+1]=function $K(t,e){return null==t||""===t||("string"==typeof e?t+=e:"object"==typeof t&&(t=wn(sr(t)))),t}(e,n),i,o)}function wN(t,e){return e>=t.expandoStartIndex}function AN(t,e,n,i){const r=t.data;if(null===r[n+1]){const s=r[Wn()],o=wN(t,n);xN(s,i)&&null===e&&!o&&(e=!1),e=function UK(t,e,n,i){const r=function x0(t){const e=Se.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(n=Xh(n=Dw(null,t,e,n,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||t[o]!==r)if(n=Dw(r,t,e,n,i),null===s){let c=function VK(t,e,n){const i=n?e.classBindings:e.styleBindings;if(0!==Ic(i))return t[pa(i)]}(t,e,i);void 0!==c&&Array.isArray(c)&&(c=Dw(null,t,e,c[1],i),c=Xh(c,e.attrs,i),function jK(t,e,n,i){t[pa(n?e.classBindings:e.styleBindings)]=i}(t,e,i,c))}else s=function HK(t,e,n){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=Xh(i,t[s].hostAttrs,n);return Xh(i,e.attrs,n)}(t,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),n}(r,s,e,i),function MK(t,e,n,i,r,s){let o=s?e.classBindings:e.styleBindings,a=pa(o),c=Ic(o);t[i]=n;let u,l=!1;if(Array.isArray(n)?(u=n[1],(null===u||Fl(n,u)>0)&&(l=!0)):u=n,r)if(0!==c){const h=pa(t[a+1]);t[i+1]=jm(h,a),0!==h&&(t[h+1]=xw(t[h+1],i)),t[a+1]=function xK(t,e){return 131071&t|e<<17}(t[a+1],i)}else t[i+1]=jm(a,0),0!==a&&(t[a+1]=xw(t[a+1],i)),a=i;else t[i+1]=jm(c,0),0===a?a=i:t[c+1]=xw(t[c+1],i),c=i;l&&(t[i+1]=Sw(t[i+1])),gN(t,u,i,!0),gN(t,u,i,!1),function DK(t,e,n,i,r){const s=r?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof e&&Fl(s,e)>=0&&(n[i+1]=Iw(n[i+1]))}(e,u,t,i,s),o=jm(a,c),s?e.classBindings=o:e.styleBindings=o}(r,s,e,n,o,i)}}function Dw(t,e,n,i,r){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=e[a],i=Xh(i,s.hostAttrs,r),s!==t);)a++;return null!==t&&(n.directiveStylingLast=a),i}function Xh(t,e,n){const i=n?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),nr(t,o,!!n||e[++s]))}return void 0===t?null:t}function GK(t,e,n){const i=String(e);""!==i&&!i.includes(" ")&&nr(t,i,n)}function TN(t,e,n,i,r,s,o,a){if(!(3&e.type))return;const c=t.data,l=c[a+1],u=function IK(t){return!(1&~t)}(l)?SN(c,e,n,r,Ic(l),o):void 0;zm(u)||(zm(s)||function SK(t){return!(2&~t)}(l)&&(s=SN(c,null,n,r,a,o)),function dq(t,e,n,i,r){if(e)r?t.addClass(n,i):t.removeClass(n,i);else{let s=-1===i.indexOf("-")?void 0:la.DashCase;null==r?t.removeStyle(n,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=la.Important),t.setStyle(n,i,r,s))}}(i,o,rh(Wn(),n),r,s))}function SN(t,e,n,i,r,s){const o=null===e;let a;for(;r>0;){const c=t[r],l=Array.isArray(c),u=l?c[1]:c,d=null===u;let h=n[r+1];h===Me&&(h=d?et:void 0);let f=d?t0(h,i):u===i?h:void 0;if(l&&!zm(f)&&(f=t0(c,i)),zm(f)&&(a=f,o))return a;const p=t[r+1];r=o?pa(p):Ic(p)}if(null!==e){let c=s?e.residualClasses:e.residualStyles;null!=c&&(a=t0(c,i))}return a}function zm(t){return void 0!==t}function xN(t,e){return!!(t.flags&(e?8:16))}function Pw(t,e){wi("NgControlFlow");const n=B(),i=Zr(),r=n[i]!==Me?n[i]:-1,s=-1!==r?Gm(n,ue+r):void 0;if(tn(n,i,t)){const a=H(null);try{if(void 0!==s&&function kE(t,e){const n=Ah(t,e);return void 0!==n&&pm(n[X],n),n}(s,0),-1!==t){const c=ue+t,l=Gm(n,c),u=function Nw(t,e){return sh(t,e)}(n[X],c),d=Ac(l,u.tView.ssrId);ru(l,iu(n,u,e,{dehydratedView:d}),0,Ec(u,d))}}finally{H(a)}}else if(void 0!==s){const a=function vO(t,e){const n=Qt+e;if(n<t.length)return t[n]}(s,0);void 0!==a&&(a[Pt]=e)}}function Gm(t,e){return t[e]}function pt(t,e,n,i){const r=B(),s=Be(),o=ue+t,a=r[Te],c=s.firstCreatePass?function g7(t,e,n,i,r,s){const o=e.consts,c=bc(e,t,2,i,Ir(o,r));return OE(e,n,c,Ir(o,s)),null!==c.attrs&&Rm(c,c.attrs,!1),null!==c.mergedAttrs&&Rm(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,e,n,i):s.data[o],l=RN(s,r,c,a,e,t);r[o]=l;const u=Bg(c);return Jr(c,!0),iO(a,l,c),!function cu(t){return!(32&~t.flags)}(c)&&ch()&&gm(s,r,l,c),0===function P5(){return Se.lFrame.elementDepthCount}()&&ci(l,r),function N5(){Se.lFrame.elementDepthCount++}(),u&&(ME(s,r,c),IE(s,c,r)),null!==i&&DE(r,c),pt}function wt(){let t=vt();C0()?T0():(t=t.parent,Jr(t,!1));const e=t;(function F5(t){return Se.skipHydrationRootTNode===t})(e)&&function V5(){Se.skipHydrationRootTNode=null}(),function L5(){Se.lFrame.elementDepthCount--}();const n=Be();return n.firstCreatePass&&(Hg(n,t),g0(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function Z5(t){return!!(8&t.flags)}(e)&&Mw(n,e,B(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function Q5(t){return!!(16&t.flags)}(e)&&Mw(n,e,B(),e.stylesWithoutHost,!1),wt}function Rs(t,e,n,i){return pt(t,e,n,i),wt(),Rs}let RN=(t,e,n,i,r,s)=>(ws(!0),fm(i,r,function p1(){return Se.lFrame.currentNamespace}()));function Yh(){return B()}function Wm(t,e,n){const i=B();return tn(i,Zr(),e)&&Bi(Be(),Nt(),i,t,e,i[Te],n,!0),Wm}const $m="en-US";let BN=$m,tL=(t,e,n)=>{};function Ui(t,e,n,i){const r=B(),s=Be(),o=vt();return function Uw(t,e,n,i,r,s,o){const a=Bg(i),l=t.firstCreatePass&&_O(t),u=e[Pt],d=mO(e);let h=!0;if(3&i.type||o){const g=bi(i,e),m=o?o(g):g,y=d.length,v=o?w=>o(tt(w[i.index])):i.index;let _=null;if(!o&&a&&(_=function dJ(t,e,n,i){const r=t.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===n&&r[s+1]===i){const a=e[Vl],c=r[s+2];return a.length>c?a[c]:null}"string"==typeof o&&(s+=2)}return null}(t,e,r,i.index)),null!==_)(_.__ngLastListenerFn__||_).__ngNextListenerFn__=s,_.__ngLastListenerFn__=s,h=!1;else{s=sL(i,e,u,s),tL(g,r,s);const w=n.listen(m,r,s);d.push(s,w),l&&l.push(r,v,y,y+1)}}else s=sL(i,e,u,s);const f=i.outputs;let p;if(h&&null!==f&&(p=f[r])){const g=p.length;if(g)for(let m=0;m<g;m+=2){const C=e[p[m]][p[m+1]].subscribe(s),S=d.length;d.push(s,C),l&&l.push(r,i.index,S,-(S+1))}}}(s,r,r[Te],o,t,e,i),Ui}function rL(t,e,n,i){const r=H(null);try{return vs(6,e,n),!1!==n(i)}catch(s){return vm(t,s),!1}finally{vs(7,e,n),H(r)}}function sL(t,e,n,i){return function r(s){if(s===Function)return i;xh(t.componentOffset>-1?rr(t.index,e):e,5);let a=rL(e,n,i,s),c=r.__ngNextListenerFn__;for(;c;)a=rL(e,n,c,s)&&a,c=c.__ngNextListenerFn__;return a}}function Ao(t=1){return function W5(t){return(Se.lFrame.contextLView=function ZD(t,e){for(;t>0;)e=e[jl],t--;return e}(t,Se.lFrame.contextLView))[Pt]}(t)}function hJ(t,e){let n=null;const i=function Y9(t){const e=t.attrs;if(null!=e){const n=e.indexOf(5);if(!(1&n))return e[n+1]}return null}(t);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?TD(t,s,!0):Z9(i,s))return r}else n=r}return n}function ga(t){const e=B()[Wt][Gn];if(!e.projection){const i=e.projection=function Tg(t,e){const n=[];for(let i=0;i<t;i++)n.push(e);return n}(t?t.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){if(128!==s.type){const o=t?hJ(s,t):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s)}s=s.next}}}function ui(t,e=0,n,i,r,s){const o=B(),a=Be(),c=i?t+1:null;null!==c&&zh(o,a,c,i,r,s,null,n);const l=bc(a,ue+t,16,null,n||null);null===l.projection&&(l.projection=e),T0();const d=!o[vi]||uc();null===o[Wt][Gn].projection[l.projection]&&null!==c?function fJ(t,e,n){const i=ue+n,r=e.data[i],s=t[i],o=Ac(s,r.tView.ssrId);ru(s,iu(t,r,void 0,{dehydratedView:o}),0,Ec(r,o))}(o,a,c):d&&32&~l.flags&&function lq(t,e,n){tO(e[Te],0,e,n,wE(t,n,e),YR(n.parent||e[Gn],n,e))}(a,o,l)}function Vw(t,e,n){return jw(t,"",e,"",n),Vw}function jw(t,e,n,i,r){const s=B(),o=mu(s,e,n,i);return o!==Me&&Bi(Be(),Nt(),s,t,o,s[Te],r,!1),jw}function Hw(t,e,n,i){!function gP(t,e,n,i){const r=Be();if(r.firstCreatePass){const s=vt();mP(r,new dP(e,n,i),s.index),function EY(t,e){const n=t.contentQueries||(t.contentQueries=[]);e!==(n.length?n[n.length-1]:-1)&&n.push(t.queries.length-1,e)}(r,t),!(2&~n)&&(r.staticContentQueries=!0)}return fP(r,B(),n)}(t,e,n,i)}function Su(t,e,n){!function pP(t,e,n){const i=Be();return i.firstCreatePass&&(mP(i,new dP(t,e,n),-1),!(2&~e)&&(i.staticViewQueries=!0)),fP(i,B(),e)}(t,e,n)}function ma(t){const e=B(),n=Be(),i=I0();jg(i+1);const r=lw(n,i);if(t.dirty&&function R5(t){return!(4&~t[me])}(e)===!(2&~r.metadata.flags)){if(null===r.matches)t.reset([]);else{const s=_P(e,i);t.reset(s,z1),t.notifyOnChanges()}return!0}return!1}function _a(){return function cw(t,e){return t[mo].queries[e].queryList}(B(),I0())}function ya(t,e=""){const n=B(),i=Be(),r=t+ue,s=i.firstCreatePass?bc(i,r,1,e,null):i.data[r],o=AL(i,n,s,e,t);n[r]=o,ch()&&gm(i,n,o,s),Jr(s,!1)}let AL=(t,e,n,i,r)=>(ws(!0),function yE(t,e){return t.createText(e)}(e[Te],i));function Dc(t){return Gw("",t,""),Dc}function Gw(t,e,n){const i=B(),r=mu(i,t,e,n);return r!==Me&&function Eo(t,e,n){const i=rh(e,t);!function zR(t,e,n){t.setValue(e,n)}(t[Te],i,n)}(i,Wn(),r),Gw}function Ww(t,e,n,i,r){if(t=Ce(t),Array.isArray(t))for(let s=0;s<t.length;s++)Ww(t[s],e,n,i,r);else{const s=Be(),o=B(),a=vt();let c=oc(t)?t:Ce(t.provide);const l=ND(t),u=1048575&a.providerIndexes,d=a.directiveStart,h=a.providerIndexes>>20;if(oc(t)||!t.multi){const f=new lh(l,r,j),p=qw(c,e,r?u:u+h,d);-1===p?(k0($g(a,o),s,c),$w(s,t,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{const f=qw(c,e,u+h,d),p=qw(c,e,u,u+h),m=p>=0&&n[p];if(r&&!m||!r&&!(f>=0&&n[f])){k0($g(a,o),s,c);const y=function LJ(t,e,n,i,r){const s=new lh(t,n,j);return s.multi=[],s.index=e,s.componentProviders=0,FL(s,r,i&&!n),s}(r?NJ:PJ,n.length,r,i,l);!r&&m&&(n[p].providerFactory=y),$w(s,t,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),n.push(y),o.push(y)}else $w(s,t,f>-1?f:p,FL(n[r?p:f],l,!r&&i));!r&&i&&m&&n[p].componentProviders++}}}function $w(t,e,n,i){const r=oc(e),s=function c5(t){return!!t.useClass}(e);if(r||s){const c=(s?Ce(e.useClass):e).prototype.ngOnDestroy;if(c){const l=t.destroyHooks||(t.destroyHooks=[]);if(!r&&e.multi){const u=l.indexOf(n);-1===u?l.push(n,[i,c]):l[u+1].push(i,c)}else l.push(n,c)}}}function FL(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function qw(t,e,n,i){for(let r=n;r<i;r++)if(e[r]===t)return r;return-1}function PJ(t,e,n,i){return Xw(this.multi,[])}function NJ(t,e,n,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=fc(n,n[X],this.providerFactory.index,i);s=a.slice(0,o),Xw(r,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],Xw(r,s);return s}function Xw(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function Yw(t,e=[]){return n=>{n.providersResolver=(i,r)=>function OJ(t,e,n){const i=Be();if(i.firstCreatePass){const r=Kr(t);Ww(n,i.data,i.blueprint,r,!0),Ww(e,i.data,i.blueprint,r,!1)}}(i,r?r(t):t,e)}}let FJ=(()=>{class t{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const i=o0(0,n.type),r=i.length>0?function pw(t,e,n=null){return new FP({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}([i],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,r)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=V({token:t,providedIn:"environment",factory:()=>new t(D(oi))})}return t})();function Vi(t){wi("NgStandalone"),t.getStandaloneInjector=e=>e.get(FJ).getOrCreateStandaloneInjector(t)}function VL(t,e,n,i,r,s){const o=e+n;return tn(t,o,r)?xs(t,o+1,s?i.call(s,r):i(r)):function tf(t,e){const n=t[e];return n===Me?void 0:n}(t,o+1)}function va(t,e){const n=Be();let i;const r=t+ue;n.firstCreatePass?(i=function YJ(t,e){if(e)for(let n=e.length-1;n>=0;n--){const i=e[n];if(t===i.name)return i}}(e,n.pipeRegistry),n.data[r]=i,i.onDestroy&&(n.destroyHooks??=[]).push(r,i.onDestroy)):i=n.data[r];const s=i.factory||(i.factory=sc(i.type)),a=Oi(j);try{const c=Wg(!1),l=s();return Wg(c),function zw(t,e,n,i){n>=t.data.length&&(t.data[n]=null,t.blueprint[n]=null),e[n]=i}(n,B(),r,l),l}finally{Oi(a)}}function ba(t,e,n){const i=t+ue,r=B(),s=function lc(t,e){return t[e]}(r,i);return function nf(t,e){return t[X].data[e].pure}(r,i)?VL(r,Ei(),e,s.transform,n,s):s.transform(n)}const dF=new L(""),e_=new L("");let iA,tA=(()=>{class t{constructor(n,i,r){this._ngZone=n,this.registry=i,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,iA||(function qZ(t){iA=t}(r),r.addToWindow(i)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{_e.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb()}});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(n)||(clearTimeout(i.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),n()},i)),this._callbacks.push({doneCb:n,timeoutId:s,updateCb:r})}whenStable(n,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,i,r),this._runCallbacksIfReady()}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||t)(D(_e),D(nA),D(e_))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})(),nA=(()=>{class t{constructor(){this._applications=new Map}registerApplication(n,i){this._applications.set(n,i)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,i=!0){return iA?.findTestabilityInTree(this,n,i)??null}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();function Rc(t){return!!t&&"function"==typeof t.then}function hF(t){return!!t&&"function"==typeof t.subscribe}const fF=new L("");let pF=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,i)=>{this.resolve=n,this.reject=i}),this.appInits=O(fF,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const r of this.appInits){const s=r();if(Rc(s))n.push(s);else if(hF(s)){const o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});n.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{i()}).catch(r=>{this.reject(r)}),0===n.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const cf=new L("");let ji=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=O(xW),this.afterRenderEffectManager=O(Mm),this.zonelessEnabled=O(Fh),this.externalTestViews=new Set,this.beforeRender=new de,this.afterTick=new de,this.componentTypes=[],this.components=[],this.isStable=O(aa).hasPendingTasks.pipe(se(n=>!n)),this._injector=O(oi)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let n;return new Promise(i=>{n=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{n.unsubscribe()})}get injector(){return this._injector}bootstrap(n,i){const r=n instanceof YO;if(!this._injector.get(pF).done)throw!r&&function sa(t){const e=je(t)||An(t)||zn(t);return null!==e&&e.standalone}(n),new $(405,!1);let o;o=r?n:this._injector.get(ua).resolveComponentFactory(n),this.componentTypes.push(o.componentType);const a=function XZ(t){return t.isBoundToModule}(o)?void 0:this._injector.get(Tc),l=o.create(lt.NULL,[],i||o.selector,a),u=l.location.nativeElement,d=l.injector.get(dF,null);return d?.registerApplication(u),l.onDestroy(()=>{this.detachView(l.hostView),t_(this.components,l),d?.unregisterApplication(u)}),this._loadComponent(l),l}tick(){this._tick(!0)}_tick(n){if(this._runningTick)throw new $(101,!1);const i=H(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(n)}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,H(i),this.afterTick.next()}}detectChangesInAttachedViews(n){let i=null;this._injector.destroyed||(i=this._injector.get(JE,null,{optional:!0}));let r=0;const s=this.afterRenderEffectManager;for(;r<10;){const o=0===r;if(n||!o){this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)JZ(a,c,o,this.zonelessEnabled)}else i?.begin?.(),i?.end?.();if(r++,s.executeInternalCallbacks(),!this.allViews.some(({_lView:a})=>oh(a))&&(s.execute(),!this.allViews.some(({_lView:a})=>oh(a))))break}}attachView(n){const i=n;this._views.push(i),i.attachToAppRef(this)}detachView(n){const i=n;t_(this._views,i),i.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const i=this._injector.get(cf,[]);[...this._bootstrapListeners,...i].forEach(r=>r(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>t_(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new $(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function t_(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function JZ(t,e,n,i){(n||oh(t))&&bm(t,e,n&&!i?0:1)}let nQ=(()=>{class t{constructor(){this.zone=O(_e),this.changeDetectionScheduler=O(ou),this.applicationRef=O(ji)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function rA({ngZoneFactory:t,ignoreChangesOutsideZone:e,scheduleInRootZone:n}){return t??=()=>new _e({...sA(),scheduleInRootZone:n}),[{provide:_e,useFactory:t},{provide:ir,multi:!0,useFactory:()=>{const i=O(nQ,{optional:!0});return()=>i.initialize()}},{provide:ir,multi:!0,useFactory:()=>{const i=O(rQ);return()=>{i.initialize()}}},!0===e?{provide:XO,useValue:!0}:[],{provide:KE,useValue:n??F1}]}function sA(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}let rQ=(()=>{class t{constructor(){this.subscription=new bt,this.initialized=!1,this.zone=O(_e),this.pendingTasks=O(aa)}initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{_e.assertNotInAngularZone(),queueMicrotask(()=>{null!==n&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{_e.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),lf=(()=>{class t{constructor(){this.appRef=O(ji),this.taskService=O(aa),this.ngZone=O(_e),this.zonelessEnabled=O(Fh),this.disableScheduling=O(XO,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new bt,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Jg):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(O(KE,{optional:!0})??!1),this.cancelScheduledCallback=null,this.shouldRefreshViews=!1,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof W0||!this.zoneIsDefined)}notify(n){if(!this.zonelessEnabled&&5===n)return;switch(n){case 3:case 2:case 0:case 4:case 5:case 1:this.shouldRefreshViews=!0}if(!this.shouldScheduleTick())return;const i=this.useMicrotaskScheduler?k1:B1;this.pendingRenderTaskId=this.taskService.add(),this.cancelScheduledCallback=this.scheduleInRootZone?Zone.root.run(()=>i(()=>this.tick(this.shouldRefreshViews))):this.ngZone.runOutsideAngular(()=>i(()=>this.tick(this.shouldRefreshViews)))}shouldScheduleTick(){return!(this.disableScheduling||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Jg+this.angularZoneId))}tick(n){if(this.runningTick||this.appRef.destroyed)return;const i=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick(n)},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(i),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,k1(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(i)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.shouldRefreshViews=!1,this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const n=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(n)}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Ea=new L("",{providedIn:"root",factory:()=>O(Ea,We.Optional|We.SkipSelf)||function sQ(){return typeof $localize<"u"&&$localize.locale||$m}()}),aA=new L("");function i_(t){return!!t.platformInjector}let wa=null;let lr=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=gQ}return t})();function gQ(t){return function mQ(t,e,n){if(cc(t)&&!n){const i=rr(t.index,e);return new Ih(i,i)}return 175&t.type?new Ih(e[Wt],e):null}(vt(),B(),!(16&~t))}class RF{constructor(){}supports(e){return Nm(e)}create(e){return new EQ(e)}}const bQ=(t,e)=>e;class EQ{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||bQ}forEachItem(e){let n;for(n=this._itHead;null!==n;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,i=this._removalsHead,r=0,s=null;for(;n||i;){const o=!i||n&&n.currentIndex<PF(i,r,s)?n:i,a=PF(o,r,s),c=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(n=n._next,null==o.previousIndex)r++;else{s||(s=[]);const l=a-r,u=c-r;if(l!=u){for(let h=0;h<l;h++){const f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<l&&(s[h]=f+1)}s[o.previousIndex]=u-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)e(n)}diff(e){if(null==e&&(e=[]),!Nm(e))throw new $(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,n=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==n&&Object.is(n.trackById,o)?(i&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)):(n=this._mismatch(n,s,o,a),i=!0),n=n._next}else r=0,function GY(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Symbol.iterator]();let i;for(;!(i=n.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==n&&Object.is(n.trackById,o)?(i&&(n=this._verifyReinsertion(n,a,o,r)),Object.is(n.item,a)||this._addIdentityChange(n,a)):(n=this._mismatch(n,a,o,r),i=!0),n=n._next,r++}),this.length=r;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,r)):e=this._addAfter(new wQ(n,i),s,r),e}_verifyReinsertion(e,n,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const n=e._next;this._addToRemovals(this._unlink(e)),e=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,n,i),this._addToMoves(e,i),e}_moveAfter(e,n,i){return this._unlink(e),this._insertAfter(e,n,i),this._addToMoves(e,i),e}_addAfter(e,n,i){return this._insertAfter(e,n,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,n,i){const r=null===n?this._itHead:n._next;return e._next=r,e._prev=n,null===r?this._itTail=e:r._prev=e,null===n?this._itHead=e:n._next=e,null===this._linkedRecords&&(this._linkedRecords=new OF),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const n=e._prev,i=e._next;return null===n?this._itHead=i:n._next=i,null===i?this._itTail=n:i._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new OF),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class wQ{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class AQ{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===n||n<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const n=e._prevDup,i=e._nextDup;return null===n?this._head=i:n._nextDup=i,null===i?this._tail=n:i._prevDup=n,null===this._head}}class OF{constructor(){this.map=new Map}put(e){const n=e.trackById;let i=this.map.get(n);i||(i=new AQ,this.map.set(n,i)),i.add(e)}get(e,n){const r=this.map.get(e);return r?r.get(e,n):null}remove(e){const n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function PF(t,e,n){const i=t.previousIndex;if(null===i)return i;let r=0;return n&&i<n.length&&(r=n[i]),i+e+r}function LF(){return new fA([new RF])}let fA=(()=>{class t{static#e=this.\u0275prov=V({token:t,providedIn:"root",factory:LF});constructor(n){this.factories=n}static create(n,i){if(null!=i){const r=i.factories.slice();n=n.concat(r)}return new t(n)}static extend(n){return{provide:t,useFactory:i=>t.create(n,i||LF()),deps:[[t,new Ag,new Nl]]}}find(n){const i=this.factories.find(r=>r.supports(n));if(null!=i)return i;throw new $(901,!1)}}return t})(),IQ=(()=>{class t{constructor(n){}static#e=this.\u0275fac=function(i){return new(i||t)(D(ji))};static#t=this.\u0275mod=Tr({type:t});static#n=this.\u0275inj=tr({})}return t})();function VQ(t){try{const{rootComponent:e,appProviders:n,platformProviders:i}=t,r=function pQ(t=[]){if(wa)return wa;const e=function TF(t=[],e){return lt.create({name:e,providers:[{provide:l0,useValue:"platform"},{provide:aA,useValue:new Set([()=>wa=null])},...t]})}(t);return wa=e,function gF(){!function Cb(t){Qp=t}(()=>{throw new $(600,!1)})}(),function SF(t){t.get(lR,null)?.forEach(n=>n())}(e),e}(i),s=[rA({}),{provide:ou,useExisting:lf},...n||[]];return function wF(t){const e=i_(t)?t.r3Injector:t.moduleRef.injector,n=e.get(_e);return n.run(()=>{i_(t)?t.r3Injector.resolveInjectorInitializers():t.moduleRef.resolveInjectorInitializers();const i=e.get(Ni,null);let r;if(n.runOutsideAngular(()=>{r=n.onError.subscribe({next:s=>{i.handleError(s)}})}),i_(t)){const s=()=>e.destroy(),o=t.platformInjector.get(aA);o.add(s),e.onDestroy(()=>{r.unsubscribe(),o.delete(s)})}else t.moduleRef.onDestroy(()=>{t_(t.allPlatformModules,t.moduleRef),r.unsubscribe()});return function KZ(t,e,n){try{const i=n();return Rc(i)?i.catch(r=>{throw e.runOutsideAngular(()=>t.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>t.handleError(i)),i}}(i,n,()=>{const s=e.get(pF);return s.runInitializers(),s.donePromise.then(()=>{if(function x7(t){"string"==typeof t&&(BN=t.toLowerCase().replace(/_/g,"-"))}(e.get(Ea,$m)||$m),i_(t)){const a=e.get(ji);return void 0!==t.rootComponent&&a.bootstrap(t.rootComponent),a}return function dQ(t,e){const n=t.injector.get(ji);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(i=>n.bootstrap(i));else{if(!t.instance.ngDoBootstrap)throw new $(-403,!1);t.instance.ngDoBootstrap(n)}e.push(t)}(t.moduleRef,t.allPlatformModules),t.moduleRef})})})}({r3Injector:new FP({providers:s,parent:r,debugName:"",runEnvironmentInitializers:!1}).injector,platformInjector:r,rootComponent:e})}catch(e){return Promise.reject(e)}}const ZF=new L("");function is(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}function f_(t,e=NaN){return isNaN(parseFloat(t))||isNaN(Number(t))?e:Number(t)}function cB(t,e){wi("NgSignals");const n=function Ln(t){const e=Object.create(ni);e.computation=t;const n=()=>{if(vn(e),qt(e),e.value===st)throw e.error;return e.value};return n[K]=e,n}(t);return e?.equal&&(n[K].equal=e.equal),n}function p_(t){const e=H(null);try{return t()}finally{H(e)}}function uB(t,e,n,i,r,s,o){try{var a=t[s](o),c=a.value}catch(l){return void n(l)}a.done?e(c):Promise.resolve(c).then(i,r)}function ee(t){return function(){var e=this,n=arguments;return new Promise(function(i,r){var s=t.apply(e,n);function o(c){uB(s,i,r,o,a,"next",c)}function a(c){uB(s,i,r,o,a,"throw",c)}o(void 0)})}}const _A={now:()=>(_A.delegate||Date).now(),delegate:void 0};class Os extends de{constructor(e=1/0,n=1/0,i=_A){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){const{isStopped:n,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;n||(i.push(e),!r&&i.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const n=this._innerSubscribe(e),{_infiniteTimeWindow:i,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=i?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){const{_bufferSize:e,_timestampProvider:n,_buffer:i,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<i.length&&i.splice(0,i.length-s),!r){const o=n.now();let a=0;for(let c=1;c<i.length&&i[c]<=o;c+=2)a=c;a&&i.splice(0,a+1)}}}function ze(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}function bA(t,e){return function(n,i){e(n,i,t)}}function Z(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function Aa(t){return this instanceof Aa?(this.v=t,this):new Aa(t)}function pB(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,e=t[Symbol.asyncIterator];return e?e.call(t):(t=function wA(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(s){n[s]=t[s]&&function(o){return new Promise(function(a,c){!function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}(a,c,(o=t[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const AA=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function gB(t){return Fe(t?.then)}function mB(t){return Fe(t[Cl])}function _B(t){return Symbol.asyncIterator&&Fe(t?.[Symbol.asyncIterator])}function yB(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const vB=function Oee(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function bB(t){return Fe(t?.[vB])}function EB(t){return function fB(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),s=[];return r={},a("next"),a("throw"),a("return",function o(f){return function(p){return Promise.resolve(p).then(f,d)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(f,p){i[f]&&(r[f]=function(g){return new Promise(function(m,y){s.push([f,g,m,y])>1||c(f,g)})},p&&(r[f]=p(r[f])))}function c(f,p){try{!function l(f){f.value instanceof Aa?Promise.resolve(f.value.v).then(u,d):h(s[0][2],f)}(i[f](p))}catch(g){h(s[0][3],g)}}function u(f){c("next",f)}function d(f){c("throw",f)}function h(f,p){f(p),s.shift(),s.length&&c(s[0][0],s[0][1])}}(this,arguments,function*(){const n=t.getReader();try{for(;;){const{value:i,done:r}=yield Aa(n.read());if(r)return yield Aa(void 0);yield yield Aa(i)}}finally{n.releaseLock()}})}function wB(t){return Fe(t?.getReader)}function un(t){if(t instanceof ge)return t;if(null!=t){if(mB(t))return function Pee(t){return new ge(e=>{const n=t[Cl]();if(Fe(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(AA(t))return function Nee(t){return new ge(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}(t);if(gB(t))return function Lee(t){return new ge(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Pd)})}(t);if(_B(t))return AB(t);if(bB(t))return function Fee(t){return new ge(e=>{for(const n of t)if(e.next(n),e.closed)return;e.complete()})}(t);if(wB(t))return function Bee(t){return AB(EB(t))}(t)}throw yB(t)}function AB(t){return new ge(e=>{(function kee(t,e){var n,i,r,s;return function dB(t,e,n,i){return new(n||(n=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(d){o(d)}}function c(u){try{l(i.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):function r(s){return s instanceof n?s:new n(function(o){o(s)})}(u.value).then(a,c)}l((i=i.apply(t,e||[])).next())})}(this,void 0,void 0,function*(){try{for(n=pB(t);!(i=yield n.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=n.return)&&(yield s.call(n))}finally{if(r)throw r.error}}e.complete()})})(t,e).catch(n=>e.error(n))})}function Co(t,e,n,i=0,r=!1){const s=e.schedule(function(){n(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(s),!r)return s}function dn(t,e,n=1/0){return Fe(e)?dn((i,r)=>se((s,o)=>e(i,s,r,o))(un(t(i,r))),n):("number"==typeof e&&(n=e),_t((i,r)=>function Uee(t,e,n,i,r,s,o,a){const c=[];let l=0,u=0,d=!1;const h=()=>{d&&!c.length&&!l&&e.complete()},f=g=>l<i?p(g):c.push(g),p=g=>{s&&e.next(g),l++;let m=!1;un(n(g,u++)).subscribe(ot(e,y=>{r?.(y),s?f(y):e.next(y)},()=>{m=!0},void 0,()=>{if(m)try{for(l--;c.length&&l<i;){const y=c.shift();o?Co(e,o,()=>p(y)):p(y)}h()}catch(y){e.error(y)}}))};return t.subscribe(ot(e,f,()=>{d=!0,h()})),()=>{a?.()}}(i,r,t,n)))}function g_(t=1/0){return dn(ps,t)}const Hi=new ge(t=>t.complete());function CB(t){return t&&Fe(t.schedule)}function CA(t){return t[t.length-1]}function TB(t){return Fe(CA(t))?t.pop():void 0}function ff(t){return CB(CA(t))?t.pop():void 0}function SB(t,e=0){return _t((n,i)=>{n.subscribe(ot(i,r=>Co(i,t,()=>i.next(r),e),()=>Co(i,t,()=>i.complete(),e),r=>Co(i,t,()=>i.error(r),e)))})}function xB(t,e=0){return _t((n,i)=>{i.add(t.schedule(()=>n.subscribe(i),e))})}function IB(t,e){if(!t)throw new Error("Iterable cannot be null");return new ge(n=>{Co(n,e,()=>{const i=t[Symbol.asyncIterator]();Co(n,e,()=>{i.next().then(r=>{r.done?n.complete():n.next(r.value)})},0,!0)})})}function Mn(t,e){return e?function Xee(t,e){if(null!=t){if(mB(t))return function zee(t,e){return un(t).pipe(xB(e),SB(e))}(t,e);if(AA(t))return function Wee(t,e){return new ge(n=>{let i=0;return e.schedule(function(){i===t.length?n.complete():(n.next(t[i++]),n.closed||this.schedule())})})}(t,e);if(gB(t))return function Gee(t,e){return un(t).pipe(xB(e),SB(e))}(t,e);if(_B(t))return IB(t,e);if(bB(t))return function $ee(t,e){return new ge(n=>{let i;return Co(n,e,()=>{i=t[vB](),Co(n,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void n.error(o)}s?n.complete():n.next(r)},0,!0)}),()=>Fe(i?.return)&&i.return()})}(t,e);if(wB(t))return function qee(t,e){return IB(EB(t),e)}(t,e)}throw yB(t)}(t,e):un(t)}function Nc(...t){const e=ff(t),n=function Hee(t,e){return"number"==typeof CA(t)?t.pop():e}(t,1/0),i=t;return i.length?1===i.length?un(i[0]):g_(n)(Mn(i,e)):Hi}function hn(t,e){return _t((n,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();n.subscribe(ot(i,c=>{r?.unsubscribe();let l=0;const u=s++;un(t(c,u)).subscribe(r=ot(i,d=>i.next(e?e(c,d,u,l++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}const m_={schedule(t,e){const n=setTimeout(t,e);return()=>clearTimeout(n)},scheduleBeforeRender(t){if(typeof window>"u")return m_.schedule(t,0);if(typeof window.requestAnimationFrame>"u")return m_.schedule(t,16);const e=window.requestAnimationFrame(t);return()=>window.cancelAnimationFrame(e)}};let TA;function ite(t,e,n){let i=n;return function Kee(t){return!!t&&t.nodeType===Node.ELEMENT_NODE}(t)&&e.some((r,s)=>!("*"===r||!function Zee(t,e){if(!TA){const n=Element.prototype;TA=n.matches||n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector}return t.nodeType===Node.ELEMENT_NODE&&TA.call(t,e)}(t,r)||(i=s,0))),i}class ste{constructor(e,n){this.componentFactory=n.get(ua).resolveComponentFactory(e)}create(e){return new ote(this.componentFactory,e)}}class ote{constructor(e,n){this.componentFactory=e,this.injector=n,this.eventEmitters=new Os(1),this.events=this.eventEmitters.pipe(hn(i=>Nc(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(_e),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=m_.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,n,i){this.runInZone(()=>{i&&(n=i.call(this.componentRef?.instance,n)),null!==this.componentRef?function Qee(t,e){return t===e||t!=t&&e!=e}(n,this.getInputValue(e))&&(void 0!==n||!this.unchangedInputs.has(e))||(this.recordInputChange(e,n),this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.instance[e]=n,this.scheduleDetectChanges()):this.initialInputValues.set(e,n)})}initializeComponent(e){const n=lt.create({providers:[],parent:this.injector}),i=function nte(t,e){const n=t.childNodes,i=e.map(()=>[]);let r=-1;e.some((s,o)=>"*"===s&&(r=o,!0));for(let s=0,o=n.length;s<o;++s){const a=n[s],c=ite(a,e,r);-1!==c&&i[c].push(a)}return i}(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(n,i,e),this.viewChangeDetectorRef=this.componentRef.injector.get(lr),this.implementsOnChanges=function Jee(t){return"function"==typeof t}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(ji).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:e,transform:n})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e),n)}),this.initialInputValues.clear()}initializeOutputs(e){const n=this.componentFactory.outputs.map(({propName:i,templateName:r})=>e.instance[i].pipe(se(o=>({name:r,value:o}))));this.eventEmitters.next(n)}callNgOnChanges(e){if(!this.implementsOnChanges||null===this.inputChanges)return;const n=this.inputChanges;this.inputChanges=null,e.instance.ngOnChanges(n)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=m_.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(e,n){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const i=this.inputChanges[e];if(i)return void(i.currentValue=n);const r=this.unchangedInputs.has(e),s=r?void 0:this.getInputValue(e);this.inputChanges[e]=new zD(s,n,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}class ate extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}let MB=null;function Mu(){return MB}class ute{}const Ye=new L("");let DB=(()=>{class t{historyGo(n){throw new Error("")}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:()=>O(dte),providedIn:"platform"})}return t})(),dte=(()=>{class t extends DB{constructor(){super(),this._doc=O(Ye),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Mu().getBaseHref(this._doc)}onPopState(n){const i=Mu().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",n,!1),()=>i.removeEventListener("popstate",n)}onHashChange(n){const i=Mu().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",n,!1),()=>i.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,i,r){this._history.pushState(n,i,r)}replaceState(n,i,r){this._history.replaceState(n,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:()=>new t,providedIn:"platform"})}return t})();function RB(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function OB(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function Lc(t){return t&&"?"!==t[0]?"?"+t:t}let __=(()=>{class t{historyGo(n){throw new Error("")}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:()=>O(fte),providedIn:"root"})}return t})();const hte=new L("");let fte=(()=>{class t extends __{constructor(n,i){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??O(Ye).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return RB(this._baseHref,n)}path(n=!1){const i=this._platformLocation.pathname+Lc(this._platformLocation.search),r=this._platformLocation.hash;return r&&n?`${i}${r}`:i}pushState(n,i,r,s){const o=this.prepareExternalUrl(r+Lc(s));this._platformLocation.pushState(n,i,o)}replaceState(n,i,r,s){const o=this.prepareExternalUrl(r+Lc(s));this._platformLocation.replaceState(n,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static#e=this.\u0275fac=function(i){return new(i||t)(D(DB),D(hte,8))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Fc=(()=>{class t{constructor(n){this._subject=new Pe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const i=this._locationStrategy.getBaseHref();this._basePath=function mte(t){if(new RegExp("^(https?:)?//").test(t)){const[,n]=t.split(/\/\/[^\/]+/);return n}return t}(OB(PB(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,i=""){return this.path()==this.normalize(n+Lc(i))}normalize(n){return t.stripTrailingSlash(function gte(t,e){if(!t||!e.startsWith(t))return e;const n=e.substring(t.length);return""===n||["/",";","?","#"].includes(n[0])?n:e}(this._basePath,PB(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,i="",r=null){this._locationStrategy.pushState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Lc(i)),r)}replaceState(n,i="",r=null){this._locationStrategy.replaceState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Lc(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{const i=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",i){this._urlChangeListeners.forEach(r=>r(n,i))}subscribe(n,i,r){return this._subject.subscribe({next:n,error:i,complete:r})}static#e=this.normalizeQueryParams=Lc;static#t=this.joinWithSlash=RB;static#n=this.stripTrailingSlash=OB;static#i=this.\u0275fac=function(i){return new(i||t)(D(__))};static#r=this.\u0275prov=V({token:t,factory:()=>function pte(){return new Fc(D(__))}(),providedIn:"root"})}return t})();function PB(t){return t.replace(/\/index.html$/,"")}function HB(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const i=n.indexOf("="),[r,s]=-1==i?[n,""]:[n.slice(0,i),n.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}class nne{constructor(e,n,i,r){this.$implicit=e,this.ngForOf=n,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let WB=(()=>{class t{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,i,r){this._viewContainer=n,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const i=this._viewContainer;n.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new nne(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),$B(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}n.forEachIdentityChange(r=>{$B(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(n,i){return!0}static#e=this.\u0275fac=function(i){return new(i||t)(j(Ci),j(Qr),j(fA))};static#t=this.\u0275dir=Xe({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return t})();function $B(t,e){t.context.$implicit=e.item}let FA=(()=>{class t{constructor(n,i){this._viewContainer=n,this._context=new ine,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){qB("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){qB("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,i){return!0}static#e=this.\u0275fac=function(i){return new(i||t)(j(Ci),j(Qr))};static#t=this.\u0275dir=Xe({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return t})();class ine{constructor(){this.$implicit=null,this.ngIf=null}}function qB(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${wn(e)}'.`)}class one{createSubscription(e,n){return p_(()=>e.subscribe({next:n,error:i=>{throw i}}))}dispose(e){p_(()=>e.unsubscribe())}}class ane{createSubscription(e,n){return e.then(n,i=>{throw i})}dispose(e){}}const cne=new ane,lne=new one;let M_=(()=>{class t{constructor(n){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=n}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(n){if(!this._obj){if(n)try{this.markForCheckOnValueUpdate=!1,this._subscribe(n)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return n!==this._obj?(this._dispose(),this.transform(n)):this._latestValue}_subscribe(n){this._obj=n,this._strategy=this._selectStrategy(n),this._subscription=this._strategy.createSubscription(n,i=>this._updateLatestValue(n,i))}_selectStrategy(n){if(Rc(n))return cne;if(hF(n))return lne;throw function ss(t,e){return new $(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(n,i){n===this._obj&&(this._latestValue=i,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static#e=this.\u0275fac=function(i){return new(i||t)(j(lr,16))};static#t=this.\u0275pipe=ri({name:"async",type:t,pure:!1,standalone:!0})}return t})(),KB=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Tr({type:t});static#n=this.\u0275inj=tr({})}return t})();const JB="browser";function Ca(t){return t===JB}function jA(t){return"server"===t}class ZB{}class nie extends ute{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class WA extends nie{static makeCurrent(){!function lte(t){MB??=t}(new WA)}onAndCancel(e,n,i){return e.addEventListener(n,i),()=>{e.removeEventListener(n,i)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.remove()}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=function iie(){return _f=_f||document.querySelector("base"),_f?_f.getAttribute("href"):null}();return null==n?null:function rie(t){return new URL(t,document.baseURI).pathname}(n)}resetBaseElement(){_f=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return HB(document.cookie,e)}}let _f=null,oie=(()=>{class t{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})();const P_=new L("");let ck=(()=>{class t{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(r=>{r.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,r){return this._findPluginFor(i).addEventListener(n,i,r)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(s=>s.supports(n)),!i)throw new $(5101,!1);return this._eventNameToPlugin.set(n,i),i}static#e=this.\u0275fac=function(i){return new(i||t)(D(P_),D(_e))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})();class $A{constructor(e){this._doc=e}}const qA="ng-app-id";let lk=(()=>{class t{constructor(n,i,r,s={}){this.doc=n,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=jA(s),this.resetHostNodes()}addStyles(n){for(const i of n)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(n){for(const i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){const i=this.styleRef;i.get(n)?.elements?.forEach(r=>r.remove()),i.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${qA}="${this.appId}"]`);if(n?.length){const i=new Map;return n.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(n,i){const r=this.styleRef;if(r.has(n)){const s=r.get(n);return s.usage+=i,s.usage}return r.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===n)return r.delete(i),s.removeAttribute(qA),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(qA,this.appId),n.appendChild(o),o}}addStyleToHost(n,i){const r=this.getStyleElement(n,i),s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||t)(D(Ye),D(Jl),D(K0,8),D(Mr))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})();const XA={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},YA=/%COMP%/g,uie=new L("",{providedIn:"root",factory:()=>!0});function dk(t,e){return e.map(n=>n.replace(YA,t))}let hk=(()=>{class t{constructor(n,i,r,s,o,a,c,l=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=jA(a),this.defaultRenderer=new KA(n,o,c,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===qr.ShadowDom&&(i={...i,encapsulation:qr.Emulated});const r=this.getOrCreateRenderer(n,i);return r instanceof pk?r.applyToHost(n):r instanceof JA&&r.applyStyles(),r}getOrCreateRenderer(n,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(i.encapsulation){case qr.Emulated:s=new pk(c,l,i,this.appId,u,o,a,d);break;case qr.ShadowDom:return new pie(c,l,n,i,o,a,this.nonce,d);default:s=new JA(c,l,i,u,o,a,d)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||t)(D(ck),D(lk),D(Jl),D(uie),D(Ye),D(Mr),D(_e),D(K0))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})();class KA{constructor(e,n,i,r){this.eventManager=e,this.doc=n,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(XA[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(fk(e)?e.content:e).appendChild(n)}insertBefore(e,n,i){e&&(fk(e)?e.content:e).insertBefore(n,i)}removeChild(e,n){n.remove()}selectRootElement(e,n){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new $(-5104,!1);return n||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,i,r){if(r){n=r+":"+n;const s=XA[r];s?e.setAttributeNS(s,n,i):e.setAttribute(n,i)}else e.setAttribute(n,i)}removeAttribute(e,n,i){if(i){const r=XA[i];r?e.removeAttributeNS(r,n):e.removeAttribute(`${i}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,i,r){r&(la.DashCase|la.Important)?e.style.setProperty(n,i,r&la.Important?"important":""):e.style[n]=i}removeStyle(e,n,i){i&la.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,i){null!=e&&(e[n]=i)}setValue(e,n){e.nodeValue=n}listen(e,n,i){if("string"==typeof e&&!(e=Mu().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(i))}decoratePreventDefault(e){return n=>{if("__ngUnwrap__"===n)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))&&n.preventDefault()}}}function fk(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class pie extends KA{constructor(e,n,i,r,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=n,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=dk(r.id,r.styles);for(const u of l){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,i){return super.insertBefore(this.nodeOrShadowRoot(e),n,i)}removeChild(e,n){return super.removeChild(null,n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class JA extends KA{constructor(e,n,i,r,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=r,this.styles=c?dk(c,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class pk extends JA{constructor(e,n,i,r,s,o,a,c){const l=r+"-"+i.id;super(e,n,i,s,o,a,c,l),this.contentAttr=function die(t){return"_ngcontent-%COMP%".replace(YA,t)}(l),this.hostAttr=function hie(t){return"_nghost-%COMP%".replace(YA,t)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){const i=super.createElement(e,n);return super.setAttribute(i,this.contentAttr,""),i}}let gie=(()=>{class t extends $A{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,r){return n.addEventListener(i,r,!1),()=>this.removeEventListener(n,i,r)}removeEventListener(n,i,r){return n.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||t)(D(Ye))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})(),mie=(()=>{class t extends $A{constructor(n){super(n),this.delegate=O(ZF,{optional:!0})}supports(n){return!!this.delegate&&this.delegate.supports(n)}addEventListener(n,i,r){return this.delegate.addEventListener(n,i,r)}removeEventListener(n,i,r){return this.delegate.removeEventListener(n,i,r)}static#e=this.\u0275fac=function(i){return new(i||t)(D(Ye))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})();const gk=["alt","control","meta","shift"],_ie={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},yie={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let vie=(()=>{class t extends $A{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,i,r){const s=t.parseEventName(i),o=t.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Mu().onAndCancel(n,s.domEventName,o))}static parseEventName(n){const i=n.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=t._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),gk.forEach(l=>{const u=i.indexOf(l);u>-1&&(i.splice(u,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const c={};return c.domEventName=r,c.fullKey=o,c}static matchEventFullKeyCode(n,i){let r=_ie[n.key]||n.key,s="";return i.indexOf("code.")>-1&&(r=n.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),gk.forEach(o=>{o!==r&&(0,yie[o])(n)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(n,i,r){return s=>{t.matchEventFullKeyCode(s,n)&&r.runGuarded(()=>i(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}static#e=this.\u0275fac=function(i){return new(i||t)(D(Ye))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})();const Cie=[{provide:Mr,useValue:JB},{provide:lR,useValue:function Eie(){WA.makeCurrent()},multi:!0},{provide:Ye,useFactory:function Aie(){return function JW(t){Y0=t}(document),document},deps:[]}],Tie=new L(""),_k=[{provide:e_,useClass:class sie{addToWindow(e){Et.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new $(5103,!1);return s},Et.getAllAngularTestabilities=()=>e.getAllTestabilities(),Et.getAllAngularRootElements=()=>e.getAllRootElements(),Et.frameworkStabilizers||(Et.frameworkStabilizers=[]),Et.frameworkStabilizers.push(i=>{const r=Et.getAllAngularTestabilities();let s=r.length;const o=function(){s--,0==s&&i()};r.forEach(a=>{a.whenStable(o)})})}findTestabilityInTree(e,n,i){return null==n?null:e.getTestability(n)??(i?Mu().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},deps:[]},{provide:dF,useClass:tA,deps:[_e,nA,e_]},{provide:tA,useClass:tA,deps:[_e,nA,e_]}],yk=[{provide:l0,useValue:"root"},{provide:Ni,useFactory:function wie(){return new Ni},deps:[]},{provide:P_,useClass:gie,multi:!0,deps:[Ye,_e,Mr]},{provide:P_,useClass:vie,multi:!0,deps:[Ye]},{provide:P_,useClass:mie,multi:!0},hk,lk,ck,{provide:JE,useExisting:hk},{provide:ZB,useClass:oie,deps:[]},[]];let Sie=(()=>{class t{constructor(n){}static withServerTransition(n){return{ngModule:t,providers:[{provide:Jl,useValue:n.appId}]}}static#e=this.\u0275fac=function(i){return new(i||t)(D(Tie,12))};static#t=this.\u0275mod=Tr({type:t});static#n=this.\u0275inj=tr({providers:[...yk,..._k],imports:[KB,IQ]})}return t})(),yf=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:function(i){let r=null;return r=i?new(i||t):D(Rie),r},providedIn:"root"})}return t})(),Rie=(()=>{class t extends yf{constructor(n){super(),this._doc=n}sanitize(n,i){if(null==i)return null;switch(n){case $n.NONE:return i;case $n.HTML:return Ts(i,"HTML")?sr(i):OR(this._doc,String(i)).toString();case $n.STYLE:return Ts(i,"Style")?sr(i):i;case $n.SCRIPT:if(Ts(i,"Script"))return sr(i);throw new $(5200,!1);case $n.URL:return Ts(i,"URL")?sr(i):lm(String(i));case $n.RESOURCE_URL:if(Ts(i,"ResourceURL"))return sr(i);throw new $(5201,!1);default:throw new $(5202,!1)}}bypassSecurityTrustHtml(n){return function y$(t){return new h$(t)}(n)}bypassSecurityTrustStyle(n){return function v$(t){return new f$(t)}(n)}bypassSecurityTrustScript(n){return function b$(t){return new p$(t)}(n)}bypassSecurityTrustUrl(n){return function E$(t){return new g$(t)}(n)}bypassSecurityTrustResourceUrl(n){return function w$(t){return new m$(t)}(n)}static#e=this.\u0275fac=function(i){return new(i||t)(D(Ye))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Ou=Ko(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function ht(t,e){return _t((n,i)=>{let r=0;n.subscribe(ot(i,s=>t.call(e,s,r++)&&i.next(s)))})}function os(t){return!!t&&(t instanceof ge||Fe(t.lift)&&Fe(t.subscribe))}const L_={schedule(t,e){const n=setTimeout(t,e);return()=>clearTimeout(n)},scheduleBeforeRender(t){if(typeof window>"u")return L_.schedule(t,0);if(typeof window.requestAnimationFrame>"u")return L_.schedule(t,16);const e=window.requestAnimationFrame(t);return()=>window.cancelAnimationFrame(e)}};let ZA;function Hie(t,e,n){let i=n;return function kie(t){return!!t&&t.nodeType===Node.ELEMENT_NODE}(t)&&e.some((r,s)=>!("*"===r||!function Uie(t,e){if(!ZA){const n=Element.prototype;ZA=n.matches||n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector}return t.nodeType===Node.ELEMENT_NODE&&ZA.call(t,e)}(t,r)||(i=s,0))),i}class Gie{constructor(e){this.component=e}create(e){return new Wie(this.component,e)}}class Wie{constructor(e,n){this.component=e,this.injector=n,this.eventEmitters=new Os(1),this.events=this.eventEmitters.pipe(hn(i=>Nc(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.hasInputChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.componentMirror=function fee(t){const e=je(t);if(!e)return null;const n=new Uh(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(this.component),this.unchangedInputs=new Set(this.componentMirror.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(_e),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=L_.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>{if(null===this.componentRef)return this.initialInputValues.get(e);const n=this.componentRef.instance[e];return function Vh(t){return"function"==typeof t&&void 0!==t[K]}(n)?n():n})}setInputValue(e,n,i){this.runInZone(()=>{i&&(n=i.call(this.componentRef?.instance,n)),null!==this.componentRef?function Vie(t,e){return t===e||t!=t&&e!=e}(n,this.getInputValue(e))&&(void 0!==n||!this.unchangedInputs.has(e))||(this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.setInput(e,n),this.scheduleDetectChanges()):this.initialInputValues.set(e,n)})}initializeComponent(e){const n=this.injector.get(oi),i=lt.create({providers:[],parent:this.injector}),r=function jie(t,e){const n=t.childNodes,i=e.map(()=>[]);let r=-1;e.some((s,o)=>"*"===s&&(r=o,!0));for(let s=0,o=n.length;s<o;++s){const a=n[s],c=Hie(a,e,r);-1!==c&&i[c].push(a)}return i}(e,[...this.componentMirror.ngContentSelectors]);this.componentRef=function hee(t,e){const n=je(t),i=e.elementInjector||Og();return new Uh(n).create(i,e.projectableNodes,e.hostElement,e.environmentInjector)}(this.component,{environmentInjector:n,elementInjector:i,projectableNodes:r,hostElement:e}),this.viewChangeDetectorRef=this.componentRef.injector.get(lr),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(ji).attachView(this.componentRef.hostView)}initializeInputs(){this.componentMirror.inputs.forEach(({propName:e,transform:n})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e),n)}),this.initialInputValues.clear()}initializeOutputs(e){const n=this.componentMirror.outputs.map(({propName:i,templateName:r})=>{const s=e.instance[i];return(os(s)?s:function Nie(t){const e=function IW(t){return t.destroyRef}(t);return new ge(n=>{e?.onDestroy(()=>n.complete());const i=t.subscribe(r=>n.next(r));return()=>i.unsubscribe()})}(s)).pipe(se(a=>({name:r,value:a})))});this.eventEmitters.next(n)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=L_.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}detectChanges(){null!==this.componentRef&&(this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}function QA(){return(QA=ee(function*(t,e,n){const{injector:i}=yield function bie(t){return VQ(function mk(t){return{appProviders:[...yk,...t?.providers??[]],platformProviders:Cie}}(t))}(n),o=function $ie(t,e){return class extends t{whenStable(){return ee(function*(){const i=e.get(ji);yield function Oie(t,e){const n="object"==typeof e;return new Promise((i,r)=>{const s=new uo({next:o=>{i(o),s.unsubscribe()},error:r,complete:()=>{n?i(e.defaultValue):r(new Ou)}});t.subscribe(s)})}(i.isStable.pipe(ht(r=>r)))})()}}}(function cte(t,e){const n=function tte(t,e){return e.get(ua).resolveComponentFactory(t).inputs}(t,e.injector),i=e.strategyFactory||new ste(t,e.injector),r=function ete(t){const e={};return t.forEach(({propName:n,templateName:i,transform:r})=>{e[function Yee(t){return t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}(i)]=[n,r]}),e}(n);class s extends ate{static#e=this.observedAttributes=Object.keys(r);get ngElementStrategy(){if(!this._ngElementStrategy){const a=this._ngElementStrategy=i.create(this.injector||e.injector);n.forEach(({propName:c,transform:l})=>{if(!this.hasOwnProperty(c))return;const u=this[c];delete this[c],a.setInputValue(c,u,l)})}return this._ngElementStrategy}constructor(a){super(),this.injector=a}attributeChangedCallback(a,c,l,u){const[d,h]=r[a];this.ngElementStrategy.setInputValue(d,l,h)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{const c=new CustomEvent(a.name,{detail:a.value});this.dispatchEvent(c)})}}return n.forEach(({propName:o,transform:a})=>{Object.defineProperty(s.prototype,o,{get(){return this.ngElementStrategy.getInputValue(o)},set(c){this.ngElementStrategy.setInputValue(o,c,a)},configurable:!0,enumerable:!0})}),s}(e,{injector:i,strategyFactory:new Gie(e)}),i);return customElements.define(t,o),o})).apply(this,arguments)}let Xie=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Tr({type:t});static#n=this.\u0275inj=tr({imports:[KB]})}return t})();function Pu(t){return!0===t}function zi(t){return null===t||typeof t>"u"}function di(t){return!zi(t)}function eC(t){return!!t}function xk(t){return zi(t)?t:JSON.parse(JSON.stringify(t))}function Ik(t){return di(t)&&"object"==typeof t&&function tC(t){return"[object Object]"===Object.prototype.toString.call(t)}(t)}new L("Maximum number of autocomplete options displayed",{providedIn:"root",factory:()=>10}),qe(123),[{src:"app:skin",organ:"Skin",name:"Skin",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002097"},{src:"app:brain",organ:"Brain",name:"Brain",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000955"},{disabled:!0,src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002509"},{disabled:!0,src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000970"},{src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004548"},{src:"app:eye",organ:"Eye",name:"Eye, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004549"},{disabled:!0,src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0003889"},{src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001303"},{src:"app:fallopian-tube-right",organ:"Fallopian Tube",name:"Fallopian Tube, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001302"},{src:"app:heart",organ:"Heart",name:"Heart",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000948"},{disabled:!0,src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002113"},{src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004538"},{src:"app:kidney-right",organ:"Kidney",name:"Kidney, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004539"},{disabled:!0,src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001465"},{src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.org/sig/ont/fma/fma24978"},{src:"app:knee",organ:"Knee",name:"Knee, R",side:"right",hasSex:!0,id:"http://purl.org/sig/ont/fma/fma24977"},{src:"app:liver",organ:"Liver",name:"Liver",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002107"},{disabled:!0,src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002048"},{src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001004"},{disabled:!0,src:"app:mammary-gland",organ:"Mammary Gland",name:"Mammary Gland, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001911"},{src:"app:mammary-gland",organ:"Mammary Gland",name:"Mammary Gland, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma57991"},{src:"app:mammary-gland",organ:"Mammary Gland",name:"Mammary Gland, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma57987"},{disabled:!0,src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000992"},{src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma7214"},{src:"app:ovary-right",organ:"Ovary",name:"Ovary, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma7213"},{src:"app:larynx",organ:"Larynx",name:"Larynx",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001737"},{src:"app:main-bronchus",organ:"Main Bronchus",name:"Main Bronchus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002182"},{disabled:!0,src:"app:palatine-tonsil",organ:"Palatine Tonsil",name:"Palatine Tonsil, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002373"},{src:"app:palatine-tonsil",organ:"Palatine Tonsil",name:"Palatine Tonsil, L",side:"left",hasSex:!0,id:"http://purl.org/sig/ont/fma/fma54974"},{src:"app:palatine-tonsil",organ:"Palatine Tonsil",name:"Palatine Tonsil, R",side:"right",hasSex:!0,id:"http://purl.org/sig/ont/fma/fma54973"},{src:"app:pancreas",organ:"Pancreas",name:"Pancreas",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001264"},{src:"app:pelvis-f",organ:"Pelvis",name:"Pelvis",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001270"},{src:"app:placenta",organ:"Placenta",name:"Placenta",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001987"},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0002367",disabled:!0},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0000079"},{src:"app:small-intestine",organ:"Small Intestine",name:"Small Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002108"},{src:"app:large-intestine",organ:"Large Intestine",name:"Large Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000059"},{src:"app:spinal-cord",organ:"Spinal Cord",name:"Spinal Cord",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002240"},{src:"app:spleen",organ:"Spleen",name:"Spleen",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002106"},{src:"app:thymus",organ:"Thymus",name:"Thymus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002370"},{src:"app:trachea",organ:"Trachea",name:"Trachea",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0003126"},{disabled:!0,src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000056"},{src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001223"},{src:"app:ureter-right",organ:"Ureter",name:"Ureter, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001222"},{src:"app:bladder",organ:"Urinary Bladder",name:"Urinary Bladder",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001255"},{src:"app:uterus",organ:"Uterus",name:"Uterus",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000995"},{src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004537"},{disabled:!0,src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002049"}].sort((t,e)=>t.name.localeCompare(e.name)).filter(t=>!0!==t.disabled);const{isArray:vre}=Array,{getPrototypeOf:bre,prototype:Ere,keys:wre}=Object;function Rk(t){if(1===t.length){const e=t[0];if(vre(e))return{args:e,keys:null};if(function Are(t){return t&&"object"==typeof t&&bre(t)===Ere}(e)){const n=wre(e);return{args:n.map(i=>e[i]),keys:n}}}return{args:t,keys:null}}const{isArray:Cre}=Array;function V_(t){return se(e=>function Tre(t,e){return Cre(e)?t(...e):t(e)}(t,e))}function Ok(t,e){return t.reduce((n,i,r)=>(n[i]=e[r],n),{})}function j_(...t){const e=TB(t),{args:n,keys:i}=Rk(t),r=new ge(s=>{const{length:o}=n;if(!o)return void s.complete();const a=new Array(o);let c=o,l=o;for(let u=0;u<o;u++){let d=!1;un(n[u]).subscribe(ot(s,h=>{d||(d=!0,l--),a[u]=h},()=>c--,void 0,()=>{(!c||!d)&&(l||s.next(i?Ok(i,a):a),s.complete())}))}});return e?r.pipe(V_(e)):r}function ne(...t){return Mn(t,ff(t))}function Ta(t,e){const n=Fe(t)?t:()=>t,i=r=>r.error(n());return new ge(e?r=>e.schedule(i,0,r):i)}function xo(t={}){const{connector:e=()=>new de,resetOnError:n=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=t;return s=>{let o,a,c,l=0,u=!1,d=!1;const h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=c=void 0,u=d=!1},p=()=>{const g=o;f(),g?.unsubscribe()};return _t((g,m)=>{l++,!d&&!u&&h();const y=c=c??e();m.add(()=>{l--,0===l&&!d&&!u&&(a=nC(p,r))}),y.subscribe(m),!o&&l>0&&(o=new uo({next:v=>y.next(v),error:v=>{d=!0,h(),a=nC(f,n,v),y.error(v)},complete:()=>{u=!0,h(),a=nC(f,i),y.complete()}}),un(g).subscribe(o))})(s)}}function nC(t,e,...n){if(!0===e)return void t();if(!1===e)return;const i=new uo({next:()=>{i.unsubscribe(),t()}});return un(e(...n)).subscribe(i)}function dr(t,e,n){let i,r=!1;return t&&"object"==typeof t?({bufferSize:i=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:n}=t):i=t??1/0,xo({connector:()=>new Os(i,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}function Ps(t){return _t((e,n)=>{let s,i=null,r=!1;i=e.subscribe(ot(n,void 0,void 0,o=>{s=un(t(o,Ps(t)(e))),i?(i.unsubscribe(),i=null,s.subscribe(n)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(n))})}function bf(t,e=ps){return t=t??Sre,_t((n,i)=>{let r,s=!0;n.subscribe(ot(i,o=>{const a=e(o);(s||!t(r,a))&&(s=!1,r=a,i.next(o))}))})}function Sre(t,e){return t===e}function Dn(t){return t<=0?()=>Hi:_t((e,n)=>{let i=0;e.subscribe(ot(n,r=>{++i<=t&&(n.next(r),t<=i&&n.complete())}))})}const Io="NGXS_META",Pk="NGXS_OPTIONS_META",iC="NGXS_SELECTOR_META";function Nk(t){if(!t.hasOwnProperty(Io)){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:n=>n.getStateGetter(e.name),children:[]};Object.defineProperty(t,Io,{value:e})}return Ef(t)}function Ef(t){return t[Io]}function Fk(t){return t[iC]}function xre(t,e){return t===e}function rC(t,e=xre){let n=null,i=null;function r(){return function Ire(t,e,n){if(null===e||null===n||e.length!==n.length)return!1;const i=e.length;for(let r=0;r<i;r++)if(!t(e[r],n[r]))return!1;return!0}(e,n,arguments)||(i=t.apply(null,arguments)),n=arguments,i}return r.reset=function(){n=null,i=null},r}let Dre=(()=>{class t{static#e=this._value={};static set(n){this._value=n}static pop(){const n=this._value;return this._value={},n}}return t})();const Bk=new L("",{providedIn:"root",factory:()=>Dre.pop()});let kk=(()=>{class t extends Os{constructor(){super(1)}bootstrap(){this.next(!0),this.complete()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Vk=new L(""),jk=new L("");function Hk(t){const e=[];let n=!1;return function(...r){if(n)e.unshift(r);else{for(n=!0,t(...r);e.length>0;){const s=e.pop();s&&t(...s)}n=!1}}}class Rre extends de{constructor(){super(...arguments),this._orderedNext=Hk(e=>super.next(e))}next(e){this._orderedNext(e)}}class Ore extends on{constructor(e){super(e),this._orderedNext=Hk(n=>super.next(n)),this._currentValue=e}getValue(){return this._currentValue}next(e){this._currentValue=e,this._orderedNext(e)}}function zk(t){return e=>new ge(n=>e.subscribe({next(i){t(()=>n.next(i))},error(i){t(()=>n.error(i))},complete(){t(()=>n.complete())}}))}let sC=(()=>{class t extends Ore{constructor(){super({}),this.state=function wk(t,e){const n=!e?.manualCleanup;n&&!e?.injector&&Qd();const i=n?e?.injector?.get(gc)??O(gc):null,r=function Fie(t=Object.is){return(e,n)=>1===e.kind&&1===n.kind&&t(e.value,n.value)}(e?.equal);let s;s=uw(e?.requireSync?{kind:0}:{kind:1,value:e?.initialValue},{equal:r});const o=t.subscribe({next:a=>s.set({kind:1,value:a}),error:a=>{if(e?.rejectErrors)throw a;s.set({kind:2,error:a})}});if(e?.requireSync&&0===s().kind)throw new $(601,!1);return i?.onDestroy(o.unsubscribe.bind(o)),cB(()=>{const a=s();switch(a.kind){case 1:return a.value;case 2:throw a.error;case 0:throw new $(601,!1)}},{equal:e?.equal})}(this.pipe(zk(p_)),{manualCleanup:!0,requireSync:!0})}ngOnDestroy(){this.complete()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Gk(t,e){return e?n=>n.pipe(Gk((i,r)=>un(t(i,r)).pipe(se((s,o)=>e(i,s,r,o))))):_t((n,i)=>{let r=0,s=null,o=!1;n.subscribe(ot(i,a=>{s||(s=ot(i,void 0,()=>{s=null,o&&i.complete()}),un(t(a,r++)).subscribe(s))},()=>{o=!0,!s&&i.complete()}))})}function Nu(t){return _t((e,n)=>{let i=!1;e.subscribe(ot(n,r=>{i=!0,n.next(r)},()=>{i||n.next(t),n.complete()}))})}function Ns(t){return _t((e,n)=>{un(t).subscribe(ot(n,()=>n.complete(),nc)),!n.closed&&e.subscribe(n)})}function At(t,e,n){const i=Fe(t)||e||n?{next:t,error:e,complete:n}:t;return i?_t((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(ot(s,c=>{var l;null===(l=i.next)||void 0===l||l.call(i,c),s.next(c)},()=>{var c;a=!1,null===(c=i.complete)||void 0===c||c.call(i),s.complete()},c=>{var l;a=!1,null===(l=i.error)||void 0===l||l.call(i,c),s.error(c)},()=>{var c,l;a&&(null===(c=i.unsubscribe)||void 0===c||c.call(i)),null===(l=i.finalize)||void 0===l||l.call(i)}))}):ps}function wf(...t){return function Pre(){return g_(1)}()(Mn(t,ff(t)))}function Sa(...t){const e=ff(t);return _t((n,i)=>{(e?wf(t,n,e):wf(t,n)).subscribe(i)})}let oC=(()=>{class t{static#e=this.type="@@INIT"}return t})(),aC=(()=>{class t{static#e=this.type="@@UPDATE_STATE";constructor(n){this.addedStates=n}}return t})();const Wk=new L("");function kc(t){return t.constructor?.type||t.type}const $k=(t,e,n)=>{t={...t};const i=e.split("."),r=i.length-1;return i.reduce((s,o,a)=>(s[o]=a===r?n:Array.isArray(s[o])?s[o].slice():{...s[o]},s&&s[o]),t),t},cC=(t,e)=>e.split(".").reduce((n,i)=>n&&n[i],t);let Bre=(()=>{class t{enter(n){return n()}leave(n){return n()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Jk=(()=>{class t{constructor(n,i){this._ngZone=n,this._platformId=i}enter(n){return jA(this._platformId)?this.runInsideAngular(n):this.runOutsideAngular(n)}leave(n){return this.runInsideAngular(n)}runInsideAngular(n){return _e.isInAngularZone()?n():this._ngZone.run(n)}runOutsideAngular(n){return _e.isInAngularZone()?this._ngZone.runOutsideAngular(n):n()}static#e=this.\u0275fac=function(i){return new(i||t)(D(_e),D(Mr))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Qk=new L(""),$re=new L("",{providedIn:"root",factory:()=>{const t=O(_e),e=O(Sg),n=e.get(Qk);return e.get(n||(t instanceof _e?Jk:Bre))}});let e2=(()=>{class t{constructor(n){this._executionStrategy=n}enter(n){return this._executionStrategy.enter(n)}leave(n){return this._executionStrategy.leave(n)}static#e=this.\u0275fac=function(i){return new(i||t)(D($re))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const t2=t=>(...e)=>t.shift()(...e,(...i)=>t2(t)(...i));function z_(t){return zk(e=>t.leave(e))}let n2=(()=>{class t extends Rre{ngOnDestroy(){this.complete()}static#e=this.\u0275fac=(()=>{let n;return function(r){return(n||(n=Cs(t)))(r||t)}})();static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),uC=(()=>{class t{constructor(n,i){this._parentManager=n,this._pluginHandlers=i,this.plugins=[],this.registerHandlers()}get rootPlugins(){return this._parentManager&&this._parentManager.plugins||this.plugins}registerHandlers(){const n=this.getPluginHandlers();this.rootPlugins.push(...n)}getPluginHandlers(){return(this._pluginHandlers||[]).map(i=>i.handle?i.handle.bind(i):i)}static#e=this.\u0275fac=function(i){return new(i||t)(D(t,12),D(Wk,8))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})();const dC=new WeakMap,r2=Er.onUnhandledError;Er.onUnhandledError=function(t){const e=dC.get(t);if(e)e();else{if(!r2)throw t;r2.call(this,t)}};let s2=(()=>{class t extends de{static#e=this.\u0275fac=(()=>{let n;return function(r){return(n||(n=Cs(t)))(r||t)}})();static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Kre=(()=>{class t{constructor(n,i,r,s,o,a){this._ngZone=n,this._actions=i,this._actionResults=r,this._pluginManager=s,this._stateStream=o,this._ngxsExecutionStrategy=a}dispatch(n){return this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(n)).pipe(function Yre(t){return e=>{let n=e.subscribe({error:i=>{t.runOutsideAngular(()=>{queueMicrotask(()=>{n&&function qre(t){const e=dC.get(t);e&&e()}(i)})})}});return new ge(i=>(n?.unsubscribe(),n=null,e.subscribe(i)))}}(this._ngZone),z_(this._ngxsExecutionStrategy))}dispatchByEvents(n){return Array.isArray(n)?0===n.length?ne(void 0):j_(n.map(i=>this.dispatchSingle(i))).pipe(se(()=>{})):this.dispatchSingle(n)}dispatchSingle(n){const i=this._stateStream.getValue();return t2([...this._pluginManager.plugins,(s,o)=>{s!==i&&this._stateStream.next(s);const a=this.getActionResultStream(o);return a.subscribe(c=>this._actions.next(c)),this._actions.next({action:o,status:"DISPATCHED"}),this.createDispatchObservable(a)}])(i,n).pipe(dr())}getActionResultStream(n){return this._actionResults.pipe(ht(i=>i.action===n&&"DISPATCHED"!==i.status),Dn(1),dr())}createDispatchObservable(n){return n.pipe(Gk(i=>{switch(i.status){case"SUCCESSFUL":return ne(this._stateStream.getValue());case"ERRORED":return Ta(()=>i.error);default:return Hi}})).pipe(dr())}static#e=this.\u0275fac=function(i){return new(i||t)(D(_e),D(n2),D(s2),D(uC),D(sC),D(e2))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const o2=new L(""),a2=new L(""),c2=new L("");let Af=(()=>{class t{constructor(){this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=Jk,this.selectorOptions={injectContainerState:!1,suppressErrors:!1}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:()=>(()=>{const n=new t,i=O(c2);return{...n,...i,selectorOptions:{...n.selectorOptions,...i.selectorOptions}}})(),providedIn:"root"})}return t})();class Jre{constructor(e,n,i){this.previousValue=e,this.currentValue=n,this.firstChange=i}}let Cf=(()=>{class t{constructor(n,i,r){this._stateStream=n,this._dispatcher=i,this._config=r}getRootStateOperations(){return{getState:()=>this._stateStream.getValue(),setState:i=>this._stateStream.next(i),dispatch:i=>this._dispatcher.dispatch(i)}}setStateToTheCurrentWithNew(n){const i=this.getRootStateOperations(),r=i.getState();i.setState({...r,...n.defaults})}static#e=this.\u0275fac=function(i){return new(i||t)(D(sC),D(Kre),D(Af))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Zre=!1;function u2(t){const e=Fk(t)||Ef(t);return e&&e.makeRootSelector||(()=>t)}function d2(t){return e=>{for(let n=0;n<t.length;n++){if(!e)return;e=e[t[n]]}return e}}function h2(t){const e=t;let n="store."+e[0],i=0;const r=e.length;let s=n;for(;++i<r;)s=s+" && "+(n=n+"."+e[i]);return new Function("store","return "+s+";")}const rse=new L("",{providedIn:"root",factory:()=>O(Af).compatibility?.strictContentSecurityPolicy?d2:h2});function lse(...t){return function Lu(t,e,n=dse){const i=function hse(t){return t.reduce((e,n)=>(e[kc(n)]=!0,e),{})}(t),r=e&&function fse(t){return t.reduce((e,n)=>(e[n]=!0,e),{})}(e);return function(s){return s.pipe(function use(t,e){return ht(n=>{const i=kc(n.action);return t[i]&&(!e||e[n.status])})}(i,r),n())}}(t,["DISPATCHED"])}function dse(){return se(t=>t.action)}let pC=(()=>{class t{constructor(n){this._internalStateOperations=n}createStateContext(n){const i=this._internalStateOperations.getRootStateOperations();return{getState:()=>m2(i.getState(),n.path),patchState(r){const s=i.getState(),o=function pse(t){return e=>{const n={...e};for(const i in t)n[i]=t[i];return n}}(r);g2(i,s,o,n.path)},setState(r){const s=i.getState();!function H_(t){return"function"==typeof t}(r)?p2(i,s,r,n.path):g2(i,s,r,n.path)},dispatch:r=>i.dispatch(r)}}static#e=this.\u0275fac=function(i){return new(i||t)(D(Cf))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function p2(t,e,n,i){const r=$k(e,i,n);return t.setState(r),r}function g2(t,e,n,i){return p2(t,e,n(m2(e,i)),i)}function m2(t,e){return cC(t,e)}new RegExp("^[a-zA-Z0-9_]+$"),new L("",{providedIn:"root",factory:()=>({warnOnUnhandledActions:!0})});let wse=(()=>{class t{constructor(){this._ngZone=O(_e),this._errorHandler=O(Ni)}handleError(n,i){this._ngZone.runOutsideAngular(()=>this._errorHandler.handleError(n))}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Ase(t){let e=void 0===t?{}:t;return t&&(Array.isArray(t)?e=t.slice():"object"==typeof t&&(e={...t})),e}let Fu=(()=>{class t{constructor(n,i,r,s,o,a,c){this._injector=n,this._config=i,this._parentFactory=r,this._actions=s,this._actionResults=o,this._stateContextFactory=a,this._initialState=c,this._actionsSubscription=null,this._propGetter=O(rse),this._ngxsUnhandledErrorHandler=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=rC(()=>{const l=this,u=l._propGetter;return this._parentFactory?this._parentFactory.getRuntimeSelectorContext():{getStateGetter(f){let p=function d(f){const p=l.statePaths[f];return p?u(p.split(".")):null}(f);return p||((...g)=>(p||(p=function d(f){const p=l.statePaths[f];return p?u(p.split(".")):null}(f)),p?p(...g):void 0))},getSelectorOptions:f=>({...l._config.selectorOptions,...f||{}})}})}get states(){return this._parentFactory?this._parentFactory.states:this._states}get statesByName(){return this._parentFactory?this._parentFactory.statesByName:this._statesByName}get statePaths(){return this._parentFactory?this._parentFactory.statePaths:this._statePaths}ngOnDestroy(){this._actionsSubscription?.unsubscribe()}add(n){const{newStates:i}=this.addToStatesMap(n);if(!i.length)return[];const r=function sse(t){const e=n=>{const i=t.find(r=>r===n);return i[Io].name};return t.reduce((n,i)=>{const{name:r,children:s}=i[Io];return n[r]=(s||[]).map(e),n},{})}(i),s=function cse(t){const e=[],n={},i=(r,s=[])=>{Array.isArray(s)||(s=[]),s.push(r),n[r]=!0,t[r].forEach(o=>{n[o]||i(o,s.slice(0))}),e.indexOf(r)<0&&e.push(r)};return Object.keys(t).forEach(r=>i(r)),e.reverse()}(r),o=function ase(t,e={}){const n=(i,r)=>{for(const s in i)if(i.hasOwnProperty(s)&&i[s].indexOf(r)>=0){const o=n(i,s);return null!==o?`${o}.${s}`:s}return null};for(const i in t)if(t.hasOwnProperty(i)){const r=n(t,i);e[i]=r?`${r}.${i}`:i}return e}(r),a=function ose(t){return t.reduce((e,n)=>(e[n[Io].name]=n,e),{})}(i),c=[];for(const l of s){const u=a[l],d=o[l],h=u[Io];this.addRuntimeInfoToMeta(h,d);const f={name:l,path:d,isInitialised:!1,actions:h.actions,instance:this._injector.get(u),defaults:Ase(h.defaults)};this.hasBeenMountedAndBootstrapped(l,d)||c.push(f),this.states.push(f)}return c}addAndReturnDefaults(n){const r=this.add(n||[]);return{defaults:r.reduce((o,a)=>$k(o,a.path,a.defaults),{}),states:r}}connectActionHandlers(){if(this._parentFactory||null!==this._actionsSubscription)return;const n=new de;this._actionsSubscription=this._actions.pipe(ht(i=>"DISPATCHED"===i.status),dn(i=>{n.next(i);const r=i.action;return this.invokeActions(n,r).pipe(se(()=>({action:r,status:"SUCCESSFUL"})),Nu({action:r,status:"CANCELED"}),Ps(s=>{const o=this._ngxsUnhandledErrorHandler||=this._injector.get(wse),a=function Xre(t,e){if(null!==t&&"object"==typeof t){let n=!1;dC.set(t,()=>{n||(n=!0,e())})}return t}(s,()=>o.handleError(s,{action:r}));return ne({action:r,status:"ERRORED",error:a})}))})).subscribe(i=>this._actionResults.next(i))}invokeActions(n,i){const r=kc(i),s=[];let o=!1;for(const a of this.states){const c=a.actions[r];if(c)for(const l of c){const u=this._stateContextFactory.createStateContext(a);try{let d=a.instance[l.fn](u,i);Rc(d)&&(d=Mn(d)),os(d)?(d=d.pipe(dn(h=>Rc(h)?Mn(h):os(h)?h:ne(h)),Nu({})),l.options.cancelUncompleted&&(d=d.pipe(Ns(n.pipe(lse(i)))))):d=ne({}).pipe(dr()),s.push(d)}catch(d){s.push(Ta(d))}o=!0}}return s.length||s.push(ne({})),j_(s)}addToStatesMap(n){const i=[],r=this.statesByName;for(const s of n){const o=Ef(s).name;!r[o]&&(i.push(s),r[o]=s)}return{newStates:i}}addRuntimeInfoToMeta(n,i){this.statePaths[n.name]=i,n.path=i}hasBeenMountedAndBootstrapped(n,i){const r=void 0!==cC(this._initialState,i);return this.statesByName[n]&&r}static#e=this.\u0275fac=function(i){return new(i||t)(D(lt),D(Af),D(t,12),D(n2),D(s2),D(pC),D(Bk,8))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})(),Pr=(()=>{class t{constructor(n,i,r,s,o,a){this._stateStream=n,this._internalStateOperations=i,this._config=r,this._internalExecutionStrategy=s,this._stateFactory=o,this._selectableStateStream=this._stateStream.pipe(z_(this._internalExecutionStrategy),dr({bufferSize:1,refCount:!0})),this.initStateStream(a)}dispatch(n){return this._internalStateOperations.getRootStateOperations().dispatch(n)}select(n){const i=this.getStoreBoundSelectorFn(n);return this._selectableStateStream.pipe(se(i),Ps(r=>this._config.selectorOptions.suppressErrors&&r instanceof TypeError?ne(void 0):Ta(r)),bf(),z_(this._internalExecutionStrategy))}selectOnce(n){return this.select(n).pipe(Dn(1))}selectSnapshot(n){return this.getStoreBoundSelectorFn(n)(this._stateStream.getValue())}selectSignal(n){const i=this.getStoreBoundSelectorFn(n);return cB(()=>i(this._stateStream.state()))}subscribe(n){return this._selectableStateStream.pipe(z_(this._internalExecutionStrategy)).subscribe(n)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(n){this._internalStateOperations.getRootStateOperations().setState(n)}getStoreBoundSelectorFn(n){return u2(n)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(n){const i=this._stateStream.value;(!i||0===Object.keys(i).length)&&this._stateStream.next(n)}static#e=this.\u0275fac=function(i){return new(i||t)(D(sC),D(Cf),D(Af),D(e2),D(Fu),D(Bk,8))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const v2=new L("");let W_=(()=>{class t{static#e=this.store=null;static#t=this.config=null;constructor(n,i){t.store=n,t.config=i}ngOnDestroy(){t.store=null,t.config=null}static#n=this.\u0275fac=function(i){return new(i||t)(D(Pr),D(Af))};static#i=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),b2=(()=>{class t{constructor(n,i,r,s){this._store=n,this._internalStateOperations=i,this._stateContextFactory=r,this._appBootstrappedState=s,this._destroy$=new Os(1)}ngOnDestroy(){this._destroy$.next()}ngxsBootstrap(n,i){this._internalStateOperations.getRootStateOperations().dispatch(n).pipe(ht(()=>!!i),At(()=>this._invokeInitOnStates(i.states)),dn(()=>this._appBootstrappedState),ht(r=>!!r),Ns(this._destroy$)).subscribe(()=>this._invokeBootstrapOnStates(i.states))}_invokeInitOnStates(n){for(const i of n){const r=i.instance;r.ngxsOnChanges&&this._store.select(s=>cC(s,i.path)).pipe(Sa(void 0),_t((t,e)=>{let n,i=!1;t.subscribe(ot(e,r=>{const s=n;n=r,i&&e.next([s,r]),i=!0}))}),Ns(this._destroy$)).subscribe(([s,o])=>{const a=new Jre(s,o,!i.isInitialised);r.ngxsOnChanges(a)}),r.ngxsOnInit&&r.ngxsOnInit(this._getStateContext(i)),i.isInitialised=!0}}_invokeBootstrapOnStates(n){for(const i of n){const r=i.instance;r.ngxsAfterBootstrap&&r.ngxsAfterBootstrap(this._getStateContext(i))}}_getStateContext(n){return this._stateContextFactory.createStateContext(n)}static#e=this.\u0275fac=function(i){return new(i||t)(D(Pr),D(Cf),D(pC),D(kk))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();new L(""),new L("");let Ise=(()=>{class t{constructor(){!function w2(){(O(v2,{optional:!0})||[]).forEach(o=>o());const e=O(Fu),n=O(Cf);O(Pr),O(W_);const i=O(o2,{optional:!0})||[],r=O(b2),s=e.addAndReturnDefaults(i);n.setStateToTheCurrentWithNew(s),e.connectActionHandlers(),r.ngxsBootstrap(new oC,s)}()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Tr({type:t});static#n=this.\u0275inj=tr({})}return t})(),Mse=(()=>{class t{constructor(){!function A2(){O(Pr);const t=O(Cf),e=O(Fu),n=O(a2,{optional:!0})||[],i=O(b2),r=n.reduce((o,a)=>o.concat(a),[]),s=e.addAndReturnDefaults(r);s.states.length&&(t.setStateToTheCurrentWithNew(s),i.ngxsBootstrap(new aC(s.defaults),s))}()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Tr({type:t});static#n=this.\u0275inj=tr({})}return t})();function S2(t,e){return[Fu,uC,...t,{provide:o2,useValue:t},{provide:cf,useFactory:()=>{const n=O(kk);return()=>n.bootstrap()},multi:!0},{provide:c2,useValue:e},{provide:Qk,useValue:e.executionStrategy},{provide:jk,useExisting:pC},{provide:Vk,useExisting:Fu}]}function x2(t){return[Fu,uC,...t,{provide:a2,multi:!0,useValue:t}]}let Dse=(()=>{class t{static forRoot(n=[],i={}){return{ngModule:Ise,providers:S2(n,i)}}static forFeature(n=[]){return{ngModule:Mse,providers:x2(n)}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Tr({type:t});static#n=this.\u0275inj=tr({})}return t})();function gC(t,e){return(n,i,r)=>{const s=Nk(n.constructor),o=Array.isArray(t)?t:[t];for(const a of o){const c=a.type;s.actions[c]||(s.actions[c]=[]),s.actions[c].push({fn:i,options:e||{},type:c})}}}function mC(t){return e=>{const n=e,i=Nk(n),r=Object.getPrototypeOf(n),s=function Rse(t,e){return{...t[Pk]||{},...e}}(r,t);(function Ose(t){const{meta:e,inheritedStateClass:n,optionsWithInheritance:i}=t,{children:r,defaults:s,name:o}=i,a="string"==typeof o?o:o&&o.getName()||null;n.hasOwnProperty(Io)&&(e.actions={...e.actions,...(n[Io]||{}).actions}),e.children=r,e.defaults=s,e.name=a})({meta:i,inheritedStateClass:r,optionsWithInheritance:s}),n[Pk]=s}}const Pse=36;function $_(t,...e){return function(n,i){const r=i.toString(),s=`__${r}__selector`,o=function Lse(t,e,n=[]){return e=e||function Fse(t){const e=t.length-1;return t.charCodeAt(e)===Pse?t.slice(0,e):t}(t),"string"==typeof e?function ise(t,e){return e?.compatibility?.strictContentSecurityPolicy?d2(t):h2(t)}(n.length?[e,...n]:e.split("."),W_.config):e}(r,t,e);Object.defineProperties(n,{[s]:{writable:!0,enumerable:!1,configurable:!0},[r]:{enumerable:!0,configurable:!0,get(){return this[s]||(this[s]=function Nse(t){return W_.store||function Wre(){throw new Error("You have forgotten to import the NGXS module!")}(),W_.store.select(t)}(o))}}})}}const I2="NGXS_SELECTOR_OPTIONS_META",q_={getOptions:t=>t&&t[I2]||{},defineOptions:(t,e)=>{t&&(t[I2]=e)}};function Bse(t,e){const n=function Lk(t){return t.hasOwnProperty(iC)||Object.defineProperty(t,iC,{value:{makeRootSelector:null,originalFn:null,containerClass:null,selectorName:null,getSelectorOptions:()=>({})}}),Fk(t)}(t);n.originalFn=t;let i=()=>({});e&&(n.containerClass=e.containerClass,n.selectorName=e.selectorName||null,i=e.getSelectorOptions||i);const r={...n};return n.getSelectorOptions=()=>function kse(t,e){return{...q_.getOptions(t.containerClass)||{},...q_.getOptions(t.originalFn)||{},...t.getSelectorOptions()||{},...e}}(r,i()),n}function Tf(t,e,n){const i=function ese(t,e){const n=e&&e.containerClass,r=rC(function(...o){const a=t.apply(n,o);return a instanceof Function?rC.apply(null,[a]):a});return Object.setPrototypeOf(r,t),r}(e,n),r=Bse(e,n);return r.makeRootSelector=function Qre(t,e,n){return i=>{const{argumentSelectorFunctions:r,selectorOptions:s}=function tse(t,e,n=[]){const i=e.getSelectorOptions(),r=t.getSelectorOptions(i),o=function nse(t=[],e,n){const i=[];return n&&(e.injectContainerState||0===t.length)&&Ef(n)&&i.push(n),i.push(...t),i}(n,r,e.containerClass).map(a=>u2(a)(t));return{selectorOptions:r,argumentSelectorFunctions:o}}(i,t,e),{suppressErrors:o}=s;return function(c){const l=r.map(u=>u(c));try{return n(...l)}catch(u){if(o&&u instanceof TypeError)return;throw Zre&&console.error("The selector below has thrown an error upon invocation. Please check for any unsafe property access that may result in null or undefined values.",t.originalFn),u}}}}(r,t,i),i}function Bu(t){return(e,n,i)=>{i||=Object.getOwnPropertyDescriptor(e,n);const r=i?.value,s=Tf(t,r,{containerClass:e,selectorName:n.toString(),getSelectorOptions:()=>({})});return{configurable:!0,get:()=>s,originalFn:r}}}const Hse="NGXS_COMPUTED_OPTION",M2="NGXS_DATA_META",_C="NGXS_META",D2="NGXS_ARGUMENT_REGISTRY_META";function R2(t=Gse){return _t((e,n)=>{let i=!1;e.subscribe(ot(n,r=>{i=!0,n.next(r)},()=>i?n.complete():n.error(t())))})}function Gse(){return new Ou}let O2=(()=>{class t{constructor(n){this.subscription=null,this.sequence$=new on(0),n&&(this.subscription=n.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){this.sequence$.next(0),this.subscription?.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}static#e=this.\u0275fac=function(i){return new(i||t)(D(Pr,8))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})();function Sf(t){return t[M2]}let Nr=(()=>{class t{static#e=this.store=null;static#t=this.computed=null;static#n=this.context=null;static#i=this.factory=null;static#r=this.ngZone=null;static#s=this.injector=null;constructor(n,i,r){t.store=n.get(Pr),t.ngZone=n.get(_e),t.factory=i,t.context=r,t.computed=n.get(O2),t.injector=n}static#o=this.\u0275fac=function(i){return new(i||t)(D(lt),D(Vk),D(jk))};static#a=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})();class Bn{static#e=this.statesCachedMeta=new Map;constructor(){Bn.statesCachedMeta.clear()}static createStateContext(e){return Nr.context.createStateContext(e)}static ensureMappedState(e){if(zi(Nr.factory)||zi(e))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return(di(e.name)?Bn.statesCachedMeta.get(e.name):null)||Bn.ensureMeta(e)}static getRepositoryByInstance(e){const i=Sf(Bn.getStateClassByInstance(e))??null;if(zi(i))throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return i}static getStateClassByInstance(e){return(e??{}).constructor}static clearMetaByInstance(e){const n=Bn.getRepositoryByInstance(e);n.stateMeta.actions={},n.operations={}}static createPayload(e,n){const i={},r=Array.from(e);for(const[s,o]of r.entries()){const a=n?.getPayloadTypeByIndex(s);di(a)&&(i[a]=o)}return Object.keys(i).length>0?i:null}static createAction(e,n,i){const r=Bn.createPayload(n,i),s=function qse(t){return class{constructor(n){if(n)for(const i of Object.keys(n))this[i]=n[i]}static get type(){return t}}}(e.type);return new s(r)}static ensureMeta(e){const n=di(e.name)?Nr.factory.states?.find(i=>i.name===e.name):null;return di(n)&&di(e.name)&&Bn.statesCachedMeta.set(e.name,n),n}static#t=this.\u0275fac=function(n){return new(n||Bn)};static#n=this.\u0275prov=V({token:Bn,factory:Bn.\u0275fac})}new class Xse{constructor(){this.subject=new Os(1)}init(){this.subject.next()}onInit(e){this.subject.pipe(function Mo(t,e){const n=arguments.length>=2;return i=>i.pipe(t?ht((r,s)=>t(r,s,i)):ps,Dn(1),n?Nu(e):R2(()=>new Ou))}()).subscribe(e)}reset(){this.subject.complete(),this.subject=new Os(1)}};class Kse extends Error{constructor(e){super(`Child states can only be added to an object. Cannot convert ${di(e?.constructor)?e.constructor.name:e} to PlainObject`)}}function P2(t){return t.NGXS_OPTIONS_META??{name:""}}function N2(t){const e=P2(t),n=e.children??[],r=xk(void 0===e.defaults?{}:e.defaults);if(n.length>0){if(Ik(r))return function Jse(t,e){return e.reduce((n,i)=>{const r=P2(i);if(function vf(t){const e="string"==typeof t?t.trim():t;return[void 0,null,NaN,"",1/0].includes(e)}(r.name))throw new Error("State name not provided in class");return n[r.name.toString()]=N2(i),n},t??{})}(r,n);throw new Kse(r)}return r}function L2(){return`__${Hse}__`}function F2(t){return t[L2()]??null}function B2(){return Nr?.computed?.sequenceValue??0}function eoe(t){let e=!1;return os(t)&&(e=!0),e}function yC(t){return t[D2]}class toe extends Error{constructor(e,n){super(`An argument with the name '${e}' already exists in the method '${n}'`)}}class noe{constructor(){this.payloadMap=new Map,this.argumentMap=new Map}getPayloadTypeByIndex(e){return this.payloadMap.get(e)??null}getArgumentNameByIndex(e){return this.argumentMap.get(e)??null}createPayloadType(e,n,i){this.checkDuplicateName(e,n),this.payloadMap.set(i,e),this.payloadMap.set(e,e)}createArgumentName(e,n,i){this.checkDuplicateName(e,n),this.argumentMap.set(i,e),this.argumentMap.set(e,e)}checkDuplicateName(e,n){if(eC(this.argumentMap.has(e))||eC(this.payloadMap.has(e)))throw new toe(e,n)}}function coe(t){return{enumerable:!0,configurable:!0,get(){const e=Sf(t),n=Bn.ensureMappedState(e.stateMeta);return Bn.createStateContext(n)}}}const poe={dataActionSubscribeRequired:!0},goe=new L("NGXS_DATA_CONFIG",{providedIn:"root",factory:()=>poe});let moe=(()=>{class t{constructor(n,i){this.accessor=n,this.injector=i}static forRoot(n=[]){return{ngModule:t,providers:[Bn,Nr,O2,...n]}}static#e=this.\u0275fac=function(i){return new(i||t)(D(Bn,2),D(Nr,2))};static#t=this.\u0275mod=Tr({type:t});static#n=this.\u0275inj=tr({})}return t})();function k2(){return(t,e,n)=>{!function $se(t,e){if(!function hre(t,e){let n=t,i=!1;if(Ik(n))for(;null!==n;){if(Pu(n?.hasOwnProperty(e))){i=!!Object.getOwnPropertyDescriptor(n,e)?.get;break}n=Object.getPrototypeOf(n)}return i}(t,e?.toString()))throw new Error(`The method must be a getter for the computed decorator to work properly.\nExample: \n@Computed() get ${e.toString()}() { \n\t .. \n}`)}(t,e);const i=n.get;return n.get=function(...r){const s=function Qse(t){return zi(F2(t))&&Object.defineProperties(t,{[L2()]:{enumerable:!0,configurable:!0,value:new WeakMap}}),F2(t)}(this),o=s?.get(i);if(Pu(o?.isObservable))return o?.value;if(zi(o)||o.sequenceId!==B2()){s.delete(i);const c=i.apply(this,r);return s.set(i,{value:c,sequenceId:B2(),isObservable:eoe(c)}),c}return o?.value},n}}const _oe={cancelUncompleted:!0,insideZone:!1,subscribeRequired:!0};function Y_(t={}){const e=function yoe(t){const e=Nr?.injector?.get(goe,void 0,We.Optional),n={..._oe};return di(e)&&void 0!==e?.dataActionSubscribeRequired&&(n.subscribeRequired=e.dataActionSubscribeRequired),{...n,...t}}(t);return(n,i,r)=>{!function Wse(t,e){if(t.hasOwnProperty("prototype"))throw new Error("Cannot support static methods with @DataAction()");if(void 0===e)throw new Error("@DataAction() can only decorate a method implementation")}(n,r);const s=r.value,o=i.toString();return r.value=function(...a){const c=this;let l=null;const u=Bn.getRepositoryByInstance(c),d=u.operations;let h=d[o];const f=u.stateMeta,p=yC(s);if(zi(h)){const _=function foe(t){return String(t).replaceAll(/\/\/.*$/gm,"").replaceAll(/\s+/g,"").replaceAll(/\/\*[^*/]*\*\//g,"").split("){",1)?.[0]?.replace(/^[^(]*\(/,"").replaceAll(/=[^,]+/g,"").split(",").filter(Boolean)??[]}(s),w=function Yse(t){const{statePath:e,argumentsNames:n,methodName:i,argumentRegistry:r}=t;let s="";for(let o=0;o<n.length;o++)di(r?.getArgumentNameByIndex(o))?s+=r?.getArgumentNameByIndex(o):di(r?.getPayloadTypeByIndex(o))?s+=r?.getPayloadTypeByIndex(o):s+=`$arg${o}`,o!==n.length-1&&(s+=", ");return`@${e.replaceAll(".","/")}.${i}(${s})`}({statePath:f.path,methodName:o,argumentsNames:_,argumentRegistry:p});h=d[o]={type:w,options:{cancelUncompleted:e.cancelUncompleted??!1}},di(h)&&(f.actions[h.type]=[{type:h.type,options:h.options,fn:h.type}])}Bn.ensureMappedState(f).instance[h.type]=()=>(Pu(e.insideZone)?Nr.ngZone?.run(()=>{l=s.apply(c,a)}):l=s.apply(c,a),os(l)&&Pu(e.subscribeRequired)?ne(null).pipe(se(()=>l)):l);const y=Bn.createAction(h,a,p),v=Nr.store.dispatch(y);return os(l)?function Zse(t,e){return j_([t,e]).pipe(se(n=>n.pop()))}(v,l):l},r}}function U2(t){return(e,n,i)=>{const r=t.trim();if(!r)throw new Error("Payload name should be initialized");(function ioe(t,e){const n=t[e];return zi(yC(n))&&Object.defineProperties(n,{[D2]:{enumerable:!0,configurable:!0,value:new noe}}),yC(n)})(e,n).createPayloadType(r,n,i)}}function V2(){return t=>{const e=function hoe(t){if(function tre(t){return!eC(t)}(t.hasOwnProperty(_C))){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:n=>n.getStateGetter(e.name),children:[]};Object.defineProperty(t,_C,{value:e})}return function doe(t){return t?.[_C]}(t)}(t);if(zi(e.name))throw new Error("@StateRepository should be add before decorator @State");!function ooe(t,e){(function soe(t){const e=Sf(t)??null;return(zi(e)||e?.stateClass!==t)&&function roe(t){Object.defineProperty(t,M2,{writable:!0,configurable:!0,enumerable:!0,value:{stateMeta:null,operations:{},stateClass:t}})}(t),Sf(t)}(t)).stateMeta=e}(t,e),function boe(t,e,n){Object.defineProperties(t.prototype,{name:{enumerable:!0,configurable:!0,value:e.name},initialState:{enumerable:!0,configurable:!0,get:()=>xk(n)},context:coe(t)})}(t,e,N2(t)),function loe(t){const n=Sf(t)?.stateMeta?.name??null;if(di(n)){const i=`__${n}__selector`;Object.defineProperties(t.prototype,{[i]:{writable:!0,enumerable:!1,configurable:!0},state$:{enumerable:!0,configurable:!0,get(){if(di(this[i]))return this[i];if(zi(Nr.store))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return this[i]=Nr.store.select(t).pipe(se(r=>r),dr({refCount:!0,bufferSize:1})),this[i]}}})}}(t)}}let Eoe=(()=>{class t{constructor(){this._dirty=!0,this.browserStorageEvents$=new de,this.isInitialised=!1,this.isBootstrapped=!1}get dirty(){return this._dirty}set dirty(n){this._dirty=n}ngxsOnChanges(n){this.dirty&&this.isBootstrapped&&(this.dirty=!1,this.ngxsDataDoCheck?.())}ngxsOnInit(){this.isInitialised=!0}ngxsAfterBootstrap(){this.isBootstrapped=!0,this.dirty&&(this.dirty=!1,this.ngxsDataDoCheck?.())}markAsDirtyAfterReset(){this.dirty=!0,this.ngxsDataAfterReset?.()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})(),j2=(()=>{class t extends Eoe{get snapshot(){return this.getState()}get ctx(){return function uoe(t){if(!t)throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return{...t,getState:()=>t.getState(),setState(e){t.setState(e)},patchState(e){t.patchState(e)}}}(this.context)}patchState(n){this.ctx.patchState(n)}setState(n){this.ctx.setState(n)}reset(){this.ctx.setState(this.initialState),this.markAsDirtyAfterReset()}getState(){return this.ctx.getState()}dispatch(n){return this.ctx.dispatch(n)}static#e=this.\u0275fac=(()=>{let n;return function(r){return(n||(n=Cs(t)))(r||t)}})();static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return ze([k2()],t.prototype,"snapshot",null),ze([Y_(),bA(0,U2("patchValue"))],t.prototype,"patchState",null),ze([Y_(),bA(0,U2("stateValue"))],t.prototype,"setState",null),ze([Y_()],t.prototype,"reset",null),t})();function H2(...t){const e=t.length;if(0===e)throw new Error("list of properties cannot be empty.");return se(n=>{let i=n;for(let r=0;r<e;r++){const s=i?.[t[r]];if(!(typeof s<"u"))return;i=s}return i})}let xa=class Jp extends j2{constructor(){super(...arguments),this.optionCache=new Map}get config$(){return this.state$.pipe(function woe(){return ht(t=>null!=t)}(),dr(1))}setConfig(e){this.setState(e)}patchConfig(e){this.patchState(e)}getProperty(e){return this.config$.pipe(H2(...e),bf(),dr(1))}getOption(...e){const n=this.getPathKey(e);if(this.optionCache.has(n))return this.optionCache.get(n)??ne();const i=this.config$.pipe(H2(...e),bf(),dr(1));return this.optionCache.set(n,i),i}getPathKey(e){return`${e.length}:${e.join(".")}`}static#e=this.\u0275fac=(()=>{let e;return function(i){return(e||(e=Cs(Jp)))(i||Jp)}})();static#t=this.\u0275prov=V({token:Jp,factory:Jp.\u0275fac})};ze([k2(),Z("design:type",ge),Z("design:paramtypes",[])],xa.prototype,"config$",null),xa=ze([V2(),mC({name:"globalConfig",defaults:null})],xa);const z2="ALLOW_TELEMETRY",Coe=G2();function G2(){const t=localStorage.getItem(z2);return null===t?void 0:"true"===t.toLowerCase()}let vC=class Zp extends j2{setAllowTelemetry(e){const n=G2();localStorage.setItem(z2,e.toString()),this.ctx.patchState({allowTelemetry:e}),(void 0!==n||!1===e)&&location.reload()}static#e=this.\u0275fac=(()=>{let e;return function(i){return(e||(e=Cs(Zp)))(i||Zp)}})();static#t=this.\u0275prov=V({token:Zp,factory:Zp.\u0275fac})};function Do(...t){const e=ff(t),n=TB(t),{args:i,keys:r}=Rk(t);if(0===i.length)return Mn([],e);const s=new ge(function Toe(t,e,n=ps){return i=>{W2(e,()=>{const{length:r}=t,s=new Array(r);let o=r,a=r;for(let c=0;c<r;c++)W2(e,()=>{const l=Mn(t[c],e);let u=!1;l.subscribe(ot(i,d=>{s[c]=d,u||(u=!0,a--),a||i.next(n(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>Ok(r,o):ps));return n?s.pipe(V_(n)):s}function W2(t,e,n){t?Co(n,t,e):e()}function K_(t){return new ge(e=>{un(t()).subscribe(e)})}function J_(){return _t((t,e)=>{let n=null;t._refCount++;const i=ot(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(n=null);const r=t._connection,s=n;n=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});t.subscribe(i),i.closed||(n=t.connect())})}ze([Y_(),Z("design:type",Function),Z("design:paramtypes",[Boolean]),Z("design:returntype",void 0)],vC.prototype,"setAllowTelemetry",null),vC=ze([V2(),mC({name:"tracking",defaults:{allowTelemetry:Coe}})],vC);class EC extends ge{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Vd(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new bt;const n=this.getSubject();e.add(this.source.subscribe(ot(n,void 0,()=>{this._teardown(),n.complete()},i=>{this._teardown(),n.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=bt.EMPTY)}return e}refCount(){return J_()(this)}}function AC(t){return se(()=>t)}function ku(t){return _t((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}Error;const YC=new L("ngx-google-analytics-settings",{factory:()=>({trackingCode:"",enableTracing:!1})}),KC=new L("ngx-window",{providedIn:"root",factory:()=>{const{defaultView:t}=O(Ye);if(!t)throw new Error("Window is not available");return t}}),Uce=new L("ngx-data-layer",{providedIn:"root",factory:()=>function kce(t){return t?t.dataLayer=t.dataLayer||[]:null}(O(KC))}),X3=new L("ngx-gtag-fn",{providedIn:"root",factory:()=>function Vce(t,e){return t?t.gtag=t.gtag||function(){e.push(arguments)}:null}(O(KC),O(Uce))});let JC=(()=>{class t{constructor(n,i,r){this.settings=n,this._document=i,this._gtag=r}get document(){return this._document}throw(n){this.settings.enableTracing&&console&&console.error&&console.error(n)}toKeyValue(n){return n.size>0?Array.from(n).reduce((i,[r,s])=>Object.defineProperty(i,r,{value:s,enumerable:!0}),{}):void 0}gtag(...n){try{this._gtag(...n.filter(i=>void 0!==i))}catch(i){this.throw(i)}}event(n,i,r,s,o,a){try{const c=new Map;i&&c.set("event_category",i),r&&c.set("event_label",r),s&&c.set("value",s),void 0!==o&&c.set("interaction",o),a&&Object.entries(a).map(([u,d])=>c.set(u,d));const l=this.toKeyValue(c);l?this.gtag("event",n,l):this.gtag("event",n)}catch(c){this.throw(c)}}pageView(n,i,r,s){try{const o=new Map([["page_path",n]]);i&&o.set("page_title",i),(r||this.document)&&o.set("page_location",r||this.document.location.href),s&&Object.entries(s).map(([a,c])=>o.set(a,c)),this.gtag("config",this.settings.trackingCode,this.toKeyValue(o))}catch(o){this.throw(o)}}appView(n,i,r,s,o){try{const a=new Map([["screen_name",n],["app_name",i]]);r&&a.set("app_id",r),s&&a.set("app_version",s),o&&a.set("app_installer_id",o),this.gtag("event","screen_view",this.toKeyValue(a))}catch(a){this.throw(a)}}set(...n){try{this._gtag("set",...n)}catch(i){this.throw(i)}}exception(n,i){try{const r=new Map;n&&r.set("description",n),i&&r.set("fatal",i),this.toKeyValue(r)?this.gtag("event","exception",this.toKeyValue(r)):this.gtag("event","exception")}catch(r){this.throw(r)}}}return t.\u0275fac=function(n){return new(n||t)(D(YC),D(Ye),D(X3))},t.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();new L("ngx-google-analytics-routing-settings",{factory:()=>({})}),new L("Key under which consent is stored",{providedIn:"root",factory:()=>"ALLOW_TELEMETRY"}),Math,Math;const sn={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function Kce(t,{precision:e=sn.precision}={}){return t=function ele(t){return Math.round(t/sn.EPSILON)*sn.EPSILON}(t),"".concat(parseFloat(t.toPrecision(e)))}function Oo(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Xn(t,e,n){return function Po(t,e,n){if(Oo(t)){const i=t;n=n||function tle(t){return t.clone?t.clone():new Array(t.length)}(i);for(let r=0;r<n.length&&r<i.length;++r)n[r]=e(t[r],r,n);return n}return e(t)}(t,i=>Math.max(e,Math.min(n,i)))}function my(t,e,n){return Oo(t)?t.map((i,r)=>my(i,e[r],n)):n*e+(1-n)*t}function $u(t,e,n){const i=sn.EPSILON;n&&(sn.EPSILON=n);try{if(t===e)return!0;if(Oo(t)&&Oo(e)){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!$u(t[r],e[r]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):"number"==typeof t&&"number"==typeof e&&Math.abs(t-e)<=sn.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{sn.EPSILON=i}}class ZC extends(function nle(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){clone(){return(new this.constructor).copy(this)}fromArray(e,n=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+n];return this.check()}toArray(e=[],n=0){for(let i=0;i<this.ELEMENTS;++i)e[n+i]=this[i];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Oo(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(sn)}formatString(e){let n="";for(let i=0;i<this.ELEMENTS;++i)n+=(i>0?", ":"")+Kce(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!$u(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,i){if(void 0===i)return this.lerp(this,e,n);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(n[r]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),n[i]);return this.check()}add(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=n[i];return this.check()}subtract(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=n[i];return this.check()}scale(e){if("number"==typeof e)for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(sn.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),n);return this.check()}get elements(){return this}}function Rt(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function _y(t,e,n=""){if(sn.debug&&!function ile(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class rle extends ZC{toString(){let e="[";if(sn.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,i){return this[n*this.RANK+e]=Rt(i),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)n[r]=this[i+r];return n}setColumn(e,n){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=n[r];return this}}function J3(t,e,n){const i=e[0],r=e[1],s=e[2],o=n[3]*i+n[7]*r+n[11]*s||1;return t[0]=(n[0]*i+n[4]*r+n[8]*s)/o,t[1]=(n[1]*i+n[5]*r+n[9]*s)/o,t[2]=(n[2]*i+n[6]*r+n[10]*s)/o,t}var ks=1e-6,Gi=typeof Float32Array<"u"?Float32Array:Array;function QC(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=e[9],h=e[10],f=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=n*a-i*o,_=n*c-r*o,w=n*l-s*o,C=i*c-r*a,S=i*l-s*a,M=r*l-s*c,x=u*g-d*p,N=u*m-h*p,U=u*y-f*p,k=d*m-h*g,z=d*y-f*g,R=h*y-f*m,F=v*R-_*z+w*k+C*U-S*N+M*x;return F?(t[0]=(a*R-c*z+l*k)*(F=1/F),t[1]=(r*z-i*R-s*k)*F,t[2]=(g*M-m*S+y*C)*F,t[3]=(h*S-d*M-f*C)*F,t[4]=(c*U-o*R-l*N)*F,t[5]=(n*R-r*U+s*N)*F,t[6]=(m*w-p*M-y*_)*F,t[7]=(u*M-h*w+f*_)*F,t[8]=(o*z-a*U+l*x)*F,t[9]=(i*U-n*z-s*x)*F,t[10]=(p*S-g*w+y*v)*F,t[11]=(d*w-u*S-f*v)*F,t[12]=(a*N-o*k-c*x)*F,t[13]=(n*k-i*N+r*x)*F,t[14]=(g*_-p*C-m*v)*F,t[15]=(u*C-d*_+h*v)*F,t):null}function zc(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],d=e[8],h=e[9],f=e[10],p=e[11],g=e[12],m=e[13],y=e[14],v=e[15],_=n[0],w=n[1],C=n[2],S=n[3];return t[0]=_*i+w*a+C*d+S*g,t[1]=_*r+w*c+C*h+S*m,t[2]=_*s+w*l+C*f+S*y,t[3]=_*o+w*u+C*p+S*v,t[4]=(_=n[4])*i+(w=n[5])*a+(C=n[6])*d+(S=n[7])*g,t[5]=_*r+w*c+C*h+S*m,t[6]=_*s+w*l+C*f+S*y,t[7]=_*o+w*u+C*p+S*v,t[8]=(_=n[8])*i+(w=n[9])*a+(C=n[10])*d+(S=n[11])*g,t[9]=_*r+w*c+C*h+S*m,t[10]=_*s+w*l+C*f+S*y,t[11]=_*o+w*u+C*p+S*v,t[12]=(_=n[12])*i+(w=n[13])*a+(C=n[14])*d+(S=n[15])*g,t[13]=_*r+w*c+C*h+S*m,t[14]=_*s+w*l+C*f+S*y,t[15]=_*o+w*u+C*p+S*v,t}function yy(t,e,n){var o,a,c,l,u,d,h,f,p,g,m,y,i=n[0],r=n[1],s=n[2];return e===t?(t[12]=e[0]*i+e[4]*r+e[8]*s+e[12],t[13]=e[1]*i+e[5]*r+e[9]*s+e[13],t[14]=e[2]*i+e[6]*r+e[10]*s+e[14],t[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(a=e[1],c=e[2],l=e[3],u=e[4],d=e[5],h=e[6],f=e[7],p=e[8],g=e[9],m=e[10],y=e[11],t[0]=o=e[0],t[1]=a,t[2]=c,t[3]=l,t[4]=u,t[5]=d,t[6]=h,t[7]=f,t[8]=p,t[9]=g,t[10]=m,t[11]=y,t[12]=o*i+u*r+p*s+e[12],t[13]=a*i+d*r+g*s+e[13],t[14]=c*i+h*r+m*s+e[14],t[15]=l*i+f*r+y*s+e[15]),t}function eT(t,e,n){var i=n[0],r=n[1],s=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Z3(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[4],o=e[5],a=e[6],c=e[7],l=e[8],u=e[9],d=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*r+l*i,t[5]=o*r+u*i,t[6]=a*r+d*i,t[7]=c*r+h*i,t[8]=l*r-s*i,t[9]=u*r-o*i,t[10]=d*r-a*i,t[11]=h*r-c*i,t}function Q3(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],o=e[1],a=e[2],c=e[3],l=e[4],u=e[5],d=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r+l*i,t[1]=o*r+u*i,t[2]=a*r+d*i,t[3]=c*r+h*i,t[4]=l*r-s*i,t[5]=u*r-o*i,t[6]=d*r-a*i,t[7]=h*r-c*i,t}Math,Math,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function vy(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function eU(t,e){return t[0]=-e[0],t[1]=-e[1],t}function tU(t,e,n,i){var r=e[0],s=e[1];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t}function nU(){var t=new Gi(3);return Gi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function iU(t,e,n){var i=new Gi(3);return i[0]=t,i[1]=e,i[2]=n,i}function rU(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function by(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],c=n[2];return t[0]=r*c-s*a,t[1]=s*o-i*c,t[2]=i*a-r*o,t}function tT(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[3]*i+n[7]*r+n[11]*s+n[15];return t[0]=(n[0]*i+n[4]*r+n[8]*s+n[12])/(o=o||1),t[1]=(n[1]*i+n[5]*r+n[9]*s+n[13])/o,t[2]=(n[2]*i+n[6]*r+n[10]*s+n[14])/o,t}function sU(t,e,n){var i=n[0],r=n[1],s=n[2],a=e[0],c=e[1],l=e[2],u=r*l-s*c,d=s*a-i*l,h=i*c-r*a,f=r*h-s*d,p=s*u-i*h,g=i*d-r*u,m=2*n[3];return d*=m,h*=m,p*=2,g*=2,t[0]=a+(u*=m)+(f*=2),t[1]=c+d+p,t[2]=l+h+g,t}(function Cle(){var t=new Gi(2);Gi!=Float32Array&&(t[0]=0,t[1]=0)})();function oU(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function zf(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*s+n[12]*o,t[1]=n[1]*i+n[5]*r+n[9]*s+n[13]*o,t[2]=n[2]*i+n[6]*r+n[10]*s+n[14]*o,t[3]=n[3]*i+n[7]*r+n[11]*s+n[15]*o,t}nU(),function Ble(){var t=new Gi(4);Gi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var aU=function(t){return t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3",t}(aU||{});const Jle=45*Math.PI/180,Zle=1,nT=.1,iT=500,Qle=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Le extends rle{static get IDENTITY(){return function tue(){return wy||(wy=new Le,Object.freeze(wy)),wy}()}static get ZERO(){return function eue(){return Ey||(Ey=new Le([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Ey)),Ey}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return aU}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,i,r,s,o,a,c,l,u,d,h,f,p,g,m){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=c,this[8]=l,this[9]=u,this[10]=d,this[11]=h,this[12]=f,this[13]=p,this[14]=g,this[15]=m,this.check()}setRowMajor(e,n,i,r,s,o,a,c,l,u,d,h,f,p,g,m){return this[0]=e,this[1]=s,this[2]=l,this[3]=f,this[4]=n,this[5]=o,this[6]=u,this[7]=p,this[8]=i,this[9]=a,this[10]=d,this[11]=g,this[12]=r,this[13]=c,this[14]=h,this[15]=m,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Qle)}fromObject(e){return this.check()}fromQuaternion(e){return function _le(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n+n,a=i+i,c=r+r,l=n*o,u=i*o,d=i*a,h=r*o,f=r*a,p=r*c,g=s*o,m=s*a,y=s*c;t[0]=1-d-p,t[1]=u+y,t[2]=h-m,t[3]=0,t[4]=u-y,t[5]=1-l-p,t[6]=f+g,t[7]=0,t[8]=h+m,t[9]=f-g,t[10]=1-l-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,e),this.check()}frustum(e){const{left:n,right:i,bottom:r,top:s,near:o=nT,far:a=iT}=e;return a===1/0?function nue(t,e,n,i,r,s){const a=2*s/(r-i),c=(n+e)/(n-e),l=(r+i)/(r-i),h=-2*s;t[0]=2*s/(n-e),t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=c,t[9]=l,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=h,t[15]=0}(this,n,i,r,s,o):function yle(t,e,n,i,r,s,o){var a=1/(n-e),c=1/(r-i),l=1/(s-o);t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*c,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*c,t[10]=(o+s)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*l,t[15]=0}(this,n,i,r,s,o,a),this.check()}lookAt(e){const{eye:n,center:i=[0,0,0],up:r=[0,1,0]}=e;return function Ale(t,e,n,i){var r,s,o,a,c,l,u,d,h,f,p=e[0],g=e[1],m=e[2],y=i[0],v=i[1],_=i[2],w=n[0],C=n[1],S=n[2];Math.abs(p-w)<ks&&Math.abs(g-C)<ks&&Math.abs(m-S)<ks?function ule(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t):(u=p-w,d=g-C,h=m-S,r=v*(h*=f=1/Math.hypot(u,d,h))-_*(d*=f),s=_*(u*=f)-y*h,o=y*d-v*u,(f=Math.hypot(r,s,o))?(r*=f=1/f,s*=f,o*=f):(r=0,s=0,o=0),a=d*o-h*s,c=h*r-u*o,l=u*s-d*r,(f=Math.hypot(a,c,l))?(a*=f=1/f,c*=f,l*=f):(a=0,c=0,l=0),t[0]=r,t[1]=a,t[2]=u,t[3]=0,t[4]=s,t[5]=c,t[6]=d,t[7]=0,t[8]=o,t[9]=l,t[10]=h,t[11]=0,t[12]=-(r*p+s*g+o*m),t[13]=-(a*p+c*g+l*m),t[14]=-(u*p+d*g+h*m),t[15]=1)}(this,n,i,r),this.check()}ortho(e){const{left:n,right:i,bottom:r,top:s,near:o=nT,far:a=iT}=e;return function Ele(t,e,n,i,r,s,o){var a=1/(e-n),c=1/(i-r),l=1/(s-o);t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*c,t[14]=(o+s)*l,t[15]=1}(this,n,i,r,s,o,a),this.check()}orthographic(e){const{fovy:n=Jle,aspect:i=Zle,focalDistance:r=1,near:s=nT,far:o=iT}=e;cU(n);const c=r*Math.tan(n/2),l=c*i;return this.ortho({left:-l,right:l,bottom:-c,top:c,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}=e;return cU(n),function vle(t,e,n,i,r){var o,s=1/Math.tan(e/2);t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(t[10]=(r+i)*(o=1/(i-r)),t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i)}(this,n,i,r,s),this.check()}determinant(){return function hle(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],c=t[7],l=t[8],u=t[9],d=t[10],h=t[11],f=t[12],p=t[13],g=t[14],m=t[15];return(e*o-n*s)*(d*m-h*g)-(e*a-i*s)*(u*m-h*p)+(e*c-r*s)*(u*g-d*p)+(n*a-i*o)*(l*m-h*f)-(n*c-r*o)*(l*g-d*f)+(i*c-r*a)*(l*p-u*f)}(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0];const i=this.getScale(n=n||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0];const i=this.getScale(n=n||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return function dle(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=s,t[11]=e[14],t[12]=r,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}invert(){return QC(this,this),this.check()}multiplyLeft(e){return zc(this,e,this),this.check()}multiplyRight(e){return zc(this,this,e),this.check()}rotateX(e){return Z3(this,this,e),this.check()}rotateY(e){return function ple(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],o=e[1],a=e[2],c=e[3],l=e[8],u=e[9],d=e[10],h=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r-l*i,t[1]=o*r-u*i,t[2]=a*r-d*i,t[3]=c*r-h*i,t[8]=s*i+l*r,t[9]=o*i+u*r,t[10]=a*i+d*r,t[11]=c*i+h*r}(this,this,e),this.check()}rotateZ(e){return Q3(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return function fle(t,e,n,i){var c,l,u,d,h,f,p,g,m,y,v,_,w,C,S,M,x,N,U,k,z,R,F,W,r=i[0],s=i[1],o=i[2],a=Math.hypot(r,s,o);a<ks||(r*=a=1/a,s*=a,o*=a,c=Math.sin(n),l=Math.cos(n),h=e[1],f=e[2],p=e[3],m=e[5],y=e[6],v=e[7],w=e[9],C=e[10],S=e[11],U=r*s*(u=1-l)-o*c,k=s*s*u+l,z=o*s*u+r*c,R=r*o*u+s*c,F=s*o*u-r*c,W=o*o*u+l,t[0]=(d=e[0])*(M=r*r*u+l)+(g=e[4])*(x=s*r*u+o*c)+(_=e[8])*(N=o*r*u-s*c),t[1]=h*M+m*x+w*N,t[2]=f*M+y*x+C*N,t[3]=p*M+v*x+S*N,t[4]=d*U+g*k+_*z,t[5]=h*U+m*k+w*z,t[6]=f*U+y*k+C*z,t[7]=p*U+v*k+S*z,t[8]=d*R+g*F+_*W,t[9]=h*R+m*F+w*W,t[10]=f*R+y*F+C*W,t[11]=p*R+v*F+S*W,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,e,n),this.check()}scale(e){return eT(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return yy(this,this,e),this.check()}transform(e,n){return 4===e.length?(_y(n=zf(n||[-0,-0,-0,-0],e,this),4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:i}=e;let r;switch(i){case 2:r=function Tle(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}(n||[-0,-0],e,this);break;case 3:r=tT(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return _y(r,e.length),r}transformAsVector(e,n){let i;switch(e.length){case 2:i=function sle(t,e,n){const i=e[0],r=e[1],s=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/s,t[1]=(n[1]*i+n[5]*r)/s,t}(n||[-0,-0],e,this);break;case 3:i=J3(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return _y(i,e.length),i}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,i){return this.identity().translate([e,n,i])}}let Ey,wy;function cU(t){if(t>2*Math.PI)throw Error("expected radians")}class iue extends bt{constructor(e,n){super()}schedule(e,n=0){return this}}const Ay={setInterval(t,e,...n){const{delegate:i}=Ay;return i?.setInterval?i.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){const{delegate:e}=Ay;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};class rT extends iue{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,n)),this.pending=!0,this.delay=n,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,i=0){return Ay.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,n,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return n;null!=n&&Ay.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,n);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:n}=this,{actions:i}=n;this.work=this.state=this.scheduler=null,this.pending=!1,El(i,this),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}}class Gf{constructor(e,n=Gf.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,i){return new this.schedulerActionCtor(this,e).schedule(i,n)}}Gf.now=_A.now;class sT extends Gf{constructor(e,n=Gf.now){super(e,n),this.actions=[],this._active=!1}flush(e){const{actions:n}=this;if(this._active)return void n.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=n.shift());if(this._active=!1,i){for(;e=n.shift();)e.unsubscribe();throw i}}}const Cy=new sT(rT),rue=Cy;function Ty(t,e=Cy){return _t((n,i)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const l=s;s=null,i.next(l)}};function c(){const l=o+t,u=e.now();if(u<l)return r=this.schedule(void 0,l-u),void i.add(r);a()}n.subscribe(ot(i,l=>{s=l,o=e.now(),r||(r=e.schedule(c,t),i.add(r))},()=>{a(),i.complete()},void 0,()=>{s=r=null}))})}function lU(){return _t((t,e)=>{t.subscribe(ot(e,nc))})}function uU(t,e){return e?n=>wf(e.pipe(Dn(1),lU()),n.pipe(uU(t))):dn((n,i)=>un(t(n,i)).pipe(Dn(1),AC(n)))}function Sy(t=0,e,n=rue){let i=-1;return null!=e&&(CB(e)?n=e:i=e),new ge(r=>{let s=function sue(t){return t instanceof Date&&!isNaN(t)}(t)?+t-n.now():t;s<0&&(s=0);let o=0;return n.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}function dU(t,e=Cy){const n=Sy(t,e);return uU(()=>n)}const lue={connector:()=>new de};function hue(t,e,n,i){n&&!Fe(n)&&(i=n);const r=Fe(n)?n:void 0;return s=>function due(t,e){const n=Fe(t)?t:()=>t;return Fe(e)?function uue(t,e=lue){const{connector:n}=e;return _t((i,r)=>{const s=n();un(t(function cue(t){return new ge(e=>t.subscribe(e))}(s))).subscribe(r),r.add(i.subscribe(s))})}(e,{connector:n}):i=>new EC(i,n)}(new Os(t,e,i),r)(s)}class fue{}const gue=(t,e)=>JSON.stringify(t)===JSON.stringify(e),mue=t=>t.map(e=>void 0!==e?JSON.parse(JSON.stringify(e)):e),ls={storageStrategy:class pue extends fue{constructor(){super(...arguments),this.cachePairs=[]}add(e,n,i){this.cachePairs.push(e)}addMany(e){this.cachePairs=e}updateAtIndex(e,n){Object.assign(this.cachePairs[e],n)}update(e,n){Object.assign(this.cachePairs[e],n)}getAll(){return this.cachePairs}removeAtIndex(e){this.cachePairs.splice(e,1)}remove(e){this.cachePairs.splice(e,1)}removeAll(){this.cachePairs.length=0}},globalCacheKey:"CACHE_STORAGE",promiseImplementation:Promise},_ue=new de;function fr(t={}){return function(e,n,i){const r=t.cacheKey||e.constructor.name+"#"+n,s=i.value;if(i&&i.value){let o=t.storageStrategy?new t.storageStrategy:new ls.storageStrategy;const a=[];t.cacheModifier&&t.cacheModifier.subscribe(u=>o.addMany(u(o.getAll(r,this)),r,this)),Nc(_ue.asObservable(),t.cacheBusterObserver?t.cacheBusterObserver:function Vee(t){return t?function jee(t){return new ge(e=>t.schedule(()=>e.complete()))}(t):Hi}()).subscribe(u=>{o.removeAll(r,this),a.length=0}),t.cacheResolver=t.cacheResolver||ls.cacheResolver||gue,t.cacheHasher=t.cacheHasher||ls.cacheHasher||mue,i.value=function(...u){const d=o.getAll(r,this);let h=t.cacheHasher(u),f=d.find(g=>t.cacheResolver(g.parameters,h));const p=a.find(g=>t.cacheResolver(g.parameters,h));if((t.maxAge||ls.maxAge)&&f&&f.created&&((new Date).getTime()-new Date(f.created).getTime()>(t.maxAge||ls.maxAge)?(o.remove?o.remove(d.indexOf(f),f,r,this):o.removeAtIndex(d.indexOf(f),r,this),f=null):(t.slidingExpiration||ls.slidingExpiration)&&(f.created=new Date,o.update?o.update(d.indexOf(f),f,r,this):o.updateAtIndex(d.indexOf(f),f,r,this))),f){const g=ne(f.response);return t.async?g.pipe(dU(0)):g}if(p)return p.response;{const g=s.call(this,...u).pipe(ku(()=>{const m=a.find(y=>t.cacheResolver(y.parameters,h));a.splice(a.indexOf(m),1)}),At(m=>{(!t.shouldCacheDecider||t.shouldCacheDecider(m))&&((!(t.maxCacheCount||ls.maxCacheCount)||1===(t.maxCacheCount||ls.maxCacheCount)||(t.maxCacheCount||ls.maxCacheCount)&&(t.maxCacheCount||ls.maxCacheCount)<d.length+1)&&(o.remove?o.remove(0,d[0],r,this):o.removeAtIndex(0,r,this)),o.add({parameters:h,response:m,created:t.maxAge||ls.maxAge?new Date:null},r,this))}),hue(1),J_());return a.push({parameters:h,response:g,created:new Date}),g}}}return i}}class xy{}class Iy{}class Ii{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(n=>{const i=n.indexOf(":");if(i>0){const r=n.slice(0,i),s=r.toLowerCase(),o=n.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((n,i)=>{this.setHeaderEntries(i,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([n,i])=>{this.setHeaderEntries(n,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof Ii?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){const n=new Ii;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof Ii?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){const n=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,n);const r=("a"===e.op?this.headers.get(n):void 0)||[];r.push(...i),this.headers.set(n,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(n);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,o)}else this.headers.delete(n),this.normalizedNames.delete(n)}}setHeaderEntries(e,n){const i=(Array.isArray(n)?n:[n]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}}class yue{encodeKey(e){return hU(e)}encodeValue(e){return hU(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const bue=/%(\d[a-f0-9])/gi,Eue={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function hU(t){return encodeURIComponent(t).replace(bue,(e,n)=>Eue[n]??e)}function My(t){return`${t}`}class Ze{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new yue,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function vue(t,e){const n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],c=n.get(o)||[];c.push(a),n.set(o,c)}),n}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{const i=e.fromObject[n],r=Array.isArray(i)?i.map(My):[My(i)];this.map.set(n,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){const n=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{n.push({param:i,value:s,op:"a"})}):n.push({param:i,value:r,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const n=this.encoder.encodeKey(e);return this.map.get(e).map(i=>n+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const n=new Ze({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const n=("a"===e.op?this.map.get(e.param):void 0)||[];n.push(My(e.value)),this.map.set(e.param,n);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(My(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Ge{constructor(){this.map=new Map}set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function fU(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function pU(t){return typeof Blob<"u"&&t instanceof Blob}function gU(t){return typeof FormData<"u"&&t instanceof FormData}class Wf{constructor(e,n,i,r){let s;if(this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function wue(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new Ii,this.context??=new Ge,this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{const a=n.indexOf("?");this.urlWithParams=n+(-1===a?"?":a<n.length-1?"&":"")+o}}else this.params=new Ze,this.urlWithParams=n}serializeBody(){return null===this.body?null:"string"==typeof this.body||fU(this.body)||pU(this.body)||gU(this.body)||function Aue(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}(this.body)?this.body:this.body instanceof Ze?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||gU(this.body)?null:pU(this.body)?this.body.type||null:fU(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Ze?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const n=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=void 0!==e.body?e.body:this.body,a=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress;let l=e.headers||this.headers,u=e.params||this.params;const d=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((h,f)=>h.set(f,e.setHeaders[f]),l)),e.setParams&&(u=Object.keys(e.setParams).reduce((h,f)=>h.set(f,e.setParams[f]),u)),new Wf(n,i,o,{params:u,headers:l,context:d,reportProgress:c,responseType:r,withCredentials:a,transferCache:s})}}var Da=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(Da||{});class oT{constructor(e,n=200,i="OK"){this.headers=e.headers||new Ii,this.status=void 0!==e.status?e.status:n,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class Dy extends oT{constructor(e={}){super(e),this.type=Da.ResponseHeader}clone(e={}){return new Dy({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Gc extends oT{constructor(e={}){super(e),this.type=Da.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Gc({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class qu extends oT{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function aT(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}let Us=(()=>{class t{constructor(n){this.handler=n}request(n,i,r={}){let s;if(n instanceof Wf)s=n;else{let c,l;c=r.headers instanceof Ii?r.headers:new Ii(r.headers),r.params&&(l=r.params instanceof Ze?r.params:new Ze({fromObject:r.params})),s=new Wf(n,i,void 0!==r.body?r.body:null,{headers:c,context:r.context,params:l,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}const o=ne(s).pipe(function xf(t,e){return Fe(e)?dn(t,e,1):dn(t,1)}(c=>this.handler.handle(c)));if(n instanceof Wf||"events"===r.observe)return o;const a=o.pipe(ht(c=>c instanceof Gc));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(se(c=>{if(null!==c.body&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return a.pipe(se(c=>{if(null!==c.body&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return a.pipe(se(c=>{if(null!==c.body&&"string"!=typeof c.body)throw new Error("Response is not a string.");return c.body}));default:return a.pipe(se(c=>c.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:(new Ze).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,r={}){return this.request("PATCH",n,aT(r,i))}post(n,i,r={}){return this.request("POST",n,aT(r,i))}put(n,i,r={}){return this.request("PUT",n,aT(r,i))}static#e=this.\u0275fac=function(i){return new(i||t)(D(xy))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})();const Sue=/^\)\]\}',?\n/;function _U(t){if(t.url)return t.url;const e="X-Request-URL".toLocaleLowerCase();return t.headers.get(e)}let cT=(()=>{class t{constructor(){this.fetchImpl=O(Iue,{optional:!0})?.fetch??fetch.bind(globalThis),this.ngZone=O(_e)}handle(n){return new ge(i=>{const r=new AbortController;return this.doRequest(n,r.signal,i).then(lT,s=>i.error(new qu({error:s}))),()=>r.abort()})}doRequest(n,i,r){var s=this;return ee(function*(){const o=s.createRequestInit(n);let a;try{const p=s.ngZone.runOutsideAngular(()=>s.fetchImpl(n.urlWithParams,{signal:i,...o}));(function Mue(t){t.then(lT,lT)})(p),r.next({type:Da.Sent}),a=yield p}catch(p){return void r.error(new qu({error:p,status:p.status??0,statusText:p.statusText,url:n.urlWithParams,headers:p.headers}))}const c=new Ii(a.headers),l=a.statusText,u=_U(a)??n.urlWithParams;let d=a.status,h=null;if(n.reportProgress&&r.next(new Dy({headers:c,status:d,statusText:l,url:u})),a.body){const p=a.headers.get("content-length"),g=[],m=a.body.getReader();let v,_,y=0;const w=typeof Zone<"u"&&Zone.current;yield s.ngZone.runOutsideAngular(ee(function*(){for(;;){const{done:S,value:M}=yield m.read();if(S)break;if(g.push(M),y+=M.length,n.reportProgress){_="text"===n.responseType?(_??"")+(v??=new TextDecoder).decode(M,{stream:!0}):void 0;const x=()=>r.next({type:Da.DownloadProgress,total:p?+p:void 0,loaded:y,partialText:_});w?w.run(x):x()}}}));const C=s.concatChunks(g,y);try{const S=a.headers.get("Content-Type")??"";h=s.parseBody(n,C,S)}catch(S){return void r.error(new qu({error:S,headers:new Ii(a.headers),status:a.status,statusText:a.statusText,url:_U(a)??n.urlWithParams}))}}0===d&&(d=h?200:0),d>=200&&d<300?(r.next(new Gc({body:h,headers:c,status:d,statusText:l,url:u})),r.complete()):r.error(new qu({error:h,headers:c,status:d,statusText:l,url:u}))})()}parseBody(n,i,r){switch(n.responseType){case"json":const s=(new TextDecoder).decode(i).replace(Sue,"");return""===s?null:JSON.parse(s);case"text":return(new TextDecoder).decode(i);case"blob":return new Blob([i],{type:r});case"arraybuffer":return i.buffer}}createRequestInit(n){const i={},r=n.withCredentials?"include":void 0;if(n.headers.forEach((s,o)=>i[s]=o.join(",")),n.headers.has("Accept")||(i.Accept="application/json, text/plain, */*"),!n.headers.has("Content-Type")){const s=n.detectContentTypeHeader();null!==s&&(i["Content-Type"]=s)}return{body:n.serializeBody(),method:n.method,headers:i,credentials:r}}concatChunks(n,i){const r=new Uint8Array(i);let s=0;for(const o of n)r.set(o,s),s+=o.length;return r}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})();class Iue{}function lT(){}function yU(t,e){return e(t)}const $f=new L(""),vU=new L(""),bU=new L("",{providedIn:"root",factory:()=>!0});let EU=(()=>{class t extends xy{constructor(n,i){super(),this.backend=n,this.injector=i,this.chain=null,this.pendingTasks=O(aa),this.contributeToStability=O(bU)}handle(n){if(null===this.chain){const i=Array.from(new Set([...this.injector.get($f),...this.injector.get(vU,[])]));this.chain=i.reduceRight((r,s)=>function Rue(t,e,n){return(i,r)=>ms(n,()=>e(i,s=>t(s,r)))}(r,s,this.injector),yU)}if(this.contributeToStability){const i=this.pendingTasks.add();return this.chain(n,r=>this.backend.handle(r)).pipe(ku(()=>this.pendingTasks.remove(i)))}return this.chain(n,i=>this.backend.handle(i))}static#e=this.\u0275fac=function(i){return new(i||t)(D(Iy),D(oi))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})();const kue=/^\)\]\}',?\n/;let AU=(()=>{class t{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new $(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?Mn(i.\u0275loadImpl()):ne(null)).pipe(hn(()=>new ge(s=>{const o=i.build();if(o.open(n.method,n.urlWithParams),n.withCredentials&&(o.withCredentials=!0),n.headers.forEach((g,m)=>o.setRequestHeader(g,m.join(","))),n.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const g=n.detectContentTypeHeader();null!==g&&o.setRequestHeader("Content-Type",g)}if(n.responseType){const g=n.responseType.toLowerCase();o.responseType="json"!==g?g:"text"}const a=n.serializeBody();let c=null;const l=()=>{if(null!==c)return c;const g=o.statusText||"OK",m=new Ii(o.getAllResponseHeaders()),y=function Uue(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(o)||n.url;return c=new Dy({headers:m,status:o.status,statusText:g,url:y}),c},u=()=>{let{headers:g,status:m,statusText:y,url:v}=l(),_=null;204!==m&&(_=typeof o.response>"u"?o.responseText:o.response),0===m&&(m=_?200:0);let w=m>=200&&m<300;if("json"===n.responseType&&"string"==typeof _){const C=_;_=_.replace(kue,"");try{_=""!==_?JSON.parse(_):null}catch(S){_=C,w&&(w=!1,_={error:S,text:_})}}w?(s.next(new Gc({body:_,headers:g,status:m,statusText:y,url:v||void 0})),s.complete()):s.error(new qu({error:_,headers:g,status:m,statusText:y,url:v||void 0}))},d=g=>{const{url:m}=l(),y=new qu({error:g,status:o.status||0,statusText:o.statusText||"Unknown Error",url:m||void 0});s.error(y)};let h=!1;const f=g=>{h||(s.next(l()),h=!0);let m={type:Da.DownloadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),"text"===n.responseType&&o.responseText&&(m.partialText=o.responseText),s.next(m)},p=g=>{let m={type:Da.UploadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),s.next(m)};return o.addEventListener("load",u),o.addEventListener("error",d),o.addEventListener("timeout",d),o.addEventListener("abort",d),n.reportProgress&&(o.addEventListener("progress",f),null!==a&&o.upload&&o.upload.addEventListener("progress",p)),o.send(a),s.next({type:Da.Sent}),()=>{o.removeEventListener("error",d),o.removeEventListener("abort",d),o.removeEventListener("load",u),o.removeEventListener("timeout",d),n.reportProgress&&(o.removeEventListener("progress",f),null!==a&&o.upload&&o.upload.removeEventListener("progress",p)),o.readyState!==o.DONE&&o.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||t)(D(ZB))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})();const uT=new L(""),CU=new L("",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),TU=new L("",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class SU{}let Hue=(()=>{class t{constructor(n,i,r){this.doc=n,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=HB(n,this.cookieName),this.lastCookieString=n),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||t)(D(Ye),D(Mr),D(CU))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})();function zue(t,e){const n=t.url.toLowerCase();if(!O(uT)||"GET"===t.method||"HEAD"===t.method||n.startsWith("http://")||n.startsWith("https://"))return e(t);const i=O(SU).getToken(),r=O(TU);return null!=i&&!t.headers.has(r)&&(t=t.clone({headers:t.headers.set(r,i)})),e(t)}function Gue(...t){const e=[Us,AU,EU,{provide:xy,useExisting:EU},{provide:Iy,useFactory:()=>O(cT,{optional:!0})??O(AU)},{provide:$f,useValue:zue,multi:!0},{provide:uT,useValue:!0},{provide:SU,useClass:Hue}];for(const n of t)e.push(...n.\u0275providers);return function Zd(t){return{\u0275providers:t}}(e)}class dT{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const hT=new L("basePath");class Xu{apiKeys;username;password;accessToken;basePath;withCredentials;encoder;encodeParam;credentials;constructor(e={}){this.apiKeys=e.apiKeys,this.username=e.username,this.password=e.password,this.accessToken=e.accessToken,this.basePath=e.basePath,this.withCredentials=e.withCredentials,this.encoder=e.encoder,this.encodeParam=e.encodeParam?e.encodeParam:n=>this.defaultEncodeParam(n),this.credentials=e.credentials?e.credentials:{}}selectHeaderContentType(e){if(0===e.length)return;const n=e.find(i=>this.isJsonMime(i));return void 0===n?e[0]:n}selectHeaderAccept(e){if(0===e.length)return;const n=e.find(i=>this.isJsonMime(i));return void 0===n?e[0]:n}isJsonMime(e){const n=new RegExp("^(application/json|[^;/ \t]+/[^;/ \t]+[+]json)[ \t]*(;.*)?$","i");return null!==e&&(n.test(e)||"application/json-patch+json"===e.toLowerCase())}lookupCredential(e){const n=this.credentials[e];return"function"==typeof n?n():n}defaultEncodeParam(e){const n="date-time"===e.dataFormat&&e.value instanceof Date?e.value.toISOString():e.value;return encodeURIComponent(String(n))}}let fT=(()=>{class t{httpClient;basePath="https://apps.humanatlas.io/api";defaultHeaders=new Ii;configuration=new Xu;encoder;constructor(n,i,r){this.httpClient=n,r&&(this.configuration=r),"string"!=typeof this.configuration.basePath&&("string"!=typeof i&&(i=this.basePath),this.configuration.basePath=i),this.encoder=this.configuration.encoder||new dT}addToHttpParams(n,i,r){return this.addToHttpParamsRecursive(n,i,r)}addToHttpParamsRecursive(n,i,r){if(null==i)return n;if("object"==typeof i)if(Array.isArray(i))i.forEach(s=>n=this.addToHttpParamsRecursive(n,s,r));else if(i instanceof Date){if(null==r)throw Error("key may not be null if value is Date");n=n.append(r,i.toISOString().substr(0,10))}else Object.keys(i).forEach(s=>n=this.addToHttpParamsRecursive(n,i[s],null!=r?`${r}.${s}`:s));else{if(null==r)throw Error("key may not be null if value is not object or array");n=n.append(r,i)}return n}aggregateResults(n,i="body",r=!1,s){const o=n.age,a=n.ageRange,c=n.bmi,l=n.bmiRange,u=n.cache,d=n.ontologyTerms,h=n.cellTypeTerms,f=n.consortiums,p=n.providers,g=n.sex,m=n.spatial,y=n.technologies,v=n.token;let _=new Ze({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(x=>{_=this.addToHttpParams(_,x,"ontology-terms")}),h&&h.forEach(x=>{_=this.addToHttpParams(_,x,"cell-type-terms")}),f&&f.forEach(x=>{_=this.addToHttpParams(_,x,"consortiums")}),p&&p.forEach(x=>{_=this.addToHttpParams(_,x,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(x=>{_=this.addToHttpParams(_,x,"spatial")}),y&&y.forEach(x=>{_=this.addToHttpParams(_,x,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let w=this.defaultHeaders,C=s&&s.httpHeaderAccept;void 0===C&&(C=this.configuration.selectHeaderAccept(["application/json"])),void 0!==C&&(w=w.set("Accept",C));let S=s&&s.context;void 0===S&&(S=new Ge);let M="json";return C&&(M=C.startsWith("text")?"text":this.configuration.isJsonMime(C)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/aggregate-results`,{context:S,params:_,responseType:M,withCredentials:this.configuration.withCredentials,headers:w,observe:i,reportProgress:r})}anatomicalSystemsTreeModel(n,i="body",r=!1,s){const o=n.cache,a=n.token;let c=new Ze({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ge);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/anatomical-systems-tree-model`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}biomarkerTermOccurences(n,i="body",r=!1,s){const o=n.age,a=n.ageRange,c=n.bmi,l=n.bmiRange,u=n.cache,d=n.ontologyTerms,h=n.cellTypeTerms,f=n.consortiums,p=n.providers,g=n.sex,m=n.spatial,y=n.technologies,v=n.token;let _=new Ze({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(x=>{_=this.addToHttpParams(_,x,"ontology-terms")}),h&&h.forEach(x=>{_=this.addToHttpParams(_,x,"cell-type-terms")}),f&&f.forEach(x=>{_=this.addToHttpParams(_,x,"consortiums")}),p&&p.forEach(x=>{_=this.addToHttpParams(_,x,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(x=>{_=this.addToHttpParams(_,x,"spatial")}),y&&y.forEach(x=>{_=this.addToHttpParams(_,x,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let w=this.defaultHeaders,C=s&&s.httpHeaderAccept;void 0===C&&(C=this.configuration.selectHeaderAccept(["application/json"])),void 0!==C&&(w=w.set("Accept",C));let S=s&&s.context;void 0===S&&(S=new Ge);let M="json";return C&&(M=C.startsWith("text")?"text":this.configuration.isJsonMime(C)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/biomarker-term-occurences`,{context:S,params:_,responseType:M,withCredentials:this.configuration.withCredentials,headers:w,observe:i,reportProgress:r})}biomarkerTreeModel(n,i="body",r=!1,s){const o=n.cache,a=n.token;let c=new Ze({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ge);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/biomarker-tree-model`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}cellTypeTermOccurences(n,i="body",r=!1,s){const o=n.age,a=n.ageRange,c=n.bmi,l=n.bmiRange,u=n.cache,d=n.ontologyTerms,h=n.cellTypeTerms,f=n.consortiums,p=n.providers,g=n.sex,m=n.spatial,y=n.technologies,v=n.token;let _=new Ze({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(x=>{_=this.addToHttpParams(_,x,"ontology-terms")}),h&&h.forEach(x=>{_=this.addToHttpParams(_,x,"cell-type-terms")}),f&&f.forEach(x=>{_=this.addToHttpParams(_,x,"consortiums")}),p&&p.forEach(x=>{_=this.addToHttpParams(_,x,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(x=>{_=this.addToHttpParams(_,x,"spatial")}),y&&y.forEach(x=>{_=this.addToHttpParams(_,x,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let w=this.defaultHeaders,C=s&&s.httpHeaderAccept;void 0===C&&(C=this.configuration.selectHeaderAccept(["application/json"])),void 0!==C&&(w=w.set("Accept",C));let S=s&&s.context;void 0===S&&(S=new Ge);let M="json";return C&&(M=C.startsWith("text")?"text":this.configuration.isJsonMime(C)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/cell-type-term-occurences`,{context:S,params:_,responseType:M,withCredentials:this.configuration.withCredentials,headers:w,observe:i,reportProgress:r})}cellTypeTreeModel(n,i="body",r=!1,s){const o=n.cache,a=n.token;let c=new Ze({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ge);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/cell-type-tree-model`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}collisions(n,i="body",r=!1,s){const o=n.spatialEntity;if(null==o)throw new Error("Required parameter spatialEntity was null or undefined when calling collisions.");let a=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(a=a.set("Accept",c));let l=s&&s.context;void 0===l&&(l=new Ge);const d=this.configuration.selectHeaderContentType(["application/json"]);void 0!==d&&(a=a.set("Content-Type",d));let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/v1/collisions`,o,{context:l,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:i,reportProgress:r})}corridor(n,i="body",r=!1,s){const o=n.spatialEntity;if(null==o)throw new Error("Required parameter spatialEntity was null or undefined when calling corridor.");let a=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["model/gltf-binary","application/json"])),void 0!==c&&(a=a.set("Accept",c));let l=s&&s.context;void 0===l&&(l=new Ge);const d=this.configuration.selectHeaderContentType(["application/json"]);return void 0!==d&&(a=a.set("Content-Type",d)),this.httpClient.post(`${this.configuration.basePath}/v1/corridor`,o,{context:l,responseType:"blob",withCredentials:this.configuration.withCredentials,headers:a,observe:i,reportProgress:r})}dbStatus(n,i="body",r=!1,s){const o=n.token;let a=new Ze({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"token"));let c=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(c=c.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Ge);let d="json";return l&&(d=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/db-status`,{context:u,params:a,responseType:d,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}dsGraph(n,i="body",r=!1,s){const o=n.age,a=n.ageRange,c=n.bmi,l=n.bmiRange,u=n.cache,d=n.ontologyTerms,h=n.cellTypeTerms,f=n.consortiums,p=n.providers,g=n.sex,m=n.spatial,y=n.technologies,v=n.token;let _=new Ze({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(x=>{_=this.addToHttpParams(_,x,"ontology-terms")}),h&&h.forEach(x=>{_=this.addToHttpParams(_,x,"cell-type-terms")}),f&&f.forEach(x=>{_=this.addToHttpParams(_,x,"consortiums")}),p&&p.forEach(x=>{_=this.addToHttpParams(_,x,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(x=>{_=this.addToHttpParams(_,x,"spatial")}),y&&y.forEach(x=>{_=this.addToHttpParams(_,x,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let w=this.defaultHeaders,C=s&&s.httpHeaderAccept;void 0===C&&(C=this.configuration.selectHeaderAccept(["application/json"])),void 0!==C&&(w=w.set("Accept",C));let S=s&&s.context;void 0===S&&(S=new Ge);let M="json";return C&&(M=C.startsWith("text")?"text":this.configuration.isJsonMime(C)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/ds-graph`,{context:S,params:_,responseType:M,withCredentials:this.configuration.withCredentials,headers:w,observe:i,reportProgress:r})}extractionSite(n,i="body",r=!1,s){const o=n.iri;if(null==o)throw new Error("Required parameter iri was null or undefined when calling extractionSite.");let a=new Ze({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"iri"));let c=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(c=c.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Ge);let d="json";return l&&(d=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/extraction-site`,{context:u,params:a,responseType:d,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}getSpatialPlacement(n,i="body",r=!1,s){const o=n.getSpatialPlacementRequest;if(null==o)throw new Error("Required parameter getSpatialPlacementRequest was null or undefined when calling getSpatialPlacement.");let a=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(a=a.set("Accept",c));let l=s&&s.context;void 0===l&&(l=new Ge);const d=this.configuration.selectHeaderContentType(["application/json"]);void 0!==d&&(a=a.set("Content-Type",d));let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/v1/get-spatial-placement`,o,{context:l,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:i,reportProgress:r})}gtexRuiLocations(n,i="body",r=!1,s){const o=n.cache;let a=new Ze({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"cache"));let c=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(c=c.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new Ge);let d="json";return l&&(d=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/gtex/rui_locations.jsonld`,{context:u,params:a,responseType:d,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}hubmapRuiLocations(n,i="body",r=!1,s){const o=n.cache,a=n.token;let c=new Ze({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ge);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/hubmap/rui_locations.jsonld`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}mesh3dCellPopulation(n,i="body",r=!1,s){const o=n.mesh3dCellPopulationRequest;if(null==o)throw new Error("Required parameter mesh3dCellPopulationRequest was null or undefined when calling mesh3dCellPopulation.");let a=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["text/csv","application/json"])),void 0!==c&&(a=a.set("Accept",c));let l=s&&s.context;void 0===l&&(l=new Ge);const d=this.configuration.selectHeaderContentType(["application/json"]);return void 0!==d&&(a=a.set("Content-Type",d)),this.httpClient.post(`${this.configuration.basePath}/v1/mesh-3d-cell-population`,o,{context:l,responseType:"blob",withCredentials:this.configuration.withCredentials,headers:a,observe:i,reportProgress:r})}ontologyTermOccurences(n,i="body",r=!1,s){const o=n.age,a=n.ageRange,c=n.bmi,l=n.bmiRange,u=n.cache,d=n.ontologyTerms,h=n.cellTypeTerms,f=n.consortiums,p=n.providers,g=n.sex,m=n.spatial,y=n.technologies,v=n.token;let _=new Ze({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(x=>{_=this.addToHttpParams(_,x,"ontology-terms")}),h&&h.forEach(x=>{_=this.addToHttpParams(_,x,"cell-type-terms")}),f&&f.forEach(x=>{_=this.addToHttpParams(_,x,"consortiums")}),p&&p.forEach(x=>{_=this.addToHttpParams(_,x,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(x=>{_=this.addToHttpParams(_,x,"spatial")}),y&&y.forEach(x=>{_=this.addToHttpParams(_,x,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let w=this.defaultHeaders,C=s&&s.httpHeaderAccept;void 0===C&&(C=this.configuration.selectHeaderAccept(["application/json"])),void 0!==C&&(w=w.set("Accept",C));let S=s&&s.context;void 0===S&&(S=new Ge);let M="json";return C&&(M=C.startsWith("text")?"text":this.configuration.isJsonMime(C)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/ontology-term-occurences`,{context:S,params:_,responseType:M,withCredentials:this.configuration.withCredentials,headers:w,observe:i,reportProgress:r})}ontologyTreeModel(n,i="body",r=!1,s){const o=n.cache,a=n.token;let c=new Ze({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ge);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/ontology-tree-model`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}providerNames(n,i="body",r=!1,s){const o=n.cache,a=n.token;let c=new Ze({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ge);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/provider-names`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}referenceOrganScene(n,i="body",r=!1,s){const o=n.organIri;if(null==o)throw new Error("Required parameter organIri was null or undefined when calling referenceOrganScene.");const a=n.age,c=n.ageRange,l=n.bmi,u=n.bmiRange,d=n.cache,h=n.ontologyTerms,f=n.cellTypeTerms,p=n.consortiums,g=n.providers,m=n.sex,y=n.spatial,v=n.technologies,_=n.token;let w=new Ze({encoder:this.encoder});null!=a&&(w=this.addToHttpParams(w,a,"age")),null!=c&&(w=this.addToHttpParams(w,c,"age-range")),null!=l&&(w=this.addToHttpParams(w,l,"bmi")),null!=u&&(w=this.addToHttpParams(w,u,"bmi-range")),null!=d&&(w=this.addToHttpParams(w,d,"cache")),h&&h.forEach(N=>{w=this.addToHttpParams(w,N,"ontology-terms")}),f&&f.forEach(N=>{w=this.addToHttpParams(w,N,"cell-type-terms")}),null!=o&&(w=this.addToHttpParams(w,o,"organ-iri")),p&&p.forEach(N=>{w=this.addToHttpParams(w,N,"consortiums")}),g&&g.forEach(N=>{w=this.addToHttpParams(w,N,"providers")}),null!=m&&(w=this.addToHttpParams(w,m,"sex")),y&&y.forEach(N=>{w=this.addToHttpParams(w,N,"spatial")}),v&&v.forEach(N=>{w=this.addToHttpParams(w,N,"technologies")}),null!=_&&(w=this.addToHttpParams(w,_,"token"));let C=this.defaultHeaders,S=s&&s.httpHeaderAccept;void 0===S&&(S=this.configuration.selectHeaderAccept(["application/json"])),void 0!==S&&(C=C.set("Accept",S));let M=s&&s.context;void 0===M&&(M=new Ge);let x="json";return S&&(x=S.startsWith("text")?"text":this.configuration.isJsonMime(S)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/reference-organ-scene`,{context:M,params:w,responseType:x,withCredentials:this.configuration.withCredentials,headers:C,observe:i,reportProgress:r})}referenceOrgans(n,i="body",r=!1,s){const o=n.cache,a=n.token;let c=new Ze({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ge);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/reference-organs`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}ruiReferenceData(n="body",i=!1,r){let s=this.defaultHeaders,o=r&&r.httpHeaderAccept;void 0===o&&(o=this.configuration.selectHeaderAccept(["application/json"])),void 0!==o&&(s=s.set("Accept",o));let a=r&&r.context;void 0===a&&(a=new Ge);let c="json";return o&&(c=o.startsWith("text")?"text":this.configuration.isJsonMime(o)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/rui-reference-data`,{context:a,responseType:c,withCredentials:this.configuration.withCredentials,headers:s,observe:n,reportProgress:i})}scene(n,i="body",r=!1,s){const o=n.age,a=n.ageRange,c=n.bmi,l=n.bmiRange,u=n.cache,d=n.ontologyTerms,h=n.cellTypeTerms,f=n.consortiums,p=n.providers,g=n.sex,m=n.spatial,y=n.technologies,v=n.token;let _=new Ze({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(x=>{_=this.addToHttpParams(_,x,"ontology-terms")}),h&&h.forEach(x=>{_=this.addToHttpParams(_,x,"cell-type-terms")}),f&&f.forEach(x=>{_=this.addToHttpParams(_,x,"consortiums")}),p&&p.forEach(x=>{_=this.addToHttpParams(_,x,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(x=>{_=this.addToHttpParams(_,x,"spatial")}),y&&y.forEach(x=>{_=this.addToHttpParams(_,x,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let w=this.defaultHeaders,C=s&&s.httpHeaderAccept;void 0===C&&(C=this.configuration.selectHeaderAccept(["application/json"])),void 0!==C&&(w=w.set("Accept",C));let S=s&&s.context;void 0===S&&(S=new Ge);let M="json";return C&&(M=C.startsWith("text")?"text":this.configuration.isJsonMime(C)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/scene`,{context:S,params:_,responseType:M,withCredentials:this.configuration.withCredentials,headers:w,observe:i,reportProgress:r})}sennetRuiLocations(n,i="body",r=!1,s){const o=n.cache,a=n.token;let c=new Ze({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ge);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/sennet/rui_locations.jsonld`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}sessionToken(n,i="body",r=!1,s){const o=n.sessionTokenRequest;if(null==o)throw new Error("Required parameter sessionTokenRequest was null or undefined when calling sessionToken.");let a=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(a=a.set("Accept",c));let l=s&&s.context;void 0===l&&(l=new Ge);const d=this.configuration.selectHeaderContentType(["application/json"]);void 0!==d&&(a=a.set("Content-Type",d));let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/v1/session-token`,o,{context:l,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:i,reportProgress:r})}sparql(n,i="body",r=!1,s){const o=n.query;if(null==o)throw new Error("Required parameter query was null or undefined when calling sparql.");const a=n.token,c=n.format;let l=new Ze({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"query")),null!=a&&(l=this.addToHttpParams(l,a,"token")),null!=c&&(l=this.addToHttpParams(l,c,"format"));let u=this.defaultHeaders,d=s&&s.httpHeaderAccept;void 0===d&&(d=this.configuration.selectHeaderAccept(["application/json","text/csv"])),void 0!==d&&(u=u.set("Accept",d));let h=s&&s.context;void 0===h&&(h=new Ge);let f="json";return d&&(f=d.startsWith("text")?"text":this.configuration.isJsonMime(d)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/sparql`,{context:h,params:l,responseType:f,withCredentials:this.configuration.withCredentials,headers:u,observe:i,reportProgress:r})}sparqlPost(n,i="body",r=!1,s){const o=n.sparqlQueryRequest;if(null==o)throw new Error("Required parameter sparqlQueryRequest was null or undefined when calling sparqlPost.");const a=n.token,c=n.format;let l=new Ze({encoder:this.encoder});null!=a&&(l=this.addToHttpParams(l,a,"token")),null!=c&&(l=this.addToHttpParams(l,c,"format"));let u=this.defaultHeaders,d=s&&s.httpHeaderAccept;void 0===d&&(d=this.configuration.selectHeaderAccept(["application/json","text/csv"])),void 0!==d&&(u=u.set("Accept",d));let h=s&&s.context;void 0===h&&(h=new Ge);const p=this.configuration.selectHeaderContentType(["application/json","application/x-www-form-urlencoded"]);void 0!==p&&(u=u.set("Content-Type",p));let g="json";return d&&(g=d.startsWith("text")?"text":this.configuration.isJsonMime(d)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/v1/sparql`,o,{context:h,params:l,responseType:g,withCredentials:this.configuration.withCredentials,headers:u,observe:i,reportProgress:r})}technologyNames(n,i="body",r=!1,s){const o=n.cache,a=n.token;let c=new Ze({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new Ge);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/technology-names`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}tissueBlocks(n,i="body",r=!1,s){const o=n.age,a=n.ageRange,c=n.bmi,l=n.bmiRange,u=n.cache,d=n.ontologyTerms,h=n.cellTypeTerms,f=n.consortiums,p=n.providers,g=n.sex,m=n.spatial,y=n.technologies,v=n.token;let _=new Ze({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(x=>{_=this.addToHttpParams(_,x,"ontology-terms")}),h&&h.forEach(x=>{_=this.addToHttpParams(_,x,"cell-type-terms")}),f&&f.forEach(x=>{_=this.addToHttpParams(_,x,"consortiums")}),p&&p.forEach(x=>{_=this.addToHttpParams(_,x,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(x=>{_=this.addToHttpParams(_,x,"spatial")}),y&&y.forEach(x=>{_=this.addToHttpParams(_,x,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let w=this.defaultHeaders,C=s&&s.httpHeaderAccept;void 0===C&&(C=this.configuration.selectHeaderAccept(["application/json"])),void 0!==C&&(w=w.set("Accept",C));let S=s&&s.context;void 0===S&&(S=new Ge);let M="json";return C&&(M=C.startsWith("text")?"text":this.configuration.isJsonMime(C)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/tissue-blocks`,{context:S,params:_,responseType:M,withCredentials:this.configuration.withCredentials,headers:w,observe:i,reportProgress:r})}static \u0275fac=function(i){return new(i||t)(D(Us),D(hT,8),D(Xu,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const pT=new de,Yu={cacheBusterObserver:pT},$c={cacheBusterObserver:pT,maxCacheCount:4};function LU(t,e,n){return t?{min:t[0]>e?t[0]:void 0,max:t[1]<n?t[1]:void 0}:void 0}function nde(t){return t.map(e=>({...e,transformMatrix:new Le(e.transformMatrix??[])}))}function ide(t){return{age:LU(t?.ageRange,1,110),bmi:LU(t?.bmiRange,13,83),sex:t?.sex?.toLowerCase(),ontologyTerms:t?.ontologyTerms,cellTypeTerms:t?.cellTypeTerms,biomarkerTerms:t?.biomarkerTerms,consortiums:t?.consortiums,providers:t?.tmc,technologies:t?.technologies,spatial:t?.spatialSearches}}class Yn{constructor(e,n){this.api=e,this.globalConfig=n,this.initialized=new Os(1),this.getSessionToken().pipe(At(i=>n.patchConfig({token:i})),At(pT),Ty(1)).subscribe(()=>{this.initialized.closed||(this.initialized.next(),this.initialized.complete())})}getDatabaseStatus(){return this.doRequest(e=>this.api.dbStatus(e))}getProviderNames(){return this.doRequest(e=>this.api.providerNames(e))}getDatasetTechnologyNames(){return this.doRequest(e=>this.api.technologyNames(e))}getOntologyTreeModel(){return this.doRequest(e=>this.api.ontologyTreeModel(e),void 0,{},t=>t)}getCellTypeTreeModel(){return this.doRequest(e=>this.api.cellTypeTreeModel(e),void 0,{},t=>t)}getBiomarkerTreeModel(){return this.doRequest(e=>this.api.biomarkerTreeModel(e),void 0,{},t=>t)}getReferenceOrgans(){return this.doRequest(e=>this.api.referenceOrgans(e),void 0,{},t=>t)}getTissueBlockResults(e){return this.doRequest(n=>this.api.tissueBlocks(n),e,{},t=>t)}getAggregateResults(e){return this.doRequest(n=>this.api.aggregateResults(n),e)}getOntologyTermOccurences(e){return this.doRequest(n=>this.api.ontologyTermOccurences(n),e)}getCellTypeTermOccurences(e){return this.doRequest(n=>this.api.cellTypeTermOccurences(n),e)}getBiomarkerTermOccurences(e){return this.doRequest(n=>this.api.biomarkerTermOccurences(n),e)}getScene(e){return this.doRequest(n=>this.api.scene(n),e,{},nde)}getReferenceOrganScene(e,n){return this.doRequest(i=>this.api.referenceOrganScene(i),n,{organIri:e})}doRequest(e,n,i,r){const{api:s,globalConfig:o}=this,a={...ide(n),...i};return Do([o.getOption("remoteApiEndpoint"),o.getOption("token"),this.initialized]).pipe(Ty(1),Dn(1),At(([c,l])=>{s.configuration.basePath=c,l&&(a.token=l)}),hn(()=>e(a)),se(c=>r?r(c):c))}getSessionToken(){const{globalConfig:e}=this;return Do([e.getOption("dataSources"),e.getOption("filter")]).pipe(Ty(50),hn(r=>this.getSessionTokenImpl(...r)),hn(r=>this.ensureDatabaseReady(r)))}getSessionTokenImpl(e,n){if((void 0===e||0===e.length)&&void 0===n)return ne(void 0);const{api:i,globalConfig:r}=this,s={dataSources:e??[],filter:n};return r.getOption("remoteApiEndpoint").pipe(At(o=>i.configuration.basePath=o),hn(()=>i.sessionToken({sessionTokenRequest:s})),se(({token:o})=>o))}ensureDatabaseReady(e){return ne(void 0).pipe(function oue(t){let n,e=1/0;return null!=t&&("object"==typeof t?({count:e=1/0,delay:n}=t):e=t),e<=0?()=>Hi:_t((i,r)=>{let o,s=0;const a=()=>{if(o?.unsubscribe(),o=null,null!=n){const l="number"==typeof n?Sy(n):un(n(s)),u=ot(r,()=>{u.unsubscribe(),c()});l.subscribe(u)}else c()},c=()=>{let l=!1;o=i.subscribe(ot(r,void 0,()=>{++s<e?o?a():l=!0:r.complete()})),l&&a()};c()})}({delay:()=>this.api.dbStatus({token:e}).pipe(ht(i=>"Ready"!==i.status),hn(i=>ne(void 0).pipe(dU(i.checkback??0))))}),lU(),function aue(...t){return e=>wf(e,ne(...t))}(e))}static#e=this.\u0275fac=function(n){return new(n||Yn)(D(fT),D(xa))};static#t=this.\u0275prov=V({token:Yn,factory:Yn.\u0275fac,providedIn:"root"})}ze([fr(Yu),Z("design:type",Function),Z("design:paramtypes",[]),Z("design:returntype",ge)],Yn.prototype,"getProviderNames",null),ze([fr(Yu),Z("design:type",Function),Z("design:paramtypes",[]),Z("design:returntype",ge)],Yn.prototype,"getDatasetTechnologyNames",null),ze([fr(Yu),Z("design:type",Function),Z("design:paramtypes",[]),Z("design:returntype",ge)],Yn.prototype,"getOntologyTreeModel",null),ze([fr(Yu),Z("design:type",Function),Z("design:paramtypes",[]),Z("design:returntype",ge)],Yn.prototype,"getCellTypeTreeModel",null),ze([fr(Yu),Z("design:type",Function),Z("design:paramtypes",[]),Z("design:returntype",ge)],Yn.prototype,"getBiomarkerTreeModel",null),ze([fr(Yu),Z("design:type",Function),Z("design:paramtypes",[]),Z("design:returntype",ge)],Yn.prototype,"getReferenceOrgans",null),ze([fr($c),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",ge)],Yn.prototype,"getTissueBlockResults",null),ze([fr($c),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",ge)],Yn.prototype,"getAggregateResults",null),ze([fr($c),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",ge)],Yn.prototype,"getOntologyTermOccurences",null),ze([fr($c),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",ge)],Yn.prototype,"getCellTypeTermOccurences",null),ze([fr($c),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",ge)],Yn.prototype,"getBiomarkerTermOccurences",null),ze([fr($c),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",ge)],Yn.prototype,"getScene",null),ze([fr($c),Z("design:type",Function),Z("design:paramtypes",[String,Object]),Z("design:returntype",ge)],Yn.prototype,"getReferenceOrganScene",null);class FU extends Error{constructor(){super(...arguments),this.message="NgxsDispatchPluginModule is not imported"}}class lde{constructor(){this.cancelUncompleted$=new de}cancelPreviousAction(){this.cancelUncompleted$.next()}}const gT="\u0275fac",BU=Symbol("InjectorInstance"),kU=Symbol("FactoryHasBeenDecorated");function UU(t,e){const n=t[BU];return n?n.get(e):null}const hde={cancelUncompleted:!1};function VU(t=hde){return(e,n,i)=>{let r;const s=function ude(t){return t?new lde:null}(t.cancelUncompleted);function o(){null!==s&&s.cancelPreviousAction();const a=UU(this,Pr)||function ade(){throw new FU}(),c=UU(this,_e)||function cde(){throw new FU}(),l=r.apply(this,arguments);return c.runOutsideAngular(()=>function ode(t,e,n){return Rc(e)?function sde(t,e){return e.then(n=>(t.dispatch(n),n))}(t,e):os(e)?function rde(t,e,n){return null!==n&&(e=e.pipe(Ns(n.cancelUncompleted$))),e.subscribe({next:i=>t.dispatch(i)}),e}(t,e,n):(t.dispatch(e),e)}(a,l,s))}"function"==typeof i?.value?(r=i.value,i.value=o):Object.defineProperty(e,n,{set:a=>r=a,get:()=>o}),function dde(t){if(kU in t.constructor.prototype)return;const e=t.constructor;"function"==typeof e[gT]&&function mT(t){const e=t[gT];if("function"!=typeof e)return;const n=t.\u0275prov||t.\u0275pipe||t.\u0275cmp||t.\u0275dir,i=()=>{const r=e();return r[BU]=j(Sg),r};n&&(n.factory=i),Object.defineProperty(t,gT,{get:()=>i})}(e),t.constructor.prototype[kU]=!0}(e)}}let jU=(()=>{class t{static#e=this.type="[CallToAction] Learn More"}return t})(),HU=(()=>{class t{static#e=this.type="[CallToAction] Open Dialog"}return t})(),zU=(()=>{class t{static#e=this.type="[CallToAction] Close Dialog"}return t})();function GU(t,e=0){return function fde(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}(t)?Number(t):2===arguments.length?e:0}function WU(t){return Array.isArray(t)?t:[t]}function gn(t){return null==t?"":"string"==typeof t?t:`${t}px`}function Oy(t){return t instanceof en?t.nativeElement:t}const pde=["addListener","removeListener"],gde=["addEventListener","removeEventListener"],mde=["on","off"];function Py(t,e,n,i){if(Fe(n)&&(i=n,n=void 0),i)return Py(t,e,n).pipe(V_(i));const[r,s]=function vde(t){return Fe(t.addEventListener)&&Fe(t.removeEventListener)}(t)?gde.map(o=>a=>t[o](e,a,n)):function _de(t){return Fe(t.addListener)&&Fe(t.removeListener)}(t)?pde.map($U(t,e)):function yde(t){return Fe(t.on)&&Fe(t.off)}(t)?mde.map($U(t,e)):[];if(!r&&AA(t))return dn(o=>Py(o,e,n))(un(t));if(!r)throw new TypeError("Invalid event target");return new ge(o=>{const a=(...c)=>o.next(1<c.length?c:c[0]);return r(a),()=>s(a)})}function $U(t,e){return n=>i=>t[n](e,i)}const Yf={schedule(t){let e=requestAnimationFrame,n=cancelAnimationFrame;const{delegate:i}=Yf;i&&(e=i.requestAnimationFrame,n=i.cancelAnimationFrame);const r=e(s=>{n=void 0,t(s)});return new bt(()=>n?.(r))},requestAnimationFrame(...t){const{delegate:e}=Yf;return(e?.requestAnimationFrame||requestAnimationFrame)(...t)},cancelAnimationFrame(...t){const{delegate:e}=Yf;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...t)},delegate:void 0};new class Ede extends sT{flush(e){this._active=!0;const n=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===n&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===n&&i.shift();)e.unsubscribe();throw r}}}(class bde extends rT{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}requestAsyncId(e,n,i=0){return null!==i&&i>0?super.requestAsyncId(e,n,i):(e.actions.push(this),e._scheduled||(e._scheduled=Yf.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,n,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,n,i);const{actions:s}=e;null!=n&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==n&&(Yf.cancelAnimationFrame(n),e._scheduled=void 0)}});let _T,Ade=1;const Ny={};function qU(t){return t in Ny&&(delete Ny[t],!0)}const Cde={setImmediate(t){const e=Ade++;return Ny[e]=!0,_T||(_T=Promise.resolve()),_T.then(()=>qU(e)&&t()),e},clearImmediate(t){qU(t)}},{setImmediate:Tde,clearImmediate:Sde}=Cde,Ly={setImmediate(...t){const{delegate:e}=Ly;return(e?.setImmediate||Tde)(...t)},clearImmediate(t){const{delegate:e}=Ly;return(e?.clearImmediate||Sde)(t)},delegate:void 0};new class Ide extends sT{flush(e){this._active=!0;const n=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===n&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===n&&i.shift();)e.unsubscribe();throw r}}}(class xde extends rT{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}requestAsyncId(e,n,i=0){return null!==i&&i>0?super.requestAsyncId(e,n,i):(e.actions.push(this),e._scheduled||(e._scheduled=Ly.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,n,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,n,i);const{actions:s}=e;null!=n&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==n&&(Ly.clearImmediate(n),e._scheduled=void 0)}});function XU(t,e=Cy){return function Dde(t){return _t((e,n)=>{let i=!1,r=null,s=null,o=!1;const a=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const l=r;r=null,n.next(l)}o&&n.complete()},c=()=>{s=null,o&&n.complete()};e.subscribe(ot(n,l=>{i=!0,r=l,s||un(t(l)).subscribe(s=ot(n,a,c))},()=>{o=!0,(!i||!s||s.closed)&&n.complete()}))})}(()=>Sy(t,e))}let yT;try{yT=typeof Intl<"u"&&Intl.v8BreakIterator}catch{yT=!1}let Kf,No=(()=>{class t{constructor(n){this._platformId=n,this.isBrowser=this._platformId?Ca(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!yT)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static#e=this.\u0275fac=function(i){return new(i||t)(D(Mr))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function KU(t){return function Rde(){if(null==Kf&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Kf=!0}))}finally{Kf=Kf||!1}return Kf}()?t:!!t.capture}var Vs=function(t){return t[t.NORMAL=0]="NORMAL",t[t.NEGATED=1]="NEGATED",t[t.INVERTED=2]="INVERTED",t}(Vs||{});let Fy,qc,vT;function JU(){if(null==qc){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return qc=!1,qc;if("scrollBehavior"in document.documentElement.style)qc=!0;else{const t=Element.prototype.scrollTo;qc=!!t&&!/\{\s*\[native code\]\s*\}/.test(t.toString())}}return qc}function Jf(){if("object"!=typeof document||!document)return Vs.NORMAL;if(null==Fy){const t=document.createElement("div"),e=t.style;t.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const n=document.createElement("div"),i=n.style;i.width="2px",i.height="1px",t.appendChild(n),document.body.appendChild(t),Fy=Vs.NORMAL,0===t.scrollLeft&&(t.scrollLeft=1,Fy=0===t.scrollLeft?Vs.NEGATED:Vs.INVERTED),t.remove()}return Fy}function bT(){let t=typeof document<"u"&&document?document.activeElement:null;for(;t&&t.shadowRoot;){const e=t.shadowRoot.activeElement;if(e===t)break;t=e}return t}function Xc(t){return t.composedPath?t.composedPath()[0]:t.target}function ZU(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}const Nde=new L("cdk-dir-doc",{providedIn:"root",factory:function Lde(){return O(Ye)}}),Fde=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let By=(()=>{class t{constructor(n){this.value="ltr",this.change=new Pe,n&&(this.value=function Bde(t){const e=t?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?Fde.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((n.body?n.body.dir:null)||(n.documentElement?n.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static#e=this.\u0275fac=function(i){return new(i||t)(D(Nde,8))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),QU=(()=>{class t{constructor(n,i,r){this._ngZone=n,this._platform=i,this._scrolled=new de,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(n){this.scrollContainers.has(n)||this.scrollContainers.set(n,n.elementScrolled().subscribe(()=>this._scrolled.next(n)))}deregister(n){const i=this.scrollContainers.get(n);i&&(i.unsubscribe(),this.scrollContainers.delete(n))}scrolled(n=20){return this._platform.isBrowser?new ge(i=>{this._globalSubscription||this._addGlobalListener();const r=n>0?this._scrolled.pipe(XU(n)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):ne()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((n,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(n,i){const r=this.getAncestorScrollContainers(n);return this.scrolled(i).pipe(ht(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(n){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,n)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(n,i){let r=Oy(i),s=n.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Py(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static#e=this.\u0275fac=function(i){return new(i||t)(D(_e),D(No),D(Ye,8))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Ude=(()=>{class t{constructor(n,i,r,s){this.elementRef=n,this.scrollDispatcher=i,this.ngZone=r,this.dir=s,this._destroyed=new de,this._elementScrolled=new ge(o=>this.ngZone.runOutsideAngular(()=>Py(this.elementRef.nativeElement,"scroll").pipe(Ns(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(n){const i=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==n.left&&(n.left=r?n.end:n.start),null==n.right&&(n.right=r?n.start:n.end),null!=n.bottom&&(n.top=i.scrollHeight-i.clientHeight-n.bottom),r&&Jf()!=Vs.NORMAL?(null!=n.left&&(n.right=i.scrollWidth-i.clientWidth-n.left),Jf()==Vs.INVERTED?n.left=n.right:Jf()==Vs.NEGATED&&(n.left=n.right?-n.right:n.right)):null!=n.right&&(n.left=i.scrollWidth-i.clientWidth-n.right),this._applyScrollToOptions(n)}_applyScrollToOptions(n){const i=this.elementRef.nativeElement;JU()?i.scrollTo(n):(null!=n.top&&(i.scrollTop=n.top),null!=n.left&&(i.scrollLeft=n.left))}measureScrollOffset(n){const i="left",r="right",s=this.elementRef.nativeElement;if("top"==n)return s.scrollTop;if("bottom"==n)return s.scrollHeight-s.clientHeight-s.scrollTop;const o=this.dir&&"rtl"==this.dir.value;return"start"==n?n=o?r:i:"end"==n&&(n=o?i:r),o&&Jf()==Vs.INVERTED?n==i?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:o&&Jf()==Vs.NEGATED?n==i?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:n==i?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}static#e=this.\u0275fac=function(i){return new(i||t)(j(en),j(QU),j(_e),j(By,8))};static#t=this.\u0275dir=Xe({type:t,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0})}return t})(),eV=(()=>{class t{constructor(n,i,r){this._platform=n,this._change=new de,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(n.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const n=this._getWindow();n.removeEventListener("resize",this._changeListener),n.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const n={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),n}getViewportRect(){const n=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:n.top,left:n.left,bottom:n.top+r,right:n.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const n=this._document,i=this._getWindow(),r=n.documentElement,s=r.getBoundingClientRect();return{top:-s.top||n.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||n.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(n=20){return n>0?this._change.pipe(XU(n)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const n=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:n.innerWidth,height:n.innerHeight}:{width:0,height:0}}static#e=this.\u0275fac=function(i){return new(i||t)(D(No),D(_e),D(Ye,8))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class ET{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class wT extends ET{constructor(e,n,i,r,s){super(),this.component=e,this.viewContainerRef=n,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=s}}class AT extends ET{constructor(e,n,i,r){super(),this.templateRef=e,this.viewContainerRef=n,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,n=this.context){return this.context=n,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class jde extends ET{constructor(e){super(),this.element=e instanceof en?e.nativeElement:e}}class CT{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof wT?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof AT?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof jde?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Hde extends CT{constructor(e,n,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=n,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=o=>{const a=o.element,c=this._document.createComment("dom-portal");a.parentNode.insertBefore(c,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{c.parentNode&&c.parentNode.replaceChild(a,c)})},this._document=s}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector||lt.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let n=e.viewContainerRef,i=n.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=n.indexOf(i);-1!==r&&n.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let ky=(()=>{class t extends CT{constructor(n,i,r){super(),this._componentFactoryResolver=n,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new Pe,this.attachDomPortal=s=>{const o=s.element,a=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(a,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{a.parentNode&&a.parentNode.replaceChild(o,a)})},this._document=r}get portal(){return this._attachedPortal}set portal(n){this.hasAttached()&&!n&&!this._isInitialized||(this.hasAttached()&&super.detach(),n&&super.attach(n),this._attachedPortal=n||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(n){n.setAttachedHost(this);const i=null!=n.viewContainerRef?n.viewContainerRef:this._viewContainerRef,s=(n.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(n.component),o=i.createComponent(s,i.length,n.injector||i.injector,n.projectableNodes||void 0);return i!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=n,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(n){n.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(n.templateRef,n.context,{injector:n.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=n,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){const n=this._viewContainerRef.element.nativeElement;return n.nodeType===n.ELEMENT_NODE?n:n.parentNode}static#e=this.\u0275fac=function(i){return new(i||t)(j(ua),j(Ci),j(Ye))};static#t=this.\u0275dir=Xe({type:t,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[0,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],standalone:!0,features:[wo]})}return t})();const tV=JU();class zde{constructor(e,n){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=n}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=gn(-this._previousScrollPosition.left),e.style.top=gn(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,r=this._document.body.style,s=i.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),tV&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),tV&&(i.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const n=this._document.body,i=this._viewportRuler.getViewportSize();return n.scrollHeight>i.height||n.scrollWidth>i.width}}class Gde{constructor(e,n,i,r){this._scrollDispatcher=e,this._ngZone=n,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0).pipe(ht(n=>!n||!this._overlayRef.overlayElement.contains(n.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const n=this._viewportRuler.getViewportScrollPosition().top;Math.abs(n-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class nV{enable(){}disable(){}attach(){}}function TT(t,e){return e.some(n=>t.bottom<n.top||t.top>n.bottom||t.right<n.left||t.left>n.right)}function iV(t,e){return e.some(n=>t.top<n.top||t.bottom>n.bottom||t.left<n.left||t.right>n.right)}class Wde{constructor(e,n,i,r){this._scrollDispatcher=e,this._viewportRuler=n,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const n=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();TT(n,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let $de=(()=>{class t{constructor(n,i,r,s){this._scrollDispatcher=n,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new nV,this.close=o=>new Gde(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new zde(this._viewportRuler,this._document),this.reposition=o=>new Wde(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}static#e=this.\u0275fac=function(i){return new(i||t)(D(QU),D(eV),D(_e),D(Ye))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class rV{constructor(e){if(this.scrollStrategy=new nV,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const n=Object.keys(e);for(const i of n)void 0!==e[i]&&(this[i]=e[i])}}}class qde{constructor(e,n){this.connectionPair=e,this.scrollableViewProperties=n}}let sV=(()=>{class t{constructor(n){this._attachedOverlays=[],this._document=n}ngOnDestroy(){this.detach()}add(n){this.remove(n),this._attachedOverlays.push(n)}remove(n){const i=this._attachedOverlays.indexOf(n);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}static#e=this.\u0275fac=function(i){return new(i||t)(D(Ye))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Xde=(()=>{class t extends sV{constructor(n,i){super(n),this._ngZone=i,this._keydownListener=r=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const a=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>a.next(r)):a.next(r);break}}}add(n){super.add(n),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static#e=this.\u0275fac=function(i){return new(i||t)(D(Ye),D(_e,8))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Yde=(()=>{class t extends sV{constructor(n,i,r){super(n),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=Xc(s)},this._clickListener=s=>{const o=Xc(s),a="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const c=this._attachedOverlays.slice();for(let l=c.length-1;l>-1;l--){const u=c[l];if(u._outsidePointerEvents.observers.length<1||!u.hasAttached())continue;if(oV(u.overlayElement,o)||oV(u.overlayElement,a))break;const d=u._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>d.next(s)):d.next(s)}}}add(n){if(super.add(n),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const n=this._document.body;n.removeEventListener("pointerdown",this._pointerDownListener,!0),n.removeEventListener("click",this._clickListener,!0),n.removeEventListener("auxclick",this._clickListener,!0),n.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(n.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(n){n.addEventListener("pointerdown",this._pointerDownListener,!0),n.addEventListener("click",this._clickListener,!0),n.addEventListener("auxclick",this._clickListener,!0),n.addEventListener("contextmenu",this._clickListener,!0)}static#e=this.\u0275fac=function(i){return new(i||t)(D(Ye),D(No),D(_e,8))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function oV(t,e){const n=typeof ShadowRoot<"u"&&ShadowRoot;let i=e;for(;i;){if(i===t)return!0;i=n&&i instanceof ShadowRoot?i.host:i.parentNode}return!1}let Uy=(()=>{class t{constructor(n,i){this._platform=i,this._document=n}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const n="cdk-overlay-container";if(this._platform.isBrowser||ZU()){const r=this._document.querySelectorAll(`.${n}[platform="server"], .${n}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const i=this._document.createElement("div");i.classList.add(n),ZU()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}static#e=this.\u0275fac=function(i){return new(i||t)(D(Ye),D(No))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class Vy{constructor(e,n,i,r,s,o,a,c,l,u=!1,d){this._portalOutlet=e,this._host=n,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=c,this._outsideClickDispatcher=l,this._animationsDisabled=u,this._injector=d,this._backdropElement=null,this._backdropClick=new de,this._attachments=new de,this._detachments=new de,this._locationChanges=bt.EMPTY,this._backdropClickHandler=h=>this._backdropClick.next(h),this._backdropTransitionendHandler=h=>{this._disposeBackdrop(h.target)},this._keydownEvents=new de,this._outsidePointerEvents=new de,this._renders=new de,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy,this._afterRenderRef=p_(()=>function QO(t,e){!e&&Qd();const n=e?.injector??O(lt);return Fi(n)?(wi("NgAfterRender"),eP(t,n,!1,e?.phase??Ai.MixedReadWrite)):ZO}(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const n=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),Im(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof n?.onDestroy&&n.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),n}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=gn(this._config.width),e.height=gn(this._config.height),e.minWidth=gn(this._config.minWidth),e.minHeight=gn(this._config.minHeight),e.maxWidth=gn(this._config.maxWidth),e.maxHeight=gn(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,n,i){const r=WU(n||[]).filter(s=>!!s);r.length&&(i?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{const e=this._renders.pipe(Ns(Nc(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const aV="cdk-overlay-connected-position-bounding-box",Kde=/([A-Za-z%]+)$/;class Jde{get positions(){return this._preferredPositions}constructor(e,n,i,r,s){this._viewportRuler=n,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new de,this._resizeSubscription=bt.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add(aV),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,n=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[];let o;for(let a of this._preferredPositions){let c=this._getOriginPoint(e,r,a),l=this._getOverlayPoint(c,n,a),u=this._getOverlayFit(l,n,i,a);if(u.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,c);this._canFitWithFlexibleDimensions(u,l,i)?s.push({position:a,origin:c,overlayRect:n,boundingBoxRect:this._calculateBoundingBoxRect(c,a)}):(!o||o.overlayFit.visibleArea<u.visibleArea)&&(o={overlayFit:u,overlayPoint:l,originPoint:c,position:a,overlayRect:n})}if(s.length){let a=null,c=-1;for(const l of s){const u=l.boundingBoxRect.width*l.boundingBoxRect.height*(l.position.weight||1);u>c&&(c=u,a=l)}return this._isPushed=!1,void this._applyPosition(a.position,a.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Yc(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(aV),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const n=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,n)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,n,i){let r,s;if("center"==i.originX)r=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;r="start"==i.originX?o:a}return n.left<0&&(r-=n.left),s="center"==i.originY?e.top+e.height/2:"top"==i.originY?e.top:e.bottom,n.top<0&&(s-=n.top),{x:r,y:s}}_getOverlayPoint(e,n,i){let r,s;return r="center"==i.overlayX?-n.width/2:"start"===i.overlayX?this._isRtl()?-n.width:0:this._isRtl()?0:-n.width,s="center"==i.overlayY?-n.height/2:"top"==i.overlayY?0:-n.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,n,i,r){const s=lV(n);let{x:o,y:a}=e,c=this._getOffset(r,"x"),l=this._getOffset(r,"y");c&&(o+=c),l&&(a+=l);let h=0-a,f=a+s.height-i.height,p=this._subtractOverflows(s.width,0-o,o+s.width-i.width),g=this._subtractOverflows(s.height,h,f),m=p*g;return{visibleArea:m,isCompletelyWithinViewport:s.width*s.height===m,fitsInViewportVertically:g===s.height,fitsInViewportHorizontally:p==s.width}}_canFitWithFlexibleDimensions(e,n,i){if(this._hasFlexibleDimensions){const r=i.bottom-n.y,s=i.right-n.x,o=cV(this._overlayRef.getConfig().minHeight),a=cV(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=o&&o<=r)&&(e.fitsInViewportHorizontally||null!=a&&a<=s)}return!1}_pushOverlayOnScreen(e,n,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=lV(n),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),c=Math.max(s.top-i.top-e.y,0),l=Math.max(s.left-i.left-e.x,0);let u=0,d=0;return u=r.width<=s.width?l||-o:e.x<this._viewportMargin?s.left-i.left-e.x:0,d=r.height<=s.height?c||-a:e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:u,y:d},{x:e.x+u,y:e.y+d}}_applyPosition(e,n){if(this._setTransformOrigin(e),this._setOverlayElementStyles(n,e),this._setBoundingBoxStyles(n,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._positionChanges.observers.length){const i=this._getScrollVisibility();if(e!==this._lastPosition||!this._lastScrollVisibility||!function Zde(t,e){return t===e||t.isOriginClipped===e.isOriginClipped&&t.isOriginOutsideView===e.isOriginOutsideView&&t.isOverlayClipped===e.isOverlayClipped&&t.isOverlayOutsideView===e.isOverlayOutsideView}(this._lastScrollVisibility,i)){const r=new qde(e,i);this._positionChanges.next(r)}this._lastScrollVisibility=i}this._lastPosition=e,this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const n=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<n.length;s++)n[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,n){const i=this._viewportRect,r=this._isRtl();let s,o,a,u,d,h;if("top"===n.overlayY)o=e.y,s=i.height-o+this._viewportMargin;else if("bottom"===n.overlayY)a=i.height-e.y+2*this._viewportMargin,s=i.height-a+this._viewportMargin;else{const f=Math.min(i.bottom-e.y+i.top,e.y),p=this._lastBoundingBoxSize.height;s=2*f,o=e.y-f,s>p&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-p/2)}if("end"===n.overlayX&&!r||"start"===n.overlayX&&r)h=i.width-e.x+2*this._viewportMargin,u=e.x-this._viewportMargin;else if("start"===n.overlayX&&!r||"end"===n.overlayX&&r)d=e.x,u=i.right-e.x;else{const f=Math.min(i.right-e.x+i.left,e.x),p=this._lastBoundingBoxSize.width;u=2*f,d=e.x-f,u>p&&!this._isInitialRender&&!this._growAfterOpen&&(d=e.x-p/2)}return{top:o,left:d,bottom:a,right:h,width:u,height:s}}_setBoundingBoxStyles(e,n){const i=this._calculateBoundingBoxRect(e,n);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=gn(i.height),r.top=gn(i.top),r.bottom=gn(i.bottom),r.width=gn(i.width),r.left=gn(i.left),r.right=gn(i.right),r.alignItems="center"===n.overlayX?"center":"end"===n.overlayX?"flex-end":"flex-start",r.justifyContent="center"===n.overlayY?"center":"bottom"===n.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=gn(s)),o&&(r.maxWidth=gn(o))}this._lastBoundingBoxSize=i,Yc(this._boundingBox.style,r)}_resetBoundingBoxStyles(){Yc(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Yc(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,n){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const u=this._viewportRuler.getViewportScrollPosition();Yc(i,this._getExactOverlayY(n,e,u)),Yc(i,this._getExactOverlayX(n,e,u))}else i.position="static";let a="",c=this._getOffset(n,"x"),l=this._getOffset(n,"y");c&&(a+=`translateX(${c}px) `),l&&(a+=`translateY(${l}px)`),i.transform=a.trim(),o.maxHeight&&(r?i.maxHeight=gn(o.maxHeight):s&&(i.maxHeight="")),o.maxWidth&&(r?i.maxWidth=gn(o.maxWidth):s&&(i.maxWidth="")),Yc(this._pane.style,i)}_getExactOverlayY(e,n,i){let r={top:"",bottom:""},s=this._getOverlayPoint(n,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=gn(s.y),r}_getExactOverlayX(e,n,i){let o,r={left:"",right:""},s=this._getOverlayPoint(n,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=gn(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),n=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:iV(e,i),isOriginOutsideView:TT(e,i),isOverlayClipped:iV(n,i),isOverlayOutsideView:TT(n,i)}}_subtractOverflows(e,...n){return n.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,n=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+n-this._viewportMargin,width:e-2*this._viewportMargin,height:n-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,n){return"x"===n?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&WU(e).forEach(n=>{""!==n&&-1===this._appliedPanelClasses.indexOf(n)&&(this._appliedPanelClasses.push(n),this._pane.classList.add(n))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof en)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const n=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+n,height:i,width:n}}}function Yc(t,e){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function cV(t){if("number"!=typeof t&&null!=t){const[e,n]=t.split(Kde);return n&&"px"!==n?null:parseFloat(e)}return t||null}function lV(t){return{top:Math.floor(t.top),right:Math.floor(t.right),bottom:Math.floor(t.bottom),left:Math.floor(t.left),width:Math.floor(t.width),height:Math.floor(t.height)}}const uV="cdk-global-overlay-wrapper";class Qde{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const n=e.getConfig();this._overlayRef=e,this._width&&!n.width&&e.updateSize({width:this._width}),this._height&&!n.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(uV),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,n=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=i,c=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),l=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a),u=this._xPosition,d=this._xOffset,h="rtl"===this._overlayRef.getConfig().direction;let f="",p="",g="";c?g="flex-start":"center"===u?(g="center",h?p=d:f=d):h?"left"===u||"end"===u?(g="flex-end",f=d):("right"===u||"start"===u)&&(g="flex-start",p=d):"left"===u||"start"===u?(g="flex-start",f=d):("right"===u||"end"===u)&&(g="flex-end",p=d),e.position=this._cssPosition,e.marginLeft=c?"0":f,e.marginTop=l?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=c?"0":p,n.justifyContent=g,n.alignItems=l?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,n=this._overlayRef.hostElement,i=n.style;n.classList.remove(uV),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let ehe=(()=>{class t{constructor(n,i,r,s){this._viewportRuler=n,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new Qde}flexibleConnectedTo(n){return new Jde(n,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static#e=this.\u0275fac=function(i){return new(i||t)(D(eV),D(Ye),D(No),D(Uy))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),the=0,Oa=(()=>{class t{constructor(n,i,r,s,o,a,c,l,u,d,h,f){this.scrollStrategies=n,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=c,this._document=l,this._directionality=u,this._location=d,this._outsideClickDispatcher=h,this._animationsModuleType=f}create(n){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),o=new rV(n);return o.direction=o.direction||this._directionality.value,new Vy(s,i,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType,this._injector.get(oi))}position(){return this._positionBuilder}_createPaneElement(n){const i=this._document.createElement("div");return i.id="cdk-overlay-"+the++,i.classList.add("cdk-overlay-pane"),n.appendChild(i),i}_createHostElement(){const n=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(n),n}_createPortalOutlet(n){return this._appRef||(this._appRef=this._injector.get(ji)),new Hde(n,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static#e=this.\u0275fac=function(i){return new(i||t)(D($de),D(Uy),D(ua),D(ehe),D(Xde),D(lt),D(_e),D(Ye),D(By),D(Fc),D(Yde),D(gh,8))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function jy(t,...e){return e.length?e.some(n=>t[n]):t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}let ST=(()=>{class t{constructor(n){this._platform=n}isDisabled(n){return n.hasAttribute("disabled")}isVisible(n){return function Ohe(t){return!!(t.offsetWidth||t.offsetHeight||"function"==typeof t.getClientRects&&t.getClientRects().length)}(n)&&"visible"===getComputedStyle(n).visibility}isTabbable(n){if(!this._platform.isBrowser)return!1;const i=function Rhe(t){try{return t.frameElement}catch{return null}}(function Vhe(t){return t.ownerDocument&&t.ownerDocument.defaultView||window}(n));if(i&&(-1===vV(i)||!this.isVisible(i)))return!1;let r=n.nodeName.toLowerCase(),s=vV(n);return n.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function khe(t){let e=t.nodeName.toLowerCase(),n="input"===e&&t.type;return"text"===n||"password"===n||"select"===e||"textarea"===e}(n))&&("audio"===r?!!n.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||n.hasAttribute("controls")):n.tabIndex>=0)}isFocusable(n,i){return function Uhe(t){return!function Nhe(t){return function Fhe(t){return"input"==t.nodeName.toLowerCase()}(t)&&"hidden"==t.type}(t)&&(function Phe(t){let e=t.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(t)||function Lhe(t){return function Bhe(t){return"a"==t.nodeName.toLowerCase()}(t)&&t.hasAttribute("href")}(t)||t.hasAttribute("contenteditable")||yV(t))}(n)&&!this.isDisabled(n)&&(i?.ignoreVisibility||this.isVisible(n))}static#e=this.\u0275fac=function(i){return new(i||t)(D(No))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function yV(t){if(!t.hasAttribute("tabindex")||void 0===t.tabIndex)return!1;let e=t.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function vV(t){if(!yV(t))return null;const e=parseInt(t.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class bV{get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,n,i,r,s=!1,o){this._element=e,this._checker=n,this._ngZone=i,this._document=r,this._injector=o,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){const e=this._startAnchor,n=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),n&&(n.removeEventListener("focus",this.endAnchorListener),n.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(n=>{this._executeOnStable(()=>n(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(n=>{this._executeOnStable(()=>n(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(n=>{this._executeOnStable(()=>n(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const n=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?n.length?n[0]:this._getFirstTabbableElement(this._element):n.length?n[n.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const n=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(n){if(!this._checker.isFocusable(n)){const i=this._getFirstTabbableElement(n);return i?.focus(e),!!i}return n.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const n=this._getRegionBoundary("start");return n&&n.focus(e),!!n}focusLastTabbableElement(e){const n=this._getRegionBoundary("end");return n&&n.focus(e),!!n}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const n=e.children;for(let i=0;i<n.length;i++){const r=n[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(n[i]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const n=e.children;for(let i=n.length-1;i>=0;i--){const r=n[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(n[i]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,n){e?n.setAttribute("tabindex","0"):n.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._injector?Im(e,{injector:this._injector}):setTimeout(e)}}let EV=(()=>{class t{constructor(n,i,r){this._checker=n,this._ngZone=i,this._injector=O(lt),this._document=r}create(n,i=!1){return new bV(n,this._checker,this._ngZone,this._document,i,this._injector)}static#e=this.\u0275fac=function(i){return new(i||t)(D(ST),D(_e),D(Ye))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const zhe=new L("cdk-input-modality-detector-options"),Ghe={ignoreKeys:[18,17,224,91,16]},Ju=KU({passive:!0,capture:!0});let Whe=(()=>{class t{get mostRecentModality(){return this._modality.value}constructor(n,i,r,s){this._platform=n,this._mostRecentTarget=null,this._modality=new on(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(a=>a===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Xc(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(function jhe(t){return 0===t.buttons||0===t.detail}(o)?"keyboard":"mouse"),this._mostRecentTarget=Xc(o))},this._onTouchstart=o=>{!function Hhe(t){const e=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}(o)?(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Xc(o)):this._modality.next("keyboard")},this._options={...Ghe,...s},this.modalityDetected=this._modality.pipe(function q3(t){return ht((e,n)=>t<=n)}(1)),this.modalityChanged=this.modalityDetected.pipe(bf()),n.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,Ju),r.addEventListener("mousedown",this._onMousedown,Ju),r.addEventListener("touchstart",this._onTouchstart,Ju)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Ju),document.removeEventListener("mousedown",this._onMousedown,Ju),document.removeEventListener("touchstart",this._onTouchstart,Ju))}static#e=this.\u0275fac=function(i){return new(i||t)(D(No),D(_e),D(Ye),D(zhe,8))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Hy=function(t){return t[t.IMMEDIATE=0]="IMMEDIATE",t[t.EVENTUAL=1]="EVENTUAL",t}(Hy||{});const qhe=new L("cdk-focus-monitor-default-options"),zy=KU({passive:!0,capture:!0});let xT=(()=>{class t{constructor(n,i,r,s,o){this._ngZone=n,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new de,this._rootNodeFocusAndBlurListener=a=>{for(let l=Xc(a);l;l=l.parentElement)"focus"===a.type?this._onFocus(a,l):this._onBlur(a,l)},this._document=s,this._detectionMode=o?.detectionMode||Hy.IMMEDIATE}monitor(n,i=!1){const r=Oy(n);if(!this._platform.isBrowser||1!==r.nodeType)return ne();const s=function Pde(t){if(function Ode(){if(null==vT){const t=typeof document<"u"?document.head:null;vT=!(!t||!t.createShadowRoot&&!t.attachShadow)}return vT}()){const e=t.getRootNode?t.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const a={checkChildren:i,subject:new de,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(n){const i=Oy(n),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(n,i,r){const s=Oy(n);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,c])=>this._originChanged(a,i,c)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((n,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(n){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(n)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:n&&this._isLastInteractionFromInputLabel(n)?"mouse":"program"}_shouldBeAttributedToTouch(n){return this._detectionMode===Hy.EVENTUAL||!!n?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(n,i){n.classList.toggle("cdk-focused",!!i),n.classList.toggle("cdk-touch-focused","touch"===i),n.classList.toggle("cdk-keyboard-focused","keyboard"===i),n.classList.toggle("cdk-mouse-focused","mouse"===i),n.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(n,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=n,this._originFromTouchInteraction="touch"===n&&i,this._detectionMode===Hy.IMMEDIATE&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(n,i){const r=this._elementInfo.get(i),s=Xc(n);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(n,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&n.relatedTarget instanceof Node&&i.contains(n.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(n,i){n.subject.observers.length&&this._ngZone.run(()=>n.subject.next(i))}_registerGlobalListeners(n){if(!this._platform.isBrowser)return;const i=n.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,zy),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,zy)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Ns(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(n){const i=n.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,zy),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,zy),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(n,i,r){this._setClasses(n,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(n){const i=[];return this._elementInfo.forEach((r,s)=>{(s===n||r.checkChildren&&s.contains(n))&&i.push([s,r])}),i}_isLastInteractionFromInputLabel(n){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===n||"INPUT"!==n.nodeName&&"TEXTAREA"!==n.nodeName||n.disabled)return!1;const s=n.labels;if(s)for(let o=0;o<s.length;o++)if(s[o].contains(i))return!0;return!1}static#e=this.\u0275fac=function(i){return new(i||t)(D(_e),D(No),D(Whe),D(Ye,8),D(qhe,8))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Yhe(t,e){}class Gy{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}}let AV=(()=>{class t extends CT{constructor(n,i,r,s,o,a,c,l){super(),this._elementRef=n,this._focusTrapFactory=i,this._config=s,this._interactivityChecker=o,this._ngZone=a,this._overlayRef=c,this._focusMonitor=l,this._platform=O(No),this._focusTrap=null,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this._ariaLabelledByQueue=[],this._changeDetectorRef=O(lr),this._injector=O(lt),this._isDestroyed=!1,this.attachDomPortal=u=>{this._portalOutlet.hasAttached();const d=this._portalOutlet.attachDomPortal(u);return this._contentAttached(),d},this._document=r,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(n){this._ariaLabelledByQueue.push(n),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(n){const i=this._ariaLabelledByQueue.indexOf(n);i>-1&&(this._ariaLabelledByQueue.splice(i,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._isDestroyed=!0,this._restoreFocus()}attachComponentPortal(n){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachComponentPortal(n);return this._contentAttached(),i}attachTemplatePortal(n){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachTemplatePortal(n);return this._contentAttached(),i}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(n,i){this._interactivityChecker.isFocusable(n)||(n.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{n.removeEventListener("blur",r),n.removeEventListener("mousedown",r),n.removeAttribute("tabindex")};n.addEventListener("blur",r),n.addEventListener("mousedown",r)})),n.focus(i)}_focusByCssSelector(n,i){let r=this._elementRef.nativeElement.querySelector(n);r&&this._forceFocus(r,i)}_trapFocus(){this._isDestroyed||Im(()=>{const n=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||n.focus();break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElement()||this._focusDialogContainer();break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}},{injector:this._injector})}_restoreFocus(){const n=this._config.restoreFocus;let i=null;if("string"==typeof n?i=this._document.querySelector(n):"boolean"==typeof n?i=n?this._elementFocusedBeforeDialogWasOpened:null:n&&(i=n),this._config.restoreFocus&&i&&"function"==typeof i.focus){const r=bT(),s=this._elementRef.nativeElement;(!r||r===this._document.body||r===s||s.contains(r))&&(this._focusMonitor?(this._focusMonitor.focusVia(i,this._closeInteractionType),this._closeInteractionType=null):i.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const n=this._elementRef.nativeElement,i=bT();return n===i||n.contains(i)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=bT()))}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}static#e=this.\u0275fac=function(i){return new(i||t)(j(en),j(EV),j(Ye,8),j(Gy),j(ST),j(_e),j(Vy),j(xT))};static#t=this.\u0275cmp=an({type:t,selectors:[["cdk-dialog-container"]],viewQuery:function(i,r){if(1&i&&Su(ky,7),2&i){let s;ma(s=_a())&&(r._portalOutlet=s.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(i,r){2&i&&Is("id",r._config.id||null)("role",r._config.role)("aria-modal",r._config.ariaModal)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledByQueue[0])("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null)},standalone:!0,features:[wo,Vi],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(i,r){1&i&&es(0,Yhe,0,0,"ng-template",0)},dependencies:[ky],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2})}return t})();class IT{constructor(e,n){this.overlayRef=e,this.config=n,this.closed=new de,this.disableClose=n.disableClose,this.backdropClick=e.backdropClick(),this.keydownEvents=e.keydownEvents(),this.outsidePointerEvents=e.outsidePointerEvents(),this.id=n.id,this.keydownEvents.subscribe(i=>{27===i.keyCode&&!this.disableClose&&!jy(i)&&(i.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=e.detachments().subscribe(()=>{!1!==n.closeOnOverlayDetachments&&this.close()})}close(e,n){if(this.containerInstance){const i=this.closed;this.containerInstance._closeInteractionType=n?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),i.next(e),i.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(e="",n=""){return this.overlayRef.updateSize({width:e,height:n}),this}addPanelClass(e){return this.overlayRef.addPanelClass(e),this}removePanelClass(e){return this.overlayRef.removePanelClass(e),this}}const CV=new L("DialogScrollStrategy",{providedIn:"root",factory:()=>{const t=O(Oa);return()=>t.scrollStrategies.block()}}),Khe=new L("DialogData"),Jhe=new L("DefaultDialogConfig");let Qhe=0,efe=(()=>{class t{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(n,i,r,s,o,a){this._overlay=n,this._injector=i,this._defaultOptions=r,this._parentDialog=s,this._overlayContainer=o,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new de,this._afterOpenedAtThisLevel=new de,this._ariaHiddenElements=new Map,this.afterAllClosed=K_(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Sa(void 0))),this._scrollStrategy=a}open(n,i){(i={...this._defaultOptions||new Gy,...i}).id=i.id||"cdk-dialog-"+Qhe++,i.id&&this.getDialogById(i.id);const s=this._getOverlayConfig(i),o=this._overlay.create(s),a=new IT(o,i),c=this._attachContainer(o,a,i);return a.containerInstance=c,this._attachDialogContent(n,a,c,i),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(a),a.closed.subscribe(()=>this._removeOpenDialog(a,!0)),this.afterOpened.next(a),a}closeAll(){MT(this.openDialogs,n=>n.close())}getDialogById(n){return this.openDialogs.find(i=>i.id===n)}ngOnDestroy(){MT(this._openDialogsAtThisLevel,n=>{!1===n.config.closeOnDestroy&&this._removeOpenDialog(n,!1)}),MT(this._openDialogsAtThisLevel,n=>n.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(n){const i=new rV({positionStrategy:n.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:n.scrollStrategy||this._scrollStrategy(),panelClass:n.panelClass,hasBackdrop:n.hasBackdrop,direction:n.direction,minWidth:n.minWidth,minHeight:n.minHeight,maxWidth:n.maxWidth,maxHeight:n.maxHeight,width:n.width,height:n.height,disposeOnNavigation:n.closeOnNavigation});return n.backdropClass&&(i.backdropClass=n.backdropClass),i}_attachContainer(n,i,r){const s=r.injector||r.viewContainerRef?.injector,o=[{provide:Gy,useValue:r},{provide:IT,useValue:i},{provide:Vy,useValue:n}];let a;r.container?"function"==typeof r.container?a=r.container:(a=r.container.type,o.push(...r.container.providers(r))):a=AV;const c=new wT(a,r.viewContainerRef,lt.create({parent:s||this._injector,providers:o}),r.componentFactoryResolver);return n.attach(c).instance}_attachDialogContent(n,i,r,s){if(n instanceof Qr){const o=this._createInjector(s,i,r,void 0);let a={$implicit:s.data,dialogRef:i};s.templateContext&&(a={...a,..."function"==typeof s.templateContext?s.templateContext():s.templateContext}),r.attachTemplatePortal(new AT(n,null,a,o))}else{const o=this._createInjector(s,i,r,this._injector),a=r.attachComponentPortal(new wT(n,s.viewContainerRef,o,s.componentFactoryResolver));i.componentRef=a,i.componentInstance=a.instance}}_createInjector(n,i,r,s){const o=n.injector||n.viewContainerRef?.injector,a=[{provide:Khe,useValue:n.data},{provide:IT,useValue:i}];return n.providers&&("function"==typeof n.providers?a.push(...n.providers(i,n,r)):a.push(...n.providers)),n.direction&&(!o||!o.get(By,null,{optional:!0}))&&a.push({provide:By,useValue:{value:n.direction,change:ne()}}),lt.create({parent:o||s,providers:a})}_removeOpenDialog(n,i){const r=this.openDialogs.indexOf(n);r>-1&&(this.openDialogs.splice(r,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((s,o)=>{s?o.setAttribute("aria-hidden",s):o.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),i&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const n=this._overlayContainer.getContainerElement();if(n.parentElement){const i=n.parentElement.children;for(let r=i.length-1;r>-1;r--){const s=i[r];s!==n&&"SCRIPT"!==s.nodeName&&"STYLE"!==s.nodeName&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const n=this._parentDialog;return n?n._getAfterAllClosed():this._afterAllClosedAtThisLevel}static#e=this.\u0275fac=function(i){return new(i||t)(D(Oa),D(lt),D(Jhe,8),D(t,12),D(Uy),D(CV))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function MT(t,e){let n=t.length;for(;n--;)e(t[n])}var Wi=function(t){return t[t.State=0]="State",t[t.Transition=1]="Transition",t[t.Sequence=2]="Sequence",t[t.Group=3]="Group",t[t.Animate=4]="Animate",t[t.Keyframes=5]="Keyframes",t[t.Style=6]="Style",t[t.Trigger=7]="Trigger",t[t.Reference=8]="Reference",t[t.AnimateChild=9]="AnimateChild",t[t.AnimateRef=10]="AnimateRef",t[t.Query=11]="Query",t[t.Stagger=12]="Stagger",t}(Wi||{});function DT(t,e){return{type:Wi.Trigger,name:t,definitions:e,options:{}}}function Wy(t,e=null){return{type:Wi.Animate,styles:e,timings:t}}function Pa(t){return{type:Wi.Style,styles:t,offset:null}}function Zu(t,e,n){return{type:Wi.State,name:t,styles:e,options:n}}function $y(t,e,n=null){return{type:Wi.Transition,expr:t,animation:e,options:n}}function sfe(t,e){}class RT{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}const OT="mdc-dialog--open",IV="mdc-dialog--opening",MV="mdc-dialog--closing";let DV=(()=>{class t extends AV{constructor(n,i,r,s,o,a,c,l,u){super(n,i,r,s,o,a,c,u),this._animationMode=l,this._animationStateChanged=new Pe,this._animationsEnabled="NoopAnimations"!==this._animationMode,this._actionSectionCount=0,this._hostElement=this._elementRef.nativeElement,this._enterAnimationDuration=this._animationsEnabled?OV(this._config.enterAnimationDuration)??150:0,this._exitAnimationDuration=this._animationsEnabled?OV(this._config.exitAnimationDuration)??75:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(RV,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(IV,OT)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(OT),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(OT),this._animationsEnabled?(this._hostElement.style.setProperty(RV,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(MV)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(n){this._actionSectionCount+=n,this._changeDetectorRef.markForCheck()}_clearAnimationClasses(){this._hostElement.classList.remove(IV,MV)}_waitForAnimationToComplete(n,i){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(i,n)}_requestAnimationFrame(n){this._ngZone.runOutsideAngular(()=>{"function"==typeof requestAnimationFrame?requestAnimationFrame(n):n()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(n){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:n})}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}attachComponentPortal(n){const i=super.attachComponentPortal(n);return i.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),i}static#e=this.\u0275fac=function(i){return new(i||t)(j(en),j(EV),j(Ye,8),j(RT),j(ST),j(_e),j(Vy),j(gh,8),j(xT))};static#t=this.\u0275cmp=an({type:t,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(i,r){2&i&&(Wm("id",r._config.id),Is("aria-modal",r._config.ariaModal)("role",r._config.role)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledByQueue[0])("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null),cr("_mat-animation-noopable",!r._animationsEnabled)("mat-mdc-dialog-container-with-actions",r._actionSectionCount>0))},standalone:!0,features:[wo,Vi],decls:3,vars:0,consts:[[1,"mat-mdc-dialog-inner-container","mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(i,r){1&i&&(pt(0,"div",0)(1,"div",1),es(2,sfe,0,0,"ng-template",2),wt()())},dependencies:[ky],styles:['.mat-mdc-dialog-container{width:100%;height:100%;display:block;box-sizing:border-box;max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;outline:0}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 80vw);min-width:var(--mat-dialog-container-min-width, 0)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, 80vw)}}.mat-mdc-dialog-inner-container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;transition:opacity linear var(--mat-dialog-transition-duration, 0ms);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mdc-dialog--closing .mat-mdc-dialog-inner-container{transition:opacity 75ms linear;transform:none}.mdc-dialog--open .mat-mdc-dialog-inner-container{opacity:1}._mat-animation-noopable .mat-mdc-dialog-inner-container{transition:none}.mat-mdc-dialog-surface{display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;width:100%;height:100%;position:relative;overflow-y:auto;outline:0;transform:scale(0.8);transition:transform var(--mat-dialog-transition-duration, 0ms) cubic-bezier(0, 0, 0.2, 1);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;box-shadow:var(--mat-dialog-container-elevation-shadow, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12));border-radius:var(--mdc-dialog-container-shape, var(--mat-app-corner-extra-large, 4px));background-color:var(--mdc-dialog-container-color, var(--mat-app-surface, white))}[dir=rtl] .mat-mdc-dialog-surface{text-align:right}.mdc-dialog--open .mat-mdc-dialog-surface,.mdc-dialog--closing .mat-mdc-dialog-surface{transform:none}._mat-animation-noopable .mat-mdc-dialog-surface{transition:none}.mat-mdc-dialog-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mat-mdc-dialog-title{display:block;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:var(--mat-dialog-headline-padding, 0 24px 9px)}.mat-mdc-dialog-title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mat-mdc-dialog-title{text-align:right}.mat-mdc-dialog-container .mat-mdc-dialog-title{color:var(--mdc-dialog-subhead-color, var(--mat-app-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mdc-dialog-subhead-font, var(--mat-app-headline-small-font, inherit));line-height:var(--mdc-dialog-subhead-line-height, var(--mat-app-headline-small-line-height, 1.5rem));font-size:var(--mdc-dialog-subhead-size, var(--mat-app-headline-small-size, 1rem));font-weight:var(--mdc-dialog-subhead-weight, var(--mat-app-headline-small-weight, 400));letter-spacing:var(--mdc-dialog-subhead-tracking, var(--mat-app-headline-small-tracking, 0.03125em))}.mat-mdc-dialog-content{display:block;flex-grow:1;box-sizing:border-box;margin:0;overflow:auto;max-height:65vh}.mat-mdc-dialog-content>:first-child{margin-top:0}.mat-mdc-dialog-content>:last-child{margin-bottom:0}.mat-mdc-dialog-container .mat-mdc-dialog-content{color:var(--mdc-dialog-supporting-text-color, var(--mat-app-on-surface-variant, rgba(0, 0, 0, 0.6)));font-family:var(--mdc-dialog-supporting-text-font, var(--mat-app-body-medium-font, inherit));line-height:var(--mdc-dialog-supporting-text-line-height, var(--mat-app-body-medium-line-height, 1.5rem));font-size:var(--mdc-dialog-supporting-text-size, var(--mat-app-body-medium-size, 1rem));font-weight:var(--mdc-dialog-supporting-text-weight, var(--mat-app-body-medium-weight, 400));letter-spacing:var(--mdc-dialog-supporting-text-tracking, var(--mat-app-body-medium-tracking, 0.03125em))}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0);padding:var(--mat-dialog-actions-padding, 8px);justify-content:var(--mat-dialog-actions-alignment, start)}.cdk-high-contrast-active .mat-mdc-dialog-actions{border-top-color:CanvasText}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}.mat-mdc-dialog-component-host{display:contents}'],encapsulation:2})}return t})();const RV="--mat-dialog-transition-duration";function OV(t){return null==t?null:"number"==typeof t?t:t.endsWith("ms")?GU(t.substring(0,t.length-2)):t.endsWith("s")?1e3*GU(t.substring(0,t.length-1)):"0"===t?0:null}var qy=function(t){return t[t.OPEN=0]="OPEN",t[t.CLOSING=1]="CLOSING",t[t.CLOSED=2]="CLOSED",t}(qy||{});class Xy{constructor(e,n,i){this._ref=e,this._containerInstance=i,this._afterOpened=new de,this._beforeClosed=new de,this._state=qy.OPEN,this.disableClose=n.disableClose,this.id=e.id,e.addPanelClass("mat-mdc-dialog-panel"),i._animationStateChanged.pipe(ht(r=>"opened"===r.state),Dn(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),i._animationStateChanged.pipe(ht(r=>"closed"===r.state),Dn(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),Nc(this.backdropClick(),this.keydownEvents().pipe(ht(r=>27===r.keyCode&&!this.disableClose&&!jy(r)))).subscribe(r=>{this.disableClose||(r.preventDefault(),function PV(t,e,n){return t._closeInteractionType=e,t.close(n)}(this,"keydown"===r.type?"keyboard":"mouse"))})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(ht(n=>"closing"===n.state),Dn(1)).subscribe(n=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),n.totalTime+100)}),this._state=qy.CLOSING,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(e){let n=this._ref.config.positionStrategy;return e&&(e.left||e.right)?e.left?n.left(e.left):n.right(e.right):n.centerHorizontally(),e&&(e.top||e.bottom)?e.top?n.top(e.top):n.bottom(e.bottom):n.centerVertically(),this._ref.updatePosition(),this}updateSize(e="",n=""){return this._ref.updateSize(e,n),this}addPanelClass(e){return this._ref.addPanelClass(e),this}removePanelClass(e){return this._ref.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=qy.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const NV=new L("MatMdcDialogData"),cfe=new L("mat-mdc-dialog-default-options"),LV=new L("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{const t=O(Oa);return()=>t.scrollStrategies.block()}});let ufe=0,Yy=(()=>{class t{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const n=this._parentDialog;return n?n._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(n,i,r,s,o,a,c,l){this._overlay=n,this._defaultOptions=s,this._scrollStrategy=o,this._parentDialog=a,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new de,this._afterOpenedAtThisLevel=new de,this.dialogConfigClass=RT,this.afterAllClosed=K_(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Sa(void 0))),this._dialog=i.get(efe),this._dialogRefConstructor=Xy,this._dialogContainerType=DV,this._dialogDataToken=NV}open(n,i){let r;(i={...this._defaultOptions||new RT,...i}).id=i.id||"mat-mdc-dialog-"+ufe++,i.scrollStrategy=i.scrollStrategy||this._scrollStrategy();const s=this._dialog.open(n,{...i,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:i},{provide:Gy,useValue:i}]},templateContext:()=>({dialogRef:r}),providers:(o,a,c)=>(r=new this._dialogRefConstructor(o,i,c),r.updatePosition(i?.position),[{provide:this._dialogContainerType,useValue:c},{provide:this._dialogDataToken,useValue:a.data},{provide:this._dialogRefConstructor,useValue:r}])});return r.componentRef=s.componentRef,r.componentInstance=s.componentInstance,this.openDialogs.push(r),this.afterOpened.next(r),r.afterClosed().subscribe(()=>{const o=this.openDialogs.indexOf(r);o>-1&&(this.openDialogs.splice(o,1),this.openDialogs.length||this._getAfterAllClosed().next())}),r}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(n){return this.openDialogs.find(i=>i.id===n)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(n){let i=n.length;for(;i--;)n[i].close()}static#e=this.\u0275fac=function(i){return new(i||t)(D(Oa),D(lt),D(Fc,8),D(cfe,8),D(LV),D(t,12),D(Uy),D(gh,8))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),dfe=0,FV=(()=>{class t{constructor(n,i,r){this._dialogRef=n,this._elementRef=i,this._dialog=r}ngOnInit(){this._dialogRef||(this._dialogRef=function BV(t,e){let n=t.nativeElement.parentElement;for(;n&&!n.classList.contains("mat-mdc-dialog-container");)n=n.parentElement;return n?e.find(i=>i.id===n.id):null}(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{this._onAdd()})}ngOnDestroy(){this._dialogRef?._containerInstance&&Promise.resolve().then(()=>{this._onRemove()})}static#e=this.\u0275fac=function(i){return new(i||t)(j(Xy,8),j(en),j(Yy))};static#t=this.\u0275dir=Xe({type:t,standalone:!0})}return t})(),PT=(()=>{class t extends FV{constructor(){super(...arguments),this.id="mat-mdc-dialog-title-"+dfe++}_onAdd(){this._dialogRef._containerInstance?._addAriaLabelledBy?.(this.id)}_onRemove(){this._dialogRef?._containerInstance?._removeAriaLabelledBy?.(this.id)}static#e=this.\u0275fac=(()=>{let n;return function(r){return(n||(n=Cs(t)))(r||t)}})();static#t=this.\u0275dir=Xe({type:t,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-mdc-dialog-title","mdc-dialog__title"],hostVars:1,hostBindings:function(i,r){2&i&&Wm("id",r.id)},inputs:{id:"id"},exportAs:["matDialogTitle"],standalone:!0,features:[wo]})}return t})(),NT=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275dir=Xe({type:t,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-mdc-dialog-content","mdc-dialog__content"],standalone:!0,features:[RP([Ude])]})}return t})();let UV=(()=>{class t{constructor(n){this.http=n,this.panelContent=new on({content:[],infoTitle:"",videoID:""})}updateData(n,i,r){this.http.get(n,{responseType:"text"}).subscribe(s=>{const o={content:this.parseMarkdown(s),infoTitle:r,videoID:i};this.panelContent.next(o)})}parseMarkdown(n){const i=[],r=n.split("# ");for(const s of r)if(s.length){const o=s.includes("\n\n")?"\n\n":"\r\n\r\n",a=s.split(o);i.push({title:a[0],content:a.splice(1).join(o)})}return i}static#e=this.\u0275fac=function(i){return new(i||t)(D(Us))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const pfe=["*"];let Ky;function Zf(t){return function gfe(){if(void 0===Ky&&(Ky=null,typeof window<"u")){const t=window;void 0!==t.trustedTypes&&(Ky=t.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return Ky}()?.createHTML(t)||t}function VV(t){return Error(`Unable to find icon with the name "${t}"`)}function jV(t){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${t}".`)}function HV(t){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${t}".`)}class Kc{constructor(e,n,i){this.url=e,this.svgText=n,this.options=i}}let Jy=(()=>{class t{constructor(n,i,r,s){this._httpClient=n,this._sanitizer=i,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(n,i,r){return this.addSvgIconInNamespace("",n,i,r)}addSvgIconLiteral(n,i,r){return this.addSvgIconLiteralInNamespace("",n,i,r)}addSvgIconInNamespace(n,i,r,s){return this._addSvgIconConfig(n,i,new Kc(r,null,s))}addSvgIconResolver(n){return this._resolvers.push(n),this}addSvgIconLiteralInNamespace(n,i,r,s){const o=this._sanitizer.sanitize($n.HTML,r);if(!o)throw HV(r);const a=Zf(o);return this._addSvgIconConfig(n,i,new Kc("",a,s))}addSvgIconSet(n,i){return this.addSvgIconSetInNamespace("",n,i)}addSvgIconSetLiteral(n,i){return this.addSvgIconSetLiteralInNamespace("",n,i)}addSvgIconSetInNamespace(n,i,r){return this._addSvgIconSetConfig(n,new Kc(i,null,r))}addSvgIconSetLiteralInNamespace(n,i,r){const s=this._sanitizer.sanitize($n.HTML,i);if(!s)throw HV(i);const o=Zf(s);return this._addSvgIconSetConfig(n,new Kc("",o,r))}registerFontClassAlias(n,i=n){return this._fontCssClassesByAlias.set(n,i),this}classNameForFontAlias(n){return this._fontCssClassesByAlias.get(n)||n}setDefaultFontSetClass(...n){return this._defaultFontSetClass=n,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(n){const i=this._sanitizer.sanitize($n.RESOURCE_URL,n);if(!i)throw jV(n);const r=this._cachedIconsByUrl.get(i);return r?ne(Zy(r)):this._loadSvgIconFromConfig(new Kc(n,null)).pipe(At(s=>this._cachedIconsByUrl.set(i,s)),se(s=>Zy(s)))}getNamedSvgIcon(n,i=""){const r=zV(i,n);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(i,n),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(i);return o?this._getSvgFromIconSetConfigs(n,o):Ta(VV(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(n){return n.svgText?ne(Zy(this._svgElementFromConfig(n))):this._loadSvgIconFromConfig(n).pipe(se(i=>Zy(i)))}_getSvgFromIconSetConfigs(n,i){const r=this._extractIconWithNameFromAnySet(n,i);return r?ne(r):j_(i.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(Ps(a=>{const l=`Loading icon set URL: ${this._sanitizer.sanitize($n.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(l)),ne(null)})))).pipe(se(()=>{const o=this._extractIconWithNameFromAnySet(n,i);if(!o)throw VV(n);return o}))}_extractIconWithNameFromAnySet(n,i){for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.svgText&&s.svgText.toString().indexOf(n)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,n,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(n){return this._fetchIcon(n).pipe(At(i=>n.svgText=i),se(()=>this._svgElementFromConfig(n)))}_loadSvgIconSetFromConfig(n){return n.svgText?ne(null):this._fetchIcon(n).pipe(At(i=>n.svgText=i))}_extractSvgIconFromSet(n,i,r){const s=n.querySelector(`[id="${i}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,r);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),r);const a=this._svgElementFromString(Zf("<svg></svg>"));return a.appendChild(o),this._setSvgAttributes(a,r)}_svgElementFromString(n){const i=this._document.createElement("DIV");i.innerHTML=n;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(n){const i=this._svgElementFromString(Zf("<svg></svg>")),r=n.attributes;for(let s=0;s<r.length;s++){const{name:o,value:a}=r[s];"id"!==o&&i.setAttribute(o,a)}for(let s=0;s<n.childNodes.length;s++)n.childNodes[s].nodeType===this._document.ELEMENT_NODE&&i.appendChild(n.childNodes[s].cloneNode(!0));return i}_setSvgAttributes(n,i){return n.setAttribute("fit",""),n.setAttribute("height","100%"),n.setAttribute("width","100%"),n.setAttribute("preserveAspectRatio","xMidYMid meet"),n.setAttribute("focusable","false"),i&&i.viewBox&&n.setAttribute("viewBox",i.viewBox),n}_fetchIcon(n){const{url:i,options:r}=n,s=r?.withCredentials??!1;if(!this._httpClient)throw function mfe(){return Error("Could not find HttpClient for use with Angular Material icons. Please add provideHttpClient() to your providers.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const o=this._sanitizer.sanitize($n.RESOURCE_URL,i);if(!o)throw jV(i);const a=this._inProgressUrlFetches.get(o);if(a)return a;const c=this._httpClient.get(o,{responseType:"text",withCredentials:s}).pipe(se(l=>Zf(l)),ku(()=>this._inProgressUrlFetches.delete(o)),xo());return this._inProgressUrlFetches.set(o,c),c}_addSvgIconConfig(n,i,r){return this._svgIconConfigs.set(zV(n,i),r),this}_addSvgIconSetConfig(n,i){const r=this._iconSetConfigs.get(n);return r?r.push(i):this._iconSetConfigs.set(n,[i]),this}_svgElementFromConfig(n){if(!n.svgElement){const i=this._svgElementFromString(n.svgText);this._setSvgAttributes(i,n.options),n.svgElement=i}return n.svgElement}_getIconConfigFromResolvers(n,i){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](i,n);if(s)return yfe(s)?new Kc(s.url,null,s.options):new Kc(s,null)}}static#e=this.\u0275fac=function(i){return new(i||t)(D(Us,8),D(yf),D(Ye,8),D(Ni))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Zy(t){return t.cloneNode(!0)}function zV(t,e){return t+":"+e}function yfe(t){return!(!t.url||!t.options)}const vfe=new L("MAT_ICON_DEFAULT_OPTIONS"),bfe=new L("mat-icon-location",{providedIn:"root",factory:function Efe(){const t=O(Ye),e=t?t.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),GV=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],wfe=GV.map(t=>`[${t}]`).join(", "),Afe=/^url\(['"]?#(.*?)['"]?\)$/;let WV=(()=>{class t{get color(){return this._color||this._defaultColor}set color(n){this._color=n}get svgIcon(){return this._svgIcon}set svgIcon(n){n!==this._svgIcon&&(n?this._updateSvgIcon(n):this._svgIcon&&this._clearSvgElement(),this._svgIcon=n)}get fontSet(){return this._fontSet}set fontSet(n){const i=this._cleanupFontValue(n);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(n){const i=this._cleanupFontValue(n);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}constructor(n,i,r,s,o,a){this._elementRef=n,this._iconRegistry=i,this._location=s,this._errorHandler=o,this.inline=!1,this._previousFontSetClass=[],this._currentIconFetch=bt.EMPTY,a&&(a.color&&(this.color=this._defaultColor=a.color),a.fontSet&&(this.fontSet=a.fontSet)),r||n.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(n){if(!n)return["",""];const i=n.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${n}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const n=this._elementsWithExternalReferences;if(n&&n.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(n){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(n),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(n)}_clearSvgElement(){const n=this._elementRef.nativeElement;let i=n.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=n.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const n=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>n.classList.remove(r)),i.forEach(r=>n.classList.add(r)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&n.classList.remove(this._previousFontIconClass),this.fontIcon&&n.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(n){return"string"==typeof n?n.trim().split(" ")[0]:n}_prependPathToReferences(n){const i=this._elementsWithExternalReferences;i&&i.forEach((r,s)=>{r.forEach(o=>{s.setAttribute(o.name,`url('${n}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(n){const i=n.querySelectorAll(wfe),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<i.length;s++)GV.forEach(o=>{const a=i[s],c=a.getAttribute(o),l=c?c.match(Afe):null;if(l){let u=r.get(a);u||(u=[],r.set(a,u)),u.push({name:o,value:l[1]})}})}_updateSvgIcon(n){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),n){const[i,r]=this._splitIconName(n);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(Dn(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${s.message}`))})}}static#e=this.\u0275fac=function(i){return new(i||t)(j(en),j(Jy),pc("aria-hidden"),j(bfe),j(Ni),j(vfe,8))};static#t=this.\u0275cmp=an({type:t,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(i,r){2&i&&(Is("data-mat-icon-type",r._usingFontIcon()?"font":"svg")("data-mat-icon-name",r._svgName||r.fontIcon)("data-mat-icon-namespace",r._svgNamespace||r.fontSet)("fontIcon",r._usingFontIcon()?r.fontIcon:null),Hm(r.color?"mat-"+r.color:""),cr("mat-icon-inline",r.inline)("mat-icon-no-color","primary"!==r.color&&"accent"!==r.color&&"warn"!==r.color))},inputs:{color:"color",inline:[2,"inline","inline",is],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],standalone:!0,features:[Cc,Vi],ngContentSelectors:pfe,decls:1,vars:0,template:function(i,r){1&i&&(ga(),ui(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}return t})(),$V=(()=>{class t{constructor(){this._listeners=[]}notify(n,i){for(let r of this._listeners)r(n,i)}listen(n){return this._listeners.push(n),()=>{this._listeners=this._listeners.filter(i=>n!==i)}}ngOnDestroy(){this._listeners=[]}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const qV=new L("CdkAccordion");let Tfe=0,Sfe=(()=>{class t{get expanded(){return this._expanded}set expanded(n){this._expanded!==n&&(this._expanded=n,this.expandedChange.emit(n),n?(this.opened.emit(),this._expansionDispatcher.notify(this.id,this.accordion?this.accordion.id:this.id)):this.closed.emit(),this._changeDetectorRef.markForCheck())}constructor(n,i,r){this.accordion=n,this._changeDetectorRef=i,this._expansionDispatcher=r,this._openCloseAllSubscription=bt.EMPTY,this.closed=new Pe,this.opened=new Pe,this.destroyed=new Pe,this.expandedChange=new Pe,this.id="cdk-accordion-child-"+Tfe++,this._expanded=!1,this.disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=r.listen((s,o)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===o&&this.id!==s&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(n=>{this.disabled||(this.expanded=n)})}static#e=this.\u0275fac=function(i){return new(i||t)(j(qV,12),j(lr),j($V))};static#t=this.\u0275dir=Xe({type:t,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:[2,"expanded","expanded",is],disabled:[2,"disabled","disabled",is]},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],standalone:!0,features:[Yw([{provide:qV,useValue:void 0}]),Cc]})}return t})();const xfe=["body"],Ife=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],Mfe=["mat-expansion-panel-header","*","mat-action-row"];function Dfe(t,e){}const Rfe=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],Ofe=["mat-panel-title","mat-panel-description","*"];function Pfe(t,e){1&t&&(pt(0,"span",1),R0(),pt(1,"svg",2),Rs(2,"path",3),wt()()),2&t&&li("@indicatorRotate",Ao()._getExpandedState())}const XV=new L("MAT_ACCORDION"),YV="225ms cubic-bezier(0.4,0.0,0.2,1)",KV={indicatorRotate:DT("indicatorRotate",[Zu("collapsed, void",Pa({transform:"rotate(0deg)"})),Zu("expanded",Pa({transform:"rotate(180deg)"})),$y("expanded <=> collapsed, void => collapsed",Wy(YV))]),bodyExpansion:DT("bodyExpansion",[Zu("collapsed, void",Pa({height:"0px",visibility:"hidden"})),Zu("expanded",Pa({height:"*",visibility:""})),$y("expanded <=> collapsed, void => collapsed",Wy(YV))])},JV=new L("MAT_EXPANSION_PANEL");let Nfe=(()=>{class t{constructor(n,i){this._template=n,this._expansionPanel=i}static#e=this.\u0275fac=function(i){return new(i||t)(j(Qr),j(JV,8))};static#t=this.\u0275dir=Xe({type:t,selectors:[["ng-template","matExpansionPanelContent",""]],standalone:!0})}return t})(),Lfe=0;const ZV=new L("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS");let QV=(()=>{class t extends Sfe{get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(n){this._hideToggle=n}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(n){this._togglePosition=n}constructor(n,i,r,s,o,a,c){super(n,i,r),this._viewContainerRef=s,this._animationMode=a,this._hideToggle=!1,this.afterExpand=new Pe,this.afterCollapse=new Pe,this._inputChanges=new de,this._headerId="mat-expansion-panel-header-"+Lfe++,this.accordion=n,this._document=o,this._animationsDisabled="NoopAnimations"===a,c&&(this.hideToggle=c.hideToggle)}_hasSpacing(){return!!this.accordion&&this.expanded&&"default"===this.accordion.displayMode}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this._lazyContent._expansionPanel===this&&this.opened.pipe(Sa(null),ht(()=>this.expanded&&!this._portal),Dn(1)).subscribe(()=>{this._portal=new AT(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(n){this._inputChanges.next(n)}ngOnDestroy(){super.ngOnDestroy(),this._inputChanges.complete()}_containsFocus(){if(this._body){const n=this._document.activeElement,i=this._body.nativeElement;return n===i||i.contains(n)}return!1}_animationStarted(n){!ej(n)&&!this._animationsDisabled&&this._body&&this._body?.nativeElement.setAttribute("inert","")}_animationDone(n){ej(n)||("expanded"===n.toState?this.afterExpand.emit():"collapsed"===n.toState&&this.afterCollapse.emit(),!this._animationsDisabled&&this._body&&this._body.nativeElement.removeAttribute("inert"))}static#e=this.\u0275fac=function(i){return new(i||t)(j(XV,12),j(lr),j($V),j(Ci),j(Ye),j(gh,8),j(ZV,8))};static#t=this.\u0275cmp=an({type:t,selectors:[["mat-expansion-panel"]],contentQueries:function(i,r,s){if(1&i&&Hw(s,Nfe,5),2&i){let o;ma(o=_a())&&(r._lazyContent=o.first)}},viewQuery:function(i,r){if(1&i&&Su(xfe,5),2&i){let s;ma(s=_a())&&(r._body=s.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(i,r){2&i&&cr("mat-expanded",r.expanded)("_mat-animation-noopable",r._animationsDisabled)("mat-expansion-panel-spacing",r._hasSpacing())},inputs:{hideToggle:[2,"hideToggle","hideToggle",is],togglePosition:"togglePosition"},outputs:{afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],standalone:!0,features:[Yw([{provide:XV,useValue:void 0},{provide:JV,useExisting:t}]),Cc,wo,xr,Vi],ngContentSelectors:Mfe,decls:7,vars:4,consts:[["body",""],["role","region",1,"mat-expansion-panel-content",3,"id"],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(i,r){if(1&i){const s=Yh();ga(Ife),ui(0),pt(1,"div",1,0),Ui("@bodyExpansion.start",function(a){return bs(s),Es(r._animationStarted(a))})("@bodyExpansion.done",function(a){return bs(s),Es(r._animationDone(a))}),pt(3,"div",2),ui(4,1),es(5,Dfe,0,0,"ng-template",3),wt(),ui(6,2),wt()}2&i&&(qn(),li("@bodyExpansion",r._getExpandedState())("id",r.id),Is("aria-labelledby",r._headerId),qn(4),li("cdkPortalOutlet",r._portal))},dependencies:[ky],styles:['.mat-expansion-panel{box-sizing:content-box;display:block;margin:0;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative;background:var(--mat-expansion-container-background-color, var(--mat-app-surface));color:var(--mat-expansion-container-text-color, var(--mat-app-on-surface));border-radius:var(--mat-expansion-container-shape)}.mat-expansion-panel:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:var(--mat-expansion-container-shape);border-top-left-radius:var(--mat-expansion-container-shape)}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:var(--mat-expansion-container-shape);border-bottom-left-radius:var(--mat-expansion-container-shape)}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible;font-family:var(--mat-expansion-container-text-font, var(--mat-app-body-large-font));font-size:var(--mat-expansion-container-text-size, var(--mat-app-body-large-size));font-weight:var(--mat-expansion-container-text-weight, var(--mat-app-body-large-weight));line-height:var(--mat-expansion-container-text-line-height, var(--mat-app-body-large-line-height));letter-spacing:var(--mat-expansion-container-text-tracking, var(--mat-app-body-large-tracking))}.mat-expansion-panel-content[style*="visibility: hidden"] *{visibility:hidden !important}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px;border-top-color:var(--mat-expansion-actions-divider-color, var(--mat-app-outline))}.mat-action-row .mat-button-base,.mat-action-row .mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row .mat-button-base,[dir=rtl] .mat-action-row .mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2,data:{animation:[KV.bodyExpansion]},changeDetection:0})}return t})();function ej(t){return"void"===t.fromState}let Ffe=(()=>{class t{constructor(n,i,r,s,o,a,c){this.panel=n,this._element=i,this._focusMonitor=r,this._changeDetectorRef=s,this._animationMode=a,this._parentChangeSubscription=bt.EMPTY,this.tabIndex=0;const l=n.accordion?n.accordion._stateChanges.pipe(ht(u=>!(!u.hideToggle&&!u.togglePosition))):Hi;this.tabIndex=parseInt(c||"")||0,this._parentChangeSubscription=Nc(n.opened,n.closed,l,n._inputChanges.pipe(ht(u=>!!(u.hideToggle||u.disabled||u.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),n.closed.pipe(ht(()=>n._containsFocus())).subscribe(()=>r.focusVia(i,"program")),o&&(this.expandedHeight=o.expandedHeight,this.collapsedHeight=o.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){const n=this._isExpanded();return n&&this.expandedHeight?this.expandedHeight:!n&&this.collapsedHeight?this.collapsedHeight:null}_keydown(n){switch(n.keyCode){case 32:case 13:jy(n)||(n.preventDefault(),this._toggle());break;default:return void(this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(n))}}focus(n,i){n?this._focusMonitor.focusVia(this._element,n,i):this._element.nativeElement.focus(i)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(n=>{n&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}static#e=this.\u0275fac=function(i){return new(i||t)(j(QV,1),j(en),j(xT),j(lr),j(ZV,8),j(gh,8),pc("tabindex"))};static#t=this.\u0275cmp=an({type:t,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(i,r){1&i&&Ui("click",function(){return r._toggle()})("keydown",function(o){return r._keydown(o)}),2&i&&(Is("id",r.panel._headerId)("tabindex",r.disabled?-1:r.tabIndex)("aria-controls",r._getPanelId())("aria-expanded",r._isExpanded())("aria-disabled",r.panel.disabled),qh("height",r._getHeaderHeight()),cr("mat-expanded",r._isExpanded())("mat-expansion-toggle-indicator-after","after"===r._getTogglePosition())("mat-expansion-toggle-indicator-before","before"===r._getTogglePosition())("_mat-animation-noopable","NoopAnimations"===r._animationMode))},inputs:{expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight",tabIndex:[2,"tabIndex","tabIndex",n=>null==n?0:f_(n)]},standalone:!0,features:[Cc,Vi],ngContentSelectors:Ofe,decls:5,vars:3,consts:[[1,"mat-content"],[1,"mat-expansion-indicator"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-hidden","true","focusable","false"],["d","M480-345 240-585l56-56 184 184 184-184 56 56-240 240Z"]],template:function(i,r){1&i&&(ga(Rfe),pt(0,"span",0),ui(1),ui(2,1),ui(3,2),wt(),es(4,Pfe,3,1,"span",1)),2&i&&(cr("mat-content-hide-toggle",!r._showToggle()),qn(4),Pw(r._showToggle()?4:-1))},styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-expansion-header-collapsed-state-height);font-family:var(--mat-expansion-header-text-font, var(--mat-app-title-medium-font));font-size:var(--mat-expansion-header-text-size, var(--mat-app-title-medium-size));font-weight:var(--mat-expansion-header-text-weight, var(--mat-app-title-medium-weight));line-height:var(--mat-expansion-header-text-line-height, var(--mat-app-title-medium-line-height));letter-spacing:var(--mat-expansion-header-text-tracking, var(--mat-app-title-medium-tracking))}.mat-expansion-panel-header.mat-expanded{height:var(--mat-expansion-header-expanded-state-height)}.mat-expansion-panel-header[aria-disabled=true]{color:var(--mat-expansion-header-disabled-state-text-color)}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-header-hover-state-layer-color)}@media(hover: none){.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-container-background-color, var(--mat-app-surface))}}.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-keyboard-focused,.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-program-focused{background:var(--mat-expansion-header-focus-state-layer-color)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-content.mat-content-hide-toggle{margin-right:8px}[dir=rtl] .mat-content.mat-content-hide-toggle{margin-right:0;margin-left:8px}.mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-left:24px;margin-right:0}[dir=rtl] .mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-right:24px;margin-left:0}.mat-expansion-panel-header-title{color:var(--mat-expansion-header-text-color, var(--mat-app-on-surface))}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;flex-basis:0;margin-right:16px;align-items:center}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-title,.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-description{color:inherit}.mat-expansion-panel-header-description{flex-grow:2;color:var(--mat-expansion-header-description-color, var(--mat-app-on-surface-variant))}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle;color:var(--mat-expansion-header-indicator-color, var(--mat-app-on-surface-variant));display:var(--mat-expansion-legacy-header-indicator-display, inline-block)}.mat-expansion-indicator svg{width:24px;height:24px;margin:0 -8px;vertical-align:middle;fill:var(--mat-expansion-header-indicator-color, var(--mat-app-on-surface-variant));display:var(--mat-expansion-header-indicator-display, none)}.cdk-high-contrast-active .mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}'],encapsulation:2,data:{animation:[KV.indicatorRotate]},changeDetection:0})}return t})();function tj(t,e,n){return n?tj(t,e).pipe(V_(n)):new ge(i=>{const r=(...o)=>i.next(1===o.length?o[0]:o),s=t(r);return Fe(e)?()=>e(r,s):void 0})}const Bfe=["youtubeContainer"];function kfe(t,e){if(1&t){const n=Yh();pt(0,"youtube-player-placeholder",2),Ui("click",function(){return bs(n),Es(Ao()._load(!0))}),wt()}if(2&t){const n=Ao();li("videoId",n.videoId)("width",n.width)("height",n.height)("isLoading",n._isLoading)("buttonLabel",n.placeholderButtonLabel)("quality",n.placeholderImageQuality)}}let Ufe=(()=>{class t{_getBackgroundImage(){let n;return n="low"===this.quality?`https://i.ytimg.com/vi/${this.videoId}/hqdefault.jpg`:"high"===this.quality?`https://i.ytimg.com/vi/${this.videoId}/maxresdefault.jpg`:`https://i.ytimg.com/vi_webp/${this.videoId}/sddefault.webp`,`url(${n})`}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=an({type:t,selectors:[["youtube-player-placeholder"]],hostAttrs:[1,"youtube-player-placeholder"],hostVars:8,hostBindings:function(i,r){2&i&&(qh("background-image",r._getBackgroundImage())("width",r.width,"px")("height",r.height,"px"),cr("youtube-player-placeholder-loading",r.isLoading))},inputs:{videoId:"videoId",width:"width",height:"height",isLoading:"isLoading",buttonLabel:"buttonLabel",quality:"quality"},standalone:!0,features:[Vi],decls:4,vars:1,consts:[["type","button",1,"youtube-player-placeholder-button"],["height","100%","version","1.1","viewBox","0 0 68 48","focusable","false","aria-hidden","true"],["d","M66.52,7.74c-0.78-2.93-2.49-5.41-5.42-6.19C55.79,.13,34,0,34,0S12.21,.13,6.9,1.55 C3.97,2.33,2.27,4.81,1.48,7.74C0.06,13.05,0,24,0,24s0.06,10.95,1.48,16.26c0.78,2.93,2.49,5.41,5.42,6.19 C12.21,47.87,34,48,34,48s21.79-0.13,27.1-1.55c2.93-0.78,4.64-3.26,5.42-6.19C67.94,34.95,68,24,68,24S67.94,13.05,66.52,7.74z","fill","#f00"],["d","M 45,24 27,14 27,34","fill","#fff"]],template:function(i,r){1&i&&(pt(0,"button",0),R0(),pt(1,"svg",1),Rs(2,"path",2)(3,"path",3),wt()()),2&i&&Is("aria-label",r.buttonLabel)},styles:[".youtube-player-placeholder{display:flex;align-items:center;justify-content:center;width:100%;overflow:hidden;cursor:pointer;background-color:#000;background-position:center center;background-size:cover;transition:box-shadow 300ms ease;box-shadow:inset 0 120px 90px -90px rgba(0,0,0,.8)}.youtube-player-placeholder-button{transition:opacity 300ms ease;-moz-appearance:none;-webkit-appearance:none;background:none;border:none;padding:0;display:flex}.youtube-player-placeholder-button svg{width:68px;height:48px}.youtube-player-placeholder-loading{box-shadow:none}.youtube-player-placeholder-loading .youtube-player-placeholder-button{opacity:0}"],encapsulation:2,changeDetection:0})}return t})();const Vfe=new L("YOUTUBE_PLAYER_CONFIG");function rj(t){return null==t?t:f_(t,0)}var js=function(t){return t[t.UNSTARTED=-1]="UNSTARTED",t[t.ENDED=0]="ENDED",t[t.PLAYING=1]="PLAYING",t[t.PAUSED=2]="PAUSED",t[t.BUFFERING=3]="BUFFERING",t[t.CUED=5]="CUED",t}(js||{});let jfe=(()=>{class t{get height(){return this._height}set height(n){this._height=null==n||isNaN(n)?390:n}get width(){return this._width}set width(n){this._width=null==n||isNaN(n)?640:n}constructor(n,i){this._ngZone=n,this._destroyed=new de,this._playerChanges=new on(void 0),this._nonce=O(K0,{optional:!0}),this._changeDetectorRef=O(lr),this._isLoading=!1,this._hasPlaceholder=!0,this._height=390,this._width=640,this.disableCookies=!1,this.disablePlaceholder=!1,this.showBeforeIframeApiLoads=!1,this.ready=this._getLazyEmitter("onReady"),this.stateChange=this._getLazyEmitter("onStateChange"),this.error=this._getLazyEmitter("onError"),this.apiChange=this._getLazyEmitter("onApiChange"),this.playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange"),this.playbackRateChange=this._getLazyEmitter("onPlaybackRateChange");const r=O(Vfe,{optional:!0});this.loadApi=r?.loadApi??!0,this.disablePlaceholder=!!r?.disablePlaceholder,this.placeholderButtonLabel=r?.placeholderButtonLabel||"Play video",this.placeholderImageQuality=r?.placeholderImageQuality||"standard",this._isBrowser=Ca(i)}ngAfterViewInit(){this._conditionallyLoad()}ngOnChanges(n){this._shouldRecreatePlayer(n)?this._conditionallyLoad():this._player&&((n.width||n.height)&&this._setSize(),n.suggestedQuality&&this._setQuality(),(n.startSeconds||n.endSeconds||n.suggestedQuality)&&this._cuePlayer())}ngOnDestroy(){this._pendingPlayer?.destroy(),this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():(this._getPendingState().playbackState=js.PLAYING,this._load(!0))}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=js.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=js.CUED}seekTo(n,i){this._player?this._player.seekTo(n,i):this._getPendingState().seek={seconds:n,allowSeekAhead:i}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(n){this._player?this._player.setVolume(n):this._getPendingState().volume=n}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(n){if(this._player)return this._player.setPlaybackRate(n);this._getPendingState().playbackRate=n}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:js.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}_load(n){this._isBrowser&&(window.YT&&window.YT.Player?this._createPlayer(n):(this.loadApi&&(this._isLoading=!0,function Hfe(t){if(LT)return;const n=document.createElement("script"),i=r=>{n.removeEventListener("load",i),n.removeEventListener("error",i),"error"===r.type&&(LT=!1)};n.addEventListener("load",i),n.addEventListener("error",i),n.src="https://www.youtube.com/iframe_api",n.async=!0,t&&n.setAttribute("nonce",t),LT=!0,document.body.appendChild(n)}(this._nonce)),this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback?.(),this._ngZone.run(()=>this._createPlayer(n))}))}_conditionallyLoad(){this._shouldShowPlaceholder()?1===this.playerVars?.autoplay&&this._load(!0):this._load(!1)}_shouldShowPlaceholder(){return!this.disablePlaceholder&&(!this._isBrowser||this._hasPlaceholder&&!!this.videoId&&!this._player)}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_shouldRecreatePlayer(n){const i=n.videoId||n.playerVars||n.disableCookies||n.disablePlaceholder;return!!i&&!i.isFirstChange()}_createPlayer(n){if(this._player?.destroy(),this._pendingPlayer?.destroy(),typeof YT>"u"||!this.videoId&&!this.playerVars?.list)return;const i=this._ngZone.runOutsideAngular(()=>new YT.Player(this.youtubeContainer.nativeElement,{videoId:this.videoId,host:this.disableCookies?"https://www.youtube-nocookie.com":void 0,width:this.width,height:this.height,playerVars:n?{...this.playerVars||{},autoplay:1}:this.playerVars})),r=()=>{this._ngZone.run(()=>{this._isLoading=!1,this._hasPlaceholder=!1,this._player=i,this._pendingPlayer=void 0,i.removeEventListener("onReady",r),this._playerChanges.next(i),this._setSize(),this._setQuality(),this._pendingPlayerState&&(this._applyPendingPlayerState(i,this._pendingPlayerState),this._pendingPlayerState=void 0);const s=i.getPlayerState();(s===js.UNSTARTED||s===js.CUED||null==s)&&this._cuePlayer(),this._changeDetectorRef.markForCheck()})};this._pendingPlayer=i,i.addEventListener("onReady",r)}_applyPendingPlayerState(n,i){const{playbackState:r,playbackRate:s,volume:o,muted:a,seek:c}=i;switch(r){case js.PLAYING:n.playVideo();break;case js.PAUSED:n.pauseVideo();break;case js.CUED:n.stopVideo()}null!=s&&n.setPlaybackRate(s),null!=o&&n.setVolume(o),null!=a&&(a?n.mute():n.unMute()),null!=c&&n.seekTo(c.seconds,c.allowSeekAhead)}_cuePlayer(){this._player&&this.videoId&&this._player.cueVideoById({videoId:this.videoId,startSeconds:this.startSeconds,endSeconds:this.endSeconds,suggestedQuality:this.suggestedQuality})}_setSize(){this._player?.setSize(this.width,this.height)}_setQuality(){this._player&&this.suggestedQuality&&this._player.setPlaybackQuality(this.suggestedQuality)}_getLazyEmitter(n){return this._playerChanges.pipe(hn(i=>i?tj(r=>{i.addEventListener(n,r)},r=>{try{i?.removeEventListener?.(n,r)}catch{}}):ne()),i=>new ge(r=>i.subscribe({next:s=>this._ngZone.run(()=>r.next(s)),error:s=>r.error(s),complete:()=>r.complete()})),Ns(this._destroyed))}static#e=this.\u0275fac=function(i){return new(i||t)(j(_e),j(Mr))};static#t=this.\u0275cmp=an({type:t,selectors:[["youtube-player"]],viewQuery:function(i,r){if(1&i&&Su(Bfe,7),2&i){let s;ma(s=_a())&&(r.youtubeContainer=s.first)}},inputs:{videoId:"videoId",height:[2,"height","height",f_],width:[2,"width","width",f_],startSeconds:[2,"startSeconds","startSeconds",rj],endSeconds:[2,"endSeconds","endSeconds",rj],suggestedQuality:"suggestedQuality",playerVars:"playerVars",disableCookies:[2,"disableCookies","disableCookies",is],loadApi:[2,"loadApi","loadApi",is],disablePlaceholder:[2,"disablePlaceholder","disablePlaceholder",is],showBeforeIframeApiLoads:[2,"showBeforeIframeApiLoads","showBeforeIframeApiLoads",is],placeholderButtonLabel:"placeholderButtonLabel",placeholderImageQuality:"placeholderImageQuality"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},standalone:!0,features:[Cc,xr,Vi],decls:4,vars:3,consts:[["youtubeContainer",""],[3,"videoId","width","height","isLoading","buttonLabel","quality"],[3,"click","videoId","width","height","isLoading","buttonLabel","quality"]],template:function(i,r){1&i&&(es(0,kfe,1,6,"youtube-player-placeholder",1),pt(1,"div"),Rs(2,"div",null,0),wt()),2&i&&(Pw(r._shouldShowPlaceholder()?0:-1),qn(),qh("display",r._shouldShowPlaceholder()?"none":""))},dependencies:[Ufe],encapsulation:2,changeDetection:0})}return t})(),LT=!1;let Jc={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function sj(t){Jc=t}const oj=/[&<>"']/,zfe=new RegExp(oj.source,"g"),aj=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,Gfe=new RegExp(aj.source,"g"),Wfe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},cj=t=>Wfe[t];function pr(t,e){if(e){if(oj.test(t))return t.replace(zfe,cj)}else if(aj.test(t))return t.replace(Gfe,cj);return t}const $fe=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function qfe(t){return t.replace($fe,(e,n)=>"colon"===(n=n.toLowerCase())?":":"#"===n.charAt(0)?"x"===n.charAt(1)?String.fromCharCode(parseInt(n.substring(2),16)):String.fromCharCode(+n.substring(1)):"")}const Xfe=/(^|[^\[])\^/g;function Tt(t,e){let n="string"==typeof t?t:t.source;e=e||"";const i={replace:(r,s)=>{let o="string"==typeof s?s:s.source;return o=o.replace(Xfe,"$1"),n=n.replace(r,o),i},getRegex:()=>new RegExp(n,e)};return i}function lj(t){try{t=encodeURI(t).replace(/%25/g,"%")}catch{return null}return t}const Qf={exec:()=>null};function uj(t,e){const i=t.replace(/\|/g,(s,o,a)=>{let c=!1,l=o;for(;--l>=0&&"\\"===a[l];)c=!c;return c?"|":" |"}).split(/ \|/);let r=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(/\\\|/g,"|");return i}function Qy(t,e,n){const i=t.length;if(0===i)return"";let r=0;for(;r<i;){const s=t.charAt(i-r-1);if(s!==e||n){if(s===e||!n)break;r++}else r++}return t.slice(0,i-r)}function dj(t,e,n,i){const r=e.href,s=e.title?pr(e.title):null,o=t[1].replace(/\\([\[\]])/g,"$1");if("!"!==t[0].charAt(0)){i.state.inLink=!0;const a={type:"link",raw:n,href:r,title:s,text:o,tokens:i.inlineTokens(o)};return i.state.inLink=!1,a}return{type:"image",raw:n,href:r,title:s,text:pr(o)}}class ev{options;rules;lexer;constructor(e){this.options=e||Jc}space(e){const n=this.rules.block.newline.exec(e);if(n&&n[0].length>0)return{type:"space",raw:n[0]}}code(e){const n=this.rules.block.code.exec(e);if(n){const i=n[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?i:Qy(i,"\n")}}}fences(e){const n=this.rules.block.fences.exec(e);if(n){const i=n[0],r=function Kfe(t,e){const n=t.match(/^(\s+)(?:```)/);if(null===n)return e;const i=n[1];return e.split("\n").map(r=>{const s=r.match(/^\s+/);if(null===s)return r;const[o]=s;return o.length>=i.length?r.slice(i.length):r}).join("\n")}(i,n[3]||"");return{type:"code",raw:i,lang:n[2]?n[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):n[2],text:r}}}heading(e){const n=this.rules.block.heading.exec(e);if(n){let i=n[2].trim();if(/#$/.test(i)){const r=Qy(i,"#");(this.options.pedantic||!r||/ $/.test(r))&&(i=r.trim())}return{type:"heading",raw:n[0],depth:n[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const n=this.rules.block.hr.exec(e);if(n)return{type:"hr",raw:n[0]}}blockquote(e){const n=this.rules.block.blockquote.exec(e);if(n){let i=n[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,"\n    $1");i=Qy(i.replace(/^ *>[ \t]?/gm,""),"\n");const r=this.lexer.state.top;this.lexer.state.top=!0;const s=this.lexer.blockTokens(i);return this.lexer.state.top=r,{type:"blockquote",raw:n[0],tokens:s,text:i}}}list(e){let n=this.rules.block.list.exec(e);if(n){let i=n[1].trim();const r=i.length>1,s={type:"list",raw:"",ordered:r,start:r?+i.slice(0,-1):"",loose:!1,items:[]};i=r?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=r?i:"[*+-]");const o=new RegExp(`^( {0,3}${i})((?:[\t ][^\\n]*)?(?:\\n|$))`);let a="",c="",l=!1;for(;e;){let u=!1;if(!(n=o.exec(e))||this.rules.block.hr.test(e))break;a=n[0],e=e.substring(a.length);let d=n[2].split("\n",1)[0].replace(/^\t+/,y=>" ".repeat(3*y.length)),h=e.split("\n",1)[0],f=0;this.options.pedantic?(f=2,c=d.trimStart()):(f=n[2].search(/[^ ]/),f=f>4?1:f,c=d.slice(f),f+=n[1].length);let p=!1;if(!d&&/^ *$/.test(h)&&(a+=h+"\n",e=e.substring(h.length+1),u=!0),!u){const y=new RegExp(`^ {0,${Math.min(3,f-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),v=new RegExp(`^ {0,${Math.min(3,f-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),_=new RegExp(`^ {0,${Math.min(3,f-1)}}(?:\`\`\`|~~~)`),w=new RegExp(`^ {0,${Math.min(3,f-1)}}#`);for(;e;){const C=e.split("\n",1)[0];if(h=C,this.options.pedantic&&(h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),_.test(h)||w.test(h)||y.test(h)||v.test(e))break;if(h.search(/[^ ]/)>=f||!h.trim())c+="\n"+h.slice(f);else{if(p||d.search(/[^ ]/)>=4||_.test(d)||w.test(d)||v.test(d))break;c+="\n"+h}!p&&!h.trim()&&(p=!0),a+=C+"\n",e=e.substring(C.length+1),d=h.slice(f)}}s.loose||(l?s.loose=!0:/\n *\n *$/.test(a)&&(l=!0));let m,g=null;this.options.gfm&&(g=/^\[[ xX]\] /.exec(c),g&&(m="[ ] "!==g[0],c=c.replace(/^\[[ xX]\] +/,""))),s.items.push({type:"list_item",raw:a,task:!!g,checked:m,loose:!1,text:c,tokens:[]}),s.raw+=a}s.items[s.items.length-1].raw=a.trimEnd(),s.items[s.items.length-1].text=c.trimEnd(),s.raw=s.raw.trimEnd();for(let u=0;u<s.items.length;u++)if(this.lexer.state.top=!1,s.items[u].tokens=this.lexer.blockTokens(s.items[u].text,[]),!s.loose){const d=s.items[u].tokens.filter(f=>"space"===f.type),h=d.length>0&&d.some(f=>/\n.*\n/.test(f.raw));s.loose=h}if(s.loose)for(let u=0;u<s.items.length;u++)s.items[u].loose=!0;return s}}html(e){const n=this.rules.block.html.exec(e);if(n)return{type:"html",block:!0,raw:n[0],pre:"pre"===n[1]||"script"===n[1]||"style"===n[1],text:n[0]}}def(e){const n=this.rules.block.def.exec(e);if(n){const i=n[1].toLowerCase().replace(/\s+/g," "),r=n[2]?n[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=n[3]?n[3].substring(1,n[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):n[3];return{type:"def",tag:i,raw:n[0],href:r,title:s}}}table(e){const n=this.rules.block.table.exec(e);if(!n||!/[:|]/.test(n[2]))return;const i=uj(n[1]),r=n[2].replace(/^\||\| *$/g,"").split("|"),s=n[3]&&n[3].trim()?n[3].replace(/\n[ \t]*$/,"").split("\n"):[],o={type:"table",raw:n[0],header:[],align:[],rows:[]};if(i.length===r.length){for(const a of r)/^ *-+: *$/.test(a)?o.align.push("right"):/^ *:-+: *$/.test(a)?o.align.push("center"):/^ *:-+ *$/.test(a)?o.align.push("left"):o.align.push(null);for(const a of i)o.header.push({text:a,tokens:this.lexer.inline(a)});for(const a of s)o.rows.push(uj(a,o.header.length).map(c=>({text:c,tokens:this.lexer.inline(c)})));return o}}lheading(e){const n=this.rules.block.lheading.exec(e);if(n)return{type:"heading",raw:n[0],depth:"="===n[2].charAt(0)?1:2,text:n[1],tokens:this.lexer.inline(n[1])}}paragraph(e){const n=this.rules.block.paragraph.exec(e);if(n){const i="\n"===n[1].charAt(n[1].length-1)?n[1].slice(0,-1):n[1];return{type:"paragraph",raw:n[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const n=this.rules.block.text.exec(e);if(n)return{type:"text",raw:n[0],text:n[0],tokens:this.lexer.inline(n[0])}}escape(e){const n=this.rules.inline.escape.exec(e);if(n)return{type:"escape",raw:n[0],text:pr(n[1])}}tag(e){const n=this.rules.inline.tag.exec(e);if(n)return!this.lexer.state.inLink&&/^<a /i.test(n[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(n[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(n[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(n[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:n[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:n[0]}}link(e){const n=this.rules.inline.link.exec(e);if(n){const i=n[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const o=Qy(i.slice(0,-1),"\\");if((i.length-o.length)%2==0)return}else{const o=function Yfe(t,e){if(-1===t.indexOf(e[1]))return-1;let n=0;for(let i=0;i<t.length;i++)if("\\"===t[i])i++;else if(t[i]===e[0])n++;else if(t[i]===e[1]&&(n--,n<0))return i;return-1}(n[2],"()");if(o>-1){const c=(0===n[0].indexOf("!")?5:4)+n[1].length+o;n[2]=n[2].substring(0,o),n[0]=n[0].substring(0,c).trim(),n[3]=""}}let r=n[2],s="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);o&&(r=o[1],s=o[3])}else s=n[3]?n[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(r=this.options.pedantic&&!/>$/.test(i)?r.slice(1):r.slice(1,-1)),dj(n,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},n[0],this.lexer)}}reflink(e,n){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){const s=n[(i[2]||i[1]).replace(/\s+/g," ").toLowerCase()];if(!s){const o=i[0].charAt(0);return{type:"text",raw:o,text:o}}return dj(i,s,i[0],this.lexer)}}emStrong(e,n,i=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!(!r||r[3]&&i.match(/[\p{L}\p{N}]/u))&&(!r[1]&&!r[2]||!i||this.rules.inline.punctuation.exec(i))){const o=[...r[0]].length-1;let a,c,l=o,u=0;const d="*"===r[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,n=n.slice(-1*e.length+o);null!=(r=d.exec(n));){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(c=[...a].length,r[3]||r[4]){l+=c;continue}if((r[5]||r[6])&&o%3&&!((o+c)%3)){u+=c;continue}if(l-=c,l>0)continue;c=Math.min(c,c+l+u);const h=[...r[0]][0].length,f=e.slice(0,o+r.index+h+c);if(Math.min(o,c)%2){const g=f.slice(1,-1);return{type:"em",raw:f,text:g,tokens:this.lexer.inlineTokens(g)}}const p=f.slice(2,-2);return{type:"strong",raw:f,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const n=this.rules.inline.code.exec(e);if(n){let i=n[2].replace(/\n/g," ");const r=/[^ ]/.test(i),s=/^ /.test(i)&&/ $/.test(i);return r&&s&&(i=i.substring(1,i.length-1)),i=pr(i,!0),{type:"codespan",raw:n[0],text:i}}}br(e){const n=this.rules.inline.br.exec(e);if(n)return{type:"br",raw:n[0]}}del(e){const n=this.rules.inline.del.exec(e);if(n)return{type:"del",raw:n[0],text:n[2],tokens:this.lexer.inlineTokens(n[2])}}autolink(e){const n=this.rules.inline.autolink.exec(e);if(n){let i,r;return"@"===n[2]?(i=pr(n[1]),r="mailto:"+i):(i=pr(n[1]),r=i),{type:"link",raw:n[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}url(e){let n;if(n=this.rules.inline.url.exec(e)){let i,r;if("@"===n[2])i=pr(n[0]),r="mailto:"+i;else{let s;do{s=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])?.[0]??""}while(s!==n[0]);i=pr(n[0]),r="www."===n[1]?"http://"+n[0]:n[0]}return{type:"link",raw:n[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const n=this.rules.inline.text.exec(e);if(n){let i;return i=this.lexer.state.inRawBlock?n[0]:pr(n[0]),{type:"text",raw:n[0],text:i}}}}const ep=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,hj=/(?:[*+-]|\d{1,9}[.)])/,fj=Tt(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,hj).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),BT=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,kT=/(?!\s*\])(?:\\.|[^\[\]\\])+/,npe=Tt(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",kT).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ipe=Tt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,hj).getRegex(),tv="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",UT=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,rpe=Tt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",UT).replace("tag",tv).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),pj=Tt(BT).replace("hr",ep).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",tv).getRegex(),VT={blockquote:Tt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",pj).getRegex(),code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,def:npe,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:ep,html:rpe,lheading:fj,list:ipe,newline:/^(?: *(?:\n|$))+/,paragraph:pj,table:Qf,text:/^[^\n]+/},gj=Tt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ep).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",tv).getRegex(),spe={...VT,table:gj,paragraph:Tt(BT).replace("hr",ep).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",gj).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",tv).getRegex()},ope={...VT,html:Tt("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",UT).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Qf,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Tt(BT).replace("hr",ep).replace("heading"," *#{1,6} *[^\n]").replace("lheading",fj).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},mj=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,_j=/^( {2,}|\\)\n(?!\s*$)/,tp="\\p{P}\\p{S}",lpe=Tt(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,tp).getRegex(),dpe=Tt(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,tp).getRegex(),hpe=Tt("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,tp).getRegex(),fpe=Tt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,tp).getRegex(),ppe=Tt(/\\([punct])/,"gu").replace(/punct/g,tp).getRegex(),gpe=Tt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),mpe=Tt(UT).replace("(?:--\x3e|$)","--\x3e").getRegex(),_pe=Tt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",mpe).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),nv=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,ype=Tt(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",nv).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),yj=Tt(/^!?\[(label)\]\[(ref)\]/).replace("label",nv).replace("ref",kT).getRegex(),vj=Tt(/^!?\[(ref)\](?:\[\])?/).replace("ref",kT).getRegex(),jT={_backpedal:Qf,anyPunctuation:ppe,autolink:gpe,blockSkip:/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,br:_j,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:Qf,emStrongLDelim:dpe,emStrongRDelimAst:hpe,emStrongRDelimUnd:fpe,escape:mj,link:ype,nolink:vj,punctuation:lpe,reflink:yj,reflinkSearch:Tt("reflink|nolink(?!\\()","g").replace("reflink",yj).replace("nolink",vj).getRegex(),tag:_pe,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:Qf},bpe={...jT,link:Tt(/^!?\[(label)\]\((.*?)\)/).replace("label",nv).getRegex(),reflink:Tt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",nv).getRegex()},HT={...jT,escape:Tt(mj).replace("])","~|])").getRegex(),url:Tt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Epe={...HT,br:Tt(_j).replace("{2,}","*").getRegex(),text:Tt(HT.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},iv={normal:VT,gfm:spe,pedantic:ope},np={normal:jT,gfm:HT,breaks:Epe,pedantic:bpe};class Hs{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Jc,this.options.tokenizer=this.options.tokenizer||new ev,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={block:iv.normal,inline:np.normal};this.options.pedantic?(n.block=iv.pedantic,n.inline=np.pedantic):this.options.gfm&&(n.block=iv.gfm,n.inline=this.options.breaks?np.breaks:np.gfm),this.tokenizer.rules=n}static get rules(){return{block:iv,inline:np}}static lex(e,n){return new Hs(n).lex(e)}static lexInline(e,n){return new Hs(n).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,"\n"),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const i=this.inlineQueue[n];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[]){let i,r,s,o;for(e=this.options.pedantic?e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e.replace(/^( *)(\t+)/gm,(a,c,l)=>c+"    ".repeat(l.length));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>!!(i=a.call({lexer:this},e,n))&&(e=e.substring(i.raw.length),n.push(i),!0)))){if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length),1===i.raw.length&&n.length>0?n[n.length-1].raw+="\n":n.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length),r=n[n.length-1],!r||"paragraph"!==r.type&&"text"!==r.type?n.push(i):(r.raw+="\n"+i.raw,r.text+="\n"+i.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length),r=n[n.length-1],!r||"paragraph"!==r.type&&"text"!==r.type?this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title}):(r.raw+="\n"+i.raw,r.text+="\n"+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text);continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),n.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const c=e.slice(1);let l;this.options.extensions.startBlock.forEach(u=>{l=u.call({lexer:this},c),"number"==typeof l&&l>=0&&(a=Math.min(a,l))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(i=this.tokenizer.paragraph(s))){r=n[n.length-1],o&&"paragraph"===r.type?(r.raw+="\n"+i.raw,r.text+="\n"+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):n.push(i),o=s.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length),r=n[n.length-1],r&&"text"===r.type?(r.raw+="\n"+i.raw,r.text+="\n"+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):n.push(i);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}throw new Error(a)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){let i,r,s,a,c,l,o=e;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;null!=(a=this.tokenizer.rules.inline.reflinkSearch.exec(o));)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(a=this.tokenizer.rules.inline.blockSkip.exec(o));)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(a=this.tokenizer.rules.inline.anyPunctuation.exec(o));)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(c||(l=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>!!(i=u.call({lexer:this},e,n))&&(e=e.substring(i.raw.length),n.push(i),!0)))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),r=n[n.length-1],r&&"text"===i.type&&"text"===r.type?(r.raw+=i.raw,r.text+=i.text):n.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),r=n[n.length-1],r&&"text"===i.type&&"text"===r.type?(r.raw+=i.raw,r.text+=i.text):n.push(i);continue}if(i=this.tokenizer.emStrong(e,o,l)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.autolink(e)){e=e.substring(i.raw.length),n.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e))){e=e.substring(i.raw.length),n.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const d=e.slice(1);let h;this.options.extensions.startInline.forEach(f=>{h=f.call({lexer:this},d),"number"==typeof h&&h>=0&&(u=Math.min(u,h))}),u<1/0&&u>=0&&(s=e.substring(0,u+1))}if(i=this.tokenizer.inlineText(s)){e=e.substring(i.raw.length),"_"!==i.raw.slice(-1)&&(l=i.raw.slice(-1)),c=!0,r=n[n.length-1],r&&"text"===r.type?(r.raw+=i.raw,r.text+=i.text):n.push(i);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}throw new Error(u)}}return n}}class Zc{options;constructor(e){this.options=e||Jc}code(e,n,i){const r=(n||"").match(/^\S*/)?.[0];return e=e.replace(/\n$/,"")+"\n",r?'<pre><code class="language-'+pr(r)+'">'+(i?e:pr(e,!0))+"</code></pre>\n":"<pre><code>"+(i?e:pr(e,!0))+"</code></pre>\n"}blockquote(e){return`<blockquote>\n${e}</blockquote>\n`}html(e,n){return e}heading(e,n,i){return`<h${n}>${e}</h${n}>\n`}hr(){return"<hr>\n"}list(e,n,i){const r=n?"ol":"ul";return"<"+r+(n&&1!==i?' start="'+i+'"':"")+">\n"+e+"</"+r+">\n"}listitem(e,n,i){return`<li>${e}</li>\n`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>\n`}table(e,n){return n&&(n=`<tbody>${n}</tbody>`),"<table>\n<thead>\n"+e+"</thead>\n"+n+"</table>\n"}tablerow(e){return`<tr>\n${e}</tr>\n`}tablecell(e,n){const i=n.header?"th":"td";return(n.align?`<${i} align="${n.align}">`:`<${i}>`)+e+`</${i}>\n`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,n,i){const r=lj(e);if(null===r)return i;let s='<a href="'+(e=r)+'"';return n&&(s+=' title="'+n+'"'),s+=">"+i+"</a>",s}image(e,n,i){const r=lj(e);if(null===r)return i;let s=`<img src="${e=r}" alt="${i}"`;return n&&(s+=` title="${n}"`),s+=">",s}text(e){return e}}class zT{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,n,i){return""+i}image(e,n,i){return""+i}br(){return""}}class zs{options;renderer;textRenderer;constructor(e){this.options=e||Jc,this.options.renderer=this.options.renderer||new Zc,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new zT}static parse(e,n){return new zs(n).parse(e)}static parseInline(e,n){return new zs(n).parseInline(e)}parse(e,n=!0){let i="";for(let r=0;r<e.length;r++){const s=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const o=s,a=this.options.extensions.renderers[o.type].call({parser:this},o);if(!1!==a||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(o.type)){i+=a||"";continue}}switch(s.type){case"space":continue;case"hr":i+=this.renderer.hr();continue;case"heading":{const o=s;i+=this.renderer.heading(this.parseInline(o.tokens),o.depth,qfe(this.parseInline(o.tokens,this.textRenderer)));continue}case"code":i+=this.renderer.code(s.text,s.lang,!!s.escaped);continue;case"table":{const o=s;let a="",c="";for(let u=0;u<o.header.length;u++)c+=this.renderer.tablecell(this.parseInline(o.header[u].tokens),{header:!0,align:o.align[u]});a+=this.renderer.tablerow(c);let l="";for(let u=0;u<o.rows.length;u++){const d=o.rows[u];c="";for(let h=0;h<d.length;h++)c+=this.renderer.tablecell(this.parseInline(d[h].tokens),{header:!1,align:o.align[h]});l+=this.renderer.tablerow(c)}i+=this.renderer.table(a,l);continue}case"blockquote":{const a=this.parse(s.tokens);i+=this.renderer.blockquote(a);continue}case"list":{const o=s,a=o.ordered,c=o.start,l=o.loose;let u="";for(let d=0;d<o.items.length;d++){const h=o.items[d],f=h.checked,p=h.task;let g="";if(h.task){const m=this.renderer.checkbox(!!f);l?h.tokens.length>0&&"paragraph"===h.tokens[0].type?(h.tokens[0].text=m+" "+h.tokens[0].text,h.tokens[0].tokens&&h.tokens[0].tokens.length>0&&"text"===h.tokens[0].tokens[0].type&&(h.tokens[0].tokens[0].text=m+" "+h.tokens[0].tokens[0].text)):h.tokens.unshift({type:"text",text:m+" "}):g+=m+" "}g+=this.parse(h.tokens,l),u+=this.renderer.listitem(g,p,!!f)}i+=this.renderer.list(u,a,c);continue}case"html":i+=this.renderer.html(s.text,s.block);continue;case"paragraph":i+=this.renderer.paragraph(this.parseInline(s.tokens));continue;case"text":{let o=s,a=o.tokens?this.parseInline(o.tokens):o.text;for(;r+1<e.length&&"text"===e[r+1].type;)o=e[++r],a+="\n"+(o.tokens?this.parseInline(o.tokens):o.text);i+=n?this.renderer.paragraph(a):a;continue}default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return i}parseInline(e,n){n=n||this.renderer;let i="";for(let r=0;r<e.length;r++){const s=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const o=this.options.extensions.renderers[s.type].call({parser:this},s);if(!1!==o||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){i+=o||"";continue}}switch(s.type){case"escape":case"text":i+=n.text(s.text);break;case"html":i+=n.html(s.text);break;case"link":i+=n.link(s.href,s.title,this.parseInline(s.tokens,n));break;case"image":i+=n.image(s.href,s.title,s.text);break;case"strong":i+=n.strong(this.parseInline(s.tokens,n));break;case"em":i+=n.em(this.parseInline(s.tokens,n));break;case"codespan":i+=n.codespan(s.text);break;case"br":i+=n.br();break;case"del":i+=n.del(this.parseInline(s.tokens,n));break;default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return i}}class rv{options;constructor(e){this.options=e||Jc}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}const Qc=new class wpe{defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};options=this.setOptions;parse=this.#e(Hs.lex,zs.parse);parseInline=this.#e(Hs.lexInline,zs.parseInline);Parser=zs;Renderer=Zc;TextRenderer=zT;Lexer=Hs;Tokenizer=ev;Hooks=rv;constructor(...e){this.use(...e)}walkTokens(e,n){let i=[];for(const r of e)switch(i=i.concat(n.call(this,r)),r.type){case"table":{const s=r;for(const o of s.header)i=i.concat(this.walkTokens(o.tokens,n));for(const o of s.rows)for(const a of o)i=i.concat(this.walkTokens(a.tokens,n));break}case"list":i=i.concat(this.walkTokens(r.items,n));break;default:{const s=r;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(o=>{const a=s[o].flat(1/0);i=i.concat(this.walkTokens(a,n))}):s.tokens&&(i=i.concat(this.walkTokens(s.tokens,n)))}}return i}use(...e){const n=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(i=>{const r={...i};if(r.async=this.defaults.async||r.async||!1,i.extensions&&(i.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const o=n.renderers[s.name];n.renderers[s.name]=o?function(...a){let c=s.renderer.apply(this,a);return!1===c&&(c=o.apply(this,a)),c}:s.renderer}if("tokenizer"in s){if(!s.level||"block"!==s.level&&"inline"!==s.level)throw new Error("extension level must be 'block' or 'inline'");const o=n[s.level];o?o.unshift(s.tokenizer):n[s.level]=[s.tokenizer],s.start&&("block"===s.level?n.startBlock?n.startBlock.push(s.start):n.startBlock=[s.start]:"inline"===s.level&&(n.startInline?n.startInline.push(s.start):n.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(n.childTokens[s.name]=s.childTokens)}),r.extensions=n),i.renderer){const s=this.defaults.renderer||new Zc(this.defaults);for(const o in i.renderer){if(!(o in s))throw new Error(`renderer '${o}' does not exist`);if("options"===o)continue;const c=i.renderer[o],l=s[o];s[o]=(...u)=>{let d=c.apply(s,u);return!1===d&&(d=l.apply(s,u)),d||""}}r.renderer=s}if(i.tokenizer){const s=this.defaults.tokenizer||new ev(this.defaults);for(const o in i.tokenizer){if(!(o in s))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const c=i.tokenizer[o],l=s[o];s[o]=(...u)=>{let d=c.apply(s,u);return!1===d&&(d=l.apply(s,u)),d}}r.tokenizer=s}if(i.hooks){const s=this.defaults.hooks||new rv;for(const o in i.hooks){if(!(o in s))throw new Error(`hook '${o}' does not exist`);if("options"===o)continue;const c=i.hooks[o],l=s[o];s[o]=rv.passThroughHooks.has(o)?u=>{if(this.defaults.async)return Promise.resolve(c.call(s,u)).then(h=>l.call(s,h));const d=c.call(s,u);return l.call(s,d)}:(...u)=>{let d=c.apply(s,u);return!1===d&&(d=l.apply(s,u)),d}}r.hooks=s}if(i.walkTokens){const s=this.defaults.walkTokens,o=i.walkTokens;r.walkTokens=function(a){let c=[];return c.push(o.call(this,a)),s&&(c=c.concat(s.call(this,a))),c}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,n){return Hs.lex(e,n??this.defaults)}parser(e,n){return zs.parse(e,n??this.defaults)}#e(e,n){return(i,r)=>{const s={...r},o={...this.defaults,...s};!0===this.defaults.async&&!1===s.async&&(o.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),o.async=!0);const a=this.#t(!!o.silent,!!o.async);if(typeof i>"u"||null===i)return a(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof i)return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(i):i).then(c=>e(c,o)).then(c=>o.hooks?o.hooks.processAllTokens(c):c).then(c=>o.walkTokens?Promise.all(this.walkTokens(c,o.walkTokens)).then(()=>c):c).then(c=>n(c,o)).then(c=>o.hooks?o.hooks.postprocess(c):c).catch(a);try{o.hooks&&(i=o.hooks.preprocess(i));let c=e(i,o);o.hooks&&(c=o.hooks.processAllTokens(c)),o.walkTokens&&this.walkTokens(c,o.walkTokens);let l=n(c,o);return o.hooks&&(l=o.hooks.postprocess(l)),l}catch(c){return a(c)}}}#t(e,n){return i=>{if(i.message+="\nPlease report this to https://github.com/markedjs/marked.",e){const r="<p>An error occurred:</p><pre>"+pr(i.message+"",!0)+"</pre>";return n?Promise.resolve(r):r}if(n)return Promise.reject(i);throw i}}};function at(t,e){return Qc.parse(t,e)}at.options=at.setOptions=function(t){return Qc.setOptions(t),sj(at.defaults=Qc.defaults),at},at.getDefaults=function FT(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}},at.defaults=Jc,at.use=function(...t){return Qc.use(...t),sj(at.defaults=Qc.defaults),at},at.walkTokens=function(t,e){return Qc.walkTokens(t,e)},at.parseInline=Qc.parseInline,at.Parser=zs,at.parser=zs.parse,at.Renderer=Zc,at.TextRenderer=zT,at.Lexer=Hs,at.lexer=Hs.lex,at.Tokenizer=ev,at.Hooks=rv,at.parse=at;const Ape=["*"];let bj=(()=>{class t{constructor(){this._buttonClick$=new de,this.copied$=this._buttonClick$.pipe(hn(()=>Nc(ne(!0),Sy(3e3).pipe(AC(!1)))),bf(),dr(1)),this.copiedText$=this.copied$.pipe(Sa(!1),se(n=>n?"Copied":"Copy"))}onCopyToClipboardClick(){this._buttonClick$.next()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=an({type:t,selectors:[["markdown-clipboard"]],standalone:!0,features:[Vi],decls:4,vars:7,consts:[[1,"markdown-clipboard-button",3,"click"]],template:function(i,r){1&i&&(pt(0,"button",0),va(1,"async"),Ui("click",function(){return r.onCopyToClipboardClick()}),ya(2),va(3,"async"),wt()),2&i&&(cr("copied",ba(1,3,r.copied$)),qn(2),Dc(ba(3,5,r.copiedText$)))},dependencies:[M_],encapsulation:2,changeDetection:0})}return t})();const Spe=new L("CLIPBOARD_OPTIONS");var GT=function(t){return t.CommandLine="command-line",t.LineHighlight="line-highlight",t.LineNumbers="line-numbers",t}(GT||{});const Ej=new L("MARKED_EXTENSIONS"),Ipe=new L("MARKED_OPTIONS"),wj=new L("SECURITY_CONTEXT");let WT=(()=>{class t{get options(){return this._options}set options(n){this._options={...this.DEFAULT_MARKED_OPTIONS,...n}}get renderer(){return this.options.renderer}set renderer(n){this.options.renderer=n}constructor(n,i,r,s,o,a,c){this.clipboardOptions=n,this.extensions=i,this.platform=s,this.securityContext=o,this.http=a,this.sanitizer=c,this.DEFAULT_MARKED_OPTIONS={renderer:new Zc},this.DEFAULT_KATEX_OPTIONS={delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\begin{CD}",right:"\\end{CD}",display:!0},{left:"\\[",right:"\\]",display:!0}]},this.DEFAULT_MERMAID_OPTIONS={startOnLoad:!1},this.DEFAULT_CLIPBOARD_OPTIONS={buttonComponent:void 0},this.DEFAULT_PARSE_OPTIONS={decodeHtml:!1,inline:!1,emoji:!1,mermaid:!1,markedOptions:void 0,disableSanitizer:!1},this.DEFAULT_RENDER_OPTIONS={clipboard:!1,clipboardOptions:void 0,katex:!1,katexOptions:void 0,mermaid:!1,mermaidOptions:void 0},this._reload$=new de,this.reload$=this._reload$.asObservable(),this.options=r}parse(n,i=this.DEFAULT_PARSE_OPTIONS){const{decodeHtml:r,inline:s,emoji:o,mermaid:a,disableSanitizer:c}=i,l={...this.options,...i.markedOptions},u=l.renderer||this.renderer||new Zc;this.extensions&&(this.renderer=this.extendsRendererForExtensions(u)),a&&(this.renderer=this.extendsRendererForMermaid(u));const d=this.trimIndentation(n),h=r?this.decodeHtml(d):d,f=o?this.parseEmoji(h):h,p=this.parseMarked(f,l,s);return(c?p:this.sanitizer.sanitize(this.securityContext,p))||""}render(n,i=this.DEFAULT_RENDER_OPTIONS,r){const{clipboard:s,clipboardOptions:o,katex:a,katexOptions:c,mermaid:l,mermaidOptions:u}=i;a&&this.renderKatex(n,{...this.DEFAULT_KATEX_OPTIONS,...c}),l&&this.renderMermaid(n,{...this.DEFAULT_MERMAID_OPTIONS,...u}),s&&this.renderClipboard(n,r,{...this.DEFAULT_CLIPBOARD_OPTIONS,...this.clipboardOptions,...o}),this.highlight(n)}reload(){this._reload$.next()}getSource(n){if(!this.http)throw new Error("[ngx-markdown] When using the `src` attribute you *have to* pass the `HttpClient` as a parameter of the `forRoot` method. See README for more information");return this.http.get(n,{responseType:"text"}).pipe(se(i=>this.handleExtension(n,i)))}highlight(n){if(!Ca(this.platform)||typeof Prism>"u"||typeof Prism.highlightAllUnder>"u")return;n||(n=document);const i=n.querySelectorAll('pre code:not([class*="language-"])');Array.prototype.forEach.call(i,r=>r.classList.add("language-none")),Prism.highlightAllUnder(n)}decodeHtml(n){if(!Ca(this.platform))return n;const i=document.createElement("textarea");return i.innerHTML=n,i.value}extendsRendererForExtensions(n){const i=n;return!0===i.\u0275NgxMarkdownRendererExtendedForExtensions||(this.extensions?.length>0&&at.use(...this.extensions),i.\u0275NgxMarkdownRendererExtendedForExtensions=!0),n}extendsRendererForMermaid(n){const i=n;if(!0===i.\u0275NgxMarkdownRendererExtendedForMermaid)return n;const r=n.code;return n.code=function(s,o,a){return"mermaid"===o?`<div class="mermaid">${s}</div>`:r.call(this,s,o,a)},i.\u0275NgxMarkdownRendererExtendedForMermaid=!0,n}handleExtension(n,i){const r=n.lastIndexOf("://"),s=r>-1?n.substring(r+4):n,o=s.lastIndexOf("/"),a=o>-1?s.substring(o+1).split("?")[0]:"",c=a.lastIndexOf("."),l=c>-1?a.substring(c+1):"";return l&&"md"!==l?"```"+l+"\n"+i+"\n```":i}parseMarked(n,i,r=!1){if(i.renderer){const s={...i.renderer};delete s.\u0275NgxMarkdownRendererExtendedForExtensions,delete s.\u0275NgxMarkdownRendererExtendedForMermaid,delete i.renderer,at.use({renderer:s})}return r?at.parseInline(n,i):at.parse(n,i)}parseEmoji(n){if(!Ca(this.platform))return n;if(typeof joypixels>"u"||typeof joypixels.shortnameToUnicode>"u")throw new Error("[ngx-markdown] When using the `emoji` attribute you *have to* include Emoji-Toolkit files to `angular.json` or use imports. See README for more information");return joypixels.shortnameToUnicode(n)}renderKatex(n,i){if(Ca(this.platform)){if(typeof katex>"u"||typeof renderMathInElement>"u")throw new Error("[ngx-markdown] When using the `katex` attribute you *have to* include KaTeX files to `angular.json` or use imports. See README for more information");renderMathInElement(n,i)}}renderClipboard(n,i,r){if(!Ca(this.platform))return;if(typeof ClipboardJS>"u")throw new Error("[ngx-markdown] When using the `clipboard` attribute you *have to* include Clipboard files to `angular.json` or use imports. See README for more information");if(!i)throw new Error("[ngx-markdown] When using the `clipboard` attribute you *have to* provide the `viewContainerRef` parameter to `MarkdownService.render()` function");const{buttonComponent:s,buttonTemplate:o}=r,a=n.querySelectorAll("pre");for(let c=0;c<a.length;c++){const l=a.item(c),u=document.createElement("div");u.style.position="relative",l.parentNode.insertBefore(u,l),u.appendChild(l);const d=document.createElement("div");let h,f;if(d.classList.add("markdown-clipboard-toolbar"),d.style.position="absolute",d.style.top=".5em",d.style.right=".5em",d.style.zIndex="1",u.insertAdjacentElement("beforeend",d),u.onmouseenter=()=>d.classList.add("hover"),u.onmouseleave=()=>d.classList.remove("hover"),s){const p=i.createComponent(s);h=p.hostView,p.changeDetectorRef.markForCheck()}else if(o)h=i.createEmbeddedView(o);else{const p=i.createComponent(bj);h=p.hostView,p.changeDetectorRef.markForCheck()}h.rootNodes.forEach(p=>{d.appendChild(p),f=new ClipboardJS(p,{text:()=>l.innerText})}),h.onDestroy(()=>f.destroy())}}renderMermaid(n,i=this.DEFAULT_MERMAID_OPTIONS){if(!Ca(this.platform))return;if(typeof mermaid>"u"||typeof mermaid.initialize>"u")throw new Error("[ngx-markdown] When using the `mermaid` attribute you *have to* include Mermaid files to `angular.json` or use imports. See README for more information");const r=n.querySelectorAll(".mermaid");0!==r.length&&(mermaid.initialize(i),mermaid.run({nodes:r}))}trimIndentation(n){if(!n)return"";let i;return n.split("\n").map(r=>{let s=i;return r.length>0&&(s=isNaN(s)?r.search(/\S|$/):Math.min(r.search(/\S|$/),s)),isNaN(i)&&(i=s),s?r.substring(s):r}).join("\n")}static#e=this.\u0275fac=function(i){return new(i||t)(D(Spe,8),D(Ej,8),D(Ipe,8),D(Mr),D(wj),D(Us,8),D(yf))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})(),Aj=(()=>{class t{get disableSanitizer(){return this._disableSanitizer}set disableSanitizer(n){this._disableSanitizer=this.coerceBooleanProperty(n)}get inline(){return this._inline}set inline(n){this._inline=this.coerceBooleanProperty(n)}get clipboard(){return this._clipboard}set clipboard(n){this._clipboard=this.coerceBooleanProperty(n)}get emoji(){return this._emoji}set emoji(n){this._emoji=this.coerceBooleanProperty(n)}get katex(){return this._katex}set katex(n){this._katex=this.coerceBooleanProperty(n)}get mermaid(){return this._mermaid}set mermaid(n){this._mermaid=this.coerceBooleanProperty(n)}get lineHighlight(){return this._lineHighlight}set lineHighlight(n){this._lineHighlight=this.coerceBooleanProperty(n)}get lineNumbers(){return this._lineNumbers}set lineNumbers(n){this._lineNumbers=this.coerceBooleanProperty(n)}get commandLine(){return this._commandLine}set commandLine(n){this._commandLine=this.coerceBooleanProperty(n)}constructor(n,i,r){this.element=n,this.markdownService=i,this.viewContainerRef=r,this.error=new Pe,this.load=new Pe,this.ready=new Pe,this._clipboard=!1,this._commandLine=!1,this._disableSanitizer=!1,this._emoji=!1,this._inline=!1,this._katex=!1,this._lineHighlight=!1,this._lineNumbers=!1,this._mermaid=!1,this.destroyed$=new de}ngOnChanges(){this.loadContent()}loadContent(){null==this.data?null==this.src||this.handleSrc():this.handleData()}ngAfterViewInit(){!this.data&&!this.src&&this.handleTransclusion(),this.markdownService.reload$.pipe(Ns(this.destroyed$)).subscribe(()=>this.loadContent())}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}render(n,i=!1){var r=this;return ee(function*(){const s={decodeHtml:i,inline:r.inline,emoji:r.emoji,mermaid:r.mermaid,disableSanitizer:r.disableSanitizer},o={clipboard:r.clipboard,clipboardOptions:{buttonComponent:r.clipboardButtonComponent,buttonTemplate:r.clipboardButtonTemplate},katex:r.katex,katexOptions:r.katexOptions,mermaid:r.mermaid,mermaidOptions:r.mermaidOptions},a=yield r.markdownService.parse(n,s);r.element.nativeElement.innerHTML=a,r.handlePlugins(),r.markdownService.render(r.element.nativeElement,o,r.viewContainerRef),r.ready.emit()})()}coerceBooleanProperty(n){return null!=n&&"false"!=`${String(n)}`}handleData(){this.render(this.data)}handleSrc(){this.markdownService.getSource(this.src).subscribe({next:n=>{this.render(n).then(()=>{this.load.emit(n)})},error:n=>this.error.emit(n)})}handleTransclusion(){this.render(this.element.nativeElement.innerHTML,!0)}handlePlugins(){this.commandLine&&(this.setPluginClass(this.element.nativeElement,GT.CommandLine),this.setPluginOptions(this.element.nativeElement,{dataFilterOutput:this.filterOutput,dataHost:this.host,dataPrompt:this.prompt,dataOutput:this.output,dataUser:this.user})),this.lineHighlight&&this.setPluginOptions(this.element.nativeElement,{dataLine:this.line,dataLineOffset:this.lineOffset}),this.lineNumbers&&(this.setPluginClass(this.element.nativeElement,GT.LineNumbers),this.setPluginOptions(this.element.nativeElement,{dataStart:this.start}))}setPluginClass(n,i){const r=n.querySelectorAll("pre");for(let s=0;s<r.length;s++){const o=i instanceof Array?i:[i];r.item(s).classList.add(...o)}}setPluginOptions(n,i){const r=n.querySelectorAll("pre");for(let s=0;s<r.length;s++)Object.keys(i).forEach(o=>{const a=i[o];if(a){const c=this.toLispCase(o);r.item(s).setAttribute(c,a.toString())}})}toLispCase(n){const i=n.match(/([A-Z])/g);if(!i)return n;let r=n.toString();for(let s=0,o=i.length;s<o;s++)r=r.replace(new RegExp(i[s]),"-"+i[s].toLowerCase());return"-"===r.slice(0,1)&&(r=r.slice(1)),r}static#e=this.\u0275fac=function(i){return new(i||t)(j(en),j(WT),j(Ci))};static#t=this.\u0275cmp=an({type:t,selectors:[["markdown"],["","markdown",""]],inputs:{data:"data",src:"src",disableSanitizer:"disableSanitizer",inline:"inline",clipboard:"clipboard",clipboardButtonComponent:"clipboardButtonComponent",clipboardButtonTemplate:"clipboardButtonTemplate",emoji:"emoji",katex:"katex",katexOptions:"katexOptions",mermaid:"mermaid",mermaidOptions:"mermaidOptions",lineHighlight:"lineHighlight",line:"line",lineOffset:"lineOffset",lineNumbers:"lineNumbers",start:"start",commandLine:"commandLine",filterOutput:"filterOutput",host:"host",prompt:"prompt",output:"output",user:"user"},outputs:{error:"error",load:"load",ready:"ready"},standalone:!0,features:[xr,Vi],ngContentSelectors:Ape,decls:1,vars:0,template:function(i,r){1&i&&(ga(),ui(0))},encapsulation:2})}return t})();var Cj;function Fpe(t,e){if(1&t&&(pt(0,"div",16),Rs(1,"youtube-player",17),wt()),2&t){const n=Ao(3);qn(),Vw("videoId",n.videoID)}}function Bpe(t,e){if(1&t&&(pt(0,"mat-expansion-panel",11)(1,"mat-expansion-panel-header")(2,"h2",12),ya(3),wt()(),pt(4,"div",13),Rs(5,"markdown",14),es(6,Fpe,2,1,"div",15),wt()()),2&t){const n=Ao(),i=n.$implicit,r=n.index;li("expanded",0===r),qn(3),Dc(i.title),qn(2),cr("first",0===r),li("data",i.content),qn(),li("ngIf",0===r)}}function kpe(t,e){if(1&t&&(pt(0,"div",9),es(1,Bpe,7,6,"mat-expansion-panel",10),wt()),2&t){const n=e.$implicit;qn(),li("ngIf",n)}}!function(t){let e;var r;let n,i;(r=e=t.SecurityLevel||(t.SecurityLevel={})).Strict="strict",r.Loose="loose",r.Antiscript="antiscript",r.Sandbox="sandbox",function(r){r.Base="base",r.Forest="forest",r.Dark="dark",r.Default="default",r.Neutral="neutral"}(n=t.Theme||(t.Theme={})),function(r){r[r.Debug=1]="Debug",r[r.Info=2]="Info",r[r.Warn=3]="Warn",r[r.Error=4]="Error",r[r.Fatal=5]="Fatal"}(i=t.LogLevel||(t.LogLevel={}))}(Cj||(Cj={}));let Upe=(()=>{class t{constructor(n,i){this.dialogRef=n,this.data=i,this.documentationContents=i.content||[],this.infoTitle=i.title||"",this.videoID=i.videoID}ngOnInit(){const n=document.createElement("script");n.src="https://www.youtube.com/iframe_api",document.body.appendChild(n)}close(){document.getElementsByClassName("modal-animated")[0]?.classList.add("modal-animate-fade-out"),setTimeout(()=>{this.dialogRef.close()},250)}static#e=this.\u0275fac=function(i){return new(i||t)(j(Xy),j(NV))};static#t=this.\u0275cmp=an({type:t,selectors:[["ccf-info-dialog"]],decls:11,vars:2,consts:[[1,"about","wrapper"],[1,"container"],[1,"content"],[1,"header"],["mat-dialog-title","",1,"title"],[1,"close"],[1,"material-icons","close-icon",3,"click"],[1,"mat-typography","dialog-content"],["class","panel",4,"ngFor","ngForOf"],[1,"panel"],[3,"expanded",4,"ngIf"],[3,"expanded"],[1,"no-header-margin"],[1,"top-padding"],[1,"variable-binding",3,"data"],["class","video-player",4,"ngIf"],[1,"video-player"],[3,"videoId"]],template:function(i,r){1&i&&(pt(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),ya(5),wt(),pt(6,"div",5)(7,"mat-icon",6),Ui("click",function(){return r.close()}),ya(8,"clear"),wt()()(),pt(9,"mat-dialog-content",7),es(10,kpe,2,1,"div",8),wt()()()()),2&i&&(qn(5),Dc(r.infoTitle),qn(5),li("ngForOf",r.documentationContents))},dependencies:[WB,FA,PT,NT,WV,QV,Ffe,jfe,Aj],styles:[".mat-dialog-container{padding:0}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:1.5rem;text-align:left}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;height:3rem;margin-bottom:2.25rem;position:relative}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.5rem;margin-bottom:1rem}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{cursor:pointer;height:3rem;width:3rem;line-height:3rem;text-align:center;transition:.6s}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.5rem;margin:0 auto;line-height:3rem;height:3rem;justify-self:center;display:flex}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1rem;margin-top:0;margin-bottom:.5rem}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]{margin-bottom:1.5rem}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .no-header-margin[_ngcontent-%COMP%]{font-weight:300;margin-bottom:0}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .top-padding[_ngcontent-%COMP%]{display:flex}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .top-padding[_ngcontent-%COMP%]   markdown[_ngcontent-%COMP%]     ul{margin-top:0;padding-left:1.5rem}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]{height:50rem;min-height:10rem;padding:0 1.5rem}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding[_ngcontent-%COMP%]{font-weight:300;display:flex}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding.first[_ngcontent-%COMP%]{padding-right:1rem;width:73%}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding[_ngcontent-%COMP%]     ul{margin:0}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding[_ngcontent-%COMP%]     img{margin-left:1rem;float:right}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .video-player[_ngcontent-%COMP%]{position:relative;width:50%}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .video-player[_ngcontent-%COMP%]     iframe{width:100%;height:100%}"],changeDetection:0})}return t})();class Lr{static#e=this.storage=(()=>{let e;try{e=window.localStorage;const n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(n){return n instanceof DOMException&&(22===n.code||1014===n.code||"QuotaExceededError"===n.name||"NS_ERROR_DOM_QUOTA_REACHED"===n.name)&&e&&0!==e.length?e:void 0}})();get length(){return Lr.storage?.length??0}key(e){return Lr.storage?.key(e)??null}getItem(e,n){return Lr.storage?.getItem(e)??n??null}setItem(e,n){try{return Lr.storage?.setItem(e,n),!0}catch{return!1}}removeItem(e){Lr.storage?.removeItem(e)}clear(){Lr.storage?.clear()}static#t=this.\u0275fac=function(n){return new(n||Lr)};static#n=this.\u0275prov=V({token:Lr,factory:Lr.\u0275fac,providedIn:"root"})}var sv;const Tj="callToActionPopupShown";let Fr=class Ab{static#e=sv=this;static ctaDatePassed(e,n=Date.now){return+n()>+new Date(e)}constructor(e,n,i,r,s){this.dialog=e,this.ga=n,this.storage=i,this.infoService=r,this.http=s}ngxsOnInit(e){const{expirationDate:n,popupShown:i}=e.getState(),r=this.storage.getItem(Tj,`${i}`),s=sv.ctaDatePassed(n);"true"!==r&&!s&&e.dispatch(new HU)}getDialogData(){return this.http.get("assets/docs/SPATIAL_SEARCH_README.md",{responseType:"text"}).pipe(se(e=>this.infoService.parseMarkdown(e)))}launchLearnMore(e){this.dialog.open(Upe,{autoFocus:!1,panelClass:"modal-animated",width:"72rem",data:{title:"Spatial Search",content:e,videoID:"UfxMpzatowE"}})}learnMore(e){return this.dialog.closeAll(),this.ga.event("open_learn_more","call_to_action"),this.getDialogData().pipe(At(n=>this.launchLearnMore(n)))}open(e){this.dialog.open(sv.callToActionComponent,{autoFocus:!1,panelClass:"modal-animated",width:"30.75rem",height:"36.688rem"}),this.ga.event("open","call_to_action"),this.storage.setItem(Tj,"true"),e.patchState({popupShown:!0})}close(e){this.dialog.closeAll(),this.ga.event("close","call_to_action")}static#t=this.\u0275fac=function(n){return new(n||Ab)(D(Yy),D(JC),D(Lr),D(UV),D(Us))};static#n=this.\u0275prov=V({token:Ab,factory:Ab.\u0275fac})};ze([gC(jU),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",ge)],Fr.prototype,"learnMore",null),ze([gC(HU),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",void 0)],Fr.prototype,"open",null),ze([gC(zU),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",void 0)],Fr.prototype,"close",null),Fr=sv=ze([mC({name:"callToAction",defaults:{title:"New to the Exploration User Interface",message:"Spatial Search has arrived!",callToAction:"Learn More",imageUrl:"assets/images/spatial_search.gif",expirationDate:"Dec 1, 2022",popupShown:!1}}),Z("design:paramtypes",[Yy,JC,Lr,UV,Us])],Fr);class Gs{static title(e){return e.title}static message(e){return e.message}static callToAction(e){return e.callToAction}static imageUrl(e){return e.imageUrl}static expirationDate(e){return e.expirationDate}static popupShown(e){return e.popupShown}}ze([Bu([Fr]),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",String)],Gs,"title",null),ze([Bu([Fr]),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",String)],Gs,"message",null),ze([Bu([Fr]),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",String)],Gs,"callToAction",null),ze([Bu([Fr]),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",String)],Gs,"imageUrl",null),ze([Bu([Fr]),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",String)],Gs,"expirationDate",null),ze([Bu([Fr]),Z("design:type",Function),Z("design:paramtypes",[Object]),Z("design:returntype",Boolean)],Gs,"popupShown",null);let Sj=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275dir=Xe({type:t,selectors:[["","mat-card-sm-image",""],["","matCardImageSmall",""]],hostAttrs:[1,"mat-mdc-card-sm-image","mdc-card__media"],standalone:!0})}return t})(),nge=(()=>{class t{constructor(){this.clsName="ccf-call-to-action",this.callToActionClicked=new Pe,this.closeClicked=new Pe}close(){this.closeClicked.emit()}onDialogButtonClick(){this.callToActionClicked.emit()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=an({type:t,selectors:[["ccf-call-to-action"]],hostVars:2,hostBindings:function(i,r){2&i&&Hm(r.clsName)},inputs:{infoTitle:"infoTitle",imageUrl:"imageUrl",message:"message",callToAction:"callToAction"},outputs:{callToActionClicked:"callToActionClicked",closeClicked:"closeClicked"},decls:13,vars:4,consts:[[1,"rui-about","wrapper"],[1,"container"],[1,"content"],[1,"first-row"],["mat-dialog-title","",1,"title"],[1,"cta-mat-icon","material-icons","close-icon",3,"click"],["mat-card-sm-image","","alt","preview","layout-fill","",1,"cta-image",3,"src"],[1,"mat-typography","dialog-content"],[1,"message"],["mat-button","",1,"mat-button",3,"click","text"]],template:function(i,r){1&i&&(pt(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"p",4),ya(5),wt(),pt(6,"mat-icon",5),Ui("click",function(){return r.close()}),ya(7,"clear"),wt()(),Rs(8,"img",6),pt(9,"mat-dialog-content",7)(10,"div",8),ya(11),wt(),pt(12,"a",9),Ui("click",function(){return r.onDialogButtonClick()}),wt()()()()()),2&i&&(qn(5),Dc(r.infoTitle),qn(3),li("src",r.imageUrl,fE),qn(3),Dc(r.message),qn(),li("text",r.callToAction))},dependencies:[WV,PT,NT,Sj],styles:["[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{display:block;align-content:center;padding-left:1.6rem;padding-right:1.6rem;border-radius:.25rem}[_nghost-%COMP%]   .info-button-wrapper[_ngcontent-%COMP%]{border-radius:.25rem;padding:.6rem;transition:.6s}[_nghost-%COMP%]   .info-button-wrapper[_ngcontent-%COMP%]   .ccf-info-button[_ngcontent-%COMP%]{cursor:pointer;transition:color .6s;font-size:1.2rem;vertical-align:sub}[_nghost-%COMP%]   .first-row[_ngcontent-%COMP%]{display:flex;width:100%;line-height:.9rem}[_nghost-%COMP%]   .first-row[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:7rem;padding-left:.2rem;font-size:.875rem;padding-top:.75rem}[_nghost-%COMP%]   .first-row[_ngcontent-%COMP%]   .cta-mat-icon[_ngcontent-%COMP%]{height:30%;line-height:3.4rem}[_nghost-%COMP%]   .message[_ngcontent-%COMP%]{padding:.5rem}[_nghost-%COMP%]   .cta-image[_ngcontent-%COMP%]{align-self:center;object-fit:cover;width:100%;border-radius:.25rem}[_nghost-%COMP%]   .mat-button[_ngcontent-%COMP%]{background-color:#444a65;font-size:.75rem;position:relative;margin-bottom:1rem;width:100%;height:2rem;color:#fff}"],changeDetection:0})}return t})();class Ws{constructor(){this.close=()=>new zU,this.learnMore=()=>new jU}static#e=this.\u0275fac=function(n){return new(n||Ws)};static#t=this.\u0275cmp=an({type:Ws,selectors:[["ccf-call-to-action-behavior"]],decls:5,vars:12,consts:[[3,"callToActionClicked","closeClicked","infoTitle","message","callToAction","imageUrl"]],template:function(n,i){if(1&n&&(pt(0,"ccf-call-to-action",0),va(1,"async"),va(2,"async"),va(3,"async"),va(4,"async"),Ui("callToActionClicked",function(){return i.learnMore()})("closeClicked",function(){return i.close()}),wt()),2&n){let r,s,o,a;li("infoTitle",null!==(r=ba(1,4,i.title$))&&void 0!==r?r:"")("message",null!==(s=ba(2,6,i.message$))&&void 0!==s?s:"")("callToAction",null!==(o=ba(3,8,i.callToAction$))&&void 0!==o?o:"")("imageUrl",null!==(a=ba(4,10,i.imageUrl$))&&void 0!==a?a:"")}},dependencies:[nge,M_],changeDetection:0})}ze([$_(Gs.title),Z("design:type",ge)],Ws.prototype,"title$",void 0),ze([$_(Gs.message),Z("design:type",ge)],Ws.prototype,"message$",void 0),ze([$_(Gs.callToAction),Z("design:type",ge)],Ws.prototype,"callToAction$",void 0),ze([$_(Gs.imageUrl),Z("design:type",ge)],Ws.prototype,"imageUrl$",void 0),ze([VU(),Z("design:type",Object)],Ws.prototype,"close",void 0),ze([VU(),Z("design:type",Object)],Ws.prototype,"learnMore",void 0),Fr.callToActionComponent=Ws;const ige={initialConfig:{},parse:{},rename:{}};class rge{constructor(e,n){this.configState=e,this.storedChanges={},this.options={...ige,...n}}addChanges(e){this.storedChanges={...this.storedChanges,...e}}applyChanges(e,n={}){void 0===e&&(e=this.storedChanges,this.storedChanges={});const{configState:i,options:{initialConfig:r}}=this,o={...r,...i.snapshot,...n};for(const[a,c]of Object.entries(e))this.processChange(a,c,o);i.setConfig(o)}processChange(e,n,i){const{options:{parse:r,rename:s}}=this,o=s[e]??e,a=n.currentValue,c=r[e]??r[o];if(null==a)delete i[o];else if(c)try{i[o]=c(a)}catch(l){console.warn(`Failed to parse ${e} = ${a} (${typeof a})`,l.message)}else i[o]=a}}let sge=(()=>{class t{constructor(n,i,r={}){this.configState=n,this.cdr=i,this.options=r,this.initialized=!1,this.configManager=new rge(this.configState,this.options)}ngOnInit(){this._init=setTimeout(()=>this.initialize(),this.options.initialDelay??0)}ngOnDestroy(){this._init&&clearTimeout(this._init)}ngOnChanges(n){this.configManager.addChanges(n),this.initialized&&this.configManager.applyChanges()}initialize(){this._init=void 0,!this.initialized&&(this.configManager.applyChanges(),this.initialized=!0,this.cdr.markForCheck())}static#e=this.\u0275fac=function(i){!function sO(){throw new Error("invalid")}()};static#t=this.\u0275dir=Xe({type:t,features:[xr]})}return t})();const $T_dbOptions={dataSources:["https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/kpmp/data/rui_locations.jsonld","https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/sparc/data/rui_locations.jsonld"],hubmapDataService:"search-api",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"https://search.api.hubmapconsortium.org/v3/entities/search",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};window;const uge=[173,255,47,229.5];let gge=(()=>{class t{constructor(n,i){this.configState=n,this.api=i,this.data$=this.configState.getOption("data"),this.zoomToID$=this.configState.getOption("zoomToID").pipe(se(r=>`http://purl.org/ccf/1.5/entity/${r}`)),this.highlightID$=this.configState.getOption("highlightID").pipe(se(r=>`http://purl.org/ccf/1.5/entity/${r}`)),this.referenceOrgans$=this.api.referenceOrgans({}),this.scene$=Do([this.data$,this.referenceOrgans$]).pipe(hn(([r,s])=>this.chooseScene(r,s))),this.organs$=this.configState.getOption("data").pipe(se(r=>this.selectOrgans(r)),dr(1)),this.filteredOrgans$=Do([this.organs$,this.referenceOrgans$]).pipe(se(([r,s])=>this.getNeededReferenceOrgans(s,r)),dr(1)),this.filteredScene$=Do([this.scene$,this.organs$,this.referenceOrgans$]).pipe(se(([r,s,o])=>this.filterSceneNodes(r,s,o)),function hge(t,e){const n=t.pipe(Sa(""));return i=>Do([i,n]).pipe(se(([r,s])=>r.map(o=>function dge(t,e,n){return t.entityId!==e?t:{...t,color:n}}(o,s,e))))}(this.highlightID$,uge),function pge(t){const e=t.pipe(Sa(""));return n=>Do([n,e]).pipe(se(([i,r])=>i.map(s=>function fge(t,e){return t.entityId!==e?t:{...t,zoomToOnLoad:!0}}(s,r))))}(this.zoomToID$),dr(1))}chooseScene(n,i){const r=n?.map(this.getPlacementTarget)??[];if(new Set(r).size>1)return this.api.scene({});if(i){const o=i.find(a=>a["@id"]===r[0]);if(o)return this.api.referenceOrganScene({organIri:o.representation_of??"",ontologyTerms:[o.reference_organ??""],sex:o.sex})}return ne([])}selectOrgans(n){return new Set(n?.map(this.getPlacementTarget))}filterSceneNodes(n,i,r){const s=this.getNeededReferenceOrgans(r,i),o=this.getNeededSkins(s),a=new Set([...i,...o]);return n.filter(c=>!c.reference_organ||a.has(c.reference_organ))}getNeededReferenceOrgans(n,i){return n.filter(r=>i.has(r.reference_organ??""))}getNeededSkins(n){if(1===n.length)return[];const i=new Set;return n.forEach(r=>{"Female"===r.sex?i.add("http://purl.org/ccf/latest/ccf.owl#VHFSkin"):"Male"===r.sex&&i.add("http://purl.org/ccf/latest/ccf.owl#VHMSkin")}),[...i]}getPlacementTarget(n){return n["http://purl.org/ccf/latest/ccf-entity.owl#has_spatial_entity"]?.placement.target}static#e=this.\u0275fac=function(i){return new(i||t)(D(xa),D(fT))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function ip(t){return(ip="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function E(t,e,n){return(e=function _ge(t){var e=function mge(t,e){if("object"!=ip(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=ip(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ip(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xj(t){if(typeof window<"u"&&"object"==typeof window.process&&"renderer"===window.process.type||typeof process<"u"&&"object"==typeof process.versions&&process.versions.electron)return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function $s(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||xj()}const Ij=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";$s();class vge{constructor(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";E(this,"storage",void 0),E(this,"id",void 0),E(this,"config",void 0),this.storage=function yge(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function qT(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const s=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let ov;function Mj(t){return"string"==typeof t?ov[t.toUpperCase()]||ov.WHITE:t}function av(t,e){if(!t)throw new Error(e||"Assertion failed")}!function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(ov||(ov={}));const La={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:"object"==typeof process&&process},cv=La.window||La.self||La.global,rp=La.process||{};function Qu(){let t;var e,n;if($s&&"performance"in cv)t=null==cv||null===(e=cv.performance)||void 0===e||null===(n=e.now)||void 0===n?void 0:n.call(e);else if("hrtime"in rp){var i;const r=null==rp||null===(i=rp.hrtime)||void 0===i?void 0:i.call(rp);t=1e3*r[0]+r[1]/1e6}else t=Date.now();return t}const ed={debug:$s&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Sge={enabled:!0,level:0};function Br(){}const Dj={},Rj={once:!0};class sp{constructor(){let{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};E(this,"id",void 0),E(this,"VERSION",Ij),E(this,"_startTs",Qu()),E(this,"_deltaTs",Qu()),E(this,"_storage",void 0),E(this,"userData",{}),E(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new vge("__probe-".concat(this.id,"__"),Sge),this.timeStamp("".concat(this.id," started")),function Tge(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const r of i)"function"==typeof t[r]&&(e.find(s=>r===s)||(t[r]=t[r].bind(t)))}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Qu()-this._startTs).toPrecision(10))}getDelta(){return Number((Qu()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){return this._storage.setConfiguration({enabled:!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){av(e,n)}warn(e){return this._getLogFunction(0,e,ed.warn,arguments,Rj)}error(e){return this._getLogFunction(0,e,ed.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,ed.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,ed.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];return this._getLogFunction(e,n,ed.debug||ed.info,arguments,Rj)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||Br,i&&[i],{tag:Dge(n)}):Br}image(e){let{logLevel:n,priority:i,image:r,message:s="",scale:o=1}=e;return this._shouldLog(n||i)?$s?function Mge(t){let{image:e,message:n="",scale:i=1}=t;if("string"==typeof e){const s=new Image;return s.onload=()=>{const o=qT(s,n,i);console.log(...o)},s.src=e,Br}const r=e.nodeName||"";if("img"===r.toLowerCase())return console.log(...qT(e,n,i)),Br;if("canvas"===r.toLowerCase()){const s=new Image;return s.onload=()=>console.log(...qT(s,n,i)),s.src=e.toDataURL(),Br}return Br}({image:r,message:s,scale:o}):function Ige(t){let{message:n="",scale:i=1}=t;return console.warn("removed"),Br}({image:r,message:s,scale:o}):Br}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Br)}group(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const r=Pj({logLevel:e,message:n,opts:i}),{collapsed:s}=i;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){return this.group(e,n,Object.assign({},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Br)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Oj(e)}_getLogFunction(e,n,i,r,s){if(this._shouldLog(e)){s=Pj({logLevel:e,message:n,args:r,opts:s}),av(i=i||s.method),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Qu();const o=s.tag||s.message;if(s.once){if(Dj[o])return Br;Dj[o]=Qu()}return n=function xge(t,e,n){if("string"==typeof e){const i=n.time?function Ege(t){const n=Math.max((arguments.length>1&&void 0!==arguments[1]?arguments[1]:8)-t.length,0);return"".concat(" ".repeat(n)).concat(t)}(function bge(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}(n.total)):"";e=function Cge(t,e,n){return!$s&&"string"==typeof t&&(e&&(e=Mj(e),t="\x1b[".concat(e,"m").concat(t,"\x1b[39m")),n&&(e=Mj(n),t="\x1b[".concat(n+10,"m").concat(t,"\x1b[49m"))),t}(e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),n.color,n.background)}return e}(this.id,s.message,s),i.bind(console,n,...s.args)}return Br}}function Oj(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return av(Number.isFinite(e)&&e>=0),e}function Pj(t){const{logLevel:e,message:n}=t;t.logLevel=Oj(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":void 0!==n&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e)}"function"==typeof t.message&&(t.message=t.message());const r=typeof t.message;return av("string"===r||"object"===r),Object.assign(t,{args:i},t.opts)}function Dge(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}E(sp,"VERSION",Ij);const $e=new sp({id:"deck"}),op=new class Rge{constructor(e={}){E(this,"_pool",[]),E(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:i=1,type:r,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:c}){const l=r||e&&e.constructor||Float32Array,u=n*i+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new l(e.buffer,0,u)}let d=1/0;c&&(d=c*i+s);const h=this._allocate(l,u,a,d);return e&&o?h.set(e):a||h.fill(0,0,4),this._release(e),h}release(e){this._release(e)}_allocate(e,n,i,r){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>r&&(s=r);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,c=o.findIndex(l=>l.byteLength>=a);if(c>=0){const l=new e(o.splice(c,1)[0],0,s);return i&&l.fill(0),l}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:i}=e,{byteLength:r}=i,s=n.findIndex(o=>o.byteLength>=r);s<0?n.push(i):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,i),n.length>this.opts.poolSize&&n.shift()}};function Nj(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}class Lj extends ZC{get x(){return this[0]}set x(e){this[0]=Rt(e)}get y(){return this[1]}set y(e){this[1]=Rt(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];n+=r*r}return Rt(n)}dot(e){let n=0;for(let i=0;i<this.ELEMENTS;++i)n+=this[i]*e[i];return Rt(n)}normalize(){const e=this.magnitude();if(0!==e)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=n[i];return this.check()}divide(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=n[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Nj(e>=0&&e<this.ELEMENTS,"index is out of range"),Rt(this[e])}setComponent(e,n){return Nj(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}const XT=[0,0,0];let lv;class hi extends Lj{static get ZERO(){return lv||(lv=new hi(0,0,0),Object.freeze(lv)),lv}constructor(e=0,n=0,i=0){super(-0,-0,-0),1===arguments.length&&Oo(e)?this.copy(e):(sn.debug&&(Rt(e),Rt(n),Rt(i)),this[0]=e,this[1]=n,this[2]=i)}set(e,n,i){return this[0]=e,this[1]=n,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return sn.debug&&(Rt(e.x),Rt(e.y),Rt(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Rt(e)}angle(e){return function Nle(t,e){var n=t[0],i=t[1],r=t[2],s=e[0],o=e[1],a=e[2],u=Math.sqrt(n*n+i*i+r*r)*Math.sqrt(s*s+o*o+a*a),d=u&&rU(t,e)/u;return Math.acos(Math.min(Math.max(d,-1),1))}(this,e)}cross(e){return by(this,this,e),this.check()}rotateX({radians:e,origin:n=XT}){return function Rle(t,e,n,i){var r=[],s=[];r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2]}(this,this,n,e),this.check()}rotateY({radians:e,origin:n=XT}){return function Ole(t,e,n,i){var r=[],s=[];r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2]}(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=XT}){return function Ple(t,e,n,i){var r=[],s=[];r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2]}(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return tT(this,this,e),this.check()}transformAsVector(e){return J3(this,this,e),this.check()}transformByMatrix3(e){return function Dle(t,e,n){var i=e[0],r=e[1],s=e[2];t[0]=i*n[0]+r*n[3]+s*n[6],t[1]=i*n[1]+r*n[4]+s*n[7],t[2]=i*n[2]+r*n[5]+s*n[8]}(this,this,e),this.check()}transformByMatrix2(e){return function ole(t,e,n){const i=e[0],r=e[1];t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return sU(this,this,e),this.check()}}const Fj=new hi;function td(t,e,n,i){Fj.set(t,e,n);const r=Fj.len();return{distance:i/r,normal:new hi(-t/r,-e/r,-n/r)}}function Lge(t){return t-Math.fround(t)}let cp;function KT(t,e){const{size:n=1,startIndex:i=0}=e,r=void 0!==e.endIndex?e.endIndex:t.length,s=(r-i)/n;cp=op.allocate(cp,s,{type:Float32Array,size:2*n});let o=i,a=0;for(;o<r;){for(let c=0;c<n;c++){const l=t[o++];cp[a+c]=l,cp[a+c+n]=Lge(l)}a+=2*n}return cp.subarray(0,s*n*2)}function nd(t,e){const n=zf([],e,t);return oU(n,n,1/n[3]),n}function Bj(t,e){const n=t%e;return n<0?e+n:n}function JT(t,e,n){return t<e?e:t>n?n:t}const ZT=Math.log2||function Bge(t){return Math.log(t)*Math.LOG2E};function Lo(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const us=Math.PI,kj=us/4,kr=us/180,QT=180/us,id=512,uv=4003e4,dv=85.051129,kge=1.5;function hv(t){const[e,n]=t;return Lo(Number.isFinite(e)),Lo(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude"),[id*(e*kr+us)/(2*us),id*(us+Math.log(Math.tan(kj+n*kr*.5)))/(2*us)]}function rd(t){const[e,n]=t,i=e/id*(2*us)-us,r=2*(Math.atan(Math.exp(n/id*(2*us)-us))-kj);return[i*QT,r*QT]}function eS(t){const{latitude:e,longitude:n,highPrecision:i=!1}=t;Lo(Number.isFinite(e)&&Number.isFinite(n));const r=id,s=Math.cos(e*kr),o=r/360,a=o/s,c=r/uv/s,l={unitsPerMeter:[c,c,c],metersPerUnit:[1/c,1/c,1/c],unitsPerDegree:[o,a,c],degreesPerUnit:[1/o,1/a,1/c]};if(i){const u=kr*Math.tan(e*kr)/s,h=r/uv*u,f=h/a*c;l.unitsPerDegree2=[0,o*u/2,h],l.unitsPerMeter2=[f,0,f]}return l}function Uj(t,e){const[n,i,r]=t,[s,o,a]=e,{unitsPerMeter:c,unitsPerMeter2:l}=eS({longitude:n,latitude:i,highPrecision:!0}),u=hv(t);u[0]+=s*(c[0]+l[0]*o),u[1]+=o*(c[1]+l[1]*o);const d=rd(u),h=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[d[0],d[1],h]:d}function fv(t){return 2*Math.atan(.5/t)*QT}function tS(t){return.5/Math.tan(.5*t*kr)}function jj(t,e){const[n,i,r=0]=t;return Lo(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(r)),nd(e,[n,i,r,1])}function lp(t,e,n=0){const[i,r,s]=t;if(Lo(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return nd(e,[i,r,s,1]);const o=nd(e,[i,r,0,1]),a=nd(e,[i,r,1,1]),c=o[2],l=a[2];return tU([],o,a,c===l?0:((n||0)-c)/(l-c))}function Hj(t){const{width:e,height:n,bounds:i,minExtent:r=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,c],[l,u]]=i,d=function Hge(t=0){return"number"==typeof t?{top:t,bottom:t,left:t,right:t}:(Lo(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}(t.padding),h=hv([a,JT(u,-dv,dv)]),f=hv([l,JT(c,-dv,dv)]),p=[Math.max(Math.abs(f[0]-h[0]),r),Math.max(Math.abs(f[1]-h[1]),r)],g=[e-d.left-d.right-2*Math.abs(o[0]),n-d.top-d.bottom-2*Math.abs(o[1])];Lo(g[0]>0&&g[1]>0);const m=g[0]/p[0],y=g[1]/p[1],C=rd([(f[0]+h[0])/2+(d.right-d.left)/2/m,(f[1]+h[1])/2+(d.top-d.bottom)/2/y]),S=Math.min(s,ZT(Math.abs(Math.min(m,y))));return Lo(Number.isFinite(S)),{longitude:C[0],latitude:C[1],zoom:S}}const zj=Math.PI/180;function Gj(t,e,n){const{pixelUnprojectionMatrix:i}=t,r=nd(i,[e,0,1,1]),s=nd(i,[e,t.height,1,1]),l=rd(tU([],r,s,(n*t.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2])));return l.push(n),l}const Qe={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Qe,"IDENTITY",{get:()=>($e.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const qs={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},pv={common:0,meters:1,pixels:2},Yj={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},$ge=Math.PI/180,qge=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Kj=[0,0,0],Xge={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class Fa{constructor(e={}){E(this,"id",void 0),E(this,"x",void 0),E(this,"y",void 0),E(this,"width",void 0),E(this,"height",void 0),E(this,"padding",void 0),E(this,"isGeospatial",void 0),E(this,"zoom",void 0),E(this,"focalDistance",void 0),E(this,"position",void 0),E(this,"modelMatrix",void 0),E(this,"distanceScales",void 0),E(this,"scale",void 0),E(this,"center",void 0),E(this,"cameraPosition",void 0),E(this,"projectionMatrix",void 0),E(this,"viewMatrix",void 0),E(this,"viewMatrixUncentered",void 0),E(this,"viewMatrixInverse",void 0),E(this,"viewProjectionMatrix",void 0),E(this,"pixelProjectionMatrix",void 0),E(this,"pixelUnprojectionMatrix",void 0),E(this,"resolution",void 0),E(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||Xge,this.focalDistance=e.focalDistance||1,this.position=e.position||Kj,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:i}=e;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?qs.WEB_MERCATOR:qs.WEB_MERCATOR_AUTO_OFFSET:qs.IDENTITY}equals(e){return e instanceof Fa&&(this===e||e.width===this.width&&e.height===this.height&&e.scale===this.scale&&$u(e.projectionMatrix,this.projectionMatrix)&&$u(e.viewMatrix,this.viewMatrix))}project(e,{topLeft:n=!0}={}){const r=jj(this.projectPosition(e),this.pixelProjectionMatrix),[s,o]=r,a=n?o:this.height-o;return 2===e.length?[s,a]:[s,a,r[2]]}unproject(e,{topLeft:n=!0,targetZ:i}={}){const[r,s,o]=e,l=lp([r,n?s:this.height-s,o],this.pixelUnprojectionMatrix,i&&i*this.distanceScales.unitsPerMeter[2]),[u,d,h]=this.unprojectPosition(l);return Number.isFinite(o)?[u,d,h]:Number.isFinite(i)?[u,d,i]:[u,d]}projectPosition(e){const[n,i]=this.projectFlat(e);return[n,i,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[n,i]=this.unprojectFlat(e);return[n,i,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){if(this.isGeospatial){const n=hv(e);return n[1]=Xn(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?rd(e):e}getBounds(e={}){const n={targetZ:e.z||0},i=this.unproject([0,0],n),r=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(i[0],r[0],s[0],o[0]),Math.min(i[1],r[1],s[1],o[1]),Math.max(i[0],r[0],s[0],o[0]),Math.max(i[1],r[1],s[1],o[1])]}getDistanceScales(e){return e?eS({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:i=1,height:r=1}){return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function Nge(t){return{left:td(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:td(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:td(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:td(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:td(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:td(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,i=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=function Vge(t){const{latitude:e}=t;Lo(Number.isFinite(e));const n=Math.cos(e*kr);return function Uge(t){return ZT(t)}(uv*n)-9}({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||eS({latitude:i,longitude:n}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:s,modelMatrix:o}=e;let a=Kj;if(s&&(a=o?new Le(o).transformAsVector(s,[]):s),this.isGeospatial){const c=this.projectPosition([n,i,0]);this.center=new hi(a).scale(this.distanceScales.unitsPerMeter).add(c)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=qge,projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:c=1e3,padding:l=null,focalDistance:u=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=(new Le).multiplyRight(n).translate(new hi(this.center).negate()),this.projectionMatrix=i||function Yge({width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:r,padding:s,near:o,far:a}){const c=t/e,l=n?(new Le).orthographic({fovy:i,aspect:c,focalDistance:r,near:o,far:a}):(new Le).perspective({fovy:i,aspect:c,near:o,far:a});if(s){const{left:u=0,right:d=0,top:h=0,bottom:f=0}=s,p=Xn((u+t-d)/2,0,t)-t/2,g=Xn((h+e-f)/2,0,e)-e/2;l[8]-=2*p/t,l[9]+=2*g/e}return l}({width:this.width,height:this.height,orthographic:r,fovyRadians:s||o*$ge,focalDistance:u,padding:l,near:a,far:c});const d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];zc(d,d,this.projectionMatrix),zc(d,d,this.viewMatrix),this.viewProjectionMatrix=d,this.viewMatrixInverse=QC([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=function Pge(t){return[t[12],t[13],t[14]]}(this.viewMatrixInverse);const h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];eT(h,h,[this.width/2,-this.height/2,1]),yy(h,h,[1,-1,0]),zc(f,h,this.viewProjectionMatrix),this.pixelProjectionMatrix=f,this.pixelUnprojectionMatrix=QC([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||$e.warn("Pixel project matrix not invertible")()}}E(Fa,"displayName","Viewport");const Kge=/([0-9]+\.?[0-9]*)(%|px)/;function Ba(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=Kge.exec(t);if(e&&e.length>=3){const n="%"===e[2],i=parseFloat(e[1]);return{position:n?i/100:i,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function ka(t,e){return t.relative?Math.round(t.position*e):t.position}function sd(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const n in t){const i=t[n],r=e[n];if(!(i===r||Array.isArray(i)&&Array.isArray(r)&&sd(i,r)))return!1}return!0}function Kn(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class iS{constructor(e){E(this,"id",void 0),E(this,"viewportInstance",void 0),E(this,"_x",void 0),E(this,"_y",void 0),E(this,"_width",void 0),E(this,"_height",void 0),E(this,"_padding",void 0),E(this,"props",void 0);const{id:n,x:i=0,y:r=0,width:s="100%",height:o="100%",padding:a=null,viewportInstance:c}=e||{};Kn(!c||c instanceof Fa),this.viewportInstance=c,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Ba(i),this._y=Ba(r),this._width=Ba(s),this._height=Ba(o),this._padding=a&&{left:Ba(a.left||0),right:Ba(a.right||0),top:Ba(a.top||0),bottom:Ba(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?!!e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):this.ViewportType===e.ViewportType&&sd(this.props,e.props))}makeViewport({width:e,height:n,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:n});return new this.ViewportType({...i,...this.props,...r})}getViewStateId(){const{viewState:e}=this.props;return"string"==typeof e?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const i in this.props.viewState)"id"!==i&&(n[i]=this.props.viewState[i]);return n}return e}getDimensions({width:e,height:n}){const i={x:ka(this._x,e),y:ka(this._y,n),width:ka(this._width,e),height:ka(this._height,n)};return this._padding&&(i.padding={left:ka(this._padding.left,e),top:ka(this._padding.top,n),right:ka(this._padding.right,e),bottom:ka(this._padding.bottom,n)}),i}get controller(){const e=this.props.controller;return e?!0===e?{type:this.ControllerType}:"function"==typeof e?{type:e}:{type:this.ControllerType,...e}:null}}const Jge=(new Le).lookAt({eye:[0,0,1]});function Zge({width:t,height:e,near:n,far:i,padding:r}){let s=-t/2,o=t/2,a=-e/2,c=e/2;if(r){const{left:l=0,right:u=0,top:d=0,bottom:h=0}=r,f=Xn((l+t-u)/2,0,t)-t/2,p=Xn((d+e-h)/2,0,e)-e/2;s-=f,o-=f,a+=p,c+=p}return(new Le).ortho({left:s,right:o,bottom:a,top:c,near:n,far:i})}class Qge extends Fa{constructor(e){const{width:n,height:i,near:r=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],padding:c=null,flipY:l=!0}=e,u=Array.isArray(o)?o[0]:o,d=Array.isArray(o)?o[1]:o,h=Math.min(u,d),f=Math.pow(2,h);let p;if(u!==d){const g=Math.pow(2,u),m=Math.pow(2,d);p={unitsPerMeter:[g/f,m/f,1],metersPerUnit:[f/g,f/m,1]}}super({...e,longitude:void 0,position:a,viewMatrix:Jge.clone().scale([f,f*(l?-1:1),f]),projectionMatrix:Zge({width:n||1,height:i||1,padding:c,near:r,far:s}),zoom:h,distanceScales:p})}projectFlat([e,n]){const{unitsPerMeter:i}=this.distanceScales;return[e*i[0],n*i[1]]}unprojectFlat([e,n]){const{metersPerUnit:i}=this.distanceScales;return[e*i[0],n*i[1]]}panByPosition(e,n){const i=lp(n,this.pixelUnprojectionMatrix),s=vy([],this.projectFlat(e),eU([],i)),o=vy([],this.center,s);return{target:this.unprojectFlat(o)}}}class dp{constructor(e){E(this,"_inProgress",void 0),E(this,"_handle",void 0),E(this,"_timeline",void 0),E(this,"time",void 0),E(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,i;this.cancel(),this.settings=e,this._inProgress=!0,null===(n=(i=this.settings).onStart)||void 0===n||n.call(i,this)}end(){var e,n;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(e=(n=this.settings).onEnd)||void 0===e||e.call(n,this))}cancel(){var e,n;this._inProgress&&(null===(e=(n=this.settings).onInterrupt)||void 0===e||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var e,n;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:i,settings:r}=this;this._handle=i.addChannel({delay:i.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(e=(n=this.settings).onUpdate)||void 0===e||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Jj=()=>{},eme=t=>t;class nme{constructor(e){E(this,"getControllerState",void 0),E(this,"props",void 0),E(this,"propsInTransition",void 0),E(this,"transition",void 0),E(this,"onViewStateChange",void 0),E(this,"onStateChange",void 0),E(this,"_onTransitionUpdate",n=>{const{time:i,settings:{interpolator:r,startProps:s,endProps:o,duration:a,easing:c}}=n,l=c(i/a),u=r.interpolateProps(s,o,l);this.propsInTransition=this.getControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new dp(e.timeline),this.onViewStateChange=e.onViewStateChange||Jj,this.onStateChange=e.onStateChange||Jj}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const i=this.props;if(this.props=e,!i||this._shouldIgnoreViewportChange(i,e))return!1;if(this._isTransitionEnabled(e)){let r=i;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;r={...i,...2===s?o:this.propsInTransition||i}}this._triggerTransition(r,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:i}=e;return(n>0||"auto"===n)&&!!i}_isUpdateDueToCurrentTransition(e){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(n):!this._isTransitionEnabled(n)||n.transitionInterpolator.arePropsEqual(e,n)}_triggerTransition(e,n){const i=this.getControllerState(e),r=this.getControllerState(n).shortestPathFrom(i),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(0===o)return;const a=s.initializeProps(e,r);this.propsInTransition={};const c={duration:o,easing:n.transitionEasing||eme,interpolator:s,interruption:n.transitionInterruption||1,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(c),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(n)}}}class ime{constructor(e){E(this,"_propsToCompare",void 0),E(this,"_propsToExtract",void 0),E(this,"_requiredProps",void 0);const{compare:n,extract:i,required:r}=e;this._propsToCompare=n,this._propsToExtract=i||n,this._requiredProps=r}arePropsEqual(e,n){for(const i of this._propsToCompare)if(!(i in e)||!(i in n)||!$u(e[i],n[i]))return!1;return!0}initializeProps(e,n){const i={},r={};for(const s of this._propsToExtract)(s in e||s in n)&&(i[s]=e[s],r[s]=n[s]);return this._checkRequiredProps(i),this._checkRequiredProps(r),{start:i,end:r}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const i=e[n];Kn(Number.isFinite(i)||Array.isArray(i),"".concat(n," is required for transition"))})}}const rme=["longitude","latitude","zoom","bearing","pitch"],sme=["longitude","latitude","zoom"];class gv extends ime{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,i=Array.isArray(e)?{}:e;i.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:rme,required:sme},super(i.transitionProps),E(this,"opts",void 0),this.opts=i}initializeProps(e,n){const i=super.initializeProps(e,n),{makeViewport:r,around:s}=this.opts;if(r&&s){const o=r(e),a=r(n),c=o.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(c),aroundPosition:c,width:n.width,height:n.height})}return i}interpolateProps(e,n,i){const r={};for(const s of this._propsToExtract)r[s]=my(e[s]||0,n[s]||0,i);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...r});Object.assign(r,s.panByPosition(n.aroundPosition,my(e.around,n.around,i)))}return r}}const Ua={transitionDuration:0},mv=t=>1-(1-t)*(1-t),od_WHEEL=["wheel"],od_PAN=["panstart","panmove","panend"],od_PINCH=["pinchstart","pinchmove","pinchend"],od_TRIPLE_PAN=["tripanstart","tripanmove","tripanend"],od_DOUBLE_TAP=["doubletap"],od_KEYBOARD=["keydown"],el={};class sS{constructor(e){E(this,"props",void 0),E(this,"state",{}),E(this,"transitionManager",void 0),E(this,"eventManager",void 0),E(this,"onViewStateChange",void 0),E(this,"onStateChange",void 0),E(this,"makeViewport",void 0),E(this,"_controllerState",void 0),E(this,"_events",{}),E(this,"_interactionState",{isDragging:!1}),E(this,"_customEvents",[]),E(this,"_eventStartBlocked",null),E(this,"_panMove",!1),E(this,"invertPan",!1),E(this,"dragMode","rotate"),E(this,"inertia",0),E(this,"scrollZoom",!0),E(this,"dragPan",!0),E(this,"dragRotate",!0),E(this,"doubleClickZoom",!0),E(this,"touchZoom",!0),E(this,"touchRotate",!1),E(this,"keyboard",!0),this.transitionManager=new nme({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;null===(e=this.eventManager)||void 0===e||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return!n&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!n&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!n&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:i}=this.props,{offsetCenter:r}=e;return[r.x-n,r.y-i]}isPointInBounds(e,n){const{width:i,height:r}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:!0===n?300:0;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:c=!1,keyboard:l=!0}=e,u=!!this.onViewStateChange;this.toggleEvents(od_WHEEL,u&&i),this.toggleEvents(od_PAN,u&&(r||s)),this.toggleEvents(od_PINCH,u&&(a||c)),this.toggleEvents(od_TRIPLE_PAN,u&&c),this.toggleEvents(od_DOUBLE_TAP,u&&o),this.toggleEvents(od_KEYBOARD,u&&l),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=c,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(i=>{this._events[i]!==n&&(this._events[i]=n,n?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,n=null,i={}){const r={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(i),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:n});return this._panMove=i,this.updateViewport(r,Ua,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),i=this.controllerState.pan({pos:n});return this.updateViewport(i,Ua,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const i=this.getCenter(e),s=this.controllerState.pan({pos:[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2]}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:mv},{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),i=this.controllerState.rotate({pos:n});return this.updateViewport(i,Ua,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const i=this.getCenter(e),s=this.controllerState.rotate({pos:[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2]}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:mv},{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const{speed:i=.01,smooth:r=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*i)));s<0&&0!==o&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.rotateStart({pos:n});return this.updateViewport(i,Ua,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const i=this.controllerState.rotate({pos:n});return this.updateViewport(i,Ua,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:mv},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return el._startPinchRotation=e.rotation,el._lastPinchEvent=e,this.updateViewport(i,Ua,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);n=n.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;n=n.rotate({deltaAngleX:el._startPinchRotation-i})}return this.updateViewport(n,Ua,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),el._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:i}=el;if(this.touchZoom&&n&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),c=Math.pow(2,o+a*n/2);s=s.zoom({pos:r,scale:c}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:r}),transitionDuration:n,transitionEasing:mv},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return el._startPinchRotation=null,el._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:n,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:o}=!0===this.keyboard?{}:this.keyboard,{controllerState:a}=this;let c;const l={};switch(e.srcEvent.code){case"Minus":c=n?a.zoomOut(i).zoomOut(i):a.zoomOut(i),l.isZooming=!0;break;case"Equal":c=n?a.zoomIn(i).zoomIn(i):a.zoomIn(i),l.isZooming=!0;break;case"ArrowLeft":n?(c=a.rotateLeft(s),l.isRotating=!0):(c=a.moveLeft(r),l.isPanning=!0);break;case"ArrowRight":n?(c=a.rotateRight(s),l.isRotating=!0):(c=a.moveRight(r),l.isPanning=!0);break;case"ArrowUp":n?(c=a.rotateUp(o),l.isRotating=!0):(c=a.moveUp(r),l.isPanning=!0);break;case"ArrowDown":n?(c=a.rotateDown(o),l.isRotating=!0):(c=a.moveDown(r),l.isPanning=!0);break;default:return!1}return this.updateViewport(c,this._getTransitionProps(),l),!0}_getTransitionProps(e){const{transition:n}=this;return n&&n.transitionInterpolator?e?{...n,transitionInterpolator:new gv({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n:Ua}}class Zj{constructor(e,n){E(this,"_viewportProps",void 0),E(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}class Qj extends Zj{constructor(e){const{width:n,height:i,rotationX:r=0,rotationOrbit:s=0,target:o=[0,0,0],zoom:a=0,minRotationX:c=-90,maxRotationX:l=90,minZoom:u=-1/0,maxZoom:d=1/0,startPanPosition:h,startRotatePos:f,startRotationX:p,startRotationOrbit:g,startZoomPosition:m,startZoom:y}=e;super({width:n,height:i,rotationX:r,rotationOrbit:s,target:o,zoom:a,minRotationX:c,maxRotationX:l,minZoom:u,maxZoom:d},{startPanPosition:h,startRotatePos:f,startRotationX:p,startRotationOrbit:g,startZoomPosition:m,startZoom:y}),E(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:n}){const i=this.getState().startPanPosition||n;if(!i)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:i=0}){const{startRotatePos:r,startRotationX:s,startRotationOrbit:o}=this.getState(),{width:a,height:c}=this.getViewportProps();if(!r||void 0===s||void 0===o)return this;let l;if(e){let u=(e[0]-r[0])/a;(s<-90||s>90)&&(u*=-1),l={rotationX:s+(e[1]-r[1])/c*180,rotationOrbit:o+180*u}}else l={rotationX:s+i,rotationOrbit:o+n};return this._getUpdatedState(l)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const n=e.getViewportProps(),i={...this.getViewportProps()},{rotationOrbit:r}=i;return Math.abs(r-n.rotationOrbit)>180&&(i.rotationOrbit=r<0?r+360:r-360),i}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:i}){let{startZoom:r,startZoomPosition:s}=this.getState();if(s||(r=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const o=this._calculateNewZoom({scale:i,startZoom:r}),a=this.makeViewport({...this.getViewportProps(),zoom:o});return this._getUpdatedState({zoom:o,...a.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:i,minZoom:r}=this.getViewportProps();return void 0===n&&(n=this.getViewportProps().zoom),Xn(n+Math.log2(e),r,i)}_panFromCenter(e){const{width:n,height:i,target:r}=this.getViewportProps();return this.pan({startPosition:r,pos:[n/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){const{maxZoom:n,minZoom:i,zoom:r,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=Array.isArray(r)?[Xn(r[0],i,n),Xn(r[1],i,n)]:Xn(r,i,n),e.rotationX=Xn(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=function Oge(t,e){const n=t%e;return n<0?e+n:n}(a+180,360)-180),e}}class ame extends sS{constructor(...e){super(...e),E(this,"ControllerState",Qj),E(this,"transition",{transitionDuration:300,transitionInterpolator:new gv({transitionProps:{compare:["target","zoom","rotationX","rotationOrbit"],required:["target","zoom"]}})})}}class cme extends Qj{constructor(e){super(e),E(this,"zoomAxis",void 0),this.zoomAxis=e.zoomAxis||"all"}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:i,minZoom:r}=this.getViewportProps();void 0===n&&(n=this.getViewportProps().zoom);let s=Math.log2(e);if(Array.isArray(n)){let[o,a]=n;switch(this.zoomAxis){case"X":o=Xn(o+s,r,i);break;case"Y":a=Xn(a+s,r,i);break;default:let c=Math.min(o+s,a+s);c<r&&(s+=r-c),c=Math.max(o+s,a+s),c>i&&(s+=i-c),o+=s,a+=s}return[o,a]}return Xn(n+s,r,i)}}class lme extends sS{constructor(...e){super(...e),E(this,"ControllerState",cme),E(this,"transition",{transitionDuration:300,transitionInterpolator:new gv(["target","zoom"])}),E(this,"dragMode","pan")}_onPanRotate(){return!1}}class oS extends iS{get ViewportType(){return Qge}get ControllerType(){return lme}}E(oS,"displayName","OrthographicView");const aS=Math.PI/180;function ume({height:t,focalDistance:e,orbitAxis:n,rotationX:i,rotationOrbit:r,zoom:s}){const o="Z"===n?[0,0,1]:[0,1,0],a="Z"===n?[0,-e,0]:[0,0,e],c=(new Le).lookAt({eye:a,up:o});c.rotateX(i*aS),"Z"===n?c.rotateZ(r*aS):c.rotateY(r*aS);const l=Math.pow(2,s)/t;return c.scale(l),c}class dme extends Fa{constructor(e){const{height:n,projectionMatrix:i,fovy:r=50,orbitAxis:s="Z",target:o=[0,0,0],rotationX:a=0,rotationOrbit:c=0,zoom:l=0}=e,u=i?i[5]/2:tS(r);super({...e,longitude:void 0,viewMatrix:ume({height:n||1,focalDistance:u,orbitAxis:s,rotationX:a,rotationOrbit:c,zoom:l}),fovy:r,focalDistance:u,position:o,zoom:l}),E(this,"projectedCenter",void 0),this.projectedCenter=this.project(this.center)}unproject(e,{topLeft:n=!0}={}){const[i,r,s=this.projectedCenter[2]]=e,o=n?r:this.height-r,[a,c,l]=lp([i,o,s],this.pixelUnprojectionMatrix);return[a,c,l]}panByPosition(e,n){const i=this.project(e);return{target:this.unproject([this.width/2+i[0]-n[0],this.height/2+i[1]-n[1],this.projectedCenter[2]])}}}class eH extends iS{constructor(e={}){super(e),this.props.orbitAxis=e.orbitAxis||"Z"}get ViewportType(){return dme}get ControllerType(){return ame}}E(eH,"displayName","OrbitView");const hp="vs",cS="fs";function gr(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const lS={number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},array:{validate:(t,e)=>Array.isArray(t)||ArrayBuffer.isView(t)}};function fme(t){let e=tH(t);return"object"===e?t?"type"in t?Object.assign({},t,lS[t.type]):"value"in t?(e=tH(t.value),Object.assign({type:e},t,lS[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},lS[e])}function tH(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}class uS{constructor(e){let{name:n,vs:i,fs:r,dependencies:s=[],uniforms:o,getUniforms:a,deprecations:c=[],defines:l={},inject:u={},vertexShader:d,fragmentShader:h}=e;gr("string"==typeof n),this.name=n,this.vs=i||d,this.fs=r||h,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(c),this.defines=l,this.injections=function mme(t){const e={vs:{},fs:{}};for(const n in t){let i=t[n];"string"==typeof i&&(i={order:0,injection:i}),e[n.slice(0,2)][n]=i}return e}(u),o&&(this.uniforms=function hme(t){const e={};for(const n in t){const r=fme(t[n]);e[n]=r}return e}(o))}getModuleSource(e){let n;switch(e){case"vs":n=this.vs||"";break;case"fs":n=this.fs||"";break;default:gr(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(n,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?n.deprecated(i.old,i.new)():n.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{n.regex="function"===n.type?new RegExp("\\b".concat(n.old,"\\(")):new RegExp("".concat(n.type," ").concat(n.old,";"))}),e}_defaultGetUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&gr(s.validate(e[r],s),"".concat(this.name,": invalid ").concat(r)),n[r]=e[r]):n[r]=s.value}return n}}function _me(t){return function nH(t){const e={},n={};return dS({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((i,r)=>n[r]-n[i]).map(i=>e[i])}(iH(t))}function dS(t){let{modules:e,level:n,moduleMap:i,moduleDepth:r}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)i[s.name]=s,(void 0===r[s.name]||r[s.name]<n)&&(r[s.name]=n);for(const s of e)s.dependencies&&dS({modules:s.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}function iH(t,e){return t.map(n=>(n instanceof uS||(gr("string"!=typeof n,"Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),gr(n.name,"shader module has no name"),(n=new uS(n)).dependencies=iH(n.dependencies)),n))}const vme=7936,bme=7937,Eme=7938,wme=35724,hS={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},tl={};function Tme(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}Object.keys(hS).forEach(t=>{tl[t]=t});const fS={};function rH(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=hS[e];if(gr(i,e),!function yme(){const e=typeof window<"u"&&window.navigator||{},n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).userAgent||e.userAgent||"",i=-1!==n.indexOf("MSIE "),r=-1!==n.indexOf("Trident/");return i||r}(n))return!0;if(e in fS)return fS[e];const s=n.behavior||"enable",o="#extension GL_".concat(i[0]," : ").concat(s,"\nvoid main(void) {}"),a=t.createShader(35633);t.shaderSource(a,o),t.compileShader(a);const c=t.getShaderParameter(a,35713);return t.deleteShader(a),fS[e]=c,c}function _v(t,e){return(e=Array.isArray(e)?e:[e]).every(n=>function Sme(t,e){const n=hS[e];gr(n,e);const i=function Ame(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext||!(!t||2!==t._version)}(t)&&n[1]||n[0],r="string"==typeof i?!!t.getExtension(i):i;return gr(!1===r||!0===r),r}(t,n))}const Rme={[hp]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[cS]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},yv="__LUMA_INJECT_DECLARATIONS__",sH=/void\s+main\s*\([^)]*\)\s*\{\n?/,oH=/}\n?[^{}]*$/,pS=[];function aH(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=e===hp;for(const s in n){const o=n[s];o.sort((c,l)=>c.order-l.order),pS.length=o.length;for(let c=0,l=o.length;c<l;++c)pS[c]=o[c].injection;const a="".concat(pS.join("\n"),"\n");switch(s){case"vs:#decl":r&&(t=t.replace(yv,a));break;case"vs:#main-start":r&&(t=t.replace(sH,c=>c+a));break;case"vs:#main-end":r&&(t=t.replace(oH,c=>a+c));break;case"fs:#decl":r||(t=t.replace(yv,a));break;case"fs:#main-start":r||(t=t.replace(sH,c=>c+a));break;case"fs:#main-end":r||(t=t.replace(oH,c=>a+c));break;default:t=t.replace(s,c=>c+a)}}return t=t.replace(yv,""),i&&(t=t.replace(/\}\s*$/,s=>s+Rme[e])),t}function gS(t){const e={};return gr(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const i in n)e[i]=e[i]?"".concat(e[i],"\n").concat(n[i]):n[i]}),e}function ad(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const cH=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Ome=[...cH,[ad("attribute"),"in $1"],[ad("varying"),"out $1"]],Pme=[...cH,[ad("varying"),"in $1"]],lH=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],Nme=[...lH,[ad("in"),"attribute $1"],[ad("out"),"varying $1"]],Lme=[...lH,[ad("in"),"varying $1"]],mS="gl_FragColor",_S=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Fme=/void\s+main\s*\([^)]*\)\s*\{\n?/;function vv(t,e){for(const[n,i]of e)t=t.replace(n,i);return t}const Vme="\n\n".concat(yv,"\n\n"),uH={[hp]:"vertex",[cS]:"fragment"};function dH(t,e){let{id:n,source:i,type:r,modules:s,defines:o={},hookFunctions:a=[],inject:c={},transpileToGLSL100:l=!1,prologue:u=!0,log:d}=e;gr("string"==typeof i,"shader source must be a string");const h=r===hp,f=i.split("\n");let p=100,g="",m=i;0===f[0].indexOf("#version ")?(p=300,g=f[0],m=f.slice(1).join("\n")):g="#version ".concat(p);const y={};s.forEach(M=>{Object.assign(y,M.getDefines())}),Object.assign(y,o);let v=u?"".concat(g,"\n").concat(function Wme(t){let{id:e,source:n,type:i}=t;return e&&"string"==typeof e&&-1===n.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(e,"_").concat(uH[i],"\n\n"):""}({id:n,source:i,type:r}),"\n").concat(function Gme(t){let{type:e}=t;return"\n#define SHADER_TYPE_".concat(uH[e].toUpperCase(),"\n")}({type:r}),"\n").concat(function xme(t){switch(function Cme(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||vme),i=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||bme);return{gpuVendor:Tme(n,i),vendor:n,renderer:i,version:t.getParameter(Eme),shadingLanguageVersion:t.getParameter(wme)}}(t).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(t),"\n").concat(function Ime(t){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return _v(t,tl.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),_v(t,tl.GLSL_DERIVATIVES)&&rH(t,tl.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),_v(t,tl.GLSL_FRAG_DATA)&&rH(t,tl.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),_v(t,tl.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(t),"\n").concat(function $me(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=0,n="";for(const i in t){0===e&&(n+="\n// APPLICATION DEFINES\n"),e++;const r=t[i];(r||Number.isFinite(r))&&(n+="#define ".concat(i.toUpperCase()," ").concat(t[i],"\n"))}return 0===e&&(n+="\n"),n}(y),"\n").concat(h?"":"precision highp float;\n\n","\n"):"".concat(g,"\n");const _=function Xme(t){const e={vs:{},fs:{}};return t.forEach(n=>{let i;"string"!=typeof n?(i=n,n=i.hook):i={},n=n.trim();const[r,s]=n.split(":"),o=n.replace(/\(.+/,"");e[r][o]=Object.assign(i,{signature:s})}),e}(a),w={},C={},S={};for(const M in c){const x="string"==typeof c[M]?{injection:c[M],order:0}:c[M],N=M.match(/^(v|f)s:(#)?([\w-]+)$/);N?N[2]?"decl"===N[3]?C[M]=[x]:S[M]=[x]:w[M]=[x]:S[M]=[x]}for(const M of s){d&&M.checkDeprecations(m,d),v+=M.getModuleSource(r,p);const N=M.injections[r];for(const U in N){const k=U.match(/^(v|f)s:#([\w-]+)$/);if(k){const R="decl"===k[2]?C:S;R[U]=R[U]||[],R[U].push(N[U])}else w[U]=w[U]||[],w[U].push(N[U])}}return v+=Vme,v=aH(v,r,C),v+=function qme(t,e){let n="";for(const i in t){const r=t[i];if(n+="void ".concat(r.signature," {\n"),r.header&&(n+="  ".concat(r.header)),e[i]){const s=e[i];s.sort((o,a)=>o.order-a.order);for(const o of s)n+="  ".concat(o.injection,"\n")}r.footer&&(n+="  ".concat(r.footer)),n+="}\n"}return n}(_[r],w),v+=m,v=aH(v,r,S),v=function Bme(t,e,n){switch(e){case 300:return n?vv(t,Ome):function kme(t){const e=(t=vv(t,Pme)).match(_S);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(mS,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(Fme,i=>"out vec4 ".concat(n,";\n").concat(i)).replace(new RegExp("\\b".concat(mS,"\\b"),"g"),n)}return t}(t);case 100:return n?vv(t,Nme):function Ume(t){const e=(t=vv(t,Lme)).match(_S);if(e){const n=e[1];t=t.replace(_S,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),mS)}return t}(t);default:throw new Error("unknown GLSL version ".concat(e))}}(v,l?100:p,h),v}function zme(t){return function(n){const i={};for(const r of t){const s=r.getUniforms(n,i);Object.assign(i,s)}return i}}const oe=new sp({id:"luma.gl"});function Mi(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const Kme="Requires WebGL2";function bv(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext||!(!t||!Number.isFinite(t._version))}function He(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext||!(!t||2!==t._version)}function Ev(t){return Mi(bv(t),"Invalid WebGLRenderingContext"),t}function fi(t){return Mi(He(t),Kme),t}const fp={};const pp=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new t.VertexAttrib(n);this.attribs[i]=r}this.maxAttrib=0};(pp.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const nl=function(e){const n=this;this.gl=e,function t_e(t){const e=t.getError;t.getError=function(){let i;do{i=e.apply(t),0!==i&&(fp[i]=!0)}while(0!==i);for(i in fp)if(fp[i])return delete fp[i],parseInt(i,10);return 0}}(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;return o.maxAttrib=Math.max(o.maxAttrib,s),o.attribs[s].enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;return o.maxAttrib=Math.max(o.maxAttrib,s),o.attribs[s].enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:n.currentArrayBuffer=o;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=o}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const c=n.currentVertexArrayObject.attribs[s];switch(o){case 34975:return c.buffer;case 34338:return c.enabled;case 34339:return c.size;case 34340:return c.stride;case 34341:return c.type;case 34922:return c.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,c,l,u){const d=n.currentVertexArrayObject;d.maxAttrib=Math.max(d.maxAttrib,s);const h=d.attribs[s];return h.buffer=n.currentArrayBuffer,h.size=o,h.type=a,h.normalized=c,h.stride=l,h.offset=u,h.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{(function Qme(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)})("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};nl.prototype.VERTEX_ARRAY_BINDING_OES=34229,nl.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new pp(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},nl.prototype.createVertexArrayOES=function(){const e=new pp(this);return this.vertexArrayObjects.push(e),e},nl.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},nl.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof pp&&e.hasBeenBound&&e.ext===this)},nl.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive)return void function e_e(t,e){fp[t]=!0,void 0!==e&&function Zme(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}(e)}(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(n,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let c=0;c<=a;c++){const l=s.attribs[c],u=r?r.attribs[c]:null;if((!r||l.enabled!==u.enabled)&&(l.enabled?i.enableVertexAttribArray.call(n,c):i.disableVertexAttribArray.call(n,c)),l.enabled){let d=!1;(!r||l.buffer!==u.buffer)&&(o!==l.buffer&&(i.bindBuffer.call(n,34962,l.buffer),o=l.buffer),d=!0),(d||l.cached!==u.cached)&&i.vertexAttribPointer.call(n,c,l.size,l.type,l.normalized,l.stride,l.offset)}}this.currentArrayBuffer!==o&&i.bindBuffer.call(n,34962,this.currentArrayBuffer)};const hH="OES_element_index",fH="WEBGL_draw_buffers",pH="WEBGL_debug_renderer_info",o_e=35723,c_e=36795,l_e=34047,u_e=37445,d_e=37446,Bt=t=>He(t)?void 0:0,h_e={3074:t=>He(t)?void 0:36064,[o_e]:t=>He(t)?void 0:4352,35977:Bt,32937:Bt,[c_e]:(t,e)=>{const n=He(t)?t.getExtension("EXT_disjoint_timer_query_webgl2"):t.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[u_e]:(t,e)=>{const n=t.getExtension(pH);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[d_e]:(t,e)=>{const n=t.getExtension(pH);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[l_e]:(t,e)=>{const n=t.luma.extensions.EXT_texture_filter_anisotropic;return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Bt,35071:Bt,37447:Bt,36063:(t,e)=>{if(!He(t)){const n=t.getExtension(fH);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Bt,35374:Bt,35377:Bt,34852:t=>{if(!He(t)){const e=t.getExtension(fH);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(hH)?2147483647:65535,33001:t=>t.getExtension(hH)?16777216:65535,33e3:t=>16777216,37157:Bt,35373:Bt,35657:Bt,36183:Bt,37137:Bt,34045:Bt,35978:Bt,35979:Bt,35968:Bt,35376:Bt,35375:Bt,35659:Bt,37154:Bt,35371:Bt,35658:Bt,35076:Bt,35077:Bt,35380:Bt},p_e="OES_vertex_array_object",gH="ANGLE_instanced_arrays",g_e="WEBGL_draw_buffers",m_e="EXT_disjoint_timer_query",mH={[p_e]:{meta:{suffix:"OES"},createVertexArray:()=>{Mi(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[gH]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Mi(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[g_e]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Mi(!1)}},[m_e]:{meta:{suffix:"EXT"},createQuery:()=>{Mi(!1)},deleteQuery:()=>{Mi(!1)},beginQuery:()=>{Mi(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},yS={readBuffer:(t,e,n)=>{He(t)&&e(n)},getVertexAttrib:(t,e,n,i)=>{const{webgl2:r,ext:s}=function v_e(t,e){return{webgl2:He(t),ext:t.getExtension(e)}}(t,gH);let o;switch(i){case 35069:o=!!r&&void 0;break;case 35070:o=r||s?void 0:0}return void 0!==o?o:e(n,i)},getProgramParameter:(t,e,n,i)=>{if(!He(t))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(n,i)},getInternalformatParameter:(t,e,n,i,r)=>He(t)||32937!==r?t.getInternalformatParameter(n,i,r):new Int32Array([0]),getTexParameter(t,e,n,i){if(34046===i){const{extensions:r}=t.luma,s=r.EXT_texture_filter_anisotropic;i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(n,i)},getParameter:function f_e(t,e,n){const i=h_e[n],r="function"==typeof i?i(t,e,n):i;return void 0!==r?r:e(n)},hint:(t,e,n,i)=>e(n,i)};function C_e(t,e){let{extension:n,target:i,target2:r}=e;const s=mH[n];Mi(s);const{meta:o={}}=s,{suffix:a=""}=o,c=t.getExtension(n);for(const l of Object.keys(s)){const u="".concat(l).concat(a);let d=null;"meta"===l||"function"==typeof t[l]||(c&&"function"==typeof c[u]?d=function(){return c[u](...arguments)}:"function"==typeof s[l]&&(d=s[l].bind(i))),d&&(i[l]=d,r[l]=d)}}globalThis.polyfillContext=function b_e(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(function n_e(t){if("function"==typeof t.createVertexArray)return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const n=t.getExtension;t.getExtension=function(r){return n.call(this,r)||("OES_vertex_array_object"!==r?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new nl(this)),this.__OESVertexArrayObject))}}(t),function E_e(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}(t),function A_e(t,e){for(const n of Object.getOwnPropertyNames(e))"overrides"!==n&&C_e(t,{extension:n,target:t.luma,target2:t})}(t,mH),function w_e(t,e){let{target:n,target2:i}=e;Object.keys(yS).forEach(r=>{if("function"==typeof yS[r]){const s=t[r]?t[r].bind(t):()=>{},o=yS[r].bind(null,t,s);n[r]=o,i[r]=o}})}(t,{target:e,target2:t}),e.polyfilled=!0),t};const vS={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Va=(t,e,n)=>e?t.enable(n):t.disable(n),_H=(t,e,n)=>t.hint(n,e),mr=(t,e,n)=>t.pixelStorei(n,e);function gp(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const x_e={3042:Va,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Va,2885:(t,e)=>t.cullFace(e),2929:Va,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Va,35723:_H,36006:(t,e)=>{const n=He(t)?36009:36160;return t.bindFramebuffer(n,e)},2886:(t,e)=>t.frontFace(e),33170:_H,2849:(t,e)=>t.lineWidth(e),32823:Va,32824:"polygonOffset",10752:"polygonOffset",35977:Va,32938:"sampleCoverage",32939:"sampleCoverage",3089:Va,3088:(t,e)=>t.scissor(...e),2960:Va,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:mr,3317:mr,37440:mr,37441:mr,37443:mr,3330:mr,3332:mr,3331:mr,36010:(t,e)=>t.bindFramebuffer(36008,e),3314:mr,32878:mr,3316:mr,3315:mr,32877:mr,framebuffer:(t,e)=>t.bindFramebuffer(36160,e&&"handle"in e?e.handle:e),blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=gp(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=gp(e)&&2===e.length?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=gp(e)?e:[e,e];const[n,i]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,i)},stencilFunc:(t,e)=>{e=gp(e)&&3===e.length?[...e,...e]:e;const[n,i,r,s,o,a]=e;t.stencilFuncSeparate(1028,n,i,r),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=gp(e)&&3===e.length?[...e,...e]:e;const[n,i,r,s,o,a]=e;t.stencilOpSeparate(1028,n,i,r),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function Xt(t,e,n){return void 0!==e[t]?e[t]:n[t]}const I_e={blendEquation:(t,e,n)=>t.blendEquationSeparate(Xt(32777,e,n),Xt(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Xt(32969,e,n),Xt(32968,e,n),Xt(32971,e,n),Xt(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Xt(32824,e,n),Xt(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Xt(32938,e,n),Xt(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Xt(2962,e,n),Xt(2967,e,n),Xt(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Xt(34816,e,n),Xt(36003,e,n),Xt(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Xt(2964,e,n),Xt(2965,e,n),Xt(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Xt(34817,e,n),Xt(34818,e,n),Xt(34819,e,n))},yH={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,i,r)=>t({32773:new Float32Array([e,n,i,r])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,i,r)=>t({32969:e,32968:n,32971:i,32970:r}),clearColor:(t,e,n,i,r)=>t({3106:new Float32Array([e,n,i,r])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,i,r)=>t({3107:[e,n,i,r]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,i,r)=>t({3088:new Int32Array([e,n,i,r])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[1028===e?2968:36005]:n}),stencilFunc:(t,e,n,i)=>t({2962:e,2967:n,2963:i,34816:e,36003:n,36004:i}),stencilFuncSeparate:(t,e,n,i,r)=>t({[1028===e?2962:34816]:n,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(t,e,n,i)=>t({2964:e,2965:n,2966:i,34817:e,34818:n,34819:i}),stencilOpSeparate:(t,e,n,i,r)=>t({[1028===e?2964:34817]:n,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(t,e,n,i,r)=>t({2978:[e,n,i,r]})},Xs=(t,e)=>t.isEnabled(e),vH={3042:Xs,2884:Xs,2929:Xs,3024:Xs,32823:Xs,32926:Xs,32928:Xs,3089:Xs,2960:Xs,35977:Xs};function bH(t){for(const e in t)return!1;return!0}function M_e(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),i=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&i&&t.length===e.length){for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}return!1}function EH(t,e){const n=t[e].bind(t);t[e]=function(){const r=arguments.length<=0?void 0:arguments[0];return r in t.state.cache&&t.state.enable?t.state.cache[r]:n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function D_e(t,e,n){const i=t[e].bind(t);t[e]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const{valueChanged:c,oldValue:l}=n(t.state._updateCache,...o);return c&&i(...o),l},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}class O_e{constructor(e){let{copyState:n=!1,log:i=()=>{}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?function N_e(t,e){if("number"==typeof(e=e||vS)){const r=e,s=vH[r];return s?s(t,r):t.getParameter(r)}const n=Array.isArray(e)?e:Object.keys(e),i={};for(const r of n){const s=vH[r];i[r]=s?s(t,Number(r)):t.getParameter(Number(r))}return i}(e):Object.assign({},vS),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Mi(this.stateStack.length>0),Fo(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(e){let i,n=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Mi(void 0!==s);const o=e[s],a=this.cache[s];M_e(o,a)||(n=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:i}}}function wH(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{enable:n=!0,copyState:i}=e;if(Mi(void 0!==i),!t.state){const{polyfillContext:r}=globalThis;r&&r(t),t.state=new O_e(t,{copyState:i}),function R_e(t){const e=t.useProgram.bind(t);t.useProgram=function(i){t.state.program!==i&&(e(i),t.state.program=i)}}(t);for(const s in yH)D_e(t,s,yH[s]);EH(t,"getParameter"),EH(t,"isEnabled")}return t.state.enable=n,t}function AH(t){Mi(t.state),t.state.pop()}function Fo(t,e){if(Mi(bv(t),"setParameters requires a WebGL context"),bH(e))return;const n={};for(const r in e){const s=Number(r),o=x_e[r];o&&("string"==typeof o?n[o]=!0:o(t,e[r],s))}const i=t.state&&t.state.cache;if(i)for(const r in n)(0,I_e[r])(t,e,i)}function Ur(t,e,n){if(bH(e))return n(t);const{nocatch:i=!0}=e;let r;if(function P_e(t){t.state||wH(t,{copyState:!1}),t.state.push()}(t),Fo(t,e),i)r=n(t),AH(t);else try{r=n(t)}finally{AH(t)}return r}function cd(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,i="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return i?t.drawingBufferWidth/i:1}return 1}function bS(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function B_e(t,e,n,i,r){const s=CH(t[0],e,n);let o=TH(t[1],e,i,r),a=CH(t[0]+1,e,n);const c=a===n-1?a:a-1;let l;return a=TH(t[1]+1,e,i,r),r?(a=0===a?a:a+1,l=o,o=a):l=a===i-1?a:a-1,{x:s,y:o,width:Math.max(c-s+1,1),height:Math.max(l-o+1,1)}}(e,cd(t),t.drawingBufferWidth,t.drawingBufferHeight,n)}function CH(t,e,n){return Math.min(Math.round(t*e),n-1)}function TH(t,e,n,i){return i?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const ES=$s(),k_e=ES&&typeof document<"u",SH={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function xH(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Mi(ES,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),t=Object.assign({},SH,t);const{width:e,height:n}=t;function i(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}let r;t.onError=i;const{canvas:s}=t,o=function H_e(t){let s,{canvas:e,width:n=800,height:i=600,onError:r}=t;return"string"==typeof e?(k_e&&"complete"===document.readyState||r("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(i)?"".concat(i,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}({canvas:s,width:e,height:n,onError:i});return r=function j_e(t,e){const{onError:n}=e;let i=null;const r=c=>i=c.statusMessage||i;t.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"))}(o,t),r?(r=wS(r,t),function z_e(t){const e=He(t)?"WebGL2":"WebGL1",n=function U_e(t){const e=t.getParameter(7936),n=t.getParameter(7937),i=t.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&t.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&t.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",r=t.debug?" debug":"";oe.info(1,"".concat(e).concat(r," context ").concat(i))()}(r),r):null}function wS(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||function G_e(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},SH,e);const{manageState:n,debug:i}=e;return n&&wH(t,{copyState:!1,log:function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return oe.log(1,...s)()}}),ES&&i&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),oe.level=Math.max(oe.level,1)):oe.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function IH(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}class MH{constructor(e,n){E(this,"name",void 0),E(this,"type",void 0),E(this,"sampleSize",1),E(this,"time",void 0),E(this,"count",void 0),E(this,"samples",void 0),E(this,"lastTiming",void 0),E(this,"lastSampleTime",void 0),E(this,"lastSampleCount",void 0),E(this,"_count",0),E(this,"_time",0),E(this,"_samples",0),E(this,"_startTime",0),E(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=IH(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(IH()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class AS{constructor(e){E(this,"id",void 0),E(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){return this._getOrCreate({name:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count"})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:i}=e;return this.stats[n]||(this.stats[n]=e instanceof MH?e:new MH(n,i)),this.stats[n]}}const mp="8.5.21",il=new class q_e{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new AS({id:e})),this.stats.get(e)}};if(globalThis.luma&&globalThis.luma.VERSION!==mp)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(mp));function Q(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function CS(t,e){if("string"!=typeof e)return e;const n=Number(e);if(!isNaN(n))return n;const i=t[e=e.replace(/^.*\./,"")];return Q(void 0!==i,"Accessing undefined constant GL.".concat(e)),i}function ja(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}globalThis.luma||($s()&&oe.log(1,"luma.gl ".concat(mp," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),globalThis.luma=globalThis.luma||{VERSION:mp,version:mp,log:oe,stats:il,globals:{modules:{},nodeIO:{}}}),globalThis;const TS={};function $i(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";TS[t]=TS[t]||1;const e=TS[t]++;return"".concat(t,"-").concat(e)}function DH(t){return Q("number"==typeof t,"Input must be a number"),t&&!(t&t-1)}function ld(t){let e=!0;for(const n in t){e=!1;break}return e}function RH(t,e,n,i){const r="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);i.forEach(o=>{s.methodName||(s[o]=()=>{throw oe.removed("Calling removed method ".concat(e,".").concat(o,": "),r)(),new Error(o)})})}const ud="Resource subclass must define virtual methods";class Bo{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ev(e);const{id:i,userData:r={}}=n;this.gl=e,this.gl2=e,this.id=i||$i(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=n.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(i=>i.delete()),this}bind(){let n,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!=typeof e?(this._bindHandle(e),this):(this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n)}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Q(e=CS(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=He(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension))return s&&"webgl2"in r?r.webgl2:r.webgl1}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{parameters:n,keys:i}=e,r=this.constructor.PARAMETERS||{},s=He(this.gl),o={},a=n||Object.keys(r);for(const c of a){const l=r[c];if(l&&(!("webgl2"in l)||s)&&(!("extension"in l)||this.gl.getExtension(l.extension))){const d=i?ja(this.gl,c):c;o[d]=this.getParameter(c,e),i&&"GLenum"===l.type&&(o[d]=ja(this.gl,o[d]))}}return o}setParameter(e,n){Q(e=CS(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=He(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(n=CS(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,i){return RH(this,e,n,i)}initialize(e){}_createHandle(){throw new Error(ud)}_deleteHandle(){throw new Error(ud)}_bindHandle(e){throw new Error(ud)}_getOptsFromHandle(){throw new Error(ud)}_getParameter(e,n){throw new Error(ud)}_setParameter(e,n){throw new Error(ud)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=il.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];il.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];const r=il.get("Memory Usage".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:""));r.get("GPU Memory").addCount(e),r.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];const i=il.get("Memory Usage".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:""));i.get("GPU Memory").subtractCount(this.byteLength),i.get("".concat(e," Memory")).subtractCount(this.byteLength)}}const X_e="Failed to deduce GL constant from typed array";function SS(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(X_e)}}function _p(t){let{clamped:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function K_e(t){let{data:e,width:n,height:i}=t;const r=Math.round(n/2),s=Math.round(i/2),o=new Uint8Array(r*s*4);for(let a=0;a<s;a++)for(let c=0;c<r;c++)for(let l=0;l<4;l++)o[4*(a*r+c)+l]=e[4*(2*a*n+2*c)+l];return{data:o,width:r,height:s}}function xS(t,e,n){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=n;for(const a in i)if(a in e){const l=i[a]?"".concat(t,".").concat(i[a]):"N/A";oe.removed("".concat(t,".").concat(a),l)()}for(const a in r)if(a in e){const c=r[a];oe.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(c))()}let o=null;for(const a in s)if(a in e){const c=s[a];oe.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(c))(),o=o||Object.assign({},e),o[c]=e[a],delete o[a]}return o||e}const J_e={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Z_e={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class qi{static getBytesPerElement(e){return _p(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Q(e.size),_p(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new qi(J_e,...n)}constructor(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach(r=>this._assign(r)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return qi.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return qi.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=xS("Accessor",e,Z_e),void 0!==e.type&&(this.type=e.type,(5124===e.type||5125===e.type)&&(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&(this.index="boolean"==typeof e.index?e.index?1:0:e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const PH={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Q_e={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:PH},eye={removedProps:PH};class St extends Bo{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){return Math.round(this.byteLength/qi.getBytesPerElement(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor))}getVertexCount(){return Math.round(this.byteLength/qi.getBytesPerVertex(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor))}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=xS("Buffer",e,Q_e),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=xS("Buffer",e,eye))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new qi(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;Q(n);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==s?(fi(this.gl),this.gl.bufferSubData(this.target,i,n,r,s)):this.gl.bufferSubData(o,i,n),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:i=0,writeOffset:r=0,size:s}=e;const{gl:o}=this;return fi(o),o.bindBuffer(36662,n.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,i,r,s),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:i=0,length:r=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};fi(this.gl);const s=_p(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(n),a=i;let c,l;e?(l=e.length,c=l-a):(c=Math.min(o,r||o),l=a+c);const u=Math.min(o,c);return r=r||u,Q(r<=u),e=e||new s(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,i,r),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:i=0,size:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,n,this.handle,i,r):(Q(0===i),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===e||35982===e?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength+n;Q(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,n,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,10),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=SS(e);return Q(s),this.setAccessor(new qi(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;Q(e>=0),this._trackDeallocatedMemory();let i=e;0===e&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,n),this.gl.bindBuffer(r,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const i=e/_p(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new qi(this.accessor,{type:SS(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return oe.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return oe.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return oe.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return oe.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new qi(this.accessor,e),this}}const IS={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},NH={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},LH={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},iye=[9729,9728],FH=globalThis.WebGLBuffer||function(){};class rl extends Bo{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{format:i,linearFiltering:r}=n;let s=!0;return i&&(s=s&&function tye(t,e){const n=IS[e];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const i=He(t)&&n.gl2||n.gl1;return"string"==typeof i?t.getExtension(i):i}(e,i),s=s&&(!r||function nye(t,e){const n=IS[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}(e,i))),s}constructor(e,n){const{id:i=$i("texture"),handle:r,target:s}=n;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(v=>this.initialize(Object.assign({},e,{pixels:v,data:v}))),this;const i=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(i&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:o=0,recreate:a=!1,parameters:c={},pixelStore:l={},textureUnit:u}=e;n||(n=r);let{width:d,height:h,dataFormat:f,type:p,compressed:g=!1,mipmaps:m=!0}=e;const{depth:y=0}=e;return({width:d,height:h,compressed:g,dataFormat:f,type:p}=this._deduceParameters({format:s,type:p,dataFormat:f,compressed:g,data:n,width:d,height:h})),this.width=d,this.height=h,this.depth=y,this.format=s,this.type=p,this.dataFormat=f,this.border=o,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),m&&this._isNPOT()&&(oe.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),m=!1,this._updateForNPOT(c)),this.mipmaps=m,this.setImageData({data:n,width:d,height:h,depth:y,format:s,type:p,dataFormat:f,border:o,mipmaps:m,parameters:l,compressed:g}),m&&this.generateMipmap(),this.setParameters(c),a&&(this.data=n),i&&(this._video={video:n,parameters:c,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:i,mipmaps:r=!1}=e;return i!==this.width||n!==this.height?this.initialize({width:i,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:r}):this}generateMipmap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isNPOT()?(oe.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Ur(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:i=null,level:r=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:c={}}=e;let{data:l=null,type:u=this.type,width:d=this.width,height:h=this.height,dataFormat:f=this.dataFormat,compressed:p=!1}=e;l||(l=i),({type:u,dataFormat:f,compressed:p,width:d,height:h}=this._deduceParameters({format:s,type:u,dataFormat:f,compressed:p,data:l,width:d,height:h}));const{gl:g}=this;g.bindTexture(this.target,this.handle);let m=null;({data:l,dataType:m}=this._getDataType({data:l,compressed:p}));let y,v=0;return Ur(this.gl,c,()=>{switch(m){case"null":g.texImage2D(n,r,s,d,h,o,f,u,l);break;case"typed-array":g.texImage2D(n,r,s,d,h,o,f,u,l,a);break;case"buffer":y=fi(g),y.bindBuffer(35052,l.handle||l),y.texImage2D(n,r,s,d,h,o,f,u,a),y.bindBuffer(35052,null);break;case"browser-object":He(g)?g.texImage2D(n,r,s,d,h,o,f,u,l):g.texImage2D(n,r,s,f,u,l);break;case"compressed":for(const[_,w]of l.entries())g.compressedTexImage2D(n,_,w.format,w.width,w.height,o,w.data),v+=w.levelSize;break;default:Q(!1,"Unknown image data type")}}),this._trackAllocatedMemory("compressed"===m?v:l&&l.byteLength?l.byteLength:this.width*this.height*(NH[this.dataFormat]||4)*(LH[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:i=null,data:r=null,x:s=0,y:o=0,width:a=this.width,height:c=this.height,level:l=0,format:u=this.format,type:d=this.type,dataFormat:h=this.dataFormat,compressed:f=!1,offset:p=0,border:g=this.border,parameters:m={}}=e;if(({type:d,dataFormat:h,compressed:f,width:a,height:c}=this._deduceParameters({format:u,type:d,dataFormat:h,compressed:f,data:r,width:a,height:c})),Q(0===this.depth,"texSubImage not supported for 3D textures"),r||(r=i),r&&r.data){const y=r;r=y.data,a=y.shape[0],c=y.shape[1]}r instanceof St&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),Ur(this.gl,m,()=>{if(f)this.gl.compressedTexSubImage2D(n,l,s,o,a,c,u,r);else if(null===r)this.gl.texSubImage2D(n,l,s,o,a,c,h,d,null);else if(ArrayBuffer.isView(r))this.gl.texSubImage2D(n,l,s,o,a,c,h,d,r,p);else if(r instanceof FH){const y=fi(this.gl);y.bindBuffer(35052,r),y.texSubImage2D(n,l,s,o,a,c,h,d,p),y.bindBuffer(35052,null)}else He(this.gl)?fi(this.gl).texSubImage2D(n,l,s,o,a,c,h,d,r):this.gl.texSubImage2D(n,l,s,o,h,d,r)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return oe.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:n}=this;return void 0!==e&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:n}=this;return void 0!==e&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:i=!1}=e;return i?{data:n,dataType:"compressed"}:null===n?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof St?{data:n.handle,dataType:"buffer"}:n instanceof FH?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:i}=e;let{width:r,height:s,dataFormat:o,type:a,compressed:c}=e;const l=IS[n];return o=o||l&&l.dataFormat,a=a||l&&l.types[0],c=c||l&&l.compressed,({width:r,height:s}=this._deduceImageSize(i,r,s)),{dataFormat:o,type:a,compressed:c,width:r,height:s,format:n,data:i}}_deduceImageSize(e,n,i){let r;return r=typeof ImageData<"u"&&e instanceof ImageData?{width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?{width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:n,height:i}:{width:n>=0?n:1,height:i>=0?i:1},Q(r,"Could not deduced texture size"),Q(void 0===n||r.width===n,"Deduced texture width does not match supplied width"),Q(void 0===i||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:Q(!1);break;default:this.gl.texParameteri(this.target,e,n)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(He(this.gl)||!this.width||!this.height||DH(this.width)&&DH(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:-1===iye.indexOf(n)&&(n=9729);break;case 10242:case 10243:33071!==n&&(n=33071)}return n}}function rye(t,e){return Q("string"==typeof t),t=""+t,new Promise((n,i)=>{try{const r=new Image;r.onload=()=>n(r),r.onerror=()=>i(new Error("Could not load image ".concat(t,"."))),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=t}catch(r){i(r)}})}class Jn extends rl{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return rl.isSupported(e,n)}constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ev(e),(n instanceof Promise||"string"==typeof n)&&(n={data:n}),"string"==typeof n.data&&(n=Object.assign({},n,{data:rye(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const sl="EXT_color_buffer_float",BH={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:sl,bpp:2},33327:{gl2:sl,bpp:4},34842:{gl2:sl,bpp:8},33326:{gl2:sl,bpp:4},33328:{gl2:sl,bpp:8},34836:{gl2:sl,bpp:16},35898:{gl2:sl,bpp:4}};class dd extends Bo{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:null};return!n||function sye(t,e,n){const i=n[e];if(!i)return!1;const r=He(t)&&i.gl2||i.gl1;return"string"==typeof r?t.getExtension(r):r}(e,n,BH)}static getSamplesForFormat(e,n){let{format:i}=n;return e.getInternalformatParameter(36161,i,32937)}constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:i=1,height:r=1,samples:s=0}=e;return Q(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==s&&He(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,i,r):this.gl.renderbufferStorage(36161,n,i,r),this.format=n,this.width=i,this.height=r,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*BH[this.format].bpp),this}resize(e){let{width:n,height:i}=e;return n!==this.width||i!==this.height?this.initialize({width:n,height:i,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const kH=6144,HH="clear: bad arguments";function DS(t){let{framebuffer:e=null,color:n=null,depth:i=null,stencil:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s={};e&&(s.framebuffer=e);let o=0;n&&(o|=16384,!0!==n&&(s.clearColor=n)),i&&(o|=256,!0!==i&&(s.clearDepth=i)),r&&(o|=1024,!0!==i&&(s.clearStencil=i)),Q(0!==o,HH),Ur(t,s,()=>{t.clear(o)})}const RS=[34069,34070,34071,34072,34073,34074];let dye=(()=>{class t extends rl{get[Symbol.toStringTag](){return"TextureCube"}constructor(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ev(n),super(n,Object.assign({},i,{target:34067})),this.initialize(i),Object.seal(this)}initialize(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mipmaps:i=!0,parameters:r={}}=n;return this.opts=n,this.setCubeMapImageData(n).then(()=>{this.loaded=!0,i&&this.generateMipmap(n),this.setParameters(r)}),this}subImage(n){let{face:i,data:r,x:s=0,y:o=0,mipmapLevel:a=0}=n;return this._subImage({target:i,data:r,x:s,y:o,mipmapLevel:a})}setCubeMapImageData(n){var i=this;return ee(function*(){let{width:r,height:s,pixels:o,data:a,border:c=0,format:l=6408,type:u=5121}=n;const{gl:d}=i,h=o||a,f=yield Promise.all(RS.map(p=>{const g=h[p];return Promise.all(Array.isArray(g)?g:[g])}));i.bind(),RS.forEach((p,g)=>{f[g].length>1&&!1!==i.opts.mipmaps&&oe.warn("".concat(i.id," has mipmap and multiple LODs."))(),f[g].forEach((m,y)=>{r&&s?d.texImage2D(p,y,l,r,s,c,l,u,m):d.texImage2D(p,y,l,l,u,m)})}),i.unbind()})()}setImageDataForFace(n){const{face:i,width:r,height:s,pixels:o,data:a,border:c=0,format:l=6408,type:u=5121}=n,{gl:d}=this,h=o||a;return this.bind(),h instanceof Promise?h.then(f=>this.setImageDataForFace(Object.assign({},n,{face:i,data:f,pixels:f}))):this.width||this.height?d.texImage2D(i,0,l,r,s,c,l,u,h):d.texImage2D(i,0,l,l,u,h),this}}return t.FACES=RS,t})();class hye extends rl{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return He(e)}constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};fi(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:i=6408,width:r,height:s,depth:o=1,border:a=0,format:c,type:l=5121,offset:u=0,data:d,parameters:h={}}=e;return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Ur(this.gl,h,()=>{ArrayBuffer.isView(d)&&this.gl.texImage3D(this.target,n,i,r,s,o,a,c,l,d),d instanceof St&&(this.gl.bindBuffer(35052,d.handle),this.gl.texImage3D(this.target,n,i,r,s,o,a,c,l,u))}),this._trackAllocatedMemory(d&&d.byteLength?d.byteLength:this.width*this.height*this.depth*(NH[this.dataFormat]||4)*(LH[this.type]||1),"Texture"),this.loaded=!0,this}}function pye(t,e){const{gl:n,width:i,height:r,id:s}=t;return new mn(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:i,height:r,attachments:{36064:t}}))}function wv(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sourceX:n=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:c,sourceType:l}=e;const{framebuffer:u,deleteFramebuffer:d}=yp(t);Q(u);const{gl:h,handle:f,attachments:p}=u;a=a||u.width,c=c||u.height,36064===s&&null===f&&(s=1028),Q(p[s]),l=l||p[s].type,o=function mye(t,e,n,i,r){if(t)return t;const s=_p(e=e||5121,{clamped:!1}),o=function uye(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Q(!1),0}}(n);return new s(i*r*o)}(o,l,r,a,c),l=l||SS(o);const g=h.bindFramebuffer(36160,f);return h.readPixels(n,i,a,c,r,l,o),h.bindFramebuffer(36160,g||null),d&&u.delete(),o}function OS(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=wv(t,{sourceAttachment:e}),{width:r,height:s}=t;for(;s>n;)({data:i,width:r,height:s}=K_e({data:i,width:r,height:s}));!function Y_e(t){let{data:e,width:n,height:i,bytesPerPixel:r=4,temp:s}=t;const o=n*r;s=s||new Uint8Array(o);for(let a=0;a<i/2;++a){const c=a*o,l=(i-a-1)*o;s.set(e.subarray(c,c+o)),e.copyWithin(c,l,l+o),e.set(s,l)}}({data:i,width:r,height:s});const o=document.createElement("canvas");o.width=r,o.height=s;const a=o.getContext("2d"),c=a.createImageData(r,s);return c.data.set(i),a.putImageData(c,0,0),o.toDataURL()}function yp(t){return t instanceof mn?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:pye(t),deleteFramebuffer:!0}}const kt_WEBGL2="WEBGL2",kt_VERTEX_ARRAY_OBJECT="VERTEX_ARRAY_OBJECT",kt_TIMER_QUERY="TIMER_QUERY",kt_INSTANCED_RENDERING="INSTANCED_RENDERING",kt_MULTIPLE_RENDER_TARGETS="MULTIPLE_RENDER_TARGETS",kt_ELEMENT_INDEX_UINT32="ELEMENT_INDEX_UINT32",kt_BLEND_EQUATION_MINMAX="BLEND_EQUATION_MINMAX",kt_FLOAT_BLEND="FLOAT_BLEND",kt_COLOR_ENCODING_SRGB="COLOR_ENCODING_SRGB",kt_TEXTURE_DEPTH="TEXTURE_DEPTH",kt_TEXTURE_FLOAT="TEXTURE_FLOAT",kt_TEXTURE_HALF_FLOAT="TEXTURE_HALF_FLOAT",kt_TEXTURE_FILTER_LINEAR_FLOAT="TEXTURE_FILTER_LINEAR_FLOAT",kt_TEXTURE_FILTER_LINEAR_HALF_FLOAT="TEXTURE_FILTER_LINEAR_HALF_FLOAT",kt_TEXTURE_FILTER_ANISOTROPIC="TEXTURE_FILTER_ANISOTROPIC",kt_COLOR_ATTACHMENT_RGBA32F="COLOR_ATTACHMENT_RGBA32F",kt_COLOR_ATTACHMENT_FLOAT="COLOR_ATTACHMENT_FLOAT",kt_COLOR_ATTACHMENT_HALF_FLOAT="COLOR_ATTACHMENT_HALF_FLOAT",kt_GLSL_FRAG_DATA="GLSL_FRAG_DATA",kt_GLSL_FRAG_DEPTH="GLSL_FRAG_DEPTH",kt_GLSL_DERIVATIVES="GLSL_DERIVATIVES",kt_GLSL_TEXTURE_LOD="GLSL_TEXTURE_LOD",zH={[kt_WEBGL2]:[!1,!0],[kt_VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[kt_TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[kt_INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[kt_MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[kt_ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[kt_BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[kt_FLOAT_BLEND]:["EXT_float_blend"],[kt_COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[kt_TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[kt_TEXTURE_FLOAT]:["OES_texture_float",!0],[kt_TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[kt_TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[kt_TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[kt_TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[kt_COLOR_ATTACHMENT_RGBA32F]:[function _ye(t){const e=new Jn(t,{format:6408,type:5126,dataFormat:6408}),n=new mn(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=n.getStatus();return e.delete(),n.delete(),36053===i},"EXT_color_buffer_float"],[kt_COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[kt_COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[kt_GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[kt_GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[kt_GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[kt_GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},yye=2;function PS(t,e){return GH(t,e)}function GH(t,e){return(e=Array.isArray(e)?e:[e]).every(n=>WH(t,n))}function WH(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},void 0===t.luma.caps[e]&&(t.luma.caps[e]=function bye(t,e){const n=zH[e];let i;Q(n,e);const r=He(t)&&n[1]||n[0];if("function"==typeof r)i=r(t);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&!!t.getExtension(s)}else"string"==typeof r?i=!!t.getExtension(r):"boolean"==typeof r?i=r:Q(!1);return i}(t,e)),t.luma.caps[e]||oe.log(yye,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}const $H="Multiple render targets not supported";class mn extends Bo{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{colorBufferFloat:i,colorBufferHalfFloat:r}=n;let s=!0;return i&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&!(!e.getExtension("EXT_color_buffer_float")&&!e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new mn(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=fi(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=fi(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:i=1,attachments:r=null,color:s=!0,depth:o=!0,stencil:a=!1,check:c=!0,readBuffer:l,drawBuffers:u}=e;if(Q(n>=0&&i>=0,"Width and height need to be integers"),this.width=n,this.height=i,r)for(const d in r){const h=r[d];(Array.isArray(h)?h[0]:h).resize({width:n,height:i})}else r=this._createDefaultAttachments(s,o,a,n,i);this.update({clearAttachments:!0,attachments:r,readBuffer:l,drawBuffers:u}),r&&c&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:i,drawBuffers:r,clearAttachments:s=!1,resizeAttachments:o=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:o});const{gl:a}=this,c=a.bindFramebuffer(36160,this.handle);return i&&this._setReadBuffer(i),r&&this._setDrawBuffers(r),a.bindFramebuffer(36160,c||null),this}resize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{width:n,height:i}=e;if(null===this.handle)return Q(void 0===n&&void 0===i),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===n&&(n=this.gl.drawingBufferWidth),void 0===i&&(i=this.gl.drawingBufferHeight),n!==this.width&&i!==this.height&&oe.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(i))();for(const r in this.attachments)this.attachments[r].resize({width:n,height:i});return this.width=n,this.height=i,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:i=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={};n&&Object.keys(this.attachments).forEach(o=>{r[o]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){Q(void 0!==o,"Misspelled framebuffer binding point?");const a=Number(o),c=r[a];let l=c;if(l)if(l instanceof dd)this._attachRenderbuffer({attachment:a,renderbuffer:l});else if(Array.isArray(c)){const[u,d=0,h=0]=c;l=u,this._attachTexture({attachment:a,texture:u,layer:d,level:h})}else this._attachTexture({attachment:a,texture:l,layer:0,level:0});else this._unattach(a);i&&l&&l.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const n=this.getStatus();if(36053!==n)throw new Error(function wye(t){return(mn.STATUS||{})[t]||"Framebuffer error ".concat(t)}(n));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),i}clear(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:n,depth:i,stencil:r,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(n||i||r)&&DS(this.gl,{color:n,depth:i,stencil:r}),s.forEach((a,c)=>{!function lye(t){let{framebuffer:e=null,buffer:n=kH,drawBuffer:i=0,value:r=[0,0,0,0]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};fi(t),Ur(t,{framebuffer:e},()=>{switch(n){case kH:switch(r.constructor){case Int32Array:t.clearBufferiv(n,i,r);break;case Uint32Array:t.clearBufferuiv(n,i,r);break;case Float32Array:default:t.clearBufferfv(n,i,r)}break;case 6145:t.clearBufferfv(6145,0,[r]);break;case 6146:t.clearBufferiv(6146,0,[r]);break;case 34041:const[s,o]=r;t.clearBufferfi(34041,0,s,o);break;default:Q(!1,HH)}})}(this.gl,{drawBuffer:c,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return oe.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return oe.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return oe.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return oe.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return oe.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return oe.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:i=0,y:r=0,width:s,height:o}=e;const a=fi(this.gl),c=a.bindFramebuffer(36008,this.handle);return 0===i&&0===r&&void 0===s&&void 0===o?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,i,r,s,o),a.bindFramebuffer(36008,c),this}getAttachmentParameter(e,n,i){let r=this._getAttachmentParameterFallback(n);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=ja(this.gl,r)),r}getAttachmentParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const r={};for(const s of i)r[n?ja(this.gl,s):s]=this.getAttachmentParameter(e,s,n);return r}getParameters(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const n=Object.keys(this.attachments),i={};for(const r of n){const s=Number(r);i[e?ja(this.gl,s):s]=this.getAttachmentParameters(s,e)}return i}show(){return typeof window<"u"&&window.open(OS(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e>oe.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const i=OS(this,{targetMaxHeight:100});return oe.image({logLevel:e,message:n,image:i},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,i,r,s){let o=null;return e&&(o=o||{},o[36064]=new Jn(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),n&&i?(o=o||{},o[33306]=new dd(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}),this.ownResources.push(o[33306])):n?(o=o||{},o[36096]=new dd(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:s}),this.ownResources.push(o[36096])):i&&Q(!1),o}_unattach(e){const n=this.attachments[e];n&&(n instanceof dd?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:i}=e;const{gl:r}=this;r.framebufferRenderbuffer(36160,n,36161,i.handle),this.attachments[n]=i}_attachTexture(e){let{attachment:n=36064,texture:i,layer:r,level:s}=e;const{gl:o}=this;switch(o.bindTexture(i.target,i.handle),i.target){case 35866:case 32879:fi(o).framebufferTextureLayer(36160,n,i.target,s,r);break;case 34067:const c=function Eye(t){return t<34069?t+34069:t}(r);o.framebufferTexture2D(36160,n,c,i.handle,s);break;case 3553:o.framebufferTexture2D(36160,n,3553,i.handle,s);break;default:Q(!1,"Illegal texture type")}o.bindTexture(i.target,null),this.attachments[n]=i}_setReadBuffer(e){const n=function Jme(t){return He(t)?t:null}(this.gl);n?n.readBuffer(e):Q(36064===e||1029===e,$H),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,i=fi(n);if(i)i.drawBuffers(e);else{const r=n.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):Q(1===e.length&&(36064===e[0]||1029===e[0]),$H)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=function vye(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in zH)void 0===t.luma.caps[e]&&(t.luma.caps[e]=WH(t,e));return t.luma.caps}(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return n.WEBGL2||n.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}mn.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const Cye={5126:Vt.bind(null,"uniform1fv",_r,1,pi),35664:Vt.bind(null,"uniform2fv",_r,2,pi),35665:Vt.bind(null,"uniform3fv",_r,3,pi),35666:Vt.bind(null,"uniform4fv",_r,4,pi),5124:Vt.bind(null,"uniform1iv",Ha,1,pi),35667:Vt.bind(null,"uniform2iv",Ha,2,pi),35668:Vt.bind(null,"uniform3iv",Ha,3,pi),35669:Vt.bind(null,"uniform4iv",Ha,4,pi),35670:Vt.bind(null,"uniform1iv",Ha,1,pi),35671:Vt.bind(null,"uniform2iv",Ha,2,pi),35672:Vt.bind(null,"uniform3iv",Ha,3,pi),35673:Vt.bind(null,"uniform4iv",Ha,4,pi),35674:Vt.bind(null,"uniformMatrix2fv",_r,4,ko),35675:Vt.bind(null,"uniformMatrix3fv",_r,9,ko),35676:Vt.bind(null,"uniformMatrix4fv",_r,16,ko),35678:Zn,35680:Zn,5125:Vt.bind(null,"uniform1uiv",Av,1,pi),36294:Vt.bind(null,"uniform2uiv",Av,2,pi),36295:Vt.bind(null,"uniform3uiv",Av,3,pi),36296:Vt.bind(null,"uniform4uiv",Av,4,pi),35685:Vt.bind(null,"uniformMatrix2x3fv",_r,6,ko),35686:Vt.bind(null,"uniformMatrix2x4fv",_r,8,ko),35687:Vt.bind(null,"uniformMatrix3x2fv",_r,6,ko),35688:Vt.bind(null,"uniformMatrix3x4fv",_r,12,ko),35689:Vt.bind(null,"uniformMatrix4x2fv",_r,8,ko),35690:Vt.bind(null,"uniformMatrix4x3fv",_r,12,ko),35678:Zn,35680:Zn,35679:Zn,35682:Zn,36289:Zn,36292:Zn,36293:Zn,36298:Zn,36299:Zn,36300:Zn,36303:Zn,36306:Zn,36307:Zn,36308:Zn,36311:Zn},Tye={},Sye={},xye={},qH=[0];function NS(t,e,n,i){1===e&&"boolean"==typeof t&&(t=t?1:0),Number.isFinite(t)&&(qH[0]=t,t=qH);const r=t.length;if(r%e&&oe.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=i[r];s||(s=new n(r),i[r]=s);for(let o=0;o<r;o++)s[o]=t[o];return s}function _r(t,e){return NS(t,e,Float32Array,Tye)}function Ha(t,e){return NS(t,e,Int32Array,Sye)}function Av(t,e){return NS(t,e,Uint32Array,xye)}function XH(t,e,n){const i=Cye[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,t,e)}function Iye(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};const n=t.match(/([^[]*)(\[[0-9]+\])?/);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function Dye(t){return Array.isArray(t)||ArrayBuffer.isView(t)?function Oye(t){if(0===t.length)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t):!!(isFinite(t)||!0===t||!1===t||t instanceof rl||t instanceof dd)||t instanceof mn&&!!t.texture}function Rye(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const i=t[e];for(let r=0,s=n.length;r<s;++r)i[r]=n[r]}else t[e]=n.slice();else t[e]=n}function Zn(){let t=null;return(e,n,i)=>{const r=t!==i;return r&&(e.uniform1i(n,i),t=i),r}}function Vt(t,e,n,i){let r=null,s=null;return(o,a,c)=>{const l=e(c,n),u=l.length;let d=!1;if(null===r)r=new Float32Array(u),s=u,d=!0;else{Q(s===u,"Uniform length cannot change.");for(let h=0;h<u;++h)if(l[h]!==r[h]){d=!0;break}}return d&&(i(o,t,a,l),r.set(l)),d}}function pi(t,e,n,i){t[e](n,i)}function ko(t,e,n,i){t[e](n,!1,i)}function Cv(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const i=t.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return i?i[1]:e}function KH(t,e){let n="";for(let i=0;i<e.length;i++)if((t[i+3]||t[i+2]||t[i+1])&&(n+="".concat(e[i],"\n"),t[i+1])){const s=t[i+1],o=s.split(":",3),a=o[0],c=parseInt(o[1],10)||0,l=s.substring(o.join(":").length+1).trim();n+=JH("^^^ ".concat(a,": ").concat(l,"\n\n"),c)}return n}function JH(t,e){let n="";for(let i=0;i<e;++i)n+=" ";return"".concat(n).concat(t)}class vp extends Bo{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Q(!1),"unknown"}}constructor(e,n){Ev(e),Q("string"==typeof n.source,"Shader: GLSL source code must be a JavaScript string"),super(e,{id:Cv(n.source,null)||n.id||$i("unnamed ".concat(vp.getTypeName(n.shaderType)))}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const i=Cv(n,null);i&&(this.id=$i(i)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(vp.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Cv(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.source;if(e.startsWith("#version ")||(e="#version 100\n".concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:o}=function YH(t,e,n,i){const r=t.split(/\r?\n/),s={},o={},a=i||Cv(e)||"(unnamed)",c="".concat(function Lye(t){switch(t){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(n)," shader ").concat(a);for(let u=0;u<r.length;u++){const d=r[u];if(d.length<=1)continue;const h=d.split(":"),f=h[0],p=parseInt(h[2],10);if(isNaN(p))throw new Error("GLSL compilation error in ".concat(c,": ").concat(t));"WARNING"!==f?s[p]=d:o[p]=d}const l=function Fye(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ";const i=t.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,o)=>{const a=String(o+e);return JH(a,r-a.length)+n+s})}(e);return{shaderName:c,errors:KH(s,l),warnings:KH(o,l)}}(i,this.source,this.shaderType,this.id);throw oe.error("GLSL compilation errors in ".concat(r,"\n").concat(s))(),oe.warn("GLSL compilation warnings in ".concat(r,"\n").concat(o))(),new Error("GLSL compilation errors in ".concat(r))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class LS extends vp{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){"string"==typeof n&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class FS extends vp{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){"string"==typeof n&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const kye=5120,Uye=5121,Vye=5122,jye=5123,Rn=5126,Hye=35664,zye=35665,Gye=35666,bp=5124,Wye=35667,$ye=35668,qye=35669,Ep=5125,Xye=36294,Yye=36295,Kye=36296,Jye=35670,Zye=35671,Qye=35672,eve=35673,tve=35674,nve=35675,ive=35676,rve=35685,sve=35686,ove=35687,ave=35688,cve=35689,lve=35690,BS={[Rn]:[Rn,1,"float"],[Hye]:[Rn,2,"vec2"],[zye]:[Rn,3,"vec3"],[Gye]:[Rn,4,"vec4"],[bp]:[bp,1,"int"],[Wye]:[bp,2,"ivec2"],[$ye]:[bp,3,"ivec3"],[qye]:[bp,4,"ivec4"],[Ep]:[Ep,1,"uint"],[Xye]:[Ep,2,"uvec2"],[Yye]:[Ep,3,"uvec3"],[Kye]:[Ep,4,"uvec4"],[Jye]:[Rn,1,"bool"],[Zye]:[Rn,2,"bvec2"],[Qye]:[Rn,3,"bvec3"],[eve]:[Rn,4,"bvec4"],[tve]:[Rn,8,"mat2"],[rve]:[Rn,8,"mat2x3"],[sve]:[Rn,8,"mat2x4"],[nve]:[Rn,12,"mat3"],[ove]:[Rn,12,"mat3x2"],[ave]:[Rn,12,"mat3x4"],[ive]:[Rn,16,"mat4"],[cve]:[Rn,16,"mat4x2"],[lve]:[Rn,16,"mat4x3"]};function iz(t){const e=BS[t];if(!e)return null;const[n,i]=e;return{type:n,components:i}}function rz(t,e){switch(t){case kye:case Uye:case Vye:case jye:t=Rn}for(const n in BS){const[i,r,s]=BS[n];if(i===t&&r===e)return{glType:n,name:s}}return null}class dve{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,i=n.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=n.getActiveAttrib(e.handle,r),c=n.getAttribLocation(e.handle,s);c>=0&&this._addAttribute(c,s,o,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!He(n))return;const i=n.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=n.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,o,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,n,i,r){const{type:s,components:o}=iz(i),a={type:s,size:r*o};this._inferProperties(e,n,a);const c={location:e,name:n,accessor:new qi(a)};this.attributeInfos.push(c),this.attributeInfosByLocation[e]=c,this.attributeInfosByName[c.name]=c}_inferProperties(e,n,i){/instance/i.test(n)&&(i.divisor=1)}_addVarying(e,n,i,r){const{type:s,components:o}=iz(i),c={location:e,name:n,accessor:new qi({type:s,size:r*o})};this.varyingInfos.push(c),this.varyingInfosByName[c.name]=c}}const hve=35981,fve=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class oz extends Bo{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",fve),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hash:n,vs:i,fs:r,varyings:s,bufferMode:o=hve}=e;return this.hash=n||"",this.vs="string"==typeof i?new LS(this.gl,{id:"".concat(e.id,"-vs"),source:i}):i,this.fs="string"==typeof r?new FS(this.gl,{id:"".concat(e.id,"-fs"),source:r}):r,Q(this.vs instanceof LS),Q(this.fs instanceof FS),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(fi(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new dve(this),this.setProps(e)}delete(){return this._isCached?this:super.delete(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:i=4,vertexCount:r,offset:s=0,start:o,end:a,isIndexed:c=!1,indexType:l=5123,instanceCount:u=0,isInstanced:d=u>0,vertexArray:h=null,transformFeedback:f,framebuffer:p,parameters:g={},uniforms:m,samplers:y}=e;if((m||y)&&(oe.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(m||{})),oe.priority>=n){const v=p?p.id:"default",_="mode=".concat(ja(this.gl,i)," verts=").concat(r," ")+"instances=".concat(u," indexType=").concat(ja(this.gl,l)," ")+"isInstanced=".concat(d," isIndexed=").concat(c," ")+"Framebuffer=".concat(v);oe.log(n,_)()}return Q(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===r||d&&0===u||(h.bindForDraw(r,u,()=>{if(void 0!==p&&(g=Object.assign({},g,{framebuffer:p})),f){const v=function nz(t){switch(t){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return Q(!1),0}}(i);f.begin(v)}this._bindTextures(),Ur(this.gl,g,()=>{c&&d?this.gl2.drawElementsInstanced(i,r,l,s,u):c&&He(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(i,o,a,r,l,s):c?this.gl.drawElements(i,r,l,s):d?this.gl2.drawArraysInstanced(i,s,r,u):this.gl.drawArrays(i,s,r)}),f&&f.end()}),0))}setUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};oe.priority>=2&&function Mye(t,e,n){for(const i in t){const r=t[i];if((!n||n[i])&&!Dye(r))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(i),r),new Error("".concat(e," Bad uniform ").concat(i))}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const i=e[n],r=this._uniformSetters[n];if(r){let s=i,o=!1;if(s instanceof mn&&(s=s.texture),s instanceof rl)if(o=this.uniforms[n]!==i,o){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:c}=r;a.bind(c),s=c,this._textureUniforms[n]=a}else s=r.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(r(s)||o)&&Rye(this.uniforms,n,i)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const i=this._textureUniforms[n];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms)this._textureUniforms[e].bind(this._uniformSetters[e].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),i={};for(const r of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new LS({handle:r});break;case 35632:i.fs=new FS({handle:r})}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=$i(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),oe.time(4,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),oe.timeEnd(4,"linkProgram for ".concat(this._getName()))(),e.debug||oe.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const i=this.gl.getActiveUniform(this.handle,n),{name:r}=Iye(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=XH(e,s,i),i.size>1)for(let o=0;o<i.size;o++)s=e.getUniformLocation(this.handle,"".concat(r,"[").concat(o,"]")),this._uniformSetters["".concat(r,"[").concat(o,"]")]=XH(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}class wp{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new wp(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{vs:n="",fs:i="",defines:r={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:c=!1}=e,l=this._getModuleList(e.modules),u=this._getHash(n),d=this._getHash(i),h=l.map(_=>this._getHash(_.name)).sort(),f=o.map(_=>this._getHash(_)),p=Object.keys(r).sort(),g=Object.keys(s).sort(),m=[],y=[];for(const _ of p)m.push(this._getHash(_)),m.push(this._getHash(r[_]));for(const _ of g)y.push(this._getHash(_)),y.push(this._getHash(s[_]));const v="".concat(u,"/").concat(d,"D").concat(m.join("/"),"M").concat(h.join("/"),"I").concat(y.join("/"),"V").concat(f.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(c?"T":"");if(!this._programCache[v]){const _=function Hme(t,e){const{vs:n,fs:i}=e,r=_me(e.modules||[]);return{gl:t,vs:dH(t,Object.assign({},e,{source:n,type:hp,modules:r})),fs:dH(t,Object.assign({},e,{source:i,type:"fs",modules:r})),getUniforms:zme(r)}}(this.gl,{vs:n,fs:i,modules:l,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:c});this._programCache[v]=new oz(this.gl,{hash:v,vs:_.vs,fs:_.fs,varyings:o,bufferMode:a}),this._getUniforms[v]=_.getUniforms||(w=>{}),this._useCounts[v]=0}return this._useCounts[v]++,this._programCache[v]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,0===this._useCounts[n]&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],c=a.name;n[r++]=a,i[c]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],c=a.name;i[c]||(n[r++]=a,i[c]=!0)}return n.length=r,n}}const pve=[255,255,255],gve=1;let mve=0;class az{constructor(e={}){E(this,"id",void 0),E(this,"color",void 0),E(this,"intensity",void 0),E(this,"type","ambient");const{color:n=pve}=e,{intensity:i=gve}=e;this.id=e.id||"ambient-".concat(mve++),this.color=n,this.intensity=i}}const _ve=[255,255,255],yve=1,vve=[0,0,-1];let bve=0;class cz{constructor(e={}){E(this,"id",void 0),E(this,"color",void 0),E(this,"intensity",void 0),E(this,"type","directional"),E(this,"direction",void 0),E(this,"shadow",void 0);const{color:n=_ve}=e,{intensity:i=yve}=e,{direction:r=vve}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(bve++),this.color=n,this.intensity=i,this.type="directional",this.direction=new hi(r).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class Eve{constructor(e,n={id:"pass"}){E(this,"id",void 0),E(this,"gl",void 0),E(this,"props",void 0);const{id:i}=n;this.id=i,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class Sv extends Eve{constructor(...e){super(...e),E(this,"_lastRenderIndex",-1)}render(e){return Fo(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:i,viewports:r,views:s,onViewportActive:o,clearStack:a=!0,clearCanvas:c=!0}=e;e.pass=e.pass||"unknown";const l=this.gl;c&&function Ave(t){Fo(t,{viewport:[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}),t.clear(16640)}(l),a&&(this._lastRenderIndex=-1);const u=[];for(const d of r){const h=s&&s[d.id];o(d);const f=this._getDrawLayerParams(d,e),p=d.subViewports||[d];for(const g of p){const m=this._drawLayersInViewport(l,{target:n,moduleParameters:i,viewport:g,view:h,pass:e.pass,layers:e.layers},f);u.push(m)}}return u}_getDrawLayerParams(e,{layers:n,pass:i,layerFilter:r,cullRect:s,effects:o,moduleParameters:a}){const c=[],l=lz(this._lastRenderIndex+1),u={layer:n[0],viewport:e,isPicking:i.startsWith("picking"),renderPass:i,cullRect:s},d={};for(let h=0;h<n.length;h++){const f=n[h],p=this._shouldDrawLayer(f,u,r,d),g={shouldDrawLayer:p};p&&(g.layerRenderIndex=l(f,p),g.moduleParameters=this._getModuleParameters(f,o,i,a),g.layerParameters=this.getLayerParameters(f,h,e)),c[h]=g}return c}_drawLayersInViewport(e,{layers:n,moduleParameters:i,pass:r,target:s,viewport:o,view:a},c){const l=function wve(t,{moduleParameters:e,target:n,viewport:i}){const r=n&&"default-framebuffer"!==n.id,s=e&&e.devicePixelRatio||cd(t);return[i.x*s,(r?n.height:t.drawingBufferHeight)-(i.y+i.height)*s,i.width*s,i.height*s]}(e,{moduleParameters:i,target:s,viewport:o});if(a&&a.props.clear){const d=!0===a.props.clear?{color:!0,depth:!0}:a.props.clear;Ur(e,{scissorTest:!0,scissor:l},()=>DS(e,d))}const u={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};Fo(e,{viewport:l});for(let d=0;d<n.length;d++){const h=n[d],{shouldDrawLayer:f,layerRenderIndex:p,moduleParameters:g,layerParameters:m}=c[d];if(f&&h.props.pickable&&u.pickableCount++,h.isComposite)u.compositeCount++;else if(f){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,p),g.viewport=o;try{h._drawLayer({moduleParameters:g,uniforms:{layerIndex:p},parameters:m})}catch(y){h.raiseError(y,"drawing ".concat(h," to ").concat(r))}}}return u}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,i){return e.props.parameters}_shouldDrawLayer(e,n,i,r){if(!e.props.visible||!this.shouldDrawLayer(e))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(i){const a=n.layer.id;if(a in r||(r[a]=i(n)),!r[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,i,r){var s;const o=Object.assign(Object.create((null===(s=e.internalState)||void 0===s?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:cd(this.gl)});if(n)for(const c of n){var a;Object.assign(o,null===(a=c.getModuleParameters)||void 0===a?void 0:a.call(c,e))}return Object.assign(o,this.getModuleParameters(e,n),r)}}function lz(t=0,e={}){const n={},i=(r,s)=>{const o=r.props._offset,a=r.id,c=r.parent&&r.parent.id;let l;if(c&&!(c in e)&&i(r.parent,!1),c in n){const u=n[c]=n[c]||lz(e[c],e);l=u(r,s),n[a]=u}else Number.isFinite(o)?(l=o+(e[c]||0),n[a]=null):l=t;return s&&l>=t&&(t=l+1),e[a]=l,l};return i}class Cve extends Sv{constructor(e,n){super(e,n),E(this,"shadowMap",void 0),E(this,"depthBuffer",void 0),E(this,"fbo",void 0),this.shadowMap=new Jn(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new dd(e,{format:33189,width:1,height:1}),this.fbo=new mn(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;Ur(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=cd(this.gl),s=i.width*r,o=i.height*r;(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const uz="#define SMOOTH_EDGE_RADIUS 0.5",Ive={name:"geometry",vs:"\n".concat(uz,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(uz,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")},Mve=Object.keys(Qe).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Qe[t],";")).join(""),Dve=Object.keys(qs).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(qs[t],";")).join(""),Rve=Object.keys(pv).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(pv[t],";")).join(""),Ove="".concat(Mve,"\n").concat(Dve,"\n").concat(Rve,'\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0; // meters\nconst float GLOBE_RADIUS = 256.0;\n\n// returns an adjustment factor for uCommonUnitsPerMeter\nfloat project_size_at_latitude(float lat) {\n  float y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n\n    // uCommonUnitsPerMeter in low-zoom Web Mercator is non-linear\n    // Adjust by 1 / cos(latitude)\n    // If geometry.position (vertex in common space) is populated, use it\n    // Otherwise use geometry.worldPosition (anchor in world space)\n    \n    if (geometry.position.w == 0.0) {\n      return project_size_at_latitude(geometry.worldPosition.y);\n    }\n\n    // latitude from common y: 2.0 * (atan(exp(y / TILE_SIZE * 2.0 * PI - PI)) - PI / 4.0)\n    // Taylor series of 1 / cos(latitude)\n    // Max error < 0.003\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\nfloat project_size_at_latitude(float meters, float lat) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\n\n//\n// Scaling offsets - scales meters to "world distance"\n// Note the scalar version of project_size is for scaling the z component only\n//\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\n\n// Get rotation matrix that aligns the z axis with the given up vector\n// Find 3 unit vectors ux, uy, uz that are perpendicular to each other and uz == up\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  // Tangent on XY plane\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n\n//\n// Projecting normal - transform deltas from current coordinate system to\n// normals in the worldspace\n//\nvec3 project_normal(vec3 vector) {\n  // Apply model matrix\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\n\n//\n// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]\n//\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\n\n//\n// Projects positions (defined by project_uCoordinateSystem) to common space (defined by project_uProjectionMode)\n//\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n\n  // Work around for a Mac+NVIDIA bug https://github.com/visgl/deck.gl/issues/4145\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size_at_latitude(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        // Too far from the projection center for offset mode to be accurate\n        // Only use high parts\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n\n  // Translation is already added to the high parts\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\n\n//\n// Projects from common space coordinates to clip space.\n// Uses project_uViewProjectionMatrix\n//\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\n\n// Returns a clip space offset that corresponds to a given number of screen pixels\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  // UNIT_PIXELS\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n');function Pve(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}function xv(t){let n,e={};return i=>{for(const r in i)if(!Pve(i[r],e[r])){n=t(i),e=i;break}return n}}const dz=[0,0,0,0],Nve=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],hz=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Lve=[0,0,0],fz=[0,0,0],Fve=xv(function Uve({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:c,geospatialOrigin:l}=function Bve(t,e,n){const{viewMatrixUncentered:i,projectionMatrix:r}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=dz,c=dz,l=t.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:d,offsetMode:h}=pz(t,e,n);return h&&(c=t.projectPosition(u||d),l=[l[0]-c[0],l[1]-c[1],l[2]-c[2]],c[3]=1,a=zf([],c,o),s=i||s,o=zc([],r,s),o=zc([],o,Nve)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:c,cameraPosCommon:l,shaderCoordinateOrigin:d,geospatialOrigin:u}}(t,n,i),u=t.getDistanceScales(),d=[t.width*e,t.height*e],h=zf([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,f={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:c,project_uCommonOrigin:o.slice(0,3),project_uCenter:r,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:d,project_uDevicePixelRatio:e,project_uFocalDistance:h,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Lve,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:hz,project_uCameraPosition:a};if(l){const p=t.getDistanceScales(l);switch(n){case Qe.METER_OFFSETS:f.project_uCommonUnitsPerWorldUnit=p.unitsPerMeter,f.project_uCommonUnitsPerWorldUnit2=p.unitsPerMeter2;break;case Qe.LNGLAT:case Qe.LNGLAT_OFFSETS:t._pseudoMeters||(f.project_uCommonUnitsPerMeter=p.unitsPerMeter),f.project_uCommonUnitsPerWorldUnit=p.unitsPerDegree,f.project_uCommonUnitsPerWorldUnit2=p.unitsPerDegree2;break;case Qe.CARTESIAN:f.project_uCommonUnitsPerWorldUnit=[1,1,p.unitsPerMeter[2]],f.project_uCommonUnitsPerWorldUnit2=[0,0,p.unitsPerMeter2[2]]}}return f});function pz(t,e,n=fz){n.length<3&&(n=[n[0],n[1],0]);let r,i=n,s=!0;switch(r=e===Qe.LNGLAT_OFFSETS||e===Qe.METER_OFFSETS?n:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case qs.WEB_MERCATOR:(e===Qe.LNGLAT||e===Qe.CARTESIAN)&&(r=[0,0,0],s=!1);break;case qs.WEB_MERCATOR_AUTO_OFFSET:e===Qe.LNGLAT?i=r:e===Qe.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],r=t.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case qs.IDENTITY:i=t.position.map(Math.fround),i[2]=i[2]||0;break;case qs.GLOBE:s=!1,r=null;break;default:s=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}const Vve={},kS={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null},Ive],vs:Ove,getUniforms:function jve(t=Vve){return"viewport"in t?function kve({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=Qe.DEFAULT,coordinateOrigin:r=fz,autoWrapLongitude:s=!1}){i===Qe.DEFAULT&&(i=t.isGeospatial?Qe.LNGLAT:Qe.CARTESIAN);const o=Fve({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return o.project_uWrapLongitude=s,o.project_uModelMatrix=n||hz,o}(t):{}}},Gve=xv(function Yve({viewport:t,center:e}){return new Le(t.viewProjectionMatrix).invert().transform(e)}),Wve=xv(function Kve({viewport:t,shadowMatrices:e}){const n=[],i=t.pixelUnprojectionMatrix,r=t.isGeospatial?void 0:1,s=[[0,0,r],[t.width,0,r],[0,t.height,r],[t.width,t.height,r],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>function Xve(t,e){const[n,i,r]=t,s=lp([n,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}(o,i));for(const o of e){const a=o.clone().translate(new hi(t.center).negate()),c=s.map(u=>a.transform(u)),l=(new Le).ortho({left:Math.min(...c.map(u=>u[0])),right:Math.max(...c.map(u=>u[0])),bottom:Math.min(...c.map(u=>u[1])),top:Math.max(...c.map(u=>u[1])),near:Math.min(...c.map(u=>-u[2])),far:Math.max(...c.map(u=>-u[2]))});n.push(l.multiplyRight(o))}return n}),$ve=[0,0,0,1],qve=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],US={name:"shadow",dependencies:[kS],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?function Jve(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||$ve,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=Gve({viewport:t.viewport,center:e.project_uCenter}),s=[],o=Wve({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const c=o[a],l=c.clone().translate(new hi(t.viewport.center).negate());e.project_uCoordinateSystem===Qe.LNGLAT&&e.project_uProjectionMode===qs.WEB_MERCATOR?(o[a]=l,s[a]=r):(o[a]=c.clone().multiplyRight(qve),s[a]=l.transform(r))}for(let a=0;a<o.length;a++)i["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],i["shadow_uProjectCenters[".concat(a,"]")]=s[a],i["shadow_uShadowMap".concat(a)]=t.shadowMaps&&t.shadowMaps.length>0?t.shadowMaps[a]:t.dummyShadowMap;return i}(t,e):{}},Zve={color:[255,255,255],intensity:1},gz=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Qve=[0,0,0,200/255];class VS{constructor(e={}){E(this,"id","lighting-effect"),E(this,"props",null),E(this,"shadowColor",Qve),E(this,"shadow",void 0),E(this,"ambientLight",null),E(this,"directionalLights",[]),E(this,"pointLights",[]),E(this,"shadowPasses",[]),E(this,"shadowMaps",[]),E(this,"dummyShadowMap",null),E(this,"programManager",void 0),E(this,"shadowMatrices",void 0);for(const n in e){const i=e[n];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow)}preRender(e,{layers:n,layerFilter:i,viewports:r,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=wp.getDefaultProgramManager(e),US&&this.programManager.addDefaultModule(US)),this.dummyShadowMap||(this.dummyShadowMap=new Jn(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:i,viewports:r,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(US),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const i=(new Le).lookAt({eye:new hi(n.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const i=new Cve(e);this.shadowPasses[n]=i,this.shadowMaps[n]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:i}=this;!e&&0===n.length&&0===i.length&&(this.ambientLight=new az(Zve),this.directionalLights.push(new cz(gz[0]),new cz(gz[1])))}}let ebe=1,tbe=1;class mz{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,o=ebe++,a={time:0,delay:n,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,i]of this.animations)i.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return void 0!==n&&this.time>=n.delay+n.duration*n.repeat}getTime(e){if(void 0===e)return this.time;const n=this.channels.get(e);return void 0===n?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const r of n)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:o}=r;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const i=tbe++;return this.animations.set(i,{animation:e,channel:n}),e.setTime(this.getTime(n)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const i=n-e.delay;i>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}const Iv=Symbol.for("component"),gd=Symbol.for("asyncPropDefaults"),ol=Symbol.for("asyncPropOriginal"),za=Symbol.for("asyncPropResolved");let jS={};function gi(t,e,n,i){$e.level>0&&jS[t]&&jS[t].call(null,e,n,i)}function HS(t,e=()=>!0){return Array.isArray(t)?_z(t,e,[]):e(t)?[t]:[]}function _z(t,e,n){let i=-1;for(;++i<t.length;){const r=t[i];Array.isArray(r)?_z(r,e,n):e(r)&&n.push(r)}return n}function ibe({target:t,source:e,start:n=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=n;o<r;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}const ds=t=>"function"==typeof t,Ga=t=>null!==t&&"object"==typeof t,vz=t=>Ga(t)&&t.constructor==={}.constructor,rbe=t=>t&&"function"==typeof t[Symbol.iterator],sbe=t=>t&&"function"==typeof t[Symbol.asyncIterator],md=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,_d=t=>typeof Blob<"u"&&t instanceof Blob,obe=t=>t&&"object"==typeof t&&t.isBuffer,bz=t=>(t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Ga(t)&&ds(t.tee)&&ds(t.cancel)&&ds(t.getReader))(t)||(t=>Ga(t)&&ds(t.read)&&ds(t.pipe)&&(t=>"boolean"==typeof t)(t.readable))(t);function Ez(t,e){if(!t)throw new Error(e||"loader assertion failed.")}function zS(t){var e;return!!t&&(Array.isArray(t)&&(t=t[0]),Array.isArray(null===(e=t)||void 0===e?void 0:e.extensions))}function GS(t){var e,n;let i;return Ez(t,"null loader"),Ez(zS(t),"invalid loader"),Array.isArray(t)&&(i=t[1],t=t[0],t={...t,options:{...t.options,...i}}),(null!==(e=t)&&void 0!==e&&e.parseTextSync||null!==(n=t)&&void 0!==n&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}let WS="";const $S={},hbe=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,fbe=/^([-\w.]+\/[-\w.+]+)/;function pbe(t){const e=fbe.exec(t);return e?e[1]:t}function wz(t){const e=hbe.exec(t);return e?e[1]:""}const gbe=/\?.*/;function Mv(t){if(md(t)){const e=qS(t.url||"");return{url:e,type:pbe(t.headers.get("content-type")||"")||wz(e)}}return _d(t)?{url:qS(t.name||""),type:t.type||""}:"string"==typeof t?{url:qS(t),type:wz(t)}:{url:"",type:""}}function qS(t){return t.replace(gbe,"")}function Az(t){return XS.apply(this,arguments)}function XS(){return XS=ee(function*(t){if(md(t))return t;const e={},n=function mbe(t){return md(t)?t.headers["content-length"]||-1:_d(t)?t.size:"string"==typeof t?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}(t);n>=0&&(e["content-length"]=String(n));const{url:i,type:r}=Mv(t);r&&(e["content-type"]=r);const s=yield function vbe(t){return JS.apply(this,arguments)}(t);s&&(e["x-first-bytes"]=s),"string"==typeof t&&(t=(new TextEncoder).encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:i}),o}),XS.apply(this,arguments)}function YS(){return YS=ee(function*(t){if(!t.ok){const e=yield function ybe(t){return KS.apply(this,arguments)}(t);throw new Error(e)}}),YS.apply(this,arguments)}function KS(){return KS=ee(function*(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let i=t.statusText;n.includes("application/json")&&(i+=" ".concat(yield t.text())),e+=i,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}),KS.apply(this,arguments)}function JS(){return JS=ee(function*(t){if("string"==typeof t)return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return yield new Promise(i=>{const r=new FileReader;r.onload=s=>{var o;return i(null==s||null===(o=s.target)||void 0===o?void 0:o.result)},r.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const i=function bbe(t){let e="";const n=new Uint8Array(t);for(let i=0;i<n.byteLength;i++)e+=String.fromCharCode(n[i]);return btoa(e)}(t.slice(0,5));return"data:base64,".concat(i)}return null}),JS.apply(this,arguments)}function Cz(t,e){return ZS.apply(this,arguments)}function ZS(){return ZS=ee(function*(t,e){if("string"==typeof t){t=function dbe(t){for(const e in $S)t.startsWith(e)&&(t=t.replace(e,$S[e]));return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(WS).concat(t)),t}(t);let n=e;return null!=e&&e.fetch&&"function"!=typeof e?.fetch&&(n=e.fetch),yield fetch(t,n)}return yield Az(t)}),ZS.apply(this,arguments)}const Tz=new sp({id:"loaders.gl"});class Ebe{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}typeof self<"u"&&self,typeof window<"u"&&window,typeof global<"u"&&global,typeof document<"u"&&document;const Sz=!("object"==typeof process&&"[object process]"===String(process)&&!process.browser),xz=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),Iz=(xz&&parseFloat(xz[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class wbe{constructor(){E(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Sz,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),Abe={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function QS(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const ex=()=>{const t=QS();return t.globalOptions=t.globalOptions||{...Iz},t.globalOptions};function Cbe(t,e,n,i){return n=n||[],function Tbe(t,e){Dz(t,null,Iz,Abe,e);for(const n of e)Dz(t&&t[n.id]||{},n.id,n.options&&n.options[n.id]||{},n.deprecatedOptions&&n.deprecatedOptions[n.id]||{},e)}(t,n=Array.isArray(n)?n:[n]),function Rz(t,e,n){const r={...t.options||{}};return function xbe(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}(r,n),null===r.log&&(r.log=new Ebe),Oz(r,ex()),Oz(r,e),r}(e,t,i)}function Mz(t,e){const n=ex(),i=t||n;return"function"==typeof i.fetch?i.fetch:Ga(i.fetch)?r=>Cz(r,i):null!=e&&e.fetch?e?.fetch:Cz}function Dz(t,e,n,i,r){const s=e||"Top level",o=e?"".concat(e,"."):"";for(const a in t){const c=!e&&Ga(t[a]);if(!(a in n)&&("baseUri"!==a||e)&&("workerUrl"!==a||!e))if(a in i)Tz.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(i[a],"'"))();else if(!c){const d=Sbe(a,r);Tz.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(d))()}}}function Sbe(t,e){const n=t.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(t===s)return"Did you mean '".concat(r.id,".").concat(s,"'?");const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(i=i||"Did you mean '".concat(r.id,".").concat(s,"'?"))}return i}function Oz(t,e){for(const n in e)n in e&&(t[n]=vz(e[n])&&vz(t[n])?{...t[n],...e[n]}:e[n])}function Ks(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Js={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},Dbe=Js.global||Js.self||Js.window||{},Wa="object"!=typeof process||"[object process]"!==String(process)||process.browser,tx="function"==typeof importScripts,Rbe=typeof window<"u"&&typeof window.orientation<"u",Pz=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Pz&&parseFloat(Pz[1]);class nx{}const ix=new Map;function Nz(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Lz(t,e=!0,n){const i=n||new Set;if(t)if(Fz(t))i.add(t);else if(Fz(t.buffer))i.add(t.buffer);else if(!ArrayBuffer.isView(t)&&e&&"object"==typeof t)for(const r in t)Lz(t[r],e,i);return void 0===n?Array.from(i):[]}function Fz(t){return!!t&&(t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)}const rx=()=>{};class sx{static isSupported(){return typeof Worker<"u"&&Wa||typeof nx<"u"&&!Wa}constructor(e){E(this,"name",void 0),E(this,"source",void 0),E(this,"url",void 0),E(this,"terminated",!1),E(this,"worker",void 0),E(this,"onMessage",void 0),E(this,"onError",void 0),E(this,"_loadableURL","");const{name:n,source:i,url:r}=e;Ks(i||r),this.name=n,this.source=i,this.url=r,this.onMessage=rx,this.onError=s=>console.log(s),this.worker=Wa?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=rx,this.onError=rx,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||Lz(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=function Obe(t){Ks(t.source&&!t.url||!t.source&&t.url);let e=ix.get(t.source||t.url);return e||(t.url&&(e=function Pbe(t){if(!t.startsWith("http"))return t;const e=function Nbe(t){return"try {\n  importScripts('".concat(t,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")}(t);return Nz(e)}(t.url),ix.set(t.url,e)),t.source&&(e=Nz(t.source),ix.set(t.source,e))),Ks(e),e}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const i=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new nx(i,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new nx(this.source,{eval:!0})}return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class Fbe{constructor(e,n){E(this,"name",void 0),E(this,"workerThread",void 0),E(this,"isRunning",!0),E(this,"result",void 0),E(this,"_resolve",()=>{}),E(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){Ks(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Ks(this.isRunning),this.isRunning=!1,this._reject(e)}}class Bbe{static isSupported(){return sx.isSupported()}constructor(e){E(this,"name","unnamed"),E(this,"source",void 0),E(this,"url",void 0),E(this,"maxConcurrency",1),E(this,"maxMobileConcurrency",1),E(this,"onDebug",()=>{}),E(this,"reuseWorkers",!0),E(this,"props",{}),E(this,"jobQueue",[]),E(this,"idleQueue",[]),E(this,"count",0),E(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}startJob(e,n=(r,s,o)=>r.done(o),i=(r,s)=>r.error(s)){var r=this;return ee(function*(){const s=new Promise(o=>(r.jobQueue.push({name:e,onMessage:n,onError:i,onStart:o}),r));return r._startQueuedJob(),yield s})()}_startQueuedJob(){var e=this;return ee(function*(){if(!e.jobQueue.length)return;const n=e._getAvailableWorker();if(!n)return;const i=e.jobQueue.shift();if(i){e.onDebug({message:"Starting job",name:i.name,workerThread:n,backlog:e.jobQueue.length});const r=new Fbe(i.name,n);n.onMessage=s=>i.onMessage(r,s.type,s.payload),n.onError=s=>i.onError(r,s),i.onStart(r);try{yield r.result}finally{e.returnWorkerToQueue(n)}}})()}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new sx({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Rbe?this.maxMobileConcurrency:this.maxConcurrency}}const kbe={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Uo{static isSupported(){return sx.isSupported()}static getWorkerFarm(e={}){return Uo._workerFarm=Uo._workerFarm||new Uo({}),Uo._workerFarm.setProps(e),Uo._workerFarm}constructor(e){E(this,"props",void 0),E(this,"workerPools",new Map),this.props={...kbe},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:i,url:r}=e;let s=this.workerPools.get(n);return s||(s=new Bbe({name:n,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}E(Uo,"_workerFarm",void 0);const Ube="latest";function ox(){return ox=ee(function*(t,e,n,i,r){const s=t.id,o=function Vbe(t,e={}){const n=e[t.id]||{},i="".concat(t.id,"-worker.js");let r=n.workerUrl;if(!r&&"compression"===t.id&&(r=e.workerUrl),"test"===e._workerType&&(r="modules/".concat(t.module,"/dist/").concat(i)),!r){let s=t.version;"latest"===s&&(s=Ube);const o=s?"@".concat(s):"";r="https://unpkg.com/@loaders.gl/".concat(t.module).concat(o,"/dist/").concat(i)}return Ks(r),r}(t,n),c=Uo.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),i=JSON.parse(JSON.stringify(i||{}));const l=yield c.startJob("process-on-worker",zbe.bind(null,r));return l.postMessage("process",{input:e,options:n,context:i}),yield(yield l.result).result}),ox.apply(this,arguments)}function zbe(t,e,n,i){return ax.apply(this,arguments)}function ax(){return ax=ee(function*(t,e,n,i){switch(n){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:r,input:s,options:o}=i;try{const a=yield t(s,o);e.postMessage("done",{id:r,result:a})}catch(a){const c=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:c})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}),ax.apply(this,arguments)}function cx(t){var e,n,i,r=2;for(typeof Symbol<"u"&&(n=Symbol.asyncIterator,i=Symbol.iterator);r--;){if(n&&null!=(e=t[n]))return e.call(t);if(i&&null!=(e=t[i]))return new Dv(e.call(t));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}function Dv(t){function e(n){if(Object(n)!==n)return Promise.reject(new TypeError(n+" is not an object."));var i=n.done;return Promise.resolve(n.value).then(function(r){return{value:r,done:i}})}return(Dv=function(i){this.s=i,this.n=i.next}).prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(i){var r=this.s.return;return void 0===r?Promise.resolve({value:i,done:!0}):e(r.apply(this.s,arguments))},throw:function(i){var r=this.s.return;return void 0===r?Promise.reject(i):e(r.apply(this.s,arguments))}},new Dv(t)}function kz(t){return t&&"object"==typeof t&&t.isBuffer}function Uz(t){if(kz(t))return function Gbe(t){return kz(t)?new Uint8Array(t.buffer,t.byteOffset,t.length).slice().buffer:t}(t);if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if("string"==typeof t){const e=t;return(new TextEncoder).encode(e).buffer}if(t&&"object"==typeof t&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function ux(){return ux=ee(function*(t){const e=[];var r,n=!1,i=!1;try{for(var o,s=cx(t);n=!(o=yield s.next()).done;n=!1)e.push(o.value)}catch(a){i=!0,r=a}finally{try{n&&null!=s.return&&(yield s.return())}finally{if(i)throw r}}return function $be(...t){const e=t.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),n=e.reduce((s,o)=>s+o.byteLength,0),i=new Uint8Array(n);let r=0;for(const s of e)i.set(s,r),r+=s.byteLength;return i.buffer}(...e)}),ux.apply(this,arguments)}qe(492);const Xbe=262144,Kbe=262144;function Vz(t,e){this.v=t,this.k=e}function Rv(t){return new Vz(t,0)}function hx(t){return function(){return new Ap(t.apply(this,arguments))}}function Ap(t){var e,n;function i(s,o){try{var a=t[s](o),c=a.value,l=c instanceof Vz;Promise.resolve(l?c.v:c).then(function(u){if(l){var d="return"===s?"return":"next";if(!c.k||u.done)return i(d,u);u=t[d](u).value}r(a.done?"return":"normal",u)},function(u){i("throw",u)})}catch(u){r("throw",u)}}function r(s,o){switch(s){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?i(e.key,e.arg):n=null}this._invoke=function(s,o){return new Promise(function(a,c){var l={key:s,arg:o,resolve:a,reject:c,next:null};n?n=n.next=l:(e=n=l,i(s,o))})},"function"!=typeof t.return&&(this.return=void 0)}Ap.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Ap.prototype.next=function(t){return this._invoke("next",t)},Ap.prototype.throw=function(t){return this._invoke("throw",t)},Ap.prototype.return=function(t){return this._invoke("return",t)};const Zbe=1048576;function fx(){return fx=hx(function*(t,e){const n=e?.chunkSize||Zbe;let i=0;for(;i<t.size;){const r=i+n,s=yield Rv(t.slice(i,r).arrayBuffer());i=r,yield s}}),fx.apply(this,arguments)}function jz(t,e){return Sz?function e0e(t,e){return px.apply(this,arguments)}(t,e):function t0e(t,e){return gx.apply(this,arguments)}(t,e)}function px(){return px=hx(function*(t,e){const n=t.getReader();let i;try{for(;;){const r=i||n.read();null!=e&&e._streamReadAhead&&(i=n.read());const{done:s,value:o}=yield Rv(r);if(s)return;yield Uz(o)}}catch{n.releaseLock()}}),px.apply(this,arguments)}function gx(){return gx=hx(function*(t,e){var r,n=!1,i=!1;try{for(var o,s=cx(t);n=!(o=yield Rv(s.next())).done;n=!1){const a=o.value;yield Uz(a)}}catch(a){i=!0,r=a}finally{try{n&&null!=s.return&&(yield Rv(s.return()))}finally{if(i)throw r}}}),gx.apply(this,arguments)}const mx="Cannot convert supplied data type";function _x(){return _x=ee(function*(t,e,n){const i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if("string"==typeof t||i)return function i0e(t,e){if(e.text&&"string"==typeof t)return t;if(obe(t)&&(t=t.buffer),t instanceof ArrayBuffer){const i=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let i=t.buffer;const r=t.byteLength||t.length;return(0!==t.byteOffset||r!==i.byteLength)&&(i=i.slice(t.byteOffset,t.byteOffset+r)),i}throw new Error(mx)}(t,e);if(_d(t)&&(t=yield Az(t)),md(t)){const r=t;return yield function _be(t){return YS.apply(this,arguments)}(r),e.binary?yield r.arrayBuffer():yield r.text()}if(bz(t)&&(t=function n0e(t,e){if("string"==typeof t)return function*Ybe(t,e){const n=e?.chunkSize||Xbe;let i=0;const r=new TextEncoder;for(;i<t.length;){const s=Math.min(t.length-i,n),o=t.slice(i,i+s);i+=s,yield r.encode(o)}}(t,e);if(t instanceof ArrayBuffer)return function*Jbe(t,e={}){const{chunkSize:n=Kbe}=e;let i=0;for(;i<t.byteLength;){const r=Math.min(t.byteLength-i,n),s=new ArrayBuffer(r),o=new Uint8Array(t,i,r);new Uint8Array(s).set(o),i+=r,yield s}}(t,e);if(_d(t))return function Qbe(t,e){return fx.apply(this,arguments)}(t,e);if(bz(t))return jz(t,e);if(md(t))return jz(t.body,e);throw new Error("makeIterator")}(t,n)),rbe(t)||sbe(t))return function qbe(t){return ux.apply(this,arguments)}(t);throw new Error(mx)}),_x.apply(this,arguments)}const l0e=new sp({id:"loaders.gl"}),Hz=()=>{const t=QS();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function zz(t){const e=Hz();t=Array.isArray(t)?t:[t];for(const n of t){const i=GS(n);e.find(r=>i===r)||e.unshift(i)}}const d0e=/\.([^.]+)$/;function bx(){return bx=ee(function*(t,e=[],n,i){if(!Wz(t))return null;let r=Gz(t,e,{...n,nothrow:!0},i);if(r)return r;if(_d(t)&&(r=Gz(t=yield t.slice(0,10).arrayBuffer(),e,n,i)),!(r||null!=n&&n.nothrow))throw new Error($z(t));return r}),bx.apply(this,arguments)}function Gz(t,e=[],n,i){if(!Wz(t))return null;if(e&&!Array.isArray(e))return GS(e);let r=[];e&&(r=r.concat(e)),null!=n&&n.ignoreRegisteredLoaders||r.push(...function u0e(){return Hz()}()),function p0e(t){for(const e of t)GS(e)}(r);const s=function f0e(t,e,n,i){const{url:r,type:s}=Mv(t),o=r||i?.url;let a=null,c="";var l;return null!=n&&n.mimeType&&(a=Ex(e,n?.mimeType),c="match forced by supplied MIME type ".concat(n?.mimeType)),a=a||function g0e(t,e){const n=e&&d0e.exec(e),i=n&&n[1];return i?function m0e(t,e){e=e.toLowerCase();for(const n of t)for(const i of n.extensions)if(i.toLowerCase()===e)return n;return null}(t,i):null}(e,o),c=c||(a?"matched url ".concat(o):""),a=a||Ex(e,s),c=c||(a?"matched MIME type ".concat(s):""),a=a||function _0e(t,e){if(!e)return null;for(const n of t)if("string"==typeof e){if(y0e(e,n))return n}else if(ArrayBuffer.isView(e)){if(qz(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&qz(e,0,n))return n;return null}(e,t),c=c||(a?"matched initial data ".concat(Xz(t)):""),a=a||Ex(e,n?.fallbackMimeType),c=c||(a?"matched fallback MIME type ".concat(s):""),c&&l0e.log(1,"selectLoader selected ".concat(null===(l=a)||void 0===l?void 0:l.name,": ").concat(c,".")),a}(t,r,n,i);if(!(s||null!=n&&n.nothrow))throw new Error($z(t));return s}function Wz(t){return!(t instanceof Response&&204===t.status)}function $z(t){const{url:e,type:n}=Mv(t);let i="No valid loader found (";i+=e?"".concat(function c0e(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(e+1):""}(e),", "):"no url provided, ",i+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const r=t?Xz(t):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function Ex(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function y0e(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>t.startsWith(i))}function qz(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(r=>function v0e(t,e,n,i){if(i instanceof ArrayBuffer)return function Wbe(t,e,n){if(t.byteLength<(n=n||t.byteLength)||e.byteLength<n)return!1;const i=new Uint8Array(t),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(i,t,i.byteLength);switch(typeof i){case"function":return i(t,n);case"string":return i===wx(t,e,i.length);default:return!1}}(t,e,n,r))}function Xz(t,e=5){return"string"==typeof t?t.slice(0,e):ArrayBuffer.isView(t)?wx(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?wx(t,0,e):""}function wx(t,e,n){if(t.byteLength<e+n)return"";const i=new DataView(t);let r="";for(let s=0;s<n;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function Ov(t,e,n,i){return Ax.apply(this,arguments)}function Ax(){return Ax=ee(function*(t,e,n,i){Ks(!i||"object"==typeof i),e&&!Array.isArray(e)&&!zS(e)&&(i=void 0,n=e,e=void 0),t=yield t,n=n||{};const{url:r}=Mv(t),o=function a0e(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...i]:i}return n&&n.length?n:null}(e,i),a=yield function h0e(t){return bx.apply(this,arguments)}(t,o,n);return a?(i=function o0e(t,e,n=null){if(n)return n;const i={fetch:Mz(e,t),...t};return Array.isArray(i.loaders)||(i.loaders=null),i}({url:r,parse:Ov,loaders:o},n=Cbe(n,a,o,r),i),yield function b0e(t,e,n,i){return Cx.apply(this,arguments)}(a,t,n,i)):null}),Ax.apply(this,arguments)}function Cx(){return Cx=ee(function*(t,e,n,i){if(function Mbe(t){Ks(t,"no worker provided")}(t),md(e)){const r=e,{ok:s,redirected:o,status:a,statusText:c,type:l,url:u}=r,d=Object.fromEntries(r.headers.entries());i.response={headers:d,ok:s,redirected:o,status:a,statusText:c,type:l,url:u}}if(e=yield function r0e(t,e,n){return _x.apply(this,arguments)}(e,t,n),t.parseTextSync&&"string"==typeof e)return n.dataType="text",t.parseTextSync(e,n,i,t);if(function jbe(t,e){return!(!Uo.isSupported()||!(Wa||null!=e&&e._nodeWorkers))&&t.worker&&e?.worker}(t,n))return yield function Hbe(t,e,n,i,r){return ox.apply(this,arguments)}(t,e,n,i,Ov);if(t.parseText&&"string"==typeof e)return yield t.parseText(e,n,i,t);if(t.parse)return yield t.parse(e,n,i,t);throw Ks(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}),Cx.apply(this,arguments)}function Cp(t,e,n,i){return Tx.apply(this,arguments)}function Tx(){return Tx=ee(function*(t,e,n,i){!Array.isArray(e)&&!zS(e)&&(n=e,e=void 0);const r=Mz(n);let s=t;return"string"==typeof t&&(s=yield r(t)),_d(t)&&(s=yield r(t)),yield Ov(s,e,n)}),Tx.apply(this,arguments)}class E0e{constructor(e,n,i){E(this,"id",void 0),E(this,"context",void 0),E(this,"isLoaded",void 0),E(this,"persistent",void 0),E(this,"_loadCount",0),E(this,"_subscribers",new Set),E(this,"_data",void 0),E(this,"_loader",void 0),E(this,"_error",void 0),E(this,"_content",void 0),this.id=e,this.context=i,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const i=++this._loadCount;let r=e;"string"==typeof e&&(r=Cp(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class w0e{constructor({gl:e,protocol:n}){E(this,"protocol",void 0),E(this,"_context",void 0),E(this,"_resources",void 0),E(this,"_consumers",void 0),E(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:n,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(n,i):(s=new E0e(e,n,this._context),this._resources[e]=s),s.persistent=r}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const i in n){const r=n[i],s=this._resources[r.resourceId];s&&s.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(s[e=e.replace(o,"")]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,i,r){const s=this._consumers,o=s[e]=s[e]||{},a=o[n]||{},c=a.resourceId&&this._resources[a.resourceId];c&&(c.unsubscribe(a),this.prune()),i&&(o[n]=a,a.onChange=r,a.resourceId=i.id,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const A0e=[kS],C0e=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function T0e(t){const e=wp.getDefaultProgramManager(t);for(const n of A0e)e.addDefaultModule(n);for(const n of C0e)e.addShaderHook(n);return e}class I0e{constructor(e,{deck:n,stats:i,viewport:r,timeline:s}={}){E(this,"layers",void 0),E(this,"context",void 0),E(this,"resourceManager",void 0),E(this,"_lastRenderedLayers",[]),E(this,"_needsRedraw",!1),E(this,"_needsUpdate",!1),E(this,"_nextLayers",null),E(this,"_debug",!1),E(this,"activateViewport",o=>{gi("layerManager.activateViewport",this,o),o&&(this.context.viewport=o)}),this.layers=[],this.resourceManager=new w0e({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&T0e(e),stats:i||new AS({id:"deck.gl"}),viewport:r||new Fa({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new mz,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);n=n||r}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(i=>0===n.id.indexOf(i))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){gi("layerManager.setLayers",this,n,e),this._lastRenderedLayers=e;const i=HS(e,Boolean);for(const r of i)r.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,i){i.raiseError(n,"".concat(e," of ").concat(i))}_updateLayers(e,n){const i={};for(const o of e)i[o.id]?$e.warn("Multiple old layers with same id ".concat(o.id))():i[o.id]=o;const r=[];this._updateSublayersRecursively(n,i,r),this._finalizeOldLayers(i);let s=!1;for(const o of r)if(o.hasUniformTransition()){s="Uniform transition in ".concat(o);break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,n,i){for(const r of e){r.context=this.context;const s=n[r.id];null===s&&$e.warn("Multiple new layers with same id ".concat(r.id))(),n[r.id]=null;let o=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),o=r.isComposite?r.getSubLayers():null}catch(a){this._handleError("matching",a,r)}o&&this._updateSublayersRecursively(o,n,i)}}_finalizeOldLayers(e){for(const n in e){const i=e[n];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle="Initialized"}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle="Matched. State transferred from previous layer",n!==e&&(e.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle="No longer matched. Awaiting garbage collection";try{e._finalize(),e.lifecycle="Finalized! Awaiting garbage collection"}catch(n){this._handleError("finalization",n,e)}}}class M0e{constructor(e){E(this,"width",void 0),E(this,"height",void 0),E(this,"views",void 0),E(this,"viewState",void 0),E(this,"controllers",void 0),E(this,"timeline",void 0),E(this,"_viewports",void 0),E(this,"_viewportMap",void 0),E(this,"_isUpdating",void 0),E(this,"_needsRedraw",void 0),E(this,"_needsUpdate",void 0),E(this,"_eventManager",void 0),E(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n="string"==typeof e?this.getView(e):e,i=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,n){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const o=i[s];if(o.containsPixel(r)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=HS(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!sd(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):$e.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){return new(0,n.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return null===(o=this.getView(e.id))||void 0===o?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,i,r){const s=e.controller;if(s){const o={...n,...s,id:e.id,x:i.x,y:i.y,width:i.width,height:i.height};return r||(r=this._createController(e,o)),r&&r.setProps(o),r}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let r=e.length;r--;){const s=e[r],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let c=n[s.id];const l=!!s.controller;l&&!c&&(i=!0),(i||!l)&&c&&(c.finalize(),c=null),this.controllers[s.id]=this._updateController(s,o,a,c),this._viewports.unshift(a)}for(const r in n){const s=n[r];s&&!this.controllers[r]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length||e.some((i,r)=>!e[r].equals(n[r]))}}const O0e=Math.PI/180;function Yz(t){return 512/4003e4/Math.cos(t*O0e)}class $a extends Fa{constructor(e={}){const{latitude:n=0,longitude:i=0,zoom:r=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:c=1.01,orthographic:l=!1,projectionMatrix:u,repeat:d=!1,worldOffset:h=0,legacyMeterSizes:f=!1}=e;let{width:p,height:g,altitude:m=1.5}=e;const y=Math.pow(2,r);p=p||1,g=g||1;let v,_=null;u?(m=u[5]/2,v=fv(m)):(e.fovy?(v=e.fovy,m=tS(v)):v=fv(m),_=function Vj(t){const{width:e,height:n,altitude:i,pitch:r=0,offset:s,center:o,scale:a,nearZMultiplier:c=1,farZMultiplier:l=1}=t;let{fovy:u=fv(kge)}=t;void 0!==i&&(u=fv(i));const d=u*kr,h=r*kr,f=tS(u);let p=f;o&&(p+=o[2]*a/Math.cos(h)/n);const g=d*(.5+(s?s[1]:0)/n),m=Math.sin(g)*p/Math.sin(JT(Math.PI/2-h-g,.01,Math.PI-.01)),y=Math.sin(h)*m+p;return{fov:d,aspect:e/n,focalDistance:f,near:c,far:Math.min(y*l,10*p)}}({width:p,height:g,pitch:s,fovy:v,nearZMultiplier:a,farZMultiplier:c}));let w=function jge(t){const{height:e,pitch:n,bearing:i,altitude:r,scale:s,center:o}=t,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];yy(a,a,[0,0,-r]),Z3(a,a,-n*kr),Q3(a,a,i*kr);const c=s/e;return eT(a,a,[c,c,c]),o&&yy(a,a,function Ile(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}([],o)),a}({height:g,pitch:s,bearing:o,scale:y,altitude:m});h&&(w=(new Le).translate([512*h,0,0]).multiplyLeft(w)),super({...e,width:p,height:g,viewMatrix:w,longitude:i,latitude:n,zoom:r,..._,fovy:v,focalDistance:m}),E(this,"longitude",void 0),E(this,"latitude",void 0),E(this,"pitch",void 0),E(this,"bearing",void 0),E(this,"altitude",void 0),E(this,"fovy",void 0),E(this,"orthographic",void 0),E(this,"_subViewports",void 0),E(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=i,this.zoom=r,this.pitch=s,this.bearing=o,this.altitude=m,this.fovy=v,this.orthographic=l,this._subViewports=d?[]:null,this._pseudoMeters=f,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),i=Math.ceil((e[2]-180)/360);for(let r=n;r<=i;r++){const s=r?new $a({...this,worldOffset:r}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,i]=this.projectFlat(e);return[n,i,(e[2]||0)*Yz(e[1])]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,i]=this.unprojectFlat(e);return[n,i,(e[2]||0)/Yz(i)]}addMetersToLngLat(e,n){return Uj(e,n)}panByPosition(e,n){const i=lp(n,this.pixelUnprojectionMatrix),s=vy([],this.projectFlat(e),eU([],i)),o=vy([],this.center,s),[a,c]=this.unprojectFlat(o);return{longitude:a,latitude:c}}getBounds(e={}){const n=function zge(t,e=0){const{width:n,height:i,unproject:r}=t,s={targetZ:e},o=r([0,i],s),a=r([n,i],s);let c,l;return(t.fovy?.5*t.fovy*zj:Math.atan(.5/t.altitude))>(90-t.pitch)*zj-.01?(c=Gj(t,0,e),l=Gj(t,n,e)):(c=r([0,0],s),l=r([n,0],s)),[o,a,l,c]}(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:i,height:r}=this,{longitude:s,latitude:o,zoom:a}=Hj({width:i,height:r,bounds:e,...n});return new $a({width:i,height:r,longitude:s,latitude:o,zoom:a})}}E($a,"displayName","WebMercatorViewport");class N0e extends Zj{constructor(e){const{width:n,height:i,latitude:r,longitude:s,zoom:o,bearing:a=0,pitch:c=0,altitude:l=1.5,position:u=[0,0,0],maxZoom:d=20,minZoom:h=0,maxPitch:f=60,minPitch:p=0,startPanLngLat:g,startZoomLngLat:m,startRotatePos:y,startBearing:v,startPitch:_,startZoom:w,normalize:C=!0}=e;Kn(Number.isFinite(s)),Kn(Number.isFinite(r)),Kn(Number.isFinite(o)),super({width:n,height:i,latitude:r,longitude:s,zoom:o,bearing:a,pitch:c,altitude:l,maxZoom:d,minZoom:h,maxPitch:f,minPitch:p,normalize:C,position:u},{startPanLngLat:g,startZoomLngLat:m,startRotatePos:y,startBearing:v,startPitch:_,startZoom:w}),E(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const i=this.getState().startPanLngLat||this._unproject(n);if(!i)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:o}=this.getState();if(!r||void 0===s||void 0===o)return this;let a;return a=e?this._getNewRotation(e,r,o,s):{bearing:s+n,pitch:o+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:i}){let{startZoom:r,startZoomLngLat:s}=this.getState();if(s||(r=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let c=r+Math.log2(i);c=Xn(c,a,o);const l=this.makeViewport({...this.getViewportProps(),zoom:c});return this._getUpdatedState({zoom:c,...l.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),i={...this.getViewportProps()},{bearing:r,longitude:s}=i;return Math.abs(r-n.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-n.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}applyConstraints(e){const{maxZoom:n,minZoom:i,zoom:r}=e;e.zoom=Xn(r,i,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=Xn(a,o,s);const{normalize:c=!0}=e;return c&&Object.assign(e,function Gge(t){const{width:e,height:n,pitch:i=0}=t;let{longitude:r,latitude:s,zoom:o,bearing:a=0}=t;(r<-180||r>180)&&(r=Bj(r+180,360)-180),(a<-180||a>180)&&(a=Bj(a+180,360)-180);const c=ZT(n/512);if(o<=c)o=c,s=0;else{const l=n/2/Math.pow(2,o),u=rd([0,l])[1];if(s<u)s=u;else{const d=rd([0,512-l])[1];s>d&&(s=d)}}return{width:e,height:n,longitude:r,latitude:s,zoom:o,pitch:i,bearing:a}}(e)),e}_zoomFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.zoom({pos:[n/2,i/2],scale:e})}_panFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.pan({startPos:[n/2,i/2],pos:[n/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,i,r){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],c=n[1],{width:l,height:u}=this.getViewportProps(),d=s/l;let h=0;o>0?Math.abs(u-c)>5&&(h=o/(c-u)*1.2):o<0&&c>5&&(h=1-a/c),h=Xn(h,-1,1);const{minPitch:f,maxPitch:p}=this.getViewportProps();let m=i;return h>0?m=i+h*(p-i):h<0&&(m=i-h*(f-i)),{pitch:m,bearing:r+180*d}}}class L0e extends sS{constructor(...e){super(...e),E(this,"ControllerState",N0e),E(this,"transition",{transitionDuration:300,transitionInterpolator:new gv({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),E(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Jz extends iS{get ViewportType(){return $a}get ControllerType(){return L0e}}E(Jz,"displayName","MapView");class F0e extends Sv{constructor(e,n){super(e,n),E(this,"maskMap",void 0),E(this,"fbo",void 0);const{mapSize:i=2048}=n;this.maskMap=new Jn(e,{width:i,height:i,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.fbo=new mn(e,{id:"maskmap",width:i,height:i,attachments:{36064:this.maskMap}})}render(e){const n=this.gl,i=[!1,!1,!1,!1];return i[e.channel]=!0,Ur(n,{clearColor:[255,255,255,255],blend:!0,blendFunc:[0,1],blendEquation:32778,colorMask:i,depthTest:!1},()=>super.render({...e,target:this.fbo,pass:"mask"}))}shouldDrawLayer(e){return"mask"===e.props.operation}delete(){this.fbo.delete(),this.maskMap.delete()}}class V0e{constructor(){E(this,"id","mask-effect"),E(this,"props",null),E(this,"useInPicking",!0),E(this,"dummyMaskMap",void 0),E(this,"channels",[]),E(this,"masks",null),E(this,"maskPass",void 0),E(this,"maskMap",void 0),E(this,"lastViewport",void 0)}preRender(e,{layers:n,layerFilter:i,viewports:r,onViewportActive:s,views:o}){this.dummyMaskMap||(this.dummyMaskMap=new Jn(e,{width:1,height:1}));const a=n.filter(d=>d.props.visible&&"mask"===d.props.operation);if(0===a.length)return this.masks=null,void(this.channels.length=0);this.masks={},this.maskPass||(this.maskPass=new F0e(e,{id:"default-mask"}),this.maskMap=this.maskPass.maskMap);const c=this._sortMaskChannels(a),l=r[0],u=!this.lastViewport||!this.lastViewport.equals(l);for(const d in c)this._renderChannel(c[d],{layerFilter:i,onViewportActive:s,views:o,viewport:l,viewportChanged:u})}_renderChannel(e,{layerFilter:n,onViewportActive:i,views:r,viewport:s,viewportChanged:o}){const a=this.channels[e.index];if(!a)return;const c=e===a||a.layers.length!==e.layers.length||e.layerBounds.some((l,u)=>l!==a.layerBounds[u]);if(e.bounds=a.bounds,e.maskBounds=a.maskBounds,this.channels[e.index]=e,(c||o)&&(this.lastViewport=s,e.bounds=function B0e({layers:t,viewport:e}){let n=null;for(const s of t){const o=s.getBounds();o&&(n?(n[0]=Math.min(n[0],o[0][0]),n[1]=Math.min(n[1],o[0][1]),n[2]=Math.max(n[2],o[1][0]),n[3]=Math.max(n[3],o[1][1])):n=[o[0][0],o[0][1],o[1][0],o[1][1]])}const i=e.getBounds();if(!n)return i;const r=function U0e(t){const e_x=t[2]-t[0],e_y=t[3]-t[1],n_x=t[0]+.5*e_x,n_y=t[1]+.5*e_y;return[n_x-e_x,n_y-e_y,n_x+e_x,n_y+e_y]}(i);return n[2]-n[0]<r[2]-r[0]||n[3]-n[1]<r[3]-r[1]||(n[0]=Math.max(n[0],r[0]),n[1]=Math.max(n[1],r[1]),n[2]=Math.min(n[2],r[2]),n[3]=Math.min(n[3],r[3])),n}({layers:e.layers,viewport:s}),c||!$u(e.bounds,a.bounds))){const{maskPass:l,maskMap:u}=this,d=function k0e({bounds:t,viewport:e,width:n,height:i}){if(t[2]<=t[0]||t[3]<=t[1])return null;if(n-=2,i-=2,e instanceof $a){const{longitude:a,latitude:c,zoom:l}=Hj({width:n,height:i,bounds:[[t[0],t[1]],[t[2],t[3]]],maxZoom:20});return new $a({longitude:a,latitude:c,zoom:l,x:1,y:1,width:n,height:i})}const s=[(t[0]+t[2])/2,(t[1]+t[3])/2,0],o=Math.min(20,n/(t[2]-t[0]),i/(t[3]-t[1]));return new oS({x:1,y:1}).makeViewport({width:n,height:i,viewState:{target:s,zoom:Math.log2(o)}})}({bounds:e.bounds,viewport:s,width:u.width,height:u.height});e.maskBounds=d?d.getBounds():[0,0,1,1],l.render({pass:"mask",channel:e.index,layers:e.layers,layerFilter:n,viewports:d?[d]:[],onViewportActive:i,views:r,moduleParameters:{devicePixelRatio:1}})}this.masks[e.id]={index:e.index,bounds:e.maskBounds,coordinateOrigin:e.coordinateOrigin,coordinateSystem:e.coordinateSystem}}_sortMaskChannels(e){const n={};let i=0;for(const r of e){const{id:s}=r.root;let o=n[s];if(!o){if(++i>4){$e.warn("Too many mask layers. The max supported is 4")();continue}o={id:s,index:this.channels.findIndex(a=>a?.id===s),layers:[],layerBounds:[],coordinateOrigin:r.root.props.coordinateOrigin,coordinateSystem:r.root.props.coordinateSystem},n[s]=o}o.layers.push(r),o.layerBounds.push(r.getBounds())}for(let r=0;r<4;r++){const s=this.channels[r];(!s||!(s.id in n))&&(this.channels[r]=null)}for(const r in n){const s=n[r];s.index<0&&(s.index=this.channels.findIndex(o=>!o),this.channels[s.index]=s)}return n}getModuleParameters(){return{maskMap:this.masks?this.maskMap:this.dummyMaskMap,maskChannels:this.masks}}cleanup(){this.dummyMaskMap&&(this.dummyMaskMap.delete(),this.dummyMaskMap=void 0),this.maskPass&&(this.maskPass.delete(),this.maskPass=void 0,this.maskMap=void 0),this.lastViewport=void 0,this.masks=null,this.channels.length=0}}const j0e=new VS;class H0e{constructor(){E(this,"effects",void 0),E(this,"_internalEffects",void 0),E(this,"_needsRedraw",void 0),this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!sd(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._internalEffects=e.slice(),this._internalEffects.push(new V0e),e.some(n=>n instanceof VS)||this._internalEffects.push(j0e)}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}}class z0e extends Sv{shouldDrawLayer(e){return"draw"===e.props.operation}}const Zz={blendFunc:[1,0,32771,0],blendEquation:32774};class Qz extends Sv{constructor(...e){super(...e),E(this,"pickZ",void 0),E(this,"_colors",null)}render(e){return e.pickingFBO?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:c,width:l,height:u},cullRect:d,effects:h,pass:f="picking",pickZ:p}){const g=this.gl;this.pickZ=p;const m=p?null:{byLayer:new Map,byAlpha:[]};this._colors=m;const y=Ur(g,{scissorTest:!0,scissor:[a,c,l,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...Zz,blend:!p},()=>super.render({target:o,layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:s,cullRect:d,effects:h?.filter(_=>_.useInPicking),pass:f}));return this._colors=null,{decodePickingColor:m&&W0e.bind(null,m),stats:y}}shouldDrawLayer(e){return e.props.pickable&&"draw"===e.props.operation}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,i){const r={...e.props.parameters};return this._colors?(Object.assign(r,Zz),r.blend=!0,r.blendColor=function G0e(t,e,n){const{byLayer:i,byAlpha:r}=t;let s,o=i.get(e);return o?(o.viewports.push(n),s=o.a):(s=i.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},i.set(e,o),r[s]=o):($e.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}(this._colors,e,i)):r.blend=!1,r}}function W0e(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}class q0e{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new z0e(e),this.pickLayersPass=new Qz(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=e.layerFilter||this.layerFilter,e.effects=e.effects||[],e.target=e.target||mn.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const i=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,r=n.render({...e,target:i});this._postRender(e.effects,e),this.renderCount++,gi("deckRenderer.renderLayers",this,r,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){let i=null;for(const r of e)r.preRender(this.gl,n),r.postRender&&(i=r);i&&this._resizeRenderBuffers(),this.lastPostProcessEffect=i}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new mn(this.gl),new mn(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:i}=this,r={inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){r.target=n.target,s.postRender(this.gl,r);break}const o=s.postRender(this.gl,r);r.inputBuffer=o,r.swapBuffer=o===i[0]?i[1]:i[0]}}}const X0e={pickedColor:null,pickedObjectIndex:-1};function Y0e({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:r,deviceRect:s}){const{x:o,y:a,width:c,height:l}=s;let u=r*r,d=-1,h=0;for(let f=0;f<l;f++){const p=f+a-i,g=p*p;if(g>u)h+=4*c;else for(let m=0;m<c;m++){if(t[h+3]-1>=0){const v=m+o-n,_=v*v+g;_<=u&&(u=_,d=h)}h+=4}}if(d>=0){const f=t.slice(d,d+4),p=e(f);if(p){const g=Math.floor(d/4/c),m=d/4-g*c;return{...p,pickedColor:f,pickedX:o+m,pickedY:a+g}}$e.error("Picked non-existent layer. Is picking buffer corrupt?")()}return X0e}function eG({pickInfo:t,viewports:e,pixelRatio:n,x:i,y:r,z:s}){let a,o=e[0];if(e.length>1&&(o=function Z0e(t,e){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.containsPixel(e))return i}return t[0]}(t?.pickedViewports||e,{x:i,y:r})),o){const c=[i-o.x,r-o.y];void 0!==s&&(c[2]=s),a=o.unproject(c)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function J0e(t){const{pickInfo:e,lastPickedInfo:n,mode:i,layers:r}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,c=o?[o]:[];if("hover"===i){const h=n.layerId,f=o?o.props.id:null;if(f!==h||a!==n.index){if(f!==h){const p=r.find(g=>g.props.id===h);p&&c.unshift(p)}n.layerId=f,n.index=a,n.info=null}}const l=eG(t),u=new Map;return u.set(null,l),c.forEach(d=>{let h={...l};d===o&&(h.color=s,h.index=a,h.picked=!0),h=tG({layer:d,info:h,mode:i});const f=h.layer;d===o&&"hover"===i&&(n.info=h),u.set(f.id,h),"hover"===i&&f.updateAutoHighlight(h)}),u}function tG({layer:t,info:e,mode:n}){for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}class Q0e{constructor(e){E(this,"gl",void 0),E(this,"pickingFBO",void 0),E(this,"depthFBO",void 0),E(this,"pickLayersPass",void 0),E(this,"layerFilter",void 0),E(this,"lastPickedInfo",void 0),E(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new Qz(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:i,viewports:r},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,c=o?i.find(h=>h.id===o):null,l=a&&r.find(h=>h.id===a)||r[0],u=l&&l.unproject([e-l.x,n-l.y]);return{...s,x:e,y:n,viewport:l,coordinate:u,layer:c}}_resizeBuffer(){var e,n;const{gl:i}=this;if(!this.pickingFBO&&(this.pickingFBO=new mn(i),mn.isSupported(i,{colorBufferFloat:!0}))){const r=new mn(i);r.attach({36064:new Jn(i,{format:He(i)?34836:6408,type:5126})}),this.depthFBO=r}null===(e=this.pickingFBO)||void 0===e||e.resize({width:i.canvas.width,height:i.canvas.height}),null===(n=this.depthFBO)||void 0===n||n.resize({width:i.canvas.width,height:i.canvas.height})}_getPickable(e){if(!1===this._pickable)return null;const n=e.filter(i=>i.isPickable()&&!i.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:i,x:r,y:s,radius:o=0,depth:a=1,mode:c="query",unproject3D:l,onViewportActive:u,effects:d}){const h=this._getPickable(e),f=cd(this.gl);if(!h)return{result:[],emptyInfo:eG({viewports:i,x:r,y:s,pixelRatio:f})};this._resizeBuffer();const p=bS(this.gl,[r,s],!0),g=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],m=Math.round(o*f),{width:y,height:v}=this.pickingFBO,_=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceWidth:y,deviceHeight:v}),w={x:r-o,y:s-o,width:2*o+1,height:2*o+1};let C;const S=[],M=new Set;for(let x=0;x<a;x++){let N,U;N=_?Y0e({...this._drawAndSample({layers:h,views:n,viewports:i,onViewportActive:u,deviceRect:_,cullRect:w,effects:d,pass:"picking:".concat(c)}),deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceRect:_}):{pickedColor:null,pickedObjectIndex:-1},N.pickedLayer&&l&&this.depthFBO&&(U=this._drawAndSample({layers:[N.pickedLayer],views:n,viewports:i,onViewportActive:u,deviceRect:{x:N.pickedX,y:N.pickedY,width:1,height:1},cullRect:w,effects:d,pass:"picking:".concat(c,":z")},!0).pickedColors[0]),N.pickedLayer&&x+1<a&&(M.add(N.pickedLayer),N.pickedLayer.disablePickingIndex(N.pickedObjectIndex)),C=J0e({pickInfo:N,lastPickedInfo:this.lastPickedInfo,mode:c,layers:h,viewports:i,x:r,y:s,z:U,pixelRatio:f});for(const k of C.values())k.layer&&S.push(k);if(!N.pickedColor)break}for(const x of M)x.restorePickingColors();return{result:S,emptyInfo:C.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:i,x:r,y:s,width:o=1,height:a=1,mode:c="query",maxObjects:l=null,onViewportActive:u,effects:d}){const h=this._getPickable(e);if(!h)return[];this._resizeBuffer();const f=cd(this.gl),p=bS(this.gl,[r,s],!0),g=p.x,m=p.y+p.height,y=bS(this.gl,[r+o,s+a],!0),_=y.y,S=function K0e({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t)for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const s=t.slice(i,i+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):$e.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(n.values())}(this._drawAndSample({layers:h,views:n,viewports:i,onViewportActive:u,deviceRect:{x:g,y:_,width:y.x+y.width-g,height:m-_},cullRect:{x:r,y:s,width:o,height:a},effects:d,pass:"picking:".concat(c)})),M=new Map,x=Number.isFinite(l);for(let N=0;N<S.length&&!(x&&l&&M.size>=l);N++){const U=S[N];let k={color:U.pickedColor,layer:null,index:U.pickedObjectIndex,picked:!0,x:r,y:s,pixelRatio:f};k=tG({layer:U.pickedLayer,info:k,mode:c}),M.has(k.object)||M.set(k.object,k)}return Array.from(M.values())}_drawAndSample({layers:e,views:n,viewports:i,onViewportActive:r,deviceRect:s,cullRect:o,effects:a,pass:c},l=!1){const u=l?this.depthFBO:this.pickingFBO,{decodePickingColor:d}=this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:n,viewports:i,onViewportActive:r,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:c,pickZ:l}),{x:h,y:f,width:p,height:g}=s,m=new(l?Float32Array:Uint8Array)(p*g*4);return wv(u,{sourceX:h,sourceY:f,sourceWidth:p,sourceHeight:g,target:m}),{pickedColors:m,decodePickingColor:d}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const o=Math.max(0,e-i),a=Math.max(0,n-i),c=Math.min(r,e+i+1)-o,l=Math.min(s,n+i+1)-a;return c<=0||l<=0?null:{x:o,y:a,width:c,height:l}}}const eEe={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class tEe{constructor(e){E(this,"el",null),E(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,eEe),n.appendChild(this.el))}setTooltip(e,n,i){const r=this.el;if(r){if("string"==typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className),Object.assign(r.style,e.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(n,"px, ").concat(i,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}function nG(t,e){if(!t)throw new Error(e||"loader assertion failed.")}typeof self<"u"&&self,typeof window<"u"&&window,typeof global<"u"&&global,typeof document<"u"&&document;const iEe=!("object"==typeof process&&"[object process]"===String(process)&&!process.browser),iG=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:rEe}=(iG&&parseFloat(iG[1]),globalThis),Sx=typeof Image<"u",xx=typeof ImageBitmap<"u",Ix=!!iEe||!!rEe;function rG(t){const e=function oG(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&"object"==typeof t&&t.data&&t.width&&t.height?"data":null}(t);if(!e)throw new Error("Not an image");return e}const aEe=/^data:image\/svg\+xml/,cEe=/\.svg((\?|#).*)?$/;function Mx(t){return t&&(aEe.test(t)||cEe.test(t))}function aG(t,e){if(Mx(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}function cG(t,e,n){return Dx.apply(this,arguments)}function Dx(){return Dx=ee(function*(t,e,n){const i=function lEe(t,e){if(Mx(e)){let i=(new TextDecoder).decode(t);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(i))}return aG(t,e)}(t,n),r=self.URL||self.webkitURL,s="string"!=typeof i&&r.createObjectURL(i);try{return yield function uEe(t,e){return Rx.apply(this,arguments)}(s||i,e)}finally{s&&r.revokeObjectURL(s)}}),Dx.apply(this,arguments)}function Rx(){return Rx=ee(function*(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(yield n.decode(),n):yield new Promise((i,r)=>{try{n.onload=()=>i(n),n.onerror=s=>r(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){r(s)}})}),Rx.apply(this,arguments)}const dEe={};let lG=!0;function Ox(){return Ox=ee(function*(t,e,n){let i;i=Mx(n)?yield cG(t,e,n):aG(t,n);const r=e&&e.imagebitmap;return yield function fEe(t){return Px.apply(this,arguments)}(i,r)}),Ox.apply(this,arguments)}function Px(){return Px=ee(function*(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if((function pEe(t){for(const e in t||dEe)return!1;return!0}(e)||!lG)&&(e=null),e)try{return yield createImageBitmap(t,e)}catch(n){console.warn(n),lG=!1}return yield createImageBitmap(t)}),Px.apply(this,arguments)}const Qs=!1,Tp=!0;function uG(t){const e=Sp(t);return function EEe(t){const e=Sp(t);return e.byteLength>=24&&2303741511===e.getUint32(0,Qs)?{mimeType:"image/png",width:e.getUint32(16,Qs),height:e.getUint32(20,Qs)}:null}(e)||function CEe(t){const e=Sp(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,Qs)&&255===e.getUint8(2)))return null;const{tableMarkers:i,sofMarkers:r}=function TEe(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,Qs);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Qs),width:e.getUint16(s+7,Qs)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,Qs)}return null}(e)||function wEe(t){const e=Sp(t);return e.byteLength>=10&&1195984440===e.getUint32(0,Qs)?{mimeType:"image/gif",width:e.getUint16(6,Tp),height:e.getUint16(8,Tp)}:null}(e)||function AEe(t){const e=Sp(t);return e.byteLength>=14&&16973===e.getUint16(0,Qs)&&e.getUint32(2,Tp)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Tp),height:e.getUint32(22,Tp)}:null}(e)||function bEe(t){const n=function gEe(t){return function vEe(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=function yEe(t){return[...t].map(e=>e.charCodeAt(0))}(e);for(let r=0;r<i.length;++r)if(i[r]!==t[r+n])return!1;return!0}(t,"ftyp",4)&&96&t[8]?function mEe(t){switch(function _Ee(t,e,n){return String.fromCharCode(...t.slice(e,n))}(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}(t):null}(new Uint8Array(t instanceof DataView?t.buffer:t));return n?{mimeType:n.mimeType,width:0,height:0}:null}(e)}function Sp(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}function Nx(){return Nx=ee(function*(t,e){const{mimeType:n}=uG(t)||{},i=globalThis._parseImageNode;return nG(i),yield i(t,n)}),Nx.apply(this,arguments)}function Lx(){return Lx=ee(function*(t,e,n){const r=((e=e||{}).image||{}).type||"auto",{url:s}=n||{},o=function IEe(t){switch(t){case"auto":case"data":return function oEe(){if(xx)return"imagebitmap";if(Sx)return"image";if(Ix)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function sEe(t){switch(t){case"auto":return xx||Sx||Ix;case"imagebitmap":return xx;case"image":return Sx;case"data":return Ix;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}(t),t}}(r);let a;switch(o){case"imagebitmap":a=yield function hEe(t,e,n){return Ox.apply(this,arguments)}(t,e,s);break;case"image":a=yield cG(t,e,s);break;case"data":a=yield function SEe(t,e){return Nx.apply(this,arguments)}(t,e);break;default:nG(!1)}return"data"===r&&(a=function sG(t){switch(rG(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}(a)),a}),Lx.apply(this,arguments)}const dG={id:"image",module:"images",name:"Images",version:"3.4.15",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:function xEe(t,e,n){return Lx.apply(this,arguments)},tests:[t=>!!uG(new DataView(t))],options:{image:{type:"auto",decode:!0}}},DEe={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function MEe(t){const e=t[0],n=t[t.length-1];return"{"===e&&"}"===n||"["===e&&"]"===n},parseTextSync:JSON.parse},xp="8.8.27",Pv=globalThis.deck&&globalThis.deck.VERSION;if(Pv&&Pv!==xp)throw new Error("deck.gl - multiple versions detected: ".concat(Pv," vs ").concat(xp));Pv||($e.log(1,"deck.gl ".concat(xp))(),globalThis.deck={...globalThis.deck,VERSION:xp,version:xp,log:$e,_registerLoggers:function nbe(t){jS=t}},zz([DEe,[dG,{imagebitmap:{premultiplyAlpha:"none"}}]]));const REe=globalThis.deck,Nv=globalThis;function hG(t){if(!t&&!$s())return"Node";if(xj(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=-1!==n.indexOf("MSIE "),r=-1!==n.indexOf("Trident/");return i||r?"IE":Nv.chrome?"Chrome":Nv.safari?"Safari":Nv.mozInnerScreenX?"Firefox":"Unknown"}class Lv extends Bo{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const i=He(e),r=GH(e,"TIMER_QUERY");let s=i||r;for(const o of n)switch(o){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:Q(!1)}return s}constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):n++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return Lv.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const fG=$s()&&typeof document<"u";let jEe=0;class HEe{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{onCreateContext:n=m=>xH(m),onAddHTML:i=null,onInitialize:r=()=>{},onRender:s=()=>{},onFinalize:o=()=>{},onError:a,gl:c=null,glOptions:l={},debug:u=!1,createFramebuffer:d=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:f=!0,stats:p=il.get("animation-loop-".concat(jEe++))}=e;let{useDevicePixels:g=!0}=e;"useDevicePixelRatio"in e&&(oe.deprecated("useDevicePixelRatio","useDevicePixels")(),g=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:o,onError:a,gl:c,glOptions:l,debug:u,createFramebuffer:d},this.gl=c,this.needsRedraw=null,this.timeline=null,this.stats=p,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:f,useDevicePixels:g}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return Q("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Lv.isSupported(this.gl,["timers"])?new Lv(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),!1!==i&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}toDataURL(){var e=this;return ee(function*(){return e.setNeedsRedraw("toDataURL"),yield e.waitForRender(),e.gl.canvas.toDataURL()})()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const i=document.getElementById(e);return i?Number(i.value):n}setViewParameters(){return oe.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=fG?new Promise((e,n)=>{fG&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):function VEe(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):function UEe(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}(e)}_renderFrame(){this.display?this.display._renderFrame(...arguments):this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?wS(this.props.gl,e):this.onCreateContext(e),!bv(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(function L_e(t){Fo(t,vS)})(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const i=this.props.onAddHTML(n);i&&(n.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&n>0&&(i=e/n),{width:e,height:n,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function V_e(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.canvas){const i=function F_e(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}(e.useDevicePixels);return void function W_e(t,e,n){let i="width"in n?n.width:t.canvas.clientWidth,r="height"in n?n.height:t.canvas.clientHeight;(!i||!r)&&(oe.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,r=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let o=e;const a=Math.floor(i*o),c=Math.floor(r*o);t.canvas.width=a,t.canvas.height=c,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==c)&&(oe.warn("Device pixel ratio clamped")(),o=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/r),t.canvas.width=Math.floor(i*o),t.canvas.height=Math.floor(r*o)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}(t,i,e)}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new mn(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var Fv=qe(511);const zEe={mousedown:1,mousemove:2,mouseup:4};(function WEe(t){const e=t.prototype.handler;t.prototype.handler=function(i){const r=this.store;i.button>0&&"pointerdown"===i.type&&(function GEe(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}(r,s=>s.pointerId===i.pointerId)||r.push(i)),e.call(this,i)}})(Fv.PointerEventInput),function $Ee(t){t.prototype.handler=function(n){let i=zEe[n.type];1&i&&n.button>=0&&(this.pressed=!0),2&i&&0===n.buttons&&(i=4),this.pressed&&(4&i&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}(Fv.MouseInput);const qEe=Fv.Manager,eo=Fv;class Bv{constructor(e,n,i){this.element=e,this.callback=n,this.options={enable:!0,...i}}}const XEe=eo?[[eo.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[eo.Rotate,{enable:!1}],[eo.Pinch,{enable:!1}],[eo.Swipe,{enable:!1}],[eo.Pan,{threshold:0,enable:!1}],[eo.Press,{enable:!1}],[eo.Tap,{event:"doubletap",taps:2,enable:!1}],[eo.Tap,{event:"anytap",enable:!1}],[eo.Tap,{enable:!1}]]:null,mG={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},YEe={doubletap:["tap"]},KEe={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Bx={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},JEe={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},_G={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},ZEe=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",yd=typeof window<"u"?window:global;typeof global<"u"?global:window,typeof document<"u"&&document;let kx=!1;try{yd.addEventListener("test",null,{get passive(){return kx=!0,!0}}),yd.removeEventListener("test",null)}catch{kx=!1}const QEe=-1!==ZEe.indexOf("firefox"),{WHEEL_EVENTS:ewe}=Bx,vG=4.000244140625;class iwe extends Bv{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{if(!this.options.enable)return;let s=r.deltaY;yd.WheelEvent&&(QEe&&r.deltaMode===yd.WheelEvent.DOM_DELTA_PIXEL&&(s/=yd.devicePixelRatio),r.deltaMode===yd.WheelEvent.DOM_DELTA_LINE&&(s*=40)),0!==s&&s%vG==0&&(s=Math.floor(s/vG)),r.shiftKey&&s&&(s*=.25),this.callback({type:"wheel",center:{x:r.clientX,y:r.clientY},delta:-s,srcEvent:r,pointerType:"mouse",target:r.target})},this.events=(this.options.events||[]).concat(ewe),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,!!kx&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){"wheel"===e&&(this.options.enable=n)}}const{MOUSE_EVENTS:rwe}=Bx,bG="pointermove",EG="pointerover",wG="pointerout",AG="pointerenter",CG="pointerleave";class swe extends Bv{constructor(e,n,i){super(e,n,i),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,this.events=(this.options.events||[]).concat(rwe),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===bG&&(this.enableMoveEvent=n),e===EG&&(this.enableOverEvent=n),e===wG&&(this.enableOutEvent=n),e===AG&&(this.enableEnterEvent=n),e===CG&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this._emit(EG,e)}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this._emit(wG,e)}handleEnterEvent(e){this.enableEnterEvent&&"mouseenter"===e.type&&this._emit(AG,e)}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this._emit(CG,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.buttons&&(this.pressed=!1),this.pressed||this._emit(bG,e);break;case"mouseup":this.pressed=!1}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:owe}=Bx,TG="keydown";class awe extends Bv{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{const s=r.target||r.srcElement;"INPUT"===s.tagName&&"text"===s.type||"TEXTAREA"===s.tagName||(this.enableDownEvent&&"keydown"===r.type&&this.callback({type:TG,srcEvent:r,key:r.key,target:r.target}),this.enableUpEvent&&"keyup"===r.type&&this.callback({type:"keyup",srcEvent:r,key:r.key,target:r.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(owe),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===TG&&(this.enableDownEvent=n),"keyup"===e&&(this.enableUpEvent=n)}}const xG="contextmenu";class cwe extends Bv{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{this.options.enable&&this.callback({type:xG,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===xG&&(this.options.enable=n)}}const lwe={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};function mwe(t){const e=lwe[t.srcEvent.type];if(!e)return null;const{buttons:n,button:i}=t.srcEvent;let r=!1,s=!1,o=!1;return 2===e?(r=!!(1&n),s=!!(4&n),o=!!(2&n)):(r=0===i,s=1===i,o=2===i),{leftButton:r,middleButton:s,rightButton:o}}function _we(t,e){const n=t.center;if(!n)return null;const i=e.getBoundingClientRect();return{center:n,offsetCenter:{x:(n.x-i.left-e.clientLeft)/(i.width/e.offsetWidth||1),y:(n.y-i.top-e.clientTop)/(i.height/e.offsetHeight||1)}}}const Vx={srcElement:"root",priority:0};class ywe{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const i=this._normalizeEvent(n);let r=n.srcEvent.target;for(;r&&r!==i.rootElement;){if(this._emit(i,r),i.handled)return;r=r.parentNode}this._emit(i,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,i,r=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let c=Vx;"string"==typeof i||i&&i.addEventListener?c={...Vx,srcElement:i}:i&&(c={...Vx,...i});let l=a.get(c.srcElement);l||(l=[],a.set(c.srcElement,l));const u={type:e,handler:n,srcElement:c.srcElement,priority:c.priority};r&&(u.once=!0),s&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let d=l.length-1;for(;d>=0&&!(l[d].priority>=u.priority);)d--;l.splice(d+1,0,u)}remove(e,n){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.type===e&&o.handler===n){i.splice(s,1);const a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}this._active=i.some(s=>!s.passive)}_emit(e,n){const i=this.handlersByElement.get(n);if(i){let r=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,r=!0},a=[];for(let c=0;c<i.length;c++){const{type:l,handler:u,once:d}=i[c];if(u({...e,type:l,stopPropagation:s,stopImmediatePropagation:o}),d&&a.push(i[c]),r)break}for(let c=0;c<a.length;c++){const{type:l,handler:u}=a[c];this.remove(l,u)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...mwe(e),..._we(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const vwe={events:null,recognizers:null,recognizerOptions:{},Manager:qEe,touchAction:"none",tabIndex:0};class bwe{constructor(e=null,n){this._onBasicInput=r=>{const{srcEvent:s}=r,o=KEe[s.type];o&&this.manager.emit(o,r)},this._onOtherEvent=r=>{this.manager.emit(r.type,r)},this.options={...vwe,...n},this.events=new Map,this.setElement(e);const{events:i}=this.options;i&&this.on(i)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this;this.manager=new(0,n.Manager)(e,{touchAction:n.touchAction,recognizers:n.recognizers||XEe}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(mG).forEach(r=>{const s=this.manager.get(r);s&&mG[r].forEach(o=>{s.recognizeWith(o)})});for(const r in n.recognizerOptions){const s=this.manager.get(r);if(s){const o=n.recognizerOptions[r];delete o.enable,s.set(o)}}this.wheelInput=new iwe(e,this._onOtherEvent,{enable:!1}),this.moveInput=new swe(e,this._onOtherEvent,{enable:!1}),this.keyInput=new awe(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new cwe(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,i){this._addEventHandler(e,n,i,!1)}once(e,n,i){this._addEventHandler(e,n,i,!0)}watch(e,n,i){this._addEventHandler(e,n,i,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==n){r.set({enable:n});const s=YEe[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=i.get(o);n?(a.requireFailure(e),r.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,i,r,s){if("string"!=typeof e){i=n;for(const u in e)this._addEventHandler(u,e[u],i,r,s);return}const{manager:o,events:a}=this,c=_G[e]||e;let l=a.get(c);l||(l=new ywe(this),a.set(c,l),l.recognizerName=JEe[c]||c,o&&o.on(c,l.handleEvent)),l.add(e,n,i,r,s),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(e,n){if("string"!=typeof e){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:i}=this,s=i.get(_G[e]||e);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const c of i.values())if(c.recognizerName===o&&!c.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function al(){}const DG={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:al,onResize:al,onViewStateChange:al,onInteractionStateChange:al,onBeforeRender:al,onAfterRender:al,onLoad:al,onError:t=>$e.error(t.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:({isDragging:t})=>t?"grabbing":"grab",getTooltip:null,debug:!1,drawPickingColors:!1};class jx{constructor(e){E(this,"props",void 0),E(this,"width",0),E(this,"height",0),E(this,"userData",{}),E(this,"canvas",null),E(this,"viewManager",null),E(this,"layerManager",null),E(this,"effectManager",null),E(this,"deckRenderer",null),E(this,"deckPicker",null),E(this,"eventManager",null),E(this,"tooltip",null),E(this,"metrics",void 0),E(this,"animationLoop",void 0),E(this,"stats",void 0),E(this,"viewState",void 0),E(this,"cursorState",void 0),E(this,"_needsRedraw",void 0),E(this,"_pickRequest",void 0),E(this,"_lastPointerDownInfo",null),E(this,"_metricsCounter",void 0),E(this,"_onPointerMove",n=>{const{_pickRequest:i}=this;if("pointerleave"===n.type)i.x=-1,i.y=-1,i.radius=0;else{if(n.leftButton||n.rightButton)return;{const r=n.offsetCenter;if(!r)return;i.x=r.x,i.y=r.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=n}),E(this,"_onEvent",n=>{const i=Yj[n.type],r=n.offsetCenter;if(!i||!r||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:r.x,y:r.y,layers:s,viewports:this.getViewports(r)},this._lastPointerDownInfo),{layer:a}=o,c=a&&(a[i.handler]||a.props[i.handler]),l=this.props[i.handler];let u=!1;c&&(u=c.call(a,o,n)),!u&&l&&l(o,n)}),E(this,"_onPointerDown",n=>{const i=n.offsetCenter,r=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=r.result[0]||r.emptyInfo}),this.props={...DG,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&$e.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===hG()&&$e.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new AS({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&op.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,i,r,s,o,a,c;this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(e=this.layerManager)||void 0===e||e.finalize(),this.layerManager=null,null===(n=this.viewManager)||void 0===n||n.finalize(),this.viewManager=null,null===(i=this.effectManager)||void 0===i||i.finalize(),this.effectManager=null,null===(r=this.deckRenderer)||void 0===r||r.finalize(),this.deckRenderer=null,null===(s=this.deckPicker)||void 0===s||s.finalize(),this.deckPicker=null,null===(o=this.eventManager)||void 0===o||o.destroy(),this.eventManager=null,null===(a=this.tooltip)||void 0===a||a.remove(),this.tooltip=null,this.props.canvas||this.props.gl||!this.canvas||(null===(c=this.canvas.parentElement)||void 0===c||c.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&$e.removed("onLayerHover","onHover")(),"onLayerClick"in e&&$e.removed("onLayerClick","onClick")(),e.initialViewState&&!sd(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||i||r||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return null!==this.viewManager}getViews(){return Kn(this.viewManager),this.viewManager.views}getViewports(e){return Kn(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_pick(e,n,i){Kn(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...i});return r.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return"string"==typeof n&&(n=document.getElementById(n),Kn(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:i}=e;if(n||0===n){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(i||0===i){var r;const s=Number.isFinite(i)?"".concat(i,"px"):i;this.canvas.style.position=(null===(r=e.style)||void 0===r?void 0:r.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const n=e.clientWidth||e.width,i=e.clientHeight||e.height;var r;n===this.width&&i===this.height||(this.width=n,this.height=i,null===(r=this.viewManager)||void 0===r||r.setProps({width:n,height:i}),this.props.onResize({width:n,height:i}))}_createAnimationLoop(e){const{width:n,height:i,gl:r,glOptions:s,debug:o,onError:a,onBeforeRender:c,onAfterRender:l,useDevicePixels:u}=e;return new HEe({width:n,height:i,useDevicePixels:u,autoResizeViewport:!1,gl:r,onCreateContext:d=>xH({...s,...d,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:d=>this._setGLContext(d.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:c,onAfterRender:l,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Jz({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:i,emptyInfo:r}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=i.length>0;let s=r,o=!1;for(const a of i){var n;s=a,o=(null===(n=a.layer)||void 0===n?void 0:n.onHover(a,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,wS(e,{enable:!0,copyState:!0})),this.tooltip=new tEe(this.canvas),Fo(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new mz;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new bwe(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in Yj)this.eventManager.on(r,this._onEvent);this.viewManager=new M0e({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new I0e(e,{deck:this,stats:this.stats,viewport:i,timeline:n}),this.effectManager=new H0e,this.deckRenderer=new q0e(e),this.deckPicker=new Q0e(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:i}=this.layerManager.context;Fo(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),$e.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const i=il.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}E(jx,"defaultProps",DG),E(jx,"VERSION",REe.VERSION);class Hx{constructor(e,n){E(this,"opts",void 0),E(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:i}=this.source,{size:r}=n;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const o=n.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[o+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function kv(t){return t.stride||t.size*t.bytesPerElement}function RG(t,e){e.offset&&$e.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=kv(t),s=(void 0!==e.vertexOffset?e.vertexOffset:t.vertexOffset||0)*n+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}class Awe{constructor(e,n,i){E(this,"gl",void 0),E(this,"id",void 0),E(this,"size",void 0),E(this,"settings",void 0),E(this,"value",void 0),E(this,"doublePrecision",void 0),E(this,"_buffer",void 0),E(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const r=n.logicalType||n.type,s=5130===r;let a,{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0),a=s?5126:!r&&n.isIndexed?e&&PS(e,"ELEMENT_INDEX_UINT32")?5125:5123:r||5126;let c=function Ewe(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(r||a||5126);this.doublePrecision=s,s&&!1===n.fp64&&(c=Float32Array),this.value=null,this.settings={...n,defaultType:c,defaultValue:o,logicalType:r,type:a,size:this.size,bytesPerElement:c.BYTES_PER_ELEMENT},this.state={...i,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new St(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*kv(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),op.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=function wwe(t,e){const n=RG(t,e);return{high:n,low:{...n,offset:n.offset+4*t.size}}}(this.getAccessor(),n||{});return i[e]=new Hx(this,s.high),i["".concat(e,"64Low")]=r?new Hx(this,s.low):new Float32Array(this.size),i}if(n){const i=RG(this.getAccessor(),n);return{[e]:new Hx(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:i,size:r}=this,s=i*r;if(n&&s&&n.length>=s){const o=new Array(r).fill(1/0),a=new Array(r).fill(-1/0);for(let c=0;c<s;)for(let l=0;l<r;l++){const u=n[c++];u<o[l]&&(o[l]=u),u>a[l]&&(a[l]=u)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let i;i=ArrayBuffer.isView(e)?{value:e}:e instanceof St?{buffer:e}:e;const r={...this.settings,...i};if(n.bufferAccessor=r,n.bounds=null,i.constant){let s=i.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),n.constant&&this._areValuesEqual(s,this.value))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(i.buffer){const s=i.buffer;n.externalBuffer=s,n.constant=!1,this.value=i.value||null;const o=i.value instanceof Float64Array;r.type=i.type||s.accessor.type,r.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(o?2:1),r.stride=kv(r)}else if(i.value){this._checkExternalBuffer(i);let s=i.value;n.externalBuffer=null,n.constant=!1,this.value=s,r.bytesPerElement=s.BYTES_PER_ELEMENT,r.stride=kv(r);const{buffer:o,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=KT(s,r));const c=s.byteLength+a+2*r.stride;o.byteLength<c&&o.reallocate(c),o.setAccessor(null),o.subData({data:s,offset:a}),r.type=i.type||o.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?KT(n,{size:this.size,startIndex:i,endIndex:r}):n.subarray(i,r),offset:i*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:i}=this,r=i.allocatedValue,s=op.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),n&&r&&o.subData({data:r instanceof Float64Array?KT(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const i=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=n.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof i)&&this.settings.normalized&&!("normalized"in e)&&$e.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return n[i]=e,n;if(!e)return n[i]=r[0],n;switch(s){case 4:n[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:n[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:n[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:n[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let o=s;for(;--o>=0;)n[i+o]=Number.isFinite(e[o])?e[o]:r[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==n[r])return!1;return!0}}const OG=[],PG=[];function Uv(t,e=0,n=1/0){let i=OG;const r={index:-1,data:t,target:[]};return t?"function"==typeof t[Symbol.iterator]?i=t:t.length>0&&(PG.length=t.length,i=PG):i=OG,(e>0||Number.isFinite(n))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,n),r.index=e-1),{iterable:i,objectInfo:r}}function NG(t){return t&&t[Symbol.asyncIterator]}const Twe=[],Vv=[[0,1/0]];function zx(t){const{source:e,target:n,start:i=0,size:r,getData:s}=t,a=e.length,c=(t.end||n.length)-i;if(a>c)return void n.set(e.subarray(0,c),i);if(n.set(e,i),!s)return;let l=a;for(;l<c;){const u=s(l,e);for(let d=0;d<r;d++)n[i+l]=u[d]||0,l++}}const Iwe={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function LG(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...Iwe[n],...e,...t,type:n}}function FG(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function BG(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function kG(t){t.push(t.shift())}function Gx(t,e){const{doublePrecision:n,settings:i,value:r,size:s}=t,o=n&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*o}function UG({buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:r,getData:s=o=>o}){const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*o,c=n.byteOffset,l=n.startIndices,u=r&&l,d=Gx(n,e),h=n.isConstant;if(!u&&i>=d)return;const f=h?n.value:n.getBuffer().getData({srcByteOffset:c});if(n.settings.normalized&&!h){const y=s;s=(v,_)=>n.normalizeConstant(y(v,_))}const p=h?(y,v)=>s(f,v):(y,v)=>s(f.subarray(y,y+a),v),g=t.getData({length:i}),m=new Float32Array(d);(function xwe({source:t,target:e,size:n,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return zx({source:t,target:e,size:n,getData:i}),e;let o=0,a=0;const c=i&&((u,d)=>i(u+a,d)),l=Math.min(r.length,s.length);for(let u=1;u<l;u++){const d=r[u]*n,h=s[u]*n;zx({source:t.subarray(o,d),target:e,start:a,end:h,size:n,getData:c}),o=d,a=h}a<e.length&&zx({source:[],target:e,start:a,size:n,getData:c})})({source:g,target:m,sourceStartIndices:r,targetStartIndices:l,size:a,getData:p}),t.byteLength<m.byteLength+c&&t.reallocate(m.byteLength+c),t.subData({data:m,offset:c})}class Wx extends Awe{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Vv}),E(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,i=this.settings.transition;return LG(Array.isArray(n)?e[n.find(s=>e[s])]:e[n],i)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:i=0,endRow:r=1/0}=n;this.state.updateRanges=function Swe(t,e){if(t===Vv||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],i=t.length;let r=0;for(let s=0;s<i;s++){const o=t[s];o[1]<e[0]?(n.push(o),r=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(r,0,e),n}(this.state.updateRanges,[i,r])}else this.state.updateRanges=Vv}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Twe}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:i}=this;return!i.noAlloc&&!!i.update&&(super.allocate(e,n.updateRanges!==Vv),!0)}updateBuffer({numInstances:e,data:n,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let c=!0;if(o){for(const[l,u]of s)o.call(r,this,{data:n,startRow:l,endRow:u,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[l,u]of s){const d=Number.isFinite(l)?this.getVertexOffset(l):0,h=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:d,endOffset:h})}this._checkAttributeArray()}else c=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),c}setConstantValue(e){return void 0!==e&&"function"!=typeof e&&(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:i,settings:r}=this;if(!e)return i.binaryValue=null,i.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(i.binaryValue===e)return this.clearNeedsUpdate(),!0;if(i.binaryValue=e,this.setNeedsRedraw(),r.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;return Kn(ArrayBuffer.isView(o.value),"invalid ".concat(r.accessor)),i.binaryAccessor=function Cwe(t,e){const{size:n,stride:i,offset:r,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,c=i?i/a:n,l=r?r/a:0,u=Math.floor((t.length-l)/c);return(d,{index:h,target:f})=>{if(!s){const y=h*c+l;for(let v=0;v<n;v++)f[v]=t[y+v];return f}const p=s[h],g=s[h+1]||u;let m;if(o){m=new Array(g-p);for(let y=p;y<g;y++){const v=y*c+l;f=new Array(n);for(let _=0;_<n;_++)f[_]=t[v+_];m[y-p]=f}}else if(c===n)m=t.subarray(p*n+l,g*n+l);else{m=new t.constructor((g-p)*n);let y=0;for(let v=p;v<g;v++){const _=v*c+l;for(let w=0;w<n;w++)m[y++]=t[_+w]}}return m}}(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:!!o.size&&o.size!==this.size}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const i in e)Object.assign(n,super.getShaderAttributes(i,e[i]));return n}_autoUpdater(e,{data:n,startRow:i,endRow:r,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:c,value:l,size:u,startIndices:d}=e,{accessor:h,transform:f}=a,p=c.binaryAccessor||("function"==typeof h?h:s[h]);Kn("function"==typeof p,'accessor "'.concat(h,'" is not a function'));let g=e.getVertexOffset(i);const{iterable:m,objectInfo:y}=Uv(n,i,r);for(const v of m){y.index++;let _=p(v,y);if(f&&(_=f.call(this,_)),d){const w=(y.index<d.length-1?d[y.index+1]:o)-d[y.index];if(_&&Array.isArray(_[0])){let C=g;for(const S of _)e._normalizeValue(S,l,C),C+=u}else _&&_.length>u?l.set(_,g):(e._normalizeValue(_,y.target,0),ibe({target:l,source:y.target,start:g,count:w}));g+=w*u}else e._normalizeValue(_,l,g),g+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!e.noAlloc&&"function"!=typeof e.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let i=!0;switch(n){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}const VG="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",Dwe="#version 300 es\n".concat(VG);function jG(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[i,r,s]=n;return e.includes(i)&&r&&s?{qualifier:i,type:r,name:s.split(";")[0]}:null}function HG(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{version:e=100,input:n,inputType:i,output:r}=t;if(!n)return 300===e?Dwe:e>300?"#version ".concat(e,"\n").concat(VG):"void main() {gl_FragColor = vec4(0);}";const s=function Pwe(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return gr(!1),null}}(n,i);return e>=300?"#version ".concat(e," ").concat(300===e?"es":"","\nin ").concat(i," ").concat(n,";\nout vec4 ").concat(r,";\nvoid main() {\n  ").concat(r," = ").concat(s,";\n}"):"varying ".concat(i," ").concat(n,";\nvoid main() {\n  gl_FragColor = ").concat(s,";\n}")}class zG extends Bo{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return He(e)}constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};fi(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,ld(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:o}=this._getBufferParams(n);return i<0?(this.unused[e]=r,oe.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[i]=n,this.bindOnUse||this._bindBuffer(i,r,o,s),this)}begin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,i,r;return e instanceof St?r=e:(r=e.buffer,i=e.byteSize,n=e.byteOffset),(void 0!==n||void 0!==i)&&(n=n||0,i=i||r.byteLength-n),{buffer:r,byteOffset:n,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return s&&void 0!==r?this.gl.bindBufferRange(35982,e,s,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r):this.gl.bindBufferBase(35982,e,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class Nwe{constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=n;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(){this._setupBuffers(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],i=e?n[e]:null;return i?i instanceof St?i:i.buffer:null}getData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyingName:n}=e,i=this.getBuffer(n);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Q(He(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap)r in n&&(i[this.feedbackMap[r]]=r);Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if("string"==typeof s){const o=n[s],{byteLength:a,usage:c,accessor:l}=o;i[r]=this._createNewBuffer(r,{byteLength:a,usage:c,accessor:l})}}return i}_setupBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:i})}_setupTransformFeedback(e,n){let{model:i}=n;const{program:r}=i;e.transformFeedback=new zG(this.gl,{program:r,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:n,feedbackBuffers:i})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];n[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],Q(i[s]instanceof St)}return{sourceBuffers:n,feedbackBuffers:i}}_createNewBuffer(e,n){const i=new St(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}function GG(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const i=parseInt(n[1],10);Number.isFinite(i)&&(e=i)}return e}const Lwe={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},jv="transform_uSize_",WG="transform_position";const zwe={10241:9728,10240:9728,10242:33071,10243:33071};class Wwe{constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:n,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),c=Object.assign({},e.parameters);let l=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const d in this.samplerTextureMap)a[d]=i[this.samplerTextureMap[d]];this._setSourceTextureParameters();const u=function kwe(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=t;const r={};let s,o;n&&(({width:s,height:o}=i),r["".concat(jv).concat(n)]=[s,o]);for(const a in e)({width:s,height:o}=e[a]),r["".concat(jv).concat(a)]=[s,o];return r}({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,u)}return this.hasTargetTexture&&(l=!1,c.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:a,discard:l,parameters:c}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(){this._setupTextures(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],i=wv(n);if(!e)return i;const r=i.constructor,s=function Owe(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return gr(!1),null}}(this.targetTextureType),o=new r(i.length*s/4);let a=0;for(let c=0;c<i.length;c+=4)for(let l=0;l<s;l++)o[a++]=i[c+l];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:i}=e;if(i instanceof Jn)return i;const r=n[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!=typeof e||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new St(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:n,targetTexture:i})}}_updateBinding(e,n){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:c}=e;c?(c.update({attachments:{36064:s},resizeAttachments:!1}),c.resize({width:o,height:a})):e.framebuffer=new mn(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const i in n)n[i].setParameters(zwe)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);return n[this._swapTexture]=e.targetTexture,{sourceTextures:n,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const n=function fye(t,e){Q(t instanceof Jn||t instanceof dye||t instanceof hye);const n=t.constructor,{gl:i,width:r,height:s,format:o,type:a,dataFormat:c,border:l,mipmaps:u}=t;return new n(i,Object.assign({width:r,height:s,format:o,type:a,dataFormat:c,border:l,mipmaps:u},e))}(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceTextures:n,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:c}=function Bwe(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:i,targetTexture:r}=t,o=Object.keys(n).length,a=null;const c={};let l=e,u={};if(o>0||i){const d=l.split("\n"),h=d.slice();if(d.forEach((f,p,g)=>{if(o>0){const m=function Hwe(t,e){const n={},i=function Uwe(t){return jG(t,["attribute","in"])}(t);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const o="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:c,uniformDeclerations:l}=function Vwe(t){const e="".concat("transform_uSampler_").concat(t),n="".concat(jv).concat(t);return{samplerName:e,sizeName:n,uniformDeclerations:"  uniform sampler2D ".concat(e,";\n  uniform vec2 ").concat(n,";")}}(s),u=function Rwe(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return gr(!1),null}}(r),d="  ".concat(r," ").concat(s," = transform_getInput(").concat(a,", ").concat(c,").").concat(u,";\n");return n[a]=s,{updatedLine:o,inject:{"vs:#decl":l,"vs:#main-start":d},samplerTextureMap:n}}return null}(f,n);if(m){const{updatedLine:y,inject:v}=m;h[p]=y,u=gS([u,v]),Object.assign(c,m.samplerTextureMap),o--}}i&&!a&&(a=function jwe(t,e){const n=jG(t,["varying","out"]);return n&&n.name===e?n.type:null}(f,i))}),i){Q(r);const f="".concat(jv).concat(i),p="uniform vec2 ".concat(f,";\n"),g="     vec2 ".concat(WG," = transform_getPos(").concat(f,");\n     gl_Position = vec4(").concat(WG,", 0, 1.);\n");u=gS([u,{"vs:#decl":p,"vs:#main-start":g}])}l=h.join("\n")}return{vs:l,targetTextureType:a,inject:u,samplerTextureMap:c}}({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),l=gS([e.inject||{},a]);return this.targetTextureType=o,this.samplerTextureMap=c,{vs:r,fs:e._fs||HG({version:GG(r),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[Lwe].concat(e.modules||[]):e.modules,uniforms:s,inject:l}}}let Hv=null;class yr extends Bo{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero||He(e)||"Chrome"===hG()}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new yr(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return yr.MAX_ATTRIBUTES=yr.MAX_ATTRIBUTES||e.getParameter(34921),yr.MAX_ATTRIBUTES}static setConstant(e,n,i){switch(i.constructor){case Float32Array:yr._setConstantFloatArray(e,n,i);break;case Int32Array:yr._setConstantIntArray(e,n,i);break;case Uint32Array:yr._setConstantUintArray(e,n,i);break;default:Q(!1)}}constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,Object.assign({},n,{id:n.id||n.program&&n.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return yr.getMaxAttributes(this.gl)}initialize(){return this.setProps(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Q(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,i){if(34963===n.target)return this.setElementBuffer(n,i);const{size:r,type:s,stride:o,offset:a,normalized:c,integer:l,divisor:u}=i,{gl:d,gl2:h}=this;return e=Number(e),this.bind(()=>{d.bindBuffer(34962,n.handle),l?(Q(He(d)),h.vertexAttribIPointer(e,r,s,o,a)):d.vertexAttribPointer(e,r,s,c,o,a),d.enableVertexAttribArray(e),h.vertexAttribDivisor(e,u||0)}),this}enable(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!n&&0===e&&!yr.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const i=this._normalizeConstantArrayValue(n),r=i.byteLength*e,s=i.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new St(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(i,this.bufferValue),o){const a=function qwe(t,e){const n=function $we(t){return(!Hv||Hv.byteLength<t)&&(Hv=new ArrayBuffer(t)),Hv}(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}(n.constructor,s);(function Xwe(t){let{target:e,source:n,start:i=0,count:r=1}=t;const s=n.length,o=r*s;let a=0;for(let c=i;a<s;a++)e[c++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+o-a),a=o)})({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==n[i])return!1;return!0}static _setConstantFloatArray(e,n,i){switch(i.length){case 1:e.vertexAttrib1fv(n,i);break;case 2:e.vertexAttrib2fv(n,i);break;case 3:e.vertexAttrib3fv(n,i);break;case 4:e.vertexAttrib4fv(n,i);break;default:Q(!1)}}static _setConstantIntArray(e,n,i){switch(Q(He(e)),i.length){case 1:e.vertexAttribI1iv(n,i);break;case 2:e.vertexAttribI2iv(n,i);break;case 3:e.vertexAttribI3iv(n,i);break;case 4:e.vertexAttribI4iv(n,i);break;default:Q(!1)}}static _setConstantUintArray(e,n,i){switch(Q(He(e)),i.length){case 1:e.vertexAttribI1uiv(n,i);break;case 2:e.vertexAttribI2uiv(n,i);break;case 3:e.vertexAttribI3uiv(n,i);break;case 4:e.vertexAttribI4uiv(n,i);break;default:Q(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:i}=n;return Q(Number.isFinite(i)),this.bind(()=>34373===e?this.gl.getVertexAttribOffset(i,e):this.gl.getVertexAttrib(i,e))}}const Jwe=/^(.+)__LOCATION_([0-9]+)$/,Zwe=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Qwe{constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.id=n.id||n.program&&n.program.id,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new yr(e),RH(this,"VertexArray","v6.0",Zwe),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e)this._setAttribute(n,e[n]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===n.target)return this.setElementBuffer(n,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,i);return r>=0&&(this.values[r]=n,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,n,s)),this}setConstant(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},i));return r>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[r]=n,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new St(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof St&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof St&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),r=i()}),r}_resolveLocationAndAccessor(e,n,i,r){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=n,oe.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const c=this._getAttributeInfo(a||o);if(!c)return s;const u=qi.resolve(c.accessor,this.accessors[o]||{},i,r),{size:d,type:h}=u;return Q(Number.isFinite(d)&&Number.isFinite(h)),{location:o,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const i=Jwe.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,n){if(n instanceof St)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof St)this.setBuffer(e,n[0],n[1]);else if(ArrayBuffer.isView(n)||Array.isArray(n))this.setConstant(e,n);else{if(!(n.buffer instanceof St))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(e,n.buffer,n)}}_setConstantAttributes(e,n){const i=Math.max(0|e,0|n);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,n){if(yr.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const i=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,n){yr.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const i=this.values[n],r=this.accessors[n];if(!i)return;const{divisor:s}=r,o=s>0;if(e.isInstanced=e.isInstanced||o,i instanceof St){const a=i;if(o){const c=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,c)}else{const c=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,c)}}}setElements(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return oe.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function Ip(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{isInteger:i=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return function eAe(t,e){const{maxElts:n=16,size:i=1}=e;let r="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(r+=",".concat(o%i==0?" ":"")),r+=Ip(t[o],e);const s=t.length>n?"...":"]";return"".concat(r).concat(s)}(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<1e-16)return i?"0":"0.";if(i||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const r=t.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function $G(t,e,n,i){const{gl:r}=t;if(!e)return{[i]:"null","Format ":"N/A"};let l,u,d,s="NOT PROVIDED",o=1,a=0,c=0;if(n&&(s=n.type,o=n.size,s=String(s).replace("Array",""),l=-1!==s.indexOf("nt")),e instanceof St){const h=e,{data:f,changed:p}=h.getDebugData();let g;return u=p?"*":"",d=f,c=h.byteLength,a=c/f.BYTES_PER_ELEMENT/o,n?g="".concat(n.divisor>0?"I ":"P "," ").concat(a," (x").concat(o,"=").concat(c," bytes ").concat(ja(r,s),")"):(l=!0,g="".concat(c," bytes")),{[i]:"".concat(u).concat(Ip(d,{size:o,isInteger:l})),"Format ":g}}return d=e,o=e.length,s=String(e.constructor.name).replace("Array",""),l=-1!==s.indexOf("nt"),{[i]:"".concat(Ip(d,{size:o,isInteger:l})," (constant)"),"Format ":"".concat(o,"x").concat(s," (constant)")}}function nAe(t,e){const{type:n,size:i}=e,r=rz(n,i);return r?"".concat(t," (").concat(r.name,")"):t}function qG(t){let{header:e="Uniforms",program:n,uniforms:i,undefinedOnly:r=!1}=t;Q(n);const o=".*Matrix",c={},l=Object.keys(n._uniformSetters).sort();let u=0;for(const f of l)!f.match(".*_.*")&&!f.match(o)&&$x({table:c,header:e,uniforms:i,uniformName:f,undefinedOnly:r})&&u++;for(const f of l)f.match(o)&&$x({table:c,header:e,uniforms:i,uniformName:f,undefinedOnly:r})&&u++;for(const f of l)c[f]||$x({table:c,header:e,uniforms:i,uniformName:f,undefinedOnly:r})&&u++;let d=0;const h={};if(!r)for(const f in i){const p=i[f];c[f]||(d++,h[f]={Type:"NOT USED: ".concat(p),[e]:Ip(p)})}return{table:c,count:u,unusedTable:h,unusedCount:d}}function $x(t){let{table:e,header:n,uniforms:i,uniformName:r,undefinedOnly:s}=t;const o=i[r],a=function iAe(t){return null!=t}(o);return!(s&&a||(e[r]={[n]:a?Ip(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},0))}function XG(t){const{type:e,size:n}=t.accessor,i=rz(e,n);return i?"".concat(i.name," ").concat(t.name):t.name}const sAe={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function aAe(t,e){const{attributeMap:n=sAe}=e||{};return n&&n[t]||t}function cAe(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}Q(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const YG=()=>{},dAe={};class bd{constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{id:i=$i("model")}=n;Q(bv(e)),this.id=i,this.gl=e,this.id=n.id||$i("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||wp.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u}=e;this.programProps={program:n,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Q(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u}=e;this.programProps={program:n,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Q(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Q(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function oAe(t,e,n){const i={};let r=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=aAe(s,n);if("indices"===s)r=o;else if(o.constant)i[a]=o.value;else{const c=o.value,l={...o};delete l.value,i[a]=[new St(t,c),l],cAe(s,l)}}if(r){const s=r.value||r;Q(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new St(t,{data:s,target:34963}),o]}return i}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(ld(e))return this;const n={};for(const i in e){const r=e[i];n[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(n),this}setUniforms(){return Object.assign(this.uniforms,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return DS(this.program.gl,e),this}draw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:c=this.vertexArray}=e;let l;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(r),oe.priority>=2&&(l=this._logDrawCallStart(2));const u=this.vertexArray.getDrawParams(),{isIndexed:d=u.isIndexed,indexType:h=u.indexType,indexOffset:f=u.indexOffset,vertexArrayInstanced:p=u.isInstanced}=this.props;p&&!this.isInstanced&&oe.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:g,instanceCount:m}=this,{onBeforeRender:y=YG,onAfterRender:v=YG}=this.props;y(),this.program.setUniforms(this.uniforms);const _=this.program.draw(Object.assign(dAe,e,{logPriority:l,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:c,transformFeedback:o,isIndexed:d,indexType:h,isInstanced:g,instanceCount:m,offset:d?f:0}));return v(),oe.priority>=2&&this._logDrawCallEnd(l,c,i),_}transform(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{discard:n=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),n&&(s=Object.assign({},s,{35977:n})),r.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(o=>o.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return oe.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:o,defines:a,varyings:c,bufferMode:l,transpileToGLSL100:u}=this.programProps;n=this.programManager.get({vs:i,fs:r,modules:s,inject:o,defines:a,varyings:c,bufferMode:l,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Q(n instanceof oz,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Qwe(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof St&&n.delete()}}_setAnimationProps(e){this.animated&&Q(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(ld(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new zG(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),oe.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:oe.level<=2})(),e}_logDrawCallEnd(e,n,i,r){if(void 0===e)return;const s=function tAe(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=$G(e,e.elements,null,n));const r=e.values;for(const s in r){const o=e._getAttributeInfo(s);if(o){let a="".concat(s,": ").concat(o.name);const c=e.accessors[o.location];c&&(a="".concat(s,": ").concat(nAe(o.name,c))),i[a]=$G(e,r[s],c,n)}}return i}({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:c}=qG({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:l,count:u}=qG({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});u>0&&oe.log("MISSING UNIFORMS",Object.keys(l))(),c>0&&oe.log("UNUSED UNIFORMS",Object.keys(a))();const d=function rAe(t){const e={},n="Accessors for ".concat(t.id);for(const i of t.attributeInfos)if(i){const r=XG(i);e["in ".concat(r)]={[n]:JSON.stringify(i.accessor)}}for(const i of t.varyingInfos)if(i){const r=XG(i);e["out ".concat(r)]={[n]:JSON.stringify(i.accessor)}}return e}(this.vertexArray.configuration);oe.table(e,s)(),oe.table(e,o)(),oe.table(e+1,d)(),r&&r.log({logLevel:2,message:"Rendered to ".concat(r.id)}),oe.groupEnd(2)()}}class qx{static isSupported(e){return He(e)}constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:i}=this;e&&e.delete(),n&&n.delete(),i&&i.delete()}run(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{clearRenderTarget:n=!0}=e,i=this._updateDrawOptions(e);n&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=e||i.swap();Q(e,"Nothing to swap")}getBuffer(){return this.bufferTransform&&this.bufferTransform.getBuffer(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)}getData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)i.update(e)}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new bd(n,Object.assign({},e,{fs:e.fs||HG({version:GG(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=r.updateModelProps(n);return n}_buildResourceTransforms(e,n){(function hAe(t){return!(ld(t.feedbackBuffers)&&ld(t.feedbackMap)&&!(t.varyings&&t.varyings.length>0))})(n)&&(this.bufferTransform=new Nwe(e,n)),function fAe(t){return!(ld(t._sourceTextures)&&!t._targetTexture&&!t._targetTextureVarying)}(n)&&(this.textureTransform=new Wwe(e,n)),Q(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=Object.assign(n,r.getDrawOptions(n));return n}}const EAe={interpolation:class pAe{constructor({gl:e,attribute:n,timeline:i}){E(this,"gl",void 0),E(this,"type","interpolation"),E(this,"attributeInTransition",void 0),E(this,"settings",void 0),E(this,"attribute",void 0),E(this,"transition",void 0),E(this,"currentStartIndices",void 0),E(this,"currentLength",void 0),E(this,"transform",void 0),E(this,"buffers",void 0),this.gl=e,this.transition=new dp(i),this.attribute=n,this.attributeInTransition=new Wx(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=function mAe(t,e){const n=BG(e.size);return new qx(t,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(e,n);const r={byteLength:0,usage:35050};this.buffers=[new St(e,r),new St(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0)return void this.transition.cancel();this.settings=e;const{buffers:r,attribute:s}=this;kG(r);const o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)UG({buffer:a,...o});this.currentStartIndices=s.startIndices,this.currentLength=Gx(s,n),this.attributeInTransition.setData({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:FG(0,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:i}=this.settings,{time:r}=this.transition;let s=r/n;i&&(s=i(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}},spring:class _Ae{constructor({gl:e,attribute:n,timeline:i}){E(this,"gl",void 0),E(this,"type","spring"),E(this,"attributeInTransition",void 0),E(this,"settings",void 0),E(this,"attribute",void 0),E(this,"transition",void 0),E(this,"currentStartIndices",void 0),E(this,"currentLength",void 0),E(this,"texture",void 0),E(this,"framebuffer",void 0),E(this,"transform",void 0),E(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new dp(i),this.attribute=n,this.attributeInTransition=new Wx(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=function vAe(t){return new Jn(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function bAe(t,e){return new mn(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function yAe(t,e,n){const i=BG(e.size);return new qx(t,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(e,n,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new St(e,r),new St(e,r),new St(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){const{buffers:r,attribute:s}=this,o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)UG({buffer:a,...o});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=Gx(s,n),this.attributeInTransition.setData({buffer:r[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:FG(0,s)}})}update(){const{buffers:e,transform:n,framebuffer:i,transition:r}=this;if(!r.update())return!1;const o=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:o.stiffness,damping:o.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),kG(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),wv(i)[0]>0||r.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}};class wAe{constructor(e,{id:n,timeline:i}){E(this,"id",void 0),E(this,"isSupported",void 0),E(this,"gl",void 0),E(this,"timeline",void 0),E(this,"transitions",void 0),E(this,"needsRedraw",void 0),E(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=qx.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],o=s.getTransitionSetting(n);o&&this._updateAttribute(r,s,o)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(n))&&this._removeTransition(r)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const i=this.transitions[n];i.inProgress&&(e[n]=i.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported)return void $e.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();r&&this._removeTransition(e);const o=EAe[i.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,gl:this.gl}):($e.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const KG="attributeManager.invalidate";class IAe{constructor(e,{id:n="attribute-manager",stats:i,timeline:r}={}){E(this,"id",void 0),E(this,"gl",void 0),E(this,"attributes",void 0),E(this,"updateTriggers",void 0),E(this,"needsRedraw",void 0),E(this,"userData",void 0),E(this,"stats",void 0),E(this,"attributeTransitionManager",void 0),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new wAe(e,{id:"".concat(n,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)void 0!==this.attributes[n]&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const i=this._invalidateTrigger(e,n);gi(KG,this,e,i)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);gi(KG,this,"all")}update({data:e,numInstances:n,startIndices:i=null,transitions:r,props:s={},buffers:o={},context:a={}}){let c=!1;gi("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const l in this.attributes){const u=this.attributes[l],d=u.settings.accessor;u.startIndices=i,u.numInstances=n,s[l]&&$e.removed("props.".concat(l),"data.attributes.".concat(l))(),u.setExternalBuffer(o[l])||u.setBinaryValue("string"==typeof d?o[d]:void 0,e.startIndices)||"string"==typeof d&&!o[d]&&u.setConstantValue(s[d])||u.needsUpdate()&&(c=!0,this._updateAttribute({attribute:u,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||u.needsRedraw()}c&&gi("attributeManager.updateEnd",this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:i}=this,r={...i.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=o)}return r}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const i={};for(const r in e)n[r]||Object.assign(i,e[r].getShaderAttributes());return i}_add(e,n={}){for(const i in e)this.attributes[i]=this._createAttribute(i,e[i],n);this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,i){const r={...n,id:e,size:(n.isIndexed?1:n.size)||1,divisor:i.instanced?1:n.divisor||0};return new Wx(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(o=>{const a=i[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:i}=e;gi("attribute.updateStart",n),n.constant?n.setConstantValue(n.value):(n.allocate(i)&&gi("attribute.allocate",n,i),n.updateBuffer(e)&&(this.needsRedraw=!0,gi("attribute.updateEnd",n,i)))}}function ZG(t,e,n,i,r){const s=e-t;return(n-e)*r+-s*i+s+e}function QG(t,e){if(Array.isArray(t)){let n=0;for(let i=0;i<t.length;i++){const r=t[i]-e[i];n+=r*r}return Math.sqrt(n)}return Math.abs(t-e)}const OAe={interpolation:class MAe extends dp{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:i,duration:r,easing:s}}=this,o=s(e/r);this._value=my(n,i,o)}},spring:class RAe extends dp{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=function DAe(t,e,n,i,r){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=ZG(t[o],e[o],n[o],i,r);return s}return ZG(t,e,n,i,r)}(s,o,n,i,r);const c=QG(a,n),l=QG(a,o);c<1e-5&&l<1e-5&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}};class PAe{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,i,r){const{transitions:s}=this;if(s.has(e)){const c=s.get(e),{value:l=c.settings.fromValue}=c;n=l,this.remove(e)}if(!(r=LG(r)))return;const o=OAe[r.type];if(!o)return void $e.error("unsupported transition type '".concat(r.type,"'"))();const a=new o(this.timeline);a.start({...r,fromValue:n,toValue:i}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,i]of this.transitions)i.update(),e[n]=i.value,i.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function FAe(t,e){if(!t.transitions)return!1;const n={},i=Yx(t);let r=!1;for(const s in t.transitions){const o=i[s],a=o&&o.type;("number"===a||"color"===a||"array"===a)&&Xx(t[s],e[s],o)&&(n[s]=!0,r=!0)}return!!r&&n}function e4({newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:r="props"}){if(e===t)return!1;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(r,".").concat(s," added");const o=Xx(t[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const o=Xx(t[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}}return!1}function Xx(t,e,n){let i=n&&n.equal;return i&&!i(t,e,n)||!i&&(i=t&&e&&t.equals,i&&!i.call(t,e))?"changed deeply":i||e===t?null:"changed shallowly"}function UAe(t,e){if(null===e)return!0;const n=e.extensions,{extensions:i}=t;if(i===n)return!1;if(!n||!i||i.length!==n.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(n[r]))return!0;return!1}function t4(t,e,n){let i=t.updateTriggers[n];i=i??{};let r=e.updateTriggers[n];return r=r??{},e4({oldProps:r,newProps:i,triggerName:n})}function Yx(t){const e=t[Iv],n=e&&e.constructor;return n?n._propTypes:{}}function WAe(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(i=>"project64"===i.name))){const i=n.modules.findIndex(r=>"project32"===r.name);i>=0&&n.modules.splice(i,1)}if("inject"in e)if(t.inject){const i={...t.inject};for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];n.inject=i}else n.inject=e.inject;return n}function Kx(t,e,n=!1){const i=e.projectPosition(t);if(n&&e instanceof $a){const[r,s,o=0]=t,a=e.getDistanceScales([r,s]);i[2]=o*a.unitsPerMeter[2]}return i}function n4(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[o,a,c=0]=t;switch(n&&([o,a,c]=zf([],[o,a,c,1],n)),i){case Qe.LNGLAT:return Kx([o,a,c],e,s);case Qe.LNGLAT_OFFSETS:return Kx([o+r[0],a+r[1],c+(r[2]||0)],e,s);case Qe.METER_OFFSETS:return Kx(Uj(r,[o,a,c]),e,s);default:return e.isGeospatial?[o+r[0],a+r[1],c+r[2]]:e.projectPosition([o,a,c])}}const XAe={10241:9987,10240:9729,10242:33071,10243:33071},Jx={},JAe={boolean:{validate:(t,e)=>!0,equal:(t,e,n)=>!!t==!!e},number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},color:{validate:(t,e)=>e.optional&&!t||Dp(t)&&(3===t.length||4===t.length),equal:(t,e,n)=>Zx(t,e)},accessor:{validate(t,e){const n=zv(t);return"function"===n||n===zv(e.value)},equal:(t,e,n)=>"function"==typeof e||Zx(t,e)},array:{validate:(t,e)=>e.optional&&!t||Dp(t),equal:(t,e,n)=>n.compare?Zx(t,e):t===e},object:{equal:(t,e,n)=>n.compare?sd(t,e):t===e},function:{validate:(t,e)=>e.optional&&!t||"function"==typeof t,equal:(t,e,n)=>!n.compare||t===e},data:{transform:(t,e,n)=>{const{dataTransform:i}=n.props;return i&&t?i(t):t}},image:{transform:(t,e,n)=>function YAe(t,e){const n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof Jn)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new Jn(n,{...e,parameters:{...XAe,...i,...t.props.textureParameters}});return Jx[r.id]=!0,r}(n,t),release:t=>{!function KAe(t){!t||!(t instanceof Jn)||Jx[t.id]&&(t.delete(),delete Jx[t.id])}(t)}}};function Zx(t,e){if(t===e)return!0;if(!Dp(t)||!Dp(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function QAe(t,e){switch(zv(e)){case"object":return Mp(t,e);case"array":return Mp(t,{type:"array",value:e,compare:!1});case"boolean":return Mp(t,{type:"boolean",value:e});case"number":return Mp(t,{type:"number",value:e});case"function":return Mp(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Mp(t,e){return"type"in e?{name:t,...JAe[e.type],...e}:"value"in e?{name:t,type:zv(e.value),...e}:{name:t,type:"object",value:e}}function Dp(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function zv(t){return Dp(t)?"array":null===t?"null":typeof t}function r4(t){return Gv(t,"_mergedDefaultProps")||(function tCe(t){if(!t.prototype)return;const n=Object.getPrototypeOf(t),i=r4(n),s=function ZAe(t){const e={},n={},i={};for(const[r,s]of Object.entries(t)){const o=s?.deprecatedFor;if(o)i[r]=Array.isArray(o)?o:[o];else{const a=QAe(r,s);e[r]=a,n[r]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:i}}(Gv(t,"defaultProps")||{}),o=function nCe(t,e,n){const i=Object.create(null);Object.assign(i,e,t);const r=function oCe(t){const e=Gv(t,"layerName")||Gv(t,"componentName");return e||$e.once(0,"".concat(t.name,".componentName not specified"))(),e||t.name}(n);return delete t.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}(s.defaultProps,i,t),a={...n._propTypes,...s.propTypes};!function rCe(t,e){const n={},i={};for(const r in e){const s=e[r],{name:o,value:a}=s;s.async&&(n[o]=a,i[o]=sCe(o))}t[gd]=n,t[ol]={},Object.defineProperties(t,i)}(o,a);const c={...n._deprecatedProps,...s.deprecatedProps};(function iCe(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(n);for(const s of e[n])s4(this,s)||(this[s]=i);$e.deprecated(r,e[n].join("/"))()}})})(o,c),t._mergedDefaultProps=o,t._propTypes=a,t._deprecatedProps=c}(t),t._mergedDefaultProps)}function sCe(t){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||NG(e)?this[ol][t]=e:this[za][t]=e},get(){if(this[za]){if(t in this[za])return this[za][t]||this[gd][t];if(t in this[ol]){const e=this[Iv]&&this[Iv].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[gd][t]}}return this[gd][t]}}}function s4(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Gv(t,e){return s4(t,e)&&t[e]}let aCe=0;class Qx{constructor(...e){E(this,"id",void 0),E(this,"props",void 0),E(this,"count",void 0),this.props=function eCe(t,e){const n=r4(t.constructor),i=Object.create(n);i[Iv]=t,i[ol]={},i[za]={};for(let r=0;r<e.length;++r){const s=e[r];for(const o in s)i[o]=s[o]}return Object.freeze(i),i}(this,e),this.id=this.props.id,this.count=aCe++}clone(e){const{props:n}=this,i={};for(const r in n[gd])r in n[za]?i[r]=n[za][r]:r in n[ol]&&(i[r]=n[ol][r]);return new this.constructor({...n,...i,...e})}}E(Qx,"componentName","Component"),E(Qx,"defaultProps",{});const cCe=Object.freeze({});class lCe{constructor(e){E(this,"component",void 0),E(this,"onAsyncPropUpdated",void 0),E(this,"asyncProps",void 0),E(this,"oldProps",void 0),E(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps||cCe}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){const n=e[za]||{},i=e[ol]||e,r=e[gd]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in i){const o=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if("string"==typeof n&&(n=this._fetch(e,n)),n instanceof Promise)return void this._watchPromise(e,n);if(NG(n))return void this._resolveAsyncIterable(e,n);this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const i=this.asyncProps[e];return n!==i.resolvedValue&&n!==i.lastValue&&(i.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const i=this.asyncProps[e];i&&(n=this._postProcessValue(i,n),i.resolvedValue=n,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(e,n,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&void 0!==n&&(this._freezeAsyncOldProps(),r.resolvedValue=n,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const i=this.asyncProps[e];if(i){i.pendingLoadCount++;const r=i.pendingLoadCount;n.then(s=>{s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r),this._onResolve(e,s)}).catch(s=>{this._onError(e,s)})}}_resolveAsyncIterable(e,n){var i=this;return ee(function*(){if("data"!==e)return void i._setPropValue(e,n);const r=i.asyncProps[e];if(!r)return;r.pendingLoadCount++;const s=r.pendingLoadCount;let o=[],a=0;var u,c=!1,l=!1;try{for(var h,d=cx(n);c=!(h=yield d.next()).done;c=!1){const f=h.value;{const{dataTransform:p}=i.component.props;o=p?p(f,o):o.concat(f),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:a,endRow:o.length}]}),a=o.length,i._setAsyncPropValue(e,o,s)}}}catch(f){l=!0,u=f}finally{try{c&&null!=d.return&&(yield d.return())}finally{if(l)throw u}}i._onResolve(e,o)})()}_postProcessValue(e,n){const i=e.type;return i&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(n,i,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const r=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class uCe extends lCe{constructor({attributeManager:e,layer:n}){super(n),E(this,"attributeManager",void 0),E(this,"needsRedraw",void 0),E(this,"needsUpdate",void 0),E(this,"subLayers",void 0),E(this,"usesPickingColorCache",void 0),E(this,"changeFlags",void 0),E(this,"viewport",void 0),E(this,"uniformTransitions",void 0),E(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}_fetch(e,n){const i=this.component.props.fetch;return i?i(n,{propName:e,layer:this.layer}):super._fetch(e,n)}_onResolve(e,n){const i=this.component.props.onDataLoad;"data"===e&&i&&i(n,{propName:e,layer:this.layer})}_onError(e,n){this.layer.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const o4=2**24-1,mCe=Object.freeze([]),_Ce=xv(({oldViewport:t,viewport:e})=>t.equals(e));let to=new Uint8ClampedArray(0);const yCe={data:{type:"data",value:mCe,async:!0},dataComparator:{type:"function",value:null,compare:!1,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:o}=n.context;var a;r=r||n.getLoadOptions(),i=i||n.props.loaders,s&&(r={...r,fetch:{...null===(a=r)||void 0===a?void 0:a.fetch,signal:s}});let c=o.contains(t);return!c&&!r&&(o.add({resourceId:t,data:Cp(t,i),persistent:!1}),c=!0),c?o.subscribe({resourceId:t,onChange:l=>{var u;return null===(u=n.internalState)||void 0===u?void 0:u.reloadAsyncProp(e,l)},consumerId:n.id,requestId:e}):Cp(t,i,r)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Qe.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,100*-t],compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class cl extends Qx{constructor(...e){super(...e),E(this,"internalState",null),E(this,"lifecycle","Awaiting state"),E(this,"context",void 0),E(this,"state",void 0),E(this,"parent",null)}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}project(e){Kn(this.internalState);const n=this.internalState.viewport||this.context.viewport,i=n4(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,s,o]=jj(i,n.pixelProjectionMatrix);return 2===e.length?[r,s]:[r,s,o]}unproject(e){return Kn(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){return Kn(this.internalState),function qAe(t,e){const{viewport:n,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function $Ae(t){const{viewport:e,modelMatrix:n,coordinateOrigin:i}=t;let{coordinateSystem:r,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return r===Qe.DEFAULT&&(r=e.isGeospatial?Qe.LNGLAT:Qe.CARTESIAN),void 0===s&&(s=r),void 0===o&&(o=i),{viewport:e,coordinateSystem:r,coordinateOrigin:i,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}(e),{geospatialOrigin:c,shaderCoordinateOrigin:l,offsetMode:u}=pz(n,i,r),d=n4(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:u});u&&function xle(t,e,n){t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2]}(d,d,n.projectPosition(c||l));return d}(e,{viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Qe.DEFAULT||e===Qe.LNGLAT||e===Qe.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Kn(e instanceof Uint8Array);const[n,i,r]=e;return n+256*i+65536*r-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function HAe(t){if(!function GAe(t){return null!==t&&"object"==typeof t}(t))throw new Error("count(): argument not an object");if("function"==typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function zAe(t){return null!==t&&"object"==typeof t&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error("count(): argument not a container")}(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;const n=this.getAttributeManager();if(!n)return null;const{positions:i,instancePositions:r}=n.attributes;return null===(e=i||r)||void 0===e?void 0:e.getBounds()}getShaders(e){for(const n of this.props.extensions)e=WAe(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:i}=e.changeFlags;if(i&&n)if(Array.isArray(i))for(const c of i)n.invalidateAll(c);else n.invalidateAll();const{props:r,oldProps:s}=e,o=Number.isInteger(s.highlightedObjectIndex)||s.pickable,a=Number.isInteger(r.highlightedObjectIndex)||r.pickable;if(o!==a&&n){const{pickingColors:c,instancePickingColors:l}=n.attributes,u=c||l;u&&(a&&u.constant&&(u.constant=!1,n.invalidate(u.id)),!u.value&&!a&&(u.constant=!0,u.value=[0,0,0]))}}finalizeState(e){for(const i of this.getModels())i.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e}){const{index:r}=e;return r>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[r]),e}raiseError(e,n){var i,r,s,o;n&&(e.message="".concat(n,": ").concat(e.message)),null!==(i=(r=this.props).onError)&&void 0!==i&&i.call(r,e)||null===(s=this.context)||void 0===s||null===(o=s.onError)||void 0===o||o.call(s,e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var e;return(null===(e=this.internalState)||void 0===e?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!_Ce({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&("all"===e?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,i=this.getNumInstances(),r=this.getStartIndices();e.update({data:n.data,numInstances:i,startIndices:r,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),i=Object.create(this.props);for(const r in n)Object.defineProperty(i,r,{value:n[r]});return i}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const i=Math.floor(to.length/3);if(this.internalState.usesPickingColorCache=!0,i<n){n>o4&&$e.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),to=op.allocate(to,n,{size:3,copy:!0,maxCount:Math.max(n,o4)});const r=Math.floor(to.length/3),s=[];for(let o=i;o<r;o++)this.encodePickingColor(o,s),to[3*o+0]=s[0],to[3*o+1]=s[1],to[3*o+2]=s[2]}e.value=to.subarray(0,3*n)}_setModelAttributes(e,n){const s=this.getAttributeManager().getShaderAttributes(n,e.userData.excludeAttributes||{});e.setAttributes(s)}disablePickingIndex(e){this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,r=n||i;if(!r)return;const s=r.getVertexOffset(e),o=r.getVertexOffset(e+1);r.buffer.subData({data:new Uint8Array(o-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==to.buffer&&(i.value=to.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){Kn(!this.internalState),Kn(Number.isFinite(this.props.coordinateSystem)),gi("layer.initialize",this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new uCe({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>($e.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.layer=this,this.internalState.uniformTransitions=new PAe(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){gi("layer.matched",this,this===e);const{state:n,internalState:i}=e;this!==e&&(this.internalState=i,this.internalState.layer=this,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(gi("layer.update",this,e),!e)return;const n=this.props,i=this.context,r=this.internalState,s=i.viewport,o=this._updateUniformTransition();r.propsInTransition=o,i.viewport=r.viewport||s,this.props=o;try{const a=this._getUpdateParams(),c=this.getModels();if(i.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const u of this.props.extensions)u.updateState.call(this,a,u);const l=this.getModels()[0]!==c[0];this._postUpdate(a,l)}finally{i.viewport=s,this.props=n,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){gi("layer.finalize",this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();const r=this.props,s=this.context;this.props=this.internalState.propsInTransition||r,n.opacity=Math.pow(this.props.opacity,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,c=a&&a(n)||[0,0];Fo(s.gl,{polygonOffset:c}),Ur(s.gl,i,()=>{const l={moduleParameters:e,uniforms:n,parameters:i,context:s};for(const u of this.props.extensions)u.draw.call(this,l,u);this.draw(l)})}finally{this.props=r}}getChangeFlags(){var e;return null===(e=this.internalState)||void 0===e?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const r in e)if(e[r]){let s=!1;if("dataChanged"===r){const o=e[r],a=n[r];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0)}n[r]||(n[r]=e[r],s=!0),s&&gi("layer.changeFlag",this,r,e)}const i=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=i,n.somethingChanged=i||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const i=function LAe(t,e){const n=e4({newProps:t,oldProps:e,propTypes:Yx(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function BAe(t,e){if(null===e)return"oldProps is null, initial diff";let n=!1;const{dataComparator:i,_dataDiff:r}=t;return i?i(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&r&&(n=r(t.data,e.data)||n),n}(t,e);let r=!1;return i||(r=function kAe(t,e){if(null===e)return{all:!0};if("all"in t.updateTriggers&&t4(t,e,"all"))return{all:!0};const n={};let i=!1;for(const r in t.updateTriggers)"all"!==r&&t4(t,e,r)&&(n[r]=!0,i=!0);return!!i&&n}(t,e)),{dataChanged:i,propsChanged:n,updateTriggersChanged:r,extensionsChanged:UAe(t,e),transitionsChanged:FAe(t,e)}}(e,n);if(i.updateTriggersChanged)for(const s in i.updateTriggersChanged)i.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(i.transitionsChanged)for(const s in i.transitionsChanged){var r;this.internalState.uniformTransitions.add(s,n[s],e[s],null===(r=e.transitions)||void 0===r?void 0:r[s])}return this.setChangeFlags(i)}validateProps(){!function NAe(t){const e=Yx(t);for(const n in e){const i=e[n],{validate:r}=i;if(r&&!r(t[n],i))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:i}=this.props;e.picked&&"function"==typeof i&&(n.pickingHighlightColor=i(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new IAe(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:i,oldProps:r}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s?.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:c}=i;if(n||r.autoHighlight!==o||r.highlightedObjectIndex!==a||r.highlightColor!==c){const l={};o||(l.pickingSelectedColor=null),Array.isArray(c)&&(l.pickingHighlightColor=c),(n||a!==r.highlightedObjectIndex)&&(l.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(l)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags;const i=this.getAttributeManager(),r=!!i&&i.getNeedsRedraw(e);return n=n||r,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}E(cl,"defaultProps",yCe),E(cl,"layerName","Layer");class eI extends cl{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:i}=this.props;return i&&i[e]&&i[e].type||n}getSubLayerRow(e,n,i){return e.__source={parent:this,object:n,index:i},e}getSubLayerAccessor(e){if("function"==typeof e){const n={index:-1,data:this.props.data,target:[]};return(i,r)=>i&&i.__source?(n.index=i.__source.index,e(i.__source.object,n)):e(i,r)}return e}getSubLayerProps(e={}){var n;const{opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:c,autoHighlight:l,highlightColor:u,coordinateSystem:d,coordinateOrigin:h,wrapLongitude:f,positionFormat:p,modelMatrix:g,extensions:m,fetch:y,operation:v,_subLayerProps:_}=this.props,w={id:"",updateTriggers:{},opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:c,autoHighlight:l,highlightColor:u,coordinateSystem:d,coordinateOrigin:h,wrapLongitude:f,positionFormat:p,modelMatrix:g,extensions:m,fetch:y,operation:v},C=_&&e.id&&_[e.id],S=C&&C.updateTriggers,M=e.id||"sublayer";if(C){const x=this.constructor._propTypes,N=e.type?e.type._propTypes:{};for(const U in C){const k=N[U]||x[U];k&&"accessor"===k.type&&(C[U]=this.getSubLayerAccessor(C[U]))}}Object.assign(w,e,C),w.id="".concat(this.props.id,"-").concat(M),w.updateTriggers={all:null===(n=this.props.updateTriggers)||void 0===n?void 0:n.all,...e.updateTriggers,...S};for(const x of m){const N=x.getSubLayerProps.call(this,x);N&&Object.assign(w,N,{updateTriggers:Object.assign(w.updateTriggers,N.updateTriggers)})}return w}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let i=this.internalState.subLayers;const r=!i||this.needsUpdate();r&&(i=HS(this.renderLayers(),Boolean),this.internalState.subLayers=i),gi("compositeLayer.renderLayers",this,r,i);for(const s of i)s.parent=this}}E(eI,"layerName","CompositeLayer");const Wv={name:"project32",dependencies:[kS],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},bCe={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},$v={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:#decl":"\nuniform bool picking_uAttribute;\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function ECe(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bCe;const e={};if(void 0!==t.pickingSelectedColor)if(t.pickingSelectedColor){const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}else e.picking_uSelectedColorValid=0;if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return void 0!==t.pickingActive&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}},a4={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class qa{static get DRAW_MODE(){return a4}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:n=$i("geometry"),drawMode:i=a4.TRIANGLES,attributes:r={},indices:s=null,vertexCount:o=null}=e;this.id=n,this.drawMode=0|i,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,Q(ArrayBuffer.isView(r.value),"".concat(this._print(i),": must be typed array or object with value as typed array")),("POSITION"===i||"positions"===i)&&!r.size&&(r.size=3),"indices"===i?(Q(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let i=1/0;for(const r in e){const s=e[r],{value:o,size:a,constant:c}=s;!c&&o&&a>=1&&(i=Math.min(i,o.length/a))}return Q(Number.isFinite(i)),i}}const c4=()=>{},l4={10241:9987,10240:9729,10242:33071,10243:33071};function SCe(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function xCe(t,e,n,i){return n===e.width&&i===e.height?e:(t.canvas.height=i,t.canvas.width=n,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(e,0,0,e.width,e.height,0,0,n,i),t.canvas)}function Rp(t){return t&&(t.id||t.url)}function u4(t,e,n){for(let i=0;i<e.length;i++){const{icon:r,xOffset:s}=e[i];t[Rp(r)]={...r,x:s,y:n}}}class RCe{constructor(e,{onUpdate:n=c4,onError:i=c4}){E(this,"gl",void 0),E(this,"onUpdate",void 0),E(this,"onError",void 0),E(this,"_loadOptions",null),E(this,"_texture",null),E(this,"_externalTexture",null),E(this,"_mapping",{}),E(this,"_textureParameters",null),E(this,"_pendingCount",0),E(this,"_autoPacking",!1),E(this,"_xOffset",0),E(this,"_yOffset",0),E(this,"_rowHeight",0),E(this,"_buffer",4),E(this,"_canvasWidth",1024),E(this,"_canvasHeight",0),E(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=i}finalize(){var e;null===(e=this._texture)||void 0===e||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?Rp(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:i,iconMapping:r,textureParameters:s}){var o;e&&(this._loadOptions=e),void 0!==n&&(this._autoPacking=n),r&&(this._mapping=r),i&&(null===(o=this._texture)||void 0===o||o.delete(),this._texture=null,this._externalTexture=i),s&&(this._textureParameters=s)}get isLoaded(){return 0===this._pendingCount}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const i=Object.values(function DCe(t,e,n){if(!t||!e)return null;n=n||{};const i={},{iterable:r,objectInfo:s}=Uv(t);for(const o of r){s.index++;const a=e(o,s),c=Rp(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!i[c]&&(!n[c]||a.url!==n[c].url)&&(i[c]={...a,source:o,sourceIndex:s.index})}return i}(e,n,this._mapping)||{});if(i.length>0){const{mapping:r,xOffset:s,yOffset:o,rowHeight:a,canvasHeight:c}=function MCe({icons:t,buffer:e,mapping:n={},xOffset:i=0,yOffset:r=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let c=0;c<t.length;c++){const l=t[c];if(!n[Rp(l)]){const{height:d,width:h}=l;i+h+e>o&&(u4(n,a,r),i=0,r=s+r+e,s=0,a=[]),a.push({icon:l,xOffset:i}),i=i+h+e,s=Math.max(s,d)}}return a.length>0&&u4(n,a,r),{mapping:n,rowHeight:s,xOffset:i,yOffset:r,canvasWidth:o,canvasHeight:SCe(s+r+e)}}({icons:i,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=r,this._xOffset=s,this._yOffset=o,this._canvasHeight=c,this._texture||(this._texture=new Jn(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||l4})),this._texture.height!==this._canvasHeight&&(this._texture=function ICe(t,e,n,i){const r=t.width,s=t.height,o=new Jn(t.gl,{width:e,height:n,parameters:i});return function gye(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:s=0,targetInternalFormat:o=6408}=n;let{targetX:a,targetY:c,targetZ:l,width:u,height:d}=n;const{framebuffer:h,deleteFramebuffer:f}=yp(t);Q(h);const{gl:p,handle:g}=h,m=typeof a<"u"||typeof c<"u"||typeof l<"u";a=a||0,c=c||0,l=l||0;const y=p.bindFramebuffer(36160,g);Q(e);let v=null;if(e instanceof rl&&(v=e,u=Number.isFinite(u)?u:v.width,d=Number.isFinite(d)?d:v.height,v.bind(0),e=v.target),m)switch(e){case 3553:case 34067:p.copyTexSubImage2D(e,s,a,c,i,r,u,d);break;case 35866:case 32879:fi(p).copyTexSubImage3D(e,s,a,c,l,i,r,u,d)}else p.copyTexImage2D(e,s,o,i,r,u,d,0);v&&v.unbind(),p.bindFramebuffer(36160,y||null),f&&h.delete()}(t,o,{targetY:0,width:r,height:s}),t.delete(),o}(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||l4)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(i)}}_loadIcons(e){const n=this._canvas.getContext("2d");for(const i of e)this._pendingCount++,Cp(i.url,dG,this._loadOptions).then(r=>{const s=Rp(i),{x:o,y:a,width:c,height:l}=this._mapping[s],u=xCe(n,r,c,l);this._texture.setSubImageData({data:u,x:o,y:a,width:c,height:l}),this._texture.generateMipmap(),this.onUpdate()}).catch(r=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:r})}).finally(()=>{this._pendingCount--})}}const d4=[0,0,0,255],OCe={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:d4},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class tI extends cl{constructor(...e){super(...e),E(this,"state",void 0)}getShaders(){return super.getShaders({vs:'#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  // convert size in meters to pixels, then scaled and clamp\n \n  // project meters to pixels and clamp to limits \n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n\n  // scale icon height to match instanceSize\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n\n  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n',fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n\n  // if colorMode == 0, use pixel color from the texture\n  // if colorMode == 1 or rendering picking buffer, use texture as transparency mask\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  // Take the global opacity and the alpha from vColor into account for the alpha component\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[Wv,$v]})}initializeState(){this.state={iconManager:new RCe(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:d4},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e,s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:c,getIcon:l,textureParameters:u}=n,{iconManager:d}=this.state,h=o||this.internalState.isAsyncPropLoading("iconAtlas");if(d.setProps({loadOptions:n.loadOptions,autoPacking:!h,iconAtlas:o,iconMapping:h?a:null,textureParameters:u}),h?i.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&d.packIcons(c,l),r.extensionsChanged){var f;const{gl:p}=this.context;null===(f=this.state.model)||void 0===f||f.delete(),this.state.model=this._getModel(p),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:c}=this.state,l=c.getTexture();l&&this.state.model.setUniforms(e).setUniforms({iconsTexture:l,iconsTextureDim:[l.width,l.height],sizeUnits:pv[s],sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,billboard:o,alphaCutoff:a}).draw()}_getModel(e){return new bd(e,{...this.getShaders(),id:this.props.id,geometry:new qa({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const i=null===(n=this.getCurrentLayer())||void 0===n?void 0:n.props.onIconError;i?i(e):$e.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:i,anchorX:r=n/2,anchorY:s=i/2}=this.state.iconManager.getIconMapping(e);return[n/2-r,i/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:i,width:r,height:s}=this.state.iconManager.getIconMapping(e);return[n,i,r,s]}}E(tI,"defaultProps",OCe),E(tI,"layerName","IconLayer");const f4=[];class nI extends tI{constructor(...e){super(...e),E(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n\n    // if enable sdf (signed distance fields)\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n\n    // Take the global opacity and the alpha from color into account for the alpha component\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:i,target:r})=>this.encodePickingColor(i,r)}})}updateState(e){super.updateState(e);const{props:n,oldProps:i}=e;let{outlineColor:r}=n;r!==i.outlineColor&&(r=r.map(s=>s/255),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!n.sdf&&n.outlineWidth&&$e.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:i,outlineWidth:r}=this.props,{outlineColor:s}=this.state;e.uniforms={...e.uniforms,buffer:.75,outlineBuffer:r?Math.max(i,.75*(1-r)):-1,gamma:i,sdf:!!n,outlineColor:s},super.draw(e)}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):f4}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):f4}}E(nI,"defaultProps",{getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}}),E(nI,"layerName","MultiIconLayer");var LCe=qe(772),FCe=qe.n(LCe);const BCe=32,kCe=[];function UCe(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function p4(t,e,n,i){let r=0;for(let o=e;o<n;o++){var s;r+=(null===(s=i[t[o]])||void 0===s?void 0:s.width)||0}return r}function g4(t,e,n,i,r,s){let o=e,a=0;for(let c=e;c<n;c++){const l=p4(t,c,c+1,r);a+l>i&&(o<c&&s.push(c),o=c,a=0),a+=l}return a}function HCe(t,e,n,i,r=0,s){void 0===s&&(s=t.length);const o=[];return"break-all"===e?g4(t,r,s,n,i,o):function jCe(t,e,n,i,r,s){let o=e,a=e,c=e,l=0;for(let u=e;u<n;u++)if((" "===t[u]||" "===t[u+1]||u+1===n)&&(c=u+1),c>a){let d=p4(t,a,c,r);l+d>i&&(o<a&&(s.push(a),o=a,l=0),d>i&&(d=g4(t,a,c,i,r,s),o=s[s.length-1])),a=c,l+=d}}(t,r,s,n,i,o),o}function zCe(t,e,n,i,r,s){let o=0,a=0;for(let c=e;c<n;c++){const l=t[c],u=i[l];u?(a||(a=u.height),r[c]=o+u.width/2,o+=u.width):($e.warn("Missing character: ".concat(l," (").concat(l.codePointAt(0),")"))(),r[c]=o,o+=BCe)}s[0]=o,s[1]=a}function m4(t,e,n,i,r){const s=Array.from(t),o=s.length,a=new Array(o),c=new Array(o),l=new Array(o),u=("break-word"===n||"break-all"===n)&&isFinite(i)&&i>0,d=[0,0],h=[0,0];let f=0,p=0,g=0;for(let m=0;m<=o;m++){const y=s[m];if(("\n"===y||m===o)&&(g=m),g>p){const v=u?HCe(s,n,i,r,p,g):kCe;for(let _=0;_<=v.length;_++){const w=0===_?p:v[_-1],C=_<v.length?v[_]:g;zCe(s,w,C,r,a,h);for(let S=w;S<C;S++)c[S]=f+h[1]/2,l[S]=h[0];f+=h[1]*e,d[0]=Math.max(d[0],h[0])}p=g}"\n"===y&&(a[p]=0,c[p]=0,l[p]=0,p++)}return d[1]=f,{x:a,y:c,rowWidth:l,size:d}}class _4{constructor(e=5){E(this,"limit",void 0),E(this,"_cache",{}),E(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}const Op={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function WCe(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1};let qv=new _4(3);function XCe(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function E4(t,e,n,i){t.font="".concat(i," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}class KCe{constructor(){E(this,"props",{...Op}),E(this,"_key",void 0),E(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return 1.2}setProps(e={}){Object.assign(this.props,e);const n=this._key;this._key=this._getKey();const i=function qCe(t,e){let n;n="string"==typeof e?new Set(Array.from(e)):new Set(e);const i=qv.get(t);if(!i)return n;for(const r in i.mapping)n.has(r)&&n.delete(r);return n}(this._key,this.props.characterSet),r=qv.get(this._key);if(r&&0===i.size)return void(this._key!==n&&(this._atlas=r));const s=this._generateFontAtlas(this._key,i,r);this._atlas=s,qv.set(this._key,s)}_generateFontAtlas(e,n,i){const{fontFamily:r,fontWeight:s,fontSize:o,buffer:a,sdf:c,radius:l,cutoff:u}=this.props;let d=i&&i.data;d||(d=document.createElement("canvas"),d.width=1024);const h=d.getContext("2d");E4(h,r,o,s);const{mapping:f,canvasHeight:p,xOffset:g,yOffset:m}=function VCe({characterSet:t,getFontWidth:e,fontHeight:n,buffer:i,maxCanvasWidth:r,mapping:s={},xOffset:o=0,yOffset:a=0}){let c=0,l=o;for(const d of t)if(!s[d]){const h=e(d);l+h+2*i>r&&(l=0,c++),s[d]={x:l+i,y:a+c*(n+2*i)+i,width:h,height:n},l+=h+2*i}const u=n+2*i;return{mapping:s,xOffset:l,yOffset:a+c*u,canvasHeight:UCe(a+(c+1)*u)}}({getFontWidth:y=>h.measureText(y).width,fontHeight:1.2*o,buffer:a,characterSet:n,maxCanvasWidth:1024,...i&&{mapping:i.mapping,xOffset:i.xOffset,yOffset:i.yOffset}});if(d.height!==p){const y=h.getImageData(0,0,d.width,d.height);d.height=p,h.putImageData(y,0,0)}if(E4(h,r,o,s),c){const y=new(FCe())(o,a,l,u,r,s),v=h.getImageData(0,0,y.size,y.size);for(const _ of n)XCe(y.draw(_),v),h.putImageData(v,f[_].x-a,f[_].y+a)}else for(const y of n)h.fillText(y,f[y].x,f[y].y+.9*o);return{xOffset:g,yOffset:m,mapping:f,data:d,width:d.width,height:d.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:i,buffer:r,sdf:s,radius:o,cutoff:a}=this.props;return s?"".concat(e," ").concat(n," ").concat(i," ").concat(r," ").concat(o," ").concat(a):"".concat(e," ").concat(n," ").concat(i," ").concat(r)}}const QCe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class iI extends cl{constructor(...e){super(...e),E(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n\n  // convert size in meters to pixels, then scaled and clamp\n\n  // project meters to pixels and clamp to limits\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Apply opacity to instance color, or return instance picking color\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[Wv,$v]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var i;const{gl:r}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:i,sizeUnits:r,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:c}=this.props;c.length<4&&(c=[c[0],c[1],c[0],c[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!a,padding:c,sizeUnits:pv[r],sizeScale:i,sizeMinPixels:s,sizeMaxPixels:o}).draw()}_getModel(e){return new bd(e,{...this.getShaders(),id:this.props.id,geometry:new qa({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}E(iI,"defaultProps",QCe),E(iI,"layerName","TextBackgroundLayer");const w4={start:1,middle:0,end:-1},A4={top:1,center:0,bottom:-1},rI=[0,0,0,255],eTe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:rI},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:Op.characterSet},fontFamily:Op.fontFamily,fontWeight:Op.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:rI},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:rI},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class sI extends eI{constructor(...e){super(...e),E(this,"state",void 0),E(this,"getBoundingRect",(n,i)=>{const r=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:c,getTextAnchor:l,getAlignmentBaseline:u}=this.props,d=s(n,i)||"",{size:[h,f]}=m4(d,c,o,a,r);return[(w4["function"==typeof l?l(n,i):l]-1)*h/2,(A4["function"==typeof u?u(n,i):u]-1)*f/2,h,f]}),E(this,"getIconOffsets",(n,i)=>{const r=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:c,getTextAnchor:l,getAlignmentBaseline:u}=this.props,d=s(n,i)||"",{x:h,y:f,rowWidth:p,size:[g,m]}=m4(d,c,o,a,r),y=w4["function"==typeof l?l(n,i):l],v=A4["function"==typeof u?u(n,i):u],_=h.length,w=new Array(2*_);let C=0;for(let S=0;S<_;S++)w[C++]=(y-1)*g/2+(1-y)*(g-p[S])/2+h[S],w[C++]=(v-1)*m/2+f[S];return w})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new KCe}}updateState(e){const{props:n,oldProps:i,changeFlags:r}=e;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==i.lineHeight||n.wordBreak!==i.wordBreak||n.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:i}=this.props,{fontAtlasManager:r,characterSet:s}=this.state,o={...e,characterSet:s,fontFamily:n,fontWeight:i};if(!r.mapping)return r.setProps(o),!0;for(const a in o)if(o[a]!==r.props[a])return r.setProps(o),!0;return!1}_updateText(){var e;const{data:n,characterSet:i}=this.props,r=null===(e=n.attributes)||void 0===e?void 0:e.getText;let a,{getText:s}=this.props,o=n.startIndices;const c="auto"===i&&new Set;if(r&&o){const{texts:l,characterCount:u}=function GCe({value:t,length:e,stride:n,offset:i,startIndices:r,characterSet:s}){const o=t.BYTES_PER_ELEMENT,a=n?n/o:1,c=i?i/o:0,l=r[e]||Math.ceil((t.length-c)/a),u=s&&new Set,d=new Array(e);let h=t;if(a>1||c>0){h=new(0,t.constructor)(l);for(let p=0;p<l;p++)h[p]=t[p*a+c]}for(let f=0;f<e;f++){const m=h.subarray(r[f],r[f+1]||l);d[f]=String.fromCodePoint.apply(null,m),u&&m.forEach(u.add,u)}if(u)for(const f of u)s.add(String.fromCodePoint(f));return{texts:d,characterCount:l}}({...ArrayBuffer.isView(r)?{value:r}:r,length:n.length,startIndices:o,characterSet:c});a=u,s=(d,{index:h})=>l[h]}else{const{iterable:l,objectInfo:u}=Uv(n);o=[0],a=0;for(const d of l){u.index++;const h=Array.from(s(d,u)||"");c&&h.forEach(c.add,c),a+=h.length,o.push(a)}}this.setState({getText:s,startIndices:o,numInstances:a,characterSet:c||i})}renderLayers(){const{startIndices:e,numInstances:n,getText:i,fontAtlasManager:{scale:r,texture:s,mapping:o},styleVersion:a}=this.state,{data:c,_dataDiff:l,getPosition:u,getColor:d,getSize:h,getAngle:f,getPixelOffset:p,getBackgroundColor:g,getBorderColor:m,getBorderWidth:y,backgroundPadding:v,background:_,billboard:w,fontSettings:C,outlineWidth:S,outlineColor:M,sizeScale:x,sizeUnits:N,sizeMinPixels:U,sizeMaxPixels:k,transitions:z,updateTriggers:R}=this.props,F=this.getSubLayerClass("characters",nI),W=this.getSubLayerClass("background",iI);return[_&&new W({getFillColor:g,getLineColor:m,getLineWidth:y,padding:v,getPosition:u,getSize:h,getAngle:f,getPixelOffset:p,billboard:w,sizeScale:x/this.state.fontAtlasManager.props.fontSize,sizeUnits:N,sizeMinPixels:U,sizeMaxPixels:k,transitions:z&&{getPosition:z.getPosition,getAngle:z.getAngle,getSize:z.getSize,getFillColor:z.getBackgroundColor,getLineColor:z.getBorderColor,getLineWidth:z.getBorderWidth,getPixelOffset:z.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:R.getPosition,getAngle:R.getAngle,getSize:R.getSize,getFillColor:R.getBackgroundColor,getLineColor:R.getBorderColor,getLineWidth:R.getBorderWidth,getPixelOffset:R.getPixelOffset,getBoundingRect:{getText:R.getText,getTextAnchor:R.getTextAnchor,getAlignmentBaseline:R.getAlignmentBaseline,styleVersion:a}}}),{data:c.attributes&&c.attributes.background?{length:c.length,attributes:c.attributes.background}:c,_dataDiff:l,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new F({sdf:C.sdf,smoothing:Number.isFinite(C.smoothing)?C.smoothing:Op.smoothing,outlineWidth:S,outlineColor:M,iconAtlas:s,iconMapping:o,getPosition:u,getColor:d,getSize:h,getAngle:f,getPixelOffset:p,billboard:w,sizeScale:x*r,sizeUnits:N,sizeMinPixels:U*r,sizeMaxPixels:k*r,transitions:z&&{getPosition:z.getPosition,getAngle:z.getAngle,getColor:z.getColor,getSize:z.getSize,getPixelOffset:z.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:R.getText,getPosition:R.getPosition,getAngle:R.getAngle,getColor:R.getColor,getSize:R.getSize,getPixelOffset:R.getPixelOffset,getIconOffsets:{getText:R.getText,getTextAnchor:R.getTextAnchor,getAlignmentBaseline:R.getAlignmentBaseline,styleVersion:a}}}),{data:c,_dataDiff:l,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:i})]}static set fontAtlasCacheLimit(e){!function YCe(t){$e.assert(Number.isFinite(t)&&t>=3,"Invalid cache limit"),qv=new _4(t)}(e)}}E(sI,"defaultProps",eTe),E(sI,"layerName","TextLayer");const C4="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",tTe={lightSources:{}};function oI(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.map(n=>n*e/255)}const aI={name:"lights",vs:C4,fs:C4,getUniforms:function T4(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tTe;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:i}=t.lightSources||{};return e||n&&n.length>0||i&&i.length>0?Object.assign({},function nTe(t){let{ambientLight:e,pointLights:n=[],directionalLights:i=[]}=t;const r={};return r["lighting_uAmbientLight.color"]=e?oI(e):[0,0,0],n.forEach((s,o)=>{r["lighting_uPointLight[".concat(o,"].color")]=oI(s),r["lighting_uPointLight[".concat(o,"].position")]=s.position,r["lighting_uPointLight[".concat(o,"].attenuation")]=s.attenuation||[1,0,0]}),r.lighting_uPointLightCount=n.length,i.forEach((s,o)=>{r["lighting_uDirectionalLight[".concat(o,"].color")]=oI(s),r["lighting_uDirectionalLight[".concat(o,"].direction")]=s.direction}),r.lighting_uDirectionalLightCount=i.length,r}({ambientLight:e,pointLights:n,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n)}return T4({lightSources:e})}return{}},defines:{MAX_LIGHTS:3}},iTe={};const sTe={name:"phong-lighting",dependencies:[aI],fs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_FRAGMENT:1},getUniforms:function x4(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:iTe;if(!("material"in t))return{};const{material:e}=t;return e?function rTe(t){const{ambient:e=.35,diffuse:n=.6,shininess:i=32,specularColor:r=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}(e):{lighting_uEnabled:!1}}},cI=Math.PI/180,Xv=new Float32Array(16),I4=new Float32Array(12);function M4(t,e,n){const i=e[0]*cI,r=e[1]*cI,s=e[2]*cI,o=Math.sin(s),a=Math.sin(i),c=Math.sin(r),l=Math.cos(s),u=Math.cos(i),d=Math.cos(r),h=n[0],f=n[1],p=n[2];t[0]=h*d*u,t[1]=h*c*u,t[2]=h*-a,t[3]=f*(-c*l+d*a*o),t[4]=f*(d*l+c*a*o),t[5]=f*u*o,t[6]=p*(c*o+d*a*l),t[7]=p*(-d*o+c*a*l),t[8]=p*u*l}function D4(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const R4={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:i,getOrientation:r,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,c=Array.isArray(a),l=c&&16===a.length,u=Array.isArray(s),d=Array.isArray(r),h=Array.isArray(o),f=l||!c&&!!a(i[0]);t.constant=f?l:d&&u&&h;const p=t.value;if(t.constant){let g;f?(Xv.set(a),g=D4(Xv)):(g=I4,M4(g,r,s),g.set(o,9)),t.value=new Float32Array(g)}else{let g=e*t.size;const{iterable:m,objectInfo:y}=Uv(i,e,n);for(const v of m){let _;y.index++,f?(Xv.set(l?a:a(v,y)),_=D4(Xv)):(_=I4,M4(_,d?r:r(v,y),u?s:s(v,y)),_.set(h?o:o(v,y),9)),p[g++]=_[0],p[g++]=_[1],p[g++]=_[2],p[g++]=_[3],p[g++]=_[4],p[g++]=_[5],p[g++]=_[6],p[g++]=_[7],p[g++]=_[8],p[g++]=_[9],p[g++]=_[10],p[g++]=_[11]}}}};function O4(t,e){return e===Qe.CARTESIAN||e===Qe.METER_OFFSETS||e===Qe.DEFAULT&&!t.isGeospatial}function P4(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),$e.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function cTe(t,e){if(t.attributes)return P4(t.attributes,e),t instanceof qa?t:new qa(t);if(t.positions||t.POSITION)return P4(t,e),new qa({attributes:t});throw Error("Invalid mesh")}class lI extends cl{constructor(...e){super(...e),E(this,"state",void 0)}getShaders(){const e=!He(this.context.gl),n={};return PS(this.context.gl,"GLSL_DERIVATIVES")&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\n\n// Scale the model\nuniform float sizeScale;\nuniform bool composeModelMatrix;\n\n// Primitive attributes\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\n\n// Instance attributes\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\n\n// Outputs to fragment shader\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    // using instancePositions as world coordinates\n    // when using globe mode, this branch does not re-orient the model to align with the surface of the earth\n    // call project_normal before setting position to avoid rotation\n    normals_commonspace = project_normal(instanceModelMatrix * normals);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n    geometry.position = position_commonspace;\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n    geometry.position = position_commonspace;\n    normals_commonspace = project_normal(instanceModelMatrix * normals);\n  }\n\n  geometry.normal = normals_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n\n// NOTE(Tarek): This is necessary because\n// headless.gl reports the extension as\n// available but does not support it in\n// the shader.\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[Wv,sTe,$v],transpileToGLSL100:e,defines:n})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:R4}),this.setState({emptyTexture:new Jn(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e;if(n.mesh!==i.mesh||r.extensionsChanged){var s;if(null===(s=this.state.model)||void 0===s||s.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const o=n.mesh.attributes||n.mesh;this.setState({hasNormals:!(!o.NORMAL&&!o.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==i.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:i,coordinateSystem:r,_instanced:s}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:i,composeModelMatrix:!s||O4(n,r),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new bd(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:cTe(e,this.props._useMeshColors),isInstanced:!0}),{texture:i}=this.props,{emptyTexture:r}=this.state;return n.setUniforms({sampler:i||r,hasTexture:!!i}),n}setTexture(e){const{emptyTexture:n,model:i}=this.state;i&&i.setUniforms({sampler:e||n,hasTexture:!!e})}}E(lI,"defaultProps",{mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}}),E(lI,"layerName","SimpleMeshLayer");const N4={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[aI]};class Ed{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:n}=e;this.id=n||$i(this.constructor.name),this.display=!0,this.position=new hi,this.rotation=new hi,this.scale=new hi(1,1,1),this.matrix=new Le,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}getBounds(){return null}setPosition(e){return Q(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return Q(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return Q(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e){arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?this.matrix=e:this.matrix.copy(e)}setMatrixComponents(e){let{position:n,rotation:i,scale:r,update:s=!0}=e;return n&&this.setPosition(n),i&&this.setRotation(i),r&&this.setScale(r),s&&this.updateMatrix(),this}updateMatrix(){const e=this.position,n=this.rotation,i=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(n),this.matrix.scale(i),this}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{position:n,rotation:i,scale:r}=e;return n&&this.setPosition(n),i&&this.setRotation(i),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(e,n){Q(e),n=n||this.matrix;const i=new Le(e).multiplyRight(n),r=i.invert(),s=r.transpose();return{viewMatrix:e,modelMatrix:n,objectMatrix:n,worldMatrix:i,worldInverseMatrix:r,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class Pp extends Ed{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=Array.isArray(e)?{children:e}:e;const{children:n=[]}=e;oe.assert(n.every(i=>i instanceof Ed),"every child must an instance of ScenegraphNode"),super(e),this.children=n}add(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];for(const r of n)Array.isArray(r)?this.add(...r):this.children.push(r);return this}remove(e){const n=this.children,i=n.indexOf(e);return i>-1&&n.splice(i,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}getBounds(){const e=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse((n,i)=>{let{worldMatrix:r}=i;const s=n.getBounds();if(!s)return;const[o,a]=s,c=new hi(o).add(a).divide([2,2,2]);r.transformAsPoint(c,c);const l=new hi(a).subtract(o).divide([2,2,2]);r.transformAsVector(l,l);for(let u=0;u<8;u++){const d=new hi(1&u?-1:1,2&u?-1:1,4&u?-1:1).multiply(l).add(c);for(let h=0;h<3;h++)e[0][h]=Math.min(e[0][h],d[h]),e[1][h]=Math.max(e[1][h],d[h])}}),Number.isFinite(e[0][0])?e:null}traverse(e){let{worldMatrix:n=new Le}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=new Le(n).multiplyRight(this.matrix);for(const r of this.children)r instanceof Pp?r.traverse(e,{worldMatrix:i}):e(r,{worldMatrix:i})}}let Yv;class uI extends Lj{static get ZERO(){return Yv||(Yv=new uI(0,0,0,0),Object.freeze(Yv)),Yv}constructor(e=0,n=0,i=0,r=0){super(-0,-0,-0,-0),Oo(e)&&1===arguments.length?this.copy(e):(sn.debug&&(Rt(e),Rt(n),Rt(i),Rt(r)),this[0]=e,this[1]=n,this[2]=i,this[3]=r)}set(e,n,i,r){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return sn.debug&&(Rt(e.x),Rt(e.y),Rt(e.z),Rt(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=Rt(e)}get w(){return this[3]}set w(e){this[3]=Rt(e)}transform(e){return tT(this,this,e),this.check()}transformByMatrix3(e){return function cle(t,e,n){const i=e[0],r=e[1],s=e[2];t[0]=n[0]*i+n[3]*r+n[6]*s,t[1]=n[1]*i+n[4]*r+n[7]*s,t[2]=n[2]*i+n[5]*r+n[8]*s,t[3]=e[3]}(this,this,e),this.check()}transformByMatrix2(e){return function ale(t,e,n){const i=e[0],r=e[1];t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t[3]=e[3]}(this,this,e),this.check()}transformByQuaternion(e){return sU(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}function L4(){var t=new Gi(4);return Gi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function F4(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function B4(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=n[0],c=n[1],l=n[2],u=n[3];return t[0]=i*u+o*a+r*l-s*c,t[1]=r*u+o*c+s*a-i*l,t[2]=s*u+o*l+i*c-r*a,t[3]=o*u-i*a-r*c-s*l,t}var U4=oU,CTe=function(){var t=nU(),e=iU(1,0,0),n=iU(0,1,0);return function(i,r,s){var o=rU(r,s);return o<-.999999?(by(t,e,r),function Sle(t){return Math.hypot(t[0],t[1],t[2])}(t)<1e-6&&by(t,n,r),function Mle(t,e){var n=e[0],i=e[1],r=e[2],s=n*n+i*i+r*r;s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s}(t,t),F4(i,t,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(by(t,r,s),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+o,function Wle(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*n+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=i*o,t[2]=r*o,t[3]=s*o,t}(i,i))}}();L4(),L4(),function uTe(){var t=new Gi(9);Gi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1}();const TTe=[0,0,0,1],xTe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ITe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function H4(t){if(!t._animation){const e=ITe[t.componentType],n=xTe[t.type],i=n*t.count,{buffer:r,byteOffset:s}=t.bufferView.data,o=new e(r,s+(t.byteOffset||0),i);if(1===n)t._animation=Array.from(o);else{const a=[];for(let c=0;c<o.length;c+=n)a.push(Array.from(o.slice(c,c+n)));t._animation=a}}return t._animation}const MTe=new Le,dI=new class STe extends ZC{constructor(e=0,n=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,n,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,i,r){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return function k4(t,e){var i,n=e[0]+e[4]+e[8];if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,t[0]=(e[5]-e[7])*(i=.5/i),t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),t[r]=.5*i,t[3]=(e[3*s+o]-e[3*o+s])*(i=.5/i),t[s]=(e[3*s+r]+e[3*r+s])*i,t[o]=(e[3*o+r]+e[3*r+o])*i}return t}(this,e),this.check()}fromAxisRotation(e,n){return F4(this,e,n),this.check()}identity(){return function dTe(t){t[0]=0,t[1]=0,t[2]=0,t[3]=1}(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Rt(e)}get y(){return this[1]}set y(e){this[1]=Rt(e)}get z(){return this[2]}set z(e){this[2]=Rt(e)}get w(){return this[3]}set w(e){this[3]=Rt(e)}len(){return function zle(t){return Math.hypot(t[0],t[1],t[2],t[3])}(this)}lengthSquared(){return function Gle(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}(this)}dot(e){return function $le(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}(this,e)}rotationTo(e,n){return CTe(this,e,n),this.check()}add(e){return function Hle(t,e,n){t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3]}(this,this,e),this.check()}calculateW(){return function gTe(t,e){var n=e[0],i=e[1],r=e[2];t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r))}(this,this),this.check()}conjugate(){return function vTe(t,e){t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3]}(this,this),this.check()}invert(){return function yTe(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*n+i*i+r*r+s*s,a=o?1/o:0;t[0]=-n*a,t[1]=-i*a,t[2]=-r*a,t[3]=s*a}(this,this),this.check()}lerp(e,n,i){return void 0===i?this.lerp(this,e,n):(function qle(t,e,n,i){var r=e[0],s=e[1],o=e[2],a=e[3];t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=o+i*(n[2]-o),t[3]=a+i*(n[3]-a)}(this,e,n,i),this.check())}multiplyRight(e){return B4(this,this,e),this.check()}multiplyLeft(e){return B4(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,0===e&&(this[3]=1),this.check()}rotateX(e){return function hTe(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);t[0]=i*c+o*a,t[1]=r*c+s*a,t[2]=s*c-r*a,t[3]=o*c-i*a}(this,this,e),this.check()}rotateY(e){return function fTe(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);t[0]=i*c-s*a,t[1]=r*c+o*a,t[2]=s*c+i*a,t[3]=o*c-r*a}(this,this,e),this.check()}rotateZ(e){return function pTe(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);t[0]=i*c+r*a,t[1]=r*c-i*a,t[2]=s*c+o*a,t[3]=o*c-s*a}(this,this,e),this.check()}scale(e){return U4(this,this,e),this.check()}slerp(e,n,i){let r,s,o;switch(arguments.length){case 1:({start:r=TTe,target:s,ratio:o}=e);break;case 2:r=this,s=e,o=n;break;default:r=e,s=n,o=i}return function Kv(t,e,n,i){var h,f,p,g,m,r=e[0],s=e[1],o=e[2],a=e[3],c=n[0],l=n[1],u=n[2],d=n[3];return(f=r*c+s*l+o*u+a*d)<0&&(f=-f,c=-c,l=-l,u=-u,d=-d),1-f>ks?(h=Math.acos(f),p=Math.sin(h),g=Math.sin((1-i)*h)/p,m=Math.sin(i*h)/p):(g=1-i,m=i),t[0]=g*r+m*c,t[1]=g*s+m*l,t[2]=g*o+m*u,t[3]=g*a+m*d,t}(this,r,s,o),this.check()}transformVector4(e,n=new uI){return function Xle(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],c=n[2],l=n[3],u=l*i+a*s-c*r,d=l*r+c*i-o*s,h=l*s+o*r-a*i,f=-o*i-a*r-c*s;t[0]=u*l+f*-o+d*-c-h*-a,t[1]=d*l+f*-a+h*-o-u*-c,t[2]=h*l+f*-c+u*-a-d*-o,t[3]=e[3]}(n,e,this),_y(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}};class LTe{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const i=(e/1e3-this.startTime)*this.speed;this.channels.forEach(r=>{let{sampler:s,target:o,path:a}=r;(function NTe(t,e,n,i){let{input:r,interpolation:s,output:o}=e;const c=t%r[r.length-1],l=r.findIndex(f=>f>=c),u=Math.max(0,l-1);if(!Array.isArray(n[i]))switch(i){case"translation":n[i]=[0,0,0];break;case"rotation":n[i]=[0,0,0,1];break;case"scale":n[i]=[1,1,1];break;default:oe.warn("Bad animation path ".concat(i))()}Q(n[i].length===o[u].length);const d=r[u],h=r[l];switch(s){case"STEP":!function PTe(t,e,n){for(let i=0;i<n.length;i++)t[e][i]=n[i]}(n,i,o[u]);break;case"LINEAR":h>d&&function RTe(t,e,n,i,r){if("rotation"===e){dI.slerp({start:n,target:i,ratio:r});for(let s=0;s<dI.length;s++)t[e][s]=dI[s]}else for(let s=0;s<n.length;s++)t[e][s]=r*i[s]+(1-r)*n[s]}(n,i,o[u],o[l],(c-d)/(h-d));break;case"CUBICSPLINE":h>d&&function OTe(t,e,n){let{p0:i,outTangent0:r,inTangent1:s,p1:o,tDiff:a,ratio:c}=n;for(let l=0;l<t[e].length;l++){const u=r[l]*a,d=s[l]*a;t[e][l]=(2*Math.pow(c,3)-3*Math.pow(c,2)+1)*i[l]+(Math.pow(c,3)-2*Math.pow(c,2)+c)*u+(-2*Math.pow(c,3)+3*Math.pow(c,2))*o[l]+(Math.pow(c,3)-Math.pow(c,2))*d}}(n,i,{p0:o[3*u+1],outTangent0:o[3*u+2],inTangent1:o[3*l+0],p1:o[3*l+1],tDiff:h-d,ratio:(c-d)/(h-d)});break;default:oe.warn("Interpolation ".concat(s," not supported"))()}})(i,s,o,a),function DTe(t,e){if(e.matrix.identity(),t.translation&&e.matrix.translate(t.translation),t.rotation){const n=MTe.fromQuaternion(t.rotation);e.matrix.multiplyRight(n)}t.scale&&e.matrix.scale(t.scale)}(o,o._node)})}}class FTe{constructor(e){this.animations=e.animations.map((n,i)=>{const r=n.name||"Animation-".concat(i),s=n.samplers.map(a=>{let{input:c,interpolation:l="LINEAR",output:u}=a;return{input:H4(e.accessors[c]),interpolation:l,output:H4(e.accessors[u])}}),o=n.channels.map(a=>{let{sampler:c,target:l}=a;return{sampler:s[c],target:e.nodes[l.node],path:l.path}});return new LTe({name:r,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(n=>n.animate(e))}getAnimations(){return this.animations}}class BTe extends Ed{constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(n),this.onBeforeRender=null,this.AfterRender=null,e instanceof bd?(this.model=e,this._setModelNodeProps(n)):this.model=new bd(e,n),this.bounds=null,this.managedResources=n.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}getBounds(){return this.bounds}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(e){this.model.setProps(e)}}class kTe{constructor(e,n){let{attributes:i,material:r,pbrDebug:s,imageBasedLightingEnvironment:o,lights:a,useTangents:c}=n;this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},PS(e,"GLSL_TEXTURE_LOD")&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],o&&(this.uniforms.u_DiffuseEnvSampler=o.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=o.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=o.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),s&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(i.NORMAL,"HAS_NORMALS"),this.defineIfPresent(i.TANGENT&&c,"HAS_TANGENTS"),this.defineIfPresent(i.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(o,"USE_IBL"),this.defineIfPresent(a,"USE_LIGHTS"),this.defineIfPresent(s,"PBR_DEBUG"),r&&this.parseMaterial(r)}defineIfPresent(e,n){e&&(this.defines[n]=1)}parseTexture(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const c=new Jn(this.gl,{id:e.name||e.id,parameters:{...r,...a},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...o});this.uniforms[n]=c,this.defineIfPresent(i,i),this.generatedTextures.push(c)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:n=1,roughnessFactor:i=1}=e;this.uniforms.u_MetallicRoughnessValues=[n,i]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=!!e.unlit,e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:n=1}=e.normalTexture;this.uniforms.u_NormalScale=n}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:n=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=n}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:n=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=n}else"BLEND"===e.alphaMode&&(oe.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach(e=>e.delete())}}function z4(t,e){return He(t)?"#version 300 es\n".concat(e):e}const HTe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},zTe={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class GTe{constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.options=Object.assign({},zTe,n)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(i=>this.createScene(i))}createAnimator(){return Array.isArray(this.gltf.animations)?new FTe(this.gltf):null}createScene(e){const i=(e.nodes||[]).map(s=>this.createNode(s));return new Pp({id:e.name||e.id,children:i})}createNode(e){if(!e._node){const i=(e.children||[]).map(s=>this.createNode(s));e.mesh&&i.push(this.createMesh(e.mesh));const r=new Pp({id:e.name||e.id,children:i});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){const s=(new Le).fromQuaternion(e.rotation);r.matrix.multiplyRight(s)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}createMesh(e){if(!e._mesh){const i=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),r=new Pp({id:e.name||e.id,children:i});e._mesh=r}return e._mesh}getVertexCount(e){oe.warn("getVertexCount() not found")()}createPrimitive(e,n,i){const r=function jTe(t,e){const{id:n,drawMode:i,vertexCount:r,attributes:s,modelOptions:o}=e,a=new kTe(t,e);oe.info(4,"createGLTFModel defines: ",a.defines)();const c=[];c.push(...a.generatedTextures),c.push(...Object.values(s).map(u=>u.buffer));const l=new BTe(t,{id:n,drawMode:i,vertexCount:r,modules:[N4],parameters:a.parameters,vs:z4(t,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:z4(t,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:c,...o,defines:{...a.defines,...o.defines}});return l.setProps({attributes:s}),l.setUniforms(a.uniforms),l}(this.gl,Object.assign({id:e.name||"".concat(i.name||i.id,"-primitive-").concat(n),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options));return r.bounds=[e.attributes.POSITION.min,e.attributes.POSITION.max],r}createAttributes(e,n){const i={};return Object.keys(e).forEach(r=>{i[r]=this.createAccessor(e[r],this.createBuffer(e[r],this.gl.ARRAY_BUFFER))}),n&&(i.indices=this.createAccessor(n,this.createBuffer(n,this.gl.ELEMENT_ARRAY_BUFFER))),oe.info(4,"glTF Attributes",{attributes:e,indices:n,generated:i})(),i}createBuffer(e,n){e.bufferView||(e.bufferView={});const{bufferView:i}=e;return i.lumaBuffers||(i.lumaBuffers={}),i.lumaBuffers[n]||(i.lumaBuffers[n]=new St(this.gl,{id:"from-".concat(i.id),data:i.data||e.value,target:n})),i.lumaBuffers[n]}createAccessor(e,n){return new qi({buffer:n,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:HTe[e.type]})}createSampler(e){return e}needsPOT(){return!1}}var Np=qe(435);const XTe="3.2.13",hI={};function ll(t){return fI.apply(this,arguments)}function fI(){return fI=ee(function*(t,e=null,n={}){return e&&(t=function YTe(t,e,n){if(t.startsWith("http"))return t;const i=n.modules||{};return i[t]?i[t]:Wa?n.CDN?(Ks(n.CDN.startsWith("http")),"".concat(n.CDN,"/").concat(e,"@").concat(XTe,"/dist/libs/").concat(t)):tx?"../src/libs/".concat(t):"modules/".concat(e,"/src/libs/").concat(t):"modules/".concat(e,"/dist/libs/").concat(t)}(t,e,n)),hI[t]=hI[t]||function KTe(t){return pI.apply(this,arguments)}(t),yield hI[t]}),fI.apply(this,arguments)}function pI(){return pI=ee(function*(t){if(t.endsWith("wasm"))return yield(yield fetch(t)).arrayBuffer();if(!Wa)try{return Np&&Np.requireFromFile&&(yield Np.requireFromFile(t))}catch{return null}return tx?importScripts(t):function JTe(t,e){if(!Wa)return Np.requireFromString&&Np.requireFromString(t,e);if(tx)return eval.call(Dbe,t),null;const n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch{n.text=t}return document.body.appendChild(n),null}(yield(yield fetch(t)).text(),t)}),pI.apply(this,arguments)}const ZTe="https://unpkg.com/@loaders.gl/textures@".concat("3.2.13","/dist/libs/basis_encoder.wasm"),QTe="https://unpkg.com/@loaders.gl/textures@".concat("3.2.13","/dist/libs/basis_encoder.js");let gI,yI;function W4(t){return mI.apply(this,arguments)}function mI(){return mI=ee(function*(t){const e=t.modules||{};return e.basis?e.basis:(gI=gI||function eSe(t){return _I.apply(this,arguments)}(t),yield gI)}),mI.apply(this,arguments)}function _I(){return _I=ee(function*(t){let e=null,n=null;return[e,n]=yield Promise.all([yield ll("basis_transcoder.js","textures",t),yield ll("basis_transcoder.wasm","textures",t)]),e=e||globalThis.BASIS,yield function tSe(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(i=>{t(n).then(r=>{const{BasisFile:s,initializeBasis:o}=r;o(),i({BasisFile:s})})})}(e,n)}),_I.apply(this,arguments)}function $4(t){return vI.apply(this,arguments)}function vI(){return vI=ee(function*(t){const e=t.modules||{};return e.basisEncoder?e.basisEncoder:(yI=yI||function nSe(t){return bI.apply(this,arguments)}(t),yield yI)}),vI.apply(this,arguments)}function bI(){return bI=ee(function*(t){let e=null,n=null;return[e,n]=yield Promise.all([yield ll(QTe,"textures",t),yield ll(ZTe,"textures",t)]),e=e||globalThis.BASIS,yield function iSe(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(i=>{t(n).then(r=>{const{BasisFile:s,KTX2File:o,initializeBasis:a,BasisEncoder:c}=r;a(),i({BasisFile:s,KTX2File:o,BasisEncoder:c})})})}(e,n)}),bI.apply(this,arguments)}const rSe=["","WEBKIT_","MOZ_"],q4={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let Jv=null;var EI,Zv,wI,Qv,Y4,AI,K4,J4;new Uint8Array([0]),function(t){t[t.NONE=0]="NONE",t[t.BASISLZ=1]="BASISLZ",t[t.ZSTD=2]="ZSTD",t[t.ZLIB=3]="ZLIB"}(EI||(EI={})),function(t){t[t.BASICFORMAT=0]="BASICFORMAT"}(Zv||(Zv={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.ETC1S=163]="ETC1S",t[t.UASTC=166]="UASTC"}(wI||(wI={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.SRGB=1]="SRGB"}(Qv||(Qv={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LINEAR=1]="LINEAR",t[t.SRGB=2]="SRGB",t[t.ITU=3]="ITU",t[t.NTSC=4]="NTSC",t[t.SLOG=5]="SLOG",t[t.SLOG2=6]="SLOG2"}(Y4||(Y4={})),function(t){t[t.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",t[t.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(AI||(AI={})),function(t){t[t.RGB=0]="RGB",t[t.RRR=3]="RRR",t[t.GGG=4]="GGG",t[t.AAA=15]="AAA"}(K4||(K4={})),function(t){t[t.RGB=0]="RGB",t[t.RGBA=3]="RGBA",t[t.RRR=4]="RRR",t[t.RRRG=5]="RRRG"}(J4||(J4={}));const vr=[171,75,84,88,32,50,48,187,13,10,26,10],uSe={etc1:{basisFormat:0,compressed:!0,format:36196},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:33776},bc3:{basisFormat:3,compressed:!0,format:33779},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:35840},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:35842},"astc-4x4":{basisFormat:10,compressed:!0,format:37808},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};function TI(){return TI=ee(function*(t,e){if("auto"===e.basis.containerFormat){if(function lSe(t){const e=new Uint8Array(t);return!(e.byteLength<vr.length||e[0]!==vr[0]||e[1]!==vr[1]||e[2]!==vr[2]||e[3]!==vr[3]||e[4]!==vr[4]||e[5]!==vr[5]||e[6]!==vr[6]||e[7]!==vr[7]||e[8]!==vr[8]||e[9]!==vr[9]||e[10]!==vr[10]||e[11]!==vr[11])}(t))return e8((yield $4(e)).KTX2File,t,e);const{BasisFile:n}=yield W4(e);return SI(n,t,e)}if("encoder"===e.basis.module){const n=yield $4(e);return"ktx2"===e.basis.containerFormat?e8(n.KTX2File,t,e):SI(n.BasisFile,t,e)}{const{BasisFile:i}=yield W4(e);return SI(i,t,e)}}),TI.apply(this,arguments)}function SI(t,e,n){const i=new t(new Uint8Array(e));try{if(!i.startTranscoding())throw new Error("Failed to start basis transcoding");const r=i.getNumImages(),s=[];for(let o=0;o<r;o++){const a=i.getNumLevels(o),c=[];for(let l=0;l<a;l++)c.push(hSe(i,o,l,n));s.push(c)}return s}finally{i.close(),i.delete()}}function hSe(t,e,n,i){const r=t.getImageWidth(e,n),s=t.getImageHeight(e,n),o=t.getHasAlpha(),{compressed:a,format:c,basisFormat:l}=t8(i,o),u=t.getImageTranscodedSizeInBytes(e,n,l),d=new Uint8Array(u);if(!t.transcodeImage(d,e,n,l,0,0))throw new Error("failed to start Basis transcoding");return{width:r,height:s,data:d,compressed:a,format:c,hasAlpha:o}}function e8(t,e,n){const i=new t(new Uint8Array(e));try{if(!i.startTranscoding())throw new Error("failed to start KTX2 transcoding");const r=i.getLevels(),s=[];for(let o=0;o<r;o++){s.push(fSe(i,o,n));break}return[s]}finally{i.close(),i.delete()}}function fSe(t,e,n){const{alphaFlag:i,height:r,width:s}=t.getImageLevelInfo(e,0,0),{compressed:o,format:a,basisFormat:c}=t8(n,i),l=t.getImageTranscodedSizeInBytes(e,0,0,c),u=new Uint8Array(l);if(!t.transcodeImage(u,e,0,0,c,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:s,height:r,data:u,compressed:o,hasAlpha:i,format:a}}function t8(t,e){let n=t&&t.basis&&t.basis.format;return"auto"===n&&(n=n8()),"object"==typeof n&&(n=e?n.alpha:n.noAlpha),n=n.toLowerCase(),uSe[n]}function n8(){const t=function sSe(t){if(!Jv){t=t||function oSe(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}()||void 0,Jv=new Set;for(const e of rSe)for(const n in q4)t&&t.getExtension("".concat(e).concat(n))&&Jv.add(q4[n])}return Jv}();return t.has("astc")?"astc-4x4":t.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:t.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:t.has("etc1")?"etc1":t.has("etc2")?"etc2":"rgb565"}const pSe={name:"Basis",id:"basis",module:"textures",version:"3.2.13",worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}},parse:function dSe(t,e){return TI.apply(this,arguments)}};function ul(t,e){if(!t)throw new Error(e||"loader assertion failed.")}typeof self<"u"&&self,typeof window<"u"&&window,typeof global<"u"&&global,typeof document<"u"&&document;const tb=!("object"==typeof process&&"[object process]"===String(process)&&!process.browser),i8=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:mSe}=(i8&&parseFloat(i8[1]),globalThis),xI=typeof Image<"u",II=typeof ImageBitmap<"u",MI=!!tb||!!mSe;function r8(t){const e=function o8(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&"object"==typeof t&&t.data&&t.width&&t.height?"data":null}(t);if(!e)throw new Error("Not an image");return e}const vSe=/^data:image\/svg\+xml/,bSe=/\.svg((\?|#).*)?$/;function DI(t){return t&&(vSe.test(t)||bSe.test(t))}function a8(t,e){if(DI(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}function c8(t,e,n){return RI.apply(this,arguments)}function RI(){return RI=ee(function*(t,e,n){const i=function ESe(t,e){if(DI(e)){let i=(new TextDecoder).decode(t);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(i))}return a8(t,e)}(t,n),r=self.URL||self.webkitURL,s="string"!=typeof i&&r.createObjectURL(i);try{return yield function wSe(t,e){return OI.apply(this,arguments)}(s||i,e)}finally{s&&r.revokeObjectURL(s)}}),RI.apply(this,arguments)}function OI(){return OI=ee(function*(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(yield n.decode(),n):yield new Promise((i,r)=>{try{n.onload=()=>i(n),n.onerror=s=>r(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){r(s)}})}),OI.apply(this,arguments)}const ASe={};let l8=!0;function PI(){return PI=ee(function*(t,e,n){let i;i=DI(n)?yield c8(t,e,n):a8(t,n);const r=e&&e.imagebitmap;return yield function TSe(t){return NI.apply(this,arguments)}(i,r)}),PI.apply(this,arguments)}function NI(){return NI=ee(function*(t,e=null){if((function SSe(t){for(const e in t||ASe)return!1;return!0}(e)||!l8)&&(e=null),e)try{return yield createImageBitmap(t,e)}catch(n){console.warn(n),l8=!1}return yield createImageBitmap(t)}),NI.apply(this,arguments)}const io=!1,Fp=!0;function LI(t){const e=Bp(t);return function xSe(t){const e=Bp(t);return e.byteLength>=24&&2303741511===e.getUint32(0,io)?{mimeType:"image/png",width:e.getUint32(16,io),height:e.getUint32(20,io)}:null}(e)||function DSe(t){const e=Bp(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,io)&&255===e.getUint8(2)))return null;const{tableMarkers:i,sofMarkers:r}=function RSe(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,io);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,io),width:e.getUint16(s+7,io)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,io)}return null}(e)||function ISe(t){const e=Bp(t);return e.byteLength>=10&&1195984440===e.getUint32(0,io)?{mimeType:"image/gif",width:e.getUint16(6,Fp),height:e.getUint16(8,Fp)}:null}(e)||function MSe(t){const e=Bp(t);return e.byteLength>=14&&16973===e.getUint16(0,io)&&e.getUint32(2,Fp)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Fp),height:e.getUint32(22,Fp)}:null}(e)}function Bp(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}function FI(){return FI=ee(function*(t,e){const{mimeType:n}=LI(t)||{},i=globalThis._parseImageNode;return ul(i),yield i(t,n)}),FI.apply(this,arguments)}function BI(){return BI=ee(function*(t,e,n){const r=((e=e||{}).image||{}).type||"auto",{url:s}=n||{},o=function NSe(t){switch(t){case"auto":case"data":return function ySe(){if(II)return"imagebitmap";if(xI)return"image";if(MI)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function _Se(t){switch(t){case"auto":return II||xI||MI;case"imagebitmap":return II;case"image":return xI;case"data":return MI;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}(t),t}}(r);let a;switch(o){case"imagebitmap":a=yield function CSe(t,e,n){return PI.apply(this,arguments)}(t,e,s);break;case"image":a=yield c8(t,e,s);break;case"data":a=yield function OSe(t,e){return FI.apply(this,arguments)}(t,e);break;default:ul(!1)}return"data"===r&&(a=function s8(t){switch(r8(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}(a)),a}),BI.apply(this,arguments)}const LSe={id:"image",module:"images",name:"Images",version:"3.2.13",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function PSe(t,e,n){return BI.apply(this,arguments)},tests:[t=>!!LI(new DataView(t))],options:{image:{type:"auto",decode:!0}}};function u8(t,e,n){if(t.byteLength<=e+n)return"";const i=new DataView(t);let r="";for(let s=0;s<n;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function d8(t,e,n){const i=void 0!==n?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(i).buffer}function br(t,e){if(!t)throw new Error(e||"assert failed: gltf")}function h8(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;const i=e.baseUri||e.uri;if(!i)throw new Error("'baseUri' must be provided to resolve relative url ".concat(t));return i.substr(0,i.lastIndexOf("/")+1)+t}function kp(t,e){return ul(t>=0),ul(e>0),t+(e-1)&~(e-1)}function kSe(t,e,n){let i;return i=t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer||t.arrayBuffer,t.byteOffset,t.byteLength),e.set(i,n),n+kp(i.byteLength,4)}const p8=["SCALAR","VEC2","VEC3","VEC4"],USe=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],VSe=new Map(USe),jSe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},HSe={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},zSe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function g8(t){return p8[t-1]||p8[0]}function m8(t){const e=VSe.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function _8(t,e){const n=zSe[t.componentType],i=jSe[t.type],s=t.count*i,o=t.count*i*HSe[t.componentType];return br(o>=0&&o<=e.byteLength),{ArrayType:n,length:s,byteLength:o}}const GSe={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class Vr{constructor(e){E(this,"gltf",void 0),E(this,"sourceBuffers",void 0),E(this,"byteLength",void 0),this.gltf=e||{json:{...GSe},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){return this.getUsedExtensions().find(r=>r===e)?(this.json.extensions||{})[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(i=>i===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(e,n){return(e.extensions||{})[n]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,n){if("object"==typeof n)return n;const i=this.json[e]&&this.json[e][n];if(!i)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(n,"]"));return i}getTypedArrayForBufferView(e){e=this.getBufferView(e);const i=this.gltf.buffers[e.buffer];return br(i),new Uint8Array(i.arrayBuffer,(e.byteOffset||0)+i.byteOffset,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const n=this.getBufferView(e.bufferView),r=this.getBuffer(n.buffer).data,{ArrayType:s,length:o}=_8(e,n);return new s(r,n.byteOffset+e.byteOffset,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const n=this.getBufferView(e.bufferView),r=this.getBuffer(n.buffer).data;return new Uint8Array(r,n.byteOffset||0,n.byteLength)}addApplicationData(e,n){return this.json[e]=n,this}addExtraData(e,n){return this.json.extras=this.json.extras||{},this.json.extras[e]=n,this}addObjectExtension(e,n,i){return e.extensions=e.extensions||{},e.extensions[n]=i,this.registerUsedExtension(n),this}setObjectExtension(e,n,i){(e.extensions||{})[n]=i}removeObjectExtension(e,n){const i=e.extensions||{},r=i[n];return delete i[n],r}addExtension(e,n={}){return br(n),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=n,this.registerUsedExtension(e),n}addRequiredExtension(e,n={}){return br(n),this.addExtension(e,n),this.registerRequiredExtension(e),n}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(n=>n===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(n=>n===e)||this.json.extensionsRequired.push(e)}removeExtension(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:n}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:n}),this.json.scenes.length-1}addNode(e){const{meshIndex:n,matrix:i}=e;this.json.nodes=this.json.nodes||[];const r={mesh:n};return i&&(r.matrix=i),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(e){const{attributes:n,indices:i,material:r,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(n),mode:s}]};if(i){const c=this._addIndices(i);a.primitives[0].indices=c}return Number.isFinite(r)&&(a.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const i={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}addImage(e,n){const i=LI(e),r=n||i?.mimeType,o={bufferView:this.addBufferView(e),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const n=e.byteLength;br(Number.isFinite(n)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const i={buffer:0,byteOffset:this.byteLength,byteLength:n};return this.byteLength+=kp(n,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(e,n){const i={bufferView:e,type:g8(n.size),componentType:n.componentType,count:n.count,max:n.max,min:n.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(i),this.json.accessors.length-1}addBinaryBuffer(e,n={size:3}){const i=this.addBufferView(e);let r={min:n.min,max:n.max};(!r.min||!r.max)&&(r=this._getAccessorMinMax(e,n.size));const s={size:n.size,componentType:m8(e),count:Math.round(e.length/n.size),min:r.min,max:r.max};return this.addAccessor(i,Object.assign(s,n))}addTexture(e){const{imageIndex:n}=e,i={source:n};return this.json.textures=this.json.textures||[],this.json.textures.push(i),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,n;this.gltf.buffers=[];const i=this.byteLength,r=new ArrayBuffer(i),s=new Uint8Array(r);let o=0;for(const a of this.sourceBuffers||[])o=kSe(a,s,o);null!==(e=this.json)&&void 0!==e&&null!==(n=e.buffers)&&void 0!==n&&n[0]?this.json.buffers[0].byteLength=i:this.json.buffers=[{byteLength:i}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(e,n){let i=!0;for(;i;){const r=e.indexOf(n);r>-1?e.splice(r,1):i=!1}}_addAttributes(e={}){const n={};for(const i in e){const r=e[i],s=this._getGltfAttributeName(i),o=this.addBinaryBuffer(r.value,r);n[s]=o}return n}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,n){const i={min:null,max:null};if(e.length<n)return i;i.min=[],i.max=[];const r=e.subarray(0,n);for(const s of r)i.min.push(s),i.max.push(s);for(let s=n;s<e.length;s+=n)for(let o=0;o<n;o++)i.min[0+o]=Math.min(i.min[0+o],e[s+o]),i.max[0+o]=Math.max(i.max[0+o],e[s+o]);return i}}const $Se="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",qSe="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",XSe=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),YSe=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),y8={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},KSe={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};function jI(){return jI=ee(function*(t,e,n,i,r,s="NONE"){const o=yield function nb(){return zI.apply(this,arguments)}();!function ib(t,e,n,i,r,s,o){const a=t.exports.sbrk,c=i+3&-4,l=a(c*r),u=a(s.length),d=new Uint8Array(t.exports.memory.buffer);d.set(s,u);const h=e(l,i,r,u,s.length);if(0===h&&o&&o(l,c,r),n.set(d.subarray(l,l+i*r)),a(l-a(0)),0!==h)throw new Error("Malformed buffer data: ".concat(h))}(o,o.exports[KSe[r]],t,e,n,i,o.exports[y8[s||"NONE"]])}),jI.apply(this,arguments)}let HI;function zI(){return zI=ee(function*(){return HI||(HI=function ZSe(){return GI.apply(this,arguments)}()),HI}),zI.apply(this,arguments)}function GI(){return GI=ee(function*(){let t=$Se;WebAssembly.validate(XSe)&&(t=qSe,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const e=yield WebAssembly.instantiate(function QSe(t){const e=new Uint8Array(t.length);for(let i=0;i<t.length;++i){const r=t.charCodeAt(i);e[i]=r>96?r-71:r>64?r-65:r>47?r+4:r>46?63:62}let n=0;for(let i=0;i<t.length;++i)e[n++]=e[i]<60?YSe[e[i]]:64*(e[i]-60)+e[++i];return e.buffer.slice(0,n)}(t),{});return yield e.instance.exports.__wasm_call_ctors(),e.instance}),GI.apply(this,arguments)}const WI="EXT_meshopt_compression",exe=WI;function txe(t,e){return $I.apply(this,arguments)}function $I(){return $I=ee(function*(t,e){var n;const i=new Vr(t);if(null==e||null===(n=e.gltf)||void 0===n||!n.decompressMeshes)return;const r=[];for(const s of t.json.bufferViews||[])r.push(nxe(i,s));yield Promise.all(r),i.removeExtension(WI)}),$I.apply(this,arguments)}function nxe(t,e){return qI.apply(this,arguments)}function qI(){return qI=ee(function*(t,e){const n=t.getObjectExtension(e,WI);if(n){const{byteOffset:i=0,byteLength:r=0,byteStride:s,count:o,mode:a,filter:c="NONE",buffer:l}=n,u=t.gltf.buffers[l],d=new Uint8Array(u.arrayBuffer,u.byteOffset+i,r),h=new Uint8Array(t.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);return yield function JSe(t,e,n,i,r){return jI.apply(this,arguments)}(h,o,s,d,a,c),h}return null}),qI.apply(this,arguments)}const ixe=["image/png","image/jpeg","image/gif"],XI={};const Ad="EXT_texture_webp",axe=Ad;function cxe(t,e){const n=new Vr(t);if(!function rxe(t){return void 0===XI[t]&&(XI[t]=function sxe(t){switch(t){case"image/webp":return function oxe(){if(!tb)return!1;try{return 0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")}catch{return!1}}();case"image/svg":return tb;default:if(!tb){const{_parseImageNode:e}=globalThis;return!!e&&ixe.includes(t)}return!0}}(t)),XI[t]}("image/webp")){if(n.getRequiredExtensions().includes(Ad))throw new Error("gltf: Required extension ".concat(Ad," not supported by browser"));return}const{json:i}=n;for(const r of i.textures||[]){const s=n.getObjectExtension(r,Ad);s&&(r.source=s.source),n.removeObjectExtension(r,Ad)}n.removeExtension(Ad)}const rb="KHR_texture_basisu",lxe=rb;function uxe(t,e){const n=new Vr(t),{json:i}=n;for(const r of i.textures||[]){const s=n.getObjectExtension(r,rb);s&&(r.source=s.source),n.removeObjectExtension(r,rb)}n.removeExtension(rb)}const b8={name:"Draco",id:"draco",module:"draco",shapes:["mesh"],version:"3.2.13",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};class sb{constructor(e,n,i=!1,r=new Map){E(this,"name",void 0),E(this,"type",void 0),E(this,"nullable",void 0),E(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new sb(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let nt,E8,w8,A8,C8,T8,S8,x8,I8;!function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth"}(nt||(nt={}));class jr{static isNull(e){return e&&e.typeId===nt.Null}static isInt(e){return e&&e.typeId===nt.Int}static isFloat(e){return e&&e.typeId===nt.Float}static isBinary(e){return e&&e.typeId===nt.Binary}static isUtf8(e){return e&&e.typeId===nt.Utf8}static isBool(e){return e&&e.typeId===nt.Bool}static isDecimal(e){return e&&e.typeId===nt.Decimal}static isDate(e){return e&&e.typeId===nt.Date}static isTime(e){return e&&e.typeId===nt.Time}static isTimestamp(e){return e&&e.typeId===nt.Timestamp}static isInterval(e){return e&&e.typeId===nt.Interval}static isList(e){return e&&e.typeId===nt.List}static isStruct(e){return e&&e.typeId===nt.Struct}static isUnion(e){return e&&e.typeId===nt.Union}static isFixedSizeBinary(e){return e&&e.typeId===nt.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===nt.FixedSizeList}static isMap(e){return e&&e.typeId===nt.Map}static isDictionary(e){return e&&e.typeId===nt.Dictionary}get typeId(){return nt.NONE}compareTo(e){return this===e}}Symbol,Symbol,E8=Symbol.toStringTag;class Xa extends jr{constructor(e,n){super(),E(this,"isSigned",void 0),E(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return nt.Int}get[E8](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class hxe extends Xa{constructor(){super(!0,8)}}class fxe extends Xa{constructor(){super(!0,16)}}class pxe extends Xa{constructor(){super(!0,32)}}class gxe extends Xa{constructor(){super(!1,8)}}class mxe extends Xa{constructor(){super(!1,16)}}class _xe extends Xa{constructor(){super(!1,32)}}w8=Symbol.toStringTag;class KI extends jr{constructor(e){super(),E(this,"precision",void 0),this.precision=e}get typeId(){return nt.Float}get[w8](){return"Float"}toString(){return"Float".concat(this.precision)}}class yxe extends KI{constructor(){super(32)}}class vxe extends KI{constructor(){super(64)}}Symbol,Symbol,A8=Symbol.toStringTag,C8=Symbol.toStringTag,T8=Symbol.toStringTag,S8=Symbol.toStringTag,x8=Symbol.toStringTag;class bxe extends jr{constructor(e,n){super(),E(this,"listSize",void 0),E(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return nt.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[x8](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}I8=Symbol.toStringTag;class Cd{constructor(e,n){E(this,"fields",void 0),E(this,"metadata",void 0),function Cxe(t,e){if(!t)throw new Error(e||"loader assertion failed.")}(Array.isArray(e)),function Txe(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(...e){const n=Object.create(null);for(const r of e)n[r]=!0;const i=this.fields.filter(r=>n[r.name]);return new Cd(i,this.metadata)}selectAt(...e){const n=e.map(i=>this.fields[i]).filter(Boolean);return new Cd(n,this.metadata)}assign(e){let n,i=this.metadata;if(e instanceof Cd){const o=e;n=o.fields,i=P8(P8(new Map,this.metadata),o.metadata)}else n=e;const r=Object.create(null);for(const o of this.fields)r[o.name]=o;for(const o of n)r[o.name]=o;const s=Object.values(r);return new Cd(s,i)}}function P8(t,e){return new Map([...t||new Map,...e||new Map])}function N8(t,e,n){return function O8(t,e,n){const i=function Exe(t){switch(t.constructor){case Int8Array:return new hxe;case Uint8Array:return new gxe;case Int16Array:return new fxe;case Uint16Array:return new mxe;case Int32Array:return new pxe;case Uint32Array:return new _xe;case Float32Array:return new yxe;case Float64Array:return new vxe;default:throw new Error("array type not supported")}}(e.value),r=n||function Axe(t){const e=new Map;return"byteOffset"in t&&e.set("byteOffset",t.byteOffset.toString(10)),"byteStride"in t&&e.set("byteStride",t.byteStride.toString(10)),"normalized"in t&&e.set("normalized",t.normalized.toString()),e}(e);return new sb(t,new bxe(e.size,new sb("value",i)),!1,r)}(t,e,n?L8(n.metadata):void 0)}function L8(t){const e=new Map;for(const n in t)e.set("".concat(n,".string"),JSON.stringify(t[n]));return e}const F8={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},Ixe={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class Dxe{constructor(e){E(this,"draco",void 0),E(this,"decoder",void 0),E(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,n={}){const i=new this.draco.DecoderBuffer;i.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(n);const r=this.decoder.GetEncodedGeometryType(i),s=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(r){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(i,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(i,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const h="DRACO decompression failed: ".concat(o.error_msg());throw new Error(h)}const a=this._getDracoLoaderData(s,r,n),c=this._getMeshData(s,a,n),l=function dxe(t){let e=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;const a=t.POSITION?t.POSITION.value:[],c=a&&a.length;for(let l=0;l<c;l+=3){const u=a[l],d=a[l+1],h=a[l+2];e=u<e?u:e,n=d<n?d:n,i=h<i?h:i,r=u>r?u:r,s=d>s?d:s,o=h>o?h:o}return[[e,n,i],[r,s,o]]}(c.attributes),u=function Sxe(t,e,n){const i=L8(e.metadata),r=[],s=function xxe(t){const e={};for(const n in t){const i=t[n];e[i.name||"undefined"]=i}return e}(e.attributes);for(const o in t){const c=N8(o,t[o],s[o]);r.push(c)}if(n){const o=N8("indices",n);r.push(o)}return new Cd(r,i)}(c.attributes,a,c.indices);return{loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:l},...c,schema:u}}finally{this.draco.destroy(i),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,n,i){const r=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,i);return{geometry_type:n,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:r,attributes:s}}_getDracoAttributes(e,n){const i={};for(let r=0;r<e.num_attributes();r++){const s=this.decoder.GetAttribute(e,r),o=this._getAttributeMetadata(e,r);i[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:r,metadata:o};const a=this._getQuantizationTransform(s,n);a&&(i[s.unique_id()].quantization_transform=a);const c=this._getOctahedronTransform(s,n);c&&(i[s.unique_id()].octahedron_transform=c)}return i}_getMeshData(e,n,i){const r=this._getMeshAttributes(n,e,i);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");return e instanceof this.draco.Mesh?"triangle-strip"===i.topology?{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(e),size:1}}:{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(e),size:1}}:{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(e,n,i){const r={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,i);s.name=o;const{value:a,size:c}=this._getAttributeValues(n,s);r[o]={value:a,size:c,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return r}_getTriangleListIndices(e){const i=3*e.num_faces(),r=4*i,s=this.draco._malloc(r);try{return this.decoder.GetTrianglesUInt32Array(e,r,s),new Uint32Array(this.draco.HEAPF32.buffer,s,i).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const n=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,n),function Pxe(t){const e=t.size(),n=new Int32Array(e);for(let i=0;i<e;i++)n[i]=t.GetValue(i);return n}(n)}finally{this.draco.destroy(n)}}_getAttributeValues(e,n){const i=Ixe[n.data_type],r=n.num_components,o=e.num_points()*r,a=o*i.BYTES_PER_ELEMENT,c=function Rxe(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}(this.draco,i);let l;const u=this.draco._malloc(a);try{const d=this.decoder.GetAttribute(e,n.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,d,c,a,u),l=new i(this.draco.HEAPF32.buffer,u,o).slice()}finally{this.draco._free(u)}return{value:l,size:r}}_deduceAttributeName(e,n){const i=e.unique_id;for(const[o,a]of Object.entries(n.extraAttributes||{}))if(a===i)return o;const r=e.attribute_type;for(const o in F8)if(this.draco[o]===r)return F8[o];const s=n.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:"CUSTOM_ATTRIBUTE_".concat(i)}_getTopLevelMetadata(e){const n=this.decoder.GetMetadata(e);return this._getDracoMetadata(n)}_getAttributeMetadata(e,n){const i=this.decoder.GetAttributeMetadata(e,n);return this._getDracoMetadata(i)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const n={},i=this.metadataQuerier.NumEntries(e);for(let r=0;r<i;r++){const s=this.metadataQuerier.GetEntryName(e,r);n[s]=this._getDracoMetadataField(e,s)}return n}_getDracoMetadataField(e,n){const i=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,n,i);const r=function Oxe(t){const e=t.size(),n=new Int32Array(e);for(let i=0;i<e;i++)n[i]=t.GetValue(i);return n}(i);return{int:this.metadataQuerier.GetIntEntry(e,n),string:this.metadataQuerier.GetStringEntry(e,n),double:this.metadataQuerier.GetDoubleEntry(e,n),intArray:r}}finally{this.draco.destroy(i)}}_disableAttributeTransforms(e){const{quantizedAttributes:n=[],octahedronAttributes:i=[]}=e,r=[...n,...i];for(const s of r)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,n){const{quantizedAttributes:i=[]}=n,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,n){const{octahedronAttributes:i=[]}=n,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}const ab="1.4.1",Nxe="https://www.gstatic.com/draco/versioned/decoders/".concat(ab,"/draco_decoder.js"),Lxe="https://www.gstatic.com/draco/versioned/decoders/".concat(ab,"/draco_wasm_wrapper.js"),Fxe="https://www.gstatic.com/draco/versioned/decoders/".concat(ab,"/draco_decoder.wasm");let Up;function QI(){return QI=ee(function*(t){const e=t.modules||{};return Up=e.draco3d?Up||e.draco3d.createDecoderModule({}).then(n=>({draco:n})):Up||function Uxe(t){return tM.apply(this,arguments)}(t),yield Up}),QI.apply(this,arguments)}function tM(){return tM=ee(function*(t){let e,n;return"js"===(t.draco&&t.draco.decoderType)?e=yield ll(Nxe,"draco",t):[e,n]=yield Promise.all([yield ll(Lxe,"draco",t),yield ll(Fxe,"draco",t)]),e=e||globalThis.DracoDecoderModule,yield function Vxe(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(i=>{t({...n,onModuleLoaded:r=>i({draco:r})})})}(e,n)}),tM.apply(this,arguments)}"https://raw.githubusercontent.com/google/draco/".concat(ab,"/javascript/draco_encoder.js");const iM={...b8,parse:function Hxe(t,e){return rM.apply(this,arguments)}};function rM(){return rM=ee(function*(t,e){const{draco:n}=yield function kxe(t){return QI.apply(this,arguments)}(e),i=new Dxe(n);try{return i.parseSync(t,e?.draco)}finally{i.destroy()}}),rM.apply(this,arguments)}function B8(t){const{buffer:e,size:n,count:i}=function Gxe(t){let e=t,n=1,i=0;return t&&t.value&&(e=t.value,n=t.size||1),e&&(ArrayBuffer.isView(e)||(e=function Wxe(t,e,n=!1){return t?Array.isArray(t)?new e(t):!n||t instanceof e?t:new e(t):null}(e,Float32Array)),i=e.length/n),{buffer:e,size:n,count:i}}(t);return{value:e,size:n,byteOffset:0,count:i,type:g8(n),componentType:m8(e)}}const dl="KHR_draco_mesh_compression",$xe=dl;function qxe(t,e,n){const i=new Vr(t);for(const r of k8(i))i.getObjectExtension(r,dl)}function Xxe(t,e,n){return sM.apply(this,arguments)}function sM(){return sM=ee(function*(t,e,n){var i;if(null==e||null===(i=e.gltf)||void 0===i||!i.decompressMeshes)return;const r=new Vr(t),s=[];for(const o of k8(r))r.getObjectExtension(o,dl)&&s.push(Kxe(r,o,e,n));yield Promise.all(s),r.removeExtension(dl)}),sM.apply(this,arguments)}function Yxe(t,e={}){const n=new Vr(t);for(const i of n.json.meshes||[])Jxe(i),n.addRequiredExtension(dl)}function Kxe(t,e,n,i){return oM.apply(this,arguments)}function oM(){return oM=ee(function*(t,e,n,i){const r=t.getObjectExtension(e,dl);if(!r)return;const s=t.getTypedArrayForBufferView(r.bufferView),o=d8(s.buffer,s.byteOffset),{parse:a}=i,c={...n};delete c["3d-tiles"];const l=yield a(o,iM,c,i),u=function zxe(t){const e={};for(const n in t)if("indices"!==n){const r=B8(t[n]);e[n]=r}return e}(l.attributes);for(const[d,h]of Object.entries(u))if(d in e.attributes){const p=t.getAccessor(e.attributes[d]);null!=p&&p.min&&null!=p&&p.max&&(h.min=p.min,h.max=p.max)}e.attributes=u,l.indices&&(e.indices=B8(l.indices)),function Zxe(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}(e)}),oM.apply(this,arguments)}function Jxe(t,e,n=4,i,r){var s;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=i.DracoWriter.encodeSync({attributes:t}),a=null==r||null===(s=r.parseSync)||void 0===s?void 0:s.call(r,{attributes:t}),c=i._addFauxAttributes(a.attributes),l=i.addBufferView(o);return{primitives:[{attributes:c,mode:n,extensions:{[dl]:{bufferView:l,attributes:c}}}]}}function*k8(t){for(const e of t.json.meshes||[])for(const n of e.primitives)yield n}const hl="KHR_lights_punctual",Qxe=hl;function eIe(t){return aM.apply(this,arguments)}function aM(){return aM=ee(function*(t){const e=new Vr(t),{json:n}=e,i=e.getExtension(hl);i&&(e.json.lights=i.lights,e.removeExtension(hl));for(const r of n.nodes||[]){const s=e.getObjectExtension(r,hl);s&&(r.light=s.light),e.removeObjectExtension(r,hl)}}),aM.apply(this,arguments)}function tIe(t){return cM.apply(this,arguments)}function cM(){return cM=ee(function*(t){const e=new Vr(t),{json:n}=e;if(n.lights){const i=e.addExtension(hl);br(!i.lights),i.lights=n.lights,delete n.lights}if(e.json.lights){for(const i of e.json.lights)e.addObjectExtension(i.node,hl,i);delete e.json.lights}}),cM.apply(this,arguments)}const jp="KHR_materials_unlit",nIe=jp;function iIe(t){return lM.apply(this,arguments)}function lM(){return lM=ee(function*(t){const e=new Vr(t),{json:n}=e;e.removeExtension(jp);for(const i of n.materials||[])i.extensions&&i.extensions.KHR_materials_unlit&&(i.unlit=!0),e.removeObjectExtension(i,jp)}),lM.apply(this,arguments)}function rIe(t){const e=new Vr(t),{json:n}=e;if(e.materials)for(const i of n.materials||[])i.unlit&&(delete i.unlit,e.addObjectExtension(i,jp,{}),e.addExtension(jp))}const Hp="KHR_techniques_webgl",sIe=Hp;function oIe(t){return uM.apply(this,arguments)}function uM(){return uM=ee(function*(t){const e=new Vr(t),{json:n}=e,i=e.getExtension(Hp);if(i){const r=function cIe(t,e){const{programs:n=[],shaders:i=[],techniques:r=[]}=t,s=new TextDecoder;return i.forEach(o=>{if(!Number.isFinite(o.bufferView))throw new Error("KHR_techniques_webgl: no shader code");o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView))}),n.forEach(o=>{o.fragmentShader=i[o.fragmentShader],o.vertexShader=i[o.vertexShader]}),r.forEach(o=>{o.program=n[o.program]}),r}(i,e);for(const s of n.materials||[]){const o=e.getObjectExtension(s,Hp);o&&(s.technique=Object.assign({},o,r[o.technique]),s.technique.values=lIe(s.technique,e)),e.removeObjectExtension(s,Hp)}e.removeExtension(Hp)}}),uM.apply(this,arguments)}function aIe(t,e){return dM.apply(this,arguments)}function dM(){return(dM=ee(function*(t,e){})).apply(this,arguments)}function lIe(t,e){const n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach(i=>{t.uniforms[i].value&&!(i in n)&&(n[i]=t.uniforms[i].value)}),Object.keys(n).forEach(i=>{"object"==typeof n[i]&&void 0!==n[i].index&&(n[i].texture=e.getTexture(n[i].index))}),n}const U8=[Kt,xt,$t,Nn,fe,rt,be];function hM(){return hM=ee(function*(t,e={},n){const i=U8.filter(s=>V8(s.name,e));for(const s of i){var r;yield null===(r=s.decode)||void 0===r?void 0:r.call(s,t,e,n)}}),hM.apply(this,arguments)}function V8(t,e){var n;const i=(null==e||null===(n=e.gltf)||void 0===n?void 0:n.excludeExtensions)||{};return!(t in i&&!i[t])}const fM="KHR_binary_glTF",j8={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},fIe={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class pIe{constructor(){E(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),E(this,"json",void 0)}normalize(e,n){this.json=e.json;const i=e.json;switch(i.asset&&i.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn("glTF: Unknown version ".concat(i.asset.version))}if(!n.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(i),this._convertTopLevelObjectsToArrays(i),function hIe(t){const e=new Vr(t),{json:n}=e;for(const i of n.images||[]){const r=e.getObjectExtension(i,fM);r&&Object.assign(i,r),e.removeObjectExtension(i,fM)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,e.removeExtension(fM)}(e),this._convertObjectIdsToArrayIndices(i),this._updateObjects(i),this._updateMaterial(i)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const n in j8)this._convertTopLevelObjectToArray(e,n)}_convertTopLevelObjectToArray(e,n){const i=e[n];if(i&&!Array.isArray(i)){e[n]=[];for(const r in i){const s=i[r];s.id=s.id||r;const o=e[n].length;e[n].push(s),this.idToIndexMap[n][r]=o}}}_convertObjectIdsToArrayIndices(e){for(const n in j8)this._convertIdsToIndices(e,n);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const n of e.textures)this._convertTextureIds(n);for(const n of e.meshes)this._convertMeshIds(n);for(const n of e.nodes)this._convertNodeIds(n);for(const n of e.scenes)this._convertSceneIds(n)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const n of e.primitives){const{attributes:i,indices:r,material:s}=n;for(const o in i)i[o]=this._convertIdToIndex(i[o],"accessor");r&&(n.indices=this._convertIdToIndex(r,"accessor")),s&&(n.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(n=>this._convertIdToIndex(n,"node"))),e.meshes&&(e.meshes=e.meshes.map(n=>this._convertIdToIndex(n,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(n=>this._convertIdToIndex(n,"node")))}_convertIdsToIndices(e,n){e[n]||(console.warn("gltf v1: json doesn't contain attribute ".concat(n)),e[n]=[]);for(const i of e[n])for(const r in i){const o=this._convertIdToIndex(i[r],r);i[r]=o}}_convertIdToIndex(e,n){const i=fIe[n];if(i in this.idToIndexMap){const r=this.idToIndexMap[i][e];if(!Number.isFinite(r))throw new Error("gltf v1: failed to resolve ".concat(n," with id ").concat(e));return r}return e}_updateObjects(e){for(const n of this.json.buffers)delete n.type}_updateMaterial(e){for(const s of e.materials){var n,i,r;s.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const o=(null===(n=s.values)||void 0===n?void 0:n.tex)||(null===(i=s.values)||void 0===i?void 0:i.texture2d_0)||(null===(r=s.values)||void 0===r?void 0:r.diffuseTex),a=e.textures.findIndex(c=>c.id===o);-1!==a&&(s.pbrMetallicRoughness.baseColorTexture={index:a})}}}const mIe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_Ie={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Hr_TEXTURE_MAG_FILTER=10240,Hr_TEXTURE_MIN_FILTER=10241,Hr_TEXTURE_WRAP_S=10242,Hr_TEXTURE_WRAP_T=10243,yIe={magFilter:10240,minFilter:10241,wrapS:10242,wrapT:10243},vIe={[Hr_TEXTURE_MAG_FILTER]:9729,[Hr_TEXTURE_MIN_FILTER]:9986,[Hr_TEXTURE_WRAP_S]:10497,[Hr_TEXTURE_WRAP_T]:10497};class wIe{constructor(){E(this,"baseUri",""),E(this,"json",{}),E(this,"buffers",[]),E(this,"images",[])}postProcess(e,n={}){const{json:i,buffers:r=[],images:s=[],baseUri:o=""}=e;return br(i),this.baseUri=o,this.json=i,this.buffers=r,this.images=s,this._resolveTree(this.json,n),this.json}_resolveTree(e,n={}){e.bufferViews&&(e.bufferViews=e.bufferViews.map((i,r)=>this._resolveBufferView(i,r))),e.images&&(e.images=e.images.map((i,r)=>this._resolveImage(i,r))),e.samplers&&(e.samplers=e.samplers.map((i,r)=>this._resolveSampler(i,r))),e.textures&&(e.textures=e.textures.map((i,r)=>this._resolveTexture(i,r))),e.accessors&&(e.accessors=e.accessors.map((i,r)=>this._resolveAccessor(i,r))),e.materials&&(e.materials=e.materials.map((i,r)=>this._resolveMaterial(i,r))),e.meshes&&(e.meshes=e.meshes.map((i,r)=>this._resolveMesh(i,r))),e.nodes&&(e.nodes=e.nodes.map((i,r)=>this._resolveNode(i,r))),e.skins&&(e.skins=e.skins.map((i,r)=>this._resolveSkin(i,r))),e.scenes&&(e.scenes=e.scenes.map((i,r)=>this._resolveScene(i,r))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,n){if("object"==typeof n)return n;const i=this.json[e]&&this.json[e][n];return i||console.warn("glTF file error: Could not find ".concat(e,"[").concat(n,"]")),i}_resolveScene(e,n){return e.id=e.id||"scene-".concat(n),e.nodes=(e.nodes||[]).map(i=>this.getNode(i)),e}_resolveNode(e,n){return e.id=e.id||"node-".concat(n),e.children&&(e.children=e.children.map(i=>this.getNode(i))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((i,r)=>{const s=this.getMesh(r);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,n){return e.id=e.id||"skin-".concat(n),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,n){return e.id=e.id||"mesh-".concat(n),e.primitives&&(e.primitives=e.primitives.map(i=>{const r=(i={...i}).attributes;i.attributes={};for(const s in r)i.attributes[s]=this.getAccessor(r[s]);return void 0!==i.indices&&(i.indices=this.getAccessor(i.indices)),void 0!==i.material&&(i.material=this.getMaterial(i.material)),i})),e}_resolveMaterial(e,n){if(e.id=e.id||"material-".concat(n),e.normalTexture&&(e.normalTexture={...e.normalTexture},e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture={...e.occlustionTexture},e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture={...e.emmisiveTexture},e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness={...e.pbrMetallicRoughness};const i=e.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture={...i.baseColorTexture},i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture={...i.metallicRoughnessTexture},i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,n){if(e.id=e.id||"accessor-".concat(n),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=function bIe(t){return _Ie[t]}(e.componentType),e.components=function EIe(t){return mIe[t]}(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const i=e.bufferView.buffer,{ArrayType:r,byteLength:s}=_8(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+i.byteOffset;let a=i.arrayBuffer.slice(o,o+s);e.bufferView.byteStride&&(a=this._getValueFromInterleavedBuffer(i,o,e.bufferView.byteStride,e.bytesPerElement,e.count)),e.value=new r(a)}return e}_getValueFromInterleavedBuffer(e,n,i,r,s){const o=new Uint8Array(s*r);for(let a=0;a<s;a++){const c=n+a*i;o.set(new Uint8Array(e.arrayBuffer.slice(c,c+r)),a*r)}return o.buffer}_resolveTexture(e,n){return e.id=e.id||"texture-".concat(n),e.sampler="sampler"in e?this.getSampler(e.sampler):vIe,e.source=this.getImage(e.source),e}_resolveSampler(e,n){e.id=e.id||"sampler-".concat(n),e.parameters={};for(const i in e){const r=this._enumSamplerParameter(i);void 0!==r&&(e.parameters[r]=e[i])}return e}_enumSamplerParameter(e){return yIe[e]}_resolveImage(e,n){e.id=e.id||"image-".concat(n),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));const i=this.images[n];return i&&(e.image=i),e}_resolveBufferView(e,n){const i=e.buffer,r={id:"bufferView-".concat(n),...e,buffer:this.buffers[i]};let o=this.buffers[i].byteOffset||0;return"byteOffset"in e&&(o+=e.byteOffset),r.data=new Uint8Array(this.buffers[i].arrayBuffer,o,e.byteLength),r}_resolveCamera(e,n){return e.id=e.id||"camera-".concat(n),e}}const H8=1735152710,pM=12,cb=8,CIe=1313821514,TIe=5130562,SIe=0,xIe=1,IIe=0,Td=!0;function gM(t,e,n,i){const r=new Uint8Array(e.buffer,n,i),o=new TextDecoder("utf8").decode(r);return t.json=JSON.parse(o),kp(i,4)}function mM(t,e,n,i){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:i,arrayBuffer:e.buffer}),kp(i,4)}function _M(){return _M=ee(function*(t,e,n=0,i,r){var s,o,a,c;(function FIe(t,e,n,i){if(i.uri&&(t.baseUri=i.uri),e instanceof ArrayBuffer&&!function DIe(t,e=0,n={}){const i=new DataView(t),{magic:r=H8}=n,s=i.getUint32(e,!1);return s===r||s===H8}(e,n,i)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)t.json=function BSe(t){try{return JSON.parse(t)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(function FSe(t,e=5){return"string"==typeof t?t.slice(0,e):ArrayBuffer.isView(t)?u8(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?u8(t,0,e):""}(t),'"'))}}(e);else if(e instanceof ArrayBuffer){const o={};n=function RIe(t,e,n=0,i={}){const r=new DataView(e),s=function MIe(t,e=0){return"".concat(String.fromCharCode(t.getUint8(e+0))).concat(String.fromCharCode(t.getUint8(e+1))).concat(String.fromCharCode(t.getUint8(e+2))).concat(String.fromCharCode(t.getUint8(e+3)))}(r,n+0),o=r.getUint32(n+4,Td),a=r.getUint32(n+8,Td);switch(Object.assign(t,{header:{byteOffset:n,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),n+=pM,t.version){case 1:return function OIe(t,e,n){ul(t.header.byteLength>pM+cb);const i=e.getUint32(n+0,Td),r=e.getUint32(n+4,Td);return n+=cb,ul(r===IIe),gM(t,e,n,i),(n+=i)+mM(t,e,n,t.header.byteLength)}(t,r,n);case 2:return function PIe(t,e,n,i){return ul(t.header.byteLength>pM+cb),function NIe(t,e,n,i){for(;n+8<=t.header.byteLength;){const r=e.getUint32(n+0,Td),s=e.getUint32(n+4,Td);switch(n+=cb,s){case CIe:gM(t,e,n,r);break;case TIe:mM(t,e,n,r);break;case SIe:i.strict||gM(t,e,n,r);break;case xIe:i.strict||mM(t,e,n,r)}n+=kp(r,4)}}(t,e,n,i),n+t.header.byteLength}(t,r,n,{});default:throw new Error("Invalid GLB version ".concat(t.version,". Only supports v1 and v2."))}}(o,e,n,i.glb),br("glTF"===o.type,"Invalid GLB magic string ".concat(o.type)),t._glb=o,t.json=o.json}else br(!1,"GLTF: must be ArrayBuffer or string");if(t.buffers=new Array((t.json.buffers||[]).length).fill(null),t._glb&&t._glb.header.hasBinChunk){const{binChunks:o}=t._glb;t.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}t.images=new Array((t.json.images||[]).length).fill({})})(t,e,n,i),function gIe(t,e={}){(new pIe).normalize(t,e)}(t,{normalize:null==i||null===(s=i.gltf)||void 0===s?void 0:s.normalize}),function uIe(t,e={},n){const i=U8.filter(s=>V8(s.name,e));for(const s of i){var r;null===(r=s.preprocess)||void 0===r||r.call(s,t,e,n)}}(t,i,r);const l=[];if(null!=i&&null!==(o=i.gltf)&&void 0!==o&&o.loadBuffers&&t.json.buffers&&(yield function BIe(t,e,n){return yM.apply(this,arguments)}(t,i,r)),null!=i&&null!==(a=i.gltf)&&void 0!==a&&a.loadImages){const d=function kIe(t,e,n){return vM.apply(this,arguments)}(t,i,r);l.push(d)}const u=function dIe(t){return hM.apply(this,arguments)}(t,i,r);return l.push(u),yield Promise.all(l),null!=i&&null!==(c=i.gltf)&&void 0!==c&&c.postProcess?function AIe(t,e){return(new wIe).postProcess(t,e)}(t,i):t}),_M.apply(this,arguments)}function yM(){return yM=ee(function*(t,e,n){const i=t.json.buffers||[];for(let o=0;o<i.length;++o){const a=i[o];if(a.uri){var r,s;const{fetch:c}=n;br(c);const l=h8(a.uri,e),u=yield null==n||null===(r=n.fetch)||void 0===r?void 0:r.call(n,l),d=yield null==u||null===(s=u.arrayBuffer)||void 0===s?void 0:s.call(u);t.buffers[o]={arrayBuffer:d,byteOffset:0,byteLength:d.byteLength},delete a.uri}else null===t.buffers[o]&&(t.buffers[o]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength})}}),yM.apply(this,arguments)}function vM(){return vM=ee(function*(t,e,n){const i=function UIe(t){const e=new Set,n=t.json.textures||[];for(const i of n)void 0!==i.source&&e.add(i.source);return Array.from(e).sort()}(t),r=t.json.images||[],s=[];for(const o of i)s.push(VIe(t,r[o],o,e,n));return yield Promise.all(s)}),vM.apply(this,arguments)}function VIe(t,e,n,i,r){return bM.apply(this,arguments)}function bM(){return bM=ee(function*(t,e,n,i,r){const{fetch:s,parse:o}=r;let a;if(e.uri&&!e.hasOwnProperty("bufferView")){const l=h8(e.uri,i);a=yield(yield s(l)).arrayBuffer()}if(Number.isFinite(e.bufferView)){const l=function f8(t,e,n){const i=t.bufferViews[n];br(i);const s=e[i.buffer];return br(s),new Uint8Array(s.arrayBuffer,(i.byteOffset||0)+s.byteOffset,i.byteLength)}(t.json,t.buffers,e.bufferView);a=d8(l.buffer,l.byteOffset,l.byteLength)}br(a,"glTF image has no data");let c=yield o(a,[LSe,pSe],{mimeType:e.mimeType,basis:i.basis||{format:n8()}},r);c&&c[0]&&(c={compressed:!0,mipmaps:!1,width:c[0].width,height:c[0].height,data:c[0]}),t.images=t.images||[],t.images[n]=c}),bM.apply(this,arguments)}const Sd={name:"glTF",id:"gltf",module:"gltf",version:"3.2.13",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function jIe(t){return EM.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function EM(){return EM=ee(function*(t,e={},n){(e={...Sd.options,...e}).gltf={...Sd.options.gltf,...e.gltf};const{byteOffset:i=0}=e;return yield function LIe(t,e){return _M.apply(this,arguments)}({},t,i,e,n)}),EM.apply(this,arguments)}function wM(){return wM=ee(function*(t){const e=[];return t.scenes.forEach(n=>{n.traverse(i=>{Object.values(i.model.getUniforms()).forEach(r=>{!1===r.loaded&&e.push(r)})})}),yield function zIe(t){return AM.apply(this,arguments)}(()=>e.some(n=>!n.loaded))}),wM.apply(this,arguments)}function AM(){return AM=ee(function*(t){for(;t();)yield new Promise(e=>requestAnimationFrame(e))}),AM.apply(this,arguments)}const z8=[255,255,255,255],$Ie={scenegraph:{type:"object",value:null,async:!0},getScene:t=>t&&t.scenes?"object"==typeof t.scene?t.scene:t.scenes[t.scene||0]:t,getAnimator:t=>t&&t.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:z8},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[Sd]};class CM extends cl{constructor(...e){super(...e),E(this,"state",void 0)}getShaders(){const e=[Wv,$v];return"pbr"===this.props._lighting&&e.push(N4),{vs:"#version 300 es\n\n// Instance attributes\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\n\n// Uniforms\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\n\n// Attributes\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\n\n// Varying\nout vec4 vColor;\n\n// MODULE_PBR contains all the varying definitions needed\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\n\n// Main\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  vec3 normal = vec3(0.0, 0.0, 1.0);\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;\n    #endif\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    // using instancePositions as world coordinates\n    // when using globe mode, this branch does not re-orient the model to align with the surface of the earth\n    // call project_normal before setting position to avoid rotation\n    geometry.normal = project_normal(normal);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n    geometry.normal = project_normal(normal);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    // set PBR data\n    pbr_vPosition = geometry.position.xyz;\n    #ifdef HAS_NORMALS\n      pbr_vNormal = geometry.normal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n\n// Uniforms\nuniform float opacity;\n\n// Varying\nin vec4 vColor;\n\nout vec4 fragmentColor;\n\n// MODULE_PBR contains all the varying definitions needed\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:e}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:z8,transition:!0},instanceModelMatrix:R4})}updateState(e){super.updateState(e);const{props:n,oldProps:i}=e;n.scenegraph!==i.scenegraph?this._updateScenegraph():n._animations!==i._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,n._animations)}finalizeState(e){super.finalizeState(e),this._deleteScenegraph()}_updateScenegraph(){const e=this.props,{gl:n}=this.context;let i=null;if(e.scenegraph instanceof Ed)i={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){const a=e.scenegraph,c=function WTe(t,e,n){const i=new GTe(t,n);return{scenes:i.instantiate(e),animator:i.createAnimator()}}(n,a,this._getModelOptions());i={gltf:a,...c},function HIe(t){return wM.apply(this,arguments)}(c).then(()=>this.setNeedsRedraw())}else e.scenegraph&&($e.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),i=e.scenegraph);const r={layer:this,gl:n},s=e.getScene(i,r),o=e.getAnimator(i,r);s instanceof Ed?(this._deleteScenegraph(),this._applyAllAttributes(s),this._applyAnimationsProp(s,o,e._animations),this.setState({scenegraph:s,animator:o})):null!==s&&$e.warn("invalid scenegraph:",s)()}_applyAllAttributes(e){if(this.state.attributesAvailable){const n=this.getAttributeManager().getAttributes();e.traverse(i=>{this._setModelAttributes(i.model,n)})}}_applyAnimationsProp(e,n,i){if(!e||!n||!i)return;const r=n.getAnimations();Object.keys(i).sort().forEach(s=>{const o=i[s];if("*"===s)r.forEach(a=>{Object.assign(a,o)});else if(Number.isFinite(Number(s))){const a=Number(s);a>=0&&a<r.length?Object.assign(r[a],o):$e.warn("animation ".concat(s," not found"))()}else{const a=r.find(({name:c})=>c===s);a?Object.assign(a,o):$e.warn("animation ".concat(s," not found"))()}})}_deleteScenegraph(){const{scenegraph:e}=this.state;e instanceof Ed&&e.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:e}=this.props;let n=null;return e&&(n="function"==typeof e?e({gl:this.context.gl,layer:this}):e),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:n,modelOptions:{isInstanced:!0,transpileToGLSL100:!He(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(e){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(n=>{this._setModelAttributes(n.model,e)})}draw({moduleParameters:e=null,parameters:n={},context:i}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(i.timeline.getTime()),this.setNeedsRedraw());const{viewport:r}=this.context,{sizeScale:s,sizeMinPixels:o,sizeMaxPixels:a,opacity:c,coordinateSystem:l}=this.props,u=this.getNumInstances();this.state.scenegraph.traverse((d,{worldMatrix:h})=>{d.model.setInstanceCount(u),d.updateModuleSettings(e),d.draw({parameters:n,uniforms:{sizeScale:s,opacity:c,sizeMinPixels:o,sizeMaxPixels:a,composeModelMatrix:O4(r,l),sceneModelMatrix:h,u_Camera:d.model.getUniforms().project_uCameraPosition}})})}}E(CM,"defaultProps",$Ie),E(CM,"layerName","ScenegraphLayer");class qIe extends qa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:n=$i("sphere-geometry")}=e,{indices:i,attributes:r}=function XIe(t){const{nlat:e=10,nlong:n=10}=t;let{radius:i=1}=t;const o=Math.PI-0,l=2*Math.PI-0,u=(e+1)*(n+1);if("number"==typeof i){const y=i;i=(v,_,w,C,S)=>y}const d=new Float32Array(3*u),h=new Float32Array(3*u),f=new Float32Array(2*u),g=new(u>65535?Uint32Array:Uint16Array)(e*n*6);for(let y=0;y<=e;y++)for(let v=0;v<=n;v++){const _=v/n,w=y/e,C=v+y*(n+1),S=2*C,M=3*C,x=l*_,N=o*w,U=Math.sin(x),k=Math.cos(x),z=Math.sin(N),F=k*z,W=Math.cos(N),G=U*z,ye=i(F,W,G,_,w);d[M+0]=ye*F,d[M+1]=ye*W,d[M+2]=ye*G,h[M+0]=F,h[M+1]=W,h[M+2]=G,f[S+0]=_,f[S+1]=1-w}const m=n+1;for(let y=0;y<n;y++)for(let v=0;v<e;v++){const _=6*(y*e+v);g[_+0]=v*m+y,g[_+1]=v*m+y+1,g[_+2]=(v+1)*m+y,g[_+3]=(v+1)*m+y,g[_+4]=v*m+y+1,g[_+5]=(v+1)*m+y+1}return{indices:{size:1,value:g},attributes:{POSITION:{size:3,value:d},NORMAL:{size:3,value:h},TEXCOORD_0:{size:2,value:f}}}}(e);super({...e,id:n,indices:i,attributes:{...r,...e.attributes}})}}const YIe={x:[2,0,1],y:[0,1,2],z:[1,2,0]};class G8 extends qa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:n=$i("truncated-code-geometry")}=e,{indices:i,attributes:r}=function KIe(t){const{bottomRadius:e=0,topRadius:n=0,height:i=1,nradial:r=10,nvertical:s=10,verticalAxis:o="y",topCap:a=!1,bottomCap:c=!1}=t,l=(a?2:0)+(c?2:0),u=(r+1)*(s+1+l),d=Math.atan2(e-n,i),h=Math.sin,f=Math.cos,p=Math.PI,g=f(d),m=h(d),y=a?-2:0,v=s+(c?2:0),_=r+1,w=new Uint16Array(r*(s+l)*6),C=YIe[o],S=new Float32Array(3*u),M=new Float32Array(3*u),x=new Float32Array(2*u);let N=0,U=0;for(let k=y;k<=v;k++){let F,z=k/s,R=i*z;k<0?(R=0,z=1,F=e):k>s?(R=i,z=1,F=n):F=e+k/s*(n-e),(-2===k||k===s+2)&&(F=0,z=0),R-=i/2;for(let W=0;W<_;W++){const G=h(W*p*2/r),ye=f(W*p*2/r);S[N+C[0]]=G*F,S[N+C[1]]=R,S[N+C[2]]=ye*F,M[N+C[0]]=k<0||k>s?0:G*g,M[N+C[1]]=k<0?-1:k>s?1:m,M[N+C[2]]=k<0||k>s?0:ye*g,x[U+0]=W/r,x[U+1]=z,U+=2,N+=3}}for(let k=0;k<s+l;k++)for(let z=0;z<r;z++){const R=6*(k*r+z);w[R+0]=_*(k+0)+0+z,w[R+1]=_*(k+0)+1+z,w[R+2]=_*(k+1)+1+z,w[R+3]=_*(k+0)+0+z,w[R+4]=_*(k+1)+1+z,w[R+5]=_*(k+1)+0+z}return{indices:w,attributes:{POSITION:{size:3,value:S},NORMAL:{size:3,value:M},TEXCOORD_0:{size:2,value:x}}}}(e);super({...e,id:n,indices:i,attributes:{...r,...e.attributes}})}}class JIe extends G8{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:n=$i("cone-geometry"),radius:i=1,cap:r=!0}=e;super({...e,id:n,topRadius:0,topCap:!!r,bottomCap:!!r,bottomRadius:i})}}class ZIe extends G8{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:n=$i("cylinder-geometry"),radius:i=1}=e;super({...e,id:n,bottomRadius:i,topRadius:i})}}const QIe=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),eMe=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),tMe=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),nMe=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),iMe={POSITION:{size:3,value:new Float32Array(eMe)},NORMAL:{size:3,value:new Float32Array(tMe)},TEXCOORD_0:{size:2,value:new Float32Array(nMe)}};class rMe extends qa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:n=$i("cube-geometry")}=e;super({...e,id:n,indices:{size:1,value:new Uint16Array(QIe)},attributes:{...iMe,...e.attributes}})}}function lb(t,e,n){e||(e=new Le(Le.IDENTITY));const i=new Le(Le.IDENTITY);if(!t)return!0;if(t.matrix)i.copy(t.matrix);else{if(i.identity(),t.translation&&i.translate(t.translation),t.rotation){const s=new Le(Le.IDENTITY).fromQuaternion(t.rotation);i.multiplyRight(s)}t.scale&&i.scale(t.scale)}const r=new Le(e).multiplyRight(i);if(!1===n(t,r,e))return!1;for(const s of t.nodes||t.children||[])if(!1===lb(s,r,n))return!1;return!0}function W8(){zz([b8,Sd])}function $8(t,e){const n=e.nodes?.find(i=>i.name===t);if(n){let i=!1;for(const r of e.scenes)i||lb(r,new Le(Le.IDENTITY),(s,o)=>s!==n||(s.matrix=o,s.translation=void 0,s.rotation=void 0,s.scale=void 0,i=!0,!1));return e.scene={id:t,name:t,nodes:[n]},e.scenes=[e.scene],{scene:e.scene,scenes:e.scenes}}return e}function q8(t,e){return TM.apply(this,arguments)}function TM(){return TM=ee(function*(t,e){const n=t.scenegraph;let i;i=e?e[n]||(e[n]=fetch(n).then(s=>s.blob())):fetch(n);const r=yield Ov(i,Sd,{DracoLoader:iM,gltf:{decompressMeshes:!0,postProcess:!0}});return r.nodes||console.log("WARNING: Empty Scene",n,r),$8(t.scenegraphNode,r)}),TM.apply(this,arguments)}function sMe(t,e){return SM.apply(this,arguments)}function SM(){return SM=ee(function*(t,e){return $8(t,yield e)}),SM.apply(this,arguments)}class hs{constructor(e){void 0===e&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const n=this.elements;n[0]=e.x,n[4]=e.y,n[8]=e.z}getTrace(e){void 0===e&&(e=new b);const n=this.elements;return e.x=n[0],e.y=n[4],e.z=n[8],e}vmult(e,n){void 0===n&&(n=new b);const i=this.elements,r=e.x,s=e.y,o=e.z;return n.x=i[0]*r+i[1]*s+i[2]*o,n.y=i[3]*r+i[4]*s+i[5]*o,n.z=i[6]*r+i[7]*s+i[8]*o,n}smult(e){for(let n=0;n<this.elements.length;n++)this.elements[n]*=e}mmult(e,n){void 0===n&&(n=new hs);const i=this.elements,r=e.elements,s=n.elements,o=i[0],a=i[1],c=i[2],l=i[3],u=i[4],d=i[5],h=i[6],f=i[7],p=i[8],g=r[0],m=r[1],y=r[2],v=r[3],_=r[4],w=r[5],C=r[6],S=r[7],M=r[8];return s[0]=o*g+a*v+c*C,s[1]=o*m+a*_+c*S,s[2]=o*y+a*w+c*M,s[3]=l*g+u*v+d*C,s[4]=l*m+u*_+d*S,s[5]=l*y+u*w+d*M,s[6]=h*g+f*v+p*C,s[7]=h*m+f*_+p*S,s[8]=h*y+f*w+p*M,n}scale(e,n){void 0===n&&(n=new hs);const i=this.elements,r=n.elements;for(let s=0;3!==s;s++)r[3*s+0]=e.x*i[3*s+0],r[3*s+1]=e.y*i[3*s+1],r[3*s+2]=e.z*i[3*s+2];return n}solve(e,n){void 0===n&&(n=new b);const s=[];let o,a;for(o=0;o<12;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+4*a]=this.elements[o+3*a];s[3]=e.x,s[7]=e.y,s[11]=e.z;let c=3;const l=c;let u,h;do{if(o=l-c,0===s[o+4*o])for(a=o+1;a<l;a++)if(0!==s[o+4*a]){u=4;do{h=4-u,s[h+4*o]+=s[h+4*a]}while(--u);break}if(0!==s[o+4*o])for(a=o+1;a<l;a++){const f=s[o+4*a]/s[o+4*o];u=4;do{h=4-u,s[h+4*a]=h<=o?0:s[h+4*a]-s[h+4*o]*f}while(--u)}}while(--c);if(n.z=s[11]/s[10],n.y=(s[7]-s[6]*n.z)/s[5],n.x=(s[3]-s[2]*n.z-s[1]*n.y)/s[0],isNaN(n.x)||isNaN(n.y)||isNaN(n.z)||n.x===1/0||n.y===1/0||n.z===1/0)throw`Could not solve equation! Got x=[${n.toString()}], b=[${e.toString()}], A=[${this.toString()}]`;return n}e(e,n,i){if(void 0===i)return this.elements[n+3*e];this.elements[n+3*e]=i}copy(e){for(let n=0;n<e.elements.length;n++)this.elements[n]=e.elements[n];return this}toString(){let e="";for(let i=0;i<9;i++)e+=this.elements[i]+",";return e}reverse(e){void 0===e&&(e=new hs);const r=oMe;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)r[s+6*o]=this.elements[s+3*o];r[3]=1,r[9]=0,r[15]=0,r[4]=0,r[10]=1,r[16]=0,r[5]=0,r[11]=0,r[17]=1;let a=3;const c=a;let l,d;do{if(s=c-a,0===r[s+6*s])for(o=s+1;o<c;o++)if(0!==r[s+6*o]){l=6;do{d=6-l,r[d+6*s]+=r[d+6*o]}while(--l);break}if(0!==r[s+6*s])for(o=s+1;o<c;o++){const h=r[s+6*o]/r[s+6*s];l=6;do{d=6-l,r[d+6*o]=d<=s?0:r[d+6*o]-r[d+6*s]*h}while(--l)}}while(--a);s=2;do{o=s-1;do{const h=r[s+6*o]/r[s+6*s];l=6;do{d=6-l,r[d+6*o]=r[d+6*o]-r[d+6*s]*h}while(--l)}while(o--)}while(--s);s=2;do{const h=1/r[s+6*s];l=6;do{d=6-l,r[d+6*s]=r[d+6*s]*h}while(--l)}while(s--);s=2;do{o=2;do{if(d=r[3+o+6*s],isNaN(d)||d===1/0)throw`Could not reverse! A=[${this.toString()}]`;e.e(s,o,d)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const n=e.x,i=e.y,r=e.z,s=e.w,o=n+n,a=i+i,c=r+r,l=n*o,u=n*a,d=n*c,h=i*a,f=i*c,p=r*c,g=s*o,m=s*a,y=s*c,v=this.elements;return v[0]=1-(h+p),v[1]=u-y,v[2]=d+m,v[3]=u+y,v[4]=1-(l+p),v[5]=f-g,v[6]=d-m,v[7]=f+g,v[8]=1-(l+h),this}transpose(e){void 0===e&&(e=new hs);const n=this.elements,i=e.elements;let r;return i[0]=n[0],i[4]=n[4],i[8]=n[8],r=n[1],i[1]=n[3],i[3]=r,r=n[2],i[2]=n[6],i[6]=r,r=n[5],i[5]=n[7],i[7]=r,e}}const oMe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class b{constructor(e,n,i){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=e,this.y=n,this.z=i}cross(e,n){void 0===n&&(n=new b);const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,c=this.z;return n.x=a*s-c*r,n.y=c*i-o*s,n.z=o*r-a*i,n}set(e,n,i){return this.x=e,this.y=n,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,n){if(!n)return new b(this.x+e.x,this.y+e.y,this.z+e.z);n.x=e.x+this.x,n.y=e.y+this.y,n.z=e.z+this.z}vsub(e,n){if(!n)return new b(this.x-e.x,this.y-e.y,this.z-e.z);n.x=this.x-e.x,n.y=this.y-e.y,n.z=this.z-e.z}crossmat(){return new hs([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,n=this.y,i=this.z,r=Math.sqrt(e*e+n*n+i*i);if(r>0){const s=1/r;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return r}unit(e){void 0===e&&(e=new b);const n=this.x,i=this.y,r=this.z;let s=Math.sqrt(n*n+i*i+r*r);return s>0?(s=1/s,e.x=n*s,e.y=i*s,e.z=r*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,n=this.y,i=this.z;return Math.sqrt(e*e+n*n+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-n)*(s-n)+(o-i)*(o-i)+(a-r)*(a-r))}distanceSquared(e){const n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return(s-n)*(s-n)+(o-i)*(o-i)+(a-r)*(a-r)}scale(e,n){void 0===n&&(n=new b);const r=this.y,s=this.z;return n.x=e*this.x,n.y=e*r,n.z=e*s,n}vmul(e,n){return void 0===n&&(n=new b),n.x=e.x*this.x,n.y=e.y*this.y,n.z=e.z*this.z,n}addScaledVector(e,n,i){return void 0===i&&(i=new b),i.x=this.x+e*n.x,i.y=this.y+e*n.y,i.z=this.z+e*n.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e){return void 0===e&&(e=new b),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,n){const i=this.length();if(i>0){const r=aMe,s=1/i;r.set(this.x*s,this.y*s,this.z*s);const o=cMe;Math.abs(r.x)<.9?(o.set(1,0,0),r.cross(o,e)):(o.set(0,1,0),r.cross(o,e)),r.cross(e,n)}else e.set(1,0,0),n.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,n,i){const r=this.x,s=this.y,o=this.z;i.x=r+(e.x-r)*n,i.y=s+(e.y-s)*n,i.z=o+(e.z-o)*n}almostEquals(e,n){return void 0===n&&(n=1e-6),!(Math.abs(this.x-e.x)>n||Math.abs(this.y-e.y)>n||Math.abs(this.z-e.z)>n)}almostZero(e){return void 0===e&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,n){return this.negate(X8),X8.almostEquals(e,n)}clone(){return new b(this.x,this.y,this.z)}}b.ZERO=new b(0,0,0),b.UNIT_X=new b(1,0,0),b.UNIT_Y=new b(0,1,0),b.UNIT_Z=new b(0,0,1);const aMe=new b,cMe=new b,X8=new b;class Ot{constructor(e){void 0===e&&(e={}),this.lowerBound=new b,this.upperBound=new b,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,n,i,r){const s=this.lowerBound,o=this.upperBound,a=i;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let c=1;c<e.length;c++){let l=e[c];a&&(a.vmult(l,Y8),l=Y8),l.x>o.x&&(o.x=l.x),l.x<s.x&&(s.x=l.x),l.y>o.y&&(o.y=l.y),l.y<s.y&&(s.y=l.y),l.z>o.z&&(o.z=l.z),l.z<s.z&&(s.z=l.z)}return n&&(n.vadd(s,s),n.vadd(o,o)),r&&(s.x-=r,s.y-=r,s.z-=r,o.x+=r,o.y+=r,o.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new Ot).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const n=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return(r.x<=i.x&&i.x<=s.x||n.x<=s.x&&s.x<=i.x)&&(r.y<=i.y&&i.y<=s.y||n.y<=s.y&&s.y<=i.y)&&(r.z<=i.z&&i.z<=s.z||n.z<=s.z&&s.z<=i.z)}volume(){const e=this.lowerBound,n=this.upperBound;return(n.x-e.x)*(n.y-e.y)*(n.z-e.z)}contains(e){const n=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return n.x<=r.x&&i.x>=s.x&&n.y<=r.y&&i.y>=s.y&&n.z<=r.z&&i.z>=s.z}getCorners(e,n,i,r,s,o,a,c){const l=this.lowerBound,u=this.upperBound;e.copy(l),n.set(u.x,l.y,l.z),i.set(u.x,u.y,l.z),r.set(l.x,u.y,u.z),s.set(u.x,l.y,u.z),o.set(l.x,u.y,l.z),a.set(l.x,l.y,u.z),c.copy(u)}toLocalFrame(e,n){const i=K8;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let h=0;8!==h;h++){const f=i[h];e.pointToLocal(f,f)}return n.setFromPoints(i)}toWorldFrame(e,n){const i=K8;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let h=0;8!==h;h++){const f=i[h];e.pointToWorld(f,f)}return n.setFromPoints(i)}overlapsRay(e){const{direction:n,from:i}=e,r=1/n.x,s=1/n.y,o=1/n.z,a=(this.lowerBound.x-i.x)*r,c=(this.upperBound.x-i.x)*r,l=(this.lowerBound.y-i.y)*s,u=(this.upperBound.y-i.y)*s,d=(this.lowerBound.z-i.z)*o,h=(this.upperBound.z-i.z)*o,f=Math.max(Math.max(Math.min(a,c),Math.min(l,u)),Math.min(d,h)),p=Math.min(Math.min(Math.max(a,c),Math.max(l,u)),Math.max(d,h));return!(p<0||f>p)}}const Y8=new b,K8=[new b,new b,new b,new b,new b,new b,new b,new b];class Z8{addEventListener(e,n){void 0===this._listeners&&(this._listeners={});const i=this._listeners;return void 0===i[e]&&(i[e]=[]),i[e].includes(n)||i[e].push(n),this}hasEventListener(e,n){if(void 0===this._listeners)return!1;const i=this._listeners;return!(void 0===i[e]||!i[e].includes(n))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,n){if(void 0===this._listeners)return this;const i=this._listeners;if(void 0===i[e])return this;const r=i[e].indexOf(n);return-1!==r&&i[e].splice(r,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const i=this._listeners[e.type];if(void 0!==i){e.target=this;for(let r=0,s=i.length;r<s;r++)i[r].call(this,e)}return this}}class Yt{constructor(e,n,i,r){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=1),this.x=e,this.y=n,this.z=i,this.w=r}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,n){const i=Math.sin(.5*n);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(.5*n),this}toAxisAngle(e){void 0===e&&(e=new b),this.normalize();const n=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,n]}setFromVectors(e,n){if(e.isAntiparallelTo(n)){const i=lMe;e.tangents(i,uMe),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(n);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(e.length()**2*n.length()**2)+e.dot(n),this.normalize()}return this}mult(e,n){void 0===n&&(n=new Yt);const i=this.x,r=this.y,s=this.z,o=this.w,a=e.x,c=e.y,l=e.z,u=e.w;return n.x=i*u+o*a+r*l-s*c,n.y=r*u+o*c+s*a-i*l,n.z=s*u+o*l+i*c-r*a,n.w=o*u-i*a-r*c-s*l,n}inverse(e){void 0===e&&(e=new Yt);const n=this.x,i=this.y,r=this.z,s=this.w;this.conjugate(e);const o=1/(n*n+i*i+r*r+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e){return void 0===e&&(e=new Yt),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,n){void 0===n&&(n=new b);const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,c=this.z,l=this.w,u=l*i+a*s-c*r,d=l*r+c*i-o*s,h=l*s+o*r-a*i,f=-o*i-a*r-c*s;return n.x=u*l+f*-o+d*-c-h*-a,n.y=d*l+f*-a+h*-o-u*-c,n.z=h*l+f*-c+u*-a-d*-o,n}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,n){let i,r,s;void 0===n&&(n="YZX");const o=this.x,a=this.y,c=this.z,l=this.w;if("YZX"!==n)throw new Error(`Euler order ${n} not supported yet.`);{const u=o*a+c*l;if(u>.499&&(i=2*Math.atan2(o,l),r=Math.PI/2,s=0),u<-.499&&(i=-2*Math.atan2(o,l),r=-Math.PI/2,s=0),void 0===i){const d=o*o,f=c*c;i=Math.atan2(2*a*l-2*o*c,1-a*a*2-2*f),r=Math.asin(2*u),s=Math.atan2(2*o*l-2*a*c,1-2*d-2*f)}}e.y=i,e.z=r,e.x=s}setFromEuler(e,n,i,r){void 0===r&&(r="XYZ");const s=Math.cos(e/2),o=Math.cos(n/2),a=Math.cos(i/2),c=Math.sin(e/2),l=Math.sin(n/2),u=Math.sin(i/2);return"XYZ"===r?(this.x=c*o*a+s*l*u,this.y=s*l*a-c*o*u,this.z=s*o*u+c*l*a,this.w=s*o*a-c*l*u):"YXZ"===r?(this.x=c*o*a+s*l*u,this.y=s*l*a-c*o*u,this.z=s*o*u-c*l*a,this.w=s*o*a+c*l*u):"ZXY"===r?(this.x=c*o*a-s*l*u,this.y=s*l*a+c*o*u,this.z=s*o*u+c*l*a,this.w=s*o*a-c*l*u):"ZYX"===r?(this.x=c*o*a-s*l*u,this.y=s*l*a+c*o*u,this.z=s*o*u-c*l*a,this.w=s*o*a+c*l*u):"YZX"===r?(this.x=c*o*a+s*l*u,this.y=s*l*a+c*o*u,this.z=s*o*u-c*l*a,this.w=s*o*a-c*l*u):"XZY"===r&&(this.x=c*o*a-s*l*u,this.y=s*l*a-c*o*u,this.z=s*o*u+c*l*a,this.w=s*o*a+c*l*u),this}clone(){return new Yt(this.x,this.y,this.z,this.w)}slerp(e,n,i){void 0===i&&(i=new Yt);const r=this.x,s=this.y,o=this.z,a=this.w;let h,f,p,g,m,c=e.x,l=e.y,u=e.z,d=e.w;return f=r*c+s*l+o*u+a*d,f<0&&(f=-f,c=-c,l=-l,u=-u,d=-d),1-f>1e-6?(h=Math.acos(f),p=Math.sin(h),g=Math.sin((1-n)*h)/p,m=Math.sin(n*h)/p):(g=1-n,m=n),i.x=g*r+m*c,i.y=g*s+m*l,i.z=g*o+m*u,i.w=g*a+m*d,i}integrate(e,n,i,r){void 0===r&&(r=new Yt);const s=e.x*i.x,o=e.y*i.y,a=e.z*i.z,c=this.x,l=this.y,u=this.z,d=this.w,h=.5*n;return r.x+=h*(s*d+o*u-a*l),r.y+=h*(o*d+a*c-s*u),r.z+=h*(a*d+s*l-o*c),r.w+=h*(-s*c-o*l-a*u),r}}const lMe=new b,uMe=new b,dMe={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let re=(()=>{class t{constructor(n){void 0===n&&(n={}),this.id=t.idCounter++,this.type=n.type||0,this.boundingSphereRadius=0,this.collisionResponse=!n.collisionResponse||n.collisionResponse,this.collisionFilterGroup=void 0!==n.collisionFilterGroup?n.collisionFilterGroup:1,this.collisionFilterMask=void 0!==n.collisionFilterMask?n.collisionFilterMask:-1,this.material=n.material?n.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(n,i){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(n,i,r,s){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}return t.idCounter=0,t.types=dMe,t})();class it{constructor(e){void 0===e&&(e={}),this.position=new b,this.quaternion=new Yt,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,n){return it.pointToLocalFrame(this.position,this.quaternion,e,n)}pointToWorld(e,n){return it.pointToWorldFrame(this.position,this.quaternion,e,n)}vectorToWorldFrame(e,n){return void 0===n&&(n=new b),this.quaternion.vmult(e,n),n}static pointToLocalFrame(e,n,i,r){return void 0===r&&(r=new b),i.vsub(e,r),n.conjugate(Q8),Q8.vmult(r,r),r}static pointToWorldFrame(e,n,i,r){return void 0===r&&(r=new b),n.vmult(i,r),r.vadd(e,r),r}static vectorToWorldFrame(e,n,i){return void 0===i&&(i=new b),e.vmult(n,i),i}static vectorToLocalFrame(e,n,i,r){return void 0===r&&(r=new b),n.w*=-1,n.vmult(i,r),n.w*=-1,r}}const Q8=new Yt;class Ka extends re{constructor(e){void 0===e&&(e={});const{vertices:n=[],faces:i=[],normals:r=[],axes:s,boundingSphereRadius:o}=e;super({type:re.types.CONVEXPOLYHEDRON}),this.vertices=n,this.faces=i,this.faceNormals=r,0===this.faceNormals.length&&this.computeNormals(),o?this.boundingSphereRadius=o:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=s?s.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,n=this.vertices,i=this.uniqueEdges;i.length=0;const r=new b;for(let s=0;s!==e.length;s++){const o=e[s],a=o.length;for(let c=0;c!==a;c++){n[o[c]].vsub(n[o[(c+1)%a]],r),r.normalize();let u=!1;for(let d=0;d!==i.length;d++)if(i[d].almostEquals(r)||i[d].almostEquals(r)){u=!0;break}u||i.push(r.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let r=0;r<this.faces[e].length;r++)if(!this.vertices[this.faces[e][r]])throw new Error(`Vertex ${this.faces[e][r]} not found!`);const n=this.faceNormals[e]||new b;if(this.getFaceNormal(e,n),n.negate(n),this.faceNormals[e]=n,n.dot(this.vertices[this.faces[e][0]])<0){console.error(`.faceNormals[${e}] = Vec3(${n.toString()}) looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.`);for(let r=0;r<this.faces[e].length;r++)console.warn(`.vertices[${this.faces[e][r]}] = Vec3(${this.vertices[this.faces[e][r]].toString()})`)}}}getFaceNormal(e,n){const i=this.faces[e];Ka.computeNormal(this.vertices[i[0]],this.vertices[i[1]],this.vertices[i[2]],n)}static computeNormal(e,n,i,r){const s=new b,o=new b;n.vsub(e,o),i.vsub(n,s),s.cross(o,r),r.isZero()||r.normalize()}clipAgainstHull(e,n,i,r,s,o,a,c,l){const u=new b;let d=-1,h=-Number.MAX_VALUE;for(let p=0;p<i.faces.length;p++){u.copy(i.faceNormals[p]),s.vmult(u,u);const g=u.dot(o);g>h&&(h=g,d=p)}const f=[];for(let p=0;p<i.faces[d].length;p++){const g=i.vertices[i.faces[d][p]],m=new b;m.copy(g),s.vmult(m,m),r.vadd(m,m),f.push(m)}d>=0&&this.clipFaceAgainstHull(o,e,n,f,a,c,l)}findSeparatingAxis(e,n,i,r,s,o,a,c){const l=new b,u=new b,d=new b,h=new b,f=new b,p=new b;let g=Number.MAX_VALUE;const m=this;if(m.uniqueAxes)for(let y=0;y!==m.uniqueAxes.length;y++){i.vmult(m.uniqueAxes[y],l);const v=m.testSepAxis(l,e,n,i,r,s);if(!1===v)return!1;v<g&&(g=v,o.copy(l))}else{const y=a?a.length:m.faces.length;for(let v=0;v<y;v++){l.copy(m.faceNormals[a?a[v]:v]),i.vmult(l,l);const w=m.testSepAxis(l,e,n,i,r,s);if(!1===w)return!1;w<g&&(g=w,o.copy(l))}}if(e.uniqueAxes)for(let y=0;y!==e.uniqueAxes.length;y++){s.vmult(e.uniqueAxes[y],u);const v=m.testSepAxis(u,e,n,i,r,s);if(!1===v)return!1;v<g&&(g=v,o.copy(u))}else{const y=c?c.length:e.faces.length;for(let v=0;v<y;v++){u.copy(e.faceNormals[c?c[v]:v]),s.vmult(u,u);const w=m.testSepAxis(u,e,n,i,r,s);if(!1===w)return!1;w<g&&(g=w,o.copy(u))}}for(let y=0;y!==m.uniqueEdges.length;y++){i.vmult(m.uniqueEdges[y],h);for(let v=0;v!==e.uniqueEdges.length;v++)if(s.vmult(e.uniqueEdges[v],f),h.cross(f,p),!p.almostZero()){p.normalize();const _=m.testSepAxis(p,e,n,i,r,s);if(!1===_)return!1;_<g&&(g=_,o.copy(p))}}return r.vsub(n,d),d.dot(o)>0&&o.negate(o),!0}testSepAxis(e,n,i,r,s,o){Ka.project(this,e,i,r,xM),Ka.project(n,e,s,o,IM);const c=xM[0],l=xM[1],u=IM[0],d=IM[1];if(c<d||u<l)return!1;const h=c-d,f=u-l;return h<f?h:f}calculateLocalInertia(e,n){const i=new b,r=new b;this.computeLocalAABB(r,i);const s=i.x-r.x,o=i.y-r.y,a=i.z-r.z;n.x=1/12*e*(2*o*2*o+2*a*2*a),n.y=1/12*e*(2*s*2*s+2*a*2*a),n.z=1/12*e*(2*o*2*o+2*s*2*s)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,n,i,r,s,o,a){const c=new b,l=new b,u=new b,d=new b,h=new b,f=new b,p=new b,g=new b,m=this,v=r,_=[];let w=-1,C=Number.MAX_VALUE;for(let U=0;U<m.faces.length;U++){c.copy(m.faceNormals[U]),i.vmult(c,c);const k=c.dot(e);k<C&&(C=k,w=U)}if(w<0)return;const S=m.faces[w];S.connectedFaces=[];for(let U=0;U<m.faces.length;U++)for(let k=0;k<m.faces[U].length;k++)-1!==S.indexOf(m.faces[U][k])&&U!==w&&-1===S.connectedFaces.indexOf(U)&&S.connectedFaces.push(U);const M=S.length;for(let U=0;U<M;U++){const k=m.vertices[S[U]];k.vsub(m.vertices[S[(U+1)%M]],l),u.copy(l),i.vmult(u,u),n.vadd(u,u),d.copy(this.faceNormals[w]),i.vmult(d,d),n.vadd(d,d),u.cross(d,h),h.negate(h),f.copy(k),i.vmult(f,f),n.vadd(f,f);const R=S.connectedFaces[U];p.copy(this.faceNormals[R]);const F=this.getPlaneConstantOfFace(R);g.copy(p),i.vmult(g,g);const W=F-g.dot(n);for(this.clipFaceAgainstPlane(v,_,g,W);v.length;)v.shift();for(;_.length;)v.push(_.shift())}p.copy(this.faceNormals[w]);const x=this.getPlaneConstantOfFace(w);g.copy(p),i.vmult(g,g);const N=x-g.dot(n);for(let U=0;U<v.length;U++){let k=g.dot(v[U])+N;k<=s&&(console.log(`clamped: depth=${k} to minDist=${s}`),k=s),k<=o&&k<=1e-6&&a.push({point:v[U],normal:g,depth:k})}}clipFaceAgainstPlane(e,n,i,r){let s,o;const a=e.length;if(a<2)return n;let c=e[e.length-1],l=e[0];s=i.dot(c)+r;for(let u=0;u<a;u++){if(l=e[u],o=i.dot(l)+r,s<0)if(o<0){const d=new b;d.copy(l),n.push(d)}else{const d=new b;c.lerp(l,s/(s-o),d),n.push(d)}else if(o<0){const d=new b;c.lerp(l,s/(s-o),d),n.push(d),n.push(l)}c=l,s=o}return n}computeWorldVertices(e,n){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new b);const i=this.vertices,r=this.worldVertices;for(let s=0;s!==this.vertices.length;s++)n.vmult(i[s],r[s]),e.vadd(r[s],r[s]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,n){const i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),n.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let r=0;r<this.vertices.length;r++){const s=i[r];s.x<e.x?e.x=s.x:s.x>n.x&&(n.x=s.x),s.y<e.y?e.y=s.y:s.y>n.y&&(n.y=s.y),s.z<e.z?e.z=s.z:s.z>n.z&&(n.z=s.z)}}computeWorldFaceNormals(e){const n=this.faceNormals.length;for(;this.worldFaceNormals.length<n;)this.worldFaceNormals.push(new b);const i=this.faceNormals,r=this.worldFaceNormals;for(let s=0;s!==n;s++)e.vmult(i[s],r[s]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const n=this.vertices;for(let i=0;i!==n.length;i++){const r=n[i].lengthSquared();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,n,i,r){const s=this.vertices;let o,a,c,l,u,d,h=new b;for(let f=0;f<s.length;f++)h.copy(s[f]),n.vmult(h,h),e.vadd(h,h),(void 0===o||h.x<o)&&(o=h.x),(void 0===l||h.x>l)&&(l=h.x),(void 0===a||h.y<a)&&(a=h.y),(void 0===u||h.y>u)&&(u=h.y),(void 0===c||h.z<c)&&(c=h.z),(void 0===d||h.z>d)&&(d=h.z);i.set(o,a,c),r.set(l,u,d)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e){void 0===e&&(e=new b);const n=this.vertices;for(let i=0;i<n.length;i++)e.vadd(n[i],e);return e.scale(1/n.length,e),e}transformAllPoints(e,n){const i=this.vertices.length,r=this.vertices;if(n){for(let s=0;s<i;s++){const o=r[s];n.vmult(o,o)}for(let s=0;s<this.faceNormals.length;s++){const o=this.faceNormals[s];n.vmult(o,o)}}if(e)for(let s=0;s<i;s++){const o=r[s];o.vadd(e,o)}}pointIsInside(e){const n=this.vertices,i=this.faces,r=this.faceNormals,o=new b;this.getAveragePointLocal(o);for(let a=0;a<this.faces.length;a++){let c=r[a];const l=n[i[a][0]],u=new b;e.vsub(l,u);const d=c.dot(u),h=new b;o.vsub(l,h);const f=c.dot(h);if(d<0&&f>0||d>0&&f<0)return!1}return-1}static project(e,n,i,r,s){const o=e.vertices.length,a=fMe;let c=0,l=0;const u=pMe,d=e.vertices;u.setZero(),it.vectorToLocalFrame(i,r,n,a),it.pointToLocalFrame(i,r,u,u);const h=u.dot(a);l=c=d[0].dot(a);for(let f=1;f<o;f++){const p=d[f].dot(a);p>c&&(c=p),p<l&&(l=p)}if(l-=h,c-=h,l>c){const f=l;l=c,c=f}s[0]=c,s[1]=l}}const xM=[],IM=[],fMe=(new b,new b),pMe=new b;class ub extends re{constructor(e){super({type:re.types.BOX}),this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,n=this.halfExtents.y,i=this.halfExtents.z,r=b,s=[new r(-e,-n,-i),new r(e,-n,-i),new r(e,n,-i),new r(-e,n,-i),new r(-e,-n,i),new r(e,-n,i),new r(e,n,i),new r(-e,n,i)],a=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],c=new Ka({vertices:s,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:a});this.convexPolyhedronRepresentation=c,c.material=this.material}calculateLocalInertia(e,n){return void 0===n&&(n=new b),ub.calculateInertia(this.halfExtents,e,n),n}static calculateInertia(e,n,i){const r=e;i.x=1/12*n*(2*r.y*2*r.y+2*r.z*2*r.z),i.y=1/12*n*(2*r.x*2*r.x+2*r.z*2*r.z),i.z=1/12*n*(2*r.y*2*r.y+2*r.x*2*r.x)}getSideNormals(e,n){const i=e,r=this.halfExtents;if(i[0].set(r.x,0,0),i[1].set(0,r.y,0),i[2].set(0,0,r.z),i[3].set(-r.x,0,0),i[4].set(0,-r.y,0),i[5].set(0,0,-r.z),void 0!==n)for(let s=0;s!==i.length;s++)n.vmult(i[s],i[s]);return i}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,n,i){const r=this.halfExtents,s=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]];for(let o=0;o<s.length;o++)Ja.set(s[o][0],s[o][1],s[o][2]),n.vmult(Ja,Ja),e.vadd(Ja,Ja),i(Ja.x,Ja.y,Ja.z)}calculateWorldAABB(e,n,i,r){const s=this.halfExtents;ro[0].set(s.x,s.y,s.z),ro[1].set(-s.x,s.y,s.z),ro[2].set(-s.x,-s.y,s.z),ro[3].set(-s.x,-s.y,-s.z),ro[4].set(s.x,-s.y,-s.z),ro[5].set(s.x,s.y,-s.z),ro[6].set(-s.x,s.y,-s.z),ro[7].set(s.x,-s.y,s.z);const o=ro[0];n.vmult(o,o),e.vadd(o,o),r.copy(o),i.copy(o);for(let a=1;a<8;a++){const c=ro[a];n.vmult(c,c),e.vadd(c,c);const l=c.x,u=c.y,d=c.z;l>r.x&&(r.x=l),u>r.y&&(r.y=u),d>r.z&&(r.z=d),l<i.x&&(i.x=l),u<i.y&&(i.y=u),d<i.z&&(i.z=d)}}}const Ja=new b,ro=[new b,new b,new b,new b,new b,new b,new b,new b];class ae extends Z8{constructor(e){void 0===e&&(e={}),super(),this.id=ae.idCounter++,this.index=-1,this.world=null,this.vlambda=new b,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new b,this.previousPosition=new b,this.interpolatedPosition=new b,this.initPosition=new b,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new b,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new b,this.force=new b;const n="number"==typeof e.mass?e.mass:0;this.mass=n,this.invMass=n>0?1/n:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=n<=0?ae.STATIC:ae.DYNAMIC,typeof e.type==typeof ae.STATIC&&(this.type=e.type),this.allowSleep=!(typeof e.allowSleep<"u")||e.allowSleep,this.sleepState=ae.AWAKE,this.sleepSpeedLimit=typeof e.sleepSpeedLimit<"u"?e.sleepSpeedLimit:.1,this.sleepTimeLimit=typeof e.sleepTimeLimit<"u"?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new b,this.quaternion=new Yt,this.initQuaternion=new Yt,this.previousQuaternion=new Yt,this.interpolatedQuaternion=new Yt,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new b,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new b,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new b,this.invInertia=new b,this.invInertiaWorld=new hs,this.invMassSolve=0,this.invInertiaSolve=new b,this.invInertiaWorldSolve=new hs,this.fixedRotation=typeof e.fixedRotation<"u"&&e.fixedRotation,this.angularDamping=typeof e.angularDamping<"u"?e.angularDamping:.01,this.linearFactor=new b(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new b(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new Ot,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new b,this.isTrigger=!!e.isTrigger,e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=ae.AWAKE,this.wakeUpAfterNarrowphase=!1,e===ae.SLEEPING&&this.dispatchEvent(ae.wakeupEvent)}sleep(){this.sleepState=ae.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const n=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),r=this.sleepSpeedLimit**2;n===ae.AWAKE&&i<r?(this.sleepState=ae.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(ae.sleepyEvent)):n===ae.SLEEPY&&i>r?this.wakeUp():n===ae.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(ae.sleepEvent))}}updateSolveMassProperties(){this.sleepState===ae.SLEEPING||this.type===ae.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,n){return void 0===n&&(n=new b),e.vsub(this.position,n),this.quaternion.conjugate().vmult(n,n),n}vectorToLocalFrame(e,n){return void 0===n&&(n=new b),this.quaternion.conjugate().vmult(e,n),n}pointToWorldFrame(e,n){return void 0===n&&(n=new b),this.quaternion.vmult(e,n),n.vadd(this.position,n),n}vectorToWorldFrame(e,n){return void 0===n&&(n=new b),this.quaternion.vmult(e,n),n}addShape(e,n,i){const r=new b,s=new Yt;return n&&r.copy(n),i&&s.copy(i),this.shapes.push(e),this.shapeOffsets.push(r),this.shapeOrientations.push(s),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const n=this.shapes.indexOf(e);return-1===n?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(n,1),this.shapeOffsets.splice(n,1),this.shapeOrientations.splice(n,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,n=this.shapeOffsets,i=e.length;let r=0;for(let s=0;s!==i;s++){const o=e[s];o.updateBoundingSphereRadius();const a=n[s].length(),c=o.boundingSphereRadius;a+c>r&&(r=a+c)}this.boundingRadius=r}updateAABB(){const e=this.shapes,n=this.shapeOffsets,i=this.shapeOrientations,r=e.length,s=gMe,o=mMe,a=this.quaternion,c=this.aabb,l=_Me;for(let u=0;u!==r;u++){const d=e[u];a.vmult(n[u],s),s.vadd(this.position,s),a.mult(i[u],o),d.calculateWorldAABB(s,o,l.lowerBound,l.upperBound),0===u?c.copy(l):c.extend(l)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const n=this.invInertia;if(n.x!==n.y||n.y!==n.z||e){const i=yMe,r=vMe;i.setRotationFromQuaternion(this.quaternion),i.transpose(r),i.scale(n,i),i.mmult(r,this.invInertiaWorld)}}applyForce(e,n){if(void 0===n&&(n=new b),this.type!==ae.DYNAMIC)return;this.sleepState===ae.SLEEPING&&this.wakeUp();const i=EMe;n.cross(e,i),this.force.vadd(e,this.force),this.torque.vadd(i,this.torque)}applyLocalForce(e,n){if(void 0===n&&(n=new b),this.type!==ae.DYNAMIC)return;const i=wMe,r=AMe;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(n,r),this.applyForce(i,r)}applyTorque(e){this.type===ae.DYNAMIC&&(this.sleepState===ae.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,n){if(void 0===n&&(n=new b),this.type!==ae.DYNAMIC)return;this.sleepState===ae.SLEEPING&&this.wakeUp();const i=n,r=CMe;r.copy(e),r.scale(this.invMass,r),this.velocity.vadd(r,this.velocity);const s=TMe;i.cross(e,s),this.invInertiaWorld.vmult(s,s),this.angularVelocity.vadd(s,this.angularVelocity)}applyLocalImpulse(e,n){if(void 0===n&&(n=new b),this.type!==ae.DYNAMIC)return;const i=SMe,r=xMe;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(n,r),this.applyImpulse(i,r)}updateMassProperties(){const e=IMe;this.invMass=this.mass>0?1/this.mass:0;const n=this.inertia,i=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),ub.calculateInertia(e,this.mass,n),this.invInertia.set(n.x>0&&!i?1/n.x:0,n.y>0&&!i?1/n.y:0,n.z>0&&!i?1/n.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,n){const i=new b;return e.vsub(this.position,i),this.angularVelocity.cross(i,n),this.velocity.vadd(n,n),n}integrate(e,n,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==ae.DYNAMIC&&this.type!==ae.KINEMATIC||this.sleepState===ae.SLEEPING)return;const r=this.velocity,s=this.angularVelocity,o=this.position,a=this.force,c=this.torque,l=this.quaternion,d=this.invInertiaWorld,h=this.linearFactor,f=this.invMass*e;r.x+=a.x*f*h.x,r.y+=a.y*f*h.y,r.z+=a.z*f*h.z;const p=d.elements,g=this.angularFactor,m=c.x*g.x,y=c.y*g.y,v=c.z*g.z;s.x+=e*(p[0]*m+p[1]*y+p[2]*v),s.y+=e*(p[3]*m+p[4]*y+p[5]*v),s.z+=e*(p[6]*m+p[7]*y+p[8]*v),o.x+=r.x*e,o.y+=r.y*e,o.z+=r.z*e,l.integrate(this.angularVelocity,e,this.angularFactor,l),n&&(i?l.normalizeFast():l.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}ae.idCounter=0,ae.COLLIDE_EVENT_NAME="collide",ae.DYNAMIC=1,ae.STATIC=2,ae.KINEMATIC=4,ae.AWAKE=0,ae.SLEEPY=1,ae.SLEEPING=2,ae.wakeupEvent={type:"wakeup"},ae.sleepyEvent={type:"sleepy"},ae.sleepEvent={type:"sleep"};const gMe=new b,mMe=new Yt,_Me=new Ot,yMe=new hs,vMe=new hs,EMe=(new hs,new b),wMe=new b,AMe=new b,CMe=new b,TMe=new b,SMe=new b,xMe=new b,IMe=new b;new b,new b,new Yt,new b,new b,new b,new b;class zp{constructor(){this.rayFromWorld=new b,this.rayToWorld=new b,this.hitNormalWorld=new b,this.hitPointWorld=new b,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,n,i,r,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(n),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(r),this.shape=s,this.body=o,this.distance=a}}let e6,t6,n6,r6,s6,o6,a6;e6=re.types.SPHERE,t6=re.types.PLANE,n6=re.types.BOX,r6=re.types.CYLINDER,s6=re.types.CONVEXPOLYHEDRON,o6=re.types.HEIGHTFIELD,a6=re.types.TRIMESH;class _n{get[e6](){return this._intersectSphere}get[t6](){return this._intersectPlane}get[n6](){return this._intersectBox}get[r6](){return this._intersectConvex}get[s6](){return this._intersectConvex}get[o6](){return this._intersectHeightfield}get[a6](){return this._intersectTrimesh}constructor(e,n){void 0===e&&(e=new b),void 0===n&&(n=new b),this.from=e.clone(),this.to=n.clone(),this.direction=new b,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=_n.ANY,this.result=new zp,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,n){return this.mode=n.mode||_n.ANY,this.result=n.result||new zp,this.skipBackfaces=!!n.skipBackfaces,this.collisionFilterMask=typeof n.collisionFilterMask<"u"?n.collisionFilterMask:-1,this.collisionFilterGroup=typeof n.collisionFilterGroup<"u"?n.collisionFilterGroup:-1,this.checkCollisionResponse=!(typeof n.checkCollisionResponse<"u")||n.checkCollisionResponse,n.from&&this.from.copy(n.from),n.to&&this.to.copy(n.to),this.callback=n.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(c6),PM.length=0,e.broadphase.aabbQuery(e,c6,PM),this.intersectBodies(PM),this.hasHit}intersectBody(e,n){n&&(this.result=n,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||!(this.collisionFilterGroup&e.collisionFilterMask)||!(e.collisionFilterGroup&this.collisionFilterMask))return;const r=LMe,s=FMe;for(let o=0,a=e.shapes.length;o<a;o++){const c=e.shapes[o];if((!i||c.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],r),r.vadd(e.position,r),this.intersectShape(c,s,r,e),this.result.shouldStop))break}}intersectBodies(e,n){n&&(this.result=n,this.updateDirection());for(let i=0,r=e.length;!this.result.shouldStop&&i<r;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,n,i,r){if(function ZMe(t,e,n){n.vsub(t,fl);const i=fl.dot(e);return e.scale(i,hb),hb.vadd(t,hb),n.distanceTo(hb)}(this.from,this.direction,i)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,n,i,r,e)}_intersectBox(e,n,i,r,s){return this._intersectConvex(e.convexPolyhedronRepresentation,n,i,r,s)}_intersectPlane(e,n,i,r,s){const o=this.from,a=this.to,c=this.direction,l=new b(0,0,1);n.vmult(l,l);const u=new b;o.vsub(i,u);const d=u.dot(l);if(a.vsub(i,u),d*u.dot(l)>0||o.distanceTo(a)<d)return;const f=l.dot(c);if(Math.abs(f)<this.precision)return;const p=new b,g=new b,m=new b;o.vsub(i,p);const y=-l.dot(p)/f;c.scale(y,g),o.vadd(g,m),this.reportIntersection(l,m,s,r,-1)}getAABB(e){const{lowerBound:n,upperBound:i}=e,r=this.to,s=this.from;n.x=Math.min(r.x,s.x),n.y=Math.min(r.y,s.y),n.z=Math.min(r.z,s.z),i.x=Math.max(r.x,s.x),i.y=Math.max(r.y,s.y),i.z=Math.max(r.z,s.z)}_intersectHeightfield(e,n,i,r,s){const o=BMe;o.from.copy(this.from),o.to.copy(this.to),it.pointToLocalFrame(i,n,o.from,o.from),it.pointToLocalFrame(i,n,o.to,o.to),o.updateDirection();const a=kMe;let c,l,u,d;c=l=0,u=d=e.data.length-1;const h=new Ot;o.getAABB(h),e.getIndexOfPosition(h.lowerBound.x,h.lowerBound.y,a,!0),c=Math.max(c,a[0]),l=Math.max(l,a[1]),e.getIndexOfPosition(h.upperBound.x,h.upperBound.y,a,!0),u=Math.min(u,a[0]+1),d=Math.min(d,a[1]+1);for(let f=c;f<u;f++)for(let p=l;p<d;p++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(f,p,h),h.overlapsRay(o)){if(e.getConvexTrianglePillar(f,p,!1),it.pointToWorldFrame(i,n,e.pillarOffset,db),this._intersectConvex(e.pillarConvex,n,db,r,s,l6),this.result.shouldStop)return;e.getConvexTrianglePillar(f,p,!0),it.pointToWorldFrame(i,n,e.pillarOffset,db),this._intersectConvex(e.pillarConvex,n,db,r,s,l6)}}}_intersectSphere(e,n,i,r,s){const o=this.from,a=this.to,l=(a.x-o.x)**2+(a.y-o.y)**2+(a.z-o.z)**2,u=2*((a.x-o.x)*(o.x-i.x)+(a.y-o.y)*(o.y-i.y)+(a.z-o.z)*(o.z-i.z)),h=u**2-4*l*((o.x-i.x)**2+(o.y-i.y)**2+(o.z-i.z)**2-e.radius**2),f=UMe,p=VMe;if(!(h<0))if(0===h)o.lerp(a,h,f),f.vsub(i,p),p.normalize(),this.reportIntersection(p,f,s,r,-1);else{const g=(-u-Math.sqrt(h))/(2*l),m=(-u+Math.sqrt(h))/(2*l);if(g>=0&&g<=1&&(o.lerp(a,g,f),f.vsub(i,p),p.normalize(),this.reportIntersection(p,f,s,r,-1)),this.result.shouldStop)return;m>=0&&m<=1&&(o.lerp(a,m,f),f.vsub(i,p),p.normalize(),this.reportIntersection(p,f,s,r,-1))}}_intersectConvex(e,n,i,r,s,o){const a=jMe,c=u6,l=o&&o.faceList||null,u=e.faces,d=e.vertices,h=e.faceNormals,f=this.direction,p=this.from,m=p.distanceTo(this.to),y=l?l.length:u.length,v=this.result;for(let _=0;!v.shouldStop&&_<y;_++){const w=l?l[_]:_,C=u[w],S=h[w],M=n,x=i;c.copy(d[C[0]]),M.vmult(c,c),c.vadd(x,c),c.vsub(p,c),M.vmult(S,a);const N=f.dot(a);if(Math.abs(N)<this.precision)continue;const U=a.dot(c)/N;if(!(U<0)){f.scale(U,Xi),Xi.vadd(p,Xi),fs.copy(d[C[0]]),M.vmult(fs,fs),x.vadd(fs,fs);for(let k=1;!v.shouldStop&&k<C.length-1;k++){so.copy(d[C[k]]),oo.copy(d[C[k+1]]),M.vmult(so,so),M.vmult(oo,oo),x.vadd(so,so),x.vadd(oo,oo);const z=Xi.distanceTo(p);!_n.pointInTriangle(Xi,fs,so,oo)&&!_n.pointInTriangle(Xi,so,fs,oo)||z>m||this.reportIntersection(a,Xi,s,r,w)}}}}_intersectTrimesh(e,n,i,r,s,o){const a=GMe,c=KMe,l=JMe,u=u6,d=WMe,h=$Me,f=qMe,p=YMe,g=XMe,m=e.indices,y=this.from,v=this.to,_=this.direction;l.position.copy(i),l.quaternion.copy(n),it.vectorToLocalFrame(i,n,_,d),it.pointToLocalFrame(i,n,y,h),it.pointToLocalFrame(i,n,v,f),f.x*=e.scale.x,f.y*=e.scale.y,f.z*=e.scale.z,h.x*=e.scale.x,h.y*=e.scale.y,h.z*=e.scale.z,f.vsub(h,d),d.normalize();const w=h.distanceSquared(f);e.tree.rayQuery(this,l,c);for(let C=0,S=c.length;!this.result.shouldStop&&C!==S;C++){const M=c[C];e.getNormal(M,a),e.getVertex(m[3*M],fs),fs.vsub(h,u);const x=d.dot(a),N=a.dot(u)/x;if(N<0)continue;d.scale(N,Xi),Xi.vadd(h,Xi),e.getVertex(m[3*M+1],so),e.getVertex(m[3*M+2],oo);const U=Xi.distanceSquared(h);!_n.pointInTriangle(Xi,so,fs,oo)&&!_n.pointInTriangle(Xi,fs,so,oo)||U>w||(it.vectorToWorldFrame(n,a,g),it.pointToWorldFrame(i,n,Xi,p),this.reportIntersection(g,p,s,r,M))}c.length=0}reportIntersection(e,n,i,r,s){const o=this.from,a=this.to,c=o.distanceTo(n),l=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(l.hitFaceIndex=typeof s<"u"?s:-1,this.mode){case _n.ALL:this.hasHit=!0,l.set(o,a,e,n,i,r,c),l.hasHit=!0,this.callback(l);break;case _n.CLOSEST:(c<l.distance||!l.hasHit)&&(this.hasHit=!0,l.hasHit=!0,l.set(o,a,e,n,i,r,c));break;case _n.ANY:this.hasHit=!0,l.hasHit=!0,l.set(o,a,e,n,i,r,c),l.shouldStop=!0}}static pointInTriangle(e,n,i,r){r.vsub(n,fl),i.vsub(n,Gp),e.vsub(n,NM);const s=fl.dot(fl),o=fl.dot(Gp),a=fl.dot(NM),c=Gp.dot(Gp),l=Gp.dot(NM);let u,d;return(u=c*a-o*l)>=0&&(d=s*l-o*a)>=0&&u+d<s*c-o*o}}_n.CLOSEST=1,_n.ANY=2,_n.ALL=4;const c6=new Ot,PM=[],Gp=new b,NM=new b,LMe=new b,FMe=new Yt,Xi=new b,fs=new b,so=new b,oo=new b;new b,new zp;const l6={faceList:[0]},db=new b,BMe=new _n,kMe=[],UMe=new b,VMe=new b,jMe=new b,u6=(new b,new b,new b),GMe=new b,WMe=new b,$Me=new b,qMe=new b,XMe=new b,YMe=new b;new Ot;const KMe=[],JMe=new it,fl=new b,hb=new b;new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new _n,new b,new b,new b,new b(1,0,0),new b(0,1,0),new b(0,0,1),new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new Ot,new b,new Ot,new b,new b,new b,new b,new b,new b,new b,new Ot,new b,new it,new Ot,new b,new b,new b,new b,new b,new Yt,new Yt,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new Ot,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new Yt,new b,new b,new b,new b,new b,new b,new b,new b,new b,new Ot,new _n;const On=globalThis.performance||{};if(!On.now){let t=Date.now();On.timing&&On.timing.navigationStart&&(t=On.timing.navigationStart),On.now=()=>Date.now()-t}function UM(){return UM=ee(function*(t){console.log("Starting Collisioning");const e=t.filter(o=>!o.scenegraph&&"wireframe"!==o.geometry).map(o=>{const a=new Le(o.transformMatrix),c=a.transformAsPoint([-1,-1,-1],[]),l=a.transformAsPoint([1,1,1],[]);return{"@id":o["@id"],name:o.tooltip,entityId:o.entityId,bbox:new Ot({lowerBound:new b(...c.map((u,d)=>Math.min(u,l[d]))),upperBound:new b(...l.map((u,d)=>Math.max(u,c[d])))})}}),n=[];for(const o of t.filter(a=>!!a.scenegraph)){const a=yield Cp(o.scenegraph,Sd,{DracoLoader:iM,decompress:!0,postProcess:!0});for(const c of a.scenes??[])lb(c,new Le(o.transformMatrix),(l,u)=>{if(l.mesh&&l.mesh.primitives&&l.mesh.primitives.length>0)for(const d of l.mesh.primitives)if(d.attributes.POSITION&&d.attributes.POSITION.min){const h=u.transformAsPoint(d.attributes.POSITION.min,[]),f=u.transformAsPoint(d.attributes.POSITION.max,[]);n.push({"@id":o["@id"],name:l.name,entityId:o.entityId,bbox:new Ot({lowerBound:new b(...h.map((p,g)=>Math.min(p,f[g]))),upperBound:new b(...f.map((p,g)=>Math.max(p,h[g])))}),gltf:a})}return!0})}const i=[],r=[];for(const o of e){const a=[];for(const c of n)o.bbox.overlaps(c.bbox)&&a.push({"@id":c["@id"],name:c.name});a.length>0?i.push({"@id":o.entityId,name:o.name,hits:a}):r.push(o)}console.log({sourceBoxes:e,targetBoxes:n,report:i,sad:r,maxHits:Math.max(...i.map(o=>o.hits.length))});const s=[];for(const o of i){s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":"","Hit Name":""});for(const a of o.hits)s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":a["@id"],"Hit Name":a.name})}return console.log(s),i}),UM.apply(this,arguments)}function VM(t,e,n){if(e&&0!==e.length){let i;switch(n.geometry){case"sphere":i=new qIe;break;case"cone":i=new JIe;break;case"cylinder":i=new ZIe;break;default:i=new rMe}return new lI({id:t,pickable:!0,autoHighlight:!1,highlightColor:[30,136,229,255],coordinateSystem:Qe.CARTESIAN,data:e,mesh:i,wireframe:!1,getColor:r=>r.color||[255,255,255,229.5],getTransformMatrix:r=>r.transformMatrix,...n})}}function F6(t,e,n){if(e&&0!==e.length)return new sI({id:t,pickable:!0,data:e.map(i=>({...i,position:new Le(i.transformMatrix).getTranslation()})),getText:i=>i.text,getPosition:i=>i.position,getColor:i=>i.color,...n})}new b;let iOe=(()=>{class t extends eI{static#e=this.layerName="BodyUILayer";static#t=this.gltfCache={};initializeState(){const{data:n}=this.props;this.setState({data:n??[],zoomOpacity:.8,doCollisions:!1}),W8()}renderLayers(){const n=this.state,i={sphere:[],cone:[],cylinder:[],cube:[],text:[],wireframe:[],scenegraph:[]};for(const o of n.data){const a=o.geometry??"cube";o.scenegraph?i.scenegraph.push(o):void 0!==i[a]&&i[a].push(o)}const r={};for(const o of i.scenegraph)o.scenegraph&&o.scenegraphNode&&!Object.prototype.hasOwnProperty.call(r,o.scenegraph)&&(r[o.scenegraph]=q8({scenegraph:o.scenegraph},t.gltfCache));const s=[];for(const[o,a]of Object.entries(i))if("scenegraph"===o)for(const c of a)s.push(new CM({id:"models-"+c["@id"],opacity:c.zoomBasedOpacity?n.zoomOpacity:c.opacity??1,pickable:!c.unpickable,coordinateSystem:Qe.CARTESIAN,data:[c],scenegraph:c.scenegraphNode?sMe(c.scenegraphNode,r[c.scenegraph]):c.scenegraph,_lighting:c._lighting,getTransformMatrix:c.transformMatrix,getColor:c.color??[0,255,0,127.5],parameters:{depthMask:!c.zoomBasedOpacity&&(void 0===c.opacity||1===c.opacity)}}));else"text"===o?(s.push(F6("text",a.filter(c=>c.unpickable),{pickable:!1})),s.push(F6("textPickable",a.filter(c=>!c.unpickable),{pickable:!0}))):"wireframe"===o?s.push(VM(o,a,{wireframe:!0,pickable:!1,geometry:o})):(s.push(VM(o,a.filter(c=>c.unpickable),{wireframe:!1,pickable:!1,geometry:o})),s.push(VM(`${o}Pickable`,a.filter(c=>!c.unpickable),{wireframe:!1,pickable:!0,geometry:o})));return n.doCollisions&&function nOe(t){UM.apply(this,arguments)}(n.data),s.filter(o=>!!o)}getPickingInfo(n){return n.info}}return t})();function B6(t,e=[]){for(const n of t.nodes||t.children||[])e.push(n.name),B6(n,e);return e}function jM(){return jM=ee(function*(t,e,n,i){W8();const r=yield q8({scenegraph:t,scenegraphNode:n},i),s={},o=[];e=new Le(e??Le.IDENTITY);for(const a of r.scenes)lb(a,e,(c,l)=>{const u={"@id":c.name||c.id,"@type":"ProcessedNode",transformMatrix:new Le(l),geometry:"wireframe",node:c};if(o.push({"@id":`GLTF:${u["@id"]}`,"@type":"GLTFNode",scenegraph:t,scenegraphNode:u["@id"],transformMatrix:new Le(e||Le.IDENTITY),tooltip:c.name||c.id,color:[255,255,255,255],_lighting:"pbr",zoomBasedOpacity:!0,node:c}),c.mesh&&c.mesh.primitives&&c.mesh.primitives.length>0)for(const d of c.mesh.primitives)if(d.attributes.POSITION&&d.attributes.POSITION.min){const h=l.transformAsPoint(d.attributes.POSITION.min,[]),f=l.transformAsPoint(d.attributes.POSITION.max,[]);u.bbox=new Ot({lowerBound:new b(...h.map((p,g)=>Math.min(p,f[g]))),upperBound:new b(...f.map((p,g)=>Math.max(p,h[g])))})}return s[u["@id"]]=u,!0});for(const a of Object.values(s).filter(c=>!c.bbox)){for(const c of B6(a.node).map(l=>s[l]).filter(l=>l.bbox))a.bbox?a.bbox.extend(c.bbox):a.bbox=c.bbox.clone();a.bbox||delete s[a["@id"]]}for(const a of Object.values(s)){const c=a.bbox.lowerBound,d=(a.size=a.bbox.upperBound.clone().vsub(c)).clone().vmul(new b(.5,.5,.5)),h=a.center=c.clone().vadd(d);a.transformMatrix=new Le(Le.IDENTITY).translate(h.toArray()).scale(d.toArray())}for(const a of o)s[a["@id"]]=a;return s}),jM.apply(this,arguments)}class sOe{constructor(e){this.deckProps=e,this.bodyUILayer=new iOe({}),this.nodeClickSubject=new de,this.nodeHoverStartSubject=new de,this.nodeHoverStopSubject=new de,this.sceneRotationSubject=new on([0,0]),this.nodeDragStartSubject=new de,this.nodeDragSubject=new de,this.nodeDragEndSubject=new de,this.nodeClick$=this.nodeClickSubject.pipe(xo()),this.nodeHoverStart$=this.nodeHoverStartSubject.pipe(xo()),this.nodeHoverStop$=this.nodeHoverStopSubject.pipe(xo()),this.sceneRotation$=this.sceneRotationSubject.pipe(xo()),this.nodeDragStart$=this.nodeDragStartSubject.pipe(xo()),this.nodeDrag$=this.nodeDragSubject.pipe(xo()),this.nodeDragEnd$=this.nodeDragEndSubject.pipe(xo()),this._onHover=i=>{const{lastHovered:r}=this;this.cursor=i.picked?"pointer":void 0,i.picked&&i.object?.["@id"]?r!==i.object&&(r&&this.nodeHoverStopSubject.next(r),this.lastHovered=i.object,this.nodeHoverStartSubject.next(i.object)):r&&(this.nodeHoverStopSubject.next(r),this.lastHovered=void 0)},this._onClick=(i,r)=>{i.picked&&i.object?.["@id"]&&this.nodeClickSubject.next({node:i.object,ctrlClick:r?.srcEvent?.ctrlKey??void 0})},this._onViewStateChange=i=>{if(i.interactionState?.isZooming){const r=this.bodyUILayer.state,s=Math.min(Math.max(1-(i.viewState.zoom-8.9)/2,.05),1);r.zoomOpacity!==s&&this.bodyUILayer.setState({data:r.data,zoomOpacity:s})}this.deck.setProps({viewState:{...i.viewState}}),this.sceneRotationSubject.next([i.viewState.rotationOrbit,i.viewState.rotationX])},this._onDragStart=(i,r)=>{this._dragEvent(i,r,this.nodeDragStartSubject)},this._onDrag=(i,r)=>{this._dragEvent(i,r,this.nodeDragSubject)},this._onDragEnd=(i,r)=>{this._dragEvent(i,r,this.nodeDragEndSubject)};const n={...e,views:["orthographic"===e.camera?new oS({flipY:!1,near:-1e3}):new eH({orbitAxis:"Y"})],controller:e.interactive??!0,layers:[this.bodyUILayer],onHover:this._onHover,onClick:this._onClick,onViewStateChange:this._onViewStateChange,onDragStart:this._onDragStart,onDrag:this._onDrag,onDragEnd:this._onDragEnd,getCursor:i=>this.cursor??(i.isDragging?"grabbing":"grab")};e.legacyLighting&&(n.effects=[new VS({ambientLight:new az({color:[255,255,255],intensity:10})})]),this.deck=new jx(n),this.deck.setProps({viewState:{orbitAxis:"Y",minRotationX:e.minRotationX??-15,maxRotationX:e.maxRotationX??15,target:e.target??[.5,.5,0],rotationX:0,rotationOrbit:e.rotation??0,zoom:e.zoom??9.5,camera:e.camera}}),e.rotation&&this.sceneRotationSubject.next([e.rotation,0])}initialize(){var e=this;return ee(function*(){for(;!e.bodyUILayer.state;)yield new Promise(n=>{setTimeout(n,200)})})()}finalize(){this.deck.finalize()}setScene(e){if(e?.length>0){let n=this.bodyUILayer.state.zoomOpacity,i=!1;for(const r of e)r.zoomToOnLoad&&(this.zoomTo(r),i=!0);n=i?.05:n,this.deckProps.debugSceneNodeProcessing?this.debugSceneNodeProcessing(e,n):this.bodyUILayer.setState({data:e,zoomOpacity:n})}}debugSceneNodeProcessing(e,n){const i="https://hubmapconsortium.github.io/ccf-3d-reference-object-library/VH_Female/United/VHF_United_Color.glb",r=new Le([.076,0,0,0,0,.076,16875389974302382e-33,0,0,-16875389974302382e-33,.076,0,.49,.034,.11,1]);(function rOe(t,e,n,i){return jM.apply(this,arguments)})(i,r,"VHF_Kidney_L_Low1").then(s=>{console.log("results",s),console.log("data",e),(e=e.concat(Object.values(s))).push({"@id":"TEST","@type":"TEST",scenegraph:i,scenegraphNode:"VHF_Kidney_R_Low",transformMatrix:r,color:[255,255,255,200],_lighting:"pbr",zoomBasedOpacity:!1}),this.bodyUILayer.setState({data:e,zoomOpacity:n})})}zoomTo(e){const n=new Le(e.transformMatrix);this.deck.setProps({viewState:{...this.deck.props.viewState,target:n.getTranslation(),rotationX:0,rotationOrbit:0,zoom:11.5}})}setRotation(e){this.deck.setProps({viewState:{...this.deck.props.viewState,rotationOrbit:e}})}setRotationX(e){this.deck.setProps({viewState:{...this.deck.props.viewState,rotationX:e}})}setZoom(e){this.deck.setProps({viewState:{...this.deck.props.viewState,zoom:e}})}setTarget(e){this.deck.setProps({viewState:{...this.deck.props.viewState,target:e}})}setInteractive(e){this.deck.setProps({controller:e})}_dragEvent(e,n,i){e?.object?.["@id"]&&i.next({node:e.object,info:e,e:n})}}const oOe=["bodyCanvas"];let aOe=(()=>{class t{constructor(){this.clsName="ccf-body-ui",this.rotationChange=new Pe,this.nodeDrag=new Pe,this.nodeClick=new Pe,this.nodeHoverStart=new Pe,this.nodeHoverStop=new Pe,this.initialized=new Pe,this._interactive=!0,this._rotation=0,this._rotationX=0,this._zoom=9.5,this._target=[0,0,0],this._scene=[],this.subscriptions=[]}get scene(){return this._scene}set scene(n){this._scene=n,this.bodyUI?.setScene(n)}get rotation(){return this._rotation}set rotation(n){this._rotation=n,this.bodyUI?.setRotation(n)}get rotationX(){return this._rotationX}set rotationX(n){this._rotationX=n,this.bodyUI?.setRotationX(n)}get zoom(){return this._zoom}set zoom(n){this._zoom=n,this.bodyUI?.setZoom(n)}get target(){return this._target}set target(n){this._target=n,this.bodyUI?.setTarget(n)}get bounds(){return this._bounds}set bounds(n){this._bounds=n,this.zoomToBounds(n)}get camera(){return this._camera}set camera(n){this._camera=n}get interactive(){return this._interactive}set interactive(n){this._interactive=n,this.bodyUI&&this.recreateBodyUI()}ngAfterViewInit(){this.setupBodyUI()}zoomToBounds(n,i={x:48,y:48}){if(this.bodyCanvas){const{width:r,height:s}=this.bodyCanvas.nativeElement,o=window.devicePixelRatio,a=Math.min(Math.log2((r-i.x)/o/n.x),Math.log2((s-i.y)/o/n.y));this.zoom=a}}setupBodyUI(){var n=this;return ee(function*(){const i=n.bodyCanvas.nativeElement,r=new sOe({id:"body-ui",canvas:i,zoom:n.zoom,target:[0,0,0],rotation:0,minRotationX:-75,maxRotationX:75,interactive:n.interactive,camera:n.camera});i.addEventListener("contextmenu",s=>s.preventDefault()),yield r.initialize(),n.bodyUI=r,window.bodyUI=r,n.scene?.length>0&&n.bodyUI.setScene(n.scene),n.bounds&&n.zoomToBounds(n.bounds),n.target&&n.bodyUI.setTarget(n.target),n.subscriptions=[n.bodyUI.sceneRotation$.subscribe(s=>n.rotationChange.next(s)),n.bodyUI.nodeDrag$.subscribe(s=>n.nodeDrag.emit(s)),n.bodyUI.nodeClick$.subscribe(s=>n.nodeClick.emit(s)),n.bodyUI.nodeHoverStart$.subscribe(s=>n.nodeHoverStart.emit(s)),n.bodyUI.nodeHoverStop$.subscribe(s=>n.nodeHoverStop.emit(s))],n.initialized.emit()})()}recreateBodyUI(){this.clearSubscriptions(),this.bodyUI.finalize(),this.setupBodyUI()}clearSubscriptions(){this.subscriptions.forEach(n=>n.unsubscribe()),this.subscriptions=[]}ngOnDestroy(){this.clearSubscriptions()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=an({type:t,selectors:[["ccf-body-ui"]],viewQuery:function(i,r){if(1&i&&Su(oOe,5,en),2&i){let s;ma(s=_a())&&(r.bodyCanvas=s.first)}},hostVars:2,hostBindings:function(i,r){2&i&&Hm(r.clsName)},inputs:{scene:"scene",rotation:"rotation",rotationX:"rotationX",zoom:"zoom",target:"target",bounds:"bounds",camera:"camera",interactive:"interactive"},outputs:{rotationChange:"rotationChange",nodeDrag:"nodeDrag",nodeClick:"nodeClick",nodeHoverStart:"nodeHoverStart",nodeHoverStop:"nodeHoverStop",initialized:"initialized"},decls:2,vars:0,consts:[["bodyCanvas",""],[1,"body-ui"]],template:function(i,r){1&i&&Rs(0,"canvas",1,0)},styles:["[_nghost-%COMP%]{height:100%;display:block}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{position:relative!important;background-color:#000;border-radius:.5rem}"],changeDetection:0})}return t})();const cOe=["bodyUI"],lOe=()=>[];let uOe=(()=>{class t{constructor(n,i,r){this.configState=n,this.sceneSource=i,this.cdr=r,this.onMouseEnter=new Pe,this.onMouseLeave=new Pe,this.onClick=new Pe,this.data$=this.configState.getOption("data"),this.organs$=this.sceneSource.filteredOrgans$,this.scene$=this.sceneSource.filteredScene$.pipe(At(s=>this.reset()))}reset(){var n=this;return ee(function*(){const{bodyUI:i}=n;yield new Promise(o=>{setTimeout(o,200)});const r=yield function oge(t,e){const n="object"==typeof e;return new Promise((i,r)=>{let o,s=!1;t.subscribe({next:a=>{o=a,s=!0},error:r,complete:()=>{s?i(o):n?i(e.defaultValue):r(new Ou)}})})}(n.organs$.pipe(Dn(1))),s=!!i.scene?.find(o=>o.zoomToOnLoad);if(i.rotation=0,i.rotationX=0,!s)if(r&&1===r.length){const{x_dimension:o,y_dimension:a,z_dimension:c}=r[0];i.bounds={x:1.25*o/1e3,y:1.25*a/1e3,z:1.25*c/1e3},i.target=[o/1e3/2,a/1e3/2,c/1e3/2]}else i.bounds={x:2.2,y:2,z:.4},i.target=[0,0,0];n.cdr.detectChanges()})()}static#e=this.\u0275fac=function(i){return new(i||t)(j(xa),j(gge),j(lr))};static#t=this.\u0275cmp=an({type:t,selectors:[["ccf-root"]],viewQuery:function(i,r){if(1&i&&Su(cOe,7),2&i){let s;ma(s=_a())&&(r.bodyUI=s.first)}},outputs:{onMouseEnter:"onMouseEnter",onMouseLeave:"onMouseLeave",onClick:"onClick"},decls:3,vars:5,consts:[["bodyUI",""],["camera","perspective",1,"body-ui",3,"nodeClick","nodeHoverStart","nodeHoverStop","scene","interactive"]],template:function(i,r){if(1&i){const s=Yh();pt(0,"ccf-body-ui",1,0),va(2,"async"),Ui("nodeClick",function(a){return bs(s),Es(r.onClick.emit(a))})("nodeHoverStart",function(a){return bs(s),Es(r.onMouseEnter.emit(a))})("nodeHoverStop",function(a){return bs(s),Es(r.onMouseLeave.emit(a))}),wt()}if(2&i){let s;li("scene",null!==(s=ba(2,2,r.scene$))&&void 0!==s?s:function UL(t,e,n){const i=Ei()+t,r=B();return r[i]===Me?xs(r,i,n?e.call(n):e()):function Hh(t,e){return t[e]}(r,i)}(4,lOe))("interactive",!0)}},dependencies:[aOe,M_],styles:[".body-ui[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0})}return t})();function dOe(t,e){if(1&t){const n=Yh();pt(0,"ccf-root",1),Ui("onMouseEnter",function(r){return bs(n),Es(Ao().onMouseEnter.emit(r))})("onMouseLeave",function(r){return bs(n),Es(Ao().onMouseLeave.emit(r))})("onClick",function(r){return bs(n),Es(Ao().onClick.emit(r))}),wt()}}function hOe(t){return"string"==typeof t&&(t=JSON.parse(t)),t.map(e=>({"@id":`http://purl.org/ccf/1.5/entity/${e.id}`,"@type":"http://purl.org/ccf/latest/ccf-entity.owl#Sample","http://purl.org/ccf/latest/ccf-entity.owl#has_spatial_entity":e.rui_location}))}let fOe=(()=>{class t extends sge{constructor(n,i){super(n,i,{initialDelay:10,initialConfig:{...$T_dbOptions,...globalThis.dbOptions},parse:{data:hOe}}),this.onMouseEnter=new Pe,this.onMouseLeave=new Pe,this.onClick=new Pe}static#e=this.\u0275fac=function(i){return new(i||t)(j(xa),j(lr))};static#t=this.\u0275cmp=an({type:t,selectors:[["ccf-root-wc"]],inputs:{data:"data",highlightID:"highlightID",zoomToID:"zoomToID"},outputs:{onMouseEnter:"onMouseEnter",onMouseLeave:"onMouseLeave",onClick:"onClick"},features:[wo],decls:1,vars:1,consts:[[3,"onMouseEnter","onMouseLeave","onClick",4,"ngIf"],[3,"onMouseEnter","onMouseLeave","onClick"]],template:function(i,r){1&i&&es(0,dOe,1,0,"ccf-root",0),2&i&&li("ngIf",r.initialized)},dependencies:[FA,uOe],encapsulation:2,changeDetection:0})}return t})();const Eb=(t,e)=>((t,e)=>new Array(e+1).join("0"))(0,e-t.toString().length)+t;class mOe{constructor(e,n,i){this.action=e,this.store=n,this.logWriter=i}dispatched(e){const n=kc(this.action),i=function gOe(t){return Eb(t.getHours(),2)+":"+Eb(t.getMinutes(),2)+":"+Eb(t.getSeconds(),2)+"."+Eb(t.getMilliseconds(),3)}(new Date);this.logWriter.startGroup(`action ${n} @ ${i}`),this._hasPayload(this.action)&&this.logWriter.logGrey("payload",{...this.action}),this.logWriter.logGrey("prev state",e)}completed(e){this.logWriter.logGreen("next state",e),this.logWriter.endGroup()}errored(e){this.logWriter.logRedish("next state after error",this.store.snapshot()),this.logWriter.logRedish("error",e),this.logWriter.endGroup()}_hasPayload(e){return this._getNonEmptyProperties(e).length>0}_getNonEmptyProperties(e){return Object.keys(e).map(r=>e[r]).filter(r=>void 0!==r)}}class _Oe{constructor(e){this.options=e,this.options=this.options||{},this.logger=e.logger||console}startGroup(e){const n=this.options.collapsed?this.logger.groupCollapsed:this.logger.group;try{n.call(this.logger,e)}catch{console.log(e)}}endGroup(){try{this.logger.groupEnd()}catch{this.logger.log("\u2014\u2014 log end \u2014\u2014")}}logGrey(e,n){this.log(e,"color: #9E9E9E; font-weight: bold",n)}logGreen(e,n){this.log(e,"color: #4CAF50; font-weight: bold",n)}logRedish(e,n){this.log(e,"color: #FD8182; font-weight: bold",n)}log(e,n,i){this.isIE()?this.logger.log(e,i):this.logger.log("%c "+e,n,i)}isIE(){const e=typeof window<"u"&&window.navigator.userAgent?window.navigator.userAgent:"";let n=!1;const i=e.indexOf("MSIE "),r=e.indexOf("Trident/");return(i>-1||r>-1)&&(n=!0),n}}const HM=new L("NGXS_LOGGER_PLUGIN_OPTIONS");let k6=(()=>{class t{constructor(n,i){this._options=n,this._injector=i}handle(n,i,r){if(this._options.disabled||!this._options.filter(i,n))return r(n,i);this._logWriter=this._logWriter||new _Oe(this._options),this._store=this._store||this._injector.get(Pr);const s=new mOe(i,this._store,this._logWriter);return s.dispatched(n),r(n,i).pipe(At(o=>{s.completed(o)}),Ps(o=>{throw s.errored(o),o}))}static#e=this.\u0275fac=function(i){return new(i||t)(D(HM),D(lt))};static#t=this.\u0275prov=V({token:t,factory:t.\u0275fac})}return t})();const wb=new L("LOGGER_USER_OPTIONS");function U6(t){return{logger:console,collapsed:!1,disabled:!1,filter:()=>!0,...t}}let yOe=(()=>{class t{static forRoot(n){return{ngModule:t,providers:[{provide:Wk,useClass:k6,multi:!0},{provide:wb,useValue:n},{provide:HM,useFactory:U6,deps:[wb]}]}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Tr({type:t});static#n=this.\u0275inj=tr({})}return t})();const vOe=[xa];let bOe=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Tr({type:t});static#n=this.\u0275inj=tr({imports:[moe.forRoot(),Dse.forRoot(vOe,{developmentMode:!1}),yOe.forRoot({disabled:true})]})}return t})();!function qie(){QA.apply(this,arguments)}("ccf-body-ui-wc",fOe,{providers:[DD((()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Tr({type:t});static#n=this.\u0275inj=tr({providers:[Gue()],imports:[Sie,bOe,Xie]})}return t})())]})},123:(ti,Pn,qe)=>{ti.exports={ResizeSensor:qe(718),ElementQueries:qe(240)}},240:function(ti,Pn,qe){"use strict";var Kt,xt,$t;typeof window<"u"&&window,xt=[qe(718)],void 0!==($t="function"==typeof(Kt=function(Nn){var fe=function(){var be,ke={},ve=[];function De(Y){Y||(Y=document.documentElement);var J=window.getComputedStyle(Y,null).fontSize;return parseFloat(J)||16}function K(Y,J){var we=J.split(/\d/),Ae=we[we.length-1];switch(J=parseFloat(J),Ae){case"px":default:return J;case"em":return J*De(Y);case"rem":return J*De();case"vw":return J*document.documentElement.clientWidth/100;case"vh":return J*document.documentElement.clientHeight/100;case"vmin":case"vmax":var Oe=document.documentElement.clientWidth/100,mt=document.documentElement.clientHeight/100;return J*(0,Math["vmin"===Ae?"min":"max"])(Oe,mt)}}function H(Y,J){this.element=Y;var we,Ae,Oe,mt,zt,It,Jt,Ln,Un=["min-width","min-height","max-width","max-height"];this.call=function(){for(we in Oe=function te(Y){if(!Y.getBoundingClientRect)return{width:Y.offsetWidth,height:Y.offsetHeight};var J=Y.getBoundingClientRect();return{width:Math.round(J.width),height:Math.round(J.height)}}(this.element),It={},ke[J])ke[J].hasOwnProperty(we)&&(mt=K(this.element,(Ae=ke[J][we]).value),zt="width"===Ae.property?Oe.width:Oe.height,Jt="","min"===Ae.mode&&zt>=mt&&(Jt+=Ae.value),"max"===Ae.mode&&zt<=mt&&(Jt+=Ae.value),It[Ln=Ae.mode+"-"+Ae.property]||(It[Ln]=""),Jt&&-1===(" "+It[Ln]+" ").indexOf(" "+Jt+" ")&&(It[Ln]+=" "+Jt));for(var Fn in Un)Un.hasOwnProperty(Fn)&&(It[Un[Fn]]?this.element.setAttribute(Un[Fn],It[Un[Fn]].substr(1)):this.element.removeAttribute(Un[Fn]))}}function Ue(Y,J){Y.elementQueriesSetupInformation||(Y.elementQueriesSetupInformation=new H(Y,J)),Y.elementQueriesSensor||(Y.elementQueriesSensor=new Nn(Y,function(){Y.elementQueriesSetupInformation.call()}))}function Ke(Y,J,we,Ae){if(typeof ke[Y]>"u"){ke[Y]=[];var Oe=ve.length;be.innerHTML+="\n"+Y+" {animation: 0.1s element-queries;}",be.innerHTML+="\n"+Y+" > .resize-sensor {min-width: "+Oe+"px;}",ve.push(Y)}ke[Y].push({mode:J,property:we,value:Ae})}function ce(Y){var J;if(document.querySelectorAll&&(J=Y?Y.querySelectorAll.bind(Y):document.querySelectorAll.bind(document)),!J&&typeof $$<"u"&&(J=$$),!J&&typeof jQuery<"u"&&(J=jQuery),!J)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return J}function qt(Y){var J=[],we=[],Ae=[],Oe=0,mt=-1,zt=[];for(var It in Y.children)if(Y.children.hasOwnProperty(It)&&Y.children[It].tagName&&"img"===Y.children[It].tagName.toLowerCase()){J.push(Y.children[It]);var Jt=Y.children[It].getAttribute("min-width")||Y.children[It].getAttribute("data-min-width"),Ln=Y.children[It].getAttribute("data-src")||Y.children[It].getAttribute("url");Ae.push(Ln),we.push({minWidth:Jt}),Jt?Y.children[It].style.display="none":(Oe=J.length-1,Y.children[It].style.display="block")}function Fn(){var ni,st=!1;for(ni in J)J.hasOwnProperty(ni)&&we[ni].minWidth&&Y.offsetWidth>we[ni].minWidth&&(st=ni);if(st||(st=Oe),mt!==st)if(zt[st])J[mt].style.display="none",J[st].style.display="block",mt=st;else{var Ji=new Image;Ji.onload=function(){J[st].src=Ae[st],J[mt].style.display="none",J[st].style.display="block",zt[st]=!0,mt=st},Ji.src=Ae[st]}else J[st].src=Ae[st]}mt=Oe,Y.resizeSensorInstance=new Nn(Y,Fn),Fn()}var vn=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,Ki=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function kn(Y){var J,we,Ae,Oe;for(Y=Y.replace(/'/g,'"');null!==(J=vn.exec(Y));)for(we=J[1]+J[3],Ae=J[2];null!==(Oe=Ki.exec(Ae));)Ke(we,Oe[1],Oe[2],Oe[3])}function _i(Y){var J="";if(Y)if("string"==typeof Y)(-1!==(Y=Y.toLowerCase()).indexOf("min-width")||-1!==Y.indexOf("max-width"))&&kn(Y);else for(var we=0,Ae=Y.length;we<Ae;we++)1===Y[we].type?(-1!==(J=Y[we].selectorText||Y[we].cssText).indexOf("min-height")||-1!==J.indexOf("max-height")||-1!==J.indexOf("min-width")||-1!==J.indexOf("max-width"))&&kn(J):4===Y[we].type?_i(Y[we].cssRules||Y[we].rules):3===Y[we].type&&Y[we].styleSheet.hasOwnProperty("cssRules")&&_i(Y[we].styleSheet.cssRules)}var yi=!1;this.init=function(){var Y="animationstart";typeof document.documentElement.style.webkitAnimationName<"u"?Y="webkitAnimationStart":typeof document.documentElement.style.MozAnimationName<"u"?Y="mozanimationstart":typeof document.documentElement.style.OAnimationName<"u"&&(Y="oanimationstart"),document.body.addEventListener(Y,function(Ae){var Oe=Ae.target,mt=Oe&&window.getComputedStyle(Oe,null),zt=mt&&mt.getPropertyValue("animation-name");if(zt&&-1!==zt.indexOf("element-queries")){Oe.elementQueriesSensor=new Nn(Oe,function(){Oe.elementQueriesSetupInformation&&Oe.elementQueriesSetupInformation.call()});var Ln=window.getComputedStyle(Oe.resizeSensor,null).getPropertyValue("min-width");Ln=parseInt(Ln.replace("px","")),Ue(Ae.target,ve[Ln])}}),yi||((be=document.createElement("style")).type="text/css",be.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",be.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(be),yi=!0);for(var J=0,we=document.styleSheets.length;J<we;J++)try{document.styleSheets[J].href&&0===document.styleSheets[J].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[J].href),_i(document.styleSheets[J].cssRules||document.styleSheets[J].rules||document.styleSheets[J].cssText)}catch{}!function gt(){for(var J=ce()("[data-responsive-image],[responsive-image]"),we=0,Ae=J.length;we<Ae;we++)qt(J[we])}()},this.findElementQueriesElements=function(Y){!function ft(Y){var J=ce(Y);for(var we in ke)if(ke.hasOwnProperty(we))for(var Ae=J(we,Y),Oe=0,mt=Ae.length;Oe<mt;Oe++)Ue(Ae[Oe],we)}(Y)},this.update=function(){this.init()}};fe.update=function(){fe.instance.update()},fe.detach=function(be){be.elementQueriesSetupInformation?(be.elementQueriesSensor.detach(),delete be.elementQueriesSetupInformation,delete be.elementQueriesSensor):be.resizeSensorInstance&&(be.resizeSensorInstance.detach(),delete be.resizeSensorInstance)},fe.init=function(){fe.instance||(fe.instance=new fe),fe.instance.init()};return fe.findElementQueriesElements=function(be){fe.instance.findElementQueriesElements(be)},fe.listen=function(){!function(be){if(document.addEventListener)document.addEventListener("DOMContentLoaded",be,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var ke=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(be(),clearInterval(ke))},10);else window.onload=be}(fe.init)},fe})?Kt.apply(Pn,xt):Kt)&&(ti.exports=$t)},718:function(ti,Pn,qe){"use strict";var Kt,xt;typeof window<"u"&&window,void 0!==(xt="function"==typeof(Kt=function(){if(typeof window>"u")return null;var $t=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")(),Nn=$t.requestAnimationFrame||$t.mozRequestAnimationFrame||$t.webkitRequestAnimationFrame||function(te){return $t.setTimeout(te,20)},fe=$t.cancelAnimationFrame||$t.mozCancelAnimationFrame||$t.webkitCancelAnimationFrame||function(te){$t.clearTimeout(te)};function rt(te,K){var H=Object.prototype.toString.call(te),Ue="[object Array]"===H||"[object NodeList]"===H||"[object HTMLCollection]"===H||"[object Object]"===H||typeof jQuery<"u"&&te instanceof jQuery||typeof Elements<"u"&&te instanceof Elements,Ke=0,ce=te.length;if(Ue)for(;Ke<ce;Ke++)K(te[Ke]);else K(te)}function be(te){if(!te.getBoundingClientRect)return{width:te.offsetWidth,height:te.offsetHeight};var K=te.getBoundingClientRect();return{width:Math.round(K.width),height:Math.round(K.height)}}function ke(te,K){Object.keys(K).forEach(function(H){te.style[H]=K[H]})}var ve=function(te,K){var H=0;function Ue(){var ft,qt,ce=[];this.add=function(gt){ce.push(gt)},this.call=function(gt){for(ft=0,qt=ce.length;ft<qt;ft++)ce[ft].call(this,gt)},this.remove=function(gt){var vn=[];for(ft=0,qt=ce.length;ft<qt;ft++)ce[ft]!==gt&&vn.push(ce[ft]);ce=vn},this.length=function(){return ce.length}}function Ke(ce,ft){if(ce){if(ce.resizedAttached)return void ce.resizedAttached.add(ft);ce.resizedAttached=new Ue,ce.resizedAttached.add(ft),ce.resizeSensor=document.createElement("div"),ce.resizeSensor.dir="ltr",ce.resizeSensor.className="resize-sensor";var qt={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},gt={position:"absolute",left:"0px",top:"0px",transition:"0s"};ke(ce.resizeSensor,qt);var vn=document.createElement("div");vn.className="resize-sensor-expand",ke(vn,qt);var Ki=document.createElement("div");ke(Ki,gt),vn.appendChild(Ki);var kn=document.createElement("div");kn.className="resize-sensor-shrink",ke(kn,qt);var _i=document.createElement("div");ke(_i,gt),ke(_i,{width:"200%",height:"200%"}),kn.appendChild(_i),ce.resizeSensor.appendChild(vn),ce.resizeSensor.appendChild(kn),ce.appendChild(ce.resizeSensor);var yi=window.getComputedStyle(ce),Y=yi?yi.getPropertyValue("position"):null;"absolute"!==Y&&"relative"!==Y&&"fixed"!==Y&&"sticky"!==Y&&(ce.style.position="relative");var J=!1,we=0,Ae=be(ce),Oe=0,mt=0,zt=!0;H=0;var Jt=function(){if(zt){if(0===ce.offsetWidth&&0===ce.offsetHeight)return void(H||(H=Nn(function(){H=0,Jt()})));zt=!1}var st,ni;ni=ce.offsetHeight,Ki.style.width=(st=ce.offsetWidth)+10+"px",Ki.style.height=ni+10+"px",vn.scrollLeft=st+10,vn.scrollTop=ni+10,kn.scrollLeft=st+10,kn.scrollTop=ni+10};ce.resizeSensor.resetSensor=Jt;var Ln=function(){we=0,J&&(Oe=Ae.width,mt=Ae.height,ce.resizedAttached&&ce.resizedAttached.call(Ae))},Un=function(){Ae=be(ce),(J=Ae.width!==Oe||Ae.height!==mt)&&!we&&(we=Nn(Ln)),Jt()},Fn=function(st,ni,Ji){st.attachEvent?st.attachEvent("on"+ni,Ji):st.addEventListener(ni,Ji)};Fn(vn,"scroll",Un),Fn(kn,"scroll",Un),H=Nn(function(){H=0,Jt()})}}rt(te,function(ce){Ke(ce,K)}),this.detach=function(ce){H||(fe(H),H=0),ve.detach(te,ce)},this.reset=function(){te.resizeSensor.resetSensor()}};if(ve.reset=function(te){rt(te,function(K){K.resizeSensor.resetSensor()})},ve.detach=function(te,K){rt(te,function(H){H&&(H.resizedAttached&&"function"==typeof K&&(H.resizedAttached.remove(K),H.resizedAttached.length())||H.resizeSensor&&(H.contains(H.resizeSensor)&&H.removeChild(H.resizeSensor),delete H.resizeSensor,delete H.resizedAttached))})},typeof MutationObserver<"u"){var De=new MutationObserver(function(te){for(var K in te)if(te.hasOwnProperty(K))for(var H=te[K].addedNodes,Ue=0;Ue<H.length;Ue++)H[Ue].resizeSensor&&ve.reset(H[Ue])});document.addEventListener("DOMContentLoaded",function(te){De.observe(document.body,{childList:!0,subtree:!0})})}return ve})?Kt.call(Pn,qe,Pn,ti):Kt)&&(ti.exports=xt)},511:(ti,Pn,qe)=>{var Kt;!function(xt,$t,Nn,fe){"use strict";var ce,rt=["","webkit","Moz","MS","ms","o"],be=$t.createElement("div"),ke="function",ve=Math.round,De=Math.abs,te=Date.now;function K(A,T,I){return setTimeout(vn(A,I),T)}function H(A,T,I){return!!Array.isArray(A)&&(Ue(A,I[T],I),!0)}function Ue(A,T,I){var P;if(A)if(A.forEach)A.forEach(T,I);else if(A.length!==fe)for(P=0;P<A.length;)T.call(I,A[P],P,A),P++;else for(P in A)A.hasOwnProperty(P)&&T.call(I,A[P],P,A)}function Ke(A,T,I){var P="DEPRECATED METHOD: "+T+"\n"+I+" AT \n";return function(){var q=new Error("get-stack-trace"),ie=q&&q.stack?q.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Ve=xt.console&&(xt.console.warn||xt.console.log);return Ve&&Ve.call(xt.console,P,ie),A.apply(this,arguments)}}ce="function"!=typeof Object.assign?function(T){if(T===fe||null===T)throw new TypeError("Cannot convert undefined or null to object");for(var I=Object(T),P=1;P<arguments.length;P++){var q=arguments[P];if(q!==fe&&null!==q)for(var ie in q)q.hasOwnProperty(ie)&&(I[ie]=q[ie])}return I}:Object.assign;var ft=Ke(function(T,I,P){for(var q=Object.keys(I),ie=0;ie<q.length;)(!P||P&&T[q[ie]]===fe)&&(T[q[ie]]=I[q[ie]]),ie++;return T},"extend","Use `assign`."),qt=Ke(function(T,I){return ft(T,I,!0)},"merge","Use `assign`.");function gt(A,T,I){var q,P=T.prototype;(q=A.prototype=Object.create(P)).constructor=A,q._super=P,I&&ce(q,I)}function vn(A,T){return function(){return A.apply(T,arguments)}}function Ki(A,T){return typeof A==ke?A.apply(T&&T[0]||fe,T):A}function kn(A,T){return A===fe?T:A}function _i(A,T,I){Ue(we(T),function(P){A.addEventListener(P,I,!1)})}function yi(A,T,I){Ue(we(T),function(P){A.removeEventListener(P,I,!1)})}function Y(A,T){for(;A;){if(A==T)return!0;A=A.parentNode}return!1}function J(A,T){return A.indexOf(T)>-1}function we(A){return A.trim().split(/\s+/g)}function Ae(A,T,I){if(A.indexOf&&!I)return A.indexOf(T);for(var P=0;P<A.length;){if(I&&A[P][I]==T||!I&&A[P]===T)return P;P++}return-1}function Oe(A){return Array.prototype.slice.call(A,0)}function mt(A,T,I){for(var P=[],q=[],ie=0;ie<A.length;){var Ve=T?A[ie][T]:A[ie];Ae(q,Ve)<0&&P.push(A[ie]),q[ie]=Ve,ie++}return I&&(P=T?P.sort(function(En,Hn){return En[T]>Hn[T]}):P.sort()),P}function zt(A,T){for(var I,P,q=T[0].toUpperCase()+T.slice(1),ie=0;ie<rt.length;){if((P=(I=rt[ie])?I+q:T)in A)return P;ie++}return fe}var It=1;function Ln(A){var T=A.ownerDocument||A;return T.defaultView||T.parentWindow||xt}var Fn="ontouchstart"in xt,st=zt(xt,"PointerEvent")!==fe,ni=Fn&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Ji="touch",_l="mouse",yl=25,Vn=1,Zt=4,jn=8,vl=1,bl=2,Za=4,Qa=8,ec=16,Ri=bl|Za,co=Qa|ec,Tb=Ri|co,Fe=["x","y"],Ko=["clientX","clientY"];function ii(A,T){var I=this;this.manager=A,this.callback=T,this.element=A.element,this.target=A.options.inputTarget,this.domHandler=function(P){Ki(A.options.enable,[A])&&I.handler(P)},this.init()}function bt(A,T,I){var P=I.pointers.length,q=I.changedPointers.length,ie=T&Vn&&P-q==0,Ve=T&(Zt|jn)&&P-q==0;I.isFirst=!!ie,I.isFinal=!!Ve,ie&&(A.session={}),I.eventType=T,function eg(A,T){var I=A.session,P=T.pointers,q=P.length;I.firstInput||(I.firstInput=Er(T)),q>1&&!I.firstMultiple?I.firstMultiple=Er(T):1===q&&(I.firstMultiple=!1);var ie=I.firstInput,Ve=I.firstMultiple,bn=Ve?Ve.center:ie.center,En=T.center=tc(P);T.timeStamp=te(),T.deltaTime=T.timeStamp-ie.timeStamp,T.angle=Nd(bn,En),T.distance=wl(bn,En),function tg(A,T){var I=T.center,P=A.offsetDelta||{},q=A.prevDelta||{},ie=A.prevInput||{};(T.eventType===Vn||ie.eventType===Zt)&&(q=A.prevDelta={x:ie.deltaX||0,y:ie.deltaY||0},P=A.offsetDelta={x:I.x,y:I.y}),T.deltaX=q.x+(I.x-P.x),T.deltaY=q.y+(I.y-P.y)}(I,T),T.offsetDirection=nc(T.deltaX,T.deltaY);var Hn=Pd(T.deltaTime,T.deltaX,T.deltaY);T.overallVelocityX=Hn.x,T.overallVelocityY=Hn.y,T.overallVelocity=De(Hn.x)>De(Hn.y)?Hn.x:Hn.y,T.scale=Ve?function Ld(A,T){return wl(T[0],T[1],Ko)/wl(A[0],A[1],Ko)}(Ve.pointers,P):1,T.rotation=Ve?function Sb(A,T){return Nd(T[1],T[0],Ko)+Nd(A[1],A[0],Ko)}(Ve.pointers,P):0,T.maxPointers=I.prevInput?T.pointers.length>I.prevInput.maxPointers?T.pointers.length:I.prevInput.maxPointers:T.pointers.length,function ng(A,T){var q,ie,Ve,bn,I=A.lastInterval||T,P=T.timeStamp-I.timeStamp;if(T.eventType!=jn&&(P>yl||I.velocity===fe)){var En=T.deltaX-I.deltaX,Hn=T.deltaY-I.deltaY,Cr=Pd(P,En,Hn);ie=Cr.x,Ve=Cr.y,q=De(Cr.x)>De(Cr.y)?Cr.x:Cr.y,bn=nc(En,Hn),A.lastInterval=T}else q=I.velocity,ie=I.velocityX,Ve=I.velocityY,bn=I.direction;T.velocity=q,T.velocityX=ie,T.velocityY=Ve,T.direction=bn}(I,T);var Cr=A.element;Y(T.srcEvent.target,Cr)&&(Cr=T.srcEvent.target),T.target=Cr}(A,I),A.emit("hammer.input",I),A.recognize(I),A.session.prevInput=I}function Er(A){for(var T=[],I=0;I<A.pointers.length;)T[I]={clientX:ve(A.pointers[I].clientX),clientY:ve(A.pointers[I].clientY)},I++;return{timeStamp:te(),pointers:T,center:tc(T),deltaX:A.deltaX,deltaY:A.deltaY}}function tc(A){var T=A.length;if(1===T)return{x:ve(A[0].clientX),y:ve(A[0].clientY)};for(var I=0,P=0,q=0;q<T;)I+=A[q].clientX,P+=A[q].clientY,q++;return{x:ve(I/T),y:ve(P/T)}}function Pd(A,T,I){return{x:T/A||0,y:I/A||0}}function nc(A,T){return A===T?vl:De(A)>=De(T)?A<0?bl:Za:T<0?Qa:ec}function wl(A,T,I){I||(I=Fe);var P=T[I[0]]-A[I[0]],q=T[I[1]]-A[I[1]];return Math.sqrt(P*P+q*q)}function Nd(A,T,I){return I||(I=Fe),180*Math.atan2(T[I[1]]-A[I[1]],T[I[0]]-A[I[0]])/Math.PI}ii.prototype={handler:function(){},init:function(){this.evEl&&_i(this.element,this.evEl,this.domHandler),this.evTarget&&_i(this.target,this.evTarget,this.domHandler),this.evWin&&_i(Ln(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&yi(this.element,this.evEl,this.domHandler),this.evTarget&&yi(this.target,this.evTarget,this.domHandler),this.evWin&&yi(Ln(this.element),this.evWin,this.domHandler)}};var lo={mousedown:Vn,mousemove:2,mouseup:Zt},Al="mousedown",xb="mousemove mouseup";function Jo(){this.evEl=Al,this.evWin=xb,this.pressed=!1,ii.apply(this,arguments)}gt(Jo,ii,{handler:function(T){var I=lo[T.type];I&Vn&&0===T.button&&(this.pressed=!0),2&I&&1!==T.which&&(I=Zt),this.pressed&&(I&Zt&&(this.pressed=!1),this.callback(this.manager,I,{pointers:[T],changedPointers:[T],pointerType:_l,srcEvent:T}))}});var Ib={pointerdown:Vn,pointermove:2,pointerup:Zt,pointercancel:jn,pointerout:jn},Fd={2:Ji,3:"pen",4:_l,5:"kinect"},ig="pointerdown",uo="pointermove pointerup pointercancel";function Zo(){this.evEl=ig,this.evWin=uo,ii.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}xt.MSPointerEvent&&!xt.PointerEvent&&(ig="MSPointerDown",uo="MSPointerMove MSPointerUp MSPointerCancel"),gt(Zo,ii,{handler:function(T){var I=this.store,P=!1,q=T.type.toLowerCase().replace("ms",""),ie=Ib[q],Ve=Fd[T.pointerType]||T.pointerType,bn=Ve==Ji,En=Ae(I,T.pointerId,"pointerId");ie&Vn&&(0===T.button||bn)?En<0&&(I.push(T),En=I.length-1):ie&(Zt|jn)&&(P=!0),!(En<0)&&(I[En]=T,this.callback(this.manager,ie,{pointers:I,changedPointers:[T],pointerType:Ve,srcEvent:T}),P&&I.splice(En,1))}});var Mb={touchstart:Vn,touchmove:2,touchend:Zt,touchcancel:jn};function Cl(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,ii.apply(this,arguments)}function ps(A,T){var I=Oe(A.touches),P=Oe(A.changedTouches);return T&(Zt|jn)&&(I=mt(I.concat(P),"identifier",!0)),[I,P]}gt(Cl,ii,{handler:function(T){var I=Mb[T.type];if(I===Vn&&(this.started=!0),this.started){var P=ps.call(this,T,I);I&(Zt|jn)&&P[0].length-P[1].length==0&&(this.started=!1),this.callback(this.manager,I,{pointers:P[0],changedPointers:P[1],pointerType:Ji,srcEvent:T})}}});var Rb={touchstart:Vn,touchmove:2,touchend:Zt,touchcancel:jn},rg="touchstart touchmove touchend touchcancel";function ge(){this.evTarget=rg,this.targetIds={},ii.apply(this,arguments)}function sg(A,T){var I=Oe(A.touches),P=this.targetIds;if(T&(2|Vn)&&1===I.length)return P[I[0].identifier]=!0,[I,I];var q,ie,Ve=Oe(A.changedTouches),bn=[],En=this.target;if(ie=I.filter(function(Hn){return Y(Hn.target,En)}),T===Vn)for(q=0;q<ie.length;)P[ie[q].identifier]=!0,q++;for(q=0;q<Ve.length;)P[Ve[q].identifier]&&bn.push(Ve[q]),T&(Zt|jn)&&delete P[Ve[q].identifier],q++;return bn.length?[mt(ie.concat(bn),"identifier",!0),bn]:void 0}gt(ge,ii,{handler:function(T){var I=Rb[T.type],P=sg.call(this,T,I);P&&this.callback(this.manager,I,{pointers:P[0],changedPointers:P[1],pointerType:Ji,srcEvent:T})}});var Ob=2500;function kd(){ii.apply(this,arguments);var A=vn(this.handler,this);this.touch=new ge(this.manager,A),this.mouse=new Jo(this.manager,A),this.primaryTouch=null,this.lastTouches=[]}function de(A,T){A&Vn?(this.primaryTouch=T.changedPointers[0].identifier,Ud.call(this,T)):A&(Zt|jn)&&Ud.call(this,T)}function Ud(A){var T=A.changedPointers[0];if(T.identifier===this.primaryTouch){var I={x:T.clientX,y:T.clientY};this.lastTouches.push(I);var P=this.lastTouches;setTimeout(function(){var ie=P.indexOf(I);ie>-1&&P.splice(ie,1)},Ob)}}function on(A){for(var T=A.srcEvent.clientX,I=A.srcEvent.clientY,P=0;P<this.lastTouches.length;P++){var q=this.lastTouches[P],ie=Math.abs(T-q.x),Ve=Math.abs(I-q.y);if(ie<=25&&Ve<=25)return!0}return!1}gt(kd,ii,{handler:function(T,I,P){var ie=P.pointerType==_l;if(!(ie&&P.sourceCapabilities&&P.sourceCapabilities.firesTouchEvents)){if(P.pointerType==Ji)de.call(this,I,P);else if(ie&&on.call(this,P))return;this.callback(T,I,P)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Vd=zt(be.style,"touchAction"),_t=Vd!==fe,ot="compute",se="manipulation",ho="none",zr="pan-x",Qo="pan-y",ic=function Pb(){if(!_t)return!1;var A={},T=xt.CSS&&xt.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(I){A[I]=!T||xt.CSS.supports("touch-action",I)}),A}();function Tl(A,T){this.manager=A,this.set(T)}Tl.prototype={set:function(A){A==ot&&(A=this.compute()),_t&&this.manager.element.style&&ic[A]&&(this.manager.element.style[Vd]=A),this.actions=A.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var A=[];return Ue(this.manager.recognizers,function(T){Ki(T.options.enable,[T])&&(A=A.concat(T.getTouchAction()))}),function jd(A){if(J(A,ho))return ho;var T=J(A,zr),I=J(A,Qo);return T&&I?ho:T||I?T?zr:Qo:J(A,se)?se:"auto"}(A.join(" "))},preventDefaults:function(A){var T=A.srcEvent,I=A.offsetDirection;if(!this.manager.session.prevented){var P=this.actions,q=J(P,ho)&&!ic[ho],ie=J(P,Qo)&&!ic[Qo],Ve=J(P,zr)&&!ic[zr];if(q&&1===A.pointers.length&&A.distance<2&&A.deltaTime<250)return;return Ve&&ie||!(q||ie&&I&Ri||Ve&&I&co)?void 0:this.preventSrc(T)}T.preventDefault()},preventSrc:function(A){this.manager.session.prevented=!0,A.preventDefault()}};var Sl=1;function Wr(A){this.options=ce({},this.defaults,A||{}),this.id=function Jt(){return It++}(),this.manager=null,this.options.enable=kn(this.options.enable,!0),this.state=Sl,this.simultaneous={},this.requireFail=[]}function cg(A){return 16&A?"cancel":8&A?"end":4&A?"move":2&A?"start":""}function Nb(A){return A==ec?"down":A==Qa?"up":A==bl?"left":A==Za?"right":""}function Hd(A,T){var I=T.manager;return I?I.get(A):A}function Ar(){Wr.apply(this,arguments)}function Ut(){Ar.apply(this,arguments),this.pX=null,this.pY=null}function lg(){Ar.apply(this,arguments)}function zd(){Wr.apply(this,arguments),this._timer=null,this._input=null}function Gd(){Ar.apply(this,arguments)}function ug(){Ar.apply(this,arguments)}function xl(){Wr.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function $r(A,T){return(T=T||{}).recognizers=kn(T.recognizers,$r.defaults.preset),new $d(A,T)}function $d(A,T){this.options=ce({},$r.defaults,T||{}),this.options.inputTarget=this.options.inputTarget||A,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=A,this.input=function El(A){return new(A.options.inputClass||(st?Zo:ni?ge:Fn?kd:Jo))(A,bt)}(this),this.touchAction=new Tl(this,this.options.touchAction),hg(this,!0),Ue(this.options.recognizers,function(I){var P=this.add(new I[0](I[1]));I[2]&&P.recognizeWith(I[2]),I[3]&&P.requireFailure(I[3])},this)}function hg(A,T){var P,I=A.element;I.style&&(Ue(A.options.cssProps,function(q,ie){P=zt(I.style,ie),T?(A.oldCssProps[P]=I.style[P],I.style[P]=q):I.style[P]=A.oldCssProps[P]||""}),T||(A.oldCssProps={}))}Wr.prototype={defaults:{},set:function(A){return ce(this.options,A),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(A){if(H(A,"recognizeWith",this))return this;var T=this.simultaneous;return T[(A=Hd(A,this)).id]||(T[A.id]=A,A.recognizeWith(this)),this},dropRecognizeWith:function(A){return H(A,"dropRecognizeWith",this)||(A=Hd(A,this),delete this.simultaneous[A.id]),this},requireFailure:function(A){if(H(A,"requireFailure",this))return this;var T=this.requireFail;return-1===Ae(T,A=Hd(A,this))&&(T.push(A),A.requireFailure(this)),this},dropRequireFailure:function(A){if(H(A,"dropRequireFailure",this))return this;A=Hd(A,this);var T=Ae(this.requireFail,A);return T>-1&&this.requireFail.splice(T,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(A){return!!this.simultaneous[A.id]},emit:function(A){var T=this,I=this.state;function P(q){T.manager.emit(q,A)}I<8&&P(T.options.event+cg(I)),P(T.options.event),A.additionalEvent&&P(A.additionalEvent),I>=8&&P(T.options.event+cg(I))},tryEmit:function(A){if(this.canEmit())return this.emit(A);this.state=32},canEmit:function(){for(var A=0;A<this.requireFail.length;){if(!(this.requireFail[A].state&(32|Sl)))return!1;A++}return!0},recognize:function(A){var T=ce({},A);if(!Ki(this.options.enable,[this,T]))return this.reset(),void(this.state=32);56&this.state&&(this.state=Sl),this.state=this.process(T),30&this.state&&this.tryEmit(T)},process:function(A){},getTouchAction:function(){},reset:function(){}},gt(Ar,Wr,{defaults:{pointers:1},attrTest:function(A){var T=this.options.pointers;return 0===T||A.pointers.length===T},process:function(A){var T=this.state,I=A.eventType,P=6&T,q=this.attrTest(A);return P&&(I&jn||!q)?16|T:P||q?I&Zt?8|T:2&T?4|T:2:32}}),gt(Ut,Ar,{defaults:{event:"pan",threshold:10,pointers:1,direction:Tb},getTouchAction:function(){var A=this.options.direction,T=[];return A&Ri&&T.push(Qo),A&co&&T.push(zr),T},directionTest:function(A){var T=this.options,I=!0,P=A.distance,q=A.direction,ie=A.deltaX,Ve=A.deltaY;return q&T.direction||(T.direction&Ri?(q=0===ie?vl:ie<0?bl:Za,I=ie!=this.pX,P=Math.abs(A.deltaX)):(q=0===Ve?vl:Ve<0?Qa:ec,I=Ve!=this.pY,P=Math.abs(A.deltaY))),A.direction=q,I&&P>T.threshold&&q&T.direction},attrTest:function(A){return Ar.prototype.attrTest.call(this,A)&&(2&this.state||!(2&this.state)&&this.directionTest(A))},emit:function(A){this.pX=A.deltaX,this.pY=A.deltaY;var T=Nb(A.direction);T&&(A.additionalEvent=this.options.event+T),this._super.emit.call(this,A)}}),gt(lg,Ar,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ho]},attrTest:function(A){return this._super.attrTest.call(this,A)&&(Math.abs(A.scale-1)>this.options.threshold||2&this.state)},emit:function(A){1!==A.scale&&(A.additionalEvent=this.options.event+(A.scale<1?"in":"out")),this._super.emit.call(this,A)}}),gt(zd,Wr,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(A){var T=this.options,I=A.pointers.length===T.pointers,P=A.distance<T.threshold,q=A.deltaTime>T.time;if(this._input=A,!P||!I||A.eventType&(Zt|jn)&&!q)this.reset();else if(A.eventType&Vn)this.reset(),this._timer=K(function(){this.state=8,this.tryEmit()},T.time,this);else if(A.eventType&Zt)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(A){8===this.state&&(A&&A.eventType&Zt?this.manager.emit(this.options.event+"up",A):(this._input.timeStamp=te(),this.manager.emit(this.options.event,this._input)))}}),gt(Gd,Ar,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ho]},attrTest:function(A){return this._super.attrTest.call(this,A)&&(Math.abs(A.rotation)>this.options.threshold||2&this.state)}}),gt(ug,Ar,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ri|co,pointers:1},getTouchAction:function(){return Ut.prototype.getTouchAction.call(this)},attrTest:function(A){var I,T=this.options.direction;return T&(Ri|co)?I=A.overallVelocity:T&Ri?I=A.overallVelocityX:T&co&&(I=A.overallVelocityY),this._super.attrTest.call(this,A)&&T&A.offsetDirection&&A.distance>this.options.threshold&&A.maxPointers==this.options.pointers&&De(I)>this.options.velocity&&A.eventType&Zt},emit:function(A){var T=Nb(A.offsetDirection);T&&this.manager.emit(this.options.event+T,A),this.manager.emit(this.options.event,A)}}),gt(xl,Wr,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[se]},process:function(A){var T=this.options,I=A.pointers.length===T.pointers,P=A.distance<T.threshold,q=A.deltaTime<T.time;if(this.reset(),A.eventType&Vn&&0===this.count)return this.failTimeout();if(P&&q&&I){if(A.eventType!=Zt)return this.failTimeout();var ie=!this.pTime||A.timeStamp-this.pTime<T.interval,Ve=!this.pCenter||wl(this.pCenter,A.center)<T.posThreshold;if(this.pTime=A.timeStamp,this.pCenter=A.center,Ve&&ie?this.count+=1:this.count=1,this._input=A,0==this.count%T.taps)return this.hasRequireFailures()?(this._timer=K(function(){this.state=8,this.tryEmit()},T.interval,this),2):8}return 32},failTimeout:function(){return this._timer=K(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),$r.VERSION="2.0.7",$r.defaults={domEvents:!1,touchAction:ot,enable:!0,inputTarget:null,inputClass:null,preset:[[Gd,{enable:!1}],[lg,{enable:!1},["rotate"]],[ug,{direction:Ri}],[Ut,{direction:Ri},["swipe"]],[xl],[xl,{event:"doubletap",taps:2},["tap"]],[zd]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},$d.prototype={set:function(A){return ce(this.options,A),A.touchAction&&this.touchAction.update(),A.inputTarget&&(this.input.destroy(),this.input.target=A.inputTarget,this.input.init()),this},stop:function(A){this.session.stopped=A?2:1},recognize:function(A){var T=this.session;if(!T.stopped){this.touchAction.preventDefaults(A);var I,P=this.recognizers,q=T.curRecognizer;(!q||q&&8&q.state)&&(q=T.curRecognizer=null);for(var ie=0;ie<P.length;)I=P[ie],2===T.stopped||q&&I!=q&&!I.canRecognizeWith(q)?I.reset():I.recognize(A),!q&&14&I.state&&(q=T.curRecognizer=I),ie++}},get:function(A){if(A instanceof Wr)return A;for(var T=this.recognizers,I=0;I<T.length;I++)if(T[I].options.event==A)return T[I];return null},add:function(A){if(H(A,"add",this))return this;var T=this.get(A.options.event);return T&&this.remove(T),this.recognizers.push(A),A.manager=this,this.touchAction.update(),A},remove:function(A){if(H(A,"remove",this))return this;if(A=this.get(A)){var T=this.recognizers,I=Ae(T,A);-1!==I&&(T.splice(I,1),this.touchAction.update())}return this},on:function(A,T){if(A!==fe&&T!==fe){var I=this.handlers;return Ue(we(A),function(P){I[P]=I[P]||[],I[P].push(T)}),this}},off:function(A,T){if(A!==fe){var I=this.handlers;return Ue(we(A),function(P){T?I[P]&&I[P].splice(Ae(I[P],T),1):delete I[P]}),this}},emit:function(A,T){this.options.domEvents&&function zM(A,T){var I=$t.createEvent("Event");I.initEvent(A,!0,!0),I.gesture=T,T.target.dispatchEvent(I)}(A,T);var I=this.handlers[A]&&this.handlers[A].slice();if(I&&I.length){T.type=A,T.preventDefault=function(){T.srcEvent.preventDefault()};for(var P=0;P<I.length;)I[P](T),P++}},destroy:function(){this.element&&hg(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},ce($r,{INPUT_START:Vn,INPUT_MOVE:2,INPUT_END:Zt,INPUT_CANCEL:jn,STATE_POSSIBLE:Sl,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:vl,DIRECTION_LEFT:bl,DIRECTION_RIGHT:Za,DIRECTION_UP:Qa,DIRECTION_DOWN:ec,DIRECTION_HORIZONTAL:Ri,DIRECTION_VERTICAL:co,DIRECTION_ALL:Tb,Manager:$d,Input:ii,TouchAction:Tl,TouchInput:ge,MouseInput:Jo,PointerEventInput:Zo,TouchMouseInput:kd,SingleTouchInput:Cl,Recognizer:Wr,AttrRecognizer:Ar,Tap:xl,Pan:Ut,Swipe:ug,Pinch:lg,Rotate:Gd,Press:zd,on:_i,off:yi,each:Ue,merge:qt,extend:ft,assign:ce,inherit:gt,bindFn:vn,prefixed:zt}),(typeof xt<"u"?xt:typeof self<"u"?self:{}).Hammer=$r,(Kt=function(){return $r}.call(Pn,qe,Pn,ti))!==fe&&(ti.exports=Kt)}(window,document)},492:()=>{},435:()=>{}},ti=>{ti(ti.s=237)}]);