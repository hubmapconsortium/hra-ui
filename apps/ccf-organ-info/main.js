(self.webpackChunkccf_organ_info=self.webpackChunkccf_organ_info||[]).push([[792],{772:Di=>{"use strict";Di.exports=at,Di.exports.default=at;var ri=1e20;function at(ve,vt,Se,Ze,Te,Ue){this.fontSize=ve||24,this.buffer=void 0===vt?3:vt,this.cutoff=Ze||.25,this.fontFamily=Te||"sans-serif",this.fontWeight=Ue||"normal",this.radius=Se||8;var re=this.size=this.fontSize+2*this.buffer,K=re+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=re,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(K*K),this.gridInner=new Float64Array(K*K),this.f=new Float64Array(K),this.z=new Float64Array(K+1),this.v=new Uint16Array(K),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(re/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function hn(ve,vt,Se,Ze,Te,Ue){for(var re=0;re<vt;re++)si(ve,re,vt,Se,Ze,Te,Ue);for(var K=0;K<Se;K++)si(ve,K*vt,1,vt,Ze,Te,Ue)}function si(ve,vt,Se,Ze,Te,Ue,re){var K,z,Ke,ct;for(Ue[0]=0,re[0]=-ri,re[1]=ri,K=0;K<Ze;K++)Te[K]=ve[vt+K*Se];for(K=1,z=0,Ke=0;K<Ze;K++){do{Ke=(Te[K]-Te[ct=Ue[z]]+K*K-ct*ct)/(K-ct)/2}while(Ke<=re[z]&&--z>-1);Ue[++z]=K,re[z]=Ke,re[z+1]=ri}for(K=0,z=0;K<Ze;K++){for(;re[z+1]<K;)z++;ve[vt+K*Se]=Te[ct=Ue[z]]+(K-ct)*(K-ct)}}at.prototype._draw=function(ve,vt){var Ue,re,K,z,Ke,ct,he,Mt,gn,Se=this.ctx.measureText(ve),Ze=Se.width,Te=2*this.buffer;vt&&this.useMetrics?(Ke=Math.floor(Se.actualBoundingBoxAscent),Mt=this.buffer+Math.ceil(Se.actualBoundingBoxAscent),ct=this.buffer,he=this.buffer,Ue=(re=Math.min(this.size,Math.ceil(Se.actualBoundingBoxRight-Se.actualBoundingBoxLeft)))+Te,K=(z=Math.min(this.size-ct,Math.ceil(Se.actualBoundingBoxAscent+Se.actualBoundingBoxDescent)))+Te,this.ctx.textBaseline="alphabetic"):(Ue=re=this.size,K=z=this.size,Ke=19*this.fontSize/24,ct=he=0,Mt=this.middle,this.ctx.textBaseline="middle"),re&&z&&(this.ctx.clearRect(he,ct,re,z),this.ctx.fillText(ve,this.buffer,Mt),gn=this.ctx.getImageData(he,ct,re,z));var Dt=new Uint8ClampedArray(Ue*K);return function yn(ve,vt,Se,Ze,Te,Ue,re){Ue.fill(ri,0,vt*Se),re.fill(0,0,vt*Se);for(var K=(vt-Ze)/2,z=0;z<Te;z++)for(var Ke=0;Ke<Ze;Ke++){var ct=(z+K)*vt+Ke+K,he=ve.data[4*(z*Ze+Ke)+3]/255;if(1===he)Ue[ct]=0,re[ct]=ri;else if(0===he)Ue[ct]=ri,re[ct]=0;else{var Mt=Math.max(0,.5-he),gn=Math.max(0,he-.5);Ue[ct]=Mt*Mt,re[ct]=gn*gn}}}(gn,Ue,K,re,z,this.gridOuter,this.gridInner),hn(this.gridOuter,Ue,K,this.f,this.v,this.z),hn(this.gridInner,Ue,K,this.f,this.v,this.z),function zt(ve,vt,Se,Ze,Te,Ue,re){for(var K=0;K<vt*Se;K++){var z=Math.sqrt(Ze[K])-Math.sqrt(Te[K]);ve[K]=Math.round(255-255*(z/Ue+re))}}(Dt,Ue,K,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:Dt,metrics:{width:re,height:z,sdfWidth:Ue,sdfHeight:K,top:Ke,left:0,advance:Ze}}},at.prototype.draw=function(ve){return this._draw(ve,!1).data},at.prototype.drawWithMetrics=function(ve){return this._draw(ve,!0)}},725:(Di,ri,at)=>{"use strict";var yn={};at.r(yn),at.d(yn,{decode:()=>j0e,name:()=>U0e});var zt={};at.r(zt),at.d(zt,{name:()=>q0e,preprocess:()=>X0e});var hn={};at.r(hn),at.d(hn,{name:()=>Y0e,preprocess:()=>Z0e});var si={};at.r(si),at.d(si,{decode:()=>Nwe,encode:()=>kwe,name:()=>Owe,preprocess:()=>Pwe});var ve={};at.r(ve),at.d(ve,{decode:()=>Uwe,encode:()=>jwe,name:()=>Vwe});var vt={};at.r(vt),at.d(vt,{decode:()=>zwe,encode:()=>Gwe,name:()=>Hwe});var Se={};function Ze(n,e){return Object.is(n,e)}at.r(Se),at.d(Se,{decode:()=>$we,encode:()=>qwe,name:()=>Wwe});let Te=null,Ue=!1,re=1;const K=Symbol("SIGNAL");function z(n){const e=Te;return Te=n,e}const Mt={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function gn(n){if(Ue)throw new Error("");if(null===Te)return;Te.consumerOnSignalRead(n);const e=Te.nextProducerIndex++;cn(Te),e<Te.producerNode.length&&Te.producerNode[e]!==n&&Rt(Te)&&ze(Te.producerNode[e],Te.producerIndexOfThis[e]),Te.producerNode[e]!==n&&(Te.producerNode[e]=n,Te.producerIndexOfThis[e]=Rt(Te)?Re(n,Te,e):0),Te.producerLastReadVersion[e]=n.version}function Gn(n){if((!Rt(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==re)){if(!n.producerMustRecompute(n)&&!J(n))return n.dirty=!1,void(n.lastCleanEpoch=re);n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=re}}function Mr(n){if(void 0===n.liveConsumerNode)return;const e=Ue;Ue=!0;try{for(const t of n.liveConsumerNode)t.dirty||$i(t)}finally{Ue=e}}function fi(){return!1!==Te?.consumerAllowSignalWrites}function $i(n){n.dirty=!0,Mr(n),n.consumerMarkedDirty?.(n)}function qi(n){return n&&(n.nextProducerIndex=0),z(n)}function Z(n,e){if(z(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(Rt(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)ze(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function J(n){cn(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(Gn(t),i!==t.version))return!0}return!1}function De(n){if(cn(n),Rt(n))for(let e=0;e<n.producerNode.length;e++)ze(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function Re(n,e,t){if(Gt(n),0===n.liveConsumerNode.length&&vn(n))for(let i=0;i<n.producerNode.length;i++)n.producerIndexOfThis[i]=Re(n.producerNode[i],n,i);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function ze(n,e){if(Gt(n),1===n.liveConsumerNode.length&&vn(n))for(let i=0;i<n.producerNode.length;i++)ze(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];cn(r),r.producerIndexOfThis[i]=e}}function Rt(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function cn(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function Gt(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function vn(n){return void 0!==n.producerNode}const pi=Symbol("UNSET"),ai=Symbol("COMPUTING"),bt=Symbol("ERRORED"),Ri={...Mt,value:pi,dirty:!0,error:null,equal:Ze,producerMustRecompute:n=>n.value===pi||n.value===ai,producerRecomputeValue(n){if(n.value===ai)throw new Error("Detected cycle in computations.");const e=n.value;n.value=ai;const t=qi(n);let i;try{i=n.computation()}catch(r){i=bt,n.error=r}finally{Z(n,t)}e!==pi&&e!==bt&&i!==bt&&n.equal(e,i)?n.value=e:(n.value=i,n.version++)}};let _m=function Ir(){throw new Error};function lu(){_m()}let uu=null;function mi(n,e){fi()||lu(),n.equal(n.value,e)||(n.value=e,function Uc(n){n.version++,function Dt(){re++}(),Mr(n),uu?.()}(n))}const Vc={...Mt,equal:Ze,value:void 0};function $e(n){return"function"==typeof n}function Da(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Oi=Da(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function fu(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class kt{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if($e(i))try{i()}catch(s){e=s instanceof Oi?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{bm(s)}catch(o){e=e??[],o instanceof Oi?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Oi(e)}}add(e){var t;if(e&&e!==this)if(this.closed)bm(e);else{if(e instanceof kt){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&fu(t,e)}remove(e){const{_finalizers:t}=this;t&&fu(t,e),e instanceof kt&&e._removeParent(this)}}kt.EMPTY=(()=>{const n=new kt;return n.closed=!0,n})();const ym=kt.EMPTY;function vm(n){return n instanceof kt||n&&"closed"in n&&$e(n.remove)&&$e(n.add)&&$e(n.unsubscribe)}function bm(n){$e(n)?n():n.unsubscribe()}const Zr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Hc={setTimeout(n,e,...t){const{delegate:i}=Hc;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=Hc;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Bh(n){Hc.setTimeout(()=>{const{onUnhandledError:e}=Zr;if(!e)throw n;e(n)})}function zc(){}const pu=Uh("C",void 0,void 0);function Uh(n,e,t){return{kind:n,value:e,error:t}}let Uo=null;function gu(n){if(Zr.useDeprecatedSynchronousErrorHandling){const e=!Uo;if(e&&(Uo={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Uo;if(Uo=null,t)throw i}}else n()}class Ra extends kt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,vm(e)&&e.add(this)):this.destination=pw}static create(e,t,i){return new jo(e,t,i)}next(e){this.isStopped?Hh(function uw(n){return Uh("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Hh(function Vh(n){return Uh("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Hh(pu,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const hw=Function.prototype.bind;function jh(n,e){return hw.call(n,e)}class wm{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Oa(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Oa(i)}else Oa(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Oa(t)}}}class jo extends Ra{constructor(e,t,i){let r;if(super(),$e(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&Zr.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&jh(e.next,s),error:e.error&&jh(e.error,s),complete:e.complete&&jh(e.complete,s)}):r=e}this.destination=new wm(r)}}function Oa(n){Zr.useDeprecatedSynchronousErrorHandling?function dw(n){Zr.useDeprecatedSynchronousErrorHandling&&Uo&&(Uo.errorThrown=!0,Uo.error=n)}(n):Bh(n)}function Hh(n,e){const{onStoppedNotification:t}=Zr;t&&Hc.setTimeout(()=>t(n,e))}const pw={closed:!0,next:zc,error:function fw(n){throw n},complete:zc},mu="function"==typeof Symbol&&Symbol.observable||"@@observable";function Ys(n){return n}let be=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function Am(n){return n&&n instanceof Ra||function mw(n){return n&&$e(n.next)&&$e(n.error)&&$e(n.complete)}(n)&&vm(n)}(t)?t:new jo(t,i,r);return gu(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=Cm(i))((r,s)=>{const o=new jo({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[mu](){return this}pipe(...t){return function Em(n){return 0===n.length?Ys:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=Cm(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function Cm(n){var e;return null!==(e=n??Zr.Promise)&&void 0!==e?e:Promise}const zh=Da(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let fe=(()=>{class n extends be{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Gh(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new zh}next(t){gu(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){gu(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){gu(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?ym:(this.currentObservers=null,s.push(t),new kt(()=>{this.currentObservers=null,fu(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new be;return t.source=this,t}}return n.create=(e,t)=>new Gh(e,t),n})();class Gh extends fe{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:ym}}class On extends fe{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function Wh(n){return $e(n?.lift)}function Ft(n){return e=>{if(Wh(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function It(n,e,t,i,r){return new Tm(n,e,t,i,r)}class Tm extends Ra{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function le(n,e){return Ft((t,i)=>{let r=0;t.subscribe(It(i,s=>{i.next(n.call(e,s,r++))}))})}typeof navigator<"u"&&navigator,typeof navigator<"u"&&!/Opera/.test(navigator.userAgent)&&navigator,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||navigator),typeof navigator<"u"&&!/Opera|WebKit/.test(navigator.userAgent)&&navigator,typeof navigator<"u"&&navigator;const TR="https://g.co/ng/security#xss";class H extends Error{constructor(e,t){super(function bu(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function Go(n){return{toString:n}.toString()}const Eu="__parameters__";function Au(n,e,t){return Go(()=>{const i=function Cw(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(c,l,u){const d=c.hasOwnProperty(Eu)?c[Eu]:Object.defineProperty(c,Eu,{value:[]})[Eu];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),c}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}const Lt=globalThis;function Ot(n){for(let e in n)if(n[e]===Ot)return e;throw Error("Could not find renamed property on target object.")}function wq(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function qn(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(qn).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Aw(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const Eq=Ot({__forward_ref__:Ot});function Bt(n){return n.__forward_ref__=Bt,n.toString=function(){return qn(this())},n}function Oe(n){return km(n)?n():n}function km(n){return"function"==typeof n&&n.hasOwnProperty(Eq)&&n.__forward_ref__===Bt}function j(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ln(n){return{providers:n.providers||[],imports:n.imports||[]}}function Fm(n){return IR(n,Bm)||IR(n,DR)}function IR(n,e){return n.hasOwnProperty(e)?n[e]:null}function Lm(n){return n&&(n.hasOwnProperty(Tw)||n.hasOwnProperty(Mq))?n[Tw]:null}const Bm=Ot({\u0275prov:Ot}),Tw=Ot({\u0275inj:Ot}),DR=Ot({ngInjectableDef:Ot}),Mq=Ot({ngInjectorDef:Ot});class k{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=j({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Dw(n){return n&&!!n.\u0275providers}const Jh=Ot({\u0275cmp:Ot}),Rw=Ot({\u0275dir:Ot}),Ow=Ot({\u0275pipe:Ot}),Wo=Ot({\u0275fac:Ot}),Qh=Ot({__NG_ELEMENT_ID__:Ot}),PR=Ot({__NG_ENV_ID__:Ot});function Be(n){return"string"==typeof n?n:null==n?"":String(n)}function Pw(n,e){throw new H(-201,!1)}var rt=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(rt||{});let Nw;function NR(){return Nw}function dr(n){const e=Nw;return Nw=n,e}function kR(n,e,t){const i=Fm(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&rt.Optional?null:void 0!==e?e:void Pw()}const ef={},kw="__NG_DI_FLAG__",Vm="ngTempTokenPath",Nq=/\n/gm,FR="__source";let Tu;function La(n){const e=Tu;return Tu=n,e}function Lq(n,e=rt.Default){if(void 0===Tu)throw new H(-203,!1);return null===Tu?kR(n,void 0,e):Tu.get(n,e&rt.Optional?null:void 0,e)}function O(n,e=rt.Default){return(NR()||Lq)(Oe(n),e)}function D(n,e=rt.Default){return O(n,Um(e))}function Um(n){return typeof n>"u"||"number"==typeof n?n:(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Fw(n){const e=[];for(let t=0;t<n.length;t++){const i=Oe(n[t]);if(Array.isArray(i)){if(0===i.length)throw new H(900,!1);let r,s=rt.Default;for(let o=0;o<i.length;o++){const a=i[o],c=Bq(a);"number"==typeof c?-1===c?r=a.token:s|=c:r=a}e.push(O(r,s))}else e.push(O(i))}return e}function tf(n,e){return n[kw]=e,n.prototype[kw]=e,n}function Bq(n){return n[kw]}const xu=tf(Au("Optional"),8),jm=tf(Au("SkipSelf"),4);function $c(n,e){return n.hasOwnProperty(Wo)?n[Wo]:null}function Su(n,e){n.forEach(t=>Array.isArray(t)?Su(t,e):e(t))}function BR(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Hm(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Pr(n,e,t){let i=Mu(n,e);return i>=0?n[1|i]=t:(i=~i,function VR(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function Bw(n,e){const t=Mu(n,e);if(t>=0)return n[1|t]}function Mu(n,e){return function UR(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const Zs={},ft=[],fr=new k(""),Gm=new k("",-1),Vw=new k("");class Wm{get(e,t=ef){if(t===ef){const i=new Error(`NullInjectorError: No provider for ${qn(e)}!`);throw i.name="NullInjectorError",i}return t}}var $m=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}($m||{}),As=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(As||{}),Ba=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(Ba||{});function Wq(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function Uw(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];HR(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function jR(n){return 3===n||4===n||6===n}function HR(n){return 64===n.charCodeAt(0)}function nf(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||zR(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function zR(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const GR="ng-template";function $q(n,e,t,i){let r=0;if(i){for(;r<e.length&&"string"==typeof e[r];r+=2)if("class"===e[r]&&-1!==Wq(e[r+1].toLowerCase(),t,0))return!0}else if(jw(n))return!1;if(r=e.indexOf(1,r),r>-1){let s;for(;++r<e.length&&"string"==typeof(s=e[r]);)if(s.toLowerCase()===t)return!0}return!1}function jw(n){return 4===n.type&&n.value!==GR}function qq(n,e,t){return e===(4!==n.type||t?n.value:GR)}function Xq(n,e,t){let i=4;const r=n.attrs,s=null!==r?function Kq(n){for(let e=0;e<n.length;e++)if(jR(n[e]))return e;return n.length}(r):0;let o=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!o)if(4&i){if(i=2|1&i,""!==c&&!qq(n,c,t)||""===c&&1===e.length){if(Ts(i))return!1;o=!0}}else if(8&i){if(null===r||!$q(n,r,c,t)){if(Ts(i))return!1;o=!0}}else{const l=e[++a],u=Yq(c,r,jw(n),t);if(-1===u){if(Ts(i))return!1;o=!0;continue}if(""!==l){let d;if(d=u>s?"":r[u+1].toLowerCase(),2&i&&l!==d){if(Ts(i))return!1;o=!0}}}}else{if(!o&&!Ts(i)&&!Ts(c))return!1;if(o&&Ts(c))continue;o=!1,i=c|1&i}}return Ts(i)||o}function Ts(n){return!(1&n)}function Yq(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function Jq(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function WR(n,e,t=!1){for(let i=0;i<e.length;i++)if(Xq(n,e[i],t))return!0;return!1}function Qq(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function $R(n,e){return n?":not("+e.trim()+")":e}function eX(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Ts(o)&&(e+=$R(s,r),r=""),i=o,s=s||!Ts(i);t++}return""!==r&&(e+=$R(s,r)),e}function Yt(n){return Go(()=>{const e=XR(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===$m.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||As.Emulated,styles:n.styles||ft,_:null,schemas:n.schemas||null,tView:null,id:""};YR(t);const i=n.dependencies;return t.directiveDefs=qm(i,!1),t.pipeDefs=qm(i,!0),t.id=function oX(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)|0;return e+=2147483648,"c"+e}(t),t})}function iX(n){return Qe(n)||Xn(n)}function rX(n){return null!==n}function fn(n){return Go(()=>({type:n.type,bootstrap:n.bootstrap||ft,declarations:n.declarations||ft,imports:n.imports||ft,exports:n.exports||ft,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function qR(n,e){if(null==n)return Zs;const t={};for(const i in n)if(n.hasOwnProperty(i)){const r=n[i];let s,o,a=Ba.None;Array.isArray(r)?(a=r[0],s=r[1],o=r[2]??s):(s=r,o=r),e?(t[s]=a!==Ba.None?[i,a]:i,e[s]=o):t[s]=i}return t}function se(n){return Go(()=>{const e=XR(n);return YR(e),e})}function Pi(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Qe(n){return n[Jh]||null}function Xn(n){return n[Rw]||null}function yi(n){return n[Ow]||null}function XR(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Zs,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||ft,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:qR(n.inputs,e),outputs:qR(n.outputs),debugInfo:null}}function YR(n){n.features?.forEach(e=>e(n))}function qm(n,e){if(!n)return null;const t=e?yi:iX;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(rX)}function qc(n){return{\u0275providers:n}}function ZR(...n){return{\u0275providers:Hw(0,n),\u0275fromNgModule:!0}}function Hw(n,...e){const t=[],i=new Set;let r;const s=o=>{t.push(o)};return Su(e,o=>{const a=o;Xm(a,s,[],i)&&(r||=[],r.push(a))}),void 0!==r&&KR(r,s),t}function KR(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];zw(r,s=>{e(s,i)})}}function Xm(n,e,t,i){if(!(n=Oe(n)))return!1;let r=null,s=Lm(n);const o=!s&&Qe(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const c=n.ngModule;if(s=Lm(c),!s)return!1;r=c}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const c="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of c)Xm(l,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;i.add(r);try{Su(s.imports,u=>{Xm(u,e,t,i)&&(l||=[],l.push(u))})}finally{}void 0!==l&&KR(l,e)}if(!a){const l=$c(r)||(()=>new r);e({provide:r,useFactory:l,deps:ft},r),e({provide:Vw,useValue:r,multi:!0},r),e({provide:fr,useValue:()=>O(r),multi:!0},r)}const c=s.providers;if(null!=c&&!a){const l=n;zw(c,u=>{e(u,l)})}}}return r!==n&&void 0!==n.providers}function zw(n,e){for(let t of n)Dw(t)&&(t=t.\u0275providers),Array.isArray(t)?zw(t,e):e(t)}const aX=Ot({provide:String,useValue:Ot});function Gw(n){return null!==n&&"object"==typeof n&&aX in n}function Xc(n){return"function"==typeof n}const Ww=new k(""),Ym={},lX={};let $w;function Zm(){return void 0===$w&&($w=new Wm),$w}class ki{}class Iu extends ki{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Xw(e,o=>this.processProvider(o)),this.records.set(Gm,Du(void 0,this)),r.has("environment")&&this.records.set(ki,Du(void 0,this));const s=this.records.get(Ww);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Vw,ft,rt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;const e=z(null);try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),z(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=La(this),i=dr(void 0);try{return e()}finally{La(t),dr(i)}}get(e,t=ef,i=rt.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(PR))return e[PR](this);i=Um(i);const s=La(this),o=dr(void 0);try{if(!(i&rt.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function pX(n){return"function"==typeof n||"object"==typeof n&&n instanceof k}(e)&&Fm(e);c=l&&this.injectableDefInScope(l)?Du(qw(e),Ym):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(i&rt.Self?Zm():this.parent).get(e,t=i&rt.Optional&&t===ef?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[Vm]=a[Vm]||[]).unshift(qn(e)),s)throw a;return function Vq(n,e,t,i){const r=n[Vm];throw e[FR]&&r.unshift(e[FR]),n.message=function Uq(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=qn(e);if(Array.isArray(e))r=e.map(qn).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):qn(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(Nq,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Vm]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{dr(o),La(s)}}resolveInjectorInitializers(){const e=z(null),t=La(this),i=dr(void 0);try{const s=this.get(fr,ft,rt.Self);for(const o of s)o()}finally{La(t),dr(i),z(e)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(qn(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new H(205,!1)}processProvider(e){let t=Xc(e=Oe(e))?e:Oe(e&&e.provide);const i=function dX(n){return Gw(n)?Du(void 0,n.useValue):Du(eO(n),Ym)}(e);if(!Xc(e)&&!0===e.multi){let r=this.records.get(t);r||(r=Du(void 0,Ym,!0),r.factory=()=>Fw(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){const i=z(null);try{return t.value===Ym&&(t.value=lX,t.value=t.factory()),"object"==typeof t.value&&t.value&&function fX(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{z(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Oe(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function qw(n){const e=Fm(n),t=null!==e?e.factory:$c(n);if(null!==t)return t;if(n instanceof k)throw new H(204,!1);if(n instanceof Function)return function uX(n){if(n.length>0)throw new H(204,!1);const t=function Sq(n){return n&&(n[Bm]||n[DR])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new H(204,!1)}function eO(n,e,t){let i;if(Xc(n)){const r=Oe(n);return $c(r)||qw(r)}if(Gw(n))i=()=>Oe(n.useValue);else if(function QR(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Fw(n.deps||[]));else if(function JR(n){return!(!n||!n.useExisting)}(n))i=()=>O(Oe(n.useExisting));else{const r=Oe(n&&(n.useClass||n.provide));if(!function hX(n){return!!n.deps}(n))return $c(r)||qw(r);i=()=>new r(...Fw(n.deps))}return i}function Du(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Xw(n,e){for(const t of n)Array.isArray(t)?Xw(t,e):t&&Dw(t)?Xw(t.\u0275providers,e):e(t)}function es(n,e){n instanceof Iu&&n.assertNotDestroyed();const i=La(n),r=dr(void 0);try{return e()}finally{La(i),dr(r)}}function tO(){return void 0!==NR()||null!=function Fq(){return Tu}()}function rf(n){if(!tO())throw new H(-203,!1)}const un=0,Y=1,Ee=2,Pn=3,xs=4,vi=5,Xi=6,Ou=7,Zt=8,Nn=9,Ks=10,Pe=11,af=12,iO=13,Pu=14,dn=15,Yc=16,Nu=17,$o=18,ku=19,rO=20,Ua=21,Jm=22,ts=23,ge=25,Zw=1,Js=7,Fu=9,wn=10;var e_=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(e_||{});function Zn(n){return Array.isArray(n)&&"object"==typeof n[Zw]}function Fi(n){return Array.isArray(n)&&!0===n[Zw]}function Kw(n){return!!(4&n.flags)}function Zc(n){return n.componentOffset>-1}function t_(n){return!(1&~n.flags)}function Ss(n){return!!n.template}function lf(n){return!!(512&n[Ee])}class lO{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function uO(n,e,t,i){null!==e?e.applyValueToInputSignal(e,i):n[t]=i}function Kn(){return dO}function dO(n){return n.type.prototype.ngOnChanges&&(n.setInput=SX),xX}function xX(){const n=fO(this),e=n?.current;if(e){const t=n.previous;if(t===Zs)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function SX(n,e,t,i,r){const s=this.declaredInputs[i],o=fO(n)||function MX(n,e){return n[hO]=e}(n,{previous:Zs,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new lO(l&&l.currentValue,t,c===Zs),uO(n,e,r,t)}Kn.ngInherit=!0;const hO="__ngSimpleChanges__";function fO(n){return n[hO]||null}const Qs=function(n,e,t){},pO="svg";function pt(n){for(;Array.isArray(n);)n=n[un];return n}function uf(n,e){return pt(e[n])}function Yi(n,e){return pt(e[n.index])}function df(n,e){return n.data[e]}function Kc(n,e){return n[e]}function Nr(n,e){const t=e[n];return Zn(t)?t:t[un]}function nE(n){return!(128&~n[Ee])}function ns(n,e){return null==e?null:n[e]}function mO(n){n[Nu]=0}function _O(n){1024&n[Ee]||(n[Ee]|=1024,nE(n)&&n_(n))}function hf(n){return!!(9216&n[Ee]||n[ts]?.dirty)}function iE(n){n[Ks].changeDetectionScheduler?.notify(7),64&n[Ee]&&(n[Ee]|=1024),hf(n)&&n_(n)}function n_(n){n[Ks].changeDetectionScheduler?.notify(0);let e=qo(n);for(;null!==e&&!(8192&e[Ee])&&(e[Ee]|=8192,nE(e));)e=qo(e)}function i_(n,e){if(!(256&~n[Ee]))throw new H(911,!1);null===n[Ua]&&(n[Ua]=[]),n[Ua].push(e)}function qo(n){const e=n[Pn];return Fi(e)?e[Pn]:e}const Ne={lFrame:DO(null),bindingsEnabled:!0,skipHydrationRootTNode:null};let vO=!1;function bO(){return Ne.bindingsEnabled}function Jc(){return null!==Ne.skipHydrationRootTNode}function B(){return Ne.lFrame.lView}function qe(){return Ne.lFrame.tView}function En(n){return Ne.lFrame.contextLView=n,n[Zt]}function Cn(n){return Ne.lFrame.contextLView=null,n}function Pt(){let n=wO();for(;null!==n&&64===n.type;)n=n.parent;return n}function wO(){return Ne.lFrame.currentTNode}function Ms(n,e){const t=Ne.lFrame;t.currentTNode=n,t.isParent=e}function oE(){return Ne.lFrame.isParent}function aE(){Ne.lFrame.isParent=!1}function AO(){return vO}function TO(n){vO=n}function Zi(){const n=Ne.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Is(){return Ne.lFrame.bindingIndex++}function Yo(n){const e=Ne.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function HX(n,e){const t=Ne.lFrame;t.bindingIndex=t.bindingRootIndex=n,cE(e)}function cE(n){Ne.lFrame.currentDirectiveIndex=n}function uE(){return Ne.lFrame.currentQueryIndex}function s_(n){Ne.lFrame.currentQueryIndex=n}function GX(n){const e=n[Y];return 2===e.type?e.declTNode:1===e.type?n[vi]:null}function MO(n,e,t){if(t&rt.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&rt.Host||(r=GX(s),null===r||(s=s[Pu],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Ne.lFrame=IO();return i.currentTNode=e,i.lView=n,!0}function dE(n){const e=IO(),t=n[Y];Ne.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function IO(){const n=Ne.lFrame,e=null===n?null:n.child;return null===e?DO(n):e}function DO(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function RO(){const n=Ne.lFrame;return Ne.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const OO=RO;function hE(){const n=RO();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function bi(){return Ne.lFrame.selectedIndex}function Qc(n){Ne.lFrame.selectedIndex=n}function Kt(){const n=Ne.lFrame;return df(n.tView,n.selectedIndex)}function o_(){Ne.lFrame.currentNamespace=pO}let NO=!0;function pf(){return NO}function eo(n){NO=n}function a_(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),null!=u&&(n.destroyHooks??=[]).push(t,u)}}function c_(n,e,t){kO(n,e,3,t)}function l_(n,e,t,i){(3&n[Ee])===t&&kO(n,e,t,i)}function fE(n,e){let t=n[Ee];(3&t)===e&&(t&=16383,t+=1,n[Ee]=t)}function kO(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let c=void 0!==i?65535&n[Nu]:0;c<o;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=i&&a>=i)break}else e[c]<0&&(n[Nu]+=65536),(a<s||-1==s)&&(ZX(n,t,e,c),n[Nu]=(4294901760&n[Nu])+c+2),c++}function FO(n,e){Qs(4,n,e);const t=z(null);try{e.call(n)}finally{z(t),Qs(5,n,e)}}function ZX(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];r?n[Ee]>>14<n[Nu]>>16&&(3&n[Ee])===e&&(n[Ee]+=16384,FO(a,s)):FO(a,s)}const Lu=-1;class gf{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}const gE={};class el{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Um(i);const r=this.injector.get(e,gE,i);return r!==gE||t===gE?r:this.parentInjector.get(e,t,i)}}function mE(n){return n!==Lu}function mf(n){return 32767&n}function _f(n,e){let t=function eY(n){return n>>16}(n),i=e;for(;t>0;)i=i[Pu],t--;return i}let _E=!0;function u_(n){const e=_E;return _E=n,e}const BO=255,VO=5;let nY=0;const to={};function d_(n,e){const t=UO(n,e);if(-1!==t)return t;const i=e[Y];i.firstCreatePass&&(n.injectorIndex=e.length,yE(i.data,n),yE(e,null),yE(i.blueprint,null));const r=h_(n,e),s=n.injectorIndex;if(mE(r)){const o=mf(r),a=_f(r,e),c=a[Y].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=r,s}function yE(n,e){n.push(0,0,0,0,0,0,0,0,e)}function UO(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function h_(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=qO(r),null===i)return Lu;if(t++,r=r[Pu],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return Lu}function vE(n,e,t){!function iY(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Qh)&&(i=t[Qh]),null==i&&(i=t[Qh]=nY++);const r=i&BO;e.data[n+(r>>VO)]|=1<<r}(n,e,t)}function jO(n,e,t){if(t&rt.Optional||void 0!==n)return n;Pw()}function HO(n,e,t,i){if(t&rt.Optional&&void 0===i&&(i=null),!(t&(rt.Self|rt.Host))){const r=n[Nn],s=dr(void 0);try{return r?r.get(e,i,t&rt.Optional):kR(e,i,t&rt.Optional)}finally{dr(s)}}return jO(i,0,t)}function zO(n,e,t,i=rt.Default,r){if(null!==n){if(2048&e[Ee]&&!(i&rt.Self)){const o=function cY(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[Ee]&&!(512&o[Ee]);){const a=GO(s,o,t,i|rt.Self,to);if(a!==to)return a;let c=s.parent;if(!c){const l=o[rO];if(l){const u=l.get(t,to,i);if(u!==to)return u}c=qO(o),o=o[Pu]}s=c}return r}(n,e,t,i,to);if(o!==to)return o}const s=GO(n,e,t,i,to);if(s!==to)return s}return HO(e,t,i,r)}function GO(n,e,t,i,r){const s=function oY(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Qh)?n[Qh]:void 0;return"number"==typeof e?e>=0?e&BO:aY:e}(t);if("function"==typeof s){if(!MO(e,n,i))return i&rt.Host?jO(r,0,i):HO(e,t,i,r);try{let o;if(o=s(i),null!=o||i&rt.Optional)return o;Pw()}finally{OO()}}else if("number"==typeof s){let o=null,a=UO(n,e),c=Lu,l=i&rt.Host?e[dn][vi]:null;for((-1===a||i&rt.SkipSelf)&&(c=-1===a?h_(n,e):e[a+8],c!==Lu&&$O(i,!1)?(o=e[Y],a=mf(c),e=_f(c,e)):a=-1);-1!==a;){const u=e[Y];if(WO(s,a,u.data)){const d=sY(a,e,t,o,i,l);if(d!==to)return d}c=e[a+8],c!==Lu&&$O(i,e[Y].data[a+8]===l)&&WO(s,a,e)?(o=u,a=mf(c),e=_f(c,e)):a=-1}}return r}function sY(n,e,t,i,r,s){const o=e[Y],a=o.data[n+8],u=f_(a,o,t,null==i?Zc(a)&&_E:i!=o&&!!(3&a.type),r&rt.Host&&s===a);return null!==u?tl(e,o,u,a):to}function f_(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,c=n.directiveStart,u=s>>20,h=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<h;f++){const p=o[f];if(f<c&&t===p||f>=c&&p.type===t)return f}if(r){const f=o[c];if(f&&Ss(f)&&f.type===t)return c}return null}function tl(n,e,t,i){let r=n[t];const s=e.data;if(function KX(n){return n instanceof gf}(r)){const o=r;o.resolving&&function Rq(n,e){throw e&&e.join(" > "),new H(-200,n)}(function Ct(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Be(n)}(s[t]));const a=u_(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?dr(o.injectImpl):null;MO(n,i,rt.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function YX(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=dO(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==l&&dr(l),u_(a),o.resolving=!1,OO()}}return r}function WO(n,e,t){return!!(t[e+(n>>VO)]&1<<n)}function $O(n,e){return!(n&rt.Self||n&rt.Host&&e)}class Jn{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return zO(this._tNode,this._lView,e,Um(i),t)}}function aY(){return new Jn(Pt(),B())}function rn(n){return Go(()=>{const e=n.prototype.constructor,t=e[Wo]||bE(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Wo]||bE(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function bE(n){return km(n)?()=>{const e=bE(Oe(n));return e&&e()}:$c(n)}function qO(n){const e=n[Y],t=e.type;return 2===t?e.declTNode:1===t?n[vi]:null}function ja(n){return function rY(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(jR(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Pt(),n)}function JO(n,e=null,t=null,i){const r=function QO(n,e=null,t=null,i,r=new Set){const s=[t||ft,ZR(n)];return i=i||("object"==typeof n?void 0:qn(n)),new Iu(s,e||Zm(),i||null,r)}(n,e,t,i);return r.resolveInjectorInitializers(),r}class gt{static{this.THROW_IF_NOT_FOUND=ef}static{this.NULL=new Wm}static create(e,t){if(Array.isArray(e))return JO({name:""},t,e,"");{const i=e.name??"";return JO({name:i},e.parent,e.providers,i)}}static{this.\u0275prov=j({token:gt,providedIn:"any",factory:()=>O(Gm)})}static{this.__NG_ELEMENT_ID__=-1}}new k("").__NG_ELEMENT_ID__=n=>{const e=Pt();if(null===e)throw new H(204,!1);if(2&e.type)return e.value;if(n&rt.Optional)return null;throw new H(204,!1)};function EE(n){return n.ngOriginalError}const tP=!0;let nl=(()=>{class n{static{this.__NG_ELEMENT_ID__=yY}static{this.__NG_ENV_ID__=t=>t}}return n})();class _Y extends nl{constructor(e){super(),this._lView=e}onDestroy(e){return i_(this._lView,e),()=>function rE(n,e){if(null===n[Ua])return;const t=n[Ua].indexOf(e);-1!==t&&n[Ua].splice(t,1)}(this._lView,e)}}function yY(){return new _Y(B())}let Zo=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new On(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=j({token:n,providedIn:"root",factory:()=>new n})}}return n})();const Ae=class vY extends fe{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,tO()&&(this.destroyRef=D(nl,{optional:!0})??void 0,this.pendingTasks=D(Zo,{optional:!0})??void 0)}emit(e){const t=z(null);try{super.next(e)}finally{z(t)}}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const c=e;r=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),r&&(r=this.wrapInTimeout(r)),o&&(o=this.wrapInTimeout(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof kt&&e.add(a),a}wrapInTimeout(e){return t=>{const i=this.pendingTasks?.add();setTimeout(()=>{e(t),void 0!==i&&this.pendingTasks?.remove(i)})}}};function g_(...n){}function nP(n){let e,t;function i(){n=g_;try{void 0!==t&&"function"==typeof cancelAnimationFrame&&cancelAnimationFrame(t),void 0!==e&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),"function"==typeof requestAnimationFrame&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function iP(n){return queueMicrotask(()=>n()),()=>{n=g_}}const CE="isAngularZone",m_=CE+"_ID";let bY=0;class ye{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ae(!1),this.onMicrotaskEmpty=new Ae(!1),this.onStable=new Ae(!1),this.onError=new Ae(!1);const{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:s=tP}=e;if(typeof Zone>"u")throw new H(908,!1);Zone.assertZonePatched();const o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&i,o.shouldCoalesceRunChangeDetection=r,o.callbackScheduled=!1,o.scheduleInRootZone=s,function CY(n){const e=()=>{!function EY(n){function e(){nP(()=>{n.callbackScheduled=!1,TE(n),n.isCheckStableRunning=!0,AE(n),n.isCheckStableRunning=!1})}n.isCheckStableRunning||n.callbackScheduled||(n.callbackScheduled=!0,n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),TE(n))}(n)},t=bY++;n._inner=n._inner.fork({name:"angular",properties:{[CE]:!0,[m_]:t,[m_+t]:!0},onInvokeTask:(i,r,s,o,a,c)=>{if(function AY(n){return oP(n,"__ignore_ng_zone__")}(c))return i.invokeTask(s,o,a,c);try{return rP(n),i.invokeTask(s,o,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||n.shouldCoalesceRunChangeDetection)&&e(),sP(n)}},onInvoke:(i,r,s,o,a,c,l)=>{try{return rP(n),i.invoke(s,o,a,c,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!function TY(n){return oP(n,"__scheduler_tick__")}(c)&&e(),sP(n)}},onHasTask:(i,r,s,o)=>{i.hasTask(s,o),r===s&&("microTask"==o.change?(n._hasPendingMicrotasks=o.microTask,TE(n),AE(n)):"macroTask"==o.change&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(i,r,s,o)=>(i.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}(o)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get(CE)}static assertInAngularZone(){if(!ye.isInAngularZone())throw new H(909,!1)}static assertNotInAngularZone(){if(ye.isInAngularZone())throw new H(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,wY,g_,g_);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const wY={};function AE(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function TE(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&!0===n.callbackScheduled)}function rP(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function sP(n){n._nesting--,AE(n)}class xE{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ae,this.onMicrotaskEmpty=new Ae,this.onStable=new Ae,this.onError=new Ae}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}function oP(n,e){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0]?.data?.[e]}class pr{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&EE(e);for(;t&&EE(t);)t=EE(t);return t||null}}const SY=new k("",{providedIn:"root",factory:()=>{const n=D(ye),e=D(pr);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function IY(){return Uu(Pt(),B())}function Uu(n,e){return new At(Yi(n,e))}let At=(()=>{class n{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=IY}}return n})();function cP(n){return n instanceof At?n.nativeElement:n}function DY(){return this._results[Symbol.iterator]()}class ju{get changes(){return this._changes??=new Ae}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const t=ju.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=DY)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;const i=function hr(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function Gq(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}function vf(n){return!(128&~n.flags)}const ME=new Map;let OY=0;const __="__ngContext__";function Li(n,e){Zn(e)?(n[__]=e[ku],function NY(n){ME.set(n[ku],n)}(e)):n[__]=e}function yP(n){return bP(n[af])}function vP(n){return bP(n[xs])}function bP(n){for(;null!==n&&!Fi(n);)n=n[xs];return n}let DE;const zu=new k("",{providedIn:"root",factory:()=>JY}),JY="ng",MP=new k(""),is=new k("",{providedIn:"platform",factory:()=>"unknown"}),il=new k(""),v_=new k("",{providedIn:"root",factory:()=>function Ha(){if(void 0!==DE)return DE;if(typeof document<"u")return document;throw new H(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let IP=()=>null;function LE(n,e,t=!1){return IP(n,e,t)}const LP=new k("",{providedIn:"root",factory:()=>!1});let S_;function $u(n){return function HE(){if(void 0===S_&&(S_=null,Lt.trustedTypes))try{S_=Lt.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return S_}()?.createHTML(n)||n}class sl{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${TR})`}}class hZ extends sl{getTypeName(){return"HTML"}}class fZ extends sl{getTypeName(){return"Style"}}class pZ extends sl{getTypeName(){return"Script"}}class gZ extends sl{getTypeName(){return"URL"}}class mZ extends sl{getTypeName(){return"ResourceURL"}}function kr(n){return n instanceof sl?n.changingThisBreaksApplicationSecurity:n}function no(n,e){const t=function _Z(n){return n instanceof sl&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${TR})`)}return t===e}class CZ{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString($u(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.firstChild?.remove(),t)}catch{return null}}}class AZ{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=$u(e),t}}const xZ=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function I_(n){return(n=String(n)).match(xZ)?n:"unsafe:"+n}function Ko(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function xf(...n){const e={};for(const t of n)for(const i in t)t.hasOwnProperty(i)&&(e[i]=!0);return e}const GP=Ko("area,br,col,hr,img,wbr"),WP=Ko("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),$P=Ko("rp,rt"),GE=xf(GP,xf(WP,Ko("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),xf($P,Ko("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),xf($P,WP)),WE=Ko("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),qP=xf(WE,Ko("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Ko("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),SZ=Ko("script,style,template");class MZ{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,i=!0,r=[];for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)r.push(t),t=RZ(t);else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let s=DZ(t);if(s){t=s;break}t=r.pop()}return this.buf.join("")}startElement(e){const t=XP(e).toLowerCase();if(!GE.hasOwnProperty(t))return this.sanitizedSomething=!0,!SZ.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),o=s.name,a=o.toLowerCase();if(!qP.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=s.value;WE[a]&&(c=I_(c)),this.buf.push(" ",o,'="',ZP(c),'"')}return this.buf.push(">"),!0}endElement(e){const t=XP(e).toLowerCase();GE.hasOwnProperty(t)&&!GP.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(ZP(e))}}function DZ(n){const e=n.nextSibling;if(e&&n!==e.previousSibling)throw YP(e);return e}function RZ(n){const e=n.firstChild;if(e&&function IZ(n,e){return(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}(n,e))throw YP(e);return e}function XP(n){const e=n.nodeName;return"string"==typeof e?e:"FORM"}function YP(n){return new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`)}const OZ=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,PZ=/([^\#-~ |!])/g;function ZP(n){return n.replace(/&/g,"&amp;").replace(OZ,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(PZ,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let D_;function KP(n,e){let t=null;try{D_=D_||function zP(n){const e=new AZ(n);return function TZ(){try{return!!(new window.DOMParser).parseFromString($u(""),"text/html")}catch{return!1}}()?new CZ(e):e}(n);let i=e?String(e):"";t=D_.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=t.innerHTML,t=D_.getInertBodyElement(i)}while(i!==s);return $u((new MZ).sanitizeChildren($E(t)||t))}finally{if(t){const i=$E(t)||t;for(;i.firstChild;)i.firstChild.remove()}}}function $E(n){return"content"in n&&function NZ(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var wi=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(wi||{});function qE(n){const e=function Sf(){const n=B();return n&&n[Ks].sanitizer}();return e?e.sanitize(wi.URL,n)||"":no(n,"URL")?kr(n):I_(Be(n))}function mr(n){return"browser"===(n??D(gt)).get(is)}var za=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(za||{});let ZE;function KE(n,e){return ZE(n,e)}function Xu(n,e,t,i,r){if(null!=i){let s,o=!1;Fi(i)?s=i:Zn(i)&&(o=!0,i=i[un]);const a=pt(i);0===n&&null!==t?null==r?hN(e,t,a):ol(e,t,a,r||null,!0):1===n&&null!==t?ol(e,t,a,r||null,!0):2===n?function If(n,e,t){n.removeChild(null,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function lK(n,e,t,i,r){const s=t[Js];s!==pt(t)&&Xu(e,n,i,s,r);for(let a=wn;a<t.length;a++){const c=t[a];F_(c[Y],c,n,e,i,s)}}(e,n,s,t,r)}}function P_(n,e,t){return n.createElement(e,t)}function lN(n,e){e[Ks].changeDetectionScheduler?.notify(8),F_(n,e,e[Pe],2,null,null)}function uN(n,e){const t=n[Fu],i=e[Pn];(Zn(i)||e[dn]!==i[Pn][dn])&&(n[Ee]|=e_.HasTransplantedViews),null===t?n[Fu]=[e]:t.push(e)}function eC(n,e){const t=n[Fu],i=t.indexOf(e);t.splice(i,1)}function Mf(n,e){if(n.length<=wn)return;const t=wn+e,i=n[t];if(i){const r=i[Yc];null!==r&&r!==n&&eC(r,i),e>0&&(n[t-1][xs]=i[xs]);const s=Hm(n,wn+e);!function tK(n,e){lN(n,e),e[un]=null,e[vi]=null}(i[Y],i);const o=s[$o];null!==o&&o.detachView(s[Y]),i[Pn]=null,i[xs]=null,i[Ee]&=-129}return i}function N_(n,e){if(!(256&e[Ee])){const t=e[Pe];t.destroyNode&&F_(n,e,t,3,null,null),function iK(n){let e=n[af];if(!e)return tC(n[Y],n);for(;e;){let t=null;if(Zn(e))t=e[af];else{const i=e[wn];i&&(t=i)}if(!t){for(;e&&!e[xs]&&e!==n;)Zn(e)&&tC(e[Y],e),e=e[Pn];null===e&&(e=n),Zn(e)&&tC(e[Y],e),t=e&&e[xs]}e=t}}(e)}}function tC(n,e){if(256&e[Ee])return;const t=z(null);try{e[Ee]&=-129,e[Ee]|=256,e[ts]&&De(e[ts]),function oK(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof gf)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],c=s[o+1];Qs(4,a,c);try{c.call(a)}finally{Qs(5,a,c)}}else{Qs(4,r,s);try{s.call(r)}finally{Qs(5,r,s)}}}}}(n,e),function sK(n,e){const t=n.cleanup,i=e[Ou];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[Ou]=null);const r=e[Ua];if(null!==r){e[Ua]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[Y].type&&e[Pe].destroy();const i=e[Yc];if(null!==i&&Fi(e[Pn])){i!==e[Pn]&&eC(i,e);const r=e[$o];null!==r&&r.detachView(n)}!function kY(n){ME.delete(n[ku])}(e)}finally{z(t)}}function nC(n,e,t){return function dN(n,e,t){let i=e;for(;null!==i&&168&i.type;)i=(e=i).parent;if(null===i)return t[un];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===As.None||s===As.Emulated)return null}return Yi(i,t)}}(n,e.parent,t)}function ol(n,e,t,i,r){n.insertBefore(e,t,i,r)}function hN(n,e,t){n.appendChild(e,t)}function fN(n,e,t,i,r){null!==i?ol(n,e,t,i,r):hN(n,e,t)}function iC(n,e){return n.parentNode(e)}function pN(n,e,t){return mN(n,e,t)}let rC,mN=function gN(n,e,t){return 40&n.type?Yi(n,t):null};function k_(n,e,t,i){const r=nC(n,i,e),s=e[Pe],a=pN(i.parent||e[vi],i,e);if(null!=r)if(Array.isArray(t))for(let c=0;c<t.length;c++)fN(s,r,t[c],a,!1);else fN(s,r,t,a,!1);void 0!==rC&&rC(s,i,e,t,r)}function al(n,e){if(null!==e){const t=e.type;if(3&t)return Yi(e,n);if(4&t)return sC(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return al(n,i);{const r=n[e.index];return Fi(r)?sC(-1,r):pt(r)}}if(128&t)return al(n,e.next);if(32&t)return KE(e,n)()||pt(n[e.index]);{const i=yN(n,e);return null!==i?Array.isArray(i)?i[0]:al(qo(n[dn]),i):al(n,e.next)}}return null}function yN(n,e){return null!==e?n[dn][vi].projection[e.projection]:null}function sC(n,e){const t=wn+n+1;if(t<e.length){const i=e[t],r=i[Y].firstChild;if(null!==r)return al(i,r)}return e[Js]}function oC(n,e,t,i,r,s,o){for(;null!=t;){if(128===t.type){t=t.next;continue}const a=i[t.index],c=t.type;if(o&&0===e&&(a&&Li(pt(a),i),t.flags|=2),32&~t.flags)if(8&c)oC(n,e,t.child,i,r,s,!1),Xu(e,n,r,a,s);else if(32&c){const l=KE(t,i);let u;for(;u=l();)Xu(e,n,r,u,s);Xu(e,n,r,a,s)}else 16&c?bN(n,e,i,t,r,s):Xu(e,n,r,a,s);t=o?t.projectionNext:t.next}}function F_(n,e,t,i,r,s){oC(t,i,n.firstChild,e,r,s,!1)}function bN(n,e,t,i,r,s){const o=t[dn],c=o[vi].projection[i.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)Xu(e,n,r,c[l],s);else{let l=c;const u=o[Pn];vf(i)&&(l.flags|=128),oC(n,e,l,u,r,s,!0)}}function wN(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function EN(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&Uw(n,e,i),null!==r&&wN(n,e,r),null!==s&&function dK(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}const Ve={};function Xe(n=1){CN(qe(),B(),bi()+n,!1)}function CN(n,e,t,i){if(!i)if(3&~e[Ee]){const s=n.preOrderHooks;null!==s&&l_(e,s,0,t)}else{const s=n.preOrderCheckHooks;null!==s&&c_(e,s,t)}Qc(t)}function R(n,e=rt.Default){const t=B();return null===t?O(n,e):zO(Pt(),t,Oe(n),e)}function TN(n,e,t,i,r,s){const o=z(null);try{let a=null;r&Ba.SignalBased&&(a=e[i][K]),null!==a&&void 0!==a.transformFn&&(s=a.transformFn(s)),r&Ba.HasDecoratorInputTransform&&(s=n.inputTransforms[i].call(e,s)),null!==n.setInput?n.setInput(e,a,s,t,i):uO(e,a,i,s)}finally{z(o)}}function L_(n,e,t,i,r,s,o,a,c,l,u){const d=e.blueprint.slice();return d[un]=r,d[Ee]=204|i,(null!==l||n&&2048&n[Ee])&&(d[Ee]|=2048),mO(d),d[Pn]=d[Pu]=n,d[Zt]=t,d[Ks]=o||n&&n[Ks],d[Pe]=a||n&&n[Pe],d[Nn]=c||n&&n[Nn]||null,d[vi]=s,d[ku]=function PY(){return OY++}(),d[Xi]=u,d[rO]=l,d[dn]=2==e.type?n[dn]:d,d}function cl(n,e,t,i,r){let s=n.data[e];if(null===s)s=function aC(n,e,t,i,r){const s=wO(),o=oE(),c=n.data[e]=function vK(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return Jc()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=c),null!==s&&(o?null==s.child&&null!==c.parent&&(s.child=c):null===s.next&&(s.next=c,c.prev=s)),c}(n,e,t,i,r),function jX(){return Ne.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function ff(){const n=Ne.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Ms(s,!0),s}function Df(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function xN(n,e,t,i,r){const s=bi(),o=2&i;try{Qc(-1),o&&e.length>ge&&CN(n,e,ge,!1),Qs(o?2:0,r),t(i,r)}finally{Qc(s),Qs(o?3:1,r)}}function cC(n,e,t){if(Kw(e)){const i=z(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{z(i)}}}function lC(n,e,t){bO()&&(function xK(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;Zc(t)&&function PK(n,e,t){const i=Yi(e,n),r=SN(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=B_(n,L_(n,r,null,o,i,e,null,n[Ks].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=a}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||d_(t,e),Li(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const c=n.data[a],l=tl(e,n,a,t);Li(l,e),null!==o&&NK(0,a-r,l,c,0,o),Ss(c)&&(Nr(t.index,e)[Zt]=tl(e,n,a,t))}}(n,e,t,Yi(t,e)),!(64&~t.flags)&&ON(n,e,t))}function uC(n,e,t=Yi){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function SN(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=dC(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function dC(n,e,t,i,r,s,o,a,c,l,u){const d=ge+i,h=d+r,f=function fK(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Ve);return t}(d,h),p="function"==typeof l?l():l;return f[Y]={type:n,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}let MN=()=>null;function IN(n,e,t,i,r){for(let s in e){if(!e.hasOwnProperty(s))continue;const o=e[s];if(void 0===o)continue;i??={};let a,c=Ba.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(null!==r){if(!r.hasOwnProperty(s))continue;l=r[s]}0===n?DN(i,t,l,a,c):DN(i,t,l,a)}return i}function DN(n,e,t,i,r){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,i):s=n[t]=[e,i],void 0!==r&&s.push(r)}function _r(n,e,t,i,r,s,o,a){const c=Yi(e,t);let u,l=e.inputs;!a&&null!=l&&(u=l[i])?(mC(n,t,u,i,r),Zc(e)&&function EK(n,e){const t=Nr(e,n);16&t[Ee]||(t[Ee]|=64)}(t,e.index)):3&e.type&&(i=function wK(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(c,i,r))}function hC(n,e,t,i){if(bO()){const r=null===i?null:{"":-1},s=function MK(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(WR(e,o.selectors,!1))if(i||(i=[]),Ss(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),fC(n,e,a.length)}else i.unshift(o),fC(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&RN(n,e,t,o,r,a),r&&function IK(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new H(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=nf(t.mergedAttrs,t.attrs)}function RN(n,e,t,i,r,s){for(let l=0;l<i.length;l++)vE(d_(t,e),n,i[l].type);!function RK(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let l=0;l<i.length;l++){const u=i[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=Df(n,e,i.length,null);for(let l=0;l<i.length;l++){const u=i[l];t.mergedAttrs=nf(t.mergedAttrs,u.hostAttrs),OK(n,t,e,c,u),DK(c,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}!function bK(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let c=null,l=null;for(let u=e.directiveStart;u<r;u++){const d=s[u],h=t?t.get(d):null,p=h?h.outputs:null;c=IN(0,d.inputs,u,c,h?h.inputs:null),l=IN(1,d.outputs,u,l,p);const g=null===c||null===o||jw(e)?null:kK(c,u,o);a.push(g)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(n,t,s)}function ON(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function zX(){return Ne.lFrame.currentDirectiveIndex}();try{Qc(s);for(let a=i;a<r;a++){const c=n.data[a],l=e[a];cE(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&SK(c,l)}}finally{Qc(-1),cE(o)}}function SK(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function fC(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function DK(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Ss(e)&&(t[""]=n)}}function OK(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=$c(r.type)),o=new gf(s,Ss(r),R);n.blueprint[i]=o,t[i]=o,function AK(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function TK(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,Df(n,t,r.hostVars,Ve),r)}function io(n,e,t,i,r,s){const o=Yi(n,e);!function pC(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const a=null==o?Be(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}(e[Pe],o,s,n.value,t,i,r)}function NK(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)TN(i,t,o[a++],o[a++],o[a++],o[a++])}function kK(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){i.push(s,o[a+1],o[a+2],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function PN(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function NN(n,e){const t=n.contentQueries;if(null!==t){const i=z(null);try{for(let r=0;r<t.length;r+=2){const o=t[r+1];if(-1!==o){const a=n.data[o];s_(t[r]),a.contentQueries(2,e[o],o)}}}finally{z(i)}}}function B_(n,e){return n[af]?n[iO][xs]=e:n[af]=e,n[iO]=e,e}function gC(n,e,t){s_(0);const i=z(null);try{e(n,t)}finally{z(i)}}function kN(n){return n[Ou]??=[]}function FN(n){return n.cleanup??=[]}function V_(n,e){const t=n[Nn],i=t?t.get(pr,null):null;i&&i.handleError(e)}function mC(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],c=t[s++];TN(n.data[o],e[o],i,a,c,r)}}function FK(n,e){const t=Nr(e,n),i=t[Y];!function LK(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[un];null!==r&&null===t[Xi]&&(t[Xi]=LE(r,t[Nn])),_C(i,t,t[Zt])}function _C(n,e,t){dE(e);try{const i=n.viewQuery;null!==i&&gC(1,i,t);const r=n.template;null!==r&&xN(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[$o]?.finishViewCreation(n),n.staticContentQueries&&NN(n,e),n.staticViewQueries&&gC(2,n.viewQuery,t);const s=n.components;null!==s&&function BK(n,e){for(let t=0;t<e.length;t++)FK(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Ee]&=-5,hE()}}function Yu(n,e,t,i){const r=z(null);try{const s=e.tView,c=L_(n,s,t,4096&n[Ee]?4096:16,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null);c[Yc]=n[e.index];const u=n[$o];return null!==u&&(c[$o]=u.createEmbeddedView(s)),_C(s,c,t),c}finally{z(r)}}function ll(n,e){return!e||null===e.firstChild||vf(n)}function Zu(n,e,t,i=!0){const r=e[Y];if(function rK(n,e,t,i){const r=wn+i,s=t.length;i>0&&(t[r-1][xs]=e),i<s-wn?(e[xs]=t[r],BR(t,wn+i,e)):(t.push(e),e[xs]=null),e[Pn]=t;const o=e[Yc];null!==o&&t!==o&&uN(o,e);const a=e[$o];null!==a&&a.insertView(n),iE(e),e[Ee]|=128}(r,e,n,t),i){const o=sC(t,n),a=e[Pe],c=iC(a,n[Js]);null!==c&&function nK(n,e,t,i,r,s){i[un]=r,i[vi]=e,F_(n,i,t,1,r,s)}(r,n[vi],a,e,c,o)}const s=e[Xi];null!==s&&null!==s.firstChild&&(s.firstChild=null)}function Rf(n,e,t,i,r=!1){for(;null!==t;){if(128===t.type){t=r?t.projectionNext:t.next;continue}const s=e[t.index];null!==s&&i.push(pt(s)),Fi(s)&&VN(s,i);const o=t.type;if(8&o)Rf(n,e,t.child,i);else if(32&o){const a=KE(t,e);let c;for(;c=a();)i.push(c)}else if(16&o){const a=yN(e,t);if(Array.isArray(a))i.push(...a);else{const c=qo(e[dn]);Rf(c[Y],c,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function VN(n,e){for(let t=wn;t<n.length;t++){const i=n[t],r=i[Y].firstChild;null!==r&&Rf(i[Y],i,r,e)}n[Js]!==n[un]&&e.push(n[Js])}let UN=[];const HK={...Mt,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{n_(n.lView)},consumerOnSignalRead(){this.lView[ts]=this}},GK={...Mt,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{let e=qo(n.lView);for(;e&&!jN(e[Y]);)e=qo(e);e&&_O(e)},consumerOnSignalRead(){this.lView[ts]=this}};function jN(n){return 2!==n.type}const WK=100;function U_(n,e=!0,t=0){const i=n[Ks],r=i.rendererFactory;r.begin?.();try{!function $K(n,e){const t=AO();try{TO(!0),vC(n,e);let i=0;for(;hf(n);){if(i===WK)throw new H(103,!1);i++,vC(n,1)}}finally{TO(t)}}(n,t)}catch(o){throw e&&V_(n,o),o}finally{r.end?.(),i.inlineEffectRunner?.flush()}}function qK(n,e,t,i){const r=e[Ee];if(!(256&~r))return;e[Ks].inlineEffectRunner?.flush(),dE(e);let a=!0,c=null,l=null;jN(n)?(l=function VK(n){return n[ts]??function UK(n){const e=UN.pop()??Object.create(HK);return e.lView=n,e}(n)}(e),c=qi(l)):null===function Ke(){return Te}()?(a=!1,l=function zK(n){const e=n[ts]??Object.create(GK);return e.lView=n,e}(e),c=qi(l)):e[ts]&&(De(e[ts]),e[ts]=null);try{mO(e),function xO(n){return Ne.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&xN(n,e,t,2,i);const u=!(3&~r);if(u){const f=n.preOrderCheckHooks;null!==f&&c_(e,f,null)}else{const f=n.preOrderHooks;null!==f&&l_(e,f,0,null),fE(e,0)}if(function XK(n){for(let e=yP(n);null!==e;e=vP(e)){if(!(e[Ee]&e_.HasTransplantedViews))continue;const t=e[Fu];for(let i=0;i<t.length;i++)_O(t[i])}}(e),zN(e,0),null!==n.contentQueries&&NN(n,e),u){const f=n.contentCheckHooks;null!==f&&c_(e,f)}else{const f=n.contentHooks;null!==f&&l_(e,f,1),fE(e,1)}!function hK(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)Qc(~r);else{const s=r,o=t[++i],a=t[++i];HX(o,s),a(2,e[s])}}}finally{Qc(-1)}}(n,e);const d=n.components;null!==d&&WN(e,d,0);const h=n.viewQuery;if(null!==h&&gC(2,h,i),u){const f=n.viewCheckHooks;null!==f&&c_(e,f)}else{const f=n.viewHooks;null!==f&&l_(e,f,2),fE(e,2)}if(!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[Jm]){for(const f of e[Jm])f();e[Jm]=null}e[Ee]&=-73}catch(u){throw n_(e),u}finally{null!==l&&(Z(l,c),a&&function jK(n){n.lView[ts]!==n&&(n.lView=null,UN.push(n))}(l)),hE()}}function zN(n,e){for(let t=yP(n);null!==t;t=vP(t))for(let i=wn;i<t.length;i++)GN(t[i],e)}function YK(n,e,t){GN(Nr(e,n),t)}function GN(n,e){nE(n)&&vC(n,e)}function vC(n,e){const i=n[Y],r=n[Ee],s=n[ts];let o=!!(0===e&&16&r);if(o||=!!(64&r&&0===e),o||=!!(1024&r),o||=!(!s?.dirty||!J(s)),o||=!1,s&&(s.dirty=!1),n[Ee]&=-9217,o)qK(i,n,i.template,n[Zt]);else if(8192&r){zN(n,1);const a=i.components;null!==a&&WN(n,a,1)}}function WN(n,e,t){for(let i=0;i<e.length;i++)YK(n,e[i],t)}function Of(n,e){const t=AO()?64:1088;for(n[Ks].changeDetectionScheduler?.notify(e);n;){n[Ee]|=t;const i=qo(n);if(lf(n)&&!i)return n;n=i}return null}class Pf{get rootNodes(){const e=this._lView,t=e[Y];return Rf(t,e,t.firstChild,[])}constructor(e,t,i=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Zt]}set context(e){this._lView[Zt]=e}get destroyed(){return!(256&~this._lView[Ee])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Pn];if(Fi(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Mf(e,i),Hm(t,i))}this._attachedToViewContainer=!1}N_(this._lView[Y],this._lView)}onDestroy(e){i_(this._lView,e)}markForCheck(){Of(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Ee]&=-129}reattach(){iE(this._lView),this._lView[Ee]|=128}detectChanges(){this._lView[Ee]|=1024,U_(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new H(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const e=lf(this._lView),t=this._lView[Yc];null!==t&&!e&&eC(t,this._lView),lN(this._lView[Y],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new H(902,!1);this._appRef=e;const t=lf(this._lView),i=this._lView[Yc];null!==i&&!t&&uN(i,this._lView),iE(this._lView)}}let Ds=(()=>{class n{static{this.__NG_ELEMENT_ID__=JK}}return n})();const ZK=Ds,KK=class extends ZK{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=Yu(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:i});return new Pf(r)}};function JK(){return j_(Pt(),B())}function j_(n,e){return 4&n.type?new KK(e,n,Uu(n,e)):null}let hk=()=>null;function dl(n,e){return hk(n,e)}class Ju{}const jf=new k("",{providedIn:"root",factory:()=>!1}),fk=new k(""),DC=new k("");class W7{}class pk{}class q7{resolveComponentFactory(e){throw function $7(n){const e=Error(`No component factory found for ${qn(n)}.`);return e.ngComponent=n,e}(e)}}class Ga{static{this.NULL=new q7}}class RC{}let Y7=(()=>{class n{static{this.\u0275prov=j({token:n,providedIn:"root",factory:()=>null})}}return n})();const mk=new Set;function Ki(n){mk.has(n)||(mk.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var Ji=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(Ji||{});const _k={destroy(){}};function q_(n,e){!e&&rf();const t=e?.injector??D(gt);return mr(t)?(Ki("NgAfterNextRender"),vk(n,t,!0,e?.phase??Ji.MixedReadWrite)):_k}function vk(n,e,t,i){const r=function Z7(n,e){if(n instanceof Function)switch(e){case Ji.EarlyRead:return{earlyRead:n};case Ji.Write:return{write:n};case Ji.MixedReadWrite:return{mixedReadWrite:n};case Ji.Read:return{read:n}}return n}(n,i),s=e.get(X_),o=s.handler??=new J7,a=[],c=[],l=()=>{for(const f of c)o.unregister(f);u()},u=e.get(nl).onDestroy(l);let d=0;const h=(f,p)=>{if(!p)return;const g=t?(...y)=>(d--,d<1&&l(),p(...y)):p,m=es(e,()=>new K7(f,a,g));o.register(m),c.push(m),d++};return h(Ji.EarlyRead,r.earlyRead),h(Ji.Write,r.write),h(Ji.MixedReadWrite,r.mixedReadWrite),h(Ji.Read,r.read),{destroy:l}}class K7{constructor(e,t,i){this.phase=e,this.pipelinedArgs=t,this.callbackFn=i,this.zone=D(ye),this.errorHandler=D(pr,{optional:!0}),D(Ju,{optional:!0})?.notify(6)}invoke(){try{const e=this.zone.runOutsideAngular(()=>this.callbackFn.apply(null,this.pipelinedArgs));this.pipelinedArgs.splice(0,this.pipelinedArgs.length,e)}catch(e){this.errorHandler?.handleError(e)}}}class J7{constructor(){this.executingCallbacks=!1,this.buckets={[Ji.EarlyRead]:new Set,[Ji.Write]:new Set,[Ji.MixedReadWrite]:new Set,[Ji.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(const e of Object.values(this.buckets))for(const t of e)t.invoke();this.executingCallbacks=!1;for(const e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(const e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}}let X_=(()=>{class n{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){const t=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const i of t)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static{this.\u0275prov=j({token:n,providedIn:"root",factory:()=>new n})}}return n})();function Z_(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=Aw(r,a):2==s&&(i=Aw(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}class Ek extends Ga{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Qe(e);return new Gf(t,this.ngModule)}}function Ck(n,e){const t=[];for(const i in n){if(!n.hasOwnProperty(i))continue;const r=n[i];if(void 0===r)continue;const s=Array.isArray(r),o=s?r[0]:r;t.push(e?{propName:o,templateName:i,isSignal:!!((s?r[1]:Ba.None)&Ba.SignalBased)}:{propName:o,templateName:i})}return t}class Gf extends pk{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=Ck(e.inputs,!0);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return Ck(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function tX(n){return n.map(eX).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){const s=z(null);try{let o=(r=r||this.ngModule)instanceof ki?r:r?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const a=o?new el(e,o):e,c=a.get(RC,null);if(null===c)throw new H(407,!1);const l=a.get(Y7,null),h={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:a.get(X_,null),changeDetectionScheduler:a.get(Ju,null)},f=c.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",g=i?function pK(n,e,t,i){const s=i.get(LP,!1)||t===As.ShadowDom,o=n.selectRootElement(e,s);return function gK(n){MN(n)}(o),o}(f,i,this.componentDef.encapsulation,a):P_(f,p,function tJ(n){const e=n.toLowerCase();return"svg"===e?pO:"math"===e?"math":null}(p));let m=512;this.componentDef.signals?m|=4096:this.componentDef.onPush||(m|=16);let y=null;null!==g&&(y=LE(g,a,!0));const v=dC(0,null,null,1,0,null,null,null,null,null,null),_=L_(null,v,null,m,null,null,h,f,a,null,y);let E,A;dE(_);try{const x=this.componentDef;let I,S=null;x.findHostDirectiveDefs?(I=[],S=new Map,x.findHostDirectiveDefs(x,I,S),I.push(x)):I=[x];const F=function iJ(n,e){const t=n[Y],i=ge;return n[i]=e,cl(t,i,2,"#host",null)}(_,g),U=function rJ(n,e,t,i,r,s,o){const a=r[Y];!function sJ(n,e,t,i){for(const r of n)e.mergedAttrs=nf(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Z_(e,e.mergedAttrs,!0),null!==t&&EN(i,t,e))}(i,n,e,o);let c=null;null!==e&&(c=LE(e,r[Nn]));const l=s.rendererFactory.createRenderer(e,t);let u=16;t.signals?u=4096:t.onPush&&(u=64);const d=L_(r,SN(t),null,u,r[n.index],n,s,l,null,null,c);return a.firstCreatePass&&fC(a,n,i.length-1),B_(r,d),r[n.index]=d}(F,g,x,I,_,h,f);A=df(v,ge),g&&function aJ(n,e,t,i){if(i)Uw(n,t,["ng-version","18.2.1"]);else{const{attrs:r,classes:s}=function nX(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Ts(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&Uw(n,t,r),s&&s.length>0&&wN(n,t,s.join(" "))}}(f,x,g,i),void 0!==t&&function cJ(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(A,this.ngContentSelectors,t),E=function oJ(n,e,t,i,r,s){const o=Pt(),a=r[Y],c=Yi(o,r);RN(a,r,o,t,null,i);for(let u=0;u<t.length;u++)Li(tl(r,a,o.directiveStart+u,o),r);ON(a,r,o),c&&Li(c,r);const l=tl(r,a,o.directiveStart+o.componentOffset,o);if(n[Zt]=r[Zt]=l,null!==s)for(const u of s)u(l,e);return cC(a,o,r),l}(U,x,I,S,_,[lJ]),_C(v,_,null)}finally{hE()}return new nJ(this.componentType,E,Uu(A,_),_,A)}finally{z(s)}}}class nJ extends W7{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Pf(r,void 0,!1),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;mC(s[Y],s,r,e,t),this.previousInputValues.set(e,t),Of(Nr(this._tNode.index,s),1)}}get injector(){return new Jn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function lJ(){const n=Pt();a_(B()[Y],n)}let Qi=(()=>{class n{static{this.__NG_ELEMENT_ID__=uJ}}return n})();function uJ(){return xk(Pt(),B())}const dJ=Qi,Ak=class extends dJ{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Uu(this._hostTNode,this._hostLView)}get injector(){return new Jn(this._hostTNode,this._hostLView)}get parentInjector(){const e=h_(this._hostTNode,this._hostLView);if(mE(e)){const t=_f(e,this._hostLView),i=mf(e);return new Jn(t[Y].data[i+8],t)}return new Jn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=Tk(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-wn}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const o=dl(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,r,ll(this._hostTNode,o)),a}createComponent(e,t,i,r,s){const o=e&&!function sf(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const p=t||{};a=p.index,i=p.injector,r=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}const c=o?e:new Gf(Qe(e)),l=i||this.parentInjector;if(!s&&null==c.ngModule){const g=(o?l:this.parentInjector).get(ki,null);g&&(s=g)}const u=Qe(c.componentType??{}),d=dl(this._lContainer,u?.id??null),f=c.create(l,r,d?.firstChild??null,s);return this.insertImpl(f.hostView,a,ll(this._hostTNode,d)),f}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){const r=e._lView;if(function OX(n){return Fi(n[Pn])}(r)){const a=this.indexOf(e);if(-1!==a)this.detach(a);else{const c=r[Pn],l=new Ak(c,c[vi],c[Pn]);l.detach(l.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;return Zu(o,r,s,i),e.attachToViewContainerRef(),BR(kC(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=Tk(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Mf(this._lContainer,t);i&&(Hm(kC(this._lContainer),t),N_(i[Y],i))}detach(e){const t=this._adjustIndex(e,-1),i=Mf(this._lContainer,t);return i&&null!=Hm(kC(this._lContainer),t)?new Pf(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function Tk(n){return n[8]}function kC(n){return n[8]||(n[8]=[])}function xk(n,e){let t;const i=e[n.index];return Fi(i)?t=i:(t=PN(i,e,null,n),e[n.index]=t,B_(e,t)),Sk(t,e,n,i),new Ak(t,n,e)}let Sk=function Ik(n,e,t,i){if(n[Js])return;let r;r=8&t.type?pt(i):function hJ(n,e){const t=n[Pe],i=t.createComment(""),r=Yi(e,n);return ol(t,iC(t,r),i,function aK(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[Js]=r},FC=()=>!1;class LC{constructor(e){this.queryList=e,this.matches=null}clone(){return new LC(this.queryList)}setDirty(){this.queryList.setDirty()}}class BC{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new BC(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==zC(e,t).matches&&this.queries[t].setDirty()}}class Dk{constructor(e,t,i=null){this.flags=t,this.read=i,this.predicate="string"==typeof e?function bJ(n){return n.split(",").map(e=>e.trim())}(e):e}}class VC{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new VC(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class UC{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new UC(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1&~this.metadata.flags){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,mJ(t,s)),this.matchTNodeWithReadOption(e,t,f_(t,e,s,!1,!1))}else i===Ds?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,f_(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===At||r===Qi||r===Ds&&4&t.type)this.addMatch(t.index,-2);else{const s=f_(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function mJ(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function yJ(n,e,t,i){return-1===t?function _J(n,e){return 11&n.type?Uu(n,e):4&n.type?j_(n,e):null}(e,n):-2===t?function vJ(n,e,t){return t===At?Uu(e,n):t===Ds?j_(e,n):t===Qi?xk(e,n):void 0}(n,e,i):tl(n,n[Y],t,e)}function Rk(n,e,t,i){const r=e[$o].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let c=0;null!==o&&c<o.length;c+=2){const l=o[c];a.push(l<0?null:yJ(e,s[l],o[c+1],t.metadata.read))}r.matches=a}return r.matches}function jC(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=Rk(n,e,r,t);for(let a=0;a<s.length;a+=2){const c=s[a];if(c>0)i.push(o[a/2]);else{const l=s[a+1],u=e[-c];for(let d=wn;d<u.length;d++){const h=u[d];h[Yc]===h[Pn]&&jC(h[Y],h,l,i)}if(null!==u[Fu]){const d=u[Fu];for(let h=0;h<d.length;h++){const f=d[h];jC(f[Y],f,l,i)}}}}}return i}function Ok(n,e,t){const i=new ju(!(4&~t));return function yK(n,e,t,i){const r=kN(e);r.push(t),n.firstCreatePass&&FN(n).push(i,r.length-1)}(n,e,i,i.destroy),(e[$o]??=new BC).queries.push(new LC(i))-1}function kk(n,e,t){null===n.queries&&(n.queries=new VC),n.queries.track(new UC(e,t))}function zC(n,e){return n.queries.getByIndex(e)}function Fk(n,e){const t=n[Y],i=zC(t,e);return i.crossesNgTemplate?jC(t,n,e,[]):Rk(t,n,i,e)}function qa(n,e){Ki("NgSignals");const t=function gi(n){const e=Object.create(Vc);e.value=n;const t=()=>(gn(e),e.value);return t[K]=e,t}(n),i=t[K];return e?.equal&&(i.equal=e.equal),t.set=r=>mi(i,r),t.update=r=>function du(n,e){fi()||lu(),mi(n,e(n.value))}(i,r),t.asReadonly=Lk.bind(t),t}function Lk(){const n=this[K];if(void 0===n.readonlyFn){const e=()=>this();e[K]=n,n.readonlyFn=e}return n.readonlyFn}function st(n){let e=function Yk(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Ss(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new H(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=J_(n.inputs),o.inputTransforms=J_(n.inputTransforms),o.declaredInputs=J_(n.declaredInputs),o.outputs=J_(n.outputs);const a=r.hostBindings;a&&kJ(n,a);const c=r.viewQuery,l=r.contentQueries;if(c&&PJ(n,c),l&&NJ(n,l),RJ(n,r),wq(n.outputs,r.outputs),Ss(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===st&&(t=!1)}}e=Object.getPrototypeOf(e)}!function OJ(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=nf(r.hostAttrs,t=nf(t,r.hostAttrs))}}(i)}function RJ(n,e){for(const t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;const i=e.inputs[t];if(void 0!==i&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t],null!==e.inputTransforms)){const r=Array.isArray(i)?i[0]:i;if(!e.inputTransforms.hasOwnProperty(r))continue;n.inputTransforms??={},n.inputTransforms[r]=e.inputTransforms[r]}}}function J_(n){return n===Zs?{}:n===ft?[]:n}function PJ(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function NJ(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function kJ(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function Zk(n){const e=t=>{const i=(Array.isArray(n)?n:n()).map(r=>"function"==typeof r?{directive:Oe(r),inputs:Zs,outputs:Zs}:{directive:Oe(r.directive),inputs:Jk(r.inputs),outputs:Jk(r.outputs)});null===t.hostDirectives?(t.findHostDirectiveDefs=Kk,t.hostDirectives=i):t.hostDirectives.unshift(...i)};return e.ngInherit=!0,e}function Kk(n,e,t){if(null!==n.hostDirectives)for(const i of n.hostDirectives){const r=Xn(i.directive);VJ(r.declaredInputs,i.inputs),Kk(r,e,t),t.set(r,i),e.push(r)}}function Jk(n){if(void 0===n||0===n.length)return Zs;const e={};for(let t=0;t<n.length;t+=2)e[n[t]]=n[t+1];return e}function VJ(n,e){for(const t in e)e.hasOwnProperty(t)&&(n[e[t]]=n[t])}function Xa(n){const e=n.inputConfig,t={};for(const i in e)if(e.hasOwnProperty(i)){const r=e[i];Array.isArray(r)&&r[3]&&(t[i]=r[3])}n.inputTransforms=t}class hl{}class tF extends hl{constructor(e){super(),this.componentFactoryResolver=new Ek(this),this.instance=null;const t=new Iu([...e.providers,{provide:hl,useValue:this},{provide:Ga,useValue:this.componentFactoryResolver}],e.parent||Zm(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function Q_(n){return!!function XC(n){return null!==n&&("function"==typeof n||"object"==typeof n)}(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function ro(n,e,t){return n[e]=t}function An(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Xf(n,e,t,i,r,s,o,a,c,l){const u=t+ge,d=e.firstCreatePass?function $J(n,e,t,i,r,s,o,a,c){const l=e.consts,u=cl(e,n,4,o||null,a||null);hC(e,t,u,ns(l,c)),a_(e,u);const d=u.tView=dC(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,e,n,i,r,s,o,a,c):e.data[u];Ms(d,!1);const h=nF(e,n,d,t);pf()&&k_(e,n,h,d),Li(h,n);const f=PN(h,n,h,d);return n[u]=f,B_(n,f),function Mk(n,e,t){return FC(n,e,t)}(f,d,n),t_(d)&&lC(e,n,d),null!=c&&uC(n,d,l),d}function er(n,e,t,i,r,s,o,a){const c=B(),l=qe();return Xf(c,l,n,e,t,i,r,ns(l.consts,s),o,a),er}let nF=function iF(n,e,t,i){return eo(!0),e[Pe].createComment("")};function kn(n,e,t,i){const r=B();return An(r,Is(),e)&&(qe(),io(Kt(),r,n,e,t,i)),kn}function cd(n,e,t,i){return An(n,Is(),t)?e+Be(t)+i:Ve}function oy(n,e){return n<<17|e<<2}function Za(n){return n>>17&32767}function sA(n){return 2|n}function gl(n){return(131068&n)>>2}function oA(n,e){return-131069&n|e<<2}function aA(n){return 1|n}function NF(n,e,t,i){const r=n[t+1],s=null===e;let o=i?Za(r):gl(r),a=!1;for(;0!==o&&(!1===a||s);){const l=n[o+1];RQ(n[o],e)&&(a=!0,n[o+1]=i?aA(l):sA(l)),o=i?Za(l):gl(l)}a&&(n[t+1]=i?sA(r):aA(r))}function RQ(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Mu(n,e)>=0}const Qn={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function kF(n){return n.substring(Qn.key,Qn.keyEnd)}function FF(n,e){const t=Qn.textEnd;return t===e?-1:(e=Qn.keyEnd=function kQ(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,Qn.key=e,t),md(n,e,t))}function md(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function Tt(n,e,t){const i=B();return An(i,Is(),e)&&_r(qe(),Kt(),i,n,e,i[Pe],t,!1),Tt}function cA(n,e,t,i,r){const o=r?"class":"style";mC(n,t,e.inputs[o],o,i)}function Jf(n,e,t){return Rs(n,e,t,!1),Jf}function Sn(n,e){return Rs(n,e,null,!0),Sn}function _d(n){!function Os(n,e,t,i){const r=qe(),s=Yo(2);r.firstUpdatePass&&HF(r,null,s,i);const o=B();if(t!==Ve&&An(o,s,t)){const a=r.data[bi()];if($F(a,i)&&!jF(r,s)){let c=i?a.classesWithoutHost:a.stylesWithoutHost;null!==c&&(t=Aw(c,t||"")),cA(r,a,o,t,i)}else!function WQ(n,e,t,i,r,s,o,a){r===Ve&&(r=ft);let c=0,l=0,u=0<r.length?r[0]:null,d=0<s.length?s[0]:null;for(;null!==u||null!==d;){const h=c<r.length?r[c+1]:void 0,f=l<s.length?s[l+1]:void 0;let g,p=null;u===d?(c+=2,l+=2,h!==f&&(p=d,g=f)):null===d||null!==u&&u<d?(c+=2,p=u):(l+=2,p=d,g=f),null!==p&&GF(n,e,t,i,p,g,o,a),u=c<r.length?r[c]:null,d=l<s.length?s[l]:null}}(r,a,o,o[Pe],o[s+1],o[s+1]=function zQ(n,e,t){if(null==t||""===t)return ft;const i=[],r=kr(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(GQ,oo,n,!0)}function oo(n,e){for(let t=function PQ(n){return function BF(n){Qn.key=0,Qn.keyEnd=0,Qn.value=0,Qn.valueEnd=0,Qn.textEnd=n.length}(n),FF(n,md(n,0,Qn.textEnd))}(e);t>=0;t=FF(e,t))Pr(n,kF(e),!0)}function Rs(n,e,t,i){const r=B(),s=qe(),o=Yo(2);s.firstUpdatePass&&HF(s,n,o,i),e!==Ve&&An(r,o,e)&&GF(s,s.data[bi()],r,r[Pe],n,r[o+1]=function $Q(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=qn(kr(n)))),n}(e,t),i,o)}function jF(n,e){return e>=n.expandoStartIndex}function HF(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[bi()],o=jF(n,t);$F(s,i)&&null===e&&!o&&(e=!1),e=function VQ(n,e,t,i){const r=function lE(n){const e=Ne.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=Qf(t=lA(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=lA(r,n,e,t,i),null===s){let c=function UQ(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==gl(i))return n[Za(i)]}(n,e,i);void 0!==c&&Array.isArray(c)&&(c=lA(null,n,e,c[1],i),c=Qf(c,e.attrs,i),function jQ(n,e,t,i){n[Za(t?e.classBindings:e.styleBindings)]=i}(n,e,i,c))}else s=function HQ(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=Qf(i,n[s].hostAttrs,t);return Qf(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function IQ(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Za(o),c=gl(o);n[i]=t;let u,l=!1;if(Array.isArray(t)?(u=t[1],(null===u||Mu(t,u)>0)&&(l=!0)):u=t,r)if(0!==c){const h=Za(n[a+1]);n[i+1]=oy(h,a),0!==h&&(n[h+1]=oA(n[h+1],i)),n[a+1]=function SQ(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=oy(a,0),0!==a&&(n[a+1]=oA(n[a+1],i)),a=i;else n[i+1]=oy(c,0),0===a?a=i:n[c+1]=oA(n[c+1],i),c=i;l&&(n[i+1]=sA(n[i+1])),NF(n,u,i,!0),NF(n,u,i,!1),function DQ(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Mu(s,e)>=0&&(t[i+1]=aA(t[i+1]))}(e,u,n,i,s),o=oy(a,c),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function lA(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=Qf(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function Qf(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Pr(n,o,!!t||e[++s]))}return void 0===n?null:n}function GQ(n,e,t){const i=String(e);""!==i&&!i.includes(" ")&&Pr(n,i,t)}function GF(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const c=n.data,l=c[a+1],u=function MQ(n){return!(1&~n)}(l)?WF(c,e,t,r,gl(l),o):void 0;ay(u)||(ay(s)||function xQ(n){return!(2&~n)}(l)&&(s=WF(c,null,t,r,a,o)),function uK(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:za.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=za.Important),n.setStyle(t,i,r,s))}}(i,o,uf(bi(),t),r,s))}function WF(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const c=n[r],l=Array.isArray(c),u=l?c[1]:c,d=null===u;let h=t[r+1];h===Ve&&(h=d?ft:void 0);let f=d?Bw(h,i):u===i?h:void 0;if(l&&!ay(f)&&(f=Bw(c,i)),ay(f)&&(a=f,o))return a;const p=n[r+1];r=o?Za(p):gl(p)}if(null!==e){let c=s?e.residualClasses:e.residualStyles;null!=c&&(a=Bw(c,i))}return a}function ay(n){return void 0!==n}function $F(n,e){return!!(n.flags&(e?8:16))}function cy(n,e){Ki("NgControlFlow");const t=B(),i=Is(),r=t[i]!==Ve?t[i]:-1,s=-1!==r?ly(t,ge+r):void 0;if(An(t,i,n)){const a=z(null);try{if(void 0!==s&&function yC(n,e){const t=Mf(n,e);return void 0!==t&&N_(t[Y],t),t}(s,0),-1!==n){const c=ge+n,l=ly(t,c),u=function hA(n,e){return df(n,e)}(t[Y],c),d=dl(l,u.tView.ssrId);Zu(l,Yu(t,u,e,{dehydratedView:d}),0,ll(u,d))}}finally{z(a)}}else if(void 0!==s){const a=function BN(n,e){const t=wn+e;if(t<n.length)return n[t]}(s,0);void 0!==a&&(a[Zt]=e)}}function ly(n,e){return n[e]}function xe(n,e,t,i){const r=B(),s=qe(),o=ge+n,a=r[Pe],c=s.firstCreatePass?function pee(n,e,t,i,r,s){const o=e.consts,c=cl(e,n,2,i,ns(o,r));return hC(e,t,c,ns(o,s)),null!==c.attrs&&Z_(c,c.attrs,!1),null!==c.mergedAttrs&&Z_(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,e,t,i):s.data[o],l=ZF(s,r,c,a,e,n);r[o]=l;const u=t_(c);return Ms(c,!0),EN(a,l,c),!function ed(n){return!(32&~n.flags)}(c)&&pf()&&k_(s,r,l,c),0===function PX(){return Ne.lFrame.elementDepthCount}()&&Li(l,r),function NX(){Ne.lFrame.elementDepthCount++}(),u&&(lC(s,r,c),cC(s,c,r)),null!==i&&uC(r,c),xe}function Ie(){let n=Pt();oE()?aE():(n=n.parent,Ms(n,!1));const e=n;(function FX(n){return Ne.skipHydrationRootTNode===n})(e)&&function UX(){Ne.skipHydrationRootTNode=null}(),function kX(){Ne.lFrame.elementDepthCount--}();const t=qe();return t.firstCreatePass&&(a_(t,n),Kw(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function JX(n){return!!(8&n.flags)}(e)&&cA(t,e,B(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function QX(n){return!!(16&n.flags)}(e)&&cA(t,e,B(),e.stylesWithoutHost,!1),Ie}function Ei(n,e,t,i){return xe(n,e,t,i),Ie(),Ei}let ZF=(n,e,t,i,r,s)=>(eo(!0),P_(i,r,function PO(){return Ne.lFrame.currentNamespace}()));function ao(){return B()}function ep(n,e,t){const i=B();return An(i,Is(),e)&&_r(qe(),Kt(),i,n,e,i[Pe],t,!0),ep}const uy="en-US";let nL=uy,bL=(n,e,t)=>{};function mt(n,e,t,i){const r=B(),s=qe(),o=Pt();return function _A(n,e,t,i,r,s,o){const a=t_(i),l=n.firstCreatePass&&FN(n),u=e[Zt],d=kN(e);let h=!0;if(3&i.type||o){const g=Yi(i,e),m=o?o(g):g,y=d.length,v=o?E=>o(pt(E[i.index])):i.index;let _=null;if(!o&&a&&(_=function ute(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[Ou],c=r[s+2];return a.length>c?a[c]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==_)(_.__ngLastListenerFn__||_).__ngNextListenerFn__=s,_.__ngLastListenerFn__=s,h=!1;else{s=AL(i,e,u,s),bL(g,r,s);const E=t.listen(m,r,s);d.push(s,E),l&&l.push(r,v,y,y+1)}}else s=AL(i,e,u,s);const f=i.outputs;let p;if(h&&null!==f&&(p=f[r])){const g=p.length;if(g)for(let m=0;m<g;m+=2){const A=e[p[m]][p[m+1]].subscribe(s),x=d.length;d.push(s,A),l&&l.push(r,i.index,x,-(x+1))}}}(s,r,r[Pe],o,n,e,i),mt}function CL(n,e,t,i){const r=z(null);try{return Qs(6,e,t),!1!==t(i)}catch(s){return V_(n,s),!1}finally{Qs(7,e,t),z(r)}}function AL(n,e,t,i){return function r(s){if(s===Function)return i;Of(n.componentOffset>-1?Nr(n.index,e):e,5);let a=CL(e,t,i,s),c=r.__ngNextListenerFn__;for(;c;)a=CL(e,t,c,s)&&a,c=c.__ngNextListenerFn__;return a}}function Ps(n=1){return function WX(n){return(Ne.lFrame.contextLView=function yO(n,e){for(;n>0;)e=e[Pu],n--;return e}(n,Ne.lFrame.contextLView))[Zt]}(n)}function dte(n,e){let t=null;const i=function Zq(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?WR(n,s,!0):Qq(i,s))return r}else t=r}return t}function co(n){const e=B()[dn][vi];if(!e.projection){const i=e.projection=function zm(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){if(128!==s.type){const o=n?dte(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s)}s=s.next}}}function ci(n,e=0,t,i,r,s){const o=B(),a=qe(),c=i?n+1:null;null!==c&&Xf(o,a,c,i,r,s,null,t);const l=cl(a,ge+n,16,null,t||null);null===l.projection&&(l.projection=e),aE();const d=!o[Xi]||Jc();null===o[dn][vi].projection[l.projection]&&null!==c?function hte(n,e,t){const i=ge+t,r=e.data[i],s=n[i],o=dl(s,r.tView.ssrId);Zu(s,Yu(n,r,void 0,{dehydratedView:o}),0,ll(r,o))}(o,a,c):d&&32&~l.flags&&function cK(n,e,t){bN(e[Pe],0,e,t,nC(n,t,e),pN(t.parent||e[vi],t,e))}(a,o,l)}function yA(n,e,t){return vA(n,"",e,"",t),yA}function vA(n,e,t,i,r){const s=B(),o=cd(s,e,t,i);return o!==Ve&&_r(qe(),Kt(),s,n,o,s[Pe],r,!1),vA}function bA(n,e,t,i){!function Nk(n,e,t,i){const r=qe();if(r.firstCreatePass){const s=Pt();kk(r,new Dk(e,t,i),s.index),function wJ(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),!(2&~t)&&(r.staticContentQueries=!0)}return Ok(r,B(),t)}(n,e,t,i)}function ea(n,e,t){!function Pk(n,e,t){const i=qe();return i.firstCreatePass&&(kk(i,new Dk(n,e,t),-1),!(2&~e)&&(i.staticViewQueries=!0)),Ok(i,B(),e)}(n,e,t)}function Ns(n){const e=B(),t=qe(),i=uE();s_(i+1);const r=zC(t,i);if(n.dirty&&function RX(n){return!(4&~n[Ee])}(e)===!(2&~r.metadata.flags)){if(null===r.matches)n.reset([]);else{const s=Fk(e,i);n.reset(s,cP),n.notifyOnChanges()}return!0}return!1}function ks(){return function HC(n,e){return n[$o].queries[e].queryList}(B(),uE())}function py(n){return Kc(function EO(){return Ne.lFrame.contextLView}(),ge+n)}function Ci(n,e=""){const t=B(),i=qe(),r=n+ge,s=i.firstCreatePass?cl(i,r,1,e,null):i.data[r],o=HL(i,t,s,e,n);t[r]=o,pf()&&k_(i,t,o,s),Ms(s,!1)}let HL=(n,e,t,i,r)=>(eo(!0),function JE(n,e){return n.createText(e)}(e[Pe],i));function lo(n){return Ka("",n,""),lo}function Ka(n,e,t){const i=B(),r=cd(i,n,e,t);return r!==Ve&&function Jo(n,e,t){const i=uf(e,n);!function cN(n,e,t){n.setValue(e,t)}(n[Pe],i,t)}(i,bi(),r),Ka}function EA(n,e,t,i,r){if(n=Oe(n),Array.isArray(n))for(let s=0;s<n.length;s++)EA(n[s],e,t,i,r);else{const s=qe(),o=B(),a=Pt();let c=Xc(n)?n:Oe(n.provide);const l=eO(n),u=1048575&a.providerIndexes,d=a.directiveStart,h=a.providerIndexes>>20;if(Xc(n)||!n.multi){const f=new gf(l,r,R),p=AA(c,e,r?u:u+h,d);-1===p?(vE(d_(a,o),s,c),CA(s,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(f),o.push(f)):(t[p]=f,o[p]=f)}else{const f=AA(c,e,u+h,d),p=AA(c,e,u,u+h),m=p>=0&&t[p];if(r&&!m||!r&&!(f>=0&&t[f])){vE(d_(a,o),s,c);const y=function Pte(n,e,t,i,r){const s=new gf(n,t,R);return s.multi=[],s.index=e,s.componentProviders=0,tB(s,r,i&&!t),s}(r?Ote:Rte,t.length,r,i,l);!r&&m&&(t[p].providerFactory=y),CA(s,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(y),o.push(y)}else CA(s,n,f>-1?f:p,tB(t[r?p:f],l,!r&&i));!r&&i&&m&&t[p].componentProviders++}}}function CA(n,e,t,i){const r=Xc(e),s=function cX(n){return!!n.useClass}(e);if(r||s){const c=(s?Oe(e.useClass):e).prototype.ngOnDestroy;if(c){const l=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const u=l.indexOf(t);-1===u?l.push(t,[i,c]):l[u+1].push(i,c)}else l.push(t,c)}}}function tB(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function AA(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function Rte(n,e,t,i){return TA(this.multi,[])}function Ote(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=tl(t,t[Y],this.providerFactory.index,i);s=a.slice(0,o),TA(r,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],TA(r,s);return s}function TA(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Vt(n,e=[]){return t=>{t.providersResolver=(i,r)=>function Dte(n,e,t){const i=qe();if(i.firstCreatePass){const r=Ss(n);EA(t,i.data,i.blueprint,r,!0),EA(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}let Nte=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=Hw(0,t.type),r=i.length>0?function qC(n,e,t=null){return new tF({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=j({token:n,providedIn:"environment",factory:()=>new n(O(ki))})}}return n})();function Bi(n){Ki("NgStandalone"),n.getStandaloneInjector=e=>e.get(Nte).getOrCreateStandaloneInjector(n)}function vd(n,e,t){const i=Zi()+n,r=B();return r[i]===Ve?ro(r,i,t?e.call(t):e()):function qf(n,e){return n[e]}(r,i)}function rB(n,e,t,i,r,s){const o=e+t;return An(n,o,r)?ro(n,o+1,s?i.call(s,r):i(r)):function op(n,e){const t=n[e];return t===Ve?void 0:t}(n,o+1)}function Mn(n,e){const t=qe();let i;const r=n+ge;t.firstCreatePass?(i=function qte(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=$c(i.type)),a=dr(R);try{const c=u_(!1),l=s();return u_(c),function wA(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,B(),r,l),l}finally{dr(a)}}function In(n,e,t){const i=n+ge,r=B(),s=Kc(r,i);return function ap(n,e){return n[Y].data[e].pure}(r,i)?rB(r,Zi(),e,s.transform,t,s):s.transform(t)}const IB=new k(""),vy=new k("");let PA,RA=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,PA||(function Wne(n){PA=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ye.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t()},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static{this.\u0275fac=function(i){return new(i||n)(O(ye),O(OA),O(vy))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})(),OA=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return PA?.findTestabilityInTree(this,t,i)??null}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();function Qa(n){return!!n&&"function"==typeof n.then}function DB(n){return!!n&&"function"==typeof n.subscribe}const NA=new k("");let RB=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=D(NA,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(Qa(s))t.push(s);else if(DB(s)){const o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const up=new k("");let vr=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=D(SY),this.afterRenderEffectManager=D(X_),this.zonelessEnabled=D(jf),this.externalTestViews=new Set,this.beforeRender=new fe,this.afterTick=new fe,this.componentTypes=[],this.components=[],this.isStable=D(Zo).hasPendingTasks.pipe(le(t=>!t)),this._injector=D(ki)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof pk;if(!this._injector.get(RB).done)throw!r&&function Va(n){const e=Qe(n)||Xn(n)||yi(n);return null!==e&&e.standalone}(t),new H(405,!1);let o;o=r?t:this._injector.get(Ga).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function $ne(n){return n.isBoundToModule}(o)?void 0:this._injector.get(hl),l=o.create(gt.NULL,[],i||o.selector,a),u=l.location.nativeElement,d=l.injector.get(IB,null);return d?.registerApplication(u),l.onDestroy(()=>{this.detachView(l.hostView),by(this.components,l),d?.unregisterApplication(u)}),this._loadComponent(l),l}tick(){this._tick(!0)}_tick(t){if(this._runningTick)throw new H(101,!1);const i=z(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(t)}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,z(i),this.afterTick.next()}}detectChangesInAttachedViews(t){let i=null;this._injector.destroyed||(i=this._injector.get(RC,null,{optional:!0}));let r=0;const s=this.afterRenderEffectManager;for(;r<10;){const o=0===r;if(t||!o){this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)Yne(a,c,o,this.zonelessEnabled)}else i?.begin?.(),i?.end?.();if(r++,s.executeInternalCallbacks(),!this.allViews.some(({_lView:a})=>hf(a))&&(s.execute(),!this.allViews.some(({_lView:a})=>hf(a))))break}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;by(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(up,[]);[...this._bootstrapListeners,...i].forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>by(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new H(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function by(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function Yne(n,e,t,i){(t||hf(n))&&U_(n,e,t&&!i?0:1)}let eie=(()=>{class n{constructor(){this.zone=D(ye),this.changeDetectionScheduler=D(Ju),this.applicationRef=D(vr)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function kA({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new ye({...FA(),scheduleInRootZone:t}),[{provide:ye,useFactory:n},{provide:fr,multi:!0,useFactory:()=>{const i=D(eie,{optional:!0});return()=>i.initialize()}},{provide:fr,multi:!0,useFactory:()=>{const i=D(nie);return()=>{i.initialize()}}},!0===e?{provide:fk,useValue:!0}:[],{provide:DC,useValue:t??tP}]}function FA(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}let nie=(()=>{class n{constructor(){this.subscription=new kt,this.initialized=!1,this.zone=D(ye),this.pendingTasks=D(Zo)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ye.assertNotInAngularZone(),queueMicrotask(()=>{null!==t&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{ye.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),dp=(()=>{class n{constructor(){this.appRef=D(vr),this.taskService=D(Zo),this.ngZone=D(ye),this.zonelessEnabled=D(jf),this.disableScheduling=D(fk,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new kt,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(m_):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(D(DC,{optional:!0})??!1),this.cancelScheduledCallback=null,this.shouldRefreshViews=!1,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof xE||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&5===t)return;switch(t){case 3:case 2:case 0:case 4:case 5:case 1:this.shouldRefreshViews=!0}if(!this.shouldScheduleTick())return;const i=this.useMicrotaskScheduler?iP:nP;this.pendingRenderTaskId=this.taskService.add(),this.cancelScheduledCallback=this.scheduleInRootZone?Zone.root.run(()=>i(()=>this.tick(this.shouldRefreshViews))):this.ngZone.runOutsideAngular(()=>i(()=>this.tick(this.shouldRefreshViews)))}shouldScheduleTick(){return!(this.disableScheduling||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(m_+this.angularZoneId))}tick(t){if(this.runningTick||this.appRef.destroyed)return;const i=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick(t)},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(i),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,iP(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(i)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.shouldRefreshViews=!1,this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const ta=new k("",{providedIn:"root",factory:()=>D(ta,rt.Optional|rt.SkipSelf)||function iie(){return typeof $localize<"u"&&$localize.locale||uy}()}),BA=new k("");function Ey(n){return!!n.platformInjector}let ec=null;let br=(()=>{class n{static{this.__NG_ELEMENT_ID__=fie}}return n})();function fie(n){return function pie(n,e,t){if(Zc(n)&&!t){const i=Nr(n.index,e);return new Pf(i,i)}return 175&n.type?new Pf(e[dn],e):null}(Pt(),B(),!(16&~n))}class XB{constructor(){}supports(e){return Q_(e)}create(e){return new vie(e)}}const yie=(n,e)=>e;class vie{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||yie}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<ZB(i,r,s)?t:i,a=ZB(o,r,s),c=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const l=a-r,u=c-r;if(l!=u){for(let h=0;h<l;h++){const f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<l&&(s[h]=f+1)}s[o.previousIndex]=u-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Q_(e))throw new H(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function GJ(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new bie(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new YB),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new YB),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class bie{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class wie{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class YB{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new wie,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function ZB(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}function JB(){return new GA([new XB])}let GA=(()=>{class n{static{this.\u0275prov=j({token:n,providedIn:"root",factory:JB})}constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||JB()),deps:[[n,new jm,new xu]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new H(901,!1)}}return n})(),xie=(()=>{class n{constructor(t){}static{this.\u0275fac=function(i){return new(i||n)(O(vr))}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({})}}return n})();function Bie(n){try{const{rootComponent:e,appProviders:t,platformProviders:i}=n,r=function hie(n=[]){if(ec)return ec;const e=function HB(n=[],e){return gt.create({name:e,providers:[{provide:Ww,useValue:"platform"},{provide:BA,useValue:new Set([()=>ec=null])},...n]})}(n);return ec=e,function OB(){!function cw(n){_m=n}(()=>{throw new H(600,!1)})}(),function zB(n){n.get(MP,null)?.forEach(t=>t())}(e),e}(i),s=[kA({}),{provide:Ju,useExisting:dp},...t||[]];return function VB(n){const e=Ey(n)?n.r3Injector:n.moduleRef.injector,t=e.get(ye);return t.run(()=>{Ey(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();const i=e.get(pr,null);let r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:s=>{i.handleError(s)}})}),Ey(n)){const s=()=>e.destroy(),o=n.platformInjector.get(BA);o.add(s),e.onDestroy(()=>{r.unsubscribe(),o.delete(s)})}else n.moduleRef.onDestroy(()=>{by(n.allPlatformModules,n.moduleRef),r.unsubscribe()});return function Xne(n,e,t){try{const i=t();return Qa(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(i,t,()=>{const s=e.get(RB);return s.runInitializers(),s.donePromise.then(()=>{if(function xee(n){"string"==typeof n&&(nL=n.toLowerCase().replace(/_/g,"-"))}(e.get(ta,uy)||uy),Ey(n)){const a=e.get(vr);return void 0!==n.rootComponent&&a.bootstrap(n.rootComponent),a}return function lie(n,e){const t=n.injector.get(vr);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>t.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new H(-403,!1);n.instance.ngDoBootstrap(t)}e.push(n)}(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}({r3Injector:new tF({providers:s,parent:r,debugName:"",runEnvironmentInitializers:!1}).injector,platformInjector:r,rootComponent:e})}catch(e){return Promise.reject(e)}}const m2=new k("");function Fn(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function gp(n,e=NaN){return isNaN(parseFloat(n))||isNaN(Number(n))?e:Number(n)}function yl(n,e){Ki("NgSignals");const t=function oi(n){const e=Object.create(Ri);e.computation=n;const t=()=>{if(Gn(e),gn(e),e.value===bt)throw e.error;return e.value};return t[K]=e,t}(n);return e?.equal&&(t[K].equal=e.equal),t}function ss(n){const e=z(null);try{return n()}finally{z(e)}}function S2(n,e,t,i,r,s,o){try{var a=n[s](o),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(i,r)}function Q(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(c){S2(s,i,r,o,a,"next",c)}function a(c){S2(s,i,r,o,a,"throw",c)}o(void 0)})}}const XA={now:()=>(XA.delegate||Date).now(),delegate:void 0};class na extends fe{constructor(e=1/0,t=1/0,i=XA){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;t||(i.push(e),!r&&i.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:i,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=i?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<i.length&&i.splice(0,i.length-s),!r){const o=t.now();let a=0;for(let c=1;c<i.length&&i[c]<=o;c+=2)a=c;a&&i.splice(0,a+1)}}}function tt(n,e,t,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s}function KA(n,e){return function(t,i){e(t,i,n)}}function te(n,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,e)}function nc(n){return this instanceof nc?(this.v=n,this):new nc(n)}function R2(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function QA(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){!function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}(a,c,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const eT=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function O2(n){return $e(n?.then)}function P2(n){return $e(n[mu])}function N2(n){return Symbol.asyncIterator&&$e(n?.[Symbol.asyncIterator])}function k2(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const F2=function Dre(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function L2(n){return $e(n?.[F2])}function B2(n){return function D2(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},a("next"),a("throw"),a("return",function o(f){return function(p){return Promise.resolve(p).then(f,d)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(f,p){i[f]&&(r[f]=function(g){return new Promise(function(m,y){s.push([f,g,m,y])>1||c(f,g)})},p&&(r[f]=p(r[f])))}function c(f,p){try{!function l(f){f.value instanceof nc?Promise.resolve(f.value.v).then(u,d):h(s[0][2],f)}(i[f](p))}catch(g){h(s[0][3],g)}}function u(f){c("next",f)}function d(f){c("throw",f)}function h(f,p){f(p),s.shift(),s.length&&c(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield nc(t.read());if(r)return yield nc(void 0);yield yield nc(i)}}finally{t.releaseLock()}})}function V2(n){return $e(n?.getReader)}function li(n){if(n instanceof be)return n;if(null!=n){if(P2(n))return function Rre(n){return new be(e=>{const t=n[mu]();if($e(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(eT(n))return function Ore(n){return new be(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(O2(n))return function Pre(n){return new be(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Bh)})}(n);if(N2(n))return U2(n);if(L2(n))return function Nre(n){return new be(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(V2(n))return function kre(n){return U2(B2(n))}(n)}throw k2(n)}function U2(n){return new be(e=>{(function Fre(n,e){var t,i,r,s;return function M2(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(d){o(d)}}function c(u){try{l(i.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,c)}l((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=R2(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function ia(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function Dn(n,e,t=1/0){return $e(e)?Dn((i,r)=>le((s,o)=>e(i,s,r,o))(li(n(i,r))),t):("number"==typeof e&&(t=e),Ft((i,r)=>function Lre(n,e,t,i,r,s,o,a){const c=[];let l=0,u=0,d=!1;const h=()=>{d&&!c.length&&!l&&e.complete()},f=g=>l<i?p(g):c.push(g),p=g=>{s&&e.next(g),l++;let m=!1;li(t(g,u++)).subscribe(It(e,y=>{r?.(y),s?f(y):e.next(y)},()=>{m=!0},void 0,()=>{if(m)try{for(l--;c.length&&l<i;){const y=c.shift();o?ia(e,o,()=>p(y)):p(y)}h()}catch(y){e.error(y)}}))};return n.subscribe(It(e,f,()=>{d=!0,h()})),()=>{a?.()}}(i,r,n,t)))}function Oy(n=1/0){return Dn(Ys,n)}const Br=new be(n=>n.complete());function j2(n){return n&&$e(n.schedule)}function tT(n){return n[n.length-1]}function H2(n){return $e(tT(n))?n.pop():void 0}function mp(n){return j2(tT(n))?n.pop():void 0}function z2(n,e=0){return Ft((t,i)=>{t.subscribe(It(i,r=>ia(i,n,()=>i.next(r),e),()=>ia(i,n,()=>i.complete(),e),r=>ia(i,n,()=>i.error(r),e)))})}function G2(n,e=0){return Ft((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function W2(n,e){if(!n)throw new Error("Iterable cannot be null");return new be(t=>{ia(t,e,()=>{const i=n[Symbol.asyncIterator]();ia(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Ln(n,e){return e?function $re(n,e){if(null!=n){if(P2(n))return function jre(n,e){return li(n).pipe(G2(e),z2(e))}(n,e);if(eT(n))return function zre(n,e){return new be(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(O2(n))return function Hre(n,e){return li(n).pipe(G2(e),z2(e))}(n,e);if(N2(n))return W2(n,e);if(L2(n))return function Gre(n,e){return new be(t=>{let i;return ia(t,e,()=>{i=n[F2](),ia(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>$e(i?.return)&&i.return()})}(n,e);if(V2(n))return function Wre(n,e){return W2(B2(n),e)}(n,e)}throw k2(n)}(n,e):li(n)}function vl(...n){const e=mp(n),t=function Ure(n,e){return"number"==typeof tT(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?li(i[0]):Oy(t)(Ln(i,e)):Br}function pn(n,e){return Ft((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(It(i,c=>{r?.unsubscribe();let l=0;const u=s++;li(n(c,u)).subscribe(r=It(i,d=>i.next(e?e(c,d,u,l++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}const Py={schedule(n,e){const t=setTimeout(n,e);return()=>clearTimeout(t)},scheduleBeforeRender(n){if(typeof window>"u")return Py.schedule(n,0);if(typeof window.requestAnimationFrame>"u")return Py.schedule(n,16);const e=window.requestAnimationFrame(n);return()=>window.cancelAnimationFrame(e)}};let nT;function tse(n,e,t){let i=t;return function Xre(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}(n)&&e.some((r,s)=>!("*"===r||!function Zre(n,e){if(!nT){const t=Element.prototype;nT=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE&&nT.call(n,e)}(n,r)||(i=s,0))),i}class ise{constructor(e,t){this.componentFactory=t.get(Ga).resolveComponentFactory(e)}create(e){return new rse(this.componentFactory,e)}}class rse{constructor(e,t){this.componentFactory=e,this.injector=t,this.eventEmitters=new na(1),this.events=this.eventEmitters.pipe(pn(i=>vl(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(ye),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=Py.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,t,i){this.runInZone(()=>{i&&(t=i.call(this.componentRef?.instance,t)),null!==this.componentRef?function Kre(n,e){return n===e||n!=n&&e!=e}(t,this.getInputValue(e))&&(void 0!==t||!this.unchangedInputs.has(e))||(this.recordInputChange(e,t),this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.instance[e]=t,this.scheduleDetectChanges()):this.initialInputValues.set(e,t)})}initializeComponent(e){const t=gt.create({providers:[],parent:this.injector}),i=function ese(n,e){const t=n.childNodes,i=e.map(()=>[]);let r=-1;e.some((s,o)=>"*"===s&&(r=o,!0));for(let s=0,o=t.length;s<o;++s){const a=t[s],c=tse(a,e,r);-1!==c&&i[c].push(a)}return i}(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(t,i,e),this.viewChangeDetectorRef=this.componentRef.injector.get(br),this.implementsOnChanges=function Yre(n){return"function"==typeof n}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(vr).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:e,transform:t})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e),t)}),this.initialInputValues.clear()}initializeOutputs(e){const t=this.componentFactory.outputs.map(({propName:i,templateName:r})=>e.instance[i].pipe(le(o=>({name:r,value:o}))));this.eventEmitters.next(t)}callNgOnChanges(e){if(!this.implementsOnChanges||null===this.inputChanges)return;const t=this.inputChanges;this.inputChanges=null,e.instance.ngOnChanges(t)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=Py.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(e,t){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const i=this.inputChanges[e];if(i)return void(i.currentValue=t);const r=this.unchangedInputs.has(e),s=r?void 0:this.getInputValue(e);this.inputChanges[e]=new lO(s,t,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}class sse extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}let $2=null;function ic(){return $2}class cse{}const nt=new k("");let q2=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:()=>D(lse),providedIn:"platform"})}}return n})(),lse=(()=>{class n extends q2{constructor(){super(),this._doc=D(nt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ic().getBaseHref(this._doc)}onPopState(t){const i=ic().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=ic().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:()=>new n,providedIn:"platform"})}}return n})();function X2(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function Y2(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function bl(n){return n&&"?"!==n[0]?"?"+n:n}let Ny=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:()=>D(dse),providedIn:"root"})}}return n})();const use=new k("");let dse=(()=>{class n extends Ny{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??D(nt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return X2(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+bl(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+bl(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+bl(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(i){return new(i||n)(O(q2),O(use,8))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),wl=(()=>{class n{constructor(t){this._subject=new Ae,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function pse(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(Y2(Z2(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+bl(i))}normalize(t){return n.stripTrailingSlash(function fse(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,Z2(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+bl(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+bl(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static{this.normalizeQueryParams=bl}static{this.joinWithSlash=X2}static{this.stripTrailingSlash=Y2}static{this.\u0275fac=function(i){return new(i||n)(O(Ny))}}static{this.\u0275prov=j({token:n,factory:()=>function hse(){return new wl(O(Ny))}(),providedIn:"root"})}}return n})();function Z2(n){return n.replace(/\/index.html$/,"")}function sV(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}class eoe{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let $y=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new eoe(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),cV(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{cV(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}static{this.\u0275fac=function(i){return new(i||n)(R(Qi),R(Ds),R(GA))}}static{this.\u0275dir=se({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return n})();function cV(n,e){n.context.$implicit=e.item}let fT=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new toe,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){lV("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){lV("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static{this.\u0275fac=function(i){return new(i||n)(R(Qi),R(Ds))}}static{this.\u0275dir=se({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return n})();class toe{constructor(){this.$implicit=null,this.ngIf=null}}function lV(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${qn(e)}'.`)}class roe{createSubscription(e,t){return ss(()=>e.subscribe({next:t,error:i=>{throw i}}))}dispose(e){ss(()=>e.unsubscribe())}}class soe{createSubscription(e,t){return e.then(t,i=>{throw i})}dispose(e){}}const ooe=new soe,aoe=new roe;let qy=(()=>{class n{constructor(t){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){if(!this._obj){if(t)try{this.markForCheckOnValueUpdate=!1,this._subscribe(t)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i))}_selectStrategy(t){if(Qa(t))return ooe;if(DB(t))return aoe;throw function Ls(n,e){return new H(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static{this.\u0275fac=function(i){return new(i||n)(R(br,16))}}static{this.\u0275pipe=Pi({name:"async",type:n,pure:!1,standalone:!0})}}return n})(),Cd=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({})}}return n})();const hV="browser";function rc(n){return n===hV}function yT(n){return"server"===n}class fV{}class eae extends cse{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class ET extends eae{static makeCurrent(){!function ase(n){$2??=n}(new ET)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function tae(){return bp=bp||document.querySelector("base"),bp?bp.getAttribute("href"):null}();return null==t?null:function nae(n){return new URL(n,document.baseURI).pathname}(t)}resetBaseElement(){bp=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return sV(document.cookie,e)}}let bp=null,rae=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();const Ky=new k("");let CV=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new H(5101,!1);return this._eventNameToPlugin.set(t,i),i}static{this.\u0275fac=function(i){return new(i||n)(O(Ky),O(ye))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();class CT{constructor(e){this._doc=e}}const AT="ng-app-id";let AV=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=yT(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${AT}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(AT),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(AT,this.appId),t.appendChild(o),o}}addStyleToHost(t,i){const r=this.getStyleElement(t,i),s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(i){return new(i||n)(O(nt),O(zu),O(v_,8),O(is))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();const TT={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},xT=/%COMP%/g,cae=new k("",{providedIn:"root",factory:()=>!0});function xV(n,e){return e.map(t=>t.replace(xT,n))}let SV=(()=>{class n{constructor(t,i,r,s,o,a,c,l=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=yT(a),this.defaultRenderer=new ST(t,o,c,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===As.ShadowDom&&(i={...i,encapsulation:As.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof IV?r.applyToHost(t):r instanceof MT&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(i.encapsulation){case As.Emulated:s=new IV(c,l,i,this.appId,u,o,a,d);break;case As.ShadowDom:return new hae(c,l,t,i,o,a,this.nonce,d);default:s=new MT(c,l,i,u,o,a,d)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(i){return new(i||n)(O(CV),O(AV),O(zu),O(cae),O(nt),O(is),O(ye),O(v_))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();class ST{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(TT[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(MV(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(MV(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new H(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=TT[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=TT[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(za.DashCase|za.Important)?e.style.setProperty(t,i,r&za.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&za.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){null!=e&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=ic().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function MV(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class hae extends ST{constructor(e,t,i,r,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=xV(r.id,r.styles);for(const u of l){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class MT extends ST{constructor(e,t,i,r,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=c?xV(c,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class IV extends MT{constructor(e,t,i,r,s,o,a,c){const l=r+"-"+i.id;super(e,t,i,s,o,a,c,l),this.contentAttr=function lae(n){return"_ngcontent-%COMP%".replace(xT,n)}(l),this.hostAttr=function uae(n){return"_nghost-%COMP%".replace(xT,n)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let fae=(()=>{class n extends CT{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static{this.\u0275fac=function(i){return new(i||n)(O(nt))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})(),pae=(()=>{class n extends CT{constructor(t){super(t),this.delegate=D(m2,{optional:!0})}supports(t){return!!this.delegate&&this.delegate.supports(t)}addEventListener(t,i,r){return this.delegate.addEventListener(t,i,r)}removeEventListener(t,i,r){return this.delegate.removeEventListener(t,i,r)}static{this.\u0275fac=function(i){return new(i||n)(O(nt))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();const DV=["alt","control","meta","shift"],gae={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},mae={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let _ae=(()=>{class n extends CT{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ic().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),DV.forEach(l=>{const u=i.indexOf(l);u>-1&&(i.splice(u,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const c={};return c.domEventName=r,c.fullKey=o,c}static matchEventFullKeyCode(t,i){let r=gae[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),DV.forEach(o=>{o!==r&&(0,mae[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static{this.\u0275fac=function(i){return new(i||n)(O(nt))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();const Eae=[{provide:is,useValue:hV},{provide:MP,useValue:function vae(){ET.makeCurrent()},multi:!0},{provide:nt,useFactory:function wae(){return function KY(n){DE=n}(document),document},deps:[]}],Cae=new k(""),OV=[{provide:vy,useClass:class iae{addToWindow(e){Lt.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new H(5103,!1);return s},Lt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Lt.getAllAngularRootElements=()=>e.getAllRootElements(),Lt.frameworkStabilizers||(Lt.frameworkStabilizers=[]),Lt.frameworkStabilizers.push(i=>{const r=Lt.getAllAngularTestabilities();let s=r.length;const o=function(){s--,0==s&&i()};r.forEach(a=>{a.whenStable(o)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?ic().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:IB,useClass:RA,deps:[ye,OA,vy]},{provide:RA,useClass:RA,deps:[ye,OA,vy]}],PV=[{provide:Ww,useValue:"root"},{provide:pr,useFactory:function bae(){return new pr},deps:[]},{provide:Ky,useClass:fae,multi:!0,deps:[nt,ye,is]},{provide:Ky,useClass:_ae,multi:!0,deps:[nt]},{provide:Ky,useClass:pae,multi:!0},SV,AV,CV,{provide:RC,useExisting:SV},{provide:fV,useClass:rae,deps:[]},[]];let Aae=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:zu,useValue:t.appId}]}}static{this.\u0275fac=function(i){return new(i||n)(O(Cae,12))}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({providers:[...PV,...OV],imports:[Cd,xie]})}}return n})(),wp=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:function(i){let r=null;return r=i?new(i||n):O(Iae),r},providedIn:"root"})}}return n})(),Iae=(()=>{class n extends wp{constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case wi.NONE:return i;case wi.HTML:return no(i,"HTML")?kr(i):KP(this._doc,String(i)).toString();case wi.STYLE:return no(i,"Style")?kr(i):i;case wi.SCRIPT:if(no(i,"Script"))return kr(i);throw new H(5200,!1);case wi.URL:return no(i,"URL")?kr(i):I_(String(i));case wi.RESOURCE_URL:if(no(i,"ResourceURL"))return kr(i);throw new H(5201,!1);default:throw new H(5202,!1)}}bypassSecurityTrustHtml(t){return function yZ(n){return new hZ(n)}(t)}bypassSecurityTrustStyle(t){return function vZ(n){return new fZ(n)}(t)}bypassSecurityTrustScript(t){return function bZ(n){return new pZ(n)}(t)}bypassSecurityTrustUrl(t){return function wZ(n){return new gZ(n)}(t)}bypassSecurityTrustResourceUrl(t){return function EZ(n){return new mZ(n)}(t)}static{this.\u0275fac=function(i){return new(i||n)(O(nt))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const Ep=Da(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function wt(n,e){return Ft((t,i)=>{let r=0;t.subscribe(It(i,s=>n.call(e,s,r++)&&i.next(s)))})}function Bs(n){return!!n&&(n instanceof be||$e(n.lift)&&$e(n.subscribe))}const Qy={schedule(n,e){const t=setTimeout(n,e);return()=>clearTimeout(t)},scheduleBeforeRender(n){if(typeof window>"u")return Qy.schedule(n,0);if(typeof window.requestAnimationFrame>"u")return Qy.schedule(n,16);const e=window.requestAnimationFrame(n);return()=>window.cancelAnimationFrame(e)}};let IT;function Uae(n,e,t){let i=t;return function Fae(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}(n)&&e.some((r,s)=>!("*"===r||!function Lae(n,e){if(!IT){const t=Element.prototype;IT=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE&&IT.call(n,e)}(n,r)||(i=s,0))),i}class Hae{constructor(e){this.component=e}create(e){return new zae(this.component,e)}}class zae{constructor(e,t){this.component=e,this.injector=t,this.eventEmitters=new na(1),this.events=this.eventEmitters.pipe(pn(i=>vl(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.hasInputChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.componentMirror=function dre(n){const e=Qe(n);if(!e)return null;const t=new Gf(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(this.component),this.unchangedInputs=new Set(this.componentMirror.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(ye),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=Qy.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>{if(null===this.componentRef)return this.initialInputValues.get(e);const t=this.componentRef.instance[e];return function Wf(n){return"function"==typeof n&&void 0!==n[K]}(t)?t():t})}setInputValue(e,t,i){this.runInZone(()=>{i&&(t=i.call(this.componentRef?.instance,t)),null!==this.componentRef?function Bae(n,e){return n===e||n!=n&&e!=e}(t,this.getInputValue(e))&&(void 0!==t||!this.unchangedInputs.has(e))||(this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.setInput(e,t),this.scheduleDetectChanges()):this.initialInputValues.set(e,t)})}initializeComponent(e){const t=this.injector.get(ki),i=gt.create({providers:[],parent:this.injector}),r=function Vae(n,e){const t=n.childNodes,i=e.map(()=>[]);let r=-1;e.some((s,o)=>"*"===s&&(r=o,!0));for(let s=0,o=t.length;s<o;++s){const a=t[s],c=Uae(a,e,r);-1!==c&&i[c].push(a)}return i}(e,[...this.componentMirror.ngContentSelectors]);this.componentRef=function ure(n,e){const t=Qe(n),i=e.elementInjector||Zm();return new Gf(t).create(i,e.projectableNodes,e.hostElement,e.environmentInjector)}(this.component,{environmentInjector:t,elementInjector:i,projectableNodes:r,hostElement:e}),this.viewChangeDetectorRef=this.componentRef.injector.get(br),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(vr).attachView(this.componentRef.hostView)}initializeInputs(){this.componentMirror.inputs.forEach(({propName:e,transform:t})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e),t)}),this.initialInputValues.clear()}initializeOutputs(e){const t=this.componentMirror.outputs.map(({propName:i,templateName:r})=>{const s=e.instance[i];return(Bs(s)?s:function Oae(n){const e=function MY(n){return n.destroyRef}(n);return new be(t=>{e?.onDestroy(()=>t.complete());const i=n.subscribe(r=>t.next(r));return()=>i.unsubscribe()})}(s)).pipe(le(a=>({name:r,value:a})))});this.eventEmitters.next(t)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=Qy.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}detectChanges(){null!==this.componentRef&&(this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}function DT(){return(DT=Q(function*(n,e,t){const{injector:i}=yield function yae(n){return Bie(function RV(n){return{appProviders:[...PV,...n?.providers??[]],platformProviders:Eae}}(n))}(t),o=function Gae(n,e){return class t extends n{get instance(){return this.ngElementStrategy.componentRef?.instance}whenStable(){return Q(function*(){const r=e.get(vr);yield function Dae(n,e){const t="object"==typeof e;return new Promise((i,r)=>{const s=new jo({next:o=>{i(o),s.unsubscribe()},error:r,complete:()=>{t?i(e.defaultValue):r(new Ep)}});n.subscribe(s)})}(r.isStable.pipe(wt(s=>s)))})()}}}(function ose(n,e){const t=function Qre(n,e){return e.get(Ga).resolveComponentFactory(n).inputs}(n,e.injector),i=e.strategyFactory||new ise(n,e.injector),r=function Jre(n){const e={};return n.forEach(({propName:t,templateName:i,transform:r})=>{e[function qre(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}(i)]=[t,r]}),e}(t);class s extends sse{static{this.observedAttributes=Object.keys(r)}get ngElementStrategy(){if(!this._ngElementStrategy){const a=this._ngElementStrategy=i.create(this.injector||e.injector);t.forEach(({propName:c,transform:l})=>{if(!this.hasOwnProperty(c))return;const u=this[c];delete this[c],a.setInputValue(c,u,l)})}return this._ngElementStrategy}constructor(a){super(),this.injector=a}attributeChangedCallback(a,c,l,u){const[d,h]=r[a];this.ngElementStrategy.setInputValue(d,l,h)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{const c=new CustomEvent(a.name,{detail:a.value});this.dispatchEvent(c)})}}return t.forEach(({propName:o,transform:a})=>{Object.defineProperty(s.prototype,o,{get(){return this.ngElementStrategy.getInputValue(o)},set(c){this.ngElementStrategy.setInputValue(o,c,a)},configurable:!0,enumerable:!0})}),s}(e,{injector:i,strategyFactory:new Hae(e)}),i);return customElements.define(n,o),o})).apply(this,arguments)}let $ae=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({imports:[Cd]})}}return n})();function Cp(n){return(Cp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(n)}function w(n,e,t){return(e=function Xae(n){var e=function qae(n,e){if("object"!=Cp(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var i=t.call(n,e||"default");if("object"!=Cp(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==Cp(e)?e:e+""}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function BV(n){if(typeof window<"u"&&"object"==typeof window.process&&"renderer"===window.process.type||typeof process<"u"&&"object"==typeof process.versions&&process.versions.electron)return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,t=n||e;return!!(t&&t.indexOf("Electron")>=0)}function uo(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||BV()}const VV=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";uo();class Zae{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";w(this,"storage",void 0),w(this,"id",void 0),w(this,"config",void 0),this.storage=function Yae(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch{return null}}(i),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function RT(n,e,t){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const r=n.src.replace(/\(/g,"%28").replace(/\)/g,"%29");n.width>i&&(t=Math.min(t,i/n.width));const s=n.width*t,o=n.height*t,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let ev;var n;function UV(n){return"string"==typeof n?ev[n.toUpperCase()]||ev.WHITE:n}function tv(n,e){if(!n)throw new Error(e||"Assertion failed")}(n=ev||(ev={}))[n.BLACK=30]="BLACK",n[n.RED=31]="RED",n[n.GREEN=32]="GREEN",n[n.YELLOW=33]="YELLOW",n[n.BLUE=34]="BLUE",n[n.MAGENTA=35]="MAGENTA",n[n.CYAN=36]="CYAN",n[n.WHITE=37]="WHITE",n[n.BRIGHT_BLACK=90]="BRIGHT_BLACK",n[n.BRIGHT_RED=91]="BRIGHT_RED",n[n.BRIGHT_GREEN=92]="BRIGHT_GREEN",n[n.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",n[n.BRIGHT_BLUE=94]="BRIGHT_BLUE",n[n.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",n[n.BRIGHT_CYAN=96]="BRIGHT_CYAN",n[n.BRIGHT_WHITE=97]="BRIGHT_WHITE";const sc={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:"object"==typeof process&&process},nv=sc.window||sc.self||sc.global,Ap=sc.process||{};function Td(){let n;var e,t;if(uo&&"performance"in nv)n=null==nv||null===(e=nv.performance)||void 0===e||null===(t=e.now)||void 0===t?void 0:t.call(e);else if("hrtime"in Ap){var i;const r=null==Ap||null===(i=Ap.hrtime)||void 0===i?void 0:i.call(Ap);n=1e3*r[0]+r[1]/1e6}else n=Date.now();return n}const xd={debug:uo&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},ice={enabled:!0,level:0};function cs(){}const jV={},HV={once:!0};class Tp{constructor(){let{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};w(this,"id",void 0),w(this,"VERSION",VV),w(this,"_startTs",Td()),w(this,"_deltaTs",Td()),w(this,"_storage",void 0),w(this,"userData",{}),w(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new Zae("__probe-".concat(this.id,"__"),ice),this.timeStamp("".concat(this.id," started")),function nce(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const t=Object.getPrototypeOf(n),i=Object.getOwnPropertyNames(t);for(const r of i)"function"==typeof n[r]&&(e.find(s=>r===s)||(n[r]=n[r].bind(n)))}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Td()-this._startTs).toPrecision(10))}getDelta(){return Number((Td()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){return this._storage.setConfiguration({enabled:!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){tv(e,t)}warn(e){return this._getLogFunction(0,e,xd.warn,arguments,HV)}error(e){return this._getLogFunction(0,e,xd.error,arguments)}deprecated(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}removed(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}probe(e,t){return this._getLogFunction(e,t,xd.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,xd.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];return this._getLogFunction(e,t,xd.debug||xd.info,arguments,HV)}table(e,t,i){return t?this._getLogFunction(e,t,console.table||cs,i&&[i],{tag:ace(t)}):cs}image(e){let{logLevel:t,priority:i,image:r,message:s="",scale:o=1}=e;return this._shouldLog(t||i)?uo?function oce(n){let{image:e,message:t="",scale:i=1}=n;if("string"==typeof e){const s=new Image;return s.onload=()=>{const o=RT(s,t,i);console.log(...o)},s.src=e,cs}const r=e.nodeName||"";if("img"===r.toLowerCase())return console.log(...RT(e,t,i)),cs;if("canvas"===r.toLowerCase()){const s=new Image;return s.onload=()=>console.log(...RT(s,t,i)),s.src=e.toDataURL(),cs}return cs}({image:r,message:s,scale:o}):function sce(n){let{message:t="",scale:i=1}=n;return console.warn("removed"),cs}({image:r,message:s,scale:o}):cs}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||cs)}group(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const r=GV({logLevel:e,message:t,opts:i}),{collapsed:s}=i;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,t){return this.group(e,t,Object.assign({},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||cs)}withGroup(e,t,i){this.group(e,t)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=zV(e)}_getLogFunction(e,t,i,r,s){if(this._shouldLog(e)){s=GV({logLevel:e,message:t,args:r,opts:s}),tv(i=i||s.method),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Td();const o=s.tag||s.message;if(s.once){if(jV[o])return cs;jV[o]=Td()}return t=function rce(n,e,t){if("string"==typeof e){const i=t.time?function Jae(n){const t=Math.max((arguments.length>1&&void 0!==arguments[1]?arguments[1]:8)-n.length,0);return"".concat(" ".repeat(t)).concat(n)}(function Kae(n){let e;return e=n<10?"".concat(n.toFixed(2),"ms"):n<100?"".concat(n.toFixed(1),"ms"):n<1e3?"".concat(n.toFixed(0),"ms"):"".concat((n/1e3).toFixed(2),"s"),e}(t.total)):"";e=function tce(n,e,t){return!uo&&"string"==typeof n&&(e&&(e=UV(e),n="\x1b[".concat(e,"m").concat(n,"\x1b[39m")),t&&(e=UV(t),n="\x1b[".concat(t+10,"m").concat(n,"\x1b[49m"))),n}(e=t.time?"".concat(n,": ").concat(i,"  ").concat(e):"".concat(n,": ").concat(e),t.color,t.background)}return e}(this.id,s.message,s),i.bind(console,t,...s.args)}return cs}}function zV(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return tv(Number.isFinite(e)&&e>=0),e}function GV(n){const{logLevel:e,message:t}=n;n.logLevel=zV(e);const i=n.args?Array.from(n.args):[];for(;i.length&&i.shift()!==t;);switch(typeof e){case"string":case"function":void 0!==t&&i.unshift(t),n.message=e;break;case"object":Object.assign(n,e)}"function"==typeof n.message&&(n.message=n.message());const r=typeof n.message;return tv("string"===r||"object"===r),Object.assign(n,{args:i},n.opts)}function ace(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}w(Tp,"VERSION",VV);const ot=new Tp({id:"deck"}),xp=new class cce{constructor(e={}){w(this,"_pool",[]),w(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,{size:i=1,type:r,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:c}){const l=r||e&&e.constructor||Float32Array,u=t*i+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new l(e.buffer,0,u)}let d=1/0;c&&(d=c*i+s);const h=this._allocate(l,u,a,d);return e&&o?h.set(e):a||h.fill(0,0,4),this._release(e),h}release(e){this._release(e)}_allocate(e,t,i,r){let s=Math.max(Math.ceil(t*this.opts.overAlloc),1);s>r&&(s=r);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,c=o.findIndex(l=>l.byteLength>=a);if(c>=0){const l=new e(o.splice(c,1)[0],0,s);return i&&l.fill(0),l}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:i}=e,{byteLength:r}=i,s=t.findIndex(o=>o.byteLength>=r);s<0?t.push(i):(s>0||t.length<this.opts.poolSize)&&t.splice(s,0,i),t.length>this.opts.poolSize&&t.shift()}},Rn=(Math,Math,{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0});function dce(n,{precision:e=Rn.precision}={}){return n=function gce(n){return Math.round(n/Rn.EPSILON)*Rn.EPSILON}(n),"".concat(parseFloat(n.toPrecision(e)))}function oa(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Ai(n,e,t){return function aa(n,e,t){if(oa(n)){const i=n;t=t||function mce(n){return n.clone?n.clone():new Array(n.length)}(i);for(let r=0;r<t.length&&r<i.length;++r)t[r]=e(n[r],r,t);return t}return e(n)}(n,i=>Math.max(e,Math.min(t,i)))}function iv(n,e,t){return oa(n)?n.map((i,r)=>iv(i,e[r],t)):t*e+(1-t)*n}function Sd(n,e,t){const i=Rn.EPSILON;t&&(Rn.EPSILON=t);try{if(n===e)return!0;if(oa(n)&&oa(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!Sd(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):"number"==typeof n&&"number"==typeof e&&Math.abs(n-e)<=Rn.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{Rn.EPSILON=i}}class OT extends(function _ce(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:oa(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Rn)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+dce(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!Sd(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){if(void 0===i)return this.lerp(this,e,t);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if("number"==typeof e)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(Rn.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}get elements(){return this}}function qt(n){if(!Number.isFinite(n))throw new Error("Invalid number ".concat(n));return n}function rv(n,e,t=""){if(Rn.debug&&!function yce(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error("math.gl: ".concat(t," some fields set to invalid numbers'"));return n}function $V(n,e){if(!n)throw new Error("math.gl assertion ".concat(e))}class qV extends OT{get x(){return this[0]}set x(e){this[0]=qt(e)}get y(){return this[1]}set y(e){this[1]=qt(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return qt(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return qt(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return $V(e>=0&&e<this.ELEMENTS,"index is out of range"),qt(this[e])}setComponent(e,t){return $V(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var ho=1e-6,wr=typeof Float32Array<"u"?Float32Array:Array;function XV(){var n=new wr(3);return wr!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function YV(n,e,t){var i=new wr(3);return i[0]=n,i[1]=e,i[2]=t,i}function ZV(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function sv(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],c=t[2];return n[0]=r*c-s*a,n[1]=s*o-i*c,n[2]=i*a-r*o,n}function PT(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s+t[15];return n[0]=(t[0]*i+t[4]*r+t[8]*s+t[12])/(o=o||1),n[1]=(t[1]*i+t[5]*r+t[9]*s+t[13])/o,n[2]=(t[2]*i+t[6]*r+t[10]*s+t[14])/o,n}function KV(n,e,t){var i=t[0],r=t[1],s=t[2],a=e[0],c=e[1],l=e[2],u=r*l-s*c,d=s*a-i*l,h=i*c-r*a,f=r*h-s*d,p=s*u-i*h,g=i*d-r*u,m=2*t[3];return d*=m,h*=m,p*=2,g*=2,n[0]=a+(u*=m)+(f*=2),n[1]=c+d+p,n[2]=l+h+g,n}Math,Math,Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});function JV(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;return n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o,n}XV();const NT=[0,0,0];let ov;class Vi extends qV{static get ZERO(){return ov||(ov=new Vi(0,0,0),Object.freeze(ov)),ov}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&oa(e)?this.copy(e):(Rn.debug&&(qt(e),qt(t),qt(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Rn.debug&&(qt(e.x),qt(e.y),qt(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=qt(e)}angle(e){return function Mce(n,e){var t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2],u=Math.sqrt(t*t+i*i+r*r)*Math.sqrt(s*s+o*o+a*a),d=u&&ZV(n,e)/u;return Math.acos(Math.min(Math.max(d,-1),1))}(this,e)}cross(e){return sv(this,this,e),this.check()}rotateX({radians:e,origin:t=NT}){return function Tce(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}rotateY({radians:e,origin:t=NT}){return function xce(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=NT}){return function Sce(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return PT(this,this,e),this.check()}transformAsVector(e){return JV(this,this,e),this.check()}transformByMatrix3(e){return function Ace(n,e,t){var i=e[0],r=e[1],s=e[2];n[0]=i*t[0]+r*t[3]+s*t[6],n[1]=i*t[1]+r*t[4]+s*t[7],n[2]=i*t[2]+r*t[5]+s*t[8]}(this,this,e),this.check()}transformByMatrix2(e){return function Oce(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return KV(this,this,e),this.check()}}const QV=new Vi;function Md(n,e,t,i){QV.set(n,e,t);const r=QV.len();return{distance:i/r,normal:new Vi(-n/r,-e/r,-t/r)}}function Bce(n){return n-Math.fround(n)}let Mp;function kT(n,e){const{size:t=1,startIndex:i=0}=e,r=void 0!==e.endIndex?e.endIndex:n.length,s=(r-i)/t;Mp=xp.allocate(Mp,s,{type:Float32Array,size:2*t});let o=i,a=0;for(;o<r;){for(let c=0;c<t;c++){const l=n[o++];Mp[a+c]=l,Mp[a+c+t]=Bce(l)}a+=2*t}return Mp.subarray(0,s*t*2)}class Vce extends OT{toString(){let e="[";if(Rn.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=qt(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}function FT(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=e[9],h=e[10],f=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=t*a-i*o,_=t*c-r*o,E=t*l-s*o,A=i*c-r*a,x=i*l-s*a,I=r*l-s*c,S=u*g-d*p,F=u*m-h*p,U=u*y-f*p,V=d*m-h*g,G=d*y-f*g,P=h*y-f*m,L=v*P-_*G+E*V+A*U-x*F+I*S;return L?(n[0]=(a*P-c*G+l*V)*(L=1/L),n[1]=(r*G-i*P-s*V)*L,n[2]=(g*I-m*x+y*A)*L,n[3]=(h*x-d*I-f*A)*L,n[4]=(c*U-o*P-l*F)*L,n[5]=(t*P-r*U+s*F)*L,n[6]=(m*E-p*I-y*_)*L,n[7]=(u*I-h*E+f*_)*L,n[8]=(o*G-a*U+l*S)*L,n[9]=(i*U-t*G-s*S)*L,n[10]=(p*x-g*E+y*v)*L,n[11]=(d*E-u*x-f*v)*L,n[12]=(a*F-o*V-c*S)*L,n[13]=(t*V-i*F+r*S)*L,n[14]=(g*_-p*A-m*v)*L,n[15]=(u*A-d*_+h*v)*L,n):null}function Cl(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],d=e[8],h=e[9],f=e[10],p=e[11],g=e[12],m=e[13],y=e[14],v=e[15],_=t[0],E=t[1],A=t[2],x=t[3];return n[0]=_*i+E*a+A*d+x*g,n[1]=_*r+E*c+A*h+x*m,n[2]=_*s+E*l+A*f+x*y,n[3]=_*o+E*u+A*p+x*v,n[4]=(_=t[4])*i+(E=t[5])*a+(A=t[6])*d+(x=t[7])*g,n[5]=_*r+E*c+A*h+x*m,n[6]=_*s+E*l+A*f+x*y,n[7]=_*o+E*u+A*p+x*v,n[8]=(_=t[8])*i+(E=t[9])*a+(A=t[10])*d+(x=t[11])*g,n[9]=_*r+E*c+A*h+x*m,n[10]=_*s+E*l+A*f+x*y,n[11]=_*o+E*u+A*p+x*v,n[12]=(_=t[12])*i+(E=t[13])*a+(A=t[14])*d+(x=t[15])*g,n[13]=_*r+E*c+A*h+x*m,n[14]=_*s+E*l+A*f+x*y,n[15]=_*o+E*u+A*p+x*v,n}function av(n,e,t){var o,a,c,l,u,d,h,f,p,g,m,y,i=t[0],r=t[1],s=t[2];return e===n?(n[12]=e[0]*i+e[4]*r+e[8]*s+e[12],n[13]=e[1]*i+e[5]*r+e[9]*s+e[13],n[14]=e[2]*i+e[6]*r+e[10]*s+e[14],n[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(a=e[1],c=e[2],l=e[3],u=e[4],d=e[5],h=e[6],f=e[7],p=e[8],g=e[9],m=e[10],y=e[11],n[0]=o=e[0],n[1]=a,n[2]=c,n[3]=l,n[4]=u,n[5]=d,n[6]=h,n[7]=f,n[8]=p,n[9]=g,n[10]=m,n[11]=y,n[12]=o*i+u*r+p*s+e[12],n[13]=a*i+d*r+g*s+e[13],n[14]=c*i+h*r+m*s+e[14],n[15]=l*i+f*r+y*s+e[15]),n}function LT(n,e,t){var i=t[0],r=t[1],s=t[2];return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function eU(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[4],o=e[5],a=e[6],c=e[7],l=e[8],u=e[9],d=e[10],h=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=s*r+l*i,n[5]=o*r+u*i,n[6]=a*r+d*i,n[7]=c*r+h*i,n[8]=l*r-s*i,n[9]=u*r-o*i,n[10]=d*r-a*i,n[11]=h*r-c*i,n}function tU(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],c=e[3],l=e[4],u=e[5],d=e[6],h=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r+l*i,n[1]=o*r+u*i,n[2]=a*r+d*i,n[3]=c*r+h*i,n[4]=l*r-s*i,n[5]=u*r-o*i,n[6]=d*r-a*i,n[7]=h*r-c*i,n}function cv(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function nU(n,e){return n[0]=-e[0],n[1]=-e[1],n}function iU(n,e,t,i){var r=e[0],s=e[1];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n}function rU(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function Ip(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3];return n[0]=t[0]*i+t[4]*r+t[8]*s+t[12]*o,n[1]=t[1]*i+t[5]*r+t[9]*s+t[13]*o,n[2]=t[2]*i+t[6]*r+t[10]*s+t[14]*o,n[3]=t[3]*i+t[7]*r+t[11]*s+t[15]*o,n}!function ele(){var n=new wr(2);wr!=Float32Array&&(n[0]=0,n[1]=0)}(),function nle(){var n=new wr(4);wr!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0)}();var sU=function(n){return n[n.COL0ROW0=0]="COL0ROW0",n[n.COL0ROW1=1]="COL0ROW1",n[n.COL0ROW2=2]="COL0ROW2",n[n.COL0ROW3=3]="COL0ROW3",n[n.COL1ROW0=4]="COL1ROW0",n[n.COL1ROW1=5]="COL1ROW1",n[n.COL1ROW2=6]="COL1ROW2",n[n.COL1ROW3=7]="COL1ROW3",n[n.COL2ROW0=8]="COL2ROW0",n[n.COL2ROW1=9]="COL2ROW1",n[n.COL2ROW2=10]="COL2ROW2",n[n.COL2ROW3=11]="COL2ROW3",n[n.COL3ROW0=12]="COL3ROW0",n[n.COL3ROW1=13]="COL3ROW1",n[n.COL3ROW2=14]="COL3ROW2",n[n.COL3ROW3=15]="COL3ROW3",n}(sU||{});const mle=45*Math.PI/180,_le=1,BT=.1,VT=500,yle=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Ge extends Vce{static get IDENTITY(){return function ble(){return uv||(uv=new Ge,Object.freeze(uv)),uv}()}static get ZERO(){return function vle(){return lv||(lv=new Ge([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(lv)),lv}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return sU}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,i,r,s,o,a,c,l,u,d,h,f,p,g,m){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=c,this[8]=l,this[9]=u,this[10]=d,this[11]=h,this[12]=f,this[13]=p,this[14]=g,this[15]=m,this.check()}setRowMajor(e,t,i,r,s,o,a,c,l,u,d,h,f,p,g,m){return this[0]=e,this[1]=s,this[2]=l,this[3]=f,this[4]=t,this[5]=o,this[6]=u,this[7]=p,this[8]=i,this[9]=a,this[10]=d,this[11]=g,this[12]=r,this[13]=c,this[14]=h,this[15]=m,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(yle)}fromObject(e){return this.check()}fromQuaternion(e){return function qce(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,c=r+r,l=t*o,u=i*o,d=i*a,h=r*o,f=r*a,p=r*c,g=s*o,m=s*a,y=s*c;n[0]=1-d-p,n[1]=u+y,n[2]=h-m,n[3]=0,n[4]=u-y,n[5]=1-l-p,n[6]=f+g,n[7]=0,n[8]=h+m,n[9]=f-g,n[10]=1-l-d,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(this,e),this.check()}frustum(e){const{left:t,right:i,bottom:r,top:s,near:o=BT,far:a=VT}=e;return a===1/0?function wle(n,e,t,i,r,s){const a=2*s/(r-i),c=(t+e)/(t-e),l=(r+i)/(r-i),h=-2*s;n[0]=2*s/(t-e),n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a,n[6]=0,n[7]=0,n[8]=c,n[9]=l,n[10]=-1,n[11]=-1,n[12]=0,n[13]=0,n[14]=h,n[15]=0}(this,t,i,r,s,o):function Xce(n,e,t,i,r,s,o){var a=1/(t-e),c=1/(r-i),l=1/(s-o);n[0]=2*s*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=2*s*c,n[6]=0,n[7]=0,n[8]=(t+e)*a,n[9]=(r+i)*c,n[10]=(o+s)*l,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*s*2*l,n[15]=0}(this,t,i,r,s,o,a),this.check()}lookAt(e){const{eye:t,center:i=[0,0,0],up:r=[0,1,0]}=e;return function Qce(n,e,t,i){var r,s,o,a,c,l,u,d,h,f,p=e[0],g=e[1],m=e[2],y=i[0],v=i[1],_=i[2],E=t[0],A=t[1],x=t[2];Math.abs(p-E)<ho&&Math.abs(g-A)<ho&&Math.abs(m-x)<ho?function Uce(n){n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(n):(u=p-E,d=g-A,h=m-x,r=v*(h*=f=1/Math.hypot(u,d,h))-_*(d*=f),s=_*(u*=f)-y*h,o=y*d-v*u,(f=Math.hypot(r,s,o))?(r*=f=1/f,s*=f,o*=f):(r=0,s=0,o=0),a=d*o-h*s,c=h*r-u*o,l=u*s-d*r,(f=Math.hypot(a,c,l))?(a*=f=1/f,c*=f,l*=f):(a=0,c=0,l=0),n[0]=r,n[1]=a,n[2]=u,n[3]=0,n[4]=s,n[5]=c,n[6]=d,n[7]=0,n[8]=o,n[9]=l,n[10]=h,n[11]=0,n[12]=-(r*p+s*g+o*m),n[13]=-(a*p+c*g+l*m),n[14]=-(u*p+d*g+h*m),n[15]=1)}(this,t,i,r),this.check()}ortho(e){const{left:t,right:i,bottom:r,top:s,near:o=BT,far:a=VT}=e;return function Kce(n,e,t,i,r,s,o){var a=1/(e-t),c=1/(i-r),l=1/(s-o);n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*c,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*l,n[11]=0,n[12]=(e+t)*a,n[13]=(r+i)*c,n[14]=(o+s)*l,n[15]=1}(this,t,i,r,s,o,a),this.check()}orthographic(e){const{fovy:t=mle,aspect:i=_le,focalDistance:r=1,near:s=BT,far:o=VT}=e;oU(t);const c=r*Math.tan(t/2),l=c*i;return this.ortho({left:-l,right:l,bottom:-c,top:c,near:s,far:o})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}=e;return oU(t),function Yce(n,e,t,i,r){var o,s=1/Math.tan(e/2);n[0]=s/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=r&&r!==1/0?(n[10]=(r+i)*(o=1/(i-r)),n[14]=2*r*i*o):(n[10]=-1,n[14]=-2*i)}(this,t,i,r,s),this.check()}determinant(){return function Hce(n){var e=n[0],t=n[1],i=n[2],r=n[3],s=n[4],o=n[5],a=n[6],c=n[7],l=n[8],u=n[9],d=n[10],h=n[11],f=n[12],p=n[13],g=n[14],m=n[15];return(e*o-t*s)*(d*m-h*g)-(e*a-i*s)*(u*m-h*p)+(e*c-r*s)*(u*g-d*p)+(t*a-i*o)*(l*m-h*f)-(t*c-r*o)*(l*g-d*f)+(i*c-r*a)*(l*p-u*f)}(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0];const i=this.getScale(t=t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0];const i=this.getScale(t=t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return function jce(n,e){if(n===e){var t=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=i,n[9]=s,n[11]=e[14],n[12]=r,n[13]=o,n[14]=a}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15]}(this,this),this.check()}invert(){return FT(this,this),this.check()}multiplyLeft(e){return Cl(this,e,this),this.check()}multiplyRight(e){return Cl(this,this,e),this.check()}rotateX(e){return eU(this,this,e),this.check()}rotateY(e){return function Gce(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],c=e[3],l=e[8],u=e[9],d=e[10],h=e[11];e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r-l*i,n[1]=o*r-u*i,n[2]=a*r-d*i,n[3]=c*r-h*i,n[8]=s*i+l*r,n[9]=o*i+u*r,n[10]=a*i+d*r,n[11]=c*i+h*r}(this,this,e),this.check()}rotateZ(e){return tU(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return function zce(n,e,t,i){var c,l,u,d,h,f,p,g,m,y,v,_,E,A,x,I,S,F,U,V,G,P,L,$,r=i[0],s=i[1],o=i[2],a=Math.hypot(r,s,o);a<ho||(r*=a=1/a,s*=a,o*=a,c=Math.sin(t),l=Math.cos(t),h=e[1],f=e[2],p=e[3],m=e[5],y=e[6],v=e[7],E=e[9],A=e[10],x=e[11],U=r*s*(u=1-l)-o*c,V=s*s*u+l,G=o*s*u+r*c,P=r*o*u+s*c,L=s*o*u-r*c,$=o*o*u+l,n[0]=(d=e[0])*(I=r*r*u+l)+(g=e[4])*(S=s*r*u+o*c)+(_=e[8])*(F=o*r*u-s*c),n[1]=h*I+m*S+E*F,n[2]=f*I+y*S+A*F,n[3]=p*I+v*S+x*F,n[4]=d*U+g*V+_*G,n[5]=h*U+m*V+E*G,n[6]=f*U+y*V+A*G,n[7]=p*U+v*V+x*G,n[8]=d*P+g*L+_*$,n[9]=h*P+m*L+E*$,n[10]=f*P+y*L+A*$,n[11]=p*P+v*L+x*$,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]))}(this,this,e,t),this.check()}scale(e){return LT(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return av(this,this,e),this.check()}transform(e,t){return 4===e.length?(rv(t=Ip(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:i}=e;let r;switch(i){case 2:r=function tle(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[4]*r+t[12],n[1]=t[1]*i+t[5]*r+t[13],n}(t||[-0,-0],e,this);break;case 3:r=PT(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return rv(r,e.length),r}transformAsVector(e,t){let i;switch(e.length){case 2:i=function Rce(n,e,t){const i=e[0],r=e[1],s=t[3]*i+t[7]*r||1;return n[0]=(t[0]*i+t[4]*r)/s,n[1]=(t[1]*i+t[5]*r)/s,n}(t||[-0,-0],e,this);break;case 3:i=JV(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return rv(i,e.length),i}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,i){return this.identity().translate([e,t,i])}}let lv,uv;function oU(n){if(n>2*Math.PI)throw Error("expected radians")}function Id(n,e){const t=Ip([],e,n);return rU(t,t,1/t[3]),t}function aU(n,e){const t=n%e;return t<0?e+t:t}function UT(n,e,t){return n<e?e:n>t?t:n}const jT=Math.log2||function Cle(n){return Math.log(n)*Math.LOG2E};function ca(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Vs=Math.PI,cU=Vs/4,ls=Vs/180,HT=180/Vs,Dd=512,dv=4003e4,hv=85.051129,Ale=1.5;function fv(n){const[e,t]=n;return ca(Number.isFinite(e)),ca(Number.isFinite(t)&&t>=-90&&t<=90,"invalid latitude"),[Dd*(e*ls+Vs)/(2*Vs),Dd*(Vs+Math.log(Math.tan(cU+t*ls*.5)))/(2*Vs)]}function Rd(n){const[e,t]=n,i=e/Dd*(2*Vs)-Vs,r=2*(Math.atan(Math.exp(t/Dd*(2*Vs)-Vs))-cU);return[i*HT,r*HT]}function zT(n){const{latitude:e,longitude:t,highPrecision:i=!1}=n;ca(Number.isFinite(e)&&Number.isFinite(t));const r=Dd,s=Math.cos(e*ls),o=r/360,a=o/s,c=r/dv/s,l={unitsPerMeter:[c,c,c],metersPerUnit:[1/c,1/c,1/c],unitsPerDegree:[o,a,c],degreesPerUnit:[1/o,1/a,1/c]};if(i){const u=ls*Math.tan(e*ls)/s,h=r/dv*u,f=h/a*c;l.unitsPerDegree2=[0,o*u/2,h],l.unitsPerMeter2=[f,0,f]}return l}function lU(n,e){const[t,i,r]=n,[s,o,a]=e,{unitsPerMeter:c,unitsPerMeter2:l}=zT({longitude:t,latitude:i,highPrecision:!0}),u=fv(n);u[0]+=s*(c[0]+l[0]*o),u[1]+=o*(c[1]+l[1]*o);const d=Rd(u),h=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[d[0],d[1],h]:d}function pv(n){return 2*Math.atan(.5/n)*HT}function GT(n){return.5/Math.tan(.5*n*ls)}function dU(n,e){const[t,i,r=0]=n;return ca(Number.isFinite(t)&&Number.isFinite(i)&&Number.isFinite(r)),Id(e,[t,i,r,1])}function Dp(n,e,t=0){const[i,r,s]=n;if(ca(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return Id(e,[i,r,s,1]);const o=Id(e,[i,r,0,1]),a=Id(e,[i,r,1,1]),c=o[2],l=a[2];return iU([],o,a,c===l?0:((t||0)-c)/(l-c))}function hU(n){const{width:e,height:t,bounds:i,minExtent:r=0,maxZoom:s=24,offset:o=[0,0]}=n,[[a,c],[l,u]]=i,d=function Mle(n=0){return"number"==typeof n?{top:n,bottom:n,left:n,right:n}:(ca(Number.isFinite(n.top)&&Number.isFinite(n.bottom)&&Number.isFinite(n.left)&&Number.isFinite(n.right)),n)}(n.padding),h=fv([a,UT(u,-hv,hv)]),f=fv([l,UT(c,-hv,hv)]),p=[Math.max(Math.abs(f[0]-h[0]),r),Math.max(Math.abs(f[1]-h[1]),r)],g=[e-d.left-d.right-2*Math.abs(o[0]),t-d.top-d.bottom-2*Math.abs(o[1])];ca(g[0]>0&&g[1]>0);const m=g[0]/p[0],y=g[1]/p[1],A=Rd([(f[0]+h[0])/2+(d.right-d.left)/2/m,(f[1]+h[1])/2+(d.top-d.bottom)/2/y]),x=Math.min(s,jT(Math.abs(Math.min(m,y))));return ca(Number.isFinite(x)),{longitude:A[0],latitude:A[1],zoom:x}}const fU=Math.PI/180;function pU(n,e,t){const{pixelUnprojectionMatrix:i}=n,r=Id(i,[e,0,1,1]),s=Id(i,[e,n.height,1,1]),l=Rd(iU([],r,s,(t*n.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2])));return l.push(t),l}const ut={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(ut,"IDENTITY",{get:()=>(ot.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const fo={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},gv={common:0,meters:1,pixels:2},vU={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},Ole=Math.PI/180,Ple=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],bU=[0,0,0],Nle={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class oc{constructor(e={}){w(this,"id",void 0),w(this,"x",void 0),w(this,"y",void 0),w(this,"width",void 0),w(this,"height",void 0),w(this,"padding",void 0),w(this,"isGeospatial",void 0),w(this,"zoom",void 0),w(this,"focalDistance",void 0),w(this,"position",void 0),w(this,"modelMatrix",void 0),w(this,"distanceScales",void 0),w(this,"scale",void 0),w(this,"center",void 0),w(this,"cameraPosition",void 0),w(this,"projectionMatrix",void 0),w(this,"viewMatrix",void 0),w(this,"viewMatrixUncentered",void 0),w(this,"viewMatrixInverse",void 0),w(this,"viewProjectionMatrix",void 0),w(this,"pixelProjectionMatrix",void 0),w(this,"pixelUnprojectionMatrix",void 0),w(this,"resolution",void 0),w(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||Nle,this.focalDistance=e.focalDistance||1,this.position=e.position||bU,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:i}=e;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?fo.WEB_MERCATOR:fo.WEB_MERCATOR_AUTO_OFFSET:fo.IDENTITY}equals(e){return e instanceof oc&&(this===e||e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Sd(e.projectionMatrix,this.projectionMatrix)&&Sd(e.viewMatrix,this.viewMatrix))}project(e,{topLeft:t=!0}={}){const r=dU(this.projectPosition(e),this.pixelProjectionMatrix),[s,o]=r,a=t?o:this.height-o;return 2===e.length?[s,a]:[s,a,r[2]]}unproject(e,{topLeft:t=!0,targetZ:i}={}){const[r,s,o]=e,l=Dp([r,t?s:this.height-s,o],this.pixelUnprojectionMatrix,i&&i*this.distanceScales.unitsPerMeter[2]),[u,d,h]=this.unprojectPosition(l);return Number.isFinite(o)?[u,d,h]:Number.isFinite(i)?[u,d,i]:[u,d]}projectPosition(e){const[t,i]=this.projectFlat(e);return[t,i,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,i]=this.unprojectFlat(e);return[t,i,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){if(this.isGeospatial){const t=fv(e);return t[1]=Ai(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?Rd(e):e}getBounds(e={}){const t={targetZ:e.z||0},i=this.unproject([0,0],t),r=this.unproject([this.width,0],t),s=this.unproject([0,this.height],t),o=this.unproject([this.width,this.height],t);return[Math.min(i[0],r[0],s[0],o[0]),Math.min(i[1],r[1],s[1],o[1]),Math.max(i[0],r[0],s[0],o[0]),Math.max(i[1],r[1],s[1],o[1])]}getDistanceScales(e){return e?zT({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:t,width:i=1,height:r=1}){return e<this.x+this.width&&this.x<e+i&&t<this.y+this.height&&this.y<t+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function Lce(n){return{left:Md(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),right:Md(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),bottom:Md(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),top:Md(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),near:Md(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),far:Md(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14])}}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,i=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=function xle(n){const{latitude:e}=n;ca(Number.isFinite(e));const t=Math.cos(e*ls);return function Tle(n){return jT(n)}(dv*t)-9}({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||zT({latitude:i,longitude:t}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:s,modelMatrix:o}=e;let a=bU;if(s&&(a=o?new Ge(o).transformAsVector(s,[]):s),this.isGeospatial){const c=this.projectPosition([t,i,0]);this.center=new Vi(a).scale(this.distanceScales.unitsPerMeter).add(c)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:t=Ple,projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:c=1e3,padding:l=null,focalDistance:u=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=(new Ge).multiplyRight(t).translate(new Vi(this.center).negate()),this.projectionMatrix=i||function kle({width:n,height:e,orthographic:t,fovyRadians:i,focalDistance:r,padding:s,near:o,far:a}){const c=n/e,l=t?(new Ge).orthographic({fovy:i,aspect:c,focalDistance:r,near:o,far:a}):(new Ge).perspective({fovy:i,aspect:c,near:o,far:a});if(s){const{left:u=0,right:d=0,top:h=0,bottom:f=0}=s,p=Ai((u+n-d)/2,0,n)-n/2,g=Ai((h+e-f)/2,0,e)-e/2;l[8]-=2*p/n,l[9]+=2*g/e}return l}({width:this.width,height:this.height,orthographic:r,fovyRadians:s||o*Ole,focalDistance:u,padding:l,near:a,far:c});const d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Cl(d,d,this.projectionMatrix),Cl(d,d,this.viewMatrix),this.viewProjectionMatrix=d,this.viewMatrixInverse=FT([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=function Fce(n){return[n[12],n[13],n[14]]}(this.viewMatrixInverse);const h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];LT(h,h,[this.width/2,-this.height/2,1]),av(h,h,[1,-1,0]),Cl(f,h,this.viewProjectionMatrix),this.pixelProjectionMatrix=f,this.pixelUnprojectionMatrix=FT([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||ot.warn("Pixel project matrix not invertible")()}}w(oc,"displayName","Viewport");const Fle=/([0-9]+\.?[0-9]*)(%|px)/;function ac(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=Fle.exec(n);if(e&&e.length>=3){const t="%"===e[2],i=parseFloat(e[1]);return{position:t?i/100:i,relative:t}}default:throw new Error("Could not parse position string ".concat(n))}}function cc(n,e){return n.relative?Math.round(n.position*e):n.position}function Od(n,e){if(n===e)return!0;if(!n||!e)return!1;for(const t in n){const i=n[t],r=e[t];if(!(i===r||Array.isArray(i)&&Array.isArray(r)&&Od(i,r)))return!1}return!0}function Ti(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}class $T{constructor(e){w(this,"id",void 0),w(this,"viewportInstance",void 0),w(this,"_x",void 0),w(this,"_y",void 0),w(this,"_width",void 0),w(this,"_height",void 0),w(this,"_padding",void 0),w(this,"props",void 0);const{id:t,x:i=0,y:r=0,width:s="100%",height:o="100%",padding:a=null,viewportInstance:c}=e||{};Ti(!c||c instanceof oc),this.viewportInstance=c,this.id=t||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=ac(i),this._y=ac(r),this._width=ac(s),this._height=ac(o),this._padding=a&&{left:ac(a.left||0),right:ac(a.right||0),top:ac(a.top||0),bottom:ac(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?!!e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):this.ViewportType===e.ViewportType&&Od(this.props,e.props))}makeViewport({width:e,height:t,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:t});return new this.ViewportType({...i,...this.props,...r})}getViewStateId(){const{viewState:e}=this.props;return"string"==typeof e?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t={...e};for(const i in this.props.viewState)"id"!==i&&(t[i]=this.props.viewState[i]);return t}return e}getDimensions({width:e,height:t}){const i={x:cc(this._x,e),y:cc(this._y,t),width:cc(this._width,e),height:cc(this._height,t)};return this._padding&&(i.padding={left:cc(this._padding.left,e),top:cc(this._padding.top,t),right:cc(this._padding.right,e),bottom:cc(this._padding.bottom,t)}),i}get controller(){const e=this.props.controller;return e?!0===e?{type:this.ControllerType}:"function"==typeof e?{type:e}:{type:this.ControllerType,...e}:null}}const Lle=(new Ge).lookAt({eye:[0,0,1]});function Ble({width:n,height:e,near:t,far:i,padding:r}){let s=-n/2,o=n/2,a=-e/2,c=e/2;if(r){const{left:l=0,right:u=0,top:d=0,bottom:h=0}=r,f=Ai((l+n-u)/2,0,n)-n/2,p=Ai((d+e-h)/2,0,e)-e/2;s-=f,o-=f,a+=p,c+=p}return(new Ge).ortho({left:s,right:o,bottom:a,top:c,near:t,far:i})}class Vle extends oc{constructor(e){const{width:t,height:i,near:r=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],padding:c=null,flipY:l=!0}=e,u=Array.isArray(o)?o[0]:o,d=Array.isArray(o)?o[1]:o,h=Math.min(u,d),f=Math.pow(2,h);let p;if(u!==d){const g=Math.pow(2,u),m=Math.pow(2,d);p={unitsPerMeter:[g/f,m/f,1],metersPerUnit:[f/g,f/m,1]}}super({...e,longitude:void 0,position:a,viewMatrix:Lle.clone().scale([f,f*(l?-1:1),f]),projectionMatrix:Ble({width:t||1,height:i||1,padding:c,near:r,far:s}),zoom:h,distanceScales:p})}projectFlat([e,t]){const{unitsPerMeter:i}=this.distanceScales;return[e*i[0],t*i[1]]}unprojectFlat([e,t]){const{metersPerUnit:i}=this.distanceScales;return[e*i[0],t*i[1]]}panByPosition(e,t){const i=Dp(t,this.pixelUnprojectionMatrix),s=cv([],this.projectFlat(e),nU([],i)),o=cv([],this.center,s);return{target:this.unprojectFlat(o)}}}class Op{constructor(e){w(this,"_inProgress",void 0),w(this,"_handle",void 0),w(this,"_timeline",void 0),w(this,"time",void 0),w(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var t,i;this.cancel(),this.settings=e,this._inProgress=!0,null===(t=(i=this.settings).onStart)||void 0===t||t.call(i,this)}end(){var e,t;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(e=(t=this.settings).onEnd)||void 0===e||e.call(t,this))}cancel(){var e,t;this._inProgress&&(null===(e=(t=this.settings).onInterrupt)||void 0===e||e.call(t,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var e,t;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:i,settings:r}=this;this._handle=i.addChannel({delay:i.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(e=(t=this.settings).onUpdate)||void 0===e||e.call(t,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const wU=()=>{},Ule=n=>n;class Hle{constructor(e){w(this,"getControllerState",void 0),w(this,"props",void 0),w(this,"propsInTransition",void 0),w(this,"transition",void 0),w(this,"onViewStateChange",void 0),w(this,"onStateChange",void 0),w(this,"_onTransitionUpdate",t=>{const{time:i,settings:{interpolator:r,startProps:s,endProps:o,duration:a,easing:c}}=t,l=c(i/a),u=r.interpolateProps(s,o,l);this.propsInTransition=this.getControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Op(e.timeline),this.onViewStateChange=e.onViewStateChange||wU,this.onStateChange=e.onStateChange||wU}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const i=this.props;if(this.props=e,!i||this._shouldIgnoreViewportChange(i,e))return!1;if(this._isTransitionEnabled(e)){let r=i;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;r={...i,...2===s?o:this.propsInTransition||i}}this._triggerTransition(r,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:i}=e;return(t>0||"auto"===t)&&!!i}_isUpdateDueToCurrentTransition(e){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const i=this.getControllerState(e),r=this.getControllerState(t).shortestPathFrom(i),s=t.transitionInterpolator,o=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(0===o)return;const a=s.initializeProps(e,r);this.propsInTransition={};const c={duration:o,easing:t.transitionEasing||Ule,interpolator:s,interruption:t.transitionInterruption||1,startProps:a.start,endProps:a.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(c),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(t)}}}class zle{constructor(e){w(this,"_propsToCompare",void 0),w(this,"_propsToExtract",void 0),w(this,"_requiredProps",void 0);const{compare:t,extract:i,required:r}=e;this._propsToCompare=t,this._propsToExtract=i||t,this._requiredProps=r}arePropsEqual(e,t){for(const i of this._propsToCompare)if(!(i in e)||!(i in t)||!Sd(e[i],t[i]))return!1;return!0}initializeProps(e,t){const i={},r={};for(const s of this._propsToExtract)(s in e||s in t)&&(i[s]=e[s],r[s]=t[s]);return this._checkRequiredProps(i),this._checkRequiredProps(r),{start:i,end:r}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(t=>{const i=e[t];Ti(Number.isFinite(i)||Array.isArray(i),"".concat(t," is required for transition"))})}}const Gle=["longitude","latitude","zoom","bearing","pitch"],Wle=["longitude","latitude","zoom"];class mv extends zle{constructor(e={}){const t=Array.isArray(e)?e:e.transitionProps,i=Array.isArray(e)?{}:e;i.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:Gle,required:Wle},super(i.transitionProps),w(this,"opts",void 0),this.opts=i}initializeProps(e,t){const i=super.initializeProps(e,t),{makeViewport:r,around:s}=this.opts;if(r&&s){const o=r(e),a=r(t),c=o.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(c),aroundPosition:c,width:t.width,height:t.height})}return i}interpolateProps(e,t,i){const r={};for(const s of this._propsToExtract)r[s]=iv(e[s]||0,t[s]||0,i);if(t.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...t,...r});Object.assign(r,s.panByPosition(t.aroundPosition,iv(e.around,t.around,i)))}return r}}const lc={transitionDuration:0},_v=n=>1-(1-n)*(1-n),Pd_WHEEL=["wheel"],Pd_PAN=["panstart","panmove","panend"],Pd_PINCH=["pinchstart","pinchmove","pinchend"],Pd_TRIPLE_PAN=["tripanstart","tripanmove","tripanend"],Pd_DOUBLE_TAP=["doubletap"],Pd_KEYBOARD=["keydown"],Al={};class XT{constructor(e){w(this,"props",void 0),w(this,"state",{}),w(this,"transitionManager",void 0),w(this,"eventManager",void 0),w(this,"onViewStateChange",void 0),w(this,"onStateChange",void 0),w(this,"makeViewport",void 0),w(this,"_controllerState",void 0),w(this,"_events",{}),w(this,"_interactionState",{isDragging:!1}),w(this,"_customEvents",[]),w(this,"_eventStartBlocked",null),w(this,"_panMove",!1),w(this,"invertPan",!1),w(this,"dragMode","rotate"),w(this,"inertia",0),w(this,"scrollZoom",!0),w(this,"dragPan",!0),w(this,"dragRotate",!0),w(this,"doubleClickZoom",!0),w(this,"touchZoom",!0),w(this,"touchRotate",!1),w(this,"keyboard",!0),this.transitionManager=new Hle({...e,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const t in this._events)if(this._events[t]){var e;null===(e=this.eventManager)||void 0===e||e.off(t,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return!t&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!t&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!t&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:t,y:i}=this.props,{offsetCenter:r}=e;return[r.x-t,r.y-i]}isPointInBounds(e,t){const{width:i,height:r}=this.props;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:!0===t?300:0;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:c=!1,keyboard:l=!0}=e,u=!!this.onViewStateChange;this.toggleEvents(Pd_WHEEL,u&&i),this.toggleEvents(Pd_PAN,u&&(r||s)),this.toggleEvents(Pd_PINCH,u&&(a||c)),this.toggleEvents(Pd_TRIPLE_PAN,u&&c),this.toggleEvents(Pd_DOUBLE_TAP,u&&o),this.toggleEvents(Pd_KEYBOARD,u&&l),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=c,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(i=>{this._events[i]!==t&&(this._events[i]=t,t?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,t=null,i={}){const r={...e.getViewportProps(),...t},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(i),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:t});return this._panMove=i,this.updateViewport(r,lc,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),i=this.controllerState.pan({pos:t});return this.updateViewport(i,lc,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.pan({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:_v},{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),i=this.controllerState.rotate({pos:t});return this.updateViewport(i,lc,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.rotate({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:_v},{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const{speed:i=.01,smooth:r=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*i)));s<0&&0!==o&&(o=1/o);const a=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:t}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.rotateStart({pos:t});return this.updateViewport(i,lc,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const i=this.controllerState.rotate({pos:t});return this.updateViewport(i,lc,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:_v},{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return Al._startPinchRotation=e.rotation,Al._lastPinchEvent=e,this.updateViewport(i,lc,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;t=t.rotate({deltaAngleX:Al._startPinchRotation-i})}return this.updateViewport(t,lc,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Al._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:i}=Al;if(this.touchZoom&&t&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),c=Math.pow(2,o+a*t/2);s=s.zoom({pos:r,scale:c}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:r}),transitionDuration:t,transitionEasing:_v},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Al._startPinchRotation=null,Al._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:o}=!0===this.keyboard?{}:this.keyboard,{controllerState:a}=this;let c;const l={};switch(e.srcEvent.code){case"Minus":c=t?a.zoomOut(i).zoomOut(i):a.zoomOut(i),l.isZooming=!0;break;case"Equal":c=t?a.zoomIn(i).zoomIn(i):a.zoomIn(i),l.isZooming=!0;break;case"ArrowLeft":t?(c=a.rotateLeft(s),l.isRotating=!0):(c=a.moveLeft(r),l.isPanning=!0);break;case"ArrowRight":t?(c=a.rotateRight(s),l.isRotating=!0):(c=a.moveRight(r),l.isPanning=!0);break;case"ArrowUp":t?(c=a.rotateUp(o),l.isRotating=!0):(c=a.moveUp(r),l.isPanning=!0);break;case"ArrowDown":t?(c=a.rotateDown(o),l.isRotating=!0):(c=a.moveDown(r),l.isPanning=!0);break;default:return!1}return this.updateViewport(c,this._getTransitionProps(),l),!0}_getTransitionProps(e){const{transition:t}=this;return t&&t.transitionInterpolator?e?{...t,transitionInterpolator:new mv({...e,...t.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:t:lc}}class EU{constructor(e,t){w(this,"_viewportProps",void 0),w(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}class CU extends EU{constructor(e){const{width:t,height:i,rotationX:r=0,rotationOrbit:s=0,target:o=[0,0,0],zoom:a=0,minRotationX:c=-90,maxRotationX:l=90,minZoom:u=-1/0,maxZoom:d=1/0,startPanPosition:h,startRotatePos:f,startRotationX:p,startRotationOrbit:g,startZoomPosition:m,startZoom:y}=e;super({width:t,height:i,rotationX:r,rotationOrbit:s,target:o,zoom:a,minRotationX:c,maxRotationX:l,minZoom:u,maxZoom:d},{startPanPosition:h,startRotatePos:f,startRotationX:p,startRotationOrbit:g,startZoomPosition:m,startZoom:y}),w(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:t}){const i=this.getState().startPanPosition||t;if(!i)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startRotationX:s,startRotationOrbit:o}=this.getState(),{width:a,height:c}=this.getViewportProps();if(!r||void 0===s||void 0===o)return this;let l;if(e){let u=(e[0]-r[0])/a;(s<-90||s>90)&&(u*=-1),l={rotationX:s+(e[1]-r[1])/c*180,rotationOrbit:o+180*u}}else l={rotationX:s+i,rotationOrbit:o+t};return this._getUpdatedState(l)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const t=e.getViewportProps(),i={...this.getViewportProps()},{rotationOrbit:r}=i;return Math.abs(r-t.rotationOrbit)>180&&(i.rotationOrbit=r<0?r+360:r-360),i}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:t,scale:i}){let{startZoom:r,startZoomPosition:s}=this.getState();if(s||(r=this.getViewportProps().zoom,s=this._unproject(t)||this._unproject(e)),!s)return this;const o=this._calculateNewZoom({scale:i,startZoom:r}),a=this.makeViewport({...this.getViewportProps(),zoom:o});return this._getUpdatedState({zoom:o,...a.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this.getViewportProps();return void 0===t&&(t=this.getViewportProps().zoom),Ai(t+Math.log2(e),r,i)}_panFromCenter(e){const{width:t,height:i,target:r}=this.getViewportProps();return this.pan({startPosition:r,pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=Array.isArray(r)?[Ai(r[0],i,t),Ai(r[1],i,t)]:Ai(r,i,t),e.rotationX=Ai(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=function kce(n,e){const t=n%e;return t<0?e+t:t}(a+180,360)-180),e}}class qle extends XT{constructor(...e){super(...e),w(this,"ControllerState",CU),w(this,"transition",{transitionDuration:300,transitionInterpolator:new mv({transitionProps:{compare:["target","zoom","rotationX","rotationOrbit"],required:["target","zoom"]}})})}}class Xle extends CU{constructor(e){super(e),w(this,"zoomAxis",void 0),this.zoomAxis=e.zoomAxis||"all"}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this.getViewportProps();void 0===t&&(t=this.getViewportProps().zoom);let s=Math.log2(e);if(Array.isArray(t)){let[o,a]=t;switch(this.zoomAxis){case"X":o=Ai(o+s,r,i);break;case"Y":a=Ai(a+s,r,i);break;default:let c=Math.min(o+s,a+s);c<r&&(s+=r-c),c=Math.max(o+s,a+s),c>i&&(s+=i-c),o+=s,a+=s}return[o,a]}return Ai(t+s,r,i)}}class Yle extends XT{constructor(...e){super(...e),w(this,"ControllerState",Xle),w(this,"transition",{transitionDuration:300,transitionInterpolator:new mv(["target","zoom"])}),w(this,"dragMode","pan")}_onPanRotate(){return!1}}class ZT extends $T{get ViewportType(){return Vle}get ControllerType(){return Yle}}w(ZT,"displayName","OrthographicView");const KT=Math.PI/180;function Zle({height:n,focalDistance:e,orbitAxis:t,rotationX:i,rotationOrbit:r,zoom:s}){const o="Z"===t?[0,0,1]:[0,1,0],a="Z"===t?[0,-e,0]:[0,0,e],c=(new Ge).lookAt({eye:a,up:o});c.rotateX(i*KT),"Z"===t?c.rotateZ(r*KT):c.rotateY(r*KT);const l=Math.pow(2,s)/n;return c.scale(l),c}class Kle extends oc{constructor(e){const{height:t,projectionMatrix:i,fovy:r=50,orbitAxis:s="Z",target:o=[0,0,0],rotationX:a=0,rotationOrbit:c=0,zoom:l=0}=e,u=i?i[5]/2:GT(r);super({...e,longitude:void 0,viewMatrix:Zle({height:t||1,focalDistance:u,orbitAxis:s,rotationX:a,rotationOrbit:c,zoom:l}),fovy:r,focalDistance:u,position:o,zoom:l}),w(this,"projectedCenter",void 0),this.projectedCenter=this.project(this.center)}unproject(e,{topLeft:t=!0}={}){const[i,r,s=this.projectedCenter[2]]=e,o=t?r:this.height-r,[a,c,l]=Dp([i,o,s],this.pixelUnprojectionMatrix);return[a,c,l]}panByPosition(e,t){const i=this.project(e);return{target:this.unproject([this.width/2+i[0]-t[0],this.height/2+i[1]-t[1],this.projectedCenter[2]])}}}class AU extends $T{constructor(e={}){super(e),this.props.orbitAxis=e.orbitAxis||"Z"}get ViewportType(){return Kle}get ControllerType(){return qle}}w(AU,"displayName","OrbitView");const Pp="vs",JT="fs";function Ur(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const QT={number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},array:{validate:(n,e)=>Array.isArray(n)||ArrayBuffer.isView(n)}};function Qle(n){let e=TU(n);return"object"===e?n?"type"in n?Object.assign({},n,QT[n.type]):"value"in n?(e=TU(n.value),Object.assign({type:e},n,QT[e])):{type:"object",value:n}:{type:"object",value:null}:Object.assign({type:e,value:n},QT[e])}function TU(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}class ex{constructor(e){let{name:t,vs:i,fs:r,dependencies:s=[],uniforms:o,getUniforms:a,deprecations:c=[],defines:l={},inject:u={},vertexShader:d,fragmentShader:h}=e;Ur("string"==typeof t),this.name=t,this.vs=i||d,this.fs=r||h,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(c),this.defines=l,this.injections=function nue(n){const e={vs:{},fs:{}};for(const t in n){let i=n[t];"string"==typeof i&&(i={order:0,injection:i}),e[t.slice(0,2)][t]=i}return e}(u),o&&(this.uniforms=function Jle(n){const e={};for(const t in n){const r=Qle(n[t]);e[t]=r}return e}(o))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:Ur(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(t,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?t.deprecated(i.old,i.new)():t.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(t=>{t.regex="function"===t.type?new RegExp("\\b".concat(t.old,"\\(")):new RegExp("".concat(t.type," ").concat(t.old,";"))}),e}_defaultGetUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&Ur(s.validate(e[r],s),"".concat(this.name,": invalid ").concat(r)),t[r]=e[r]):t[r]=s.value}return t}}function iue(n){return function xU(n){const e={},t={};return tx({modules:n,level:0,moduleMap:e,moduleDepth:t}),Object.keys(t).sort((i,r)=>t[r]-t[i]).map(i=>e[i])}(SU(n))}function tx(n){let{modules:e,level:t,moduleMap:i,moduleDepth:r}=n;if(t>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)i[s.name]=s,(void 0===r[s.name]||r[s.name]<t)&&(r[s.name]=t);for(const s of e)s.dependencies&&tx({modules:s.dependencies,level:t+1,moduleMap:i,moduleDepth:r})}function SU(n,e){return n.map(t=>(t instanceof ex||(Ur("string"!=typeof t,"Shader module use by name is deprecated. Import shader module '".concat(t,"' and use it directly.")),Ur(t.name,"shader module has no name"),(t=new ex(t)).dependencies=SU(t.dependencies)),t))}const sue=7936,oue=7937,aue=7938,cue=35724,nx={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Tl={};function due(n,e){return n.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":n.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":n.match(/AMD/i)||e.match(/AMD/i)||n.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}Object.keys(nx).forEach(n=>{Tl[n]=n});const ix={};function MU(n,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=nx[e];if(Ur(i,e),!function rue(){const e=typeof window<"u"&&window.navigator||{},t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).userAgent||e.userAgent||"",i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r}(t))return!0;if(e in ix)return ix[e];const s=t.behavior||"enable",o="#extension GL_".concat(i[0]," : ").concat(s,"\nvoid main(void) {}"),a=n.createShader(35633);n.shaderSource(a,o),n.compileShader(a);const c=n.getShaderParameter(a,35713);return n.deleteShader(a),ix[e]=c,c}function yv(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>function hue(n,e){const t=nx[e];Ur(t,e);const i=function lue(n){return typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext||!(!n||2!==n._version)}(n)&&t[1]||t[0],r="string"==typeof i?!!n.getExtension(i):i;return Ur(!1===r||!0===r),r}(n,t))}const _ue={[Pp]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[JT]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},vv="__LUMA_INJECT_DECLARATIONS__",IU=/void\s+main\s*\([^)]*\)\s*\{\n?/,DU=/}\n?[^{}]*$/,rx=[];function RU(n,e,t){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=e===Pp;for(const s in t){const o=t[s];o.sort((c,l)=>c.order-l.order),rx.length=o.length;for(let c=0,l=o.length;c<l;++c)rx[c]=o[c].injection;const a="".concat(rx.join("\n"),"\n");switch(s){case"vs:#decl":r&&(n=n.replace(vv,a));break;case"vs:#main-start":r&&(n=n.replace(IU,c=>c+a));break;case"vs:#main-end":r&&(n=n.replace(DU,c=>a+c));break;case"fs:#decl":r||(n=n.replace(vv,a));break;case"fs:#main-start":r||(n=n.replace(IU,c=>c+a));break;case"fs:#main-end":r||(n=n.replace(DU,c=>a+c));break;default:n=n.replace(s,c=>c+a)}}return n=n.replace(vv,""),i&&(n=n.replace(/\}\s*$/,s=>s+_ue[e])),n}function sx(n){const e={};return Ur(Array.isArray(n)&&n.length>1),n.forEach(t=>{for(const i in t)e[i]=e[i]?"".concat(e[i],"\n").concat(t[i]):t[i]}),e}function Nd(n){return new RegExp("\\b".concat(n,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const OU=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],yue=[...OU,[Nd("attribute"),"in $1"],[Nd("varying"),"out $1"]],vue=[...OU,[Nd("varying"),"in $1"]],PU=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],bue=[...PU,[Nd("in"),"attribute $1"],[Nd("out"),"varying $1"]],wue=[...PU,[Nd("in"),"varying $1"]],ox="gl_FragColor",ax=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Eue=/void\s+main\s*\([^)]*\)\s*\{\n?/;function bv(n,e){for(const[t,i]of e)n=n.replace(t,i);return n}const xue="\n\n".concat(vv,"\n\n"),NU={[Pp]:"vertex",[JT]:"fragment"};function kU(n,e){let{id:t,source:i,type:r,modules:s,defines:o={},hookFunctions:a=[],inject:c={},transpileToGLSL100:l=!1,prologue:u=!0,log:d}=e;Ur("string"==typeof i,"shader source must be a string");const h=r===Pp,f=i.split("\n");let p=100,g="",m=i;0===f[0].indexOf("#version ")?(p=300,g=f[0],m=f.slice(1).join("\n")):g="#version ".concat(p);const y={};s.forEach(I=>{Object.assign(y,I.getDefines())}),Object.assign(y,o);let v=u?"".concat(g,"\n").concat(function Rue(n){let{id:e,source:t,type:i}=n;return e&&"string"==typeof e&&-1===t.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(e,"_").concat(NU[i],"\n\n"):""}({id:t,source:i,type:r}),"\n").concat(function Due(n){let{type:e}=n;return"\n#define SHADER_TYPE_".concat(NU[e].toUpperCase(),"\n")}({type:r}),"\n").concat(function fue(n){switch(function uue(n){const e=n.getExtension("WEBGL_debug_renderer_info"),t=n.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||sue),i=n.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||oue);return{gpuVendor:due(t,i),vendor:t,renderer:i,version:n.getParameter(aue),shadingLanguageVersion:n.getParameter(cue)}}(n).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(n),"\n").concat(function pue(n){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return yv(n,Tl.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),yv(n,Tl.GLSL_DERIVATIVES)&&MU(n,Tl.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),yv(n,Tl.GLSL_FRAG_DATA)&&MU(n,Tl.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),yv(n,Tl.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(n),"\n").concat(function Oue(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=0,t="";for(const i in n){0===e&&(t+="\n// APPLICATION DEFINES\n"),e++;const r=n[i];(r||Number.isFinite(r))&&(t+="#define ".concat(i.toUpperCase()," ").concat(n[i],"\n"))}return 0===e&&(t+="\n"),t}(y),"\n").concat(h?"":"precision highp float;\n\n","\n"):"".concat(g,"\n");const _=function Nue(n){const e={vs:{},fs:{}};return n.forEach(t=>{let i;"string"!=typeof t?(i=t,t=i.hook):i={},t=t.trim();const[r,s]=t.split(":"),o=t.replace(/\(.+/,"");e[r][o]=Object.assign(i,{signature:s})}),e}(a),E={},A={},x={};for(const I in c){const S="string"==typeof c[I]?{injection:c[I],order:0}:c[I],F=I.match(/^(v|f)s:(#)?([\w-]+)$/);F?F[2]?"decl"===F[3]?A[I]=[S]:x[I]=[S]:E[I]=[S]:x[I]=[S]}for(const I of s){d&&I.checkDeprecations(m,d),v+=I.getModuleSource(r,p);const F=I.injections[r];for(const U in F){const V=U.match(/^(v|f)s:#([\w-]+)$/);if(V){const P="decl"===V[2]?A:x;P[U]=P[U]||[],P[U].push(F[U])}else E[U]=E[U]||[],E[U].push(F[U])}}return v+=xue,v=RU(v,r,A),v+=function Pue(n,e){let t="";for(const i in n){const r=n[i];if(t+="void ".concat(r.signature," {\n"),r.header&&(t+="  ".concat(r.header)),e[i]){const s=e[i];s.sort((o,a)=>o.order-a.order);for(const o of s)t+="  ".concat(o.injection,"\n")}r.footer&&(t+="  ".concat(r.footer)),t+="}\n"}return t}(_[r],E),v+=m,v=RU(v,r,x),v=function Cue(n,e,t){switch(e){case 300:return t?bv(n,yue):function Aue(n){const e=(n=bv(n,vue)).match(ax);if(e){const t=e[1];n=n.replace(new RegExp("\\b".concat(ox,"\\b"),"g"),t)}else{const t="fragmentColor";n=n.replace(Eue,i=>"out vec4 ".concat(t,";\n").concat(i)).replace(new RegExp("\\b".concat(ox,"\\b"),"g"),t)}return n}(n);case 100:return t?bv(n,bue):function Tue(n){const e=(n=bv(n,wue)).match(ax);if(e){const t=e[1];n=n.replace(ax,"").replace(new RegExp("\\b".concat(t,"\\b"),"g"),ox)}return n}(n);default:throw new Error("unknown GLSL version ".concat(e))}}(v,l?100:p,h),v}function Iue(n){return function(t){const i={};for(const r of n){const s=r.getUniforms(t,i);Object.assign(i,s)}return i}}const ue=new Tp({id:"luma.gl"});function rr(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}const Fue="Requires WebGL2";function wv(n){return typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext||!(!n||!Number.isFinite(n._version))}function et(n){return typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext||!(!n||2!==n._version)}function Ev(n){return rr(wv(n),"Invalid WebGLRenderingContext"),n}function Ui(n){return rr(et(n),Fue),n}const Np={};const kp=function n(e){const t=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new n.VertexAttrib(t);this.attribs[i]=r}this.maxAttrib=0};(kp.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const xl=function(e){const t=this;this.gl=e,function jue(n){const e=n.getError;n.getError=function(){let i;do{i=e.apply(n),0!==i&&(Np[i]=!0)}while(0!==i);for(i in Np)if(Np[i])return delete Np[i],parseInt(i,10);return 0}}(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;return o.maxAttrib=Math.max(o.maxAttrib,s),o.attribs[s].enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;return o.maxAttrib=Math.max(o.maxAttrib,s),o.attribs[s].enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:t.currentArrayBuffer=o;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=o}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const c=t.currentVertexArrayObject.attribs[s];switch(o){case 34975:return c.buffer;case 34338:return c.enabled;case 34339:return c.size;case 34340:return c.stride;case 34341:return c.type;case 34922:return c.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,c,l,u){const d=t.currentVertexArrayObject;d.maxAttrib=Math.max(d.maxAttrib,s);const h=d.attribs[s];return h.buffer=t.currentArrayBuffer,h.size=o,h.type=a,h.normalized=c,h.stride=l,h.offset=u,h.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{(function Vue(n){globalThis.console&&globalThis.console.log&&globalThis.console.log(n)})("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};xl.prototype.VERTEX_ARRAY_BINDING_OES=34229,xl.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new kp(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},xl.prototype.createVertexArrayOES=function(){const e=new kp(this);return this.vertexArrayObjects.push(e),e},xl.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},xl.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof kp&&e.hasBeenBound&&e.ext===this)},xl.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void function Uue(n,e){Np[n]=!0,void 0!==e&&function Bue(n){globalThis.console&&globalThis.console.error&&globalThis.console.error(n)}(e)}(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(t,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let c=0;c<=a;c++){const l=s.attribs[c],u=r?r.attribs[c]:null;if((!r||l.enabled!==u.enabled)&&(l.enabled?i.enableVertexAttribArray.call(t,c):i.disableVertexAttribArray.call(t,c)),l.enabled){let d=!1;(!r||l.buffer!==u.buffer)&&(o!==l.buffer&&(i.bindBuffer.call(t,34962,l.buffer),o=l.buffer),d=!0),(d||l.cached!==u.cached)&&i.vertexAttribPointer.call(t,c,l.size,l.type,l.normalized,l.stride,l.offset)}}this.currentArrayBuffer!==o&&i.bindBuffer.call(t,34962,this.currentArrayBuffer)};const FU="OES_element_index",LU="WEBGL_draw_buffers",BU="WEBGL_debug_renderer_info",$ue=35723,Xue=36795,Yue=34047,Zue=37445,Kue=37446,en=n=>et(n)?void 0:0,Jue={3074:n=>et(n)?void 0:36064,[$ue]:n=>et(n)?void 0:4352,35977:en,32937:en,[Xue]:(n,e)=>{const t=et(n)?n.getExtension("EXT_disjoint_timer_query_webgl2"):n.getExtension("EXT_disjoint_timer_query");return t&&t.GPU_DISJOINT_EXT?e(t.GPU_DISJOINT_EXT):0},[Zue]:(n,e)=>{const t=n.getExtension(BU);return e(t&&t.UNMASKED_VENDOR_WEBGL||7936)},[Kue]:(n,e)=>{const t=n.getExtension(BU);return e(t&&t.UNMASKED_RENDERER_WEBGL||7937)},[Yue]:(n,e)=>{const t=n.luma.extensions.EXT_texture_filter_anisotropic;return t?e(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:en,35071:en,37447:en,36063:(n,e)=>{if(!et(n)){const t=n.getExtension(LU);return t?e(t.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:en,35374:en,35377:en,34852:n=>{if(!et(n)){const e=n.getExtension(LU);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:n=>n.getExtension(FU)?2147483647:65535,33001:n=>n.getExtension(FU)?16777216:65535,33e3:n=>16777216,37157:en,35373:en,35657:en,36183:en,37137:en,34045:en,35978:en,35979:en,35968:en,35376:en,35375:en,35659:en,37154:en,35371:en,35658:en,35076:en,35077:en,35380:en},ede="OES_vertex_array_object",VU="ANGLE_instanced_arrays",tde="WEBGL_draw_buffers",nde="EXT_disjoint_timer_query",UU={[ede]:{meta:{suffix:"OES"},createVertexArray:()=>{rr(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[VU]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(n,e){rr(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[tde]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{rr(!1)}},[nde]:{meta:{suffix:"EXT"},createQuery:()=>{rr(!1)},deleteQuery:()=>{rr(!1)},beginQuery:()=>{rr(!1)},endQuery:()=>{},getQuery(n,e){return this.getQueryObject(n,e)},getQueryParameter(n,e){return this.getQueryObject(n,e)},getQueryObject:()=>{}}},cx={readBuffer:(n,e,t)=>{et(n)&&e(t)},getVertexAttrib:(n,e,t,i)=>{const{webgl2:r,ext:s}=function sde(n,e){return{webgl2:et(n),ext:n.getExtension(e)}}(n,VU);let o;switch(i){case 35069:o=!!r&&void 0;break;case 35070:o=r||s?void 0:0}return void 0!==o?o:e(t,i)},getProgramParameter:(n,e,t,i)=>{if(!et(n))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(t,i)},getInternalformatParameter:(n,e,t,i,r)=>et(n)||32937!==r?n.getInternalformatParameter(t,i,r):new Int32Array([0]),getTexParameter(n,e,t,i){if(34046===i){const{extensions:r}=n.luma,s=r.EXT_texture_filter_anisotropic;i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(t,i)},getParameter:function Que(n,e,t){const i=Jue[t],r="function"==typeof i?i(n,e,t):i;return void 0!==r?r:e(t)},hint:(n,e,t,i)=>e(t,i)};function ude(n,e){let{extension:t,target:i,target2:r}=e;const s=UU[t];rr(s);const{meta:o={}}=s,{suffix:a=""}=o,c=n.getExtension(t);for(const l of Object.keys(s)){const u="".concat(l).concat(a);let d=null;"meta"===l||"function"==typeof n[l]||(c&&"function"==typeof c[u]?d=function(){return c[u](...arguments)}:"function"==typeof s[l]&&(d=s[l].bind(i))),d&&(i[l]=d,r[l]=d)}}globalThis.polyfillContext=function ode(n){n.luma=n.luma||{};const{luma:e}=n;return e.polyfilled||(function Hue(n){if("function"==typeof n.createVertexArray)return;const e=n.getSupportedExtensions;n.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const t=n.getExtension;n.getExtension=function(r){return t.call(this,r)||("OES_vertex_array_object"!==r?null:(n.__OESVertexArrayObject||(this.__OESVertexArrayObject=new xl(this)),this.__OESVertexArrayObject))}}(n),function ade(n){n.luma.extensions={};const e=n.getSupportedExtensions()||[];for(const t of e)n.luma[t]=n.getExtension(t)}(n),function lde(n,e){for(const t of Object.getOwnPropertyNames(e))"overrides"!==t&&ude(n,{extension:t,target:n.luma,target2:n})}(n,UU),function cde(n,e){let{target:t,target2:i}=e;Object.keys(cx).forEach(r=>{if("function"==typeof cx[r]){const s=n[r]?n[r].bind(n):()=>{},o=cx[r].bind(null,n,s);t[r]=o,i[r]=o}})}(n,{target:e,target2:n}),e.polyfilled=!0),n};const lx={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},uc=(n,e,t)=>e?n.enable(t):n.disable(t),jU=(n,e,t)=>n.hint(t,e),jr=(n,e,t)=>n.pixelStorei(t,e);function Fp(n){return Array.isArray(n)||ArrayBuffer.isView(n)}const fde={3042:uc,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:uc,2885:(n,e)=>n.cullFace(e),2929:uc,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:uc,35723:jU,36006:(n,e)=>{const t=et(n)?36009:36160;return n.bindFramebuffer(t,e)},2886:(n,e)=>n.frontFace(e),33170:jU,2849:(n,e)=>n.lineWidth(e),32823:uc,32824:"polygonOffset",10752:"polygonOffset",35977:uc,32938:"sampleCoverage",32939:"sampleCoverage",3089:uc,3088:(n,e)=>n.scissor(...e),2960:uc,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),3333:jr,3317:jr,37440:jr,37441:jr,37443:jr,3330:jr,3332:jr,3331:jr,36010:(n,e)=>n.bindFramebuffer(36008,e),3314:jr,32878:jr,3316:jr,3315:jr,32877:jr,framebuffer:(n,e)=>n.bindFramebuffer(36160,e&&"handle"in e?e.handle:e),blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{e=Fp(e)?e:[e,e],n.blendEquationSeparate(...e)},blendFunc:(n,e)=>{e=Fp(e)&&2===e.length?[...e,...e]:e,n.blendFuncSeparate(...e)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(...e),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=Fp(e)?e:[e,e];const[t,i]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,i)},stencilFunc:(n,e)=>{e=Fp(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilFuncSeparate(1028,t,i,r),n.stencilFuncSeparate(1029,s,o,a)},stencilOp:(n,e)=>{e=Fp(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilOpSeparate(1028,t,i,r),n.stencilOpSeparate(1029,s,o,a)},viewport:(n,e)=>n.viewport(...e)};function mn(n,e,t){return void 0!==e[n]?e[n]:t[n]}const pde={blendEquation:(n,e,t)=>n.blendEquationSeparate(mn(32777,e,t),mn(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(mn(32969,e,t),mn(32968,e,t),mn(32971,e,t),mn(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(mn(32824,e,t),mn(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(mn(32938,e,t),mn(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,mn(2962,e,t),mn(2967,e,t),mn(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,mn(34816,e,t),mn(36003,e,t),mn(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,mn(2964,e,t),mn(2965,e,t),mn(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,mn(34817,e,t),mn(34818,e,t),mn(34819,e,t))},HU={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},blendColor:(n,e,t,i,r)=>n({32773:new Float32Array([e,t,i,r])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,i,r)=>n({32969:e,32968:t,32971:i,32970:r}),clearColor:(n,e,t,i,r)=>n({3106:new Float32Array([e,t,i,r])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,i,r)=>n({3107:[e,t,i,r]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,i,r)=>n({3088:new Int32Array([e,t,i,r])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[1028===e?2968:36005]:t}),stencilFunc:(n,e,t,i)=>n({2962:e,2967:t,2963:i,34816:e,36003:t,36004:i}),stencilFuncSeparate:(n,e,t,i,r)=>n({[1028===e?2962:34816]:t,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(n,e,t,i)=>n({2964:e,2965:t,2966:i,34817:e,34818:t,34819:i}),stencilOpSeparate:(n,e,t,i,r)=>n({[1028===e?2964:34817]:t,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(n,e,t,i,r)=>n({2978:[e,t,i,r]})},po=(n,e)=>n.isEnabled(e),zU={3042:po,2884:po,2929:po,3024:po,32823:po,32926:po,32928:po,3089:po,2960:po,35977:po};function GU(n){for(const e in n)return!1;return!0}function gde(n,e){if(n===e)return!0;const t=Array.isArray(n)||ArrayBuffer.isView(n),i=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&i&&n.length===e.length){for(let r=0;r<n.length;++r)if(n[r]!==e[r])return!1;return!0}return!1}function WU(n,e){const t=n[e].bind(n);n[e]=function(){const r=arguments.length<=0?void 0:arguments[0];return r in n.state.cache&&n.state.enable?n.state.cache[r]:t(...arguments)},Object.defineProperty(n[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function mde(n,e,t){const i=n[e].bind(n);n[e]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const{valueChanged:c,oldValue:l}=t(n.state._updateCache,...o);return c&&i(...o),l},Object.defineProperty(n[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}class yde{constructor(e){let{copyState:t=!1,log:i=()=>{}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?function bde(n,e){if("number"==typeof(e=e||lx)){const r=e,s=zU[r];return s?s(n,r):n.getParameter(r)}const t=Array.isArray(e)?e:Object.keys(e),i={};for(const r of t){const s=zU[r];i[r]=s?s(n,Number(r)):n.getParameter(Number(r))}return i}(e):Object.assign({},lx),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){rr(this.stateStack.length>0),la(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(e){let i,t=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){rr(void 0!==s);const o=e[s],a=this.cache[s];gde(o,a)||(t=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=o)}return{valueChanged:t,oldValue:i}}}function $U(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{enable:t=!0,copyState:i}=e;if(rr(void 0!==i),!n.state){const{polyfillContext:r}=globalThis;r&&r(n),n.state=new yde(n,{copyState:i}),function _de(n){const e=n.useProgram.bind(n);n.useProgram=function(i){n.state.program!==i&&(e(i),n.state.program=i)}}(n);for(const s in HU)mde(n,s,HU[s]);WU(n,"getParameter"),WU(n,"isEnabled")}return n.state.enable=t,n}function qU(n){rr(n.state),n.state.pop()}function la(n,e){if(rr(wv(n),"setParameters requires a WebGL context"),GU(e))return;const t={};for(const r in e){const s=Number(r),o=fde[r];o&&("string"==typeof o?t[o]=!0:o(n,e[r],s))}const i=n.state&&n.state.cache;if(i)for(const r in t)(0,pde[r])(n,e,i)}function us(n,e,t){if(GU(e))return t(n);const{nocatch:i=!0}=e;let r;if(function vde(n){n.state||$U(n,{copyState:!1}),n.state.push()}(n),la(n,e),i)r=t(n),qU(n);else try{r=t(n)}finally{qU(n)}return r}function kd(n){const{luma:e}=n;if(n.canvas&&e){const t=e.canvasSizeInfo,i="clientWidth"in t?t.clientWidth:n.canvas.clientWidth;return i?n.drawingBufferWidth/i:1}return 1}function ux(n,e){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function Cde(n,e,t,i,r){const s=XU(n[0],e,t);let o=YU(n[1],e,i,r),a=XU(n[0]+1,e,t);const c=a===t-1?a:a-1;let l;return a=YU(n[1]+1,e,i,r),r?(a=0===a?a:a+1,l=o,o=a):l=a===i-1?a:a-1,{x:s,y:o,width:Math.max(c-s+1,1),height:Math.max(l-o+1,1)}}(e,kd(n),n.drawingBufferWidth,n.drawingBufferHeight,t)}function XU(n,e,t){return Math.min(Math.round(n*e),t-1)}function YU(n,e,t,i){return i?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}const dx=uo(),Ade=dx&&typeof document<"u",ZU={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function KU(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};rr(dx,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),n=Object.assign({},ZU,n);const{width:e,height:t}=n;function i(a){if(n.throwOnError)throw new Error(a);return console.error(a),null}let r;n.onError=i;const{canvas:s}=n,o=function Mde(n){let s,{canvas:e,width:t=800,height:i=600,onError:r}=n;return"string"==typeof e?(Ade&&"complete"===document.readyState||r("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(t)?"".concat(t,"px"):"100%",s.style.height=Number.isFinite(i)?"".concat(i,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}({canvas:s,width:e,height:t,onError:i});return r=function Sde(n,e){const{onError:t}=e;let i=null;const r=c=>i=c.statusMessage||i;n.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||n.getContext("webgl2",e),a=a||n.getContext("experimental-webgl2",e)),s&&(a=a||n.getContext("webgl",e),a=a||n.getContext("experimental-webgl",e)),n.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&n.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&n.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):t("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"))}(o,n),r?(r=hx(r,n),function Ide(n){const e=et(n)?"WebGL2":"WebGL1",t=function Tde(n){const e=n.getParameter(7936),t=n.getParameter(7937),i=n.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&n.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&n.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||t,vendorMasked:e,rendererMasked:t,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n),i=t?"(".concat(t.vendor,",").concat(t.renderer,")"):"",r=n.debug?" debug":"";ue.info(1,"".concat(e).concat(r," context ").concat(i))()}(r),r):null}function hx(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!n||n._instrumented)return n;n._version=n._version||function Dde(n){return typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext?2:1}(n),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{},e=Object.assign({},ZU,e);const{manageState:t,debug:i}=e;return t&&$U(n,{copyState:!1,log:function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return ue.log(1,...s)()}}),dx&&i&&(globalThis.makeDebugContext?(n=globalThis.makeDebugContext(n,e),ue.level=Math.max(ue.level,1)):ue.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),n._instrumented=!0,n}function JU(){let n;if(typeof window<"u"&&window.performance)n=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}class QU{constructor(e,t){w(this,"name",void 0),w(this,"type",void 0),w(this,"sampleSize",1),w(this,"time",void 0),w(this,"count",void 0),w(this,"samples",void 0),w(this,"lastTiming",void 0),w(this,"lastSampleTime",void 0),w(this,"lastSampleCount",void 0),w(this,"_count",0),w(this,"_time",0),w(this,"_samples",0),w(this,"_startTime",0),w(this,"_timerPending",!1),this.name=e,this.type=t,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=JU(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(JU()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class fx{constructor(e){w(this,"id",void 0),w(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){return this._getOrCreate({name:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count"})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(t=>this._getOrCreate(t))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:i}=e;return this.stats[t]||(this.stats[t]=e instanceof QU?e:new QU(t,i)),this.stats[t]}}const Lp="8.5.21",Sl=new class Pde{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new fx({id:e})),this.stats.get(e)}};if(globalThis.luma&&globalThis.luma.VERSION!==Lp)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Lp));function ne(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function px(n,e){if("string"!=typeof e)return e;const t=Number(e);if(!isNaN(t))return t;const i=n[e=e.replace(/^.*\./,"")];return ne(void 0!==i,"Accessing undefined constant GL.".concat(e)),i}function dc(n,e){e=Number(e);for(const t in n)if(n[t]===e)return"GL.".concat(t);return String(e)}globalThis.luma||(uo()&&ue.log(1,"luma.gl ".concat(Lp," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),globalThis.luma=globalThis.luma||{VERSION:Lp,version:Lp,log:ue,stats:Sl,globals:{modules:{},nodeIO:{}}}),globalThis;const gx={};function Er(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";gx[n]=gx[n]||1;const e=gx[n]++;return"".concat(n,"-").concat(e)}function e3(n){return ne("number"==typeof n,"Input must be a number"),n&&!(n&n-1)}function Fd(n){let e=!0;for(const t in n){e=!1;break}return e}function t3(n,e,t,i){const r="See luma.gl ".concat(t," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(n);i.forEach(o=>{s.methodName||(s[o]=()=>{throw ue.removed("Calling removed method ".concat(e,".").concat(o,": "),r)(),new Error(o)})})}const Ld="Resource subclass must define virtual methods";class ua{get[Symbol.toStringTag](){return"Resource"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ev(e);const{id:i,userData:r={}}=t;this.gl=e,this.gl2=e,this.id=i||Er(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach(i=>i.delete()),this}bind(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!=typeof e?(this._bindHandle(e),this):(this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t)}unbind(){this.bind(null)}getParameter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ne(e=px(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=et(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension))return s&&"webgl2"in r?r.webgl2:r.webgl1}return this._getParameter(e,t)}getParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{parameters:t,keys:i}=e,r=this.constructor.PARAMETERS||{},s=et(this.gl),o={},a=t||Object.keys(r);for(const c of a){const l=r[c];if(l&&(!("webgl2"in l)||s)&&(!("extension"in l)||this.gl.getExtension(l.extension))){const d=i?dc(this.gl,c):c;o[d]=this.getParameter(c,e),i&&"GLenum"===l.type&&(o[d]=dc(this.gl,o[d]))}}return o}setParameter(e,t){ne(e=px(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=et(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(t=px(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,i){return t3(this,e,t,i)}initialize(e){}_createHandle(){throw new Error(Ld)}_deleteHandle(){throw new Error(Ld)}_bindHandle(e){throw new Error(Ld)}_getOptsFromHandle(){throw new Error(Ld)}_getParameter(e,t){throw new Error(Ld)}_setParameter(e,t){throw new Error(Ld)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],t=Sl.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get("".concat(e,"s Created")).incrementCount(),t.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Sl.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,t),this._trackAllocatedMemoryForContext(e,t,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];const r=Sl.get("Memory Usage".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:""));r.get("GPU Memory").addCount(e),r.get("".concat(t," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];const i=Sl.get("Memory Usage".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:""));i.get("GPU Memory").subtractCount(this.byteLength),i.get("".concat(e," Memory")).subtractCount(this.byteLength)}}const Nde="Failed to deduce GL constant from typed array";function mx(n){switch(ArrayBuffer.isView(n)?n.constructor:n){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(Nde)}}function Bp(n){let{clamped:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(n){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Fde(n){let{data:e,width:t,height:i}=n;const r=Math.round(t/2),s=Math.round(i/2),o=new Uint8Array(r*s*4);for(let a=0;a<s;a++)for(let c=0;c<r;c++)for(let l=0;l<4;l++)o[4*(a*r+c)+l]=e[4*(2*a*t+2*c)+l];return{data:o,width:r,height:s}}function _x(n,e,t){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=t;for(const a in i)if(a in e){const l=i[a]?"".concat(n,".").concat(i[a]):"N/A";ue.removed("".concat(n,".").concat(a),l)()}for(const a in r)if(a in e){const c=r[a];ue.deprecated("".concat(n,".").concat(a),"".concat(n,".").concat(c))()}let o=null;for(const a in s)if(a in e){const c=s[a];ue.deprecated("".concat(n,".").concat(a),"".concat(n,".").concat(c))(),o=o||Object.assign({},e),o[c]=e[a],delete o[a]}return o||e}const Lde={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Bde={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Cr{static getBytesPerElement(e){return Bp(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return ne(e.size),Bp(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new Cr(Lde,...t)}constructor(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(r=>this._assign(r)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Cr.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Cr.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=_x("Accessor",e,Bde),void 0!==e.type&&(this.type=e.type,(5124===e.type||5125===e.type)&&(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&(this.index="boolean"==typeof e.index?e.index?1:0:e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const r3={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Vde={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:r3},Ude={removedProps:r3};class Ut extends ua{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(){return Math.round(this.byteLength/Cr.getBytesPerElement(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor))}getVertexCount(){return Math.round(this.byteLength/Cr.getBytesPerVertex(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor))}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=_x("Buffer",e,Vde),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=_x("Buffer",e,Ude))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new Cr(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;ne(t);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==s?(Ui(this.gl),this.gl.bufferSubData(this.target,i,t,r,s)):this.gl.bufferSubData(o,i,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData(e){let{sourceBuffer:t,readOffset:i=0,writeOffset:r=0,size:s}=e;const{gl:o}=this;return Ui(o),o.bindBuffer(36662,t.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,i,r,s),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:t=0,dstOffset:i=0,length:r=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ui(this.gl);const s=Bp(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(t),a=i;let c,l;e?(l=e.length,c=l-a):(c=Math.min(o,r||o),l=a+c);const u=Math.min(o,c);return r=r||u,ne(r<=u),e=e||new s(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,i,r),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:i=0,size:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,i,r):(ne(0===i),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:t=this.accessor&&this.accessor.index}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength+t;ne(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,10),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=mx(e);return ne(s),this.setAccessor(new Cr(this.accessor,{type:s})),this}_setByteLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;ne(e>=0),this._trackDeallocatedMemory();let i=e;0===e&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const i=e/Bp(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new Cr(this.accessor,{type:mx(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return ue.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return ue.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return ue.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return ue.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Cr(this.accessor,e),this}}const yx={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},s3={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},o3={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},zde=[9729,9728],a3=globalThis.WebGLBuffer||function(){};class Ml extends ua{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{format:i,linearFiltering:r}=t;let s=!0;return i&&(s=s&&function jde(n,e){const t=yx[e];if(!t)return!1;if(void 0===t.gl1&&void 0===t.gl2)return!0;const i=et(n)&&t.gl2||t.gl1;return"string"==typeof i?n.getExtension(i):i}(e,i),s=s&&(!r||function Hde(n,e){const t=yx[e];switch(t&&t.types[0]){case 5126:return n.getExtension("OES_texture_float_linear");case 5131:return n.getExtension("OES_texture_half_float_linear");default:return!0}}(e,i))),s}constructor(e,t){const{id:i=Er("texture"),handle:r,target:s}=t;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data;if(t instanceof Promise)return t.then(v=>this.initialize(Object.assign({},e,{pixels:v,data:v}))),this;const i=typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement;if(i&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:o=0,recreate:a=!1,parameters:c={},pixelStore:l={},textureUnit:u}=e;t||(t=r);let{width:d,height:h,dataFormat:f,type:p,compressed:g=!1,mipmaps:m=!0}=e;const{depth:y=0}=e;return({width:d,height:h,compressed:g,dataFormat:f,type:p}=this._deduceParameters({format:s,type:p,dataFormat:f,compressed:g,data:t,width:d,height:h})),this.width=d,this.height=h,this.depth=y,this.format=s,this.type=p,this.dataFormat=f,this.border=o,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),m&&this._isNPOT()&&(ue.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),m=!1,this._updateForNPOT(c)),this.mipmaps=m,this.setImageData({data:t,width:d,height:h,depth:y,format:s,type:p,dataFormat:f,border:o,mipmaps:m,parameters:l,compressed:g}),m&&this.generateMipmap(),this.setParameters(c),a&&(this.data=t),i&&(this._video={video:t,parameters:c,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:t,width:i,mipmaps:r=!1}=e;return i!==this.width||t!==this.height?this.initialize({width:i,height:t,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:r}):this}generateMipmap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isNPOT()?(ue.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),us(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:i=null,level:r=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:c={}}=e;let{data:l=null,type:u=this.type,width:d=this.width,height:h=this.height,dataFormat:f=this.dataFormat,compressed:p=!1}=e;l||(l=i),({type:u,dataFormat:f,compressed:p,width:d,height:h}=this._deduceParameters({format:s,type:u,dataFormat:f,compressed:p,data:l,width:d,height:h}));const{gl:g}=this;g.bindTexture(this.target,this.handle);let m=null;({data:l,dataType:m}=this._getDataType({data:l,compressed:p}));let y,v=0;return us(this.gl,c,()=>{switch(m){case"null":g.texImage2D(t,r,s,d,h,o,f,u,l);break;case"typed-array":g.texImage2D(t,r,s,d,h,o,f,u,l,a);break;case"buffer":y=Ui(g),y.bindBuffer(35052,l.handle||l),y.texImage2D(t,r,s,d,h,o,f,u,a),y.bindBuffer(35052,null);break;case"browser-object":et(g)?g.texImage2D(t,r,s,d,h,o,f,u,l):g.texImage2D(t,r,s,f,u,l);break;case"compressed":for(const[_,E]of l.entries())g.compressedTexImage2D(t,_,E.format,E.width,E.height,o,E.data),v+=E.levelSize;break;default:ne(!1,"Unknown image data type")}}),this._trackAllocatedMemory("compressed"===m?v:l&&l.byteLength?l.byteLength:this.width*this.height*(s3[this.dataFormat]||4)*(o3[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData(e){let{target:t=this.target,pixels:i=null,data:r=null,x:s=0,y:o=0,width:a=this.width,height:c=this.height,level:l=0,format:u=this.format,type:d=this.type,dataFormat:h=this.dataFormat,compressed:f=!1,offset:p=0,border:g=this.border,parameters:m={}}=e;if(({type:d,dataFormat:h,compressed:f,width:a,height:c}=this._deduceParameters({format:u,type:d,dataFormat:h,compressed:f,data:r,width:a,height:c})),ne(0===this.depth,"texSubImage not supported for 3D textures"),r||(r=i),r&&r.data){const y=r;r=y.data,a=y.shape[0],c=y.shape[1]}r instanceof Ut&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),us(this.gl,m,()=>{if(f)this.gl.compressedTexSubImage2D(t,l,s,o,a,c,u,r);else if(null===r)this.gl.texSubImage2D(t,l,s,o,a,c,h,d,null);else if(ArrayBuffer.isView(r))this.gl.texSubImage2D(t,l,s,o,a,c,h,d,r,p);else if(r instanceof a3){const y=Ui(this.gl);y.bindBuffer(35052,r),y.texSubImage2D(t,l,s,o,a,c,h,d,p),y.bindBuffer(35052,null)}else et(this.gl)?Ui(this.gl).texSubImage2D(t,l,s,o,a,c,h,d,r):this.gl.texSubImage2D(t,l,s,o,h,d,r)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return ue.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType(e){let{data:t,compressed:i=!1}=e;return i?{data:t,dataType:"compressed"}:null===t?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof Ut?{data:t.handle,dataType:"buffer"}:t instanceof a3?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:i}=e;let{width:r,height:s,dataFormat:o,type:a,compressed:c}=e;const l=yx[t];return o=o||l&&l.dataFormat,a=a||l&&l.types[0],c=c||l&&l.compressed,({width:r,height:s}=this._deduceImageSize(i,r,s)),{dataFormat:o,type:a,compressed:c,width:r,height:s,format:t,data:i}}_deduceImageSize(e,t,i){let r;return r=typeof ImageData<"u"&&e instanceof ImageData?{width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?{width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:i}:{width:t>=0?t:1,height:i>=0?i:1},ne(r,"Could not deduced texture size"),ne(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),ne(void 0===i||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:ne(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(et(this.gl)||!this.width||!this.height||e3(this.width)&&e3(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===zde.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}function Gde(n,e){return ne("string"==typeof n),n=""+n,new Promise((t,i)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>i(new Error("Could not load image ".concat(n,"."))),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=n}catch(r){i(r)}})}class xi extends Ml{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,t){return Ml.isSupported(e,t)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ev(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:Gde(t.data)})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const Il="EXT_color_buffer_float",c3={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Il,bpp:2},33327:{gl2:Il,bpp:4},34842:{gl2:Il,bpp:8},33326:{gl2:Il,bpp:4},33328:{gl2:Il,bpp:8},34836:{gl2:Il,bpp:16},35898:{gl2:Il,bpp:4}};class Bd extends ua{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:null};return!t||function Wde(n,e,t){const i=t[e];if(!i)return!1;const r=et(n)&&i.gl2||i.gl1;return"string"==typeof r?n.getExtension(r):r}(e,t,c3)}static getSamplesForFormat(e,t){let{format:i}=t;return e.getInternalformatParameter(36161,i,32937)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.initialize(t),Object.seal(this)}initialize(e){let{format:t,width:i=1,height:r=1,samples:s=0}=e;return ne(t,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==s&&et(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,t,i,r):this.gl.renderbufferStorage(36161,t,i,r),this.format=t,this.width=i,this.height=r,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*c3[this.format].bpp),this}resize(e){let{width:t,height:i}=e;return t!==this.width||i!==this.height?this.initialize({width:t,height:i,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const l3=6144,f3="clear: bad arguments";function bx(n){let{framebuffer:e=null,color:t=null,depth:i=null,stencil:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s={};e&&(s.framebuffer=e);let o=0;t&&(o|=16384,!0!==t&&(s.clearColor=t)),i&&(o|=256,!0!==i&&(s.clearDepth=i)),r&&(o|=1024,!0!==i&&(s.clearStencil=i)),ne(0!==o,f3),us(n,s,()=>{n.clear(o)})}const wx=[34069,34070,34071,34072,34073,34074];let Kde=(()=>{class n extends Ml{get[Symbol.toStringTag](){return"TextureCube"}constructor(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ev(t),super(t,Object.assign({},i,{target:34067})),this.initialize(i),Object.seal(this)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mipmaps:i=!0,parameters:r={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,i&&this.generateMipmap(t),this.setParameters(r)}),this}subImage(t){let{face:i,data:r,x:s=0,y:o=0,mipmapLevel:a=0}=t;return this._subImage({target:i,data:r,x:s,y:o,mipmapLevel:a})}setCubeMapImageData(t){var i=this;return Q(function*(){let{width:r,height:s,pixels:o,data:a,border:c=0,format:l=6408,type:u=5121}=t;const{gl:d}=i,h=o||a,f=yield Promise.all(wx.map(p=>{const g=h[p];return Promise.all(Array.isArray(g)?g:[g])}));i.bind(),wx.forEach((p,g)=>{f[g].length>1&&!1!==i.opts.mipmaps&&ue.warn("".concat(i.id," has mipmap and multiple LODs."))(),f[g].forEach((m,y)=>{r&&s?d.texImage2D(p,y,l,r,s,c,l,u,m):d.texImage2D(p,y,l,l,u,m)})}),i.unbind()})()}setImageDataForFace(t){const{face:i,width:r,height:s,pixels:o,data:a,border:c=0,format:l=6408,type:u=5121}=t,{gl:d}=this,h=o||a;return this.bind(),h instanceof Promise?h.then(f=>this.setImageDataForFace(Object.assign({},t,{face:i,data:f,pixels:f}))):this.width||this.height?d.texImage2D(i,0,l,r,s,c,l,u,h):d.texImage2D(i,0,l,l,u,h),this}}return n.FACES=wx,n})();class Jde extends Ml{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return et(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ui(e),t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1}),super(e,t),this.initialize(t),Object.seal(this)}setImageData(e){let{level:t=0,dataFormat:i=6408,width:r,height:s,depth:o=1,border:a=0,format:c,type:l=5121,offset:u=0,data:d,parameters:h={}}=e;return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),us(this.gl,h,()=>{ArrayBuffer.isView(d)&&this.gl.texImage3D(this.target,t,i,r,s,o,a,c,l,d),d instanceof Ut&&(this.gl.bindBuffer(35052,d.handle),this.gl.texImage3D(this.target,t,i,r,s,o,a,c,l,u))}),this._trackAllocatedMemory(d&&d.byteLength?d.byteLength:this.width*this.height*this.depth*(s3[this.dataFormat]||4)*(o3[this.type]||1),"Texture"),this.loaded=!0,this}}function ehe(n,e){const{gl:t,width:i,height:r,id:s}=n;return new Un(t,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:i,height:r,attachments:{36064:n}}))}function Cv(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sourceX:t=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:c,sourceType:l}=e;const{framebuffer:u,deleteFramebuffer:d}=Vp(n);ne(u);const{gl:h,handle:f,attachments:p}=u;a=a||u.width,c=c||u.height,36064===s&&null===f&&(s=1028),ne(p[s]),l=l||p[s].type,o=function nhe(n,e,t,i,r){if(n)return n;const s=Bp(e=e||5121,{clamped:!1}),o=function Zde(n){switch(n){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return ne(!1),0}}(t);return new s(i*r*o)}(o,l,r,a,c),l=l||mx(o);const g=h.bindFramebuffer(36160,f);return h.readPixels(t,i,a,c,r,l,o),h.bindFramebuffer(36160,g||null),d&&u.delete(),o}function Ex(n){let{sourceAttachment:e=36064,targetMaxHeight:t=Number.MAX_SAFE_INTEGER}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Cv(n,{sourceAttachment:e}),{width:r,height:s}=n;for(;s>t;)({data:i,width:r,height:s}=Fde({data:i,width:r,height:s}));!function kde(n){let{data:e,width:t,height:i,bytesPerPixel:r=4,temp:s}=n;const o=t*r;s=s||new Uint8Array(o);for(let a=0;a<i/2;++a){const c=a*o,l=(i-a-1)*o;s.set(e.subarray(c,c+o)),e.copyWithin(c,l,l+o),e.set(s,l)}}({data:i,width:r,height:s});const o=document.createElement("canvas");o.width=r,o.height=s;const a=o.getContext("2d"),c=a.createImageData(r,s);return c.data.set(i),a.putImageData(c,0,0),o.toDataURL()}function Vp(n){return n instanceof Un?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:ehe(n),deleteFramebuffer:!0}}const tn_WEBGL2="WEBGL2",tn_VERTEX_ARRAY_OBJECT="VERTEX_ARRAY_OBJECT",tn_TIMER_QUERY="TIMER_QUERY",tn_INSTANCED_RENDERING="INSTANCED_RENDERING",tn_MULTIPLE_RENDER_TARGETS="MULTIPLE_RENDER_TARGETS",tn_ELEMENT_INDEX_UINT32="ELEMENT_INDEX_UINT32",tn_BLEND_EQUATION_MINMAX="BLEND_EQUATION_MINMAX",tn_FLOAT_BLEND="FLOAT_BLEND",tn_COLOR_ENCODING_SRGB="COLOR_ENCODING_SRGB",tn_TEXTURE_DEPTH="TEXTURE_DEPTH",tn_TEXTURE_FLOAT="TEXTURE_FLOAT",tn_TEXTURE_HALF_FLOAT="TEXTURE_HALF_FLOAT",tn_TEXTURE_FILTER_LINEAR_FLOAT="TEXTURE_FILTER_LINEAR_FLOAT",tn_TEXTURE_FILTER_LINEAR_HALF_FLOAT="TEXTURE_FILTER_LINEAR_HALF_FLOAT",tn_TEXTURE_FILTER_ANISOTROPIC="TEXTURE_FILTER_ANISOTROPIC",tn_COLOR_ATTACHMENT_RGBA32F="COLOR_ATTACHMENT_RGBA32F",tn_COLOR_ATTACHMENT_FLOAT="COLOR_ATTACHMENT_FLOAT",tn_COLOR_ATTACHMENT_HALF_FLOAT="COLOR_ATTACHMENT_HALF_FLOAT",tn_GLSL_FRAG_DATA="GLSL_FRAG_DATA",tn_GLSL_FRAG_DEPTH="GLSL_FRAG_DEPTH",tn_GLSL_DERIVATIVES="GLSL_DERIVATIVES",tn_GLSL_TEXTURE_LOD="GLSL_TEXTURE_LOD",p3={[tn_WEBGL2]:[!1,!0],[tn_VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[tn_TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[tn_INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[tn_MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[tn_ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[tn_BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[tn_FLOAT_BLEND]:["EXT_float_blend"],[tn_COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[tn_TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[tn_TEXTURE_FLOAT]:["OES_texture_float",!0],[tn_TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[tn_TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[tn_TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[tn_TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[tn_COLOR_ATTACHMENT_RGBA32F]:[function ihe(n){const e=new xi(n,{format:6408,type:5126,dataFormat:6408}),t=new Un(n,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=t.getStatus();return e.delete(),t.delete(),36053===i},"EXT_color_buffer_float"],[tn_COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[tn_COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[tn_GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[tn_GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[tn_GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[tn_GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},rhe=2;function Cx(n,e){return g3(n,e)}function g3(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>m3(n,t))}function m3(n,e){return n.luma=n.luma||{},n.luma.caps=n.luma.caps||{},void 0===n.luma.caps[e]&&(n.luma.caps[e]=function ohe(n,e){const t=p3[e];let i;ne(t,e);const r=et(n)&&t[1]||t[0];if("function"==typeof r)i=r(n);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&!!n.getExtension(s)}else"string"==typeof r?i=!!n.getExtension(r):"boolean"==typeof r?i=r:ne(!1);return i}(n,e)),n.luma.caps[e]||ue.log(rhe,"Feature: ".concat(e," not supported"))(),n.luma.caps[e]}const _3="Multiple render targets not supported";class Un extends ua{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{colorBufferFloat:i,colorBufferHalfFloat:r}=t;let s=!0;return i&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&!(!e.getExtension("EXT_color_buffer_float")&&!e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Un(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Ui(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Ui(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:t=1,height:i=1,attachments:r=null,color:s=!0,depth:o=!0,stencil:a=!1,check:c=!0,readBuffer:l,drawBuffers:u}=e;if(ne(t>=0&&i>=0,"Width and height need to be integers"),this.width=t,this.height=i,r)for(const d in r){const h=r[d];(Array.isArray(h)?h[0]:h).resize({width:t,height:i})}else r=this._createDefaultAttachments(s,o,a,t,i);this.update({clearAttachments:!0,attachments:r,readBuffer:l,drawBuffers:u}),r&&c&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:t={},readBuffer:i,drawBuffers:r,clearAttachments:s=!1,resizeAttachments:o=!0}=e;this.attach(t,{clearAttachments:s,resizeAttachments:o});const{gl:a}=this,c=a.bindFramebuffer(36160,this.handle);return i&&this._setReadBuffer(i),r&&this._setDrawBuffers(r),a.bindFramebuffer(36160,c||null),this}resize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{width:t,height:i}=e;if(null===this.handle)return ne(void 0===t&&void 0===i),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===i&&(i=this.gl.drawingBufferHeight),t!==this.width&&i!==this.height&&ue.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(t,"x").concat(i))();for(const r in this.attachments)this.attachments[r].resize({width:t,height:i});return this.width=t,this.height=i,this}attach(e){let{clearAttachments:t=!1,resizeAttachments:i=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={};t&&Object.keys(this.attachments).forEach(o=>{r[o]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){ne(void 0!==o,"Misspelled framebuffer binding point?");const a=Number(o),c=r[a];let l=c;if(l)if(l instanceof Bd)this._attachRenderbuffer({attachment:a,renderbuffer:l});else if(Array.isArray(c)){const[u,d=0,h=0]=c;l=u,this._attachTexture({attachment:a,texture:u,layer:d,level:h})}else this._attachTexture({attachment:a,texture:l,layer:0,level:0});else this._unattach(a);i&&l&&l.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const t=this.getStatus();if(36053!==t)throw new Error(function che(n){return(Un.STATUS||{})[n]||"Framebuffer error ".concat(n)}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),i}clear(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:t,depth:i,stencil:r,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(t||i||r)&&bx(this.gl,{color:t,depth:i,stencil:r}),s.forEach((a,c)=>{!function Yde(n){let{framebuffer:e=null,buffer:t=l3,drawBuffer:i=0,value:r=[0,0,0,0]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ui(n),us(n,{framebuffer:e},()=>{switch(t){case l3:switch(r.constructor){case Int32Array:n.clearBufferiv(t,i,r);break;case Uint32Array:n.clearBufferuiv(t,i,r);break;case Float32Array:default:n.clearBufferfv(t,i,r)}break;case 6145:n.clearBufferfv(6145,0,[r]);break;case 6146:n.clearBufferiv(6146,0,[r]);break;case 34041:const[s,o]=r;n.clearBufferfi(34041,0,s,o);break;default:ne(!1,f3)}})}(this.gl,{drawBuffer:c,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return ue.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return ue.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return ue.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return ue.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return ue.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return ue.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:t=[],x:i=0,y:r=0,width:s,height:o}=e;const a=Ui(this.gl),c=a.bindFramebuffer(36008,this.handle);return 0===i&&0===r&&void 0===s&&void 0===o?a.invalidateFramebuffer(36008,t):a.invalidateFramebuffer(36008,t,i,r,s,o),a.bindFramebuffer(36008,c),this}getAttachmentParameter(e,t,i){let r=this._getAttachmentParameterFallback(t);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=dc(this.gl,r)),r}getAttachmentParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const r={};for(const s of i)r[t?dc(this.gl,s):s]=this.getAttachmentParameter(e,s,t);return r}getParameters(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=Object.keys(this.attachments),i={};for(const r of t){const s=Number(r);i[e?dc(this.gl,s):s]=this.getAttachmentParameters(s,e)}return i}show(){return typeof window<"u"&&window.open(Ex(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e>ue.level||typeof window>"u")return this;t=t||"Framebuffer ".concat(this.id);const i=Ex(this,{targetMaxHeight:100});return ue.image({logLevel:e,message:t,image:i},t)(),this}bind(){let{target:e=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,i,r,s){let o=null;return e&&(o=o||{},o[36064]=new xi(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),t&&i?(o=o||{},o[33306]=new Bd(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}),this.ownResources.push(o[33306])):t?(o=o||{},o[36096]=new Bd(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:s}),this.ownResources.push(o[36096])):i&&ne(!1),o}_unattach(e){const t=this.attachments[e];t&&(t instanceof Bd?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:t=36064,renderbuffer:i}=e;const{gl:r}=this;r.framebufferRenderbuffer(36160,t,36161,i.handle),this.attachments[t]=i}_attachTexture(e){let{attachment:t=36064,texture:i,layer:r,level:s}=e;const{gl:o}=this;switch(o.bindTexture(i.target,i.handle),i.target){case 35866:case 32879:Ui(o).framebufferTextureLayer(36160,t,i.target,s,r);break;case 34067:const c=function ahe(n){return n<34069?n+34069:n}(r);o.framebufferTexture2D(36160,t,c,i.handle,s);break;case 3553:o.framebufferTexture2D(36160,t,3553,i.handle,s);break;default:ne(!1,"Illegal texture type")}o.bindTexture(i.target,null),this.attachments[t]=i}_setReadBuffer(e){const t=function Lue(n){return et(n)?n:null}(this.gl);t?t.readBuffer(e):ne(36064===e||1029===e,_3),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,i=Ui(t);if(i)i.drawBuffers(e);else{const r=t.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):ne(1===e.length&&(36064===e[0]||1029===e[0]),_3)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function she(n){n.luma=n.luma||{},n.luma.caps=n.luma.caps||{};for(const e in p3)void 0===n.luma.caps[e]&&(n.luma.caps[e]=m3(n,e));return n.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}Un.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const uhe={5126:sn.bind(null,"uniform1fv",Hr,1,ji),35664:sn.bind(null,"uniform2fv",Hr,2,ji),35665:sn.bind(null,"uniform3fv",Hr,3,ji),35666:sn.bind(null,"uniform4fv",Hr,4,ji),5124:sn.bind(null,"uniform1iv",hc,1,ji),35667:sn.bind(null,"uniform2iv",hc,2,ji),35668:sn.bind(null,"uniform3iv",hc,3,ji),35669:sn.bind(null,"uniform4iv",hc,4,ji),35670:sn.bind(null,"uniform1iv",hc,1,ji),35671:sn.bind(null,"uniform2iv",hc,2,ji),35672:sn.bind(null,"uniform3iv",hc,3,ji),35673:sn.bind(null,"uniform4iv",hc,4,ji),35674:sn.bind(null,"uniformMatrix2fv",Hr,4,da),35675:sn.bind(null,"uniformMatrix3fv",Hr,9,da),35676:sn.bind(null,"uniformMatrix4fv",Hr,16,da),35678:Si,35680:Si,5125:sn.bind(null,"uniform1uiv",Av,1,ji),36294:sn.bind(null,"uniform2uiv",Av,2,ji),36295:sn.bind(null,"uniform3uiv",Av,3,ji),36296:sn.bind(null,"uniform4uiv",Av,4,ji),35685:sn.bind(null,"uniformMatrix2x3fv",Hr,6,da),35686:sn.bind(null,"uniformMatrix2x4fv",Hr,8,da),35687:sn.bind(null,"uniformMatrix3x2fv",Hr,6,da),35688:sn.bind(null,"uniformMatrix3x4fv",Hr,12,da),35689:sn.bind(null,"uniformMatrix4x2fv",Hr,8,da),35690:sn.bind(null,"uniformMatrix4x3fv",Hr,12,da),35678:Si,35680:Si,35679:Si,35682:Si,36289:Si,36292:Si,36293:Si,36298:Si,36299:Si,36300:Si,36303:Si,36306:Si,36307:Si,36308:Si,36311:Si},dhe={},hhe={},fhe={},y3=[0];function Ax(n,e,t,i){1===e&&"boolean"==typeof n&&(n=n?1:0),Number.isFinite(n)&&(y3[0]=n,n=y3);const r=n.length;if(r%e&&ue.warn("Uniform size should be multiples of ".concat(e),n)(),n instanceof t)return n;let s=i[r];s||(s=new t(r),i[r]=s);for(let o=0;o<r;o++)s[o]=n[o];return s}function Hr(n,e){return Ax(n,e,Float32Array,dhe)}function hc(n,e){return Ax(n,e,Int32Array,hhe)}function Av(n,e){return Ax(n,e,Uint32Array,fhe)}function v3(n,e,t){const i=uhe[t.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(t.type));return i().bind(null,n,e)}function phe(n){if("]"!==n[n.length-1])return{name:n,length:1,isArray:!1};const t=n.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(n));return{name:t[1],length:t[2]||1,isArray:!!t[2]}}function mhe(n){return Array.isArray(n)||ArrayBuffer.isView(n)?function yhe(n){if(0===n.length)return!1;const e=Math.min(n.length,16);for(let t=0;t<e;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n):!!(isFinite(n)||!0===n||!1===n||n instanceof Ml||n instanceof Bd)||n instanceof Un&&!!n.texture}function _he(n,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))if(n[e]){const i=n[e];for(let r=0,s=t.length;r<s;++r)i[r]=t[r]}else n[e]=t.slice();else n[e]=t}function Si(){let n=null;return(e,t,i)=>{const r=n!==i;return r&&(e.uniform1i(t,i),n=i),r}}function sn(n,e,t,i){let r=null,s=null;return(o,a,c)=>{const l=e(c,t),u=l.length;let d=!1;if(null===r)r=new Float32Array(u),s=u,d=!0;else{ne(s===u,"Uniform length cannot change.");for(let h=0;h<u;++h)if(l[h]!==r[h]){d=!0;break}}return d&&(i(o,n,a,l),r.set(l)),d}}function ji(n,e,t,i){n[e](t,i)}function da(n,e,t,i){n[e](t,!1,i)}function Tv(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const i=n.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return i?i[1]:e}function w3(n,e){let t="";for(let i=0;i<e.length;i++)if((n[i+3]||n[i+2]||n[i+1])&&(t+="".concat(e[i],"\n"),n[i+1])){const s=n[i+1],o=s.split(":",3),a=o[0],c=parseInt(o[1],10)||0,l=s.substring(o.join(":").length+1).trim();t+=E3("^^^ ".concat(a,": ").concat(l,"\n\n"),c)}return t}function E3(n,e){let t="";for(let i=0;i<e;++i)t+=" ";return"".concat(t).concat(n)}class Up extends ua{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return ne(!1),"unknown"}}constructor(e,t){Ev(e),ne("string"==typeof t.source,"Shader: GLSL source code must be a JavaScript string"),super(e,{id:Tv(t.source,null)||t.id||Er("unnamed ".concat(Up.getTypeName(t.shaderType)))}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize(e){let{source:t}=e;const i=Tv(t,null);i&&(this.id=Er(i)),this._compile(t)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(Up.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Tv(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.source;if(e.startsWith("#version ")||(e="#version 100\n".concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:o}=function b3(n,e,t,i){const r=n.split(/\r?\n/),s={},o={},a=i||Tv(e)||"(unnamed)",c="".concat(function whe(n){switch(n){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(t)," shader ").concat(a);for(let u=0;u<r.length;u++){const d=r[u];if(d.length<=1)continue;const h=d.split(":"),f=h[0],p=parseInt(h[2],10);if(isNaN(p))throw new Error("GLSL compilation error in ".concat(c,": ").concat(n));"WARNING"!==f?s[p]=d:o[p]=d}const l=function Ehe(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ";const i=n.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,o)=>{const a=String(o+e);return E3(a,r-a.length)+t+s})}(e);return{shaderName:c,errors:w3(s,l),warnings:w3(o,l)}}(i,this.source,this.shaderType,this.id);throw ue.error("GLSL compilation errors in ".concat(r,"\n").concat(s))(),ue.warn("GLSL compilation warnings in ".concat(r,"\n").concat(o))(),new Error("GLSL compilation errors in ".concat(r))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class Tx extends Up{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class xx extends Up{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Ahe=5120,The=5121,xhe=5122,She=5123,ti=5126,Mhe=35664,Ihe=35665,Dhe=35666,jp=5124,Rhe=35667,Ohe=35668,Phe=35669,Hp=5125,Nhe=36294,khe=36295,Fhe=36296,Lhe=35670,Bhe=35671,Vhe=35672,Uhe=35673,jhe=35674,Hhe=35675,zhe=35676,Ghe=35685,Whe=35686,$he=35687,qhe=35688,Xhe=35689,Yhe=35690,Sx={[ti]:[ti,1,"float"],[Mhe]:[ti,2,"vec2"],[Ihe]:[ti,3,"vec3"],[Dhe]:[ti,4,"vec4"],[jp]:[jp,1,"int"],[Rhe]:[jp,2,"ivec2"],[Ohe]:[jp,3,"ivec3"],[Phe]:[jp,4,"ivec4"],[Hp]:[Hp,1,"uint"],[Nhe]:[Hp,2,"uvec2"],[khe]:[Hp,3,"uvec3"],[Fhe]:[Hp,4,"uvec4"],[Lhe]:[ti,1,"bool"],[Bhe]:[ti,2,"bvec2"],[Vhe]:[ti,3,"bvec3"],[Uhe]:[ti,4,"bvec4"],[jhe]:[ti,8,"mat2"],[Ghe]:[ti,8,"mat2x3"],[Whe]:[ti,8,"mat2x4"],[Hhe]:[ti,12,"mat3"],[$he]:[ti,12,"mat3x2"],[qhe]:[ti,12,"mat3x4"],[zhe]:[ti,16,"mat4"],[Xhe]:[ti,16,"mat4x2"],[Yhe]:[ti,16,"mat4x3"]};function M3(n){const e=Sx[n];if(!e)return null;const[t,i]=e;return{type:t,components:i}}function I3(n,e){switch(n){case Ahe:case The:case xhe:case She:n=ti}for(const t in Sx){const[i,r,s]=Sx[t];if(i===n&&r===e)return{glType:t,name:s}}return null}class Khe{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,i=t.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getActiveAttrib(e.handle,r),c=t.getAttribLocation(e.handle,s);c>=0&&this._addAttribute(c,s,o,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!et(t))return;const i=t.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,o,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,t,i,r){const{type:s,components:o}=M3(i),a={type:s,size:r*o};this._inferProperties(e,t,a);const c={location:e,name:t,accessor:new Cr(a)};this.attributeInfos.push(c),this.attributeInfosByLocation[e]=c,this.attributeInfosByName[c.name]=c}_inferProperties(e,t,i){/instance/i.test(t)&&(i.divisor=1)}_addVarying(e,t,i,r){const{type:s,components:o}=M3(i),c={location:e,name:t,accessor:new Cr({type:s,size:r*o})};this.varyingInfos.push(c),this.varyingInfosByName[c.name]=c}}const Jhe=35981,Qhe=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class R3 extends ua{get[Symbol.toStringTag](){return"Program"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.stubRemovedMethods("Program","v6.0",Qhe),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hash:t,vs:i,fs:r,varyings:s,bufferMode:o=Jhe}=e;return this.hash=t||"",this.vs="string"==typeof i?new Tx(this.gl,{id:"".concat(e.id,"-vs"),source:i}):i,this.fs="string"==typeof r?new xx(this.gl,{id:"".concat(e.id,"-fs"),source:r}):r,ne(this.vs instanceof Tx),ne(this.fs instanceof xx),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Ui(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Khe(this),this.setProps(e)}delete(){return this._isCached?this:super.delete(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:t,drawMode:i=4,vertexCount:r,offset:s=0,start:o,end:a,isIndexed:c=!1,indexType:l=5123,instanceCount:u=0,isInstanced:d=u>0,vertexArray:h=null,transformFeedback:f,framebuffer:p,parameters:g={},uniforms:m,samplers:y}=e;if((m||y)&&(ue.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(m||{})),ue.priority>=t){const v=p?p.id:"default",_="mode=".concat(dc(this.gl,i)," verts=").concat(r," ")+"instances=".concat(u," indexType=").concat(dc(this.gl,l)," ")+"isInstanced=".concat(d," isIndexed=").concat(c," ")+"Framebuffer=".concat(v);ue.log(t,_)()}return ne(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===r||d&&0===u||(h.bindForDraw(r,u,()=>{if(void 0!==p&&(g=Object.assign({},g,{framebuffer:p})),f){const v=function S3(n){switch(n){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return ne(!1),0}}(i);f.begin(v)}this._bindTextures(),us(this.gl,g,()=>{c&&d?this.gl2.drawElementsInstanced(i,r,l,s,u):c&&et(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(i,o,a,r,l,s):c?this.gl.drawElements(i,r,l,s):d?this.gl2.drawArraysInstanced(i,s,r,u):this.gl.drawArrays(i,s,r)}),f&&f.end()}),0))}setUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ue.priority>=2&&function ghe(n,e,t){for(const i in n){const r=n[i];if((!t||t[i])&&!mhe(r))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(i),r),new Error("".concat(e," Bad uniform ").concat(i))}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const i=e[t],r=this._uniformSetters[t];if(r){let s=i,o=!1;if(s instanceof Un&&(s=s.texture),s instanceof Ml)if(o=this.uniforms[t]!==i,o){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:c}=r;a.bind(c),s=c,this._textureUniforms[t]=a}else s=r.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(r(s)||o)&&_he(this.uniforms,t,i)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const i=this._textureUniforms[t];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms)this._textureUniforms[e].bind(this._uniformSetters[e].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),i={};for(const r of t)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new Tx({handle:r});break;case 35632:i.fs=new xx({handle:r})}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const t=this._getName();this.id=Er(t)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),ue.time(4,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),ue.timeEnd(4,"linkProgram for ".concat(this._getName()))(),e.debug||ue.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const i=this.gl.getActiveUniform(this.handle,t),{name:r}=phe(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=v3(e,s,i),i.size>1)for(let o=0;o<i.size;o++)s=e.getUniformLocation(this.handle,"".concat(r,"[").concat(o,"]")),this._uniformSetters["".concat(r,"[").concat(o,"]")]=v3(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class zp{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new zp(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(t=>t.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==t),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{vs:t="",fs:i="",defines:r={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:c=!1}=e,l=this._getModuleList(e.modules),u=this._getHash(t),d=this._getHash(i),h=l.map(_=>this._getHash(_.name)).sort(),f=o.map(_=>this._getHash(_)),p=Object.keys(r).sort(),g=Object.keys(s).sort(),m=[],y=[];for(const _ of p)m.push(this._getHash(_)),m.push(this._getHash(r[_]));for(const _ of g)y.push(this._getHash(_)),y.push(this._getHash(s[_]));const v="".concat(u,"/").concat(d,"D").concat(m.join("/"),"M").concat(h.join("/"),"I").concat(y.join("/"),"V").concat(f.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(c?"T":"");if(!this._programCache[v]){const _=function Mue(n,e){const{vs:t,fs:i}=e,r=iue(e.modules||[]);return{gl:n,vs:kU(n,Object.assign({},e,{source:t,type:Pp,modules:r})),fs:kU(n,Object.assign({},e,{source:i,type:"fs",modules:r})),getUniforms:Iue(r)}}(this.gl,{vs:t,fs:i,modules:l,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:c});this._programCache[v]=new R3(this.gl,{hash:v,vs:_.vs,fs:_.fs,varyings:o,bufferMode:a}),this._getUniforms[v]=_.getUniforms||(E=>{}),this._useCounts[v]=0}return this._useCounts[v]++,this._programCache[v]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],c=a.name;t[r++]=a,i[c]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],c=a.name;i[c]||(t[r++]=a,i[c]=!0)}return t.length=r,t}}const efe=[255,255,255],tfe=1;let nfe=0;class O3{constructor(e={}){w(this,"id",void 0),w(this,"color",void 0),w(this,"intensity",void 0),w(this,"type","ambient");const{color:t=efe}=e,{intensity:i=tfe}=e;this.id=e.id||"ambient-".concat(nfe++),this.color=t,this.intensity=i}}const ife=[255,255,255],rfe=1,sfe=[0,0,-1];let ofe=0;class P3{constructor(e={}){w(this,"id",void 0),w(this,"color",void 0),w(this,"intensity",void 0),w(this,"type","directional"),w(this,"direction",void 0),w(this,"shadow",void 0);const{color:t=ife}=e,{intensity:i=rfe}=e,{direction:r=sfe}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(ofe++),this.color=t,this.intensity=i,this.type="directional",this.direction=new Vi(r).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class afe{constructor(e,t={id:"pass"}){w(this,"id",void 0),w(this,"gl",void 0),w(this,"props",void 0);const{id:i}=t;this.id=i,this.gl=e,this.props={...t}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class Sv extends afe{constructor(...e){super(...e),w(this,"_lastRenderIndex",-1)}render(e){return la(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:t,moduleParameters:i,viewports:r,views:s,onViewportActive:o,clearStack:a=!0,clearCanvas:c=!0}=e;e.pass=e.pass||"unknown";const l=this.gl;c&&function lfe(n){la(n,{viewport:[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}),n.clear(16640)}(l),a&&(this._lastRenderIndex=-1);const u=[];for(const d of r){const h=s&&s[d.id];o(d);const f=this._getDrawLayerParams(d,e),p=d.subViewports||[d];for(const g of p){const m=this._drawLayersInViewport(l,{target:t,moduleParameters:i,viewport:g,view:h,pass:e.pass,layers:e.layers},f);u.push(m)}}return u}_getDrawLayerParams(e,{layers:t,pass:i,layerFilter:r,cullRect:s,effects:o,moduleParameters:a}){const c=[],l=N3(this._lastRenderIndex+1),u={layer:t[0],viewport:e,isPicking:i.startsWith("picking"),renderPass:i,cullRect:s},d={};for(let h=0;h<t.length;h++){const f=t[h],p=this._shouldDrawLayer(f,u,r,d),g={shouldDrawLayer:p};p&&(g.layerRenderIndex=l(f,p),g.moduleParameters=this._getModuleParameters(f,o,i,a),g.layerParameters=this.getLayerParameters(f,h,e)),c[h]=g}return c}_drawLayersInViewport(e,{layers:t,moduleParameters:i,pass:r,target:s,viewport:o,view:a},c){const l=function cfe(n,{moduleParameters:e,target:t,viewport:i}){const r=t&&"default-framebuffer"!==t.id,s=e&&e.devicePixelRatio||kd(n);return[i.x*s,(r?t.height:n.drawingBufferHeight)-(i.y+i.height)*s,i.width*s,i.height*s]}(e,{moduleParameters:i,target:s,viewport:o});if(a&&a.props.clear){const d=!0===a.props.clear?{color:!0,depth:!0}:a.props.clear;us(e,{scissorTest:!0,scissor:l},()=>bx(e,d))}const u={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};la(e,{viewport:l});for(let d=0;d<t.length;d++){const h=t[d],{shouldDrawLayer:f,layerRenderIndex:p,moduleParameters:g,layerParameters:m}=c[d];if(f&&h.props.pickable&&u.pickableCount++,h.isComposite)u.compositeCount++;else if(f){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,p),g.viewport=o;try{h._drawLayer({moduleParameters:g,uniforms:{layerIndex:p},parameters:m})}catch(y){h.raiseError(y,"drawing ".concat(h," to ").concat(r))}}}return u}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t,i){return e.props.parameters}_shouldDrawLayer(e,t,i,r){if(!e.props.visible||!this.shouldDrawLayer(e))return!1;t.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(t))return!1;t.layer=o,o=o.parent}if(i){const a=t.layer.id;if(a in r||(r[a]=i(t)),!r[a])return!1}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,i,r){var s;const o=Object.assign(Object.create((null===(s=e.internalState)||void 0===s?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:kd(this.gl)});if(t)for(const c of t){var a;Object.assign(o,null===(a=c.getModuleParameters)||void 0===a?void 0:a.call(c,e))}return Object.assign(o,this.getModuleParameters(e,t),r)}}function N3(n=0,e={}){const t={},i=(r,s)=>{const o=r.props._offset,a=r.id,c=r.parent&&r.parent.id;let l;if(c&&!(c in e)&&i(r.parent,!1),c in t){const u=t[c]=t[c]||N3(e[c],e);l=u(r,s),t[a]=u}else Number.isFinite(o)?(l=o+(e[c]||0),t[a]=null):l=n;return s&&l>=n&&(n=l+1),e[a]=l,l};return i}class ufe extends Sv{constructor(e,t){super(e,t),w(this,"shadowMap",void 0),w(this,"depthBuffer",void 0),w(this,"fbo",void 0),this.shadowMap=new xi(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Bd(e,{format:33189,width:1,height:1}),this.fbo=new Un(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;us(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=kd(this.gl),s=i.width*r,o=i.height*r;(s!==t.width||o!==t.height)&&t.resize({width:s,height:o}),super.render({...e,target:t,pass:"shadow"})})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const k3="#define SMOOTH_EDGE_RADIUS 0.5",pfe={name:"geometry",vs:"\n".concat(k3,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(k3,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")},gfe=Object.keys(ut).map(n=>"const int COORDINATE_SYSTEM_".concat(n," = ").concat(ut[n],";")).join(""),mfe=Object.keys(fo).map(n=>"const int PROJECTION_MODE_".concat(n," = ").concat(fo[n],";")).join(""),_fe=Object.keys(gv).map(n=>"const int UNIT_".concat(n.toUpperCase()," = ").concat(gv[n],";")).join(""),yfe="".concat(gfe,"\n").concat(mfe,"\n").concat(_fe,'\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0; // meters\nconst float GLOBE_RADIUS = 256.0;\n\n// returns an adjustment factor for uCommonUnitsPerMeter\nfloat project_size_at_latitude(float lat) {\n  float y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n\n    // uCommonUnitsPerMeter in low-zoom Web Mercator is non-linear\n    // Adjust by 1 / cos(latitude)\n    // If geometry.position (vertex in common space) is populated, use it\n    // Otherwise use geometry.worldPosition (anchor in world space)\n    \n    if (geometry.position.w == 0.0) {\n      return project_size_at_latitude(geometry.worldPosition.y);\n    }\n\n    // latitude from common y: 2.0 * (atan(exp(y / TILE_SIZE * 2.0 * PI - PI)) - PI / 4.0)\n    // Taylor series of 1 / cos(latitude)\n    // Max error < 0.003\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\nfloat project_size_at_latitude(float meters, float lat) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\n\n//\n// Scaling offsets - scales meters to "world distance"\n// Note the scalar version of project_size is for scaling the z component only\n//\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\n\n// Get rotation matrix that aligns the z axis with the given up vector\n// Find 3 unit vectors ux, uy, uz that are perpendicular to each other and uz == up\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  // Tangent on XY plane\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n\n//\n// Projecting normal - transform deltas from current coordinate system to\n// normals in the worldspace\n//\nvec3 project_normal(vec3 vector) {\n  // Apply model matrix\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\n\n//\n// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]\n//\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\n\n//\n// Projects positions (defined by project_uCoordinateSystem) to common space (defined by project_uProjectionMode)\n//\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n\n  // Work around for a Mac+NVIDIA bug https://github.com/visgl/deck.gl/issues/4145\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size_at_latitude(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        // Too far from the projection center for offset mode to be accurate\n        // Only use high parts\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n\n  // Translation is already added to the high parts\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\n\n//\n// Projects from common space coordinates to clip space.\n// Uses project_uViewProjectionMatrix\n//\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\n\n// Returns a clip space offset that corresponds to a given number of screen pixels\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  // UNIT_PIXELS\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n');function vfe(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}return!1}function Mv(n){let t,e={};return i=>{for(const r in i)if(!vfe(i[r],e[r])){t=n(i),e=i;break}return t}}const F3=[0,0,0,0],bfe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],L3=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],wfe=[0,0,0],B3=[0,0,0],Efe=Mv(function Tfe({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:c,geospatialOrigin:l}=function Cfe(n,e,t){const{viewMatrixUncentered:i,projectionMatrix:r}=n;let{viewMatrix:s,viewProjectionMatrix:o}=n,a=F3,c=F3,l=n.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:d,offsetMode:h}=V3(n,e,t);return h&&(c=n.projectPosition(u||d),l=[l[0]-c[0],l[1]-c[1],l[2]-c[2]],c[3]=1,a=Ip([],c,o),s=i||s,o=Cl([],r,s),o=Cl([],o,bfe)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:c,cameraPosCommon:l,shaderCoordinateOrigin:d,geospatialOrigin:u}}(n,t,i),u=n.getDistanceScales(),d=[n.width*e,n.height*e],h=Ip([],[0,0,-n.focalDistance,1],n.projectionMatrix)[3]||1,f={project_uCoordinateSystem:t,project_uProjectionMode:n.projectionMode,project_uCoordinateOrigin:c,project_uCommonOrigin:o.slice(0,3),project_uCenter:r,project_uPseudoMeters:!!n._pseudoMeters,project_uViewportSize:d,project_uDevicePixelRatio:e,project_uFocalDistance:h,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:wfe,project_uScale:n.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:L3,project_uCameraPosition:a};if(l){const p=n.getDistanceScales(l);switch(t){case ut.METER_OFFSETS:f.project_uCommonUnitsPerWorldUnit=p.unitsPerMeter,f.project_uCommonUnitsPerWorldUnit2=p.unitsPerMeter2;break;case ut.LNGLAT:case ut.LNGLAT_OFFSETS:n._pseudoMeters||(f.project_uCommonUnitsPerMeter=p.unitsPerMeter),f.project_uCommonUnitsPerWorldUnit=p.unitsPerDegree,f.project_uCommonUnitsPerWorldUnit2=p.unitsPerDegree2;break;case ut.CARTESIAN:f.project_uCommonUnitsPerWorldUnit=[1,1,p.unitsPerMeter[2]],f.project_uCommonUnitsPerWorldUnit2=[0,0,p.unitsPerMeter2[2]]}}return f});function V3(n,e,t=B3){t.length<3&&(t=[t[0],t[1],0]);let r,i=t,s=!0;switch(r=e===ut.LNGLAT_OFFSETS||e===ut.METER_OFFSETS?t:n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case fo.WEB_MERCATOR:(e===ut.LNGLAT||e===ut.CARTESIAN)&&(r=[0,0,0],s=!1);break;case fo.WEB_MERCATOR_AUTO_OFFSET:e===ut.LNGLAT?i=r:e===ut.CARTESIAN&&(i=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],r=n.unprojectPosition(i),i[0]-=t[0],i[1]-=t[1],i[2]-=t[2]);break;case fo.IDENTITY:i=n.position.map(Math.fround),i[2]=i[2]||0;break;case fo.GLOBE:s=!1,r=null;break;default:s=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}const xfe={},Mx={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null},pfe],vs:yfe,getUniforms:function Sfe(n=xfe){return"viewport"in n?function Afe({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:i=ut.DEFAULT,coordinateOrigin:r=B3,autoWrapLongitude:s=!1}){i===ut.DEFAULT&&(i=n.isGeospatial?ut.LNGLAT:ut.CARTESIAN);const o=Efe({viewport:n,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return o.project_uWrapLongitude=s,o.project_uModelMatrix=t||L3,o}(n):{}}},Dfe=Mv(function kfe({viewport:n,center:e}){return new Ge(n.viewProjectionMatrix).invert().transform(e)}),Rfe=Mv(function Ffe({viewport:n,shadowMatrices:e}){const t=[],i=n.pixelUnprojectionMatrix,r=n.isGeospatial?void 0:1,s=[[0,0,r],[n.width,0,r],[0,n.height,r],[n.width,n.height,r],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(o=>function Nfe(n,e){const[t,i,r]=n,s=Dp([t,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}(o,i));for(const o of e){const a=o.clone().translate(new Vi(n.center).negate()),c=s.map(u=>a.transform(u)),l=(new Ge).ortho({left:Math.min(...c.map(u=>u[0])),right:Math.max(...c.map(u=>u[0])),bottom:Math.min(...c.map(u=>u[1])),top:Math.max(...c.map(u=>u[1])),near:Math.min(...c.map(u=>-u[2])),far:Math.max(...c.map(u=>-u[2]))});t.push(l.multiplyRight(o))}return t}),Ofe=[0,0,0,1],Pfe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Ix={name:"shadow",dependencies:[Mx],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(n={},e={})=>"viewport"in n&&(n.drawToShadowMap||n.shadowMaps&&n.shadowMaps.length>0)?function Lfe(n,e){const{shadowEnabled:t=!0}=n;if(!t||!n.shadowMatrices||!n.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:!!n.drawToShadowMap,shadow_uUseShadowMap:!!n.shadowMaps&&n.shadowMaps.length>0,shadow_uColor:n.shadowColor||Ofe,shadow_uLightId:n.shadowLightId||0,shadow_uLightCount:n.shadowMatrices.length},r=Dfe({viewport:n.viewport,center:e.project_uCenter}),s=[],o=Rfe({shadowMatrices:n.shadowMatrices,viewport:n.viewport}).slice();for(let a=0;a<n.shadowMatrices.length;a++){const c=o[a],l=c.clone().translate(new Vi(n.viewport.center).negate());e.project_uCoordinateSystem===ut.LNGLAT&&e.project_uProjectionMode===fo.WEB_MERCATOR?(o[a]=l,s[a]=r):(o[a]=c.clone().multiplyRight(Pfe),s[a]=l.transform(r))}for(let a=0;a<o.length;a++)i["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],i["shadow_uProjectCenters[".concat(a,"]")]=s[a],i["shadow_uShadowMap".concat(a)]=n.shadowMaps&&n.shadowMaps.length>0?n.shadowMaps[a]:n.dummyShadowMap;return i}(n,e):{}},Bfe={color:[255,255,255],intensity:1},U3=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Vfe=[0,0,0,200/255];class Dx{constructor(e={}){w(this,"id","lighting-effect"),w(this,"props",null),w(this,"shadowColor",Vfe),w(this,"shadow",void 0),w(this,"ambientLight",null),w(this,"directionalLights",[]),w(this,"pointLights",[]),w(this,"shadowPasses",[]),w(this,"shadowMaps",[]),w(this,"dummyShadowMap",null),w(this,"programManager",void 0),w(this,"shadowMatrices",void 0);for(const t in e){const i=e[t];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow)}preRender(e,{layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=zp.getDefaultProgramManager(e),Ix&&this.programManager.addDefaultModule(Ix)),this.dummyShadowMap||(this.dummyShadowMap=new xi(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Ix),this.programManager=null)}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const i=(new Ge).lookAt({eye:new Vi(t.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const i=new ufe(e);this.shadowPasses[t]=i,this.shadowMaps[t]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:i}=this;!e&&0===t.length&&0===i.length&&(this.ambientLight=new O3(Bfe),this.directionalLights.push(new P3(U3[0]),new P3(U3[1])))}}let Ufe=1,jfe=1;class j3{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,o=Ufe++,a={time:0,delay:t,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,i]of this.animations)i.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:o}=r;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const i=jfe++;return this.animations.set(i,{animation:e,channel:t}),e.setTime(this.getTime(t)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const i=t-e.delay;i>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}const Iv=Symbol.for("component"),Hd=Symbol.for("asyncPropDefaults"),Dl=Symbol.for("asyncPropOriginal"),fc=Symbol.for("asyncPropResolved");let Rx={};function Hi(n,e,t,i){ot.level>0&&Rx[n]&&Rx[n].call(null,e,t,i)}function Ox(n,e=()=>!0){return Array.isArray(n)?H3(n,e,[]):e(n)?[n]:[]}function H3(n,e,t){let i=-1;for(;++i<n.length;){const r=n[i];Array.isArray(r)?H3(r,e,t):e(r)&&t.push(r)}return t}function zfe({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s);return n}const Us=n=>"function"==typeof n,pc=n=>null!==n&&"object"==typeof n,G3=n=>pc(n)&&n.constructor==={}.constructor,Gfe=n=>n&&"function"==typeof n[Symbol.iterator],Wfe=n=>n&&"function"==typeof n[Symbol.asyncIterator],zd=n=>typeof Response<"u"&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,Gd=n=>typeof Blob<"u"&&n instanceof Blob,$fe=n=>n&&"object"==typeof n&&n.isBuffer,W3=n=>(n=>typeof ReadableStream<"u"&&n instanceof ReadableStream||pc(n)&&Us(n.tee)&&Us(n.cancel)&&Us(n.getReader))(n)||(n=>pc(n)&&Us(n.read)&&Us(n.pipe)&&(n=>"boolean"==typeof n)(n.readable))(n);function $3(n,e){if(!n)throw new Error(e||"loader assertion failed.")}function Px(n){var e;return!!n&&(Array.isArray(n)&&(n=n[0]),Array.isArray(null===(e=n)||void 0===e?void 0:e.extensions))}function Nx(n){var e,t;let i;return $3(n,"null loader"),$3(Px(n),"invalid loader"),Array.isArray(n)&&(i=n[1],n=n[0],n={...n,options:{...n.options,...i}}),(null!==(e=n)&&void 0!==e&&e.parseTextSync||null!==(t=n)&&void 0!==t&&t.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}let kx="";const Fx={},Jfe=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Qfe=/^([-\w.]+\/[-\w.+]+)/;function epe(n){const e=Qfe.exec(n);return e?e[1]:n}function q3(n){const e=Jfe.exec(n);return e?e[1]:""}const tpe=/\?.*/;function Dv(n){if(zd(n)){const e=Lx(n.url||"");return{url:e,type:epe(n.headers.get("content-type")||"")||q3(e)}}return Gd(n)?{url:Lx(n.name||""),type:n.type||""}:"string"==typeof n?{url:Lx(n),type:q3(n)}:{url:"",type:""}}function Lx(n){return n.replace(tpe,"")}function X3(n){return Bx.apply(this,arguments)}function Bx(){return Bx=Q(function*(n){if(zd(n))return n;const e={},t=function npe(n){return zd(n)?n.headers["content-length"]||-1:Gd(n)?n.size:"string"==typeof n?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}(n);t>=0&&(e["content-length"]=String(t));const{url:i,type:r}=Dv(n);r&&(e["content-type"]=r);const s=yield function spe(n){return jx.apply(this,arguments)}(n);s&&(e["x-first-bytes"]=s),"string"==typeof n&&(n=(new TextEncoder).encode(n));const o=new Response(n,{headers:e});return Object.defineProperty(o,"url",{value:i}),o}),Bx.apply(this,arguments)}function Vx(){return Vx=Q(function*(n){if(!n.ok){const e=yield function rpe(n){return Ux.apply(this,arguments)}(n);throw new Error(e)}}),Vx.apply(this,arguments)}function Ux(){return Ux=Q(function*(n){let e="Failed to fetch resource ".concat(n.url," (").concat(n.status,"): ");try{const t=n.headers.get("Content-Type");let i=n.statusText;t.includes("application/json")&&(i+=" ".concat(yield n.text())),e+=i,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}),Ux.apply(this,arguments)}function jx(){return jx=Q(function*(n){if("string"==typeof n)return"data:,".concat(n.slice(0,5));if(n instanceof Blob){const t=n.slice(0,5);return yield new Promise(i=>{const r=new FileReader;r.onload=s=>{var o;return i(null==s||null===(o=s.target)||void 0===o?void 0:o.result)},r.readAsDataURL(t)})}if(n instanceof ArrayBuffer){const i=function ope(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.byteLength;i++)e+=String.fromCharCode(t[i]);return btoa(e)}(n.slice(0,5));return"data:base64,".concat(i)}return null}),jx.apply(this,arguments)}function Y3(n,e){return Hx.apply(this,arguments)}function Hx(){return Hx=Q(function*(n,e){if("string"==typeof n){n=function Kfe(n){for(const e in Fx)n.startsWith(e)&&(n=n.replace(e,Fx[e]));return!n.startsWith("http://")&&!n.startsWith("https://")&&(n="".concat(kx).concat(n)),n}(n);let t=e;return null!=e&&e.fetch&&"function"!=typeof e?.fetch&&(t=e.fetch),yield fetch(n,t)}return yield X3(n)}),Hx.apply(this,arguments)}const Z3=new Tp({id:"loaders.gl"});class ape{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}typeof self<"u"&&self,typeof window<"u"&&window,typeof global<"u"&&global,typeof document<"u"&&document;const K3=!("object"==typeof process&&"[object process]"===String(process)&&!process.browser),J3=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),Q3=(J3&&parseFloat(J3[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class cpe{constructor(){w(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:K3,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),lpe={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function zx(){globalThis.loaders=globalThis.loaders||{};const{loaders:n}=globalThis;return n._state=n._state||{},n._state}const Gx=()=>{const n=zx();return n.globalOptions=n.globalOptions||{...Q3},n.globalOptions};function upe(n,e,t,i){return t=t||[],function dpe(n,e){tj(n,null,Q3,lpe,e);for(const t of e)tj(n&&n[t.id]||{},t.id,t.options&&t.options[t.id]||{},t.deprecatedOptions&&t.deprecatedOptions[t.id]||{},e)}(n,t=Array.isArray(t)?t:[t]),function nj(n,e,t){const r={...n.options||{}};return function fpe(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}(r,t),null===r.log&&(r.log=new ape),ij(r,Gx()),ij(r,e),r}(e,n,i)}function ej(n,e){const t=Gx(),i=n||t;return"function"==typeof i.fetch?i.fetch:pc(i.fetch)?r=>Y3(r,i):null!=e&&e.fetch?e?.fetch:Y3}function tj(n,e,t,i,r){const s=e||"Top level",o=e?"".concat(e,"."):"";for(const a in n){const c=!e&&pc(n[a]);if(!(a in t)&&("baseUri"!==a||e)&&("workerUrl"!==a||!e))if(a in i)Z3.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(i[a],"'"))();else if(!c){const d=hpe(a,r);Z3.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(d))()}}}function hpe(n,e){const t=n.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(n===s)return"Did you mean '".concat(r.id,".").concat(s,"'?");const o=s.toLowerCase();(t.startsWith(o)||o.startsWith(t))&&(i=i||"Did you mean '".concat(r.id,".").concat(s,"'?"))}return i}function ij(n,e){for(const t in e)t in e&&(n[t]=G3(e[t])&&G3(n[t])?{...n[t],...e[t]}:e[t])}function mo(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}const _o={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},mpe=_o.global||_o.self||_o.window||{},gc="object"!=typeof process||"[object process]"!==String(process)||process.browser,Wx="function"==typeof importScripts,_pe=typeof window<"u"&&typeof window.orientation<"u",rj=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);rj&&parseFloat(rj[1]);class $x{}const qx=new Map;function sj(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function oj(n,e=!0,t){const i=t||new Set;if(n)if(aj(n))i.add(n);else if(aj(n.buffer))i.add(n.buffer);else if(!ArrayBuffer.isView(n)&&e&&"object"==typeof n)for(const r in n)oj(n[r],e,i);return void 0===t?Array.from(i):[]}function aj(n){return!!n&&(n instanceof ArrayBuffer||typeof MessagePort<"u"&&n instanceof MessagePort||typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)}const Xx=()=>{};class Yx{static isSupported(){return typeof Worker<"u"&&gc||typeof $x<"u"&&!gc}constructor(e){w(this,"name",void 0),w(this,"source",void 0),w(this,"url",void 0),w(this,"terminated",!1),w(this,"worker",void 0),w(this,"onMessage",void 0),w(this,"onError",void 0),w(this,"_loadableURL","");const{name:t,source:i,url:r}=e;mo(i||r),this.name=t,this.source=i,this.url=r,this.onMessage=Xx,this.onError=s=>console.log(s),this.worker=gc?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Xx,this.onError=Xx,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,t){t=t||oj(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(t+="".concat(e.message," in ")),e.lineno&&(t+=":".concat(e.lineno,":").concat(e.colno)),new Error(t)}_createBrowserWorker(){this._loadableURL=function ype(n){mo(n.source&&!n.url||!n.source&&n.url);let e=qx.get(n.source||n.url);return e||(n.url&&(e=function vpe(n){if(!n.startsWith("http"))return n;const e=function bpe(n){return"try {\n  importScripts('".concat(n,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")}(n);return sj(e)}(n.url),qx.set(n.url,e)),n.source&&(e=sj(n.source),qx.set(n.source,e))),mo(e),e}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}_createNodeWorker(){let e;if(this.url){const i=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new $x(i,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new $x(this.source,{eval:!0})}return e.on("message",t=>{this.onMessage(t)}),e.on("error",t=>{this.onError(t)}),e.on("exit",t=>{}),e}}class Epe{constructor(e,t){w(this,"name",void 0),w(this,"workerThread",void 0),w(this,"isRunning",!0),w(this,"result",void 0),w(this,"_resolve",()=>{}),w(this,"_reject",()=>{}),this.name=e,this.workerThread=t,this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){mo(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){mo(this.isRunning),this.isRunning=!1,this._reject(e)}}class Cpe{static isSupported(){return Yx.isSupported()}constructor(e){w(this,"name","unnamed"),w(this,"source",void 0),w(this,"url",void 0),w(this,"maxConcurrency",1),w(this,"maxMobileConcurrency",1),w(this,"onDebug",()=>{}),w(this,"reuseWorkers",!0),w(this,"props",{}),w(this,"jobQueue",[]),w(this,"idleQueue",[]),w(this,"count",0),w(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}startJob(e,t=(r,s,o)=>r.done(o),i=(r,s)=>r.error(s)){var r=this;return Q(function*(){const s=new Promise(o=>(r.jobQueue.push({name:e,onMessage:t,onError:i,onStart:o}),r));return r._startQueuedJob(),yield s})()}_startQueuedJob(){var e=this;return Q(function*(){if(!e.jobQueue.length)return;const t=e._getAvailableWorker();if(!t)return;const i=e.jobQueue.shift();if(i){e.onDebug({message:"Starting job",name:i.name,workerThread:t,backlog:e.jobQueue.length});const r=new Epe(i.name,t);t.onMessage=s=>i.onMessage(r,s.type,s.payload),t.onError=s=>i.onError(r,s),i.onStart(r);try{yield r.result}finally{e.returnWorkerToQueue(t)}}})()}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Yx({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return _pe?this.maxMobileConcurrency:this.maxConcurrency}}const Ape={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class ha{static isSupported(){return Yx.isSupported()}static getWorkerFarm(e={}){return ha._workerFarm=ha._workerFarm||new ha({}),ha._workerFarm.setProps(e),ha._workerFarm}constructor(e){w(this,"props",void 0),w(this,"workerPools",new Map),this.props={...Ape},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:i,url:r}=e;let s=this.workerPools.get(t);return s||(s=new Cpe({name:t,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}w(ha,"_workerFarm",void 0);const Tpe="latest";function Zx(){return Zx=Q(function*(n,e,t,i,r){const s=n.id,o=function xpe(n,e={}){const t=e[n.id]||{},i="".concat(n.id,"-worker.js");let r=t.workerUrl;if(!r&&"compression"===n.id&&(r=e.workerUrl),"test"===e._workerType&&(r="modules/".concat(n.module,"/dist/").concat(i)),!r){let s=n.version;"latest"===s&&(s=Tpe);const o=s?"@".concat(s):"";r="https://unpkg.com/@loaders.gl/".concat(n.module).concat(o,"/dist/").concat(i)}return mo(r),r}(n,t),c=ha.getWorkerFarm(t).getWorkerPool({name:s,url:o});t=JSON.parse(JSON.stringify(t)),i=JSON.parse(JSON.stringify(i||{}));const l=yield c.startJob("process-on-worker",Ipe.bind(null,r));return l.postMessage("process",{input:e,options:t,context:i}),yield(yield l.result).result}),Zx.apply(this,arguments)}function Ipe(n,e,t,i){return Kx.apply(this,arguments)}function Kx(){return Kx=Q(function*(n,e,t,i){switch(t){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:r,input:s,options:o}=i;try{const a=yield n(s,o);e.postMessage("done",{id:r,result:a})}catch(a){const c=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:c})}break;default:console.warn("parse-with-worker unknown message ".concat(t))}}),Kx.apply(this,arguments)}function Jx(n){var e,t,i,r=2;for(typeof Symbol<"u"&&(t=Symbol.asyncIterator,i=Symbol.iterator);r--;){if(t&&null!=(e=n[t]))return e.call(n);if(i&&null!=(e=n[i]))return new Rv(e.call(n));t="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}function Rv(n){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var i=t.done;return Promise.resolve(t.value).then(function(r){return{value:r,done:i}})}return(Rv=function(i){this.s=i,this.n=i.next}).prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(i){var r=this.s.return;return void 0===r?Promise.resolve({value:i,done:!0}):e(r.apply(this.s,arguments))},throw:function(i){var r=this.s.return;return void 0===r?Promise.reject(i):e(r.apply(this.s,arguments))}},new Rv(n)}function lj(n){return n&&"object"==typeof n&&n.isBuffer}function uj(n){if(lj(n))return function Dpe(n){return lj(n)?new Uint8Array(n.buffer,n.byteOffset,n.length).slice().buffer:n}(n);if(n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return 0===n.byteOffset&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if("string"==typeof n){const e=n;return(new TextEncoder).encode(e).buffer}if(n&&"object"==typeof n&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function eS(){return eS=Q(function*(n){const e=[];var r,t=!1,i=!1;try{for(var o,s=Jx(n);t=!(o=yield s.next()).done;t=!1)e.push(o.value)}catch(a){i=!0,r=a}finally{try{t&&null!=s.return&&(yield s.return())}finally{if(i)throw r}}return function Ope(...n){const e=n.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),t=e.reduce((s,o)=>s+o.byteLength,0),i=new Uint8Array(t);let r=0;for(const s of e)i.set(s,r),r+=s.byteLength;return i.buffer}(...e)}),eS.apply(this,arguments)}at(492);const Npe=262144,Fpe=262144;function dj(n,e){this.v=n,this.k=e}function Ov(n){return new dj(n,0)}function nS(n){return function(){return new Gp(n.apply(this,arguments))}}function Gp(n){var e,t;function i(s,o){try{var a=n[s](o),c=a.value,l=c instanceof dj;Promise.resolve(l?c.v:c).then(function(u){if(l){var d="return"===s?"return":"next";if(!c.k||u.done)return i(d,u);u=n[d](u).value}r(a.done?"return":"normal",u)},function(u){i("throw",u)})}catch(u){r("throw",u)}}function r(s,o){switch(s){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?i(e.key,e.arg):t=null}this._invoke=function(s,o){return new Promise(function(a,c){var l={key:s,arg:o,resolve:a,reject:c,next:null};t?t=t.next=l:(e=t=l,i(s,o))})},"function"!=typeof n.return&&(this.return=void 0)}Gp.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Gp.prototype.next=function(n){return this._invoke("next",n)},Gp.prototype.throw=function(n){return this._invoke("throw",n)},Gp.prototype.return=function(n){return this._invoke("return",n)};const Bpe=1048576;function iS(){return iS=nS(function*(n,e){const t=e?.chunkSize||Bpe;let i=0;for(;i<n.size;){const r=i+t,s=yield Ov(n.slice(i,r).arrayBuffer());i=r,yield s}}),iS.apply(this,arguments)}function hj(n,e){return K3?function Upe(n,e){return rS.apply(this,arguments)}(n,e):function jpe(n,e){return sS.apply(this,arguments)}(n,e)}function rS(){return rS=nS(function*(n,e){const t=n.getReader();let i;try{for(;;){const r=i||t.read();null!=e&&e._streamReadAhead&&(i=t.read());const{done:s,value:o}=yield Ov(r);if(s)return;yield uj(o)}}catch{t.releaseLock()}}),rS.apply(this,arguments)}function sS(){return sS=nS(function*(n,e){var r,t=!1,i=!1;try{for(var o,s=Jx(n);t=!(o=yield Ov(s.next())).done;t=!1){const a=o.value;yield uj(a)}}catch(a){i=!0,r=a}finally{try{t&&null!=s.return&&(yield Ov(s.return()))}finally{if(i)throw r}}}),sS.apply(this,arguments)}const oS="Cannot convert supplied data type";function aS(){return aS=Q(function*(n,e,t){const i=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if("string"==typeof n||i)return function zpe(n,e){if(e.text&&"string"==typeof n)return n;if($fe(n)&&(n=n.buffer),n instanceof ArrayBuffer){const i=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let i=n.buffer;const r=n.byteLength||n.length;return(0!==n.byteOffset||r!==i.byteLength)&&(i=i.slice(n.byteOffset,n.byteOffset+r)),i}throw new Error(oS)}(n,e);if(Gd(n)&&(n=yield X3(n)),zd(n)){const r=n;return yield function ipe(n){return Vx.apply(this,arguments)}(r),e.binary?yield r.arrayBuffer():yield r.text()}if(W3(n)&&(n=function Hpe(n,e){if("string"==typeof n)return function*kpe(n,e){const t=e?.chunkSize||Npe;let i=0;const r=new TextEncoder;for(;i<n.length;){const s=Math.min(n.length-i,t),o=n.slice(i,i+s);i+=s,yield r.encode(o)}}(n,e);if(n instanceof ArrayBuffer)return function*Lpe(n,e={}){const{chunkSize:t=Fpe}=e;let i=0;for(;i<n.byteLength;){const r=Math.min(n.byteLength-i,t),s=new ArrayBuffer(r),o=new Uint8Array(n,i,r);new Uint8Array(s).set(o),i+=r,yield s}}(n,e);if(Gd(n))return function Vpe(n,e){return iS.apply(this,arguments)}(n,e);if(W3(n))return hj(n,e);if(zd(n))return hj(n.body,e);throw new Error("makeIterator")}(n,t)),Gfe(n)||Wfe(n))return function Ppe(n){return eS.apply(this,arguments)}(n);throw new Error(oS)}),aS.apply(this,arguments)}const Ype=new Tp({id:"loaders.gl"}),fj=()=>{const n=zx();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry};function pj(n){const e=fj();n=Array.isArray(n)?n:[n];for(const t of n){const i=Nx(t);e.find(r=>i===r)||e.unshift(i)}}const Kpe=/\.([^.]+)$/;function uS(){return uS=Q(function*(n,e=[],t,i){if(!mj(n))return null;let r=gj(n,e,{...t,nothrow:!0},i);if(r)return r;if(Gd(n)&&(r=gj(n=yield n.slice(0,10).arrayBuffer(),e,t,i)),!(r||null!=t&&t.nothrow))throw new Error(_j(n));return r}),uS.apply(this,arguments)}function gj(n,e=[],t,i){if(!mj(n))return null;if(e&&!Array.isArray(e))return Nx(e);let r=[];e&&(r=r.concat(e)),null!=t&&t.ignoreRegisteredLoaders||r.push(...function Zpe(){return fj()}()),function ege(n){for(const e of n)Nx(e)}(r);const s=function Qpe(n,e,t,i){const{url:r,type:s}=Dv(n),o=r||i?.url;let a=null,c="";var l;return null!=t&&t.mimeType&&(a=dS(e,t?.mimeType),c="match forced by supplied MIME type ".concat(t?.mimeType)),a=a||function tge(n,e){const t=e&&Kpe.exec(e),i=t&&t[1];return i?function nge(n,e){e=e.toLowerCase();for(const t of n)for(const i of t.extensions)if(i.toLowerCase()===e)return t;return null}(n,i):null}(e,o),c=c||(a?"matched url ".concat(o):""),a=a||dS(e,s),c=c||(a?"matched MIME type ".concat(s):""),a=a||function ige(n,e){if(!e)return null;for(const t of n)if("string"==typeof e){if(rge(e,t))return t}else if(ArrayBuffer.isView(e)){if(yj(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&yj(e,0,t))return t;return null}(e,n),c=c||(a?"matched initial data ".concat(vj(n)):""),a=a||dS(e,t?.fallbackMimeType),c=c||(a?"matched fallback MIME type ".concat(s):""),c&&Ype.log(1,"selectLoader selected ".concat(null===(l=a)||void 0===l?void 0:l.name,": ").concat(c,".")),a}(n,r,t,i);if(!(s||null!=t&&t.nothrow))throw new Error(_j(n));return s}function mj(n){return!(n instanceof Response&&204===n.status)}function _j(n){const{url:e,type:t}=Dv(n);let i="No valid loader found (";i+=e?"".concat(function Xpe(n){const e=n&&n.lastIndexOf("/");return e>=0?n.substr(e+1):""}(e),", "):"no url provided, ",i+="MIME type: ".concat(t?'"'.concat(t,'"'):"not provided",", ");const r=n?vj(n):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function dS(n,e){for(const t of n)if(t.mimeTypes&&t.mimeTypes.includes(e)||e==="application/x.".concat(t.id))return t;return null}function rge(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>n.startsWith(i))}function yj(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(r=>function sge(n,e,t,i){if(i instanceof ArrayBuffer)return function Rpe(n,e,t){if(n.byteLength<(t=t||n.byteLength)||e.byteLength<t)return!1;const i=new Uint8Array(n),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(i,n,i.byteLength);switch(typeof i){case"function":return i(n,t);case"string":return i===hS(n,e,i.length);default:return!1}}(n,e,t,r))}function vj(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?hS(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?hS(n,0,e):""}function hS(n,e,t){if(n.byteLength<e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function Pv(n,e,t,i){return fS.apply(this,arguments)}function fS(){return fS=Q(function*(n,e,t,i){mo(!i||"object"==typeof i),e&&!Array.isArray(e)&&!Px(e)&&(i=void 0,t=e,e=void 0),n=yield n,t=t||{};const{url:r}=Dv(n),o=function qpe(n,e){if(!e&&n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...i]:i}return t&&t.length?t:null}(e,i),a=yield function Jpe(n){return uS.apply(this,arguments)}(n,o,t);return a?(i=function $pe(n,e,t=null){if(t)return t;const i={fetch:ej(e,n),...n};return Array.isArray(i.loaders)||(i.loaders=null),i}({url:r,parse:Pv,loaders:o},t=upe(t,a,o,r),i),yield function oge(n,e,t,i){return pS.apply(this,arguments)}(a,n,t,i)):null}),fS.apply(this,arguments)}function pS(){return pS=Q(function*(n,e,t,i){if(function gpe(n){mo(n,"no worker provided")}(n),zd(e)){const r=e,{ok:s,redirected:o,status:a,statusText:c,type:l,url:u}=r,d=Object.fromEntries(r.headers.entries());i.response={headers:d,ok:s,redirected:o,status:a,statusText:c,type:l,url:u}}if(e=yield function Gpe(n,e,t){return aS.apply(this,arguments)}(e,n,t),n.parseTextSync&&"string"==typeof e)return t.dataType="text",n.parseTextSync(e,t,i,n);if(function Spe(n,e){return!(!ha.isSupported()||!(gc||null!=e&&e._nodeWorkers))&&n.worker&&e?.worker}(n,t))return yield function Mpe(n,e,t,i,r){return Zx.apply(this,arguments)}(n,e,t,i,Pv);if(n.parseText&&"string"==typeof e)return yield n.parseText(e,t,i,n);if(n.parse)return yield n.parse(e,t,i,n);throw mo(!n.parseSync),new Error("".concat(n.id," loader - no parser found and worker is disabled"))}),pS.apply(this,arguments)}function Wp(n,e,t,i){return gS.apply(this,arguments)}function gS(){return gS=Q(function*(n,e,t,i){!Array.isArray(e)&&!Px(e)&&(t=e,e=void 0);const r=ej(t);let s=n;return"string"==typeof n&&(s=yield r(n)),Gd(n)&&(s=yield r(n)),yield Pv(s,e,t)}),gS.apply(this,arguments)}class age{constructor(e,t,i){w(this,"id",void 0),w(this,"context",void 0),w(this,"isLoaded",void 0),w(this,"persistent",void 0),w(this,"_loadCount",0),w(this,"_subscribers",new Set),w(this,"_data",void 0),w(this,"_loader",void 0),w(this,"_error",void 0),w(this,"_content",void 0),this.id=e,this.context=i,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const i=++this._loadCount;let r=e;"string"==typeof e&&(r=Wp(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class cge{constructor({gl:e,protocol:t}){w(this,"protocol",void 0),w(this,"_context",void 0),w(this,"_resources",void 0),w(this,"_consumers",void 0),w(this,"_pruneRequest",void 0),this.protocol=t||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(t,i):(s=new age(e,t,this._context),this._resources[e]=s),s.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const i in t){const r=t[i],s=this._resources[r.resourceId];s&&s.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(s[e=e.replace(o,"")]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,t),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,i,r){const s=this._consumers,o=s[e]=s[e]||{},a=o[t]||{},c=a.resourceId&&this._resources[a.resourceId];c&&(c.unsubscribe(a),this.prune()),i&&(o[t]=a,a.onChange=r,a.resourceId=i.id,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const lge=[Mx],uge=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function dge(n){const e=zp.getDefaultProgramManager(n);for(const t of lge)e.addDefaultModule(t);for(const t of uge)e.addShaderHook(t);return e}class pge{constructor(e,{deck:t,stats:i,viewport:r,timeline:s}={}){w(this,"layers",void 0),w(this,"context",void 0),w(this,"resourceManager",void 0),w(this,"_lastRenderedLayers",[]),w(this,"_needsRedraw",!1),w(this,"_needsUpdate",!1),w(this,"_nextLayers",null),w(this,"_debug",!1),w(this,"activateViewport",o=>{Hi("layerManager.activateViewport",this,o),o&&(this.context.viewport=o)}),this.layers=[],this.resourceManager=new cge({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:t,programManager:e&&dge(e),stats:i||new fx({id:"deck.gl"}),viewport:r||new oc({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new j3,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(t=>e.find(i=>0===t.id.indexOf(i))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){Hi("layerManager.setLayers",this,t,e),this._lastRenderedLayers=e;const i=Ox(e,Boolean);for(const r of i)r.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,t,i){i.raiseError(t,"".concat(e," of ").concat(i))}_updateLayers(e,t){const i={};for(const o of e)i[o.id]?ot.warn("Multiple old layers with same id ".concat(o.id))():i[o.id]=o;const r=[];this._updateSublayersRecursively(t,i,r),this._finalizeOldLayers(i);let s=!1;for(const o of r)if(o.hasUniformTransition()){s="Uniform transition in ".concat(o);break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,t,i){for(const r of e){r.context=this.context;const s=t[r.id];null===s&&ot.warn("Multiple new layers with same id ".concat(r.id))(),t[r.id]=null;let o=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),o=r.isComposite?r.getSubLayers():null}catch(a){this._handleError("matching",a,r)}o&&this._updateSublayersRecursively(o,t,i)}}_finalizeOldLayers(e){for(const t in e){const i=e[t];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle="Initialized"}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle="Matched. State transferred from previous layer",t!==e&&(e.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle="No longer matched. Awaiting garbage collection";try{e._finalize(),e.lifecycle="Finalized! Awaiting garbage collection"}catch(t){this._handleError("finalization",t,e)}}}class gge{constructor(e){w(this,"width",void 0),w(this,"height",void 0),w(this,"views",void 0),w(this,"viewState",void 0),w(this,"controllers",void 0),w(this,"timeline",void 0),w(this,"_viewports",void 0),w(this,"_viewportMap",void 0),w(this,"_isUpdating",void 0),w(this,"_needsRedraw",void 0),w(this,"_needsUpdate",void 0),w(this,"_eventManager",void 0),w(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return this.views.find(t=>t.id===e)}getViewState(e){const t="string"==typeof e?this.getView(e):e,i=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,t){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const o=i[s];if(o.containsPixel(r)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=Ox(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Od(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):ot.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...t,viewId:e})}_createController(e,t){return new(0,t.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return null===(o=this.getView(e.id))||void 0===o?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,t,i,r){const s=e.controller;if(s){const o={...t,...s,id:e.id,x:i.x,y:i.y,width:i.width,height:i.height};return r||(r=this._createController(e,o)),r&&r.setProps(o),r}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let r=e.length;r--;){const s=e[r],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let c=t[s.id];const l=!!s.controller;l&&!c&&(i=!0),(i||!l)&&c&&(c.finalize(),c=null),this.controllers[s.id]=this._updateController(s,o,a,c),this._viewports.unshift(a)}for(const r in t){const s=t[r];s&&!this.controllers[r]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((i,r)=>!e[r].equals(t[r]))}}const yge=Math.PI/180;function bj(n){return 512/4003e4/Math.cos(n*yge)}class mc extends oc{constructor(e={}){const{latitude:t=0,longitude:i=0,zoom:r=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:c=1.01,orthographic:l=!1,projectionMatrix:u,repeat:d=!1,worldOffset:h=0,legacyMeterSizes:f=!1}=e;let{width:p,height:g,altitude:m=1.5}=e;const y=Math.pow(2,r);p=p||1,g=g||1;let v,_=null;u?(m=u[5]/2,v=pv(m)):(e.fovy?(v=e.fovy,m=GT(v)):v=pv(m),_=function uU(n){const{width:e,height:t,altitude:i,pitch:r=0,offset:s,center:o,scale:a,nearZMultiplier:c=1,farZMultiplier:l=1}=n;let{fovy:u=pv(Ale)}=n;void 0!==i&&(u=pv(i));const d=u*ls,h=r*ls,f=GT(u);let p=f;o&&(p+=o[2]*a/Math.cos(h)/t);const g=d*(.5+(s?s[1]:0)/t),m=Math.sin(g)*p/Math.sin(UT(Math.PI/2-h-g,.01,Math.PI-.01)),y=Math.sin(h)*m+p;return{fov:d,aspect:e/t,focalDistance:f,near:c,far:Math.min(y*l,10*p)}}({width:p,height:g,pitch:s,fovy:v,nearZMultiplier:a,farZMultiplier:c}));let E=function Sle(n){const{height:e,pitch:t,bearing:i,altitude:r,scale:s,center:o}=n,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];av(a,a,[0,0,-r]),eU(a,a,-t*ls),tU(a,a,i*ls);const c=s/e;return LT(a,a,[c,c,c]),o&&av(a,a,function Ece(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}([],o)),a}({height:g,pitch:s,bearing:o,scale:y,altitude:m});h&&(E=(new Ge).translate([512*h,0,0]).multiplyLeft(E)),super({...e,width:p,height:g,viewMatrix:E,longitude:i,latitude:t,zoom:r,..._,fovy:v,focalDistance:m}),w(this,"longitude",void 0),w(this,"latitude",void 0),w(this,"pitch",void 0),w(this,"bearing",void 0),w(this,"altitude",void 0),w(this,"fovy",void 0),w(this,"orthographic",void 0),w(this,"_subViewports",void 0),w(this,"_pseudoMeters",void 0),this.latitude=t,this.longitude=i,this.zoom=r,this.pitch=s,this.bearing=o,this.altitude=m,this.fovy=v,this.orthographic=l,this._subViewports=d?[]:null,this._pseudoMeters=f,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),i=Math.ceil((e[2]-180)/360);for(let r=t;r<=i;r++){const s=r?new mc({...this,worldOffset:r}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,i]=this.projectFlat(e);return[t,i,(e[2]||0)*bj(e[1])]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,i]=this.unprojectFlat(e);return[t,i,(e[2]||0)/bj(i)]}addMetersToLngLat(e,t){return lU(e,t)}panByPosition(e,t){const i=Dp(t,this.pixelUnprojectionMatrix),s=cv([],this.projectFlat(e),nU([],i)),o=cv([],this.center,s),[a,c]=this.unprojectFlat(o);return{longitude:a,latitude:c}}getBounds(e={}){const t=function Ile(n,e=0){const{width:t,height:i,unproject:r}=n,s={targetZ:e},o=r([0,i],s),a=r([t,i],s);let c,l;return(n.fovy?.5*n.fovy*fU:Math.atan(.5/n.altitude))>(90-n.pitch)*fU-.01?(c=pU(n,0,e),l=pU(n,t,e)):(c=r([0,0],s),l=r([t,0],s)),[o,a,l,c]}(this,e.z||0);return[Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),Math.min(t[0][1],t[1][1],t[2][1],t[3][1]),Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),Math.max(t[0][1],t[1][1],t[2][1],t[3][1])]}fitBounds(e,t={}){const{width:i,height:r}=this,{longitude:s,latitude:o,zoom:a}=hU({width:i,height:r,bounds:e,...t});return new mc({width:i,height:r,longitude:s,latitude:o,zoom:a})}}w(mc,"displayName","WebMercatorViewport");class bge extends EU{constructor(e){const{width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a=0,pitch:c=0,altitude:l=1.5,position:u=[0,0,0],maxZoom:d=20,minZoom:h=0,maxPitch:f=60,minPitch:p=0,startPanLngLat:g,startZoomLngLat:m,startRotatePos:y,startBearing:v,startPitch:_,startZoom:E,normalize:A=!0}=e;Ti(Number.isFinite(s)),Ti(Number.isFinite(r)),Ti(Number.isFinite(o)),super({width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a,pitch:c,altitude:l,maxZoom:d,minZoom:h,maxPitch:f,minPitch:p,normalize:A,position:u},{startPanLngLat:g,startZoomLngLat:m,startRotatePos:y,startBearing:v,startPitch:_,startZoom:E}),w(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const i=this.getState().startPanLngLat||this._unproject(t);if(!i)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:o}=this.getState();if(!r||void 0===s||void 0===o)return this;let a;return a=e?this._getNewRotation(e,r,o,s):{bearing:s+t,pitch:o+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:t,scale:i}){let{startZoom:r,startZoomLngLat:s}=this.getState();if(s||(r=this.getViewportProps().zoom,s=this._unproject(t)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let c=r+Math.log2(i);c=Ai(c,a,o);const l=this.makeViewport({...this.getViewportProps(),zoom:c});return this._getUpdatedState({zoom:c,...l.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),i={...this.getViewportProps()},{bearing:r,longitude:s}=i;return Math.abs(r-t.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-t.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r}=e;e.zoom=Ai(r,i,t);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=Ai(a,o,s);const{normalize:c=!0}=e;return c&&Object.assign(e,function Dle(n){const{width:e,height:t,pitch:i=0}=n;let{longitude:r,latitude:s,zoom:o,bearing:a=0}=n;(r<-180||r>180)&&(r=aU(r+180,360)-180),(a<-180||a>180)&&(a=aU(a+180,360)-180);const c=jT(t/512);if(o<=c)o=c,s=0;else{const l=t/2/Math.pow(2,o),u=Rd([0,l])[1];if(s<u)s=u;else{const d=Rd([0,512-l])[1];s>d&&(s=d)}}return{width:e,height:t,longitude:r,latitude:s,zoom:o,pitch:i,bearing:a}}(e)),e}_zoomFromCenter(e){const{width:t,height:i}=this.getViewportProps();return this.zoom({pos:[t/2,i/2],scale:e})}_panFromCenter(e){const{width:t,height:i}=this.getViewportProps();return this.pan({startPos:[t/2,i/2],pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,i,r){const s=e[0]-t[0],o=e[1]-t[1],a=e[1],c=t[1],{width:l,height:u}=this.getViewportProps(),d=s/l;let h=0;o>0?Math.abs(u-c)>5&&(h=o/(c-u)*1.2):o<0&&c>5&&(h=1-a/c),h=Ai(h,-1,1);const{minPitch:f,maxPitch:p}=this.getViewportProps();let m=i;return h>0?m=i+h*(p-i):h<0&&(m=i-h*(f-i)),{pitch:m,bearing:r+180*d}}}class wge extends XT{constructor(...e){super(...e),w(this,"ControllerState",bge),w(this,"transition",{transitionDuration:300,transitionInterpolator:new mv({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),w(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Ej extends $T{get ViewportType(){return mc}get ControllerType(){return wge}}w(Ej,"displayName","MapView");class Ege extends Sv{constructor(e,t){super(e,t),w(this,"maskMap",void 0),w(this,"fbo",void 0);const{mapSize:i=2048}=t;this.maskMap=new xi(e,{width:i,height:i,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.fbo=new Un(e,{id:"maskmap",width:i,height:i,attachments:{36064:this.maskMap}})}render(e){const t=this.gl,i=[!1,!1,!1,!1];return i[e.channel]=!0,us(t,{clearColor:[255,255,255,255],blend:!0,blendFunc:[0,1],blendEquation:32778,colorMask:i,depthTest:!1},()=>super.render({...e,target:this.fbo,pass:"mask"}))}shouldDrawLayer(e){return"mask"===e.props.operation}delete(){this.fbo.delete(),this.maskMap.delete()}}class xge{constructor(){w(this,"id","mask-effect"),w(this,"props",null),w(this,"useInPicking",!0),w(this,"dummyMaskMap",void 0),w(this,"channels",[]),w(this,"masks",null),w(this,"maskPass",void 0),w(this,"maskMap",void 0),w(this,"lastViewport",void 0)}preRender(e,{layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o}){this.dummyMaskMap||(this.dummyMaskMap=new xi(e,{width:1,height:1}));const a=t.filter(d=>d.props.visible&&"mask"===d.props.operation);if(0===a.length)return this.masks=null,void(this.channels.length=0);this.masks={},this.maskPass||(this.maskPass=new Ege(e,{id:"default-mask"}),this.maskMap=this.maskPass.maskMap);const c=this._sortMaskChannels(a),l=r[0],u=!this.lastViewport||!this.lastViewport.equals(l);for(const d in c)this._renderChannel(c[d],{layerFilter:i,onViewportActive:s,views:o,viewport:l,viewportChanged:u})}_renderChannel(e,{layerFilter:t,onViewportActive:i,views:r,viewport:s,viewportChanged:o}){const a=this.channels[e.index];if(!a)return;const c=e===a||a.layers.length!==e.layers.length||e.layerBounds.some((l,u)=>l!==a.layerBounds[u]);if(e.bounds=a.bounds,e.maskBounds=a.maskBounds,this.channels[e.index]=e,(c||o)&&(this.lastViewport=s,e.bounds=function Cge({layers:n,viewport:e}){let t=null;for(const s of n){const o=s.getBounds();o&&(t?(t[0]=Math.min(t[0],o[0][0]),t[1]=Math.min(t[1],o[0][1]),t[2]=Math.max(t[2],o[1][0]),t[3]=Math.max(t[3],o[1][1])):t=[o[0][0],o[0][1],o[1][0],o[1][1]])}const i=e.getBounds();if(!t)return i;const r=function Tge(n){const e_x=n[2]-n[0],e_y=n[3]-n[1],t_x=n[0]+.5*e_x,t_y=n[1]+.5*e_y;return[t_x-e_x,t_y-e_y,t_x+e_x,t_y+e_y]}(i);return t[2]-t[0]<r[2]-r[0]||t[3]-t[1]<r[3]-r[1]||(t[0]=Math.max(t[0],r[0]),t[1]=Math.max(t[1],r[1]),t[2]=Math.min(t[2],r[2]),t[3]=Math.min(t[3],r[3])),t}({layers:e.layers,viewport:s}),c||!Sd(e.bounds,a.bounds))){const{maskPass:l,maskMap:u}=this,d=function Age({bounds:n,viewport:e,width:t,height:i}){if(n[2]<=n[0]||n[3]<=n[1])return null;if(t-=2,i-=2,e instanceof mc){const{longitude:a,latitude:c,zoom:l}=hU({width:t,height:i,bounds:[[n[0],n[1]],[n[2],n[3]]],maxZoom:20});return new mc({longitude:a,latitude:c,zoom:l,x:1,y:1,width:t,height:i})}const s=[(n[0]+n[2])/2,(n[1]+n[3])/2,0],o=Math.min(20,t/(n[2]-n[0]),i/(n[3]-n[1]));return new ZT({x:1,y:1}).makeViewport({width:t,height:i,viewState:{target:s,zoom:Math.log2(o)}})}({bounds:e.bounds,viewport:s,width:u.width,height:u.height});e.maskBounds=d?d.getBounds():[0,0,1,1],l.render({pass:"mask",channel:e.index,layers:e.layers,layerFilter:t,viewports:d?[d]:[],onViewportActive:i,views:r,moduleParameters:{devicePixelRatio:1}})}this.masks[e.id]={index:e.index,bounds:e.maskBounds,coordinateOrigin:e.coordinateOrigin,coordinateSystem:e.coordinateSystem}}_sortMaskChannels(e){const t={};let i=0;for(const r of e){const{id:s}=r.root;let o=t[s];if(!o){if(++i>4){ot.warn("Too many mask layers. The max supported is 4")();continue}o={id:s,index:this.channels.findIndex(a=>a?.id===s),layers:[],layerBounds:[],coordinateOrigin:r.root.props.coordinateOrigin,coordinateSystem:r.root.props.coordinateSystem},t[s]=o}o.layers.push(r),o.layerBounds.push(r.getBounds())}for(let r=0;r<4;r++){const s=this.channels[r];(!s||!(s.id in t))&&(this.channels[r]=null)}for(const r in t){const s=t[r];s.index<0&&(s.index=this.channels.findIndex(o=>!o),this.channels[s.index]=s)}return t}getModuleParameters(){return{maskMap:this.masks?this.maskMap:this.dummyMaskMap,maskChannels:this.masks}}cleanup(){this.dummyMaskMap&&(this.dummyMaskMap.delete(),this.dummyMaskMap=void 0),this.maskPass&&(this.maskPass.delete(),this.maskPass=void 0,this.maskMap=void 0),this.lastViewport=void 0,this.masks=null,this.channels.length=0}}const Sge=new Dx;class Mge{constructor(){w(this,"effects",void 0),w(this,"_internalEffects",void 0),w(this,"_needsRedraw",void 0),this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!Od(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._internalEffects=e.slice(),this._internalEffects.push(new xge),e.some(t=>t instanceof Dx)||this._internalEffects.push(Sge)}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}}class Ige extends Sv{shouldDrawLayer(e){return"draw"===e.props.operation}}const Cj={blendFunc:[1,0,32771,0],blendEquation:32774};class Aj extends Sv{constructor(...e){super(...e),w(this,"pickZ",void 0),w(this,"_colors",null)}render(e){return e.pickingFBO?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:c,width:l,height:u},cullRect:d,effects:h,pass:f="picking",pickZ:p}){const g=this.gl;this.pickZ=p;const m=p?null:{byLayer:new Map,byAlpha:[]};this._colors=m;const y=us(g,{scissorTest:!0,scissor:[a,c,l,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...Cj,blend:!p},()=>super.render({target:o,layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,cullRect:d,effects:h?.filter(_=>_.useInPicking),pass:f}));return this._colors=null,{decodePickingColor:m&&Rge.bind(null,m),stats:y}}shouldDrawLayer(e){return e.props.pickable&&"draw"===e.props.operation}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t,i){const r={...e.props.parameters};return this._colors?(Object.assign(r,Cj),r.blend=!0,r.blendColor=function Dge(n,e,t){const{byLayer:i,byAlpha:r}=n;let s,o=i.get(e);return o?(o.viewports.push(t),s=o.a):(s=i.size+1,s<=255?(o={a:s,layer:e,viewports:[t]},i.set(e,o),r[s]=o):(ot.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}(this._colors,e,i)):r.blend=!1,r}}function Rge(n,e){const t=n.byAlpha[e[3]];return t&&{pickedLayer:t.layer,pickedViewports:t.viewports,pickedObjectIndex:t.layer.decodePickingColor(e)}}class Pge{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new Ige(e),this.pickLayersPass=new Aj(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=e.layerFilter||this.layerFilter,e.effects=e.effects||[],e.target=e.target||Un.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const i=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,r=t.render({...e,target:i});this._postRender(e.effects,e),this.renderCount++,Hi("deckRenderer.renderLayers",this,r,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){let i=null;for(const r of e)r.preRender(this.gl,t),r.postRender&&(i=r);i&&this._resizeRenderBuffers(),this.lastPostProcessEffect=i}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new Un(this.gl),new Un(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:i}=this,r={inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){r.target=t.target,s.postRender(this.gl,r);break}const o=s.postRender(this.gl,r);r.inputBuffer=o,r.swapBuffer=o===i[0]?i[1]:i[0]}}}const Nge={pickedColor:null,pickedObjectIndex:-1};function kge({pickedColors:n,decodePickingColor:e,deviceX:t,deviceY:i,deviceRadius:r,deviceRect:s}){const{x:o,y:a,width:c,height:l}=s;let u=r*r,d=-1,h=0;for(let f=0;f<l;f++){const p=f+a-i,g=p*p;if(g>u)h+=4*c;else for(let m=0;m<c;m++){if(n[h+3]-1>=0){const v=m+o-t,_=v*v+g;_<=u&&(u=_,d=h)}h+=4}}if(d>=0){const f=n.slice(d,d+4),p=e(f);if(p){const g=Math.floor(d/4/c),m=d/4-g*c;return{...p,pickedColor:f,pickedX:o+m,pickedY:a+g}}ot.error("Picked non-existent layer. Is picking buffer corrupt?")()}return Nge}function Tj({pickInfo:n,viewports:e,pixelRatio:t,x:i,y:r,z:s}){let a,o=e[0];if(e.length>1&&(o=function Bge(n,e){for(let t=n.length-1;t>=0;t--){const i=n[t];if(i.containsPixel(e))return i}return n[0]}(n?.pickedViewports||e,{x:i,y:r})),o){const c=[i-o.x,r-o.y];void 0!==s&&(c[2]=s),a=o.unproject(c)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:a,devicePixel:n&&"pickedX"in n?[n.pickedX,n.pickedY]:void 0,pixelRatio:t}}function Lge(n){const{pickInfo:e,lastPickedInfo:t,mode:i,layers:r}=n,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,c=o?[o]:[];if("hover"===i){const h=t.layerId,f=o?o.props.id:null;if(f!==h||a!==t.index){if(f!==h){const p=r.find(g=>g.props.id===h);p&&c.unshift(p)}t.layerId=f,t.index=a,t.info=null}}const l=Tj(n),u=new Map;return u.set(null,l),c.forEach(d=>{let h={...l};d===o&&(h.color=s,h.index=a,h.picked=!0),h=xj({layer:d,info:h,mode:i});const f=h.layer;d===o&&"hover"===i&&(t.info=h),u.set(f.id,h),"hover"===i&&f.updateAutoHighlight(h)}),u}function xj({layer:n,info:e,mode:t}){for(;n&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:i}),n=n.parent}return e}class Vge{constructor(e){w(this,"gl",void 0),w(this,"pickingFBO",void 0),w(this,"depthFBO",void 0),w(this,"pickLayersPass",void 0),w(this,"layerFilter",void 0),w(this,"lastPickedInfo",void 0),w(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new Aj(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:i,viewports:r},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,c=o?i.find(h=>h.id===o):null,l=a&&r.find(h=>h.id===a)||r[0],u=l&&l.unproject([e-l.x,t-l.y]);return{...s,x:e,y:t,viewport:l,coordinate:u,layer:c}}_resizeBuffer(){var e,t;const{gl:i}=this;if(!this.pickingFBO&&(this.pickingFBO=new Un(i),Un.isSupported(i,{colorBufferFloat:!0}))){const r=new Un(i);r.attach({36064:new xi(i,{format:et(i)?34836:6408,type:5126})}),this.depthFBO=r}null===(e=this.pickingFBO)||void 0===e||e.resize({width:i.canvas.width,height:i.canvas.height}),null===(t=this.depthFBO)||void 0===t||t.resize({width:i.canvas.width,height:i.canvas.height})}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(i=>i.isPickable()&&!i.isComposite);return t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:i,x:r,y:s,radius:o=0,depth:a=1,mode:c="query",unproject3D:l,onViewportActive:u,effects:d}){const h=this._getPickable(e),f=kd(this.gl);if(!h)return{result:[],emptyInfo:Tj({viewports:i,x:r,y:s,pixelRatio:f})};this._resizeBuffer();const p=ux(this.gl,[r,s],!0),g=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],m=Math.round(o*f),{width:y,height:v}=this.pickingFBO,_=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceWidth:y,deviceHeight:v}),E={x:r-o,y:s-o,width:2*o+1,height:2*o+1};let A;const x=[],I=new Set;for(let S=0;S<a;S++){let F,U;F=_?kge({...this._drawAndSample({layers:h,views:t,viewports:i,onViewportActive:u,deviceRect:_,cullRect:E,effects:d,pass:"picking:".concat(c)}),deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceRect:_}):{pickedColor:null,pickedObjectIndex:-1},F.pickedLayer&&l&&this.depthFBO&&(U=this._drawAndSample({layers:[F.pickedLayer],views:t,viewports:i,onViewportActive:u,deviceRect:{x:F.pickedX,y:F.pickedY,width:1,height:1},cullRect:E,effects:d,pass:"picking:".concat(c,":z")},!0).pickedColors[0]),F.pickedLayer&&S+1<a&&(I.add(F.pickedLayer),F.pickedLayer.disablePickingIndex(F.pickedObjectIndex)),A=Lge({pickInfo:F,lastPickedInfo:this.lastPickedInfo,mode:c,layers:h,viewports:i,x:r,y:s,z:U,pixelRatio:f});for(const V of A.values())V.layer&&x.push(V);if(!F.pickedColor)break}for(const S of I)S.restorePickingColors();return{result:x,emptyInfo:A.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:i,x:r,y:s,width:o=1,height:a=1,mode:c="query",maxObjects:l=null,onViewportActive:u,effects:d}){const h=this._getPickable(e);if(!h)return[];this._resizeBuffer();const f=kd(this.gl),p=ux(this.gl,[r,s],!0),g=p.x,m=p.y+p.height,y=ux(this.gl,[r+o,s+a],!0),_=y.y,x=function Fge({pickedColors:n,decodePickingColor:e}){const t=new Map;if(n)for(let i=0;i<n.length;i+=4)if(n[i+3]-1>=0){const s=n.slice(i,i+4),o=s.join(",");if(!t.has(o)){const a=e(s);a?t.set(o,{...a,color:s}):ot.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(t.values())}(this._drawAndSample({layers:h,views:t,viewports:i,onViewportActive:u,deviceRect:{x:g,y:_,width:y.x+y.width-g,height:m-_},cullRect:{x:r,y:s,width:o,height:a},effects:d,pass:"picking:".concat(c)})),I=new Map,S=Number.isFinite(l);for(let F=0;F<x.length&&!(S&&l&&I.size>=l);F++){const U=x[F];let V={color:U.pickedColor,layer:null,index:U.pickedObjectIndex,picked:!0,x:r,y:s,pixelRatio:f};V=xj({layer:U.pickedLayer,info:V,mode:c}),I.has(V.object)||I.set(V.object,V)}return Array.from(I.values())}_drawAndSample({layers:e,views:t,viewports:i,onViewportActive:r,deviceRect:s,cullRect:o,effects:a,pass:c},l=!1){const u=l?this.depthFBO:this.pickingFBO,{decodePickingColor:d}=this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:t,viewports:i,onViewportActive:r,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:c,pickZ:l}),{x:h,y:f,width:p,height:g}=s,m=new(l?Float32Array:Uint8Array)(p*g*4);return Cv(u,{sourceX:h,sourceY:f,sourceWidth:p,sourceHeight:g,target:m}),{pickedColors:m,decodePickingColor:d}}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const o=Math.max(0,e-i),a=Math.max(0,t-i),c=Math.min(r,e+i+1)-o,l=Math.min(s,t+i+1)-a;return c<=0||l<=0?null:{x:o,y:a,width:c,height:l}}}const Uge={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class jge{constructor(e){w(this,"el",null),w(this,"isVisible",!1);const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,Uge),t.appendChild(this.el))}setTooltip(e,t,i){const r=this.el;if(r){if("string"==typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className),Object.assign(r.style,e.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(i,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}function Sj(n,e){if(!n)throw new Error(e||"loader assertion failed.")}typeof self<"u"&&self,typeof window<"u"&&window,typeof global<"u"&&global,typeof document<"u"&&document;const zge=!("object"==typeof process&&"[object process]"===String(process)&&!process.browser),Mj=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:Gge}=(Mj&&parseFloat(Mj[1]),globalThis),mS=typeof Image<"u",_S=typeof ImageBitmap<"u",yS=!!zge||!!Gge;function Ij(n){const e=function Rj(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&n instanceof Image?"image":n&&"object"==typeof n&&n.data&&n.width&&n.height?"data":null}(n);if(!e)throw new Error("Not an image");return e}const qge=/^data:image\/svg\+xml/,Xge=/\.svg((\?|#).*)?$/;function vS(n){return n&&(qge.test(n)||Xge.test(n))}function Oj(n,e){if(vS(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}function Pj(n,e,t){return bS.apply(this,arguments)}function bS(){return bS=Q(function*(n,e,t){const i=function Yge(n,e){if(vS(e)){let i=(new TextDecoder).decode(n);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(i))}return Oj(n,e)}(n,t),r=self.URL||self.webkitURL,s="string"!=typeof i&&r.createObjectURL(i);try{return yield function Zge(n,e){return wS.apply(this,arguments)}(s||i,e)}finally{s&&r.revokeObjectURL(s)}}),bS.apply(this,arguments)}function wS(){return wS=Q(function*(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(yield t.decode(),t):yield new Promise((i,r)=>{try{t.onload=()=>i(t),t.onerror=s=>r(new Error("Could not load image ".concat(n,": ").concat(s)))}catch(s){r(s)}})}),wS.apply(this,arguments)}const Kge={};let Nj=!0;function ES(){return ES=Q(function*(n,e,t){let i;i=vS(t)?yield Pj(n,e,t):Oj(n,t);const r=e&&e.imagebitmap;return yield function Qge(n){return CS.apply(this,arguments)}(i,r)}),ES.apply(this,arguments)}function CS(){return CS=Q(function*(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if((function eme(n){for(const e in n||Kge)return!1;return!0}(e)||!Nj)&&(e=null),e)try{return yield createImageBitmap(n,e)}catch(t){console.warn(t),Nj=!1}return yield createImageBitmap(n)}),CS.apply(this,arguments)}const vo=!1,$p=!0;function kj(n){const e=qp(n);return function ame(n){const e=qp(n);return e.byteLength>=24&&2303741511===e.getUint32(0,vo)?{mimeType:"image/png",width:e.getUint32(16,vo),height:e.getUint32(20,vo)}:null}(e)||function ume(n){const e=qp(n);if(!(e.byteLength>=3&&65496===e.getUint16(0,vo)&&255===e.getUint8(2)))return null;const{tableMarkers:i,sofMarkers:r}=function dme(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,vo);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,vo),width:e.getUint16(s+7,vo)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,vo)}return null}(e)||function cme(n){const e=qp(n);return e.byteLength>=10&&1195984440===e.getUint32(0,vo)?{mimeType:"image/gif",width:e.getUint16(6,$p),height:e.getUint16(8,$p)}:null}(e)||function lme(n){const e=qp(n);return e.byteLength>=14&&16973===e.getUint16(0,vo)&&e.getUint32(2,$p)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,$p),height:e.getUint32(22,$p)}:null}(e)||function ome(n){const t=function tme(n){return function sme(n,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=function rme(n){return[...n].map(e=>e.charCodeAt(0))}(e);for(let r=0;r<i.length;++r)if(i[r]!==n[r+t])return!1;return!0}(n,"ftyp",4)&&96&n[8]?function nme(n){switch(function ime(n,e,t){return String.fromCharCode(...n.slice(e,t))}(n,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}(n):null}(new Uint8Array(n instanceof DataView?n.buffer:n));return t?{mimeType:t.mimeType,width:0,height:0}:null}(e)}function qp(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}function AS(){return AS=Q(function*(n,e){const{mimeType:t}=kj(n)||{},i=globalThis._parseImageNode;return Sj(i),yield i(n,t)}),AS.apply(this,arguments)}function TS(){return TS=Q(function*(n,e,t){const r=((e=e||{}).image||{}).type||"auto",{url:s}=t||{},o=function pme(n){switch(n){case"auto":case"data":return function $ge(){if(_S)return"imagebitmap";if(mS)return"image";if(yS)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function Wge(n){switch(n){case"auto":return _S||mS||yS;case"imagebitmap":return _S;case"image":return mS;case"data":return yS;default:throw new Error("@loaders.gl/images: image ".concat(n," not supported in this environment"))}}(n),n}}(r);let a;switch(o){case"imagebitmap":a=yield function Jge(n,e,t){return ES.apply(this,arguments)}(n,e,s);break;case"image":a=yield Pj(n,e,s);break;case"data":a=yield function hme(n,e){return AS.apply(this,arguments)}(n,e);break;default:Sj(!1)}return"data"===r&&(a=function Dj(n){switch(Ij(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}(a)),a}),TS.apply(this,arguments)}const Fj={id:"image",module:"images",name:"Images",version:"3.4.15",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:function fme(n,e,t){return TS.apply(this,arguments)},tests:[n=>!!kj(new DataView(n))],options:{image:{type:"auto",decode:!0}}},mme={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function gme(n){const e=n[0],t=n[n.length-1];return"{"===e&&"}"===t||"["===e&&"]"===t},parseTextSync:JSON.parse},Xp="8.8.27",Nv=globalThis.deck&&globalThis.deck.VERSION;if(Nv&&Nv!==Xp)throw new Error("deck.gl - multiple versions detected: ".concat(Nv," vs ").concat(Xp));Nv||(ot.log(1,"deck.gl ".concat(Xp))(),globalThis.deck={...globalThis.deck,VERSION:Xp,version:Xp,log:ot,_registerLoggers:function Hfe(n){Rx=n}},pj([mme,[Fj,{imagebitmap:{premultiplyAlpha:"none"}}]]));const _me=globalThis.deck,kv=globalThis;function Lj(n){if(!n&&!uo())return"Node";if(BV(n))return"Electron";const t=n||(typeof navigator<"u"?navigator:{}).userAgent||"";if(t.indexOf("Edge")>-1)return"Edge";const i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r?"IE":kv.chrome?"Chrome":kv.safari?"Safari":kv.mozInnerScreenX?"Firefox":"Unknown"}class Fv extends ua{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const i=et(e),r=g3(e,"TIMER_QUERY");let s=i||r;for(const o of t)switch(o){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:ne(!1)}return s}constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return Fv.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const Bj=uo()&&typeof document<"u";let Sme=0;class Mme{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{onCreateContext:t=m=>KU(m),onAddHTML:i=null,onInitialize:r=()=>{},onRender:s=()=>{},onFinalize:o=()=>{},onError:a,gl:c=null,glOptions:l={},debug:u=!1,createFramebuffer:d=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:f=!0,stats:p=Sl.get("animation-loop-".concat(Sme++))}=e;let{useDevicePixels:g=!0}=e;"useDevicePixelRatio"in e&&(ue.deprecated("useDevicePixelRatio","useDevicePixels")(),g=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:o,onError:a,gl:c,glOptions:l,debug:u,createFramebuffer:d},this.gl=c,this.needsRedraw=null,this.timeline=null,this.stats=p,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:f,useDevicePixels:g}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return ne("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Fv.isSupported(this.gl,["timers"])?new Fv(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),!1!==i&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}toDataURL(){var e=this;return Q(function*(){return e.setNeedsRedraw("toDataURL"),yield e.waitForRender(),e.gl.canvas.toDataURL()})()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const i=document.getElementById(e);return i?Number(i.value):t}setViewParameters(){return ue.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Bj?new Promise((e,t)=>{Bj&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):function xme(n){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):function Tme(n){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}(e)}_renderFrame(){this.display?this.display._renderFrame(...arguments):this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?hx(this.props.gl,e):this.onCreateContext(e),!wv(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(function wde(n){la(n,lx)})(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const i=this.props.onAddHTML(t);i&&(t.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&t>0&&(i=e/t),{width:e,height:t,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function xde(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n.canvas){const i=function Ede(n){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(n)?n<=0?1:n:n?e:1}(e.useDevicePixels);return void function Rde(n,e,t){let i="width"in t?t.width:n.canvas.clientWidth,r="height"in t?t.height:n.canvas.clientHeight;(!i||!r)&&(ue.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=n.canvas.width||1,r=n.canvas.height||1),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{};const s=n.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let o=e;const a=Math.floor(i*o),c=Math.floor(r*o);n.canvas.width=a,n.canvas.height=c,(n.drawingBufferWidth!==a||n.drawingBufferHeight!==c)&&(ue.warn("Device pixel ratio clamped")(),o=Math.min(n.drawingBufferWidth/i,n.drawingBufferHeight/r),n.canvas.width=Math.floor(i*o),n.canvas.height=Math.floor(r*o)),Object.assign(n.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}(n,i,e)}const t=n.getExtension("STACKGL_resize_drawingbuffer");t&&"width"in e&&"height"in e&&t.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Un(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var Lv=at(511);const Ime={mousedown:1,mousemove:2,mouseup:4};(function Rme(n){const e=n.prototype.handler;n.prototype.handler=function(i){const r=this.store;i.button>0&&"pointerdown"===i.type&&(function Dme(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return!0;return!1}(r,s=>s.pointerId===i.pointerId)||r.push(i)),e.call(this,i)}})(Lv.PointerEventInput),function Ome(n){n.prototype.handler=function(t){let i=Ime[t.type];1&i&&t.button>=0&&(this.pressed=!0),2&i&&0===t.buttons&&(i=4),this.pressed&&(4&i&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}(Lv.MouseInput);const Pme=Lv.Manager,bo=Lv;class Bv{constructor(e,t,i){this.element=e,this.callback=t,this.options={enable:!0,...i}}}const Nme=bo?[[bo.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[bo.Rotate,{enable:!1}],[bo.Pinch,{enable:!1}],[bo.Swipe,{enable:!1}],[bo.Pan,{threshold:0,enable:!1}],[bo.Press,{enable:!1}],[bo.Tap,{event:"doubletap",taps:2,enable:!1}],[bo.Tap,{event:"anytap",enable:!1}],[bo.Tap,{enable:!1}]]:null,jj={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},kme={doubletap:["tap"]},Fme={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},SS={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Lme={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},Hj={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Bme=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Wd=typeof window<"u"?window:global;typeof global<"u"?global:window,typeof document<"u"&&document;let MS=!1;try{Wd.addEventListener("test",null,{get passive(){return MS=!0,!0}}),Wd.removeEventListener("test",null)}catch{MS=!1}const Vme=-1!==Bme.indexOf("firefox"),{WHEEL_EVENTS:Ume}=SS,Gj=4.000244140625;class zme extends Bv{constructor(e,t,i){super(e,t,i),this.handleEvent=r=>{if(!this.options.enable)return;let s=r.deltaY;Wd.WheelEvent&&(Vme&&r.deltaMode===Wd.WheelEvent.DOM_DELTA_PIXEL&&(s/=Wd.devicePixelRatio),r.deltaMode===Wd.WheelEvent.DOM_DELTA_LINE&&(s*=40)),0!==s&&s%Gj==0&&(s=Math.floor(s/Gj)),r.shiftKey&&s&&(s*=.25),this.callback({type:"wheel",center:{x:r.clientX,y:r.clientY},delta:-s,srcEvent:r,pointerType:"mouse",target:r.target})},this.events=(this.options.events||[]).concat(Ume),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,!!MS&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}}const{MOUSE_EVENTS:Gme}=SS,Wj="pointermove",$j="pointerover",qj="pointerout",Xj="pointerenter",Yj="pointerleave";class Wme extends Bv{constructor(e,t,i){super(e,t,i),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,this.events=(this.options.events||[]).concat(Gme),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===Wj&&(this.enableMoveEvent=t),e===$j&&(this.enableOverEvent=t),e===qj&&(this.enableOutEvent=t),e===Xj&&(this.enableEnterEvent=t),e===Yj&&(this.enableLeaveEvent=t)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this._emit($j,e)}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this._emit(qj,e)}handleEnterEvent(e){this.enableEnterEvent&&"mouseenter"===e.type&&this._emit(Xj,e)}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this._emit(Yj,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.buttons&&(this.pressed=!1),this.pressed||this._emit(Wj,e);break;case"mouseup":this.pressed=!1}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const{KEY_EVENTS:$me}=SS,Zj="keydown";class qme extends Bv{constructor(e,t,i){super(e,t,i),this.handleEvent=r=>{const s=r.target||r.srcElement;"INPUT"===s.tagName&&"text"===s.type||"TEXTAREA"===s.tagName||(this.enableDownEvent&&"keydown"===r.type&&this.callback({type:Zj,srcEvent:r,key:r.key,target:r.target}),this.enableUpEvent&&"keyup"===r.type&&this.callback({type:"keyup",srcEvent:r,key:r.key,target:r.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat($me),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===Zj&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}}const Jj="contextmenu";class Xme extends Bv{constructor(e,t,i){super(e,t,i),this.handleEvent=r=>{this.options.enable&&this.callback({type:Jj,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===Jj&&(this.options.enable=t)}}const Yme={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};function n_e(n){const e=Yme[n.srcEvent.type];if(!e)return null;const{buttons:t,button:i}=n.srcEvent;let r=!1,s=!1,o=!1;return 2===e?(r=!!(1&t),s=!!(4&t),o=!!(2&t)):(r=0===i,s=1===i,o=2===i),{leftButton:r,middleButton:s,rightButton:o}}function i_e(n,e){const t=n.center;if(!t)return null;const i=e.getBoundingClientRect();return{center:t,offsetCenter:{x:(t.x-i.left-e.clientLeft)/(i.width/e.offsetWidth||1),y:(t.y-i.top-e.clientTop)/(i.height/e.offsetHeight||1)}}}const DS={srcElement:"root",priority:0};class r_e{constructor(e){this.handleEvent=t=>{if(this.isEmpty())return;const i=this._normalizeEvent(t);let r=t.srcEvent.target;for(;r&&r!==i.rootElement;){if(this._emit(i,r),i.handled)return;r=r.parentNode}this._emit(i,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,i,r=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let c=DS;"string"==typeof i||i&&i.addEventListener?c={...DS,srcElement:i}:i&&(c={...DS,...i});let l=a.get(c.srcElement);l||(l=[],a.set(c.srcElement,l));const u={type:e,handler:t,srcElement:c.srcElement,priority:c.priority};r&&(u.once=!0),s&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let d=l.length-1;for(;d>=0&&!(l[d].priority>=u.priority);)d--;l.splice(d+1,0,u)}remove(e,t){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.type===e&&o.handler===t){i.splice(s,1);const a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}this._active=i.some(s=>!s.passive)}_emit(e,t){const i=this.handlersByElement.get(t);if(i){let r=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,r=!0},a=[];for(let c=0;c<i.length;c++){const{type:l,handler:u,once:d}=i[c];if(u({...e,type:l,stopPropagation:s,stopImmediatePropagation:o}),d&&a.push(i[c]),r)break}for(let c=0;c<a.length;c++){const{type:l,handler:u}=a[c];this.remove(l,u)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return{...e,...n_e(e),...i_e(e,t),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t}}}const s_e={events:null,recognizers:null,recognizerOptions:{},Manager:Pme,touchAction:"none",tabIndex:0};class o_e{constructor(e=null,t){this._onBasicInput=r=>{const{srcEvent:s}=r,o=Fme[s.type];o&&this.manager.emit(o,r)},this._onOtherEvent=r=>{this.manager.emit(r.type,r)},this.options={...s_e,...t},this.events=new Map,this.setElement(e);const{events:i}=this.options;i&&this.on(i)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this;this.manager=new(0,t.Manager)(e,{touchAction:t.touchAction,recognizers:t.recognizers||Nme}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(jj).forEach(r=>{const s=this.manager.get(r);s&&jj[r].forEach(o=>{s.recognizeWith(o)})});for(const r in t.recognizerOptions){const s=this.manager.get(r);if(s){const o=t.recognizerOptions[r];delete o.enable,s.set(o)}}this.wheelInput=new zme(e,this._onOtherEvent,{enable:!1}),this.moveInput=new Wme(e,this._onOtherEvent,{enable:!1}),this.keyInput=new qme(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new Xme(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,i){this._addEventHandler(e,t,i,!1)}once(e,t,i){this._addEventHandler(e,t,i,!0)}watch(e,t,i){this._addEventHandler(e,t,i,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const s=kme[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=i.get(o);t?(a.requireFailure(e),r.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,i,r,s){if("string"!=typeof e){i=t;for(const u in e)this._addEventHandler(u,e[u],i,r,s);return}const{manager:o,events:a}=this,c=Hj[e]||e;let l=a.get(c);l||(l=new r_e(this),a.set(c,l),l.recognizerName=Lme[c]||c,o&&o.on(c,l.handleEvent)),l.add(e,t,i,r,s),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:i}=this,s=i.get(Hj[e]||e);if(s&&(s.remove(e,t),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const c of i.values())if(c.recognizerName===o&&!c.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function Rl(){}const tH={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Rl,onResize:Rl,onViewStateChange:Rl,onInteractionStateChange:Rl,onBeforeRender:Rl,onAfterRender:Rl,onLoad:Rl,onError:n=>ot.error(n.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:({isDragging:n})=>n?"grabbing":"grab",getTooltip:null,debug:!1,drawPickingColors:!1};class RS{constructor(e){w(this,"props",void 0),w(this,"width",0),w(this,"height",0),w(this,"userData",{}),w(this,"canvas",null),w(this,"viewManager",null),w(this,"layerManager",null),w(this,"effectManager",null),w(this,"deckRenderer",null),w(this,"deckPicker",null),w(this,"eventManager",null),w(this,"tooltip",null),w(this,"metrics",void 0),w(this,"animationLoop",void 0),w(this,"stats",void 0),w(this,"viewState",void 0),w(this,"cursorState",void 0),w(this,"_needsRedraw",void 0),w(this,"_pickRequest",void 0),w(this,"_lastPointerDownInfo",null),w(this,"_metricsCounter",void 0),w(this,"_onPointerMove",t=>{const{_pickRequest:i}=this;if("pointerleave"===t.type)i.x=-1,i.y=-1,i.radius=0;else{if(t.leftButton||t.rightButton)return;{const r=t.offsetCenter;if(!r)return;i.x=r.x,i.y=r.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=t}),w(this,"_onEvent",t=>{const i=vU[t.type],r=t.offsetCenter;if(!i||!r||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:r.x,y:r.y,layers:s,viewports:this.getViewports(r)},this._lastPointerDownInfo),{layer:a}=o,c=a&&(a[i.handler]||a.props[i.handler]),l=this.props[i.handler];let u=!1;c&&(u=c.call(a,o,t)),!u&&l&&l(o,t)}),w(this,"_onPointerDown",t=>{const i=t.offsetCenter,r=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=r.result[0]||r.emptyInfo}),this.props={...tH,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&ot.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===Lj()&&ot.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new fx({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&xp.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,t,i,r,s,o,a,c;this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(e=this.layerManager)||void 0===e||e.finalize(),this.layerManager=null,null===(t=this.viewManager)||void 0===t||t.finalize(),this.viewManager=null,null===(i=this.effectManager)||void 0===i||i.finalize(),this.effectManager=null,null===(r=this.deckRenderer)||void 0===r||r.finalize(),this.deckRenderer=null,null===(s=this.deckPicker)||void 0===s||s.finalize(),this.deckPicker=null,null===(o=this.eventManager)||void 0===o||o.destroy(),this.eventManager=null,null===(a=this.tooltip)||void 0===a||a.remove(),this.tooltip=null,this.props.canvas||this.props.gl||!this.canvas||(null===(c=this.canvas.parentElement)||void 0===c||c.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&ot.removed("onLayerHover","onHover")(),"onLayerClick"in e&&ot.removed("onLayerClick","onClick")(),e.initialViewState&&!Od(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||i||r||s||o,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return null!==this.viewManager}getViews(){return Ti(this.viewManager),this.viewManager.views}getViewports(e){return Ti(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_pick(e,t,i){Ti(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...i});return r.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;return"string"==typeof t&&(t=document.getElementById(t),Ti(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:i}=e;if(t||0===t){const s=Number.isFinite(t)?"".concat(t,"px"):t;this.canvas.style.width=s}if(i||0===i){var r;const s=Number.isFinite(i)?"".concat(i,"px"):i;this.canvas.style.position=(null===(r=e.style)||void 0===r?void 0:r.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const t=e.clientWidth||e.width,i=e.clientHeight||e.height;var r;t===this.width&&i===this.height||(this.width=t,this.height=i,null===(r=this.viewManager)||void 0===r||r.setProps({width:t,height:i}),this.props.onResize({width:t,height:i}))}_createAnimationLoop(e){const{width:t,height:i,gl:r,glOptions:s,debug:o,onError:a,onBeforeRender:c,onAfterRender:l,useDevicePixels:u}=e;return new Mme({width:t,height:i,useDevicePixels:u,autoResizeViewport:!1,gl:r,onCreateContext:d=>KU({...s,...d,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:d=>this._setGLContext(d.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:c,onAfterRender:l,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Ej({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:i,emptyInfo:r}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=i.length>0;let s=r,o=!1;for(const a of i){var t;s=a,o=(null===(t=a.layer)||void 0===t?void 0:t.onHover(a,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,hx(e,{enable:!0,copyState:!0})),this.tooltip=new jge(this.canvas),la(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new j3;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new o_e(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in vU)this.eventManager.on(r,this._onEvent);this.viewManager=new gge({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new pge(e,{deck:this,stats:this.stats,viewport:i,timeline:t}),this.effectManager=new Mge,this.deckRenderer=new Pge(e),this.deckPicker=new Vge(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:i}=this.layerManager.context;la(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects(),...t}),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),ot.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:t},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const i=Sl.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}function fa(n={}){const{connector:e=()=>new fe,resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,c,l=0,u=!1,d=!1;const h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=c=void 0,u=d=!1},p=()=>{const g=o;f(),g?.unsubscribe()};return Ft((g,m)=>{l++,!d&&!u&&h();const y=c=c??e();m.add(()=>{l--,0===l&&!d&&!u&&(a=OS(p,r))}),y.subscribe(m),!o&&l>0&&(o=new jo({next:v=>y.next(v),error:v=>{d=!0,h(),a=OS(f,t,v),y.error(v)},complete:()=>{u=!0,h(),a=OS(f,i),y.complete()}}),li(g).subscribe(o))})(s)}}function OS(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new jo({next:()=>{i.unsubscribe(),n()}});return li(e(...t)).subscribe(i)}w(RS,"defaultProps",tH),w(RS,"VERSION",_me.VERSION);class PS{constructor(e,t){w(this,"opts",void 0),w(this,"source",void 0),this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:i}=this.source,{size:r}=t;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const o=t.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[o+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function Vv(n){return n.stride||n.size*n.bytesPerElement}function nH(n,e){e.offset&&ot.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=Vv(n),s=(void 0!==e.vertexOffset?e.vertexOffset:n.vertexOffset||0)*t+(e.elementOffset||0)*n.bytesPerElement+(n.offset||0);return{...e,offset:s,stride:t}}class l_e{constructor(e,t,i){w(this,"gl",void 0),w(this,"id",void 0),w(this,"size",void 0),w(this,"settings",void 0),w(this,"value",void 0),w(this,"doublePrecision",void 0),w(this,"_buffer",void 0),w(this,"state",void 0),this.gl=e,this.id=t.id||"",this.size=t.size||1;const r=t.logicalType||t.type,s=5130===r;let a,{defaultValue:o}=t;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0),a=s?5126:!r&&t.isIndexed?e&&Cx(e,"ELEMENT_INDEX_UINT32")?5125:5123:r||5126;let c=function a_e(n){switch(n){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(r||a||5126);this.doublePrecision=s,s&&!1===t.fp64&&(c=Float32Array),this.value=null,this.settings={...t,defaultType:c,defaultValue:o,logicalType:r,type:a,size:this.size,bytesPerElement:c.BYTES_PER_ELEMENT},this.state={...i,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new Ut(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Vv(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),xp.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=function c_e(n,e){const t=nH(n,e);return{high:t,low:{...t,offset:t.offset+4*n.size}}}(this.getAccessor(),t||{});return i[e]=new PS(this,s.high),i["".concat(e,"64Low")]=r?new PS(this,s.low):new Float32Array(this.size),i}if(t){const i=nH(this.getAccessor(),t);return{[e]:new PS(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:i,size:r}=this,s=i*r;if(t&&s&&t.length>=s){const o=new Array(r).fill(1/0),a=new Array(r).fill(-1/0);for(let c=0;c<s;)for(let l=0;l<r;l++){const u=t[c++];u<o[l]&&(o[l]=u),u>a[l]&&(a[l]=u)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let i;i=ArrayBuffer.isView(e)?{value:e}:e instanceof Ut?{buffer:e}:e;const r={...this.settings,...i};if(t.bufferAccessor=r,t.bounds=null,i.constant){let s=i.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),t.constant&&this._areValuesEqual(s,this.value))return!1;t.externalBuffer=null,t.constant=!0,this.value=s}else if(i.buffer){const s=i.buffer;t.externalBuffer=s,t.constant=!1,this.value=i.value||null;const o=i.value instanceof Float64Array;r.type=i.type||s.accessor.type,r.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(o?2:1),r.stride=Vv(r)}else if(i.value){this._checkExternalBuffer(i);let s=i.value;t.externalBuffer=null,t.constant=!1,this.value=s,r.bytesPerElement=s.BYTES_PER_ELEMENT,r.stride=Vv(r);const{buffer:o,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=kT(s,r));const c=s.byteLength+a+2*r.stride;o.byteLength<c&&o.reallocate(c),o.setAccessor(null),o.subData({data:s,offset:a}),r.type=i.type||o.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const t=this.value,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?kT(t,{size:this.size,startIndex:i,endIndex:r}):t.subarray(i,r),offset:i*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,t=!1){const{state:i}=this,r=i.allocatedValue,s=xp.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),t&&r&&o.subData({data:r instanceof Float64Array?kT(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const i=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));!(t instanceof i)&&this.settings.normalized&&!("normalized"in e)&&ot.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(e).map(t=>t/255);case 5123:return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return t[i]=e,t;if(!e)return t[i]=r[0],t;switch(s){case 4:t[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let o=s;for(;--o>=0;)t[i+o]=Number.isFinite(e[o])?e[o]:r[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}}const iH=[],rH=[];function Uv(n,e=0,t=1/0){let i=iH;const r={index:-1,data:n,target:[]};return n?"function"==typeof n[Symbol.iterator]?i=n:n.length>0&&(rH.length=n.length,i=rH):i=iH,(e>0||Number.isFinite(t))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,t),r.index=e-1),{iterable:i,objectInfo:r}}function sH(n){return n&&n[Symbol.asyncIterator]}const d_e=[],jv=[[0,1/0]];function NS(n){const{source:e,target:t,start:i=0,size:r,getData:s}=n,a=e.length,c=(n.end||t.length)-i;if(a>c)return void t.set(e.subarray(0,c),i);if(t.set(e,i),!s)return;let l=a;for(;l<c;){const u=s(l,e);for(let d=0;d<r;d++)t[i+l]=u[d]||0,l++}}const p_e={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function oH(n,e){if(!n)return null;Number.isFinite(n)&&(n={type:"interpolation",duration:n});const t=n.type||"interpolation";return{...p_e[t],...e,...n,type:t}}function aH(n,e){const t=e.getBuffer();return t?[t,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function cH(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(n,'"'))}}function lH(n){n.push(n.shift())}function kS(n,e){const{doublePrecision:t,settings:i,value:r,size:s}=n,o=t&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*o}function uH({buffer:n,numInstances:e,attribute:t,fromLength:i,fromStartIndices:r,getData:s=o=>o}){const o=t.doublePrecision&&t.value instanceof Float64Array?2:1,a=t.size*o,c=t.byteOffset,l=t.startIndices,u=r&&l,d=kS(t,e),h=t.isConstant;if(!u&&i>=d)return;const f=h?t.value:t.getBuffer().getData({srcByteOffset:c});if(t.settings.normalized&&!h){const y=s;s=(v,_)=>t.normalizeConstant(y(v,_))}const p=h?(y,v)=>s(f,v):(y,v)=>s(f.subarray(y,y+a),v),g=n.getData({length:i}),m=new Float32Array(d);(function f_e({source:n,target:e,size:t,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return NS({source:n,target:e,size:t,getData:i}),e;let o=0,a=0;const c=i&&((u,d)=>i(u+a,d)),l=Math.min(r.length,s.length);for(let u=1;u<l;u++){const d=r[u]*t,h=s[u]*t;NS({source:n.subarray(o,d),target:e,start:a,end:h,size:t,getData:c}),o=d,a=h}a<e.length&&NS({source:[],target:e,start:a,size:t,getData:c})})({source:g,target:m,sourceStartIndices:r,targetStartIndices:l,size:a,getData:p}),n.byteLength<m.byteLength+c&&n.reallocate(m.byteLength+c),n.subData({data:m,offset:c})}class FS extends l_e{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:jv}),w(this,"constant",!1),this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,i=this.settings.transition;return oH(Array.isArray(t)?e[t.find(s=>e[s])]:e[t],i)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:i=0,endRow:r=1/0}=t;this.state.updateRanges=function h_e(n,e){if(n===jv||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],i=n.length;let r=0;for(let s=0;s<i;s++){const o=n[s];o[1]<e[0]?(t.push(o),r=s+1):o[0]>e[1]?t.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return t.splice(r,0,e),t}(this.state.updateRanges,[i,r])}else this.state.updateRanges=jv}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=d_e}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:i}=this;return!i.noAlloc&&!!i.update&&(super.allocate(e,t.updateRanges!==jv),!0)}updateBuffer({numInstances:e,data:t,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let c=!0;if(o){for(const[l,u]of s)o.call(r,this,{data:t,startRow:l,endRow:u,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[l,u]of s){const d=Number.isFinite(l)?this.getVertexOffset(l):0,h=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:d,endOffset:h})}this._checkAttributeArray()}else c=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),c}setConstantValue(e){return void 0!==e&&"function"!=typeof e&&(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:i,settings:r}=this;if(!e)return i.binaryValue=null,i.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(i.binaryValue===e)return this.clearNeedsUpdate(),!0;if(i.binaryValue=e,this.setNeedsRedraw(),r.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;return Ti(ArrayBuffer.isView(o.value),"invalid ".concat(r.accessor)),i.binaryAccessor=function u_e(n,e){const{size:t,stride:i,offset:r,startIndices:s,nested:o}=e,a=n.BYTES_PER_ELEMENT,c=i?i/a:t,l=r?r/a:0,u=Math.floor((n.length-l)/c);return(d,{index:h,target:f})=>{if(!s){const y=h*c+l;for(let v=0;v<t;v++)f[v]=n[y+v];return f}const p=s[h],g=s[h+1]||u;let m;if(o){m=new Array(g-p);for(let y=p;y<g;y++){const v=y*c+l;f=new Array(t);for(let _=0;_<t;_++)f[_]=n[v+_];m[y-p]=f}}else if(c===t)m=n.subarray(p*t+l,g*t+l);else{m=new n.constructor((g-p)*t);let y=0;for(let v=p;v<g;v++){const _=v*c+l;for(let E=0;E<t;E++)m[y++]=n[_+E]}}return m}}(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:t,nested:!!o.size&&o.size!==this.size}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const i in e)Object.assign(t,super.getShaderAttributes(i,e[i]));return t}_autoUpdater(e,{data:t,startRow:i,endRow:r,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:c,value:l,size:u,startIndices:d}=e,{accessor:h,transform:f}=a,p=c.binaryAccessor||("function"==typeof h?h:s[h]);Ti("function"==typeof p,'accessor "'.concat(h,'" is not a function'));let g=e.getVertexOffset(i);const{iterable:m,objectInfo:y}=Uv(t,i,r);for(const v of m){y.index++;let _=p(v,y);if(f&&(_=f.call(this,_)),d){const E=(y.index<d.length-1?d[y.index+1]:o)-d[y.index];if(_&&Array.isArray(_[0])){let A=g;for(const x of _)e._normalizeValue(x,l,A),A+=u}else _&&_.length>u?l.set(_,g):(e._normalizeValue(_,y.target,0),zfe({target:l,source:y.target,start:g,count:E}));g+=E*u}else e._normalizeValue(_,l,g),g+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!e.noAlloc&&"function"!=typeof e.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let i=!0;switch(t){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}const dH="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",m_e="#version 300 es\n".concat(dH);function hH(n,e){e=Array.isArray(e)?e:[e];const t=n.replace(/^\s+/,"").split(/\s+/),[i,r,s]=t;return e.includes(i)&&r&&s?{qualifier:i,type:r,name:s.split(";")[0]}:null}function fH(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{version:e=100,input:t,inputType:i,output:r}=n;if(!t)return 300===e?m_e:e>300?"#version ".concat(e,"\n").concat(dH):"void main() {gl_FragColor = vec4(0);}";const s=function v_e(n,e){switch(e){case"float":return"vec4(".concat(n,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(n,", 0.0, 1.0)");case"vec3":return"vec4(".concat(n,", 1.0)");case"vec4":return n;default:return Ur(!1),null}}(t,i);return e>=300?"#version ".concat(e," ").concat(300===e?"es":"","\nin ").concat(i," ").concat(t,";\nout vec4 ").concat(r,";\nvoid main() {\n  ").concat(r," = ").concat(s,";\n}"):"varying ".concat(i," ").concat(t,";\nvoid main() {\n  gl_FragColor = ").concat(s,";\n}")}class pH extends ua{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return et(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ui(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Fd(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:o}=this._getBufferParams(t);return i<0?(this.unused[e]=r,ue.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[i]=t,this.bindOnUse||this._bindBuffer(i,r,o,s),this)}begin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,i,r;return e instanceof Ut?r=e:(r=e.buffer,i=e.byteSize,t=e.byteOffset),(void 0!==t||void 0!==i)&&(t=t||0,i=i||r.byteLength-t),{buffer:r,byteOffset:t,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t){let r=arguments.length>3?arguments[3]:void 0;const s=t&&t.handle;return s&&void 0!==r?this.gl.bindBufferRange(35982,e,s,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r):this.gl.bindBufferBase(35982,e,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class b_e{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=t;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(){this._setupBuffers(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],i=e?t[e]:null;return i?i instanceof Ut?i:i.buffer:null}getData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyingName:t}=e,i=this.getBuffer(t);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&ne(et(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap)r in t&&(i[this.feedbackMap[r]]=r);Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if("string"==typeof s){const o=t[s],{byteLength:a,usage:c,accessor:l}=o;i[r]=this._createNewBuffer(r,{byteLength:a,usage:c,accessor:l})}}return i}_setupBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:i})}_setupTransformFeedback(e,t){let{model:i}=t;const{program:r}=i;e.transformFeedback=new pH(this.gl,{program:r,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:t,feedbackBuffers:i})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];t[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],ne(i[s]instanceof Ut)}return{sourceBuffers:t,feedbackBuffers:i}}_createNewBuffer(e,t){const i=new Ut(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}function gH(n){let e=100;const t=n.match(/[^\s]+/g);if(t.length>=2&&"#version"===t[0]){const i=parseInt(t[1],10);Number.isFinite(i)&&(e=i)}return e}const w_e={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},Hv="transform_uSize_",mH="transform_position";const I_e={10241:9728,10240:9728,10242:33071,10243:33071};class R_e{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},t,e.attributes),a=Object.assign({},e.uniforms),c=Object.assign({},e.parameters);let l=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const d in this.samplerTextureMap)a[d]=i[this.samplerTextureMap[d]];this._setSourceTextureParameters();const u=function A_e(n){let{sourceTextureMap:e,targetTextureVarying:t,targetTexture:i}=n;const r={};let s,o;t&&(({width:s,height:o}=i),r["".concat(Hv).concat(t)]=[s,o]);for(const a in e)({width:s,height:o}=e[a]),r["".concat(Hv).concat(a)]=[s,o];return r}({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,u)}return this.hasTargetTexture&&(l=!1,c.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:a,discard:l,parameters:c}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(){this._setupTextures(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{framebuffer:t}=this.bindings[this.currentIndex],i=Cv(t);if(!e)return i;const r=i.constructor,s=function y_e(n){switch(n){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Ur(!1),null}}(this.targetTextureType),o=new r(i.length*s/4);let a=0;for(let c=0;c<i.length;c+=4)for(let l=0;l<s;l++)o[a++]=i[c+l];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{_targetTextureVarying:t,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:i}=e;if(i instanceof xi)return i;const r=t[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!=typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new Ut(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:t,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:t,targetTexture:i})}}_updateBinding(e,t){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:c}=e;c?(c.update({attachments:{36064:s},resizeAttachments:!1}),c.resize({width:o,height:a})):e.framebuffer=new Un(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const i in t)t[i].setParameters(I_e)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);return t[this._swapTexture]=e.targetTexture,{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=function Qde(n,e){ne(n instanceof xi||n instanceof Kde||n instanceof Jde);const t=n.constructor,{gl:i,width:r,height:s,format:o,type:a,dataFormat:c,border:l,mipmaps:u}=n;return new t(i,Object.assign({width:r,height:s,format:o,type:a,dataFormat:c,border:l,mipmaps:u},e))}(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceTextures:t,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:c}=function C_e(n){let{vs:e,sourceTextureMap:t,targetTextureVarying:i,targetTexture:r}=n,o=Object.keys(t).length,a=null;const c={};let l=e,u={};if(o>0||i){const d=l.split("\n"),h=d.slice();if(d.forEach((f,p,g)=>{if(o>0){const m=function M_e(n,e){const t={},i=function T_e(n){return hH(n,["attribute","in"])}(n);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const o="// ".concat(n," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:c,uniformDeclerations:l}=function x_e(n){const e="".concat("transform_uSampler_").concat(n),t="".concat(Hv).concat(n);return{samplerName:e,sizeName:t,uniformDeclerations:"  uniform sampler2D ".concat(e,";\n  uniform vec2 ").concat(t,";")}}(s),u=function __e(n){switch(n){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Ur(!1),null}}(r),d="  ".concat(r," ").concat(s," = transform_getInput(").concat(a,", ").concat(c,").").concat(u,";\n");return t[a]=s,{updatedLine:o,inject:{"vs:#decl":l,"vs:#main-start":d},samplerTextureMap:t}}return null}(f,t);if(m){const{updatedLine:y,inject:v}=m;h[p]=y,u=sx([u,v]),Object.assign(c,m.samplerTextureMap),o--}}i&&!a&&(a=function S_e(n,e){const t=hH(n,["varying","out"]);return t&&t.name===e?t.type:null}(f,i))}),i){ne(r);const f="".concat(Hv).concat(i),p="uniform vec2 ".concat(f,";\n"),g="     vec2 ".concat(mH," = transform_getPos(").concat(f,");\n     gl_Position = vec4(").concat(mH,", 0, 1.);\n");u=sx([u,{"vs:#decl":p,"vs:#main-start":g}])}l=h.join("\n")}return{vs:l,targetTextureType:a,inject:u,samplerTextureMap:c}}({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),l=sx([e.inject||{},a]);return this.targetTextureType=o,this.samplerTextureMap=c,{vs:r,fs:e._fs||fH({version:gH(r),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[w_e].concat(e.modules||[]):e.modules,uniforms:s,inject:l}}}let zv=null;class zr extends ua{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero||et(e)||"Chrome"===Lj()}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new zr(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return zr.MAX_ATTRIBUTES=zr.MAX_ATTRIBUTES||e.getParameter(34921),zr.MAX_ATTRIBUTES}static setConstant(e,t,i){switch(i.constructor){case Float32Array:zr._setConstantFloatArray(e,t,i);break;case Int32Array:zr._setConstantIntArray(e,t,i);break;case Uint32Array:zr._setConstantUintArray(e,t,i);break;default:ne(!1)}}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,Object.assign({},t,{id:t.id||t.program&&t.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return zr.getMaxAttributes(this.gl)}initialize(){return this.setProps(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return ne(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,t,i){if(34963===t.target)return this.setElementBuffer(t,i);const{size:r,type:s,stride:o,offset:a,normalized:c,integer:l,divisor:u}=i,{gl:d,gl2:h}=this;return e=Number(e),this.bind(()=>{d.bindBuffer(34962,t.handle),l?(ne(et(d)),h.vertexAttribIPointer(e,r,s,o,a)):d.vertexAttribPointer(e,r,s,c,o,a),d.enableVertexAttribArray(e),h.vertexAttribDivisor(e,u||0)}),this}enable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!t&&0===e&&!zr.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t){const i=this._normalizeConstantArrayValue(t),r=i.byteLength*e,s=i.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new Ut(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(i,this.bufferValue),o){const a=function P_e(n,e){const t=function O_e(n){return(!zv||zv.byteLength<n)&&(zv=new ArrayBuffer(n)),zv}(n.BYTES_PER_ELEMENT*e);return new n(t,0,e)}(t.constructor,s);(function N_e(n){let{target:e,source:t,start:i=0,count:r=1}=n;const s=t.length,o=r*s;let a=0;for(let c=i;a<s;a++)e[c++]=t[a];for(;a<o;)a<o-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+o-a),a=o)})({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}static _setConstantFloatArray(e,t,i){switch(i.length){case 1:e.vertexAttrib1fv(t,i);break;case 2:e.vertexAttrib2fv(t,i);break;case 3:e.vertexAttrib3fv(t,i);break;case 4:e.vertexAttrib4fv(t,i);break;default:ne(!1)}}static _setConstantIntArray(e,t,i){switch(ne(et(e)),i.length){case 1:e.vertexAttribI1iv(t,i);break;case 2:e.vertexAttribI2iv(t,i);break;case 3:e.vertexAttribI3iv(t,i);break;case 4:e.vertexAttribI4iv(t,i);break;default:ne(!1)}}static _setConstantUintArray(e,t,i){switch(ne(et(e)),i.length){case 1:e.vertexAttribI1uiv(t,i);break;case 2:e.vertexAttribI2uiv(t,i);break;case 3:e.vertexAttribI3uiv(t,i);break;case 4:e.vertexAttribI4uiv(t,i);break;default:ne(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,t){let{location:i}=t;return ne(Number.isFinite(i)),this.bind(()=>34373===e?this.gl.getVertexAttribOffset(i,e):this.gl.getVertexAttrib(i,e))}}const L_e=/^(.+)__LOCATION_([0-9]+)$/,B_e=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class V_e{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.id=t.id||t.program&&t.program.id,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new zr(e),t3(this,"VertexArray","v6.0",B_e),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const t in e)this._setAttribute(t,e[t]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===t.target)return this.setElementBuffer(t,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,t.accessor,i);return r>=0&&(this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,t,s)),this}setConstant(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},i));return r>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new Ut(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof Ut&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof Ut&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),r=i()}),r}_resolveLocationAndAccessor(e,t,i,r){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=t,ue.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const c=this._getAttributeInfo(a||o);if(!c)return s;const u=Cr.resolve(c.accessor,this.accessors[o]||{},i,r),{size:d,type:h}=u;return ne(Number.isFinite(d)&&Number.isFinite(h)),{location:o,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const i=L_e.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,t){if(t instanceof Ut)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof Ut)this.setBuffer(e,t[0],t[1]);else if(ArrayBuffer.isView(t)||Array.isArray(t))this.setConstant(e,t);else{if(!(t.buffer instanceof Ut))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(e,t.buffer,t)}}_setConstantAttributes(e,t){const i=Math.max(0|e,0|t);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,t){if(zr.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const i=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,t){zr.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const i=this.values[t],r=this.accessors[t];if(!i)return;const{divisor:s}=r,o=s>0;if(e.isInstanced=e.isInstanced||o,i instanceof Ut){const a=i;if(o){const c=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,c)}else{const c=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,c)}}}setElements(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ue.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function Yp(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{isInteger:i=!1}=e;if(Array.isArray(n)||ArrayBuffer.isView(n))return function U_e(n,e){const{maxElts:t=16,size:i=1}=e;let r="[";for(let o=0;o<n.length&&o<t;++o)o>0&&(r+=",".concat(o%i==0?" ":"")),r+=Yp(n[o],e);const s=n.length>t?"...":"]";return"".concat(r).concat(s)}(n,e);if(!Number.isFinite(n))return String(n);if(Math.abs(n)<1e-16)return i?"0":"0.";if(i||Math.abs(n)>100&&Math.abs(n)<1e4)return n.toFixed(0);const r=n.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function _H(n,e,t,i){const{gl:r}=n;if(!e)return{[i]:"null","Format ":"N/A"};let l,u,d,s="NOT PROVIDED",o=1,a=0,c=0;if(t&&(s=t.type,o=t.size,s=String(s).replace("Array",""),l=-1!==s.indexOf("nt")),e instanceof Ut){const h=e,{data:f,changed:p}=h.getDebugData();let g;return u=p?"*":"",d=f,c=h.byteLength,a=c/f.BYTES_PER_ELEMENT/o,t?g="".concat(t.divisor>0?"I ":"P "," ").concat(a," (x").concat(o,"=").concat(c," bytes ").concat(dc(r,s),")"):(l=!0,g="".concat(c," bytes")),{[i]:"".concat(u).concat(Yp(d,{size:o,isInteger:l})),"Format ":g}}return d=e,o=e.length,s=String(e.constructor.name).replace("Array",""),l=-1!==s.indexOf("nt"),{[i]:"".concat(Yp(d,{size:o,isInteger:l})," (constant)"),"Format ":"".concat(o,"x").concat(s," (constant)")}}function H_e(n,e){const{type:t,size:i}=e,r=I3(t,i);return r?"".concat(n," (").concat(r.name,")"):n}function yH(n){let{header:e="Uniforms",program:t,uniforms:i,undefinedOnly:r=!1}=n;ne(t);const o=".*Matrix",c={},l=Object.keys(t._uniformSetters).sort();let u=0;for(const f of l)!f.match(".*_.*")&&!f.match(o)&&LS({table:c,header:e,uniforms:i,uniformName:f,undefinedOnly:r})&&u++;for(const f of l)f.match(o)&&LS({table:c,header:e,uniforms:i,uniformName:f,undefinedOnly:r})&&u++;for(const f of l)c[f]||LS({table:c,header:e,uniforms:i,uniformName:f,undefinedOnly:r})&&u++;let d=0;const h={};if(!r)for(const f in i){const p=i[f];c[f]||(d++,h[f]={Type:"NOT USED: ".concat(p),[e]:Yp(p)})}return{table:c,count:u,unusedTable:h,unusedCount:d}}function LS(n){let{table:e,header:t,uniforms:i,uniformName:r,undefinedOnly:s}=n;const o=i[r],a=function z_e(n){return null!=n}(o);return!(s&&a||(e[r]={[t]:a?Yp(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},0))}function vH(n){const{type:e,size:t}=n.accessor,i=I3(e,t);return i?"".concat(i.name," ").concat(n.name):n.name}const W_e={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function q_e(n,e){const{attributeMap:t=W_e}=e||{};return t&&t[n]||n}function X_e(n,e){let t;switch(n){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":t="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":t="vectors"}switch(t){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}ne(Number.isFinite(e.size),"attribute ".concat(n," needs size"))}const bH=()=>{},K_e={};class qd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{id:i=Er("model")}=t;ne(wv(e)),this.id=i,this.gl=e,this.id=t.id||Er("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||zp.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},ne(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return ne(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return ne(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function $_e(n,e,t){const i={};let r=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=q_e(s,t);if("indices"===s)r=o;else if(o.constant)i[a]=o.value;else{const c=o.value,l={...o};delete l.value,i[a]=[new Ut(n,c),l],X_e(s,l)}}if(r){const s=r.value||r;ne(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new Ut(n,{data:s,target:34963}),o]}return i}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Fd(e))return this;const t={};for(const i in e){const r=e[i];t[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(t),this}setUniforms(){return Object.assign(this.uniforms,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return bx(this.program.gl,e),this}draw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._checkProgram();const{moduleSettings:t=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:c=this.vertexArray}=e;let l;this.setAttributes(s),this.updateModuleSettings(t),this.setUniforms(r),ue.priority>=2&&(l=this._logDrawCallStart(2));const u=this.vertexArray.getDrawParams(),{isIndexed:d=u.isIndexed,indexType:h=u.indexType,indexOffset:f=u.indexOffset,vertexArrayInstanced:p=u.isInstanced}=this.props;p&&!this.isInstanced&&ue.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:g,instanceCount:m}=this,{onBeforeRender:y=bH,onAfterRender:v=bH}=this.props;y(),this.program.setUniforms(this.uniforms);const _=this.program.draw(Object.assign(K_e,e,{logPriority:l,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:c,transformFeedback:o,isIndexed:d,indexType:h,isInstanced:g,instanceCount:m,offset:d?f:0}));return v(),ue.priority>=2&&this._logDrawCallEnd(l,c,i),_}transform(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{discard:t=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),t&&(s=Object.assign({},s,{35977:t})),r.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(o=>o.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ue.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:o,defines:a,varyings:c,bufferMode:l,transpileToGLSL100:u}=this.programProps;t=this.programManager.get({vs:i,fs:r,modules:s,inject:o,defines:a,varyings:c,bufferMode:l,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}ne(t instanceof R3,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new V_e(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof Ut&&t.delete()}}_setAnimationProps(e){this.animated&&ne(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Fd(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new pH(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),ue.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:ue.level<=2})(),e}_logDrawCallEnd(e,t,i,r){if(void 0===e)return;const s=function j_e(n){let{vertexArray:e,header:t="Attributes"}=n;if(!e.configuration)return{};const i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=_H(e,e.elements,null,t));const r=e.values;for(const s in r){const o=e._getAttributeInfo(s);if(o){let a="".concat(s,": ").concat(o.name);const c=e.accessors[o.location];c&&(a="".concat(s,": ").concat(H_e(o.name,c))),i[a]=_H(e,r[s],c,t)}}return i}({vertexArray:t,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:c}=yH({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:l,count:u}=yH({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});u>0&&ue.log("MISSING UNIFORMS",Object.keys(l))(),c>0&&ue.log("UNUSED UNIFORMS",Object.keys(a))();const d=function G_e(n){const e={},t="Accessors for ".concat(n.id);for(const i of n.attributeInfos)if(i){const r=vH(i);e["in ".concat(r)]={[t]:JSON.stringify(i.accessor)}}for(const i of n.varyingInfos)if(i){const r=vH(i);e["out ".concat(r)]={[t]:JSON.stringify(i.accessor)}}return e}(this.vertexArray.configuration);ue.table(e,s)(),ue.table(e,o)(),ue.table(e+1,d)(),r&&r.log({logLevel:2,message:"Rendered to ".concat(r.id)}),ue.groupEnd(2)()}}class BS{static isSupported(e){return et(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:i}=this;e&&e.delete(),t&&t.delete(),i&&i.delete()}run(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{clearRenderTarget:t=!0}=e,i=this._updateDrawOptions(e);t&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)e=e||i.swap();ne(e,"Nothing to swap")}getBuffer(){return this.bufferTransform&&this.bufferTransform.getBuffer(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)}getData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)i.update(e)}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new qd(t,Object.assign({},e,{fs:e.fs||fH({version:gH(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=r.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function J_e(n){return!(Fd(n.feedbackBuffers)&&Fd(n.feedbackMap)&&!(n.varyings&&n.varyings.length>0))})(t)&&(this.bufferTransform=new b_e(e,t)),function Q_e(n){return!(Fd(n._sourceTextures)&&!n._targetTexture&&!n._targetTextureVarying)}(t)&&(this.textureTransform=new R_e(e,t)),ne(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=Object.assign(t,r.getDrawOptions(t));return t}}const aye={interpolation:class eye{constructor({gl:e,attribute:t,timeline:i}){w(this,"gl",void 0),w(this,"type","interpolation"),w(this,"attributeInTransition",void 0),w(this,"settings",void 0),w(this,"attribute",void 0),w(this,"transition",void 0),w(this,"currentStartIndices",void 0),w(this,"currentLength",void 0),w(this,"transform",void 0),w(this,"buffers",void 0),this.gl=e,this.transition=new Op(i),this.attribute=t,this.attributeInTransition=new FS(e,t.settings),this.currentStartIndices=t.startIndices,this.currentLength=0,this.transform=function nye(n,e){const t=cH(e.size);return new BS(n,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:t},varyings:["vCurrent"]})}(e,t);const r={byteLength:0,usage:35050};this.buffers=[new Ut(e,r),new Ut(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0)return void this.transition.cancel();this.settings=e;const{buffers:r,attribute:s}=this;lH(r);const o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)uH({buffer:a,...o});this.currentStartIndices=s.startIndices,this.currentLength=kS(s,t),this.attributeInTransition.setData({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:aH(0,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{duration:t,easing:i}=this.settings,{time:r}=this.transition;let s=r/t;i&&(s=i(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}},spring:class iye{constructor({gl:e,attribute:t,timeline:i}){w(this,"gl",void 0),w(this,"type","spring"),w(this,"attributeInTransition",void 0),w(this,"settings",void 0),w(this,"attribute",void 0),w(this,"transition",void 0),w(this,"currentStartIndices",void 0),w(this,"currentLength",void 0),w(this,"texture",void 0),w(this,"framebuffer",void 0),w(this,"transform",void 0),w(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Op(i),this.attribute=t,this.attributeInTransition=new FS(e,{...t.settings,normalized:!1}),this.currentStartIndices=t.startIndices,this.currentLength=0,this.texture=function sye(n){return new xi(n,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function oye(n,e){return new Un(n,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function rye(n,e,t){const i=cH(e.size);return new BS(n,{framebuffer:t,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(e,t,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new Ut(e,r),new Ut(e,r),new Ut(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){const{buffers:r,attribute:s}=this,o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)uH({buffer:a,...o});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=kS(s,t),this.attributeInTransition.setData({buffer:r[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:aH(0,s)}})}update(){const{buffers:e,transform:t,framebuffer:i,transition:r}=this;if(!r.update())return!1;const o=this.settings;return t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:o.stiffness,damping:o.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),lH(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),Cv(i)[0]>0||r.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}};class cye{constructor(e,{id:t,timeline:i}){w(this,"id",void 0),w(this,"isSupported",void 0),w(this,"gl",void 0),w(this,"timeline",void 0),w(this,"transitions",void 0),w(this,"needsRedraw",void 0),w(this,"numInstances",void 0),this.id=t,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=BS.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],o=s.getTransitionSetting(t);o&&this._updateAttribute(r,s,o)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(t))&&this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const i=this.transitions[t];i.inProgress&&(e[t]=i.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported)return void ot.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();r&&this._removeTransition(e);const o=aye[i.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,gl:this.gl}):(ot.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const wH="attributeManager.invalidate";class pye{constructor(e,{id:t="attribute-manager",stats:i,timeline:r}={}){w(this,"id",void 0),w(this,"gl",void 0),w(this,"attributes",void 0),w(this,"updateTriggers",void 0),w(this,"needsRedraw",void 0),w(this,"userData",void 0),w(this,"stats",void 0),w(this,"attributeTransitionManager",void 0),this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new cye(e,{id:"".concat(t,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const t of e)void 0!==this.attributes[t]&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const i=this._invalidateTrigger(e,t);Hi(wH,this,e,i)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);Hi(wH,this,"all")}update({data:e,numInstances:t,startIndices:i=null,transitions:r,props:s={},buffers:o={},context:a={}}){let c=!1;Hi("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const l in this.attributes){const u=this.attributes[l],d=u.settings.accessor;u.startIndices=i,u.numInstances=t,s[l]&&ot.removed("props.".concat(l),"data.attributes.".concat(l))(),u.setExternalBuffer(o[l])||u.setBinaryValue("string"==typeof d?o[d]:void 0,e.startIndices)||"string"==typeof d&&!o[d]&&u.setConstantValue(s[d])||u.needsUpdate()&&(c=!0,this._updateAttribute({attribute:u,numInstances:t,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||u.needsRedraw()}c&&Hi("attributeManager.updateEnd",this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:i}=this,r={...i.getAttributes()};for(const s in t){const o=t[s];o.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=o)}return r}getShaderAttributes(e,t={}){e||(e=this.getAttributes());const i={};for(const r in e)t[r]||Object.assign(i,e[r].getShaderAttributes());return i}_add(e,t={}){for(const i in e)this.attributes[i]=this._createAttribute(i,e[i],t);this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,i){const r={...t,id:e,size:(t.isIndexed?1:t.size)||1,divisor:i.instanced?1:t.divisor||0};return new FS(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(o=>{const a=i[o];a&&a.setNeedsUpdate(a.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:i}=e;Hi("attribute.updateStart",t),t.constant?t.setConstantValue(t.value):(t.allocate(i)&&Hi("attribute.allocate",t,i),t.updateBuffer(e)&&(this.needsRedraw=!0,Hi("attribute.updateEnd",t,i)))}}function CH(n,e,t,i,r){const s=e-n;return(t-e)*r+-s*i+s+e}function AH(n,e){if(Array.isArray(n)){let t=0;for(let i=0;i<n.length;i++){const r=n[i]-e[i];t+=r*r}return Math.sqrt(t)}return Math.abs(n-e)}const yye={interpolation:class gye extends Op{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:i,duration:r,easing:s}}=this,o=s(e/r);this._value=iv(t,i,o)}},spring:class _ye extends Op{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=function mye(n,e,t,i,r){if(Array.isArray(t)){const s=[];for(let o=0;o<t.length;o++)s[o]=CH(n[o],e[o],t[o],i,r);return s}return CH(n,e,t,i,r)}(s,o,t,i,r);const c=AH(a,t),l=AH(a,o);c<1e-5&&l<1e-5&&(a=t,this.end()),this._prevValue=o,this._currValue=a}}};class vye{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,i,r){const{transitions:s}=this;if(s.has(e)){const c=s.get(e),{value:l=c.settings.fromValue}=c;t=l,this.remove(e)}if(!(r=oH(r)))return;const o=yye[r.type];if(!o)return void ot.error("unsupported transition type '".concat(r.type,"'"))();const a=new o(this.timeline);a.start({...r,fromValue:t,toValue:i}),s.set(e,a)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,i]of this.transitions)i.update(),e[t]=i.value,i.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function Eye(n,e){if(!n.transitions)return!1;const t={},i=US(n);let r=!1;for(const s in n.transitions){const o=i[s],a=o&&o.type;("number"===a||"color"===a||"array"===a)&&VS(n[s],e[s],o)&&(t[s]=!0,r=!0)}return!!r&&t}function TH({newProps:n,oldProps:e,ignoreProps:t={},propTypes:i={},triggerName:r="props"}){if(e===n)return!1;if("object"!=typeof n||null===n||"object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const s of Object.keys(n))if(!(s in t)){if(!(s in e))return"".concat(r,".").concat(s," added");const o=VS(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in t)){if(!(s in n))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(n,s)){const o=VS(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}}return!1}function VS(n,e,t){let i=t&&t.equal;return i&&!i(n,e,t)||!i&&(i=n&&e&&n.equals,i&&!i.call(n,e))?"changed deeply":i||e===n?null:"changed shallowly"}function Tye(n,e){if(null===e)return!0;const t=e.extensions,{extensions:i}=n;if(i===t)return!1;if(!t||!i||i.length!==t.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(t[r]))return!0;return!1}function xH(n,e,t){let i=n.updateTriggers[t];i=i??{};let r=e.updateTriggers[t];return r=r??{},TH({oldProps:r,newProps:i,triggerName:t})}function US(n){const e=n[Iv],t=e&&e.constructor;return t?t._propTypes:{}}function Rye(n,e){if(!e)return n;const t={...n,...e};if("defines"in e&&(t.defines={...n.defines,...e.defines}),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(i=>"project64"===i.name))){const i=t.modules.findIndex(r=>"project32"===r.name);i>=0&&t.modules.splice(i,1)}if("inject"in e)if(n.inject){const i={...n.inject};for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];t.inject=i}else t.inject=e.inject;return t}function jS(n,e,t=!1){const i=e.projectPosition(n);if(t&&e instanceof mc){const[r,s,o=0]=n,a=e.getDistanceScales([r,s]);i[2]=o*a.unitsPerMeter[2]}return i}function SH(n,{viewport:e,modelMatrix:t,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[o,a,c=0]=n;switch(t&&([o,a,c]=Ip([],[o,a,c,1],t)),i){case ut.LNGLAT:return jS([o,a,c],e,s);case ut.LNGLAT_OFFSETS:return jS([o+r[0],a+r[1],c+(r[2]||0)],e,s);case ut.METER_OFFSETS:return jS(lU(r,[o,a,c]),e,s);default:return e.isGeospatial?[o+r[0],a+r[1],c+r[2]]:e.projectPosition([o,a,c])}}const Nye={10241:9987,10240:9729,10242:33071,10243:33071},HS={},Lye={boolean:{validate:(n,e)=>!0,equal:(n,e,t)=>!!n==!!e},number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},color:{validate:(n,e)=>e.optional&&!n||Kp(n)&&(3===n.length||4===n.length),equal:(n,e,t)=>zS(n,e)},accessor:{validate(n,e){const t=Gv(n);return"function"===t||t===Gv(e.value)},equal:(n,e,t)=>"function"==typeof e||zS(n,e)},array:{validate:(n,e)=>e.optional&&!n||Kp(n),equal:(n,e,t)=>t.compare?zS(n,e):n===e},object:{equal:(n,e,t)=>t.compare?Od(n,e):n===e},function:{validate:(n,e)=>e.optional&&!n||"function"==typeof n,equal:(n,e,t)=>!t.compare||n===e},data:{transform:(n,e,t)=>{const{dataTransform:i}=t.props;return i&&n?i(n):n}},image:{transform:(n,e,t)=>function kye(n,e){const t=n.context&&n.context.gl;if(!t||!e)return null;if(e instanceof xi)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new xi(t,{...e,parameters:{...Nye,...i,...n.props.textureParameters}});return HS[r.id]=!0,r}(t,n),release:n=>{!function Fye(n){!n||!(n instanceof xi)||HS[n.id]&&(n.delete(),delete HS[n.id])}(n)}}};function zS(n,e){if(n===e)return!0;if(!Kp(n)||!Kp(e))return!1;const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function Vye(n,e){switch(Gv(e)){case"object":return Zp(n,e);case"array":return Zp(n,{type:"array",value:e,compare:!1});case"boolean":return Zp(n,{type:"boolean",value:e});case"number":return Zp(n,{type:"number",value:e});case"function":return Zp(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function Zp(n,e){return"type"in e?{name:n,...Lye[e.type],...e}:"value"in e?{name:n,type:Gv(e.value),...e}:{name:n,type:"object",value:e}}function Kp(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function Gv(n){return Kp(n)?"array":null===n?"null":typeof n}function MH(n){return Wv(n,"_mergedDefaultProps")||(function jye(n){if(!n.prototype)return;const t=Object.getPrototypeOf(n),i=MH(t),s=function Bye(n){const e={},t={},i={};for(const[r,s]of Object.entries(n)){const o=s?.deprecatedFor;if(o)i[r]=Array.isArray(o)?o:[o];else{const a=Vye(r,s);e[r]=a,t[r]=a.value}}return{propTypes:e,defaultProps:t,deprecatedProps:i}}(Wv(n,"defaultProps")||{}),o=function Hye(n,e,t){const i=Object.create(null);Object.assign(i,e,n);const r=function $ye(n){const e=Wv(n,"layerName")||Wv(n,"componentName");return e||ot.once(0,"".concat(n.name,".componentName not specified"))(),e||n.name}(t);return delete n.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}(s.defaultProps,i,n),a={...t._propTypes,...s.propTypes};!function Gye(n,e){const t={},i={};for(const r in e){const s=e[r],{name:o,value:a}=s;s.async&&(t[o]=a,i[o]=Wye(o))}n[Hd]=t,n[Dl]={},Object.defineProperties(n,i)}(o,a);const c={...t._deprecatedProps,...s.deprecatedProps};(function zye(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(t);for(const s of e[t])IH(this,s)||(this[s]=i);ot.deprecated(r,e[t].join("/"))()}})})(o,c),n._mergedDefaultProps=o,n._propTypes=a,n._deprecatedProps=c}(n),n._mergedDefaultProps)}function Wye(n){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||sH(e)?this[Dl][n]=e:this[fc][n]=e},get(){if(this[fc]){if(n in this[fc])return this[fc][n]||this[Hd][n];if(n in this[Dl]){const e=this[Iv]&&this[Iv].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[Hd][n]}}return this[Hd][n]}}}function IH(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Wv(n,e){return IH(n,e)&&n[e]}let qye=0;class GS{constructor(...e){w(this,"id",void 0),w(this,"props",void 0),w(this,"count",void 0),this.props=function Uye(n,e){const t=MH(n.constructor),i=Object.create(t);i[Iv]=n,i[Dl]={},i[fc]={};for(let r=0;r<e.length;++r){const s=e[r];for(const o in s)i[o]=s[o]}return Object.freeze(i),i}(this,e),this.id=this.props.id,this.count=qye++}clone(e){const{props:t}=this,i={};for(const r in t[Hd])r in t[fc]?i[r]=t[fc][r]:r in t[Dl]&&(i[r]=t[Dl][r]);return new this.constructor({...t,...i,...e})}}w(GS,"componentName","Component"),w(GS,"defaultProps",{});const Xye=Object.freeze({});class Yye{constructor(e){w(this,"component",void 0),w(this,"onAsyncPropUpdated",void 0),w(this,"asyncProps",void 0),w(this,"oldProps",void 0),w(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps||Xye}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return!!(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){const t=e[fc]||{},i=e[Dl]||e,r=e[Hd]||{};for(const s in t){const o=t[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o),t[s]=this.getAsyncProp(s)}for(const s in i){const o=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if("string"==typeof t&&(t=this._fetch(e,t)),t instanceof Promise)return void this._watchPromise(e,t);if(sH(t))return void this._resolveAsyncIterable(e,t);this._setPropValue(e,t)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const i=this.asyncProps[e];return t!==i.resolvedValue&&t!==i.lastValue&&(i.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const i=this.asyncProps[e];i&&(t=this._postProcessValue(i,t),i.resolvedValue=t,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(e,t,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&void 0!==t&&(this._freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const i=this.asyncProps[e];if(i){i.pendingLoadCount++;const r=i.pendingLoadCount;t.then(s=>{s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r),this._onResolve(e,s)}).catch(s=>{this._onError(e,s)})}}_resolveAsyncIterable(e,t){var i=this;return Q(function*(){if("data"!==e)return void i._setPropValue(e,t);const r=i.asyncProps[e];if(!r)return;r.pendingLoadCount++;const s=r.pendingLoadCount;let o=[],a=0;var u,c=!1,l=!1;try{for(var h,d=Jx(t);c=!(h=yield d.next()).done;c=!1){const f=h.value;{const{dataTransform:p}=i.component.props;o=p?p(f,o):o.concat(f),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:a,endRow:o.length}]}),a=o.length,i._setAsyncPropValue(e,o,s)}}}catch(f){l=!0,u=f}finally{try{c&&null!=d.return&&(yield d.return())}finally{if(l)throw u}}i._onResolve(e,o)})()}_postProcessValue(e,t){const i=e.type;return i&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(t,i,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const r=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}class Zye extends Yye{constructor({attributeManager:e,layer:t}){super(t),w(this,"attributeManager",void 0),w(this,"needsRedraw",void 0),w(this,"needsUpdate",void 0),w(this,"subLayers",void 0),w(this,"usesPickingColorCache",void 0),w(this,"changeFlags",void 0),w(this,"viewport",void 0),w(this,"uniformTransitions",void 0),w(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}_fetch(e,t){const i=this.component.props.fetch;return i?i(t,{propName:e,layer:this.layer}):super._fetch(e,t)}_onResolve(e,t){const i=this.component.props.onDataLoad;"data"===e&&i&&i(t,{propName:e,layer:this.layer})}_onError(e,t){this.layer.raiseError(t,"loading ".concat(e," of ").concat(this.layer))}}const DH=2**24-1,nve=Object.freeze([]),ive=Mv(({oldViewport:n,viewport:e})=>n.equals(e));let wo=new Uint8ClampedArray(0);const rve={data:{type:"data",value:nve,async:!0},dataComparator:{type:"function",value:null,compare:!1,optional:!0},_dataDiff:{type:"function",value:n=>n&&n.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:o}=t.context;var a;r=r||t.getLoadOptions(),i=i||t.props.loaders,s&&(r={...r,fetch:{...null===(a=r)||void 0===a?void 0:a.fetch,signal:s}});let c=o.contains(n);return!c&&!r&&(o.add({resourceId:n,data:Wp(n,i),persistent:!1}),c=!0),c?o.subscribe({resourceId:n,onChange:l=>{var u;return null===(u=t.internalState)||void 0===u?void 0:u.reloadAsyncProp(e,l)},consumerId:t.id,requestId:e}):Wp(n,i,r)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:ut.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,100*-n],compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Ol extends GS{constructor(...e){super(...e),w(this,"internalState",null),w(this,"lifecycle","Awaiting state"),w(this,"context",void 0),w(this,"state",void 0),w(this,"parent",null)}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}project(e){Ti(this.internalState);const t=this.internalState.viewport||this.context.viewport,i=SH(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,s,o]=dU(i,t.pixelProjectionMatrix);return 2===e.length?[r,s]:[r,s,o]}unproject(e){return Ti(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){return Ti(this.internalState),function Pye(n,e){const{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function Oye(n){const{viewport:e,modelMatrix:t,coordinateOrigin:i}=n;let{coordinateSystem:r,fromCoordinateSystem:s,fromCoordinateOrigin:o}=n;return r===ut.DEFAULT&&(r=e.isGeospatial?ut.LNGLAT:ut.CARTESIAN),void 0===s&&(s=r),void 0===o&&(o=i),{viewport:e,coordinateSystem:r,coordinateOrigin:i,modelMatrix:t,fromCoordinateSystem:s,fromCoordinateOrigin:o}}(e),{geospatialOrigin:c,shaderCoordinateOrigin:l,offsetMode:u}=V3(t,i,r),d=SH(n,{viewport:t,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:u});u&&function wce(n,e,t){n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2]}(d,d,t.projectPosition(c||l));return d}(e,{viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...t})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const t of this.getModels())t.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===ut.DEFAULT||e===ut.LNGLAT||e===ut.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,t=[]){return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){Ti(e instanceof Uint8Array);const[t,i,r]=e;return t+256*i+65536*r-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function Mye(n){if(!function Dye(n){return null!==n&&"object"==typeof n}(n))throw new Error("count(): argument not an object");if("function"==typeof n.count)return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(function Iye(n){return null!==n&&"object"==typeof n&&n.constructor===Object}(n))return Object.keys(n).length;throw new Error("count(): argument not a container")}(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;const t=this.getAttributeManager();if(!t)return null;const{positions:i,instancePositions:r}=t.attributes;return null===(e=i||r)||void 0===e?void 0:e.getBounds()}getShaders(e){for(const t of this.props.extensions)e=Rye(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:i}=e.changeFlags;if(i&&t)if(Array.isArray(i))for(const c of i)t.invalidateAll(c);else t.invalidateAll();const{props:r,oldProps:s}=e,o=Number.isInteger(s.highlightedObjectIndex)||s.pickable,a=Number.isInteger(r.highlightedObjectIndex)||r.pickable;if(o!==a&&t){const{pickingColors:c,instancePickingColors:l}=t.attributes,u=c||l;u&&(a&&u.constant&&(u.constant=!1,t.invalidate(u.id)),!u.value&&!a&&(u.constant=!0,u.value=[0,0,0]))}}finalizeState(e){for(const i of this.getModels())i.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e)}getPickingInfo({info:e}){const{index:r}=e;return r>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[r]),e}raiseError(e,t){var i,r,s,o;t&&(e.message="".concat(t,": ").concat(e.message)),null!==(i=(r=this.props).onError)&&void 0!==i&&i.call(r,e)||null===(s=this.context)||void 0===s||null===(o=s.onError)||void 0===o||o.call(s,e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var e;return(null===(e=this.internalState)||void 0===e?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,(!t||!ive({oldViewport:t,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const t=this.getAttributeManager();t&&("all"===e?t.invalidateAll():t.invalidate(e))}updateAttributes(e){for(const t of this.getModels())this._setModelAttributes(t,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,i=this.getNumInstances(),r=this.getStartIndices();e.update({data:t.data,numInstances:i,startIndices:r,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),i=Object.create(this.props);for(const r in t)Object.defineProperty(i,r,{value:t[r]});return i}return this.props}calculateInstancePickingColors(e,{numInstances:t}){if(e.constant)return;const i=Math.floor(wo.length/3);if(this.internalState.usesPickingColorCache=!0,i<t){t>DH&&ot.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),wo=xp.allocate(wo,t,{size:3,copy:!0,maxCount:Math.max(t,DH)});const r=Math.floor(wo.length/3),s=[];for(let o=i;o<r;o++)this.encodePickingColor(o,s),wo[3*o+0]=s[0],wo[3*o+1]=s[1],wo[3*o+2]=s[2]}e.value=wo.subarray(0,3*t)}_setModelAttributes(e,t){const s=this.getAttributeManager().getShaderAttributes(t,e.userData.excludeAttributes||{});e.setAttributes(s)}disablePickingIndex(e){this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:i}=this.getAttributeManager().attributes,r=t||i;if(!r)return;const s=r.getVertexOffset(e),o=r.getVertexOffset(e+1);r.buffer.subData({data:new Uint8Array(o-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,i=e||t;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==wo.buffer&&(i.value=wo.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){Ti(!this.internalState),Ti(Number.isFinite(this.props.coordinateSystem)),Hi("layer.initialize",this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Zye({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(ot.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.layer=this,this.internalState.uniformTransitions=new vye(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Hi("layer.matched",this,this===e);const{state:t,internalState:i}=e;this!==e&&(this.internalState=i,this.internalState.layer=this,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Hi("layer.update",this,e),!e)return;const t=this.props,i=this.context,r=this.internalState,s=i.viewport,o=this._updateUniformTransition();r.propsInTransition=o,i.viewport=r.viewport||s,this.props=o;try{const a=this._getUpdateParams(),c=this.getModels();if(i.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const u of this.props.extensions)u.updateState.call(this,a,u);const l=this.getModels()[0]!==c[0];this._postUpdate(a,l)}finally{i.viewport=s,this.props=t,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){Hi("layer.finalize",this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,e)}_drawLayer({moduleParameters:e=null,uniforms:t={},parameters:i={}}){this._updateAttributeTransition();const r=this.props,s=this.context;this.props=this.internalState.propsInTransition||r,t.opacity=Math.pow(this.props.opacity,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,c=a&&a(t)||[0,0];la(s.gl,{polygonOffset:c}),us(s.gl,i,()=>{const l={moduleParameters:e,uniforms:t,parameters:i,context:s};for(const u of this.props.extensions)u.draw.call(this,l,u);this.draw(l)})}finally{this.props=r}}getChangeFlags(){var e;return null===(e=this.internalState)||void 0===e?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const r in e)if(e[r]){let s=!1;if("dataChanged"===r){const o=e[r],a=t[r];o&&Array.isArray(a)&&(t.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0)}t[r]||(t[r]=e[r],s=!0),s&&Hi("layer.changeFlag",this,r,e)}const i=!!(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=i,t.somethingChanged=i||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){const i=function wye(n,e){const t=TH({newProps:n,oldProps:e,propTypes:US(n),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function Cye(n,e){if(null===e)return"oldProps is null, initial diff";let t=!1;const{dataComparator:i,_dataDiff:r}=n;return i?i(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&r&&(t=r(n.data,e.data)||t),t}(n,e);let r=!1;return i||(r=function Aye(n,e){if(null===e)return{all:!0};if("all"in n.updateTriggers&&xH(n,e,"all"))return{all:!0};const t={};let i=!1;for(const r in n.updateTriggers)"all"!==r&&xH(n,e,r)&&(t[r]=!0,i=!0);return!!i&&t}(n,e)),{dataChanged:i,propsChanged:t,updateTriggersChanged:r,extensionsChanged:Tye(n,e),transitionsChanged:Eye(n,e)}}(e,t);if(i.updateTriggersChanged)for(const s in i.updateTriggersChanged)i.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(i.transitionsChanged)for(const s in i.transitionsChanged){var r;this.internalState.uniformTransitions.add(s,t[s],e[s],null===(r=e.transitions)||void 0===r?void 0:r[s])}return this.setChangeFlags(i)}validateProps(){!function bye(n){const e=US(n);for(const t in e){const i=e[t],{validate:r}=i;if(r&&!r(n[t],i))throw new Error("Invalid prop ".concat(t,": ").concat(n[t]))}}(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={pickingSelectedColor:e.picked?e.color:null},{highlightColor:i}=this.props;e.picked&&"function"==typeof i&&(t.pickingHighlightColor=i(e)),this.setModuleParameters(t),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new pye(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:i,oldProps:r}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s?.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:c}=i;if(t||r.autoHighlight!==o||r.highlightedObjectIndex!==a||r.highlightColor!==c){const l={};o||(l.pickingSelectedColor=null),Array.isArray(c)&&(l.pickingHighlightColor=c),(t||a!==r.highlightedObjectIndex)&&(l.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(l)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags;const i=this.getAttributeManager(),r=!!i&&i.getNeedsRedraw(e);return t=t||r,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}w(Ol,"defaultProps",rve),w(Ol,"layerName","Layer");class WS extends Ol{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:t}=e;return t&&t.__source&&t.__source.parent&&t.__source.parent.id===this.id&&(e.object=t.__source.object,e.index=t.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:i}=this.props;return i&&i[e]&&i[e].type||t}getSubLayerRow(e,t,i){return e.__source={parent:this,object:t,index:i},e}getSubLayerAccessor(e){if("function"==typeof e){const t={index:-1,data:this.props.data,target:[]};return(i,r)=>i&&i.__source?(t.index=i.__source.index,e(i.__source.object,t)):e(i,r)}return e}getSubLayerProps(e={}){var t;const{opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:c,autoHighlight:l,highlightColor:u,coordinateSystem:d,coordinateOrigin:h,wrapLongitude:f,positionFormat:p,modelMatrix:g,extensions:m,fetch:y,operation:v,_subLayerProps:_}=this.props,E={id:"",updateTriggers:{},opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:c,autoHighlight:l,highlightColor:u,coordinateSystem:d,coordinateOrigin:h,wrapLongitude:f,positionFormat:p,modelMatrix:g,extensions:m,fetch:y,operation:v},A=_&&e.id&&_[e.id],x=A&&A.updateTriggers,I=e.id||"sublayer";if(A){const S=this.constructor._propTypes,F=e.type?e.type._propTypes:{};for(const U in A){const V=F[U]||S[U];V&&"accessor"===V.type&&(A[U]=this.getSubLayerAccessor(A[U]))}}Object.assign(E,e,A),E.id="".concat(this.props.id,"-").concat(I),E.updateTriggers={all:null===(t=this.props.updateTriggers)||void 0===t?void 0:t.all,...e.updateTriggers,...x};for(const S of m){const F=S.getSubLayerProps.call(this,S);F&&Object.assign(E,F,{updateTriggers:Object.assign(E.updateTriggers,F.updateTriggers)})}return E}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let i=this.internalState.subLayers;const r=!i||this.needsUpdate();r&&(i=Ox(this.renderLayers(),Boolean),this.internalState.subLayers=i),Hi("compositeLayer.renderLayers",this,r,i);for(const s of i)s.parent=this}}w(WS,"layerName","CompositeLayer");const $v={name:"project32",dependencies:[Mx],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},ove={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},qv={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:#decl":"\nuniform bool picking_uAttribute;\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function ave(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ove;const e={};if(void 0!==n.pickingSelectedColor)if(n.pickingSelectedColor){const t=n.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=t}else e.picking_uSelectedColorValid=0;if(n.pickingHighlightColor){const t=Array.from(n.pickingHighlightColor,i=>i/255);Number.isFinite(t[3])||(t[3]=1),e.picking_uHighlightColor=t}return void 0!==n.pickingActive&&(e.picking_uActive=!!n.pickingActive,e.picking_uAttribute=!!n.pickingAttribute),e}},RH={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class _c{static get DRAW_MODE(){return RH}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=Er("geometry"),drawMode:i=RH.TRIANGLES,attributes:r={},indices:s=null,vertexCount:o=null}=e;this.id=t,this.drawMode=0|i,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,ne(ArrayBuffer.isView(r.value),"".concat(this._print(i),": must be typed array or object with value as typed array")),("POSITION"===i||"positions"===i)&&!r.size&&(r.size=3),"indices"===i?(ne(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let i=1/0;for(const r in e){const s=e[r],{value:o,size:a,constant:c}=s;!c&&o&&a>=1&&(i=Math.min(i,o.length/a))}return ne(Number.isFinite(i)),i}}const OH=()=>{},PH={10241:9987,10240:9729,10242:33071,10243:33071};function hve(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function fve(n,e,t,i){return t===e.width&&i===e.height?e:(n.canvas.height=i,n.canvas.width=t,n.clearRect(0,0,n.canvas.width,n.canvas.height),n.drawImage(e,0,0,e.width,e.height,0,0,t,i),n.canvas)}function Jp(n){return n&&(n.id||n.url)}function NH(n,e,t){for(let i=0;i<e.length;i++){const{icon:r,xOffset:s}=e[i];n[Jp(r)]={...r,x:s,y:t}}}class _ve{constructor(e,{onUpdate:t=OH,onError:i=OH}){w(this,"gl",void 0),w(this,"onUpdate",void 0),w(this,"onError",void 0),w(this,"_loadOptions",null),w(this,"_texture",null),w(this,"_externalTexture",null),w(this,"_mapping",{}),w(this,"_textureParameters",null),w(this,"_pendingCount",0),w(this,"_autoPacking",!1),w(this,"_xOffset",0),w(this,"_yOffset",0),w(this,"_rowHeight",0),w(this,"_buffer",4),w(this,"_canvasWidth",1024),w(this,"_canvasHeight",0),w(this,"_canvas",null),this.gl=e,this.onUpdate=t,this.onError=i}finalize(){var e;null===(e=this._texture)||void 0===e||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?Jp(e):e;return this._mapping[t]||{}}setProps({loadOptions:e,autoPacking:t,iconAtlas:i,iconMapping:r,textureParameters:s}){var o;e&&(this._loadOptions=e),void 0!==t&&(this._autoPacking=t),r&&(this._mapping=r),i&&(null===(o=this._texture)||void 0===o||o.delete(),this._texture=null,this._externalTexture=i),s&&(this._textureParameters=s)}get isLoaded(){return 0===this._pendingCount}packIcons(e,t){if(!this._autoPacking||typeof document>"u")return;const i=Object.values(function mve(n,e,t){if(!n||!e)return null;t=t||{};const i={},{iterable:r,objectInfo:s}=Uv(n);for(const o of r){s.index++;const a=e(o,s),c=Jp(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!i[c]&&(!t[c]||a.url!==t[c].url)&&(i[c]={...a,source:o,sourceIndex:s.index})}return i}(e,t,this._mapping)||{});if(i.length>0){const{mapping:r,xOffset:s,yOffset:o,rowHeight:a,canvasHeight:c}=function gve({icons:n,buffer:e,mapping:t={},xOffset:i=0,yOffset:r=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let c=0;c<n.length;c++){const l=n[c];if(!t[Jp(l)]){const{height:d,width:h}=l;i+h+e>o&&(NH(t,a,r),i=0,r=s+r+e,s=0,a=[]),a.push({icon:l,xOffset:i}),i=i+h+e,s=Math.max(s,d)}}return a.length>0&&NH(t,a,r),{mapping:t,rowHeight:s,xOffset:i,yOffset:r,canvasWidth:o,canvasHeight:hve(s+r+e)}}({icons:i,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=r,this._xOffset=s,this._yOffset=o,this._canvasHeight=c,this._texture||(this._texture=new xi(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||PH})),this._texture.height!==this._canvasHeight&&(this._texture=function pve(n,e,t,i){const r=n.width,s=n.height,o=new xi(n.gl,{width:e,height:t,parameters:i});return function the(n,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:s=0,targetInternalFormat:o=6408}=t;let{targetX:a,targetY:c,targetZ:l,width:u,height:d}=t;const{framebuffer:h,deleteFramebuffer:f}=Vp(n);ne(h);const{gl:p,handle:g}=h,m=typeof a<"u"||typeof c<"u"||typeof l<"u";a=a||0,c=c||0,l=l||0;const y=p.bindFramebuffer(36160,g);ne(e);let v=null;if(e instanceof Ml&&(v=e,u=Number.isFinite(u)?u:v.width,d=Number.isFinite(d)?d:v.height,v.bind(0),e=v.target),m)switch(e){case 3553:case 34067:p.copyTexSubImage2D(e,s,a,c,i,r,u,d);break;case 35866:case 32879:Ui(p).copyTexSubImage3D(e,s,a,c,l,i,r,u,d)}else p.copyTexImage2D(e,s,o,i,r,u,d,0);v&&v.unbind(),p.bindFramebuffer(36160,y||null),f&&h.delete()}(n,o,{targetY:0,width:r,height:s}),n.delete(),o}(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||PH)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(i)}}_loadIcons(e){const t=this._canvas.getContext("2d");for(const i of e)this._pendingCount++,Wp(i.url,Fj,this._loadOptions).then(r=>{const s=Jp(i),{x:o,y:a,width:c,height:l}=this._mapping[s],u=fve(t,r,c,l);this._texture.setSubImageData({data:u,x:o,y:a,width:c,height:l}),this._texture.generateMipmap(),this.onUpdate()}).catch(r=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:r})}).finally(()=>{this._pendingCount--})}}const kH=[0,0,0,255],yve={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:n=>n.position},getIcon:{type:"accessor",value:n=>n.icon},getColor:{type:"accessor",value:kH},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class $S extends Ol{constructor(...e){super(...e),w(this,"state",void 0)}getShaders(){return super.getShaders({vs:'#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  // convert size in meters to pixels, then scaled and clamp\n \n  // project meters to pixels and clamp to limits \n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n\n  // scale icon height to match instanceSize\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n\n  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n',fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n\n  // if colorMode == 0, use pixel color from the texture\n  // if colorMode == 1 or rendering picking buffer, use texture as transparency mask\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  // Take the global opacity and the alpha from vColor into account for the alpha component\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[$v,qv]})}initializeState(){this.state={iconManager:new _ve(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:kH},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:t,oldProps:i,changeFlags:r}=e,s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:c,getIcon:l,textureParameters:u}=t,{iconManager:d}=this.state,h=o||this.internalState.isAsyncPropLoading("iconAtlas");if(d.setProps({loadOptions:t.loadOptions,autoPacking:!h,iconAtlas:o,iconMapping:h?a:null,textureParameters:u}),h?i.iconMapping!==t.iconMapping&&s.invalidate("getIcon"):(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&d.packIcons(c,l),r.extensionsChanged){var f;const{gl:p}=this.context;null===(f=this.state.model)||void 0===f||f.delete(),this.state.model=this._getModel(p),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:t,sizeMinPixels:i,sizeMaxPixels:r,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:c}=this.state,l=c.getTexture();l&&this.state.model.setUniforms(e).setUniforms({iconsTexture:l,iconsTextureDim:[l.width,l.height],sizeUnits:gv[s],sizeScale:t,sizeMinPixels:i,sizeMaxPixels:r,billboard:o,alphaCutoff:a}).draw()}_getModel(e){return new qd(e,{...this.getShaders(),id:this.props.id,geometry:new _c({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var t;const i=null===(t=this.getCurrentLayer())||void 0===t?void 0:t.props.onIconError;i?i(e):ot.error(e.error.message)()}getInstanceOffset(e){const{width:t,height:i,anchorX:r=t/2,anchorY:s=i/2}=this.state.iconManager.getIconMapping(e);return[t/2-r,i/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:t,y:i,width:r,height:s}=this.state.iconManager.getIconMapping(e);return[t,i,r,s]}}w($S,"defaultProps",yve),w($S,"layerName","IconLayer");const LH=[];class qS extends $S{constructor(...e){super(...e),w(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n\n    // if enable sdf (signed distance fields)\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n\n    // Take the global opacity and the alpha from color into account for the alpha component\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(t,{index:i,target:r})=>this.encodePickingColor(i,r)}})}updateState(e){super.updateState(e);const{props:t,oldProps:i}=e;let{outlineColor:r}=t;r!==i.outlineColor&&(r=r.map(s=>s/255),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!t.sdf&&t.outlineWidth&&ot.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:t,smoothing:i,outlineWidth:r}=this.props,{outlineColor:s}=this.state;e.uniforms={...e.uniforms,buffer:.75,outlineBuffer:r?Math.max(i,.75*(1-r)):-1,gamma:i,sdf:!!t,outlineColor:s},super.draw(e)}getInstanceOffset(e){return e?Array.from(e).flatMap(t=>super.getInstanceOffset(t)):LH}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(t=>super.getInstanceIconFrame(t)):LH}}w(qS,"defaultProps",{getIconOffsets:{type:"accessor",value:n=>n.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}}),w(qS,"layerName","MultiIconLayer");var wve=at(772),Eve=at.n(wve);const Cve=32,Ave=[];function Tve(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function BH(n,e,t,i){let r=0;for(let o=e;o<t;o++){var s;r+=(null===(s=i[n[o]])||void 0===s?void 0:s.width)||0}return r}function VH(n,e,t,i,r,s){let o=e,a=0;for(let c=e;c<t;c++){const l=BH(n,c,c+1,r);a+l>i&&(o<c&&s.push(c),o=c,a=0),a+=l}return a}function Mve(n,e,t,i,r=0,s){void 0===s&&(s=n.length);const o=[];return"break-all"===e?VH(n,r,s,t,i,o):function Sve(n,e,t,i,r,s){let o=e,a=e,c=e,l=0;for(let u=e;u<t;u++)if((" "===n[u]||" "===n[u+1]||u+1===t)&&(c=u+1),c>a){let d=BH(n,a,c,r);l+d>i&&(o<a&&(s.push(a),o=a,l=0),d>i&&(d=VH(n,a,c,i,r,s),o=s[s.length-1])),a=c,l+=d}}(n,r,s,t,i,o),o}function Ive(n,e,t,i,r,s){let o=0,a=0;for(let c=e;c<t;c++){const l=n[c],u=i[l];u?(a||(a=u.height),r[c]=o+u.width/2,o+=u.width):(ot.warn("Missing character: ".concat(l," (").concat(l.codePointAt(0),")"))(),r[c]=o,o+=Cve)}s[0]=o,s[1]=a}function UH(n,e,t,i,r){const s=Array.from(n),o=s.length,a=new Array(o),c=new Array(o),l=new Array(o),u=("break-word"===t||"break-all"===t)&&isFinite(i)&&i>0,d=[0,0],h=[0,0];let f=0,p=0,g=0;for(let m=0;m<=o;m++){const y=s[m];if(("\n"===y||m===o)&&(g=m),g>p){const v=u?Mve(s,t,i,r,p,g):Ave;for(let _=0;_<=v.length;_++){const E=0===_?p:v[_-1],A=_<v.length?v[_]:g;Ive(s,E,A,r,a,h);for(let x=E;x<A;x++)c[x]=f+h[1]/2,l[x]=h[0];f+=h[1]*e,d[0]=Math.max(d[0],h[0])}p=g}"\n"===y&&(a[p]=0,c[p]=0,l[p]=0,p++)}return d[1]=f,{x:a,y:c,rowWidth:l,size:d}}class jH{constructor(e=5){w(this,"limit",void 0),w(this,"_cache",{}),w(this,"_order",[]),this.limit=e}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const t=this._order.indexOf(e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}const Qp={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function Rve(){const n=[];for(let e=32;e<128;e++)n.push(String.fromCharCode(e));return n}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1};let Xv=new jH(3);function Nve(n,e){for(let t=0;t<n.length;t++)e.data[4*t+3]=n[t]}function WH(n,e,t,i){n.font="".concat(i," ").concat(t,"px ").concat(e),n.fillStyle="#000",n.textBaseline="alphabetic",n.textAlign="left"}class Fve{constructor(){w(this,"props",{...Qp}),w(this,"_key",void 0),w(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return 1.2}setProps(e={}){Object.assign(this.props,e);const t=this._key;this._key=this._getKey();const i=function Pve(n,e){let t;t="string"==typeof e?new Set(Array.from(e)):new Set(e);const i=Xv.get(n);if(!i)return t;for(const r in i.mapping)t.has(r)&&t.delete(r);return t}(this._key,this.props.characterSet),r=Xv.get(this._key);if(r&&0===i.size)return void(this._key!==t&&(this._atlas=r));const s=this._generateFontAtlas(this._key,i,r);this._atlas=s,Xv.set(this._key,s)}_generateFontAtlas(e,t,i){const{fontFamily:r,fontWeight:s,fontSize:o,buffer:a,sdf:c,radius:l,cutoff:u}=this.props;let d=i&&i.data;d||(d=document.createElement("canvas"),d.width=1024);const h=d.getContext("2d");WH(h,r,o,s);const{mapping:f,canvasHeight:p,xOffset:g,yOffset:m}=function xve({characterSet:n,getFontWidth:e,fontHeight:t,buffer:i,maxCanvasWidth:r,mapping:s={},xOffset:o=0,yOffset:a=0}){let c=0,l=o;for(const d of n)if(!s[d]){const h=e(d);l+h+2*i>r&&(l=0,c++),s[d]={x:l+i,y:a+c*(t+2*i)+i,width:h,height:t},l+=h+2*i}const u=t+2*i;return{mapping:s,xOffset:l,yOffset:a+c*u,canvasHeight:Tve(a+(c+1)*u)}}({getFontWidth:y=>h.measureText(y).width,fontHeight:1.2*o,buffer:a,characterSet:t,maxCanvasWidth:1024,...i&&{mapping:i.mapping,xOffset:i.xOffset,yOffset:i.yOffset}});if(d.height!==p){const y=h.getImageData(0,0,d.width,d.height);d.height=p,h.putImageData(y,0,0)}if(WH(h,r,o,s),c){const y=new(Eve())(o,a,l,u,r,s),v=h.getImageData(0,0,y.size,y.size);for(const _ of t)Nve(y.draw(_),v),h.putImageData(v,f[_].x-a,f[_].y+a)}else for(const y of t)h.fillText(y,f[y].x,f[y].y+.9*o);return{xOffset:g,yOffset:m,mapping:f,data:d,width:d.width,height:d.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:i,buffer:r,sdf:s,radius:o,cutoff:a}=this.props;return s?"".concat(e," ").concat(t," ").concat(i," ").concat(r," ").concat(o," ").concat(a):"".concat(e," ").concat(t," ").concat(i," ").concat(r)}}const Vve={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:n=>n.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class XS extends Ol{constructor(...e){super(...e),w(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n\n  // convert size in meters to pixels, then scaled and clamp\n\n  // project meters to pixels and clamp to limits\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Apply opacity to instance color, or return instance picking color\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[$v,qv]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:t}=e;if(t.extensionsChanged){var i;const{gl:r}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:t,sizeScale:i,sizeUnits:r,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:c}=this.props;c.length<4&&(c=[c[0],c[1],c[0],c[1]]),this.state.model.setUniforms(e).setUniforms({billboard:t,stroked:!!a,padding:c,sizeUnits:gv[r],sizeScale:i,sizeMinPixels:s,sizeMaxPixels:o}).draw()}_getModel(e){return new qd(e,{...this.getShaders(),id:this.props.id,geometry:new _c({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}w(XS,"defaultProps",Vve),w(XS,"layerName","TextBackgroundLayer");const $H={start:1,middle:0,end:-1},qH={top:1,center:0,bottom:-1},YS=[0,0,0,255],Uve={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:YS},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:Qp.characterSet},fontFamily:Qp.fontFamily,fontWeight:Qp.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:YS},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:n=>n.text},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:YS},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class ZS extends WS{constructor(...e){super(...e),w(this,"state",void 0),w(this,"getBoundingRect",(t,i)=>{const r=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:c,getTextAnchor:l,getAlignmentBaseline:u}=this.props,d=s(t,i)||"",{size:[h,f]}=UH(d,c,o,a,r);return[($H["function"==typeof l?l(t,i):l]-1)*h/2,(qH["function"==typeof u?u(t,i):u]-1)*f/2,h,f]}),w(this,"getIconOffsets",(t,i)=>{const r=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:c,getTextAnchor:l,getAlignmentBaseline:u}=this.props,d=s(t,i)||"",{x:h,y:f,rowWidth:p,size:[g,m]}=UH(d,c,o,a,r),y=$H["function"==typeof l?l(t,i):l],v=qH["function"==typeof u?u(t,i):u],_=h.length,E=new Array(2*_);let A=0;for(let x=0;x<_;x++)E[A++]=(y-1)*g/2+(1-y)*(g-p[x])/2+h[x],E[A++]=(v-1)*m/2+f[x];return E})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new Fve}}updateState(e){const{props:t,oldProps:i,changeFlags:r}=e;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||t.lineHeight!==i.lineHeight||t.wordBreak!==i.wordBreak||t.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:t,fontWeight:i}=this.props,{fontAtlasManager:r,characterSet:s}=this.state,o={...e,characterSet:s,fontFamily:t,fontWeight:i};if(!r.mapping)return r.setProps(o),!0;for(const a in o)if(o[a]!==r.props[a])return r.setProps(o),!0;return!1}_updateText(){var e;const{data:t,characterSet:i}=this.props,r=null===(e=t.attributes)||void 0===e?void 0:e.getText;let a,{getText:s}=this.props,o=t.startIndices;const c="auto"===i&&new Set;if(r&&o){const{texts:l,characterCount:u}=function Dve({value:n,length:e,stride:t,offset:i,startIndices:r,characterSet:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:1,c=i?i/o:0,l=r[e]||Math.ceil((n.length-c)/a),u=s&&new Set,d=new Array(e);let h=n;if(a>1||c>0){h=new(0,n.constructor)(l);for(let p=0;p<l;p++)h[p]=n[p*a+c]}for(let f=0;f<e;f++){const m=h.subarray(r[f],r[f+1]||l);d[f]=String.fromCodePoint.apply(null,m),u&&m.forEach(u.add,u)}if(u)for(const f of u)s.add(String.fromCodePoint(f));return{texts:d,characterCount:l}}({...ArrayBuffer.isView(r)?{value:r}:r,length:t.length,startIndices:o,characterSet:c});a=u,s=(d,{index:h})=>l[h]}else{const{iterable:l,objectInfo:u}=Uv(t);o=[0],a=0;for(const d of l){u.index++;const h=Array.from(s(d,u)||"");c&&h.forEach(c.add,c),a+=h.length,o.push(a)}}this.setState({getText:s,startIndices:o,numInstances:a,characterSet:c||i})}renderLayers(){const{startIndices:e,numInstances:t,getText:i,fontAtlasManager:{scale:r,texture:s,mapping:o},styleVersion:a}=this.state,{data:c,_dataDiff:l,getPosition:u,getColor:d,getSize:h,getAngle:f,getPixelOffset:p,getBackgroundColor:g,getBorderColor:m,getBorderWidth:y,backgroundPadding:v,background:_,billboard:E,fontSettings:A,outlineWidth:x,outlineColor:I,sizeScale:S,sizeUnits:F,sizeMinPixels:U,sizeMaxPixels:V,transitions:G,updateTriggers:P}=this.props,L=this.getSubLayerClass("characters",qS),$=this.getSubLayerClass("background",XS);return[_&&new $({getFillColor:g,getLineColor:m,getLineWidth:y,padding:v,getPosition:u,getSize:h,getAngle:f,getPixelOffset:p,billboard:E,sizeScale:S/this.state.fontAtlasManager.props.fontSize,sizeUnits:F,sizeMinPixels:U,sizeMaxPixels:V,transitions:G&&{getPosition:G.getPosition,getAngle:G.getAngle,getSize:G.getSize,getFillColor:G.getBackgroundColor,getLineColor:G.getBorderColor,getLineWidth:G.getBorderWidth,getPixelOffset:G.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:P.getPosition,getAngle:P.getAngle,getSize:P.getSize,getFillColor:P.getBackgroundColor,getLineColor:P.getBorderColor,getLineWidth:P.getBorderWidth,getPixelOffset:P.getPixelOffset,getBoundingRect:{getText:P.getText,getTextAnchor:P.getTextAnchor,getAlignmentBaseline:P.getAlignmentBaseline,styleVersion:a}}}),{data:c.attributes&&c.attributes.background?{length:c.length,attributes:c.attributes.background}:c,_dataDiff:l,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new L({sdf:A.sdf,smoothing:Number.isFinite(A.smoothing)?A.smoothing:Qp.smoothing,outlineWidth:x,outlineColor:I,iconAtlas:s,iconMapping:o,getPosition:u,getColor:d,getSize:h,getAngle:f,getPixelOffset:p,billboard:E,sizeScale:S*r,sizeUnits:F,sizeMinPixels:U*r,sizeMaxPixels:V*r,transitions:G&&{getPosition:G.getPosition,getAngle:G.getAngle,getColor:G.getColor,getSize:G.getSize,getPixelOffset:G.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:P.getText,getPosition:P.getPosition,getAngle:P.getAngle,getColor:P.getColor,getSize:P.getSize,getPixelOffset:P.getPixelOffset,getIconOffsets:{getText:P.getText,getTextAnchor:P.getTextAnchor,getAlignmentBaseline:P.getAlignmentBaseline,styleVersion:a}}}),{data:c,_dataDiff:l,startIndices:e,numInstances:t,getIconOffsets:this.getIconOffsets,getIcon:i})]}static set fontAtlasCacheLimit(e){!function kve(n){ot.assert(Number.isFinite(n)&&n>=3,"Invalid cache limit"),Xv=new jH(n)}(e)}}w(ZS,"defaultProps",Uve),w(ZS,"layerName","TextLayer");const XH="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",jve={lightSources:{}};function KS(){let{color:n=[0,0,0],intensity:e=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.map(t=>t*e/255)}const JS={name:"lights",vs:XH,fs:XH,getUniforms:function YH(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jve;if("lightSources"in n){const{ambientLight:e,pointLights:t,directionalLights:i}=n.lightSources||{};return e||t&&t.length>0||i&&i.length>0?Object.assign({},function Hve(n){let{ambientLight:e,pointLights:t=[],directionalLights:i=[]}=n;const r={};return r["lighting_uAmbientLight.color"]=e?KS(e):[0,0,0],t.forEach((s,o)=>{r["lighting_uPointLight[".concat(o,"].color")]=KS(s),r["lighting_uPointLight[".concat(o,"].position")]=s.position,r["lighting_uPointLight[".concat(o,"].attenuation")]=s.attenuation||[1,0,0]}),r.lighting_uPointLightCount=t.length,i.forEach((s,o)=>{r["lighting_uDirectionalLight[".concat(o,"].color")]=KS(s),r["lighting_uDirectionalLight[".concat(o,"].direction")]=s.direction}),r.lighting_uDirectionalLightCount=i.length,r}({ambientLight:e,pointLights:t,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in n){const e={pointLights:[],directionalLights:[]};for(const t of n.lights||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights.push(t);break;case"point":e.pointLights.push(t)}return YH({lightSources:e})}return{}},defines:{MAX_LIGHTS:3}},zve={};const Wve={name:"phong-lighting",dependencies:[JS],fs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_FRAGMENT:1},getUniforms:function KH(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zve;if(!("material"in n))return{};const{material:e}=n;return e?function Gve(n){const{ambient:e=.35,diffuse:t=.6,shininess:i=32,specularColor:r=[30,30,30]}=n;return{lighting_uAmbient:e,lighting_uDiffuse:t,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}(e):{lighting_uEnabled:!1}}},QS=Math.PI/180,Yv=new Float32Array(16),JH=new Float32Array(12);function QH(n,e,t){const i=e[0]*QS,r=e[1]*QS,s=e[2]*QS,o=Math.sin(s),a=Math.sin(i),c=Math.sin(r),l=Math.cos(s),u=Math.cos(i),d=Math.cos(r),h=t[0],f=t[1],p=t[2];n[0]=h*d*u,n[1]=h*c*u,n[2]=h*-a,n[3]=f*(-c*l+d*a*o),n[4]=f*(d*l+c*a*o),n[5]=f*u*o,n[6]=p*(c*o+d*a*l),n[7]=p*(-d*o+c*a*l),n[8]=p*u*l}function ez(n){return n[0]=n[0],n[1]=n[1],n[2]=n[2],n[3]=n[4],n[4]=n[5],n[5]=n[6],n[6]=n[8],n[7]=n[9],n[8]=n[10],n[9]=n[12],n[10]=n[13],n[11]=n[14],n.subarray(0,12)}const tz={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(n,{startRow:e,endRow:t}){const{data:i,getOrientation:r,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,c=Array.isArray(a),l=c&&16===a.length,u=Array.isArray(s),d=Array.isArray(r),h=Array.isArray(o),f=l||!c&&!!a(i[0]);n.constant=f?l:d&&u&&h;const p=n.value;if(n.constant){let g;f?(Yv.set(a),g=ez(Yv)):(g=JH,QH(g,r,s),g.set(o,9)),n.value=new Float32Array(g)}else{let g=e*n.size;const{iterable:m,objectInfo:y}=Uv(i,e,t);for(const v of m){let _;y.index++,f?(Yv.set(l?a:a(v,y)),_=ez(Yv)):(_=JH,QH(_,d?r:r(v,y),u?s:s(v,y)),_.set(h?o:o(v,y),9)),p[g++]=_[0],p[g++]=_[1],p[g++]=_[2],p[g++]=_[3],p[g++]=_[4],p[g++]=_[5],p[g++]=_[6],p[g++]=_[7],p[g++]=_[8],p[g++]=_[9],p[g++]=_[10],p[g++]=_[11]}}}};function nz(n,e){return e===ut.CARTESIAN||e===ut.METER_OFFSETS||e===ut.DEFAULT&&!n.isGeospatial}function iz(n,e){(n.COLOR_0||n.colors)&&e||(n.colors={constant:!0,value:new Float32Array([1,1,1])}),ot.assert(n.positions||n.POSITION,'no "postions" or "POSITION" attribute in mesh')}function Xve(n,e){if(n.attributes)return iz(n.attributes,e),n instanceof _c?n:new _c(n);if(n.positions||n.POSITION)return iz(n,e),new _c({attributes:n});throw Error("Invalid mesh")}class eM extends Ol{constructor(...e){super(...e),w(this,"state",void 0)}getShaders(){const e=!et(this.context.gl),t={};return Cx(this.context.gl,"GLSL_DERIVATIVES")&&(t.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\n\n// Scale the model\nuniform float sizeScale;\nuniform bool composeModelMatrix;\n\n// Primitive attributes\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\n\n// Instance attributes\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\n\n// Outputs to fragment shader\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    // using instancePositions as world coordinates\n    // when using globe mode, this branch does not re-orient the model to align with the surface of the earth\n    // call project_normal before setting position to avoid rotation\n    normals_commonspace = project_normal(instanceModelMatrix * normals);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n    geometry.position = position_commonspace;\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n    geometry.position = position_commonspace;\n    normals_commonspace = project_normal(instanceModelMatrix * normals);\n  }\n\n  geometry.normal = normals_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n\n// NOTE(Tarek): This is necessary because\n// headless.gl reports the extension as\n// available but does not support it in\n// the shader.\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[$v,Wve,qv],transpileToGLSL100:e,defines:t})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:tz}),this.setState({emptyTexture:new xi(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:t,oldProps:i,changeFlags:r}=e;if(t.mesh!==i.mesh||r.extensionsChanged){var s;if(null===(s=this.state.model)||void 0===s||s.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const o=t.mesh.attributes||t.mesh;this.setState({hasNormals:!(!o.NORMAL&&!o.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==i.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:t}=this.context,{sizeScale:i,coordinateSystem:r,_instanced:s}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:i,composeModelMatrix:!s||nz(t,r),flatShading:!this.state.hasNormals}).draw()}getModel(e){const t=new qd(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:Xve(e,this.props._useMeshColors),isInstanced:!0}),{texture:i}=this.props,{emptyTexture:r}=this.state;return t.setUniforms({sampler:i||r,hasTexture:!!i}),t}setTexture(e){const{emptyTexture:t,model:i}=this.state;i&&i.setUniforms({sampler:e||t,hasTexture:!!e})}}w(eM,"defaultProps",{mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}}),w(eM,"layerName","SimpleMeshLayer");const rz={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[JS]};class Xd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t}=e;this.id=t||Er(this.constructor.name),this.display=!0,this.position=new Vi,this.rotation=new Vi,this.scale=new Vi(1,1,1),this.matrix=new Ge,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}getBounds(){return null}setPosition(e){return ne(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return ne(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return ne(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e){arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?this.matrix=e:this.matrix.copy(e)}setMatrixComponents(e){let{position:t,rotation:i,scale:r,update:s=!0}=e;return t&&this.setPosition(t),i&&this.setRotation(i),r&&this.setScale(r),s&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,i=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(i),this}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{position:t,rotation:i,scale:r}=e;return t&&this.setPosition(t),i&&this.setRotation(i),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(e,t){ne(e),t=t||this.matrix;const i=new Ge(e).multiplyRight(t),r=i.invert(),s=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:i,worldInverseMatrix:r,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class eg extends Xd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=Array.isArray(e)?{children:e}:e;const{children:t=[]}=e;ue.assert(t.every(i=>i instanceof Xd),"every child must an instance of ScenegraphNode"),super(e),this.children=t}add(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];for(const r of t)Array.isArray(r)?this.add(...r):this.children.push(r);return this}remove(e){const t=this.children,i=t.indexOf(e);return i>-1&&t.splice(i,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}getBounds(){const e=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse((t,i)=>{let{worldMatrix:r}=i;const s=t.getBounds();if(!s)return;const[o,a]=s,c=new Vi(o).add(a).divide([2,2,2]);r.transformAsPoint(c,c);const l=new Vi(a).subtract(o).divide([2,2,2]);r.transformAsVector(l,l);for(let u=0;u<8;u++){const d=new Vi(1&u?-1:1,2&u?-1:1,4&u?-1:1).multiply(l).add(c);for(let h=0;h<3;h++)e[0][h]=Math.min(e[0][h],d[h]),e[1][h]=Math.max(e[1][h],d[h])}}),Number.isFinite(e[0][0])?e:null}traverse(e){let{worldMatrix:t=new Ge}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=new Ge(t).multiplyRight(this.matrix);for(const r of this.children)r instanceof eg?r.traverse(e,{worldMatrix:i}):e(r,{worldMatrix:i})}}let Zv;class tM extends qV{static get ZERO(){return Zv||(Zv=new tM(0,0,0,0),Object.freeze(Zv)),Zv}constructor(e=0,t=0,i=0,r=0){super(-0,-0,-0,-0),oa(e)&&1===arguments.length?this.copy(e):(Rn.debug&&(qt(e),qt(t),qt(i),qt(r)),this[0]=e,this[1]=t,this[2]=i,this[3]=r)}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return Rn.debug&&(qt(e.x),qt(e.y),qt(e.z),qt(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=qt(e)}get w(){return this[3]}set w(e){this[3]=qt(e)}transform(e){return PT(this,this,e),this.check()}transformByMatrix3(e){return function Nce(n,e,t){const i=e[0],r=e[1],s=e[2];n[0]=t[0]*i+t[3]*r+t[6]*s,n[1]=t[1]*i+t[4]*r+t[7]*s,n[2]=t[2]*i+t[5]*r+t[8]*s,n[3]=e[3]}(this,this,e),this.check()}transformByMatrix2(e){return function Pce(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2],n[3]=e[3]}(this,this,e),this.check()}transformByQuaternion(e){return KV(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}function sz(){var n=new wr(4);return wr!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function oz(n,e,t){t*=.5;var i=Math.sin(t);return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=Math.cos(t),n}function az(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=t[0],c=t[1],l=t[2],u=t[3];return n[0]=i*u+o*a+r*l-s*c,n[1]=r*u+o*c+s*a-i*l,n[2]=s*u+o*l+i*c-r*a,n[3]=o*u-i*a-r*c-s*l,n}var lz=rU,ube=function(){var n=XV(),e=YV(1,0,0),t=YV(0,1,0);return function(i,r,s){var o=ZV(r,s);return o<-.999999?(sv(n,e,r),function bce(n){return Math.hypot(n[0],n[1],n[2])}(n)<1e-6&&sv(n,t,r),function Cce(n,e){var t=e[0],i=e[1],r=e[2],s=t*t+i*i+r*r;s>0&&(s=1/Math.sqrt(s)),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s}(n,n),oz(i,n,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(sv(n,r,s),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=1+o,function ule(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=i*o,n[2]=r*o,n[3]=s*o,n}(i,i))}}();sz(),sz(),function Zve(){var n=new wr(9);wr!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1}();const dbe=[0,0,0,1],fbe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},pbe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function hz(n){if(!n._animation){const e=pbe[n.componentType],t=fbe[n.type],i=t*n.count,{buffer:r,byteOffset:s}=n.bufferView.data,o=new e(r,s+(n.byteOffset||0),i);if(1===t)n._animation=Array.from(o);else{const a=[];for(let c=0;c<o.length;c+=t)a.push(Array.from(o.slice(c,c+t)));n._animation=a}}return n._animation}const gbe=new Ge,nM=new class hbe extends OT{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return function cz(n,e){var i,t=e[0]+e[4]+e[8];if(t>0)i=Math.sqrt(t+1),n[3]=.5*i,n[0]=(e[5]-e[7])*(i=.5/i),n[1]=(e[6]-e[2])*i,n[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),n[r]=.5*i,n[3]=(e[3*s+o]-e[3*o+s])*(i=.5/i),n[s]=(e[3*s+r]+e[3*r+s])*i,n[o]=(e[3*o+r]+e[3*r+o])*i}return n}(this,e),this.check()}fromAxisRotation(e,t){return oz(this,e,t),this.check()}identity(){return function Kve(n){n[0]=0,n[1]=0,n[2]=0,n[3]=1}(this),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=qt(e)}get y(){return this[1]}set y(e){this[1]=qt(e)}get z(){return this[2]}set z(e){this[2]=qt(e)}get w(){return this[3]}set w(e){this[3]=qt(e)}len(){return function cle(n){return Math.hypot(n[0],n[1],n[2],n[3])}(this)}lengthSquared(){return function lle(n){var e=n[0],t=n[1],i=n[2],r=n[3];return e*e+t*t+i*i+r*r}(this)}dot(e){return function dle(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]}(this,e)}rotationTo(e,t){return ube(this,e,t),this.check()}add(e){return function ale(n,e,t){n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3]}(this,this,e),this.check()}calculateW(){return function tbe(n,e){var t=e[0],i=e[1],r=e[2];n[0]=t,n[1]=i,n[2]=r,n[3]=Math.sqrt(Math.abs(1-t*t-i*i-r*r))}(this,this),this.check()}conjugate(){return function sbe(n,e){n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3]}(this,this),this.check()}invert(){return function rbe(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s,a=o?1/o:0;n[0]=-t*a,n[1]=-i*a,n[2]=-r*a,n[3]=s*a}(this,this),this.check()}lerp(e,t,i){return void 0===i?this.lerp(this,e,t):(function hle(n,e,t,i){var r=e[0],s=e[1],o=e[2],a=e[3];n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n[2]=o+i*(t[2]-o),n[3]=a+i*(t[3]-a)}(this,e,t,i),this.check())}multiplyRight(e){return az(this,this,e),this.check()}multiplyLeft(e){return az(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return function Jve(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),c=Math.cos(t);n[0]=i*c+o*a,n[1]=r*c+s*a,n[2]=s*c-r*a,n[3]=o*c-i*a}(this,this,e),this.check()}rotateY(e){return function Qve(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),c=Math.cos(t);n[0]=i*c-s*a,n[1]=r*c+o*a,n[2]=s*c+i*a,n[3]=o*c-r*a}(this,this,e),this.check()}rotateZ(e){return function ebe(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),c=Math.cos(t);n[0]=i*c+r*a,n[1]=r*c-i*a,n[2]=s*c+o*a,n[3]=o*c-s*a}(this,this,e),this.check()}scale(e){return lz(this,this,e),this.check()}slerp(e,t,i){let r,s,o;switch(arguments.length){case 1:({start:r=dbe,target:s,ratio:o}=e);break;case 2:r=this,s=e,o=t;break;default:r=e,s=t,o=i}return function Kv(n,e,t,i){var h,f,p,g,m,r=e[0],s=e[1],o=e[2],a=e[3],c=t[0],l=t[1],u=t[2],d=t[3];return(f=r*c+s*l+o*u+a*d)<0&&(f=-f,c=-c,l=-l,u=-u,d=-d),1-f>ho?(h=Math.acos(f),p=Math.sin(h),g=Math.sin((1-i)*h)/p,m=Math.sin(i*h)/p):(g=1-i,m=i),n[0]=g*r+m*c,n[1]=g*s+m*l,n[2]=g*o+m*u,n[3]=g*a+m*d,n}(this,r,s,o),this.check()}transformVector4(e,t=new tM){return function fle(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],c=t[2],l=t[3],u=l*i+a*s-c*r,d=l*r+c*i-o*s,h=l*s+o*r-a*i,f=-o*i-a*r-c*s;n[0]=u*l+f*-o+d*-c-h*-a,n[1]=d*l+f*-a+h*-o-u*-c,n[2]=h*l+f*-c+u*-a-d*-o,n[3]=e[3]}(t,e,this),rv(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}};class wbe{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const i=(e/1e3-this.startTime)*this.speed;this.channels.forEach(r=>{let{sampler:s,target:o,path:a}=r;(function bbe(n,e,t,i){let{input:r,interpolation:s,output:o}=e;const c=n%r[r.length-1],l=r.findIndex(f=>f>=c),u=Math.max(0,l-1);if(!Array.isArray(t[i]))switch(i){case"translation":t[i]=[0,0,0];break;case"rotation":t[i]=[0,0,0,1];break;case"scale":t[i]=[1,1,1];break;default:ue.warn("Bad animation path ".concat(i))()}ne(t[i].length===o[u].length);const d=r[u],h=r[l];switch(s){case"STEP":!function vbe(n,e,t){for(let i=0;i<t.length;i++)n[e][i]=t[i]}(t,i,o[u]);break;case"LINEAR":h>d&&function _be(n,e,t,i,r){if("rotation"===e){nM.slerp({start:t,target:i,ratio:r});for(let s=0;s<nM.length;s++)n[e][s]=nM[s]}else for(let s=0;s<t.length;s++)n[e][s]=r*i[s]+(1-r)*t[s]}(t,i,o[u],o[l],(c-d)/(h-d));break;case"CUBICSPLINE":h>d&&function ybe(n,e,t){let{p0:i,outTangent0:r,inTangent1:s,p1:o,tDiff:a,ratio:c}=t;for(let l=0;l<n[e].length;l++){const u=r[l]*a,d=s[l]*a;n[e][l]=(2*Math.pow(c,3)-3*Math.pow(c,2)+1)*i[l]+(Math.pow(c,3)-2*Math.pow(c,2)+c)*u+(-2*Math.pow(c,3)+3*Math.pow(c,2))*o[l]+(Math.pow(c,3)-Math.pow(c,2))*d}}(t,i,{p0:o[3*u+1],outTangent0:o[3*u+2],inTangent1:o[3*l+0],p1:o[3*l+1],tDiff:h-d,ratio:(c-d)/(h-d)});break;default:ue.warn("Interpolation ".concat(s," not supported"))()}})(i,s,o,a),function mbe(n,e){if(e.matrix.identity(),n.translation&&e.matrix.translate(n.translation),n.rotation){const t=gbe.fromQuaternion(n.rotation);e.matrix.multiplyRight(t)}n.scale&&e.matrix.scale(n.scale)}(o,o._node)})}}class Ebe{constructor(e){this.animations=e.animations.map((t,i)=>{const r=t.name||"Animation-".concat(i),s=t.samplers.map(a=>{let{input:c,interpolation:l="LINEAR",output:u}=a;return{input:hz(e.accessors[c]),interpolation:l,output:hz(e.accessors[u])}}),o=t.channels.map(a=>{let{sampler:c,target:l}=a;return{sampler:s[c],target:e.nodes[l.node],path:l.path}});return new wbe({name:r,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}class Cbe extends Xd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t),this.onBeforeRender=null,this.AfterRender=null,e instanceof qd?(this.model=e,this._setModelNodeProps(t)):this.model=new qd(e,t),this.bounds=null,this.managedResources=t.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}getBounds(){return this.bounds}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(e){this.model.setProps(e)}}class Abe{constructor(e,t){let{attributes:i,material:r,pbrDebug:s,imageBasedLightingEnvironment:o,lights:a,useTangents:c}=t;this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},Cx(e,"GLSL_TEXTURE_LOD")&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],o&&(this.uniforms.u_DiffuseEnvSampler=o.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=o.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=o.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),s&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(i.NORMAL,"HAS_NORMALS"),this.defineIfPresent(i.TANGENT&&c,"HAS_TANGENTS"),this.defineIfPresent(i.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(o,"USE_IBL"),this.defineIfPresent(a,"USE_LIGHTS"),this.defineIfPresent(s,"PBR_DEBUG"),r&&this.parseMaterial(r)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const c=new xi(this.gl,{id:e.name||e.id,parameters:{...r,...a},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...o});this.uniforms[t]=c,this.defineIfPresent(i,i),this.generatedTextures.push(c)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:i=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,i]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=!!e.unlit,e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(ue.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach(e=>e.delete())}}function fz(n,e){return et(n)?"#version 300 es\n".concat(e):e}const Mbe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ibe={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class Dbe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.options=Object.assign({},Ibe,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(i=>this.createScene(i))}createAnimator(){return Array.isArray(this.gltf.animations)?new Ebe(this.gltf):null}createScene(e){const i=(e.nodes||[]).map(s=>this.createNode(s));return new eg({id:e.name||e.id,children:i})}createNode(e){if(!e._node){const i=(e.children||[]).map(s=>this.createNode(s));e.mesh&&i.push(this.createMesh(e.mesh));const r=new eg({id:e.name||e.id,children:i});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){const s=(new Ge).fromQuaternion(e.rotation);r.matrix.multiplyRight(s)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}createMesh(e){if(!e._mesh){const i=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),r=new eg({id:e.name||e.id,children:i});e._mesh=r}return e._mesh}getVertexCount(e){ue.warn("getVertexCount() not found")()}createPrimitive(e,t,i){const r=function Sbe(n,e){const{id:t,drawMode:i,vertexCount:r,attributes:s,modelOptions:o}=e,a=new Abe(n,e);ue.info(4,"createGLTFModel defines: ",a.defines)();const c=[];c.push(...a.generatedTextures),c.push(...Object.values(s).map(u=>u.buffer));const l=new Cbe(n,{id:t,drawMode:i,vertexCount:r,modules:[rz],parameters:a.parameters,vs:fz(n,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:fz(n,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:c,...o,defines:{...a.defines,...o.defines}});return l.setProps({attributes:s}),l.setUniforms(a.uniforms),l}(this.gl,Object.assign({id:e.name||"".concat(i.name||i.id,"-primitive-").concat(t),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options));return r.bounds=[e.attributes.POSITION.min,e.attributes.POSITION.max],r}createAttributes(e,t){const i={};return Object.keys(e).forEach(r=>{i[r]=this.createAccessor(e[r],this.createBuffer(e[r],this.gl.ARRAY_BUFFER))}),t&&(i.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),ue.info(4,"glTF Attributes",{attributes:e,indices:t,generated:i})(),i}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:i}=e;return i.lumaBuffers||(i.lumaBuffers={}),i.lumaBuffers[t]||(i.lumaBuffers[t]=new Ut(this.gl,{id:"from-".concat(i.id),data:i.data||e.value,target:t})),i.lumaBuffers[t]}createAccessor(e,t){return new Cr({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:Mbe[e.type]})}createSampler(e){return e}needsPOT(){return!1}}var tg=at(435);const Nbe="3.2.13",iM={};function Pl(n){return rM.apply(this,arguments)}function rM(){return rM=Q(function*(n,e=null,t={}){return e&&(n=function kbe(n,e,t){if(n.startsWith("http"))return n;const i=t.modules||{};return i[n]?i[n]:gc?t.CDN?(mo(t.CDN.startsWith("http")),"".concat(t.CDN,"/").concat(e,"@").concat(Nbe,"/dist/libs/").concat(n)):Wx?"../src/libs/".concat(n):"modules/".concat(e,"/src/libs/").concat(n):"modules/".concat(e,"/dist/libs/").concat(n)}(n,e,t)),iM[n]=iM[n]||function Fbe(n){return sM.apply(this,arguments)}(n),yield iM[n]}),rM.apply(this,arguments)}function sM(){return sM=Q(function*(n){if(n.endsWith("wasm"))return yield(yield fetch(n)).arrayBuffer();if(!gc)try{return tg&&tg.requireFromFile&&(yield tg.requireFromFile(n))}catch{return null}return Wx?importScripts(n):function Lbe(n,e){if(!gc)return tg.requireFromString&&tg.requireFromString(n,e);if(Wx)return eval.call(mpe,n),null;const t=document.createElement("script");t.id=e;try{t.appendChild(document.createTextNode(n))}catch{t.text=n}return document.body.appendChild(t),null}(yield(yield fetch(n)).text(),n)}),sM.apply(this,arguments)}const Bbe="https://unpkg.com/@loaders.gl/textures@".concat("3.2.13","/dist/libs/basis_encoder.wasm"),Vbe="https://unpkg.com/@loaders.gl/textures@".concat("3.2.13","/dist/libs/basis_encoder.js");let oM,lM;function gz(n){return aM.apply(this,arguments)}function aM(){return aM=Q(function*(n){const e=n.modules||{};return e.basis?e.basis:(oM=oM||function Ube(n){return cM.apply(this,arguments)}(n),yield oM)}),aM.apply(this,arguments)}function cM(){return cM=Q(function*(n){let e=null,t=null;return[e,t]=yield Promise.all([yield Pl("basis_transcoder.js","textures",n),yield Pl("basis_transcoder.wasm","textures",n)]),e=e||globalThis.BASIS,yield function jbe(n,e){const t={};return e&&(t.wasmBinary=e),new Promise(i=>{n(t).then(r=>{const{BasisFile:s,initializeBasis:o}=r;o(),i({BasisFile:s})})})}(e,t)}),cM.apply(this,arguments)}function mz(n){return uM.apply(this,arguments)}function uM(){return uM=Q(function*(n){const e=n.modules||{};return e.basisEncoder?e.basisEncoder:(lM=lM||function Hbe(n){return dM.apply(this,arguments)}(n),yield lM)}),uM.apply(this,arguments)}function dM(){return dM=Q(function*(n){let e=null,t=null;return[e,t]=yield Promise.all([yield Pl(Vbe,"textures",n),yield Pl(Bbe,"textures",n)]),e=e||globalThis.BASIS,yield function zbe(n,e){const t={};return e&&(t.wasmBinary=e),new Promise(i=>{n(t).then(r=>{const{BasisFile:s,KTX2File:o,initializeBasis:a,BasisEncoder:c}=r;a(),i({BasisFile:s,KTX2File:o,BasisEncoder:c})})})}(e,t)}),dM.apply(this,arguments)}const Gbe=["","WEBKIT_","MOZ_"],_z={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let Jv=null;var hM,Qv,fM,eb,vz,pM,bz,wz;new Uint8Array([0]),function(n){n[n.NONE=0]="NONE",n[n.BASISLZ=1]="BASISLZ",n[n.ZSTD=2]="ZSTD",n[n.ZLIB=3]="ZLIB"}(hM||(hM={})),function(n){n[n.BASICFORMAT=0]="BASICFORMAT"}(Qv||(Qv={})),function(n){n[n.UNSPECIFIED=0]="UNSPECIFIED",n[n.ETC1S=163]="ETC1S",n[n.UASTC=166]="UASTC"}(fM||(fM={})),function(n){n[n.UNSPECIFIED=0]="UNSPECIFIED",n[n.SRGB=1]="SRGB"}(eb||(eb={})),function(n){n[n.UNSPECIFIED=0]="UNSPECIFIED",n[n.LINEAR=1]="LINEAR",n[n.SRGB=2]="SRGB",n[n.ITU=3]="ITU",n[n.NTSC=4]="NTSC",n[n.SLOG=5]="SLOG",n[n.SLOG2=6]="SLOG2"}(vz||(vz={})),function(n){n[n.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",n[n.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(pM||(pM={})),function(n){n[n.RGB=0]="RGB",n[n.RRR=3]="RRR",n[n.GGG=4]="GGG",n[n.AAA=15]="AAA"}(bz||(bz={})),function(n){n[n.RGB=0]="RGB",n[n.RGBA=3]="RGBA",n[n.RRR=4]="RRR",n[n.RRRG=5]="RRRG"}(wz||(wz={}));const Gr=[171,75,84,88,32,50,48,187,13,10,26,10],Zbe={etc1:{basisFormat:0,compressed:!0,format:36196},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:33776},bc3:{basisFormat:3,compressed:!0,format:33779},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:35840},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:35842},"astc-4x4":{basisFormat:10,compressed:!0,format:37808},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};function mM(){return mM=Q(function*(n,e){if("auto"===e.basis.containerFormat){if(function Ybe(n){const e=new Uint8Array(n);return!(e.byteLength<Gr.length||e[0]!==Gr[0]||e[1]!==Gr[1]||e[2]!==Gr[2]||e[3]!==Gr[3]||e[4]!==Gr[4]||e[5]!==Gr[5]||e[6]!==Gr[6]||e[7]!==Gr[7]||e[8]!==Gr[8]||e[9]!==Gr[9]||e[10]!==Gr[10]||e[11]!==Gr[11])}(n))return Az((yield mz(e)).KTX2File,n,e);const{BasisFile:t}=yield gz(e);return _M(t,n,e)}if("encoder"===e.basis.module){const t=yield mz(e);return"ktx2"===e.basis.containerFormat?Az(t.KTX2File,n,e):_M(t.BasisFile,n,e)}{const{BasisFile:i}=yield gz(e);return _M(i,n,e)}}),mM.apply(this,arguments)}function _M(n,e,t){const i=new n(new Uint8Array(e));try{if(!i.startTranscoding())throw new Error("Failed to start basis transcoding");const r=i.getNumImages(),s=[];for(let o=0;o<r;o++){const a=i.getNumLevels(o),c=[];for(let l=0;l<a;l++)c.push(Jbe(i,o,l,t));s.push(c)}return s}finally{i.close(),i.delete()}}function Jbe(n,e,t,i){const r=n.getImageWidth(e,t),s=n.getImageHeight(e,t),o=n.getHasAlpha(),{compressed:a,format:c,basisFormat:l}=Tz(i,o),u=n.getImageTranscodedSizeInBytes(e,t,l),d=new Uint8Array(u);if(!n.transcodeImage(d,e,t,l,0,0))throw new Error("failed to start Basis transcoding");return{width:r,height:s,data:d,compressed:a,format:c,hasAlpha:o}}function Az(n,e,t){const i=new n(new Uint8Array(e));try{if(!i.startTranscoding())throw new Error("failed to start KTX2 transcoding");const r=i.getLevels(),s=[];for(let o=0;o<r;o++){s.push(Qbe(i,o,t));break}return[s]}finally{i.close(),i.delete()}}function Qbe(n,e,t){const{alphaFlag:i,height:r,width:s}=n.getImageLevelInfo(e,0,0),{compressed:o,format:a,basisFormat:c}=Tz(t,i),l=n.getImageTranscodedSizeInBytes(e,0,0,c),u=new Uint8Array(l);if(!n.transcodeImage(u,e,0,0,c,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:s,height:r,data:u,compressed:o,hasAlpha:i,format:a}}function Tz(n,e){let t=n&&n.basis&&n.basis.format;return"auto"===t&&(t=xz()),"object"==typeof t&&(t=e?t.alpha:t.noAlpha),t=t.toLowerCase(),Zbe[t]}function xz(){const n=function Wbe(n){if(!Jv){n=n||function $be(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}()||void 0,Jv=new Set;for(const e of Gbe)for(const t in _z)n&&n.getExtension("".concat(e).concat(t))&&Jv.add(_z[t])}return Jv}();return n.has("astc")?"astc-4x4":n.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:n.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:n.has("etc1")?"etc1":n.has("etc2")?"etc2":"rgb565"}const e0e={name:"Basis",id:"basis",module:"textures",version:"3.2.13",worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}},parse:function Kbe(n,e){return mM.apply(this,arguments)}};function Nl(n,e){if(!n)throw new Error(e||"loader assertion failed.")}typeof self<"u"&&self,typeof window<"u"&&window,typeof global<"u"&&global,typeof document<"u"&&document;const nb=!("object"==typeof process&&"[object process]"===String(process)&&!process.browser),Sz=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:n0e}=(Sz&&parseFloat(Sz[1]),globalThis),yM=typeof Image<"u",vM=typeof ImageBitmap<"u",bM=!!nb||!!n0e;function Mz(n){const e=function Dz(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&n instanceof Image?"image":n&&"object"==typeof n&&n.data&&n.width&&n.height?"data":null}(n);if(!e)throw new Error("Not an image");return e}const s0e=/^data:image\/svg\+xml/,o0e=/\.svg((\?|#).*)?$/;function wM(n){return n&&(s0e.test(n)||o0e.test(n))}function Rz(n,e){if(wM(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}function Oz(n,e,t){return EM.apply(this,arguments)}function EM(){return EM=Q(function*(n,e,t){const i=function a0e(n,e){if(wM(e)){let i=(new TextDecoder).decode(n);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(i))}return Rz(n,e)}(n,t),r=self.URL||self.webkitURL,s="string"!=typeof i&&r.createObjectURL(i);try{return yield function c0e(n,e){return CM.apply(this,arguments)}(s||i,e)}finally{s&&r.revokeObjectURL(s)}}),EM.apply(this,arguments)}function CM(){return CM=Q(function*(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(yield t.decode(),t):yield new Promise((i,r)=>{try{t.onload=()=>i(t),t.onerror=s=>r(new Error("Could not load image ".concat(n,": ").concat(s)))}catch(s){r(s)}})}),CM.apply(this,arguments)}const l0e={};let Pz=!0;function AM(){return AM=Q(function*(n,e,t){let i;i=wM(t)?yield Oz(n,e,t):Rz(n,t);const r=e&&e.imagebitmap;return yield function d0e(n){return TM.apply(this,arguments)}(i,r)}),AM.apply(this,arguments)}function TM(){return TM=Q(function*(n,e=null){if((function h0e(n){for(const e in n||l0e)return!1;return!0}(e)||!Pz)&&(e=null),e)try{return yield createImageBitmap(n,e)}catch(t){console.warn(t),Pz=!1}return yield createImageBitmap(n)}),TM.apply(this,arguments)}const Co=!1,ig=!0;function xM(n){const e=rg(n);return function f0e(n){const e=rg(n);return e.byteLength>=24&&2303741511===e.getUint32(0,Co)?{mimeType:"image/png",width:e.getUint32(16,Co),height:e.getUint32(20,Co)}:null}(e)||function m0e(n){const e=rg(n);if(!(e.byteLength>=3&&65496===e.getUint16(0,Co)&&255===e.getUint8(2)))return null;const{tableMarkers:i,sofMarkers:r}=function _0e(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,Co);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Co),width:e.getUint16(s+7,Co)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,Co)}return null}(e)||function p0e(n){const e=rg(n);return e.byteLength>=10&&1195984440===e.getUint32(0,Co)?{mimeType:"image/gif",width:e.getUint16(6,ig),height:e.getUint16(8,ig)}:null}(e)||function g0e(n){const e=rg(n);return e.byteLength>=14&&16973===e.getUint16(0,Co)&&e.getUint32(2,ig)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,ig),height:e.getUint32(22,ig)}:null}(e)}function rg(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}function SM(){return SM=Q(function*(n,e){const{mimeType:t}=xM(n)||{},i=globalThis._parseImageNode;return Nl(i),yield i(n,t)}),SM.apply(this,arguments)}function MM(){return MM=Q(function*(n,e,t){const r=((e=e||{}).image||{}).type||"auto",{url:s}=t||{},o=function b0e(n){switch(n){case"auto":case"data":return function r0e(){if(vM)return"imagebitmap";if(yM)return"image";if(bM)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function i0e(n){switch(n){case"auto":return vM||yM||bM;case"imagebitmap":return vM;case"image":return yM;case"data":return bM;default:throw new Error("@loaders.gl/images: image ".concat(n," not supported in this environment"))}}(n),n}}(r);let a;switch(o){case"imagebitmap":a=yield function u0e(n,e,t){return AM.apply(this,arguments)}(n,e,s);break;case"image":a=yield Oz(n,e,s);break;case"data":a=yield function y0e(n,e){return SM.apply(this,arguments)}(n,e);break;default:Nl(!1)}return"data"===r&&(a=function Iz(n){switch(Mz(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}(a)),a}),MM.apply(this,arguments)}const w0e={id:"image",module:"images",name:"Images",version:"3.2.13",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function v0e(n,e,t){return MM.apply(this,arguments)},tests:[n=>!!xM(new DataView(n))],options:{image:{type:"auto",decode:!0}}};function Nz(n,e,t){if(n.byteLength<=e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function kz(n,e,t){const i=void 0!==t?new Uint8Array(n).subarray(e,e+t):new Uint8Array(n).subarray(e);return new Uint8Array(i).buffer}function Wr(n,e){if(!n)throw new Error(e||"assert failed: gltf")}function Fz(n,e){if(n.startsWith("data:")||n.startsWith("http:")||n.startsWith("https:"))return n;const i=e.baseUri||e.uri;if(!i)throw new Error("'baseUri' must be provided to resolve relative url ".concat(n));return i.substr(0,i.lastIndexOf("/")+1)+n}function sg(n,e){return Nl(n>=0),Nl(e>0),n+(e-1)&~(e-1)}function A0e(n,e,t){let i;return i=n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer||n.arrayBuffer,n.byteOffset,n.byteLength),e.set(i,t),t+sg(i.byteLength,4)}const Bz=["SCALAR","VEC2","VEC3","VEC4"],T0e=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],x0e=new Map(T0e),S0e={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},M0e={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},I0e={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Vz(n){return Bz[n-1]||Bz[0]}function Uz(n){const e=x0e.get(n.constructor);if(!e)throw new Error("Illegal typed array");return e}function jz(n,e){const t=I0e[n.componentType],i=S0e[n.type],s=n.count*i,o=n.count*i*M0e[n.componentType];return Wr(o>=0&&o<=e.byteLength),{ArrayType:t,length:s,byteLength:o}}const D0e={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class ds{constructor(e){w(this,"gltf",void 0),w(this,"sourceBuffers",void 0),w(this,"byteLength",void 0),this.gltf=e||{json:{...D0e},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){return this.getUsedExtensions().find(r=>r===e)?(this.json.extensions||{})[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(i=>i===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];if(!i)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(t,"]"));return i}getTypedArrayForBufferView(e){e=this.getBufferView(e);const i=this.gltf.buffers[e.buffer];return Wr(i),new Uint8Array(i.arrayBuffer,(e.byteOffset||0)+i.byteOffset,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data,{ArrayType:s,length:o}=jz(e,t);return new s(r,t.byteOffset+e.byteOffset,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data;return new Uint8Array(r,t.byteOffset||0,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,i){return e.extensions=e.extensions||{},e.extensions[t]=i,this.registerUsedExtension(t),this}setObjectExtension(e,t,i){(e.extensions||{})[t]=i}removeObjectExtension(e,t){const i=e.extensions||{},r=i[t];return delete i[t],r}addExtension(e,t={}){return Wr(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e,t={}){return Wr(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(t=>t===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(t=>t===e)||this.json.extensionsRequired.push(e)}removeExtension(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:i}=e;this.json.nodes=this.json.nodes||[];const r={mesh:t};return i&&(r.matrix=i),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:i,material:r,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(i){const c=this._addIndices(i);a.primitives[0].indices=c}return Number.isFinite(r)&&(a.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const i={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}addImage(e,t){const i=xM(e),r=t||i?.mimeType,o={bufferView:this.addBufferView(e),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const t=e.byteLength;Wr(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const i={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=sg(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(e,t){const i={bufferView:e,type:Vz(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(i),this.json.accessors.length-1}addBinaryBuffer(e,t={size:3}){const i=this.addBufferView(e);let r={min:t.min,max:t.max};(!r.min||!r.max)&&(r=this._getAccessorMinMax(e,t.size));const s={size:t.size,componentType:Uz(e),count:Math.round(e.length/t.size),min:r.min,max:r.max};return this.addAccessor(i,Object.assign(s,t))}addTexture(e){const{imageIndex:t}=e,i={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(i),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;this.gltf.buffers=[];const i=this.byteLength,r=new ArrayBuffer(i),s=new Uint8Array(r);let o=0;for(const a of this.sourceBuffers||[])o=A0e(a,s,o);null!==(e=this.json)&&void 0!==e&&null!==(t=e.buffers)&&void 0!==t&&t[0]?this.json.buffers[0].byteLength=i:this.json.buffers=[{byteLength:i}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(e,t){let i=!0;for(;i;){const r=e.indexOf(t);r>-1?e.splice(r,1):i=!1}}_addAttributes(e={}){const t={};for(const i in e){const r=e[i],s=this._getGltfAttributeName(i),o=this.addBinaryBuffer(r.value,r);t[s]=o}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const i={min:null,max:null};if(e.length<t)return i;i.min=[],i.max=[];const r=e.subarray(0,t);for(const s of r)i.min.push(s),i.max.push(s);for(let s=t;s<e.length;s+=t)for(let o=0;o<t;o++)i.min[0+o]=Math.min(i.min[0+o],e[s+o]),i.max[0+o]=Math.max(i.max[0+o],e[s+o]);return i}}const O0e="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",P0e="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",N0e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),k0e=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),Hz={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},F0e={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};function OM(){return OM=Q(function*(n,e,t,i,r,s="NONE"){const o=yield function ib(){return NM.apply(this,arguments)}();!function rb(n,e,t,i,r,s,o){const a=n.exports.sbrk,c=i+3&-4,l=a(c*r),u=a(s.length),d=new Uint8Array(n.exports.memory.buffer);d.set(s,u);const h=e(l,i,r,u,s.length);if(0===h&&o&&o(l,c,r),t.set(d.subarray(l,l+i*r)),a(l-a(0)),0!==h)throw new Error("Malformed buffer data: ".concat(h))}(o,o.exports[F0e[r]],n,e,t,i,o.exports[Hz[s||"NONE"]])}),OM.apply(this,arguments)}let PM;function NM(){return NM=Q(function*(){return PM||(PM=function B0e(){return kM.apply(this,arguments)}()),PM}),NM.apply(this,arguments)}function kM(){return kM=Q(function*(){let n=O0e;WebAssembly.validate(N0e)&&(n=P0e,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const e=yield WebAssembly.instantiate(function V0e(n){const e=new Uint8Array(n.length);for(let i=0;i<n.length;++i){const r=n.charCodeAt(i);e[i]=r>96?r-71:r>64?r-65:r>47?r+4:r>46?63:62}let t=0;for(let i=0;i<n.length;++i)e[t++]=e[i]<60?k0e[e[i]]:64*(e[i]-60)+e[++i];return e.buffer.slice(0,t)}(n),{});return yield e.instance.exports.__wasm_call_ctors(),e.instance}),kM.apply(this,arguments)}const FM="EXT_meshopt_compression",U0e=FM;function j0e(n,e){return LM.apply(this,arguments)}function LM(){return LM=Q(function*(n,e){var t;const i=new ds(n);if(null==e||null===(t=e.gltf)||void 0===t||!t.decompressMeshes)return;const r=[];for(const s of n.json.bufferViews||[])r.push(H0e(i,s));yield Promise.all(r),i.removeExtension(FM)}),LM.apply(this,arguments)}function H0e(n,e){return BM.apply(this,arguments)}function BM(){return BM=Q(function*(n,e){const t=n.getObjectExtension(e,FM);if(t){const{byteOffset:i=0,byteLength:r=0,byteStride:s,count:o,mode:a,filter:c="NONE",buffer:l}=t,u=n.gltf.buffers[l],d=new Uint8Array(u.arrayBuffer,u.byteOffset+i,r),h=new Uint8Array(n.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);return yield function L0e(n,e,t,i,r){return OM.apply(this,arguments)}(h,o,s,d,a,c),h}return null}),BM.apply(this,arguments)}const z0e=["image/png","image/jpeg","image/gif"],VM={};const Zd="EXT_texture_webp",q0e=Zd;function X0e(n,e){const t=new ds(n);if(!function G0e(n){return void 0===VM[n]&&(VM[n]=function W0e(n){switch(n){case"image/webp":return function $0e(){if(!nb)return!1;try{return 0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")}catch{return!1}}();case"image/svg":return nb;default:if(!nb){const{_parseImageNode:e}=globalThis;return!!e&&z0e.includes(n)}return!0}}(n)),VM[n]}("image/webp")){if(t.getRequiredExtensions().includes(Zd))throw new Error("gltf: Required extension ".concat(Zd," not supported by browser"));return}const{json:i}=t;for(const r of i.textures||[]){const s=t.getObjectExtension(r,Zd);s&&(r.source=s.source),t.removeObjectExtension(r,Zd)}t.removeExtension(Zd)}const sb="KHR_texture_basisu",Y0e=sb;function Z0e(n,e){const t=new ds(n),{json:i}=t;for(const r of i.textures||[]){const s=t.getObjectExtension(r,sb);s&&(r.source=s.source),t.removeObjectExtension(r,sb)}t.removeExtension(sb)}const Gz={name:"Draco",id:"draco",module:"draco",shapes:["mesh"],version:"3.2.13",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};class ob{constructor(e,t,i=!1,r=new Map){w(this,"name",void 0),w(this,"type",void 0),w(this,"nullable",void 0),w(this,"metadata",void 0),this.name=e,this.type=t,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new ob(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let _t,Wz,$z,qz,Xz,Yz,Zz,Kz,Jz;!function(n){n[n.NONE=0]="NONE",n[n.Null=1]="Null",n[n.Int=2]="Int",n[n.Float=3]="Float",n[n.Binary=4]="Binary",n[n.Utf8=5]="Utf8",n[n.Bool=6]="Bool",n[n.Decimal=7]="Decimal",n[n.Date=8]="Date",n[n.Time=9]="Time",n[n.Timestamp=10]="Timestamp",n[n.Interval=11]="Interval",n[n.List=12]="List",n[n.Struct=13]="Struct",n[n.Union=14]="Union",n[n.FixedSizeBinary=15]="FixedSizeBinary",n[n.FixedSizeList=16]="FixedSizeList",n[n.Map=17]="Map",n[n.Dictionary=-1]="Dictionary",n[n.Int8=-2]="Int8",n[n.Int16=-3]="Int16",n[n.Int32=-4]="Int32",n[n.Int64=-5]="Int64",n[n.Uint8=-6]="Uint8",n[n.Uint16=-7]="Uint16",n[n.Uint32=-8]="Uint32",n[n.Uint64=-9]="Uint64",n[n.Float16=-10]="Float16",n[n.Float32=-11]="Float32",n[n.Float64=-12]="Float64",n[n.DateDay=-13]="DateDay",n[n.DateMillisecond=-14]="DateMillisecond",n[n.TimestampSecond=-15]="TimestampSecond",n[n.TimestampMillisecond=-16]="TimestampMillisecond",n[n.TimestampMicrosecond=-17]="TimestampMicrosecond",n[n.TimestampNanosecond=-18]="TimestampNanosecond",n[n.TimeSecond=-19]="TimeSecond",n[n.TimeMillisecond=-20]="TimeMillisecond",n[n.TimeMicrosecond=-21]="TimeMicrosecond",n[n.TimeNanosecond=-22]="TimeNanosecond",n[n.DenseUnion=-23]="DenseUnion",n[n.SparseUnion=-24]="SparseUnion",n[n.IntervalDayTime=-25]="IntervalDayTime",n[n.IntervalYearMonth=-26]="IntervalYearMonth"}(_t||(_t={}));class hs{static isNull(e){return e&&e.typeId===_t.Null}static isInt(e){return e&&e.typeId===_t.Int}static isFloat(e){return e&&e.typeId===_t.Float}static isBinary(e){return e&&e.typeId===_t.Binary}static isUtf8(e){return e&&e.typeId===_t.Utf8}static isBool(e){return e&&e.typeId===_t.Bool}static isDecimal(e){return e&&e.typeId===_t.Decimal}static isDate(e){return e&&e.typeId===_t.Date}static isTime(e){return e&&e.typeId===_t.Time}static isTimestamp(e){return e&&e.typeId===_t.Timestamp}static isInterval(e){return e&&e.typeId===_t.Interval}static isList(e){return e&&e.typeId===_t.List}static isStruct(e){return e&&e.typeId===_t.Struct}static isUnion(e){return e&&e.typeId===_t.Union}static isFixedSizeBinary(e){return e&&e.typeId===_t.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===_t.FixedSizeList}static isMap(e){return e&&e.typeId===_t.Map}static isDictionary(e){return e&&e.typeId===_t.Dictionary}get typeId(){return _t.NONE}compareTo(e){return this===e}}Symbol,Symbol,Wz=Symbol.toStringTag;class yc extends hs{constructor(e,t){super(),w(this,"isSigned",void 0),w(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=t}get typeId(){return _t.Int}get[Wz](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class J0e extends yc{constructor(){super(!0,8)}}class Q0e extends yc{constructor(){super(!0,16)}}class ewe extends yc{constructor(){super(!0,32)}}class twe extends yc{constructor(){super(!1,8)}}class nwe extends yc{constructor(){super(!1,16)}}class iwe extends yc{constructor(){super(!1,32)}}$z=Symbol.toStringTag;class jM extends hs{constructor(e){super(),w(this,"precision",void 0),this.precision=e}get typeId(){return _t.Float}get[$z](){return"Float"}toString(){return"Float".concat(this.precision)}}class rwe extends jM{constructor(){super(32)}}class swe extends jM{constructor(){super(64)}}Symbol,Symbol,qz=Symbol.toStringTag,Xz=Symbol.toStringTag,Yz=Symbol.toStringTag,Zz=Symbol.toStringTag,Kz=Symbol.toStringTag;class owe extends hs{constructor(e,t){super(),w(this,"listSize",void 0),w(this,"children",void 0),this.listSize=e,this.children=[t]}get typeId(){return _t.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[Kz](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}Jz=Symbol.toStringTag;class Kd{constructor(e,t){w(this,"fields",void 0),w(this,"metadata",void 0),function uwe(n,e){if(!n)throw new Error(e||"loader assertion failed.")}(Array.isArray(e)),function dwe(n){const e={};for(const t of n)e[t.name]&&console.warn("Schema: duplicated field name",t.name,t),e[t.name]=!0}(e),this.fields=e,this.metadata=t||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let t=0;t<this.fields.length;++t)if(!this.fields[t].compareTo(e.fields[t]))return!1;return!0}select(...e){const t=Object.create(null);for(const r of e)t[r]=!0;const i=this.fields.filter(r=>t[r.name]);return new Kd(i,this.metadata)}selectAt(...e){const t=e.map(i=>this.fields[i]).filter(Boolean);return new Kd(t,this.metadata)}assign(e){let t,i=this.metadata;if(e instanceof Kd){const o=e;t=o.fields,i=iG(iG(new Map,this.metadata),o.metadata)}else t=e;const r=Object.create(null);for(const o of this.fields)r[o.name]=o;for(const o of t)r[o.name]=o;const s=Object.values(r);return new Kd(s,i)}}function iG(n,e){return new Map([...n||new Map,...e||new Map])}function rG(n,e,t){return function nG(n,e,t){const i=function awe(n){switch(n.constructor){case Int8Array:return new J0e;case Uint8Array:return new twe;case Int16Array:return new Q0e;case Uint16Array:return new nwe;case Int32Array:return new ewe;case Uint32Array:return new iwe;case Float32Array:return new rwe;case Float64Array:return new swe;default:throw new Error("array type not supported")}}(e.value),r=t||function lwe(n){const e=new Map;return"byteOffset"in n&&e.set("byteOffset",n.byteOffset.toString(10)),"byteStride"in n&&e.set("byteStride",n.byteStride.toString(10)),"normalized"in n&&e.set("normalized",n.normalized.toString()),e}(e);return new ob(n,new owe(e.size,new ob("value",i)),!1,r)}(n,e,t?sG(t.metadata):void 0)}function sG(n){const e=new Map;for(const t in n)e.set("".concat(t,".string"),JSON.stringify(n[t]));return e}const oG={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},pwe={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class mwe{constructor(e){w(this,"draco",void 0),w(this,"decoder",void 0),w(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,t={}){const i=new this.draco.DecoderBuffer;i.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const r=this.decoder.GetEncodedGeometryType(i),s=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(r){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(i,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(i,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const h="DRACO decompression failed: ".concat(o.error_msg());throw new Error(h)}const a=this._getDracoLoaderData(s,r,t),c=this._getMeshData(s,a,t),l=function K0e(n){let e=1/0,t=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;const a=n.POSITION?n.POSITION.value:[],c=a&&a.length;for(let l=0;l<c;l+=3){const u=a[l],d=a[l+1],h=a[l+2];e=u<e?u:e,t=d<t?d:t,i=h<i?h:i,r=u>r?u:r,s=d>s?d:s,o=h>o?h:o}return[[e,t,i],[r,s,o]]}(c.attributes),u=function hwe(n,e,t){const i=sG(e.metadata),r=[],s=function fwe(n){const e={};for(const t in n){const i=n[t];e[i.name||"undefined"]=i}return e}(e.attributes);for(const o in n){const c=rG(o,n[o],s[o]);r.push(c)}if(t){const o=rG("indices",t);r.push(o)}return new Kd(r,i)}(c.attributes,a,c.indices);return{loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:l},...c,schema:u}}finally{this.draco.destroy(i),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,t,i){const r=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,i);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:r,attributes:s}}_getDracoAttributes(e,t){const i={};for(let r=0;r<e.num_attributes();r++){const s=this.decoder.GetAttribute(e,r),o=this._getAttributeMetadata(e,r);i[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:r,metadata:o};const a=this._getQuantizationTransform(s,t);a&&(i[s.unique_id()].quantization_transform=a);const c=this._getOctahedronTransform(s,t);c&&(i[s.unique_id()].octahedron_transform=c)}return i}_getMeshData(e,t,i){const r=this._getMeshAttributes(t,e,i);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");return e instanceof this.draco.Mesh?"triangle-strip"===i.topology?{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(e),size:1}}:{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(e),size:1}}:{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(e,t,i){const r={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,i);s.name=o;const{value:a,size:c}=this._getAttributeValues(t,s);r[o]={value:a,size:c,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return r}_getTriangleListIndices(e){const i=3*e.num_faces(),r=4*i,s=this.draco._malloc(r);try{return this.decoder.GetTrianglesUInt32Array(e,r,s),new Uint32Array(this.draco.HEAPF32.buffer,s,i).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),function vwe(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const i=pwe[t.data_type],r=t.num_components,o=e.num_points()*r,a=o*i.BYTES_PER_ELEMENT,c=function _we(n,e){switch(e){case Float32Array:return n.DT_FLOAT32;case Int8Array:return n.DT_INT8;case Int16Array:return n.DT_INT16;case Int32Array:return n.DT_INT32;case Uint8Array:return n.DT_UINT8;case Uint16Array:return n.DT_UINT16;case Uint32Array:return n.DT_UINT32;default:return n.DT_INVALID}}(this.draco,i);let l;const u=this.draco._malloc(a);try{const d=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,d,c,a,u),l=new i(this.draco.HEAPF32.buffer,u,o).slice()}finally{this.draco._free(u)}return{value:l,size:r}}_deduceAttributeName(e,t){const i=e.unique_id;for(const[o,a]of Object.entries(t.extraAttributes||{}))if(a===i)return o;const r=e.attribute_type;for(const o in oG)if(this.draco[o]===r)return oG[o];const s=t.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:"CUSTOM_ATTRIBUTE_".concat(i)}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const i=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(i)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},i=this.metadataQuerier.NumEntries(e);for(let r=0;r<i;r++){const s=this.metadataQuerier.GetEntryName(e,r);t[s]=this._getDracoMetadataField(e,s)}return t}_getDracoMetadataField(e,t){const i=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,i);const r=function ywe(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(i);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:r}}finally{this.draco.destroy(i)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:i=[]}=e,r=[...t,...i];for(const s of r)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,t){const{quantizedAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}const cb="1.4.1",bwe="https://www.gstatic.com/draco/versioned/decoders/".concat(cb,"/draco_decoder.js"),wwe="https://www.gstatic.com/draco/versioned/decoders/".concat(cb,"/draco_wasm_wrapper.js"),Ewe="https://www.gstatic.com/draco/versioned/decoders/".concat(cb,"/draco_decoder.wasm");let og;function GM(){return GM=Q(function*(n){const e=n.modules||{};return og=e.draco3d?og||e.draco3d.createDecoderModule({}).then(t=>({draco:t})):og||function Twe(n){return $M.apply(this,arguments)}(n),yield og}),GM.apply(this,arguments)}function $M(){return $M=Q(function*(n){let e,t;return"js"===(n.draco&&n.draco.decoderType)?e=yield Pl(bwe,"draco",n):[e,t]=yield Promise.all([yield Pl(wwe,"draco",n),yield Pl(Ewe,"draco",n)]),e=e||globalThis.DracoDecoderModule,yield function xwe(n,e){const t={};return e&&(t.wasmBinary=e),new Promise(i=>{n({...t,onModuleLoaded:r=>i({draco:r})})})}(e,t)}),$M.apply(this,arguments)}"https://raw.githubusercontent.com/google/draco/".concat(cb,"/javascript/draco_encoder.js");const XM={...Gz,parse:function Mwe(n,e){return YM.apply(this,arguments)}};function YM(){return YM=Q(function*(n,e){const{draco:t}=yield function Awe(n){return GM.apply(this,arguments)}(e),i=new mwe(t);try{return i.parseSync(n,e?.draco)}finally{i.destroy()}}),YM.apply(this,arguments)}function aG(n){const{buffer:e,size:t,count:i}=function Dwe(n){let e=n,t=1,i=0;return n&&n.value&&(e=n.value,t=n.size||1),e&&(ArrayBuffer.isView(e)||(e=function Rwe(n,e,t=!1){return n?Array.isArray(n)?new e(n):!t||n instanceof e?n:new e(n):null}(e,Float32Array)),i=e.length/t),{buffer:e,size:t,count:i}}(n);return{value:e,size:t,byteOffset:0,count:i,type:Vz(t),componentType:Uz(e)}}const kl="KHR_draco_mesh_compression",Owe=kl;function Pwe(n,e,t){const i=new ds(n);for(const r of cG(i))i.getObjectExtension(r,kl)}function Nwe(n,e,t){return ZM.apply(this,arguments)}function ZM(){return ZM=Q(function*(n,e,t){var i;if(null==e||null===(i=e.gltf)||void 0===i||!i.decompressMeshes)return;const r=new ds(n),s=[];for(const o of cG(r))r.getObjectExtension(o,kl)&&s.push(Fwe(r,o,e,t));yield Promise.all(s),r.removeExtension(kl)}),ZM.apply(this,arguments)}function kwe(n,e={}){const t=new ds(n);for(const i of t.json.meshes||[])Lwe(i),t.addRequiredExtension(kl)}function Fwe(n,e,t,i){return KM.apply(this,arguments)}function KM(){return KM=Q(function*(n,e,t,i){const r=n.getObjectExtension(e,kl);if(!r)return;const s=n.getTypedArrayForBufferView(r.bufferView),o=kz(s.buffer,s.byteOffset),{parse:a}=i,c={...t};delete c["3d-tiles"];const l=yield a(o,XM,c,i),u=function Iwe(n){const e={};for(const t in n)if("indices"!==t){const r=aG(n[t]);e[t]=r}return e}(l.attributes);for(const[d,h]of Object.entries(u))if(d in e.attributes){const p=n.getAccessor(e.attributes[d]);null!=p&&p.min&&null!=p&&p.max&&(h.min=p.min,h.max=p.max)}e.attributes=u,l.indices&&(e.indices=aG(l.indices)),function Bwe(n){if(!n.attributes&&Object.keys(n.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}(e)}),KM.apply(this,arguments)}function Lwe(n,e,t=4,i,r){var s;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=i.DracoWriter.encodeSync({attributes:n}),a=null==r||null===(s=r.parseSync)||void 0===s?void 0:s.call(r,{attributes:n}),c=i._addFauxAttributes(a.attributes),l=i.addBufferView(o);return{primitives:[{attributes:c,mode:t,extensions:{[kl]:{bufferView:l,attributes:c}}}]}}function*cG(n){for(const e of n.json.meshes||[])for(const t of e.primitives)yield t}const Fl="KHR_lights_punctual",Vwe=Fl;function Uwe(n){return JM.apply(this,arguments)}function JM(){return JM=Q(function*(n){const e=new ds(n),{json:t}=e,i=e.getExtension(Fl);i&&(e.json.lights=i.lights,e.removeExtension(Fl));for(const r of t.nodes||[]){const s=e.getObjectExtension(r,Fl);s&&(r.light=s.light),e.removeObjectExtension(r,Fl)}}),JM.apply(this,arguments)}function jwe(n){return QM.apply(this,arguments)}function QM(){return QM=Q(function*(n){const e=new ds(n),{json:t}=e;if(t.lights){const i=e.addExtension(Fl);Wr(!i.lights),i.lights=t.lights,delete t.lights}if(e.json.lights){for(const i of e.json.lights)e.addObjectExtension(i.node,Fl,i);delete e.json.lights}}),QM.apply(this,arguments)}const cg="KHR_materials_unlit",Hwe=cg;function zwe(n){return eI.apply(this,arguments)}function eI(){return eI=Q(function*(n){const e=new ds(n),{json:t}=e;e.removeExtension(cg);for(const i of t.materials||[])i.extensions&&i.extensions.KHR_materials_unlit&&(i.unlit=!0),e.removeObjectExtension(i,cg)}),eI.apply(this,arguments)}function Gwe(n){const e=new ds(n),{json:t}=e;if(e.materials)for(const i of t.materials||[])i.unlit&&(delete i.unlit,e.addObjectExtension(i,cg,{}),e.addExtension(cg))}const lg="KHR_techniques_webgl",Wwe=lg;function $we(n){return tI.apply(this,arguments)}function tI(){return tI=Q(function*(n){const e=new ds(n),{json:t}=e,i=e.getExtension(lg);if(i){const r=function Xwe(n,e){const{programs:t=[],shaders:i=[],techniques:r=[]}=n,s=new TextDecoder;return i.forEach(o=>{if(!Number.isFinite(o.bufferView))throw new Error("KHR_techniques_webgl: no shader code");o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView))}),t.forEach(o=>{o.fragmentShader=i[o.fragmentShader],o.vertexShader=i[o.vertexShader]}),r.forEach(o=>{o.program=t[o.program]}),r}(i,e);for(const s of t.materials||[]){const o=e.getObjectExtension(s,lg);o&&(s.technique=Object.assign({},o,r[o.technique]),s.technique.values=Ywe(s.technique,e)),e.removeObjectExtension(s,lg)}e.removeExtension(lg)}}),tI.apply(this,arguments)}function qwe(n,e){return nI.apply(this,arguments)}function nI(){return(nI=Q(function*(n,e){})).apply(this,arguments)}function Ywe(n,e){const t=Object.assign({},n.values);return Object.keys(n.uniforms||{}).forEach(i=>{n.uniforms[i].value&&!(i in t)&&(t[i]=n.uniforms[i].value)}),Object.keys(t).forEach(i=>{"object"==typeof t[i]&&void 0!==t[i].index&&(t[i].texture=e.getTexture(t[i].index))}),t}const lG=[yn,zt,hn,si,ve,vt,Se];function iI(){return iI=Q(function*(n,e={},t){const i=lG.filter(s=>uG(s.name,e));for(const s of i){var r;yield null===(r=s.decode)||void 0===r?void 0:r.call(s,n,e,t)}}),iI.apply(this,arguments)}function uG(n,e){var t;const i=(null==e||null===(t=e.gltf)||void 0===t?void 0:t.excludeExtensions)||{};return!(n in i&&!i[n])}const rI="KHR_binary_glTF",dG={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},Qwe={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class eEe{constructor(){w(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),w(this,"json",void 0)}normalize(e,t){this.json=e.json;const i=e.json;switch(i.asset&&i.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn("glTF: Unknown version ".concat(i.asset.version))}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(i),this._convertTopLevelObjectsToArrays(i),function Jwe(n){const e=new ds(n),{json:t}=e;for(const i of t.images||[]){const r=e.getObjectExtension(i,rI);r&&Object.assign(i,r),e.removeObjectExtension(i,rI)}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,e.removeExtension(rI)}(e),this._convertObjectIdsToArrayIndices(i),this._updateObjects(i),this._updateMaterial(i)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in dG)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const i=e[t];if(i&&!Array.isArray(i)){e[t]=[];for(const r in i){const s=i[r];s.id=s.id||r;const o=e[t].length;e[t].push(s),this.idToIndexMap[t][r]=o}}}_convertObjectIdsToArrayIndices(e){for(const t in dG)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:i,indices:r,material:s}=t;for(const o in i)i[o]=this._convertIdToIndex(i[o],"accessor");r&&(t.indices=this._convertIdToIndex(r,"accessor")),s&&(t.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(t=>this._convertIdToIndex(t,"node"))),e.meshes&&(e.meshes=e.meshes.map(t=>this._convertIdToIndex(t,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(e,t){e[t]||(console.warn("gltf v1: json doesn't contain attribute ".concat(t)),e[t]=[]);for(const i of e[t])for(const r in i){const o=this._convertIdToIndex(i[r],r);i[r]=o}}_convertIdToIndex(e,t){const i=Qwe[t];if(i in this.idToIndexMap){const r=this.idToIndexMap[i][e];if(!Number.isFinite(r))throw new Error("gltf v1: failed to resolve ".concat(t," with id ").concat(e));return r}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){for(const s of e.materials){var t,i,r;s.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const o=(null===(t=s.values)||void 0===t?void 0:t.tex)||(null===(i=s.values)||void 0===i?void 0:i.texture2d_0)||(null===(r=s.values)||void 0===r?void 0:r.diffuseTex),a=e.textures.findIndex(c=>c.id===o);-1!==a&&(s.pbrMetallicRoughness.baseColorTexture={index:a})}}}const nEe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},iEe={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},fs_TEXTURE_MAG_FILTER=10240,fs_TEXTURE_MIN_FILTER=10241,fs_TEXTURE_WRAP_S=10242,fs_TEXTURE_WRAP_T=10243,rEe={magFilter:10240,minFilter:10241,wrapS:10242,wrapT:10243},sEe={[fs_TEXTURE_MAG_FILTER]:9729,[fs_TEXTURE_MIN_FILTER]:9986,[fs_TEXTURE_WRAP_S]:10497,[fs_TEXTURE_WRAP_T]:10497};class cEe{constructor(){w(this,"baseUri",""),w(this,"json",{}),w(this,"buffers",[]),w(this,"images",[])}postProcess(e,t={}){const{json:i,buffers:r=[],images:s=[],baseUri:o=""}=e;return Wr(i),this.baseUri=o,this.json=i,this.buffers=r,this.images=s,this._resolveTree(this.json,t),this.json}_resolveTree(e,t={}){e.bufferViews&&(e.bufferViews=e.bufferViews.map((i,r)=>this._resolveBufferView(i,r))),e.images&&(e.images=e.images.map((i,r)=>this._resolveImage(i,r))),e.samplers&&(e.samplers=e.samplers.map((i,r)=>this._resolveSampler(i,r))),e.textures&&(e.textures=e.textures.map((i,r)=>this._resolveTexture(i,r))),e.accessors&&(e.accessors=e.accessors.map((i,r)=>this._resolveAccessor(i,r))),e.materials&&(e.materials=e.materials.map((i,r)=>this._resolveMaterial(i,r))),e.meshes&&(e.meshes=e.meshes.map((i,r)=>this._resolveMesh(i,r))),e.nodes&&(e.nodes=e.nodes.map((i,r)=>this._resolveNode(i,r))),e.skins&&(e.skins=e.skins.map((i,r)=>this._resolveSkin(i,r))),e.scenes&&(e.scenes=e.scenes.map((i,r)=>this._resolveScene(i,r))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];return i||console.warn("glTF file error: Could not find ".concat(e,"[").concat(t,"]")),i}_resolveScene(e,t){return e.id=e.id||"scene-".concat(t),e.nodes=(e.nodes||[]).map(i=>this.getNode(i)),e}_resolveNode(e,t){return e.id=e.id||"node-".concat(t),e.children&&(e.children=e.children.map(i=>this.getNode(i))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((i,r)=>{const s=this.getMesh(r);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,t){return e.id=e.id||"skin-".concat(t),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,t){return e.id=e.id||"mesh-".concat(t),e.primitives&&(e.primitives=e.primitives.map(i=>{const r=(i={...i}).attributes;i.attributes={};for(const s in r)i.attributes[s]=this.getAccessor(r[s]);return void 0!==i.indices&&(i.indices=this.getAccessor(i.indices)),void 0!==i.material&&(i.material=this.getMaterial(i.material)),i})),e}_resolveMaterial(e,t){if(e.id=e.id||"material-".concat(t),e.normalTexture&&(e.normalTexture={...e.normalTexture},e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture={...e.occlustionTexture},e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture={...e.emmisiveTexture},e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness={...e.pbrMetallicRoughness};const i=e.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture={...i.baseColorTexture},i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture={...i.metallicRoughnessTexture},i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,t){if(e.id=e.id||"accessor-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=function oEe(n){return iEe[n]}(e.componentType),e.components=function aEe(n){return nEe[n]}(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const i=e.bufferView.buffer,{ArrayType:r,byteLength:s}=jz(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+i.byteOffset;let a=i.arrayBuffer.slice(o,o+s);e.bufferView.byteStride&&(a=this._getValueFromInterleavedBuffer(i,o,e.bufferView.byteStride,e.bytesPerElement,e.count)),e.value=new r(a)}return e}_getValueFromInterleavedBuffer(e,t,i,r,s){const o=new Uint8Array(s*r);for(let a=0;a<s;a++){const c=t+a*i;o.set(new Uint8Array(e.arrayBuffer.slice(c,c+r)),a*r)}return o.buffer}_resolveTexture(e,t){return e.id=e.id||"texture-".concat(t),e.sampler="sampler"in e?this.getSampler(e.sampler):sEe,e.source=this.getImage(e.source),e}_resolveSampler(e,t){e.id=e.id||"sampler-".concat(t),e.parameters={};for(const i in e){const r=this._enumSamplerParameter(i);void 0!==r&&(e.parameters[r]=e[i])}return e}_enumSamplerParameter(e){return rEe[e]}_resolveImage(e,t){e.id=e.id||"image-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));const i=this.images[t];return i&&(e.image=i),e}_resolveBufferView(e,t){const i=e.buffer,r={id:"bufferView-".concat(t),...e,buffer:this.buffers[i]};let o=this.buffers[i].byteOffset||0;return"byteOffset"in e&&(o+=e.byteOffset),r.data=new Uint8Array(this.buffers[i].arrayBuffer,o,e.byteLength),r}_resolveCamera(e,t){return e.id=e.id||"camera-".concat(t),e}}const hG=1735152710,sI=12,lb=8,uEe=1313821514,dEe=5130562,hEe=0,fEe=1,pEe=0,Jd=!0;function oI(n,e,t,i){const r=new Uint8Array(e.buffer,t,i),o=new TextDecoder("utf8").decode(r);return n.json=JSON.parse(o),sg(i,4)}function aI(n,e,t,i){return n.header.hasBinChunk=!0,n.binChunks.push({byteOffset:t,byteLength:i,arrayBuffer:e.buffer}),sg(i,4)}function cI(){return cI=Q(function*(n,e,t=0,i,r){var s,o,a,c;(function EEe(n,e,t,i){if(i.uri&&(n.baseUri=i.uri),e instanceof ArrayBuffer&&!function mEe(n,e=0,t={}){const i=new DataView(n),{magic:r=hG}=t,s=i.getUint32(e,!1);return s===r||s===hG}(e,t,i)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)n.json=function C0e(n){try{return JSON.parse(n)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(function E0e(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?Nz(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?Nz(n,0,e):""}(n),'"'))}}(e);else if(e instanceof ArrayBuffer){const o={};t=function _Ee(n,e,t=0,i={}){const r=new DataView(e),s=function gEe(n,e=0){return"".concat(String.fromCharCode(n.getUint8(e+0))).concat(String.fromCharCode(n.getUint8(e+1))).concat(String.fromCharCode(n.getUint8(e+2))).concat(String.fromCharCode(n.getUint8(e+3)))}(r,t+0),o=r.getUint32(t+4,Jd),a=r.getUint32(t+8,Jd);switch(Object.assign(n,{header:{byteOffset:t,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),t+=sI,n.version){case 1:return function yEe(n,e,t){Nl(n.header.byteLength>sI+lb);const i=e.getUint32(t+0,Jd),r=e.getUint32(t+4,Jd);return t+=lb,Nl(r===pEe),oI(n,e,t,i),(t+=i)+aI(n,e,t,n.header.byteLength)}(n,r,t);case 2:return function vEe(n,e,t,i){return Nl(n.header.byteLength>sI+lb),function bEe(n,e,t,i){for(;t+8<=n.header.byteLength;){const r=e.getUint32(t+0,Jd),s=e.getUint32(t+4,Jd);switch(t+=lb,s){case uEe:oI(n,e,t,r);break;case dEe:aI(n,e,t,r);break;case hEe:i.strict||oI(n,e,t,r);break;case fEe:i.strict||aI(n,e,t,r)}t+=sg(r,4)}}(n,e,t,i),t+n.header.byteLength}(n,r,t,{});default:throw new Error("Invalid GLB version ".concat(n.version,". Only supports v1 and v2."))}}(o,e,t,i.glb),Wr("glTF"===o.type,"Invalid GLB magic string ".concat(o.type)),n._glb=o,n.json=o.json}else Wr(!1,"GLTF: must be ArrayBuffer or string");if(n.buffers=new Array((n.json.buffers||[]).length).fill(null),n._glb&&n._glb.header.hasBinChunk){const{binChunks:o}=n._glb;n.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}n.images=new Array((n.json.images||[]).length).fill({})})(n,e,t,i),function tEe(n,e={}){(new eEe).normalize(n,e)}(n,{normalize:null==i||null===(s=i.gltf)||void 0===s?void 0:s.normalize}),function Zwe(n,e={},t){const i=lG.filter(s=>uG(s.name,e));for(const s of i){var r;null===(r=s.preprocess)||void 0===r||r.call(s,n,e,t)}}(n,i,r);const l=[];if(null!=i&&null!==(o=i.gltf)&&void 0!==o&&o.loadBuffers&&n.json.buffers&&(yield function CEe(n,e,t){return lI.apply(this,arguments)}(n,i,r)),null!=i&&null!==(a=i.gltf)&&void 0!==a&&a.loadImages){const d=function AEe(n,e,t){return uI.apply(this,arguments)}(n,i,r);l.push(d)}const u=function Kwe(n){return iI.apply(this,arguments)}(n,i,r);return l.push(u),yield Promise.all(l),null!=i&&null!==(c=i.gltf)&&void 0!==c&&c.postProcess?function lEe(n,e){return(new cEe).postProcess(n,e)}(n,i):n}),cI.apply(this,arguments)}function lI(){return lI=Q(function*(n,e,t){const i=n.json.buffers||[];for(let o=0;o<i.length;++o){const a=i[o];if(a.uri){var r,s;const{fetch:c}=t;Wr(c);const l=Fz(a.uri,e),u=yield null==t||null===(r=t.fetch)||void 0===r?void 0:r.call(t,l),d=yield null==u||null===(s=u.arrayBuffer)||void 0===s?void 0:s.call(u);n.buffers[o]={arrayBuffer:d,byteOffset:0,byteLength:d.byteLength},delete a.uri}else null===n.buffers[o]&&(n.buffers[o]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength})}}),lI.apply(this,arguments)}function uI(){return uI=Q(function*(n,e,t){const i=function TEe(n){const e=new Set,t=n.json.textures||[];for(const i of t)void 0!==i.source&&e.add(i.source);return Array.from(e).sort()}(n),r=n.json.images||[],s=[];for(const o of i)s.push(xEe(n,r[o],o,e,t));return yield Promise.all(s)}),uI.apply(this,arguments)}function xEe(n,e,t,i,r){return dI.apply(this,arguments)}function dI(){return dI=Q(function*(n,e,t,i,r){const{fetch:s,parse:o}=r;let a;if(e.uri&&!e.hasOwnProperty("bufferView")){const l=Fz(e.uri,i);a=yield(yield s(l)).arrayBuffer()}if(Number.isFinite(e.bufferView)){const l=function Lz(n,e,t){const i=n.bufferViews[t];Wr(i);const s=e[i.buffer];return Wr(s),new Uint8Array(s.arrayBuffer,(i.byteOffset||0)+s.byteOffset,i.byteLength)}(n.json,n.buffers,e.bufferView);a=kz(l.buffer,l.byteOffset,l.byteLength)}Wr(a,"glTF image has no data");let c=yield o(a,[w0e,e0e],{mimeType:e.mimeType,basis:i.basis||{format:xz()}},r);c&&c[0]&&(c={compressed:!0,mipmaps:!1,width:c[0].width,height:c[0].height,data:c[0]}),n.images=n.images||[],n.images[t]=c}),dI.apply(this,arguments)}const Qd={name:"glTF",id:"gltf",module:"gltf",version:"3.2.13",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function SEe(n){return hI.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function hI(){return hI=Q(function*(n,e={},t){(e={...Qd.options,...e}).gltf={...Qd.options.gltf,...e.gltf};const{byteOffset:i=0}=e;return yield function wEe(n,e){return cI.apply(this,arguments)}({},n,i,e,t)}),hI.apply(this,arguments)}function fI(){return fI=Q(function*(n){const e=[];return n.scenes.forEach(t=>{t.traverse(i=>{Object.values(i.model.getUniforms()).forEach(r=>{!1===r.loaded&&e.push(r)})})}),yield function IEe(n){return pI.apply(this,arguments)}(()=>e.some(t=>!t.loaded))}),fI.apply(this,arguments)}function pI(){return pI=Q(function*(n){for(;n();)yield new Promise(e=>requestAnimationFrame(e))}),pI.apply(this,arguments)}const fG=[255,255,255,255],OEe={scenegraph:{type:"object",value:null,async:!0},getScene:n=>n&&n.scenes?"object"==typeof n.scene?n.scene:n.scenes[n.scene||0]:n,getAnimator:n=>n&&n.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:fG},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[Qd]};class gI extends Ol{constructor(...e){super(...e),w(this,"state",void 0)}getShaders(){const e=[$v,qv];return"pbr"===this.props._lighting&&e.push(rz),{vs:"#version 300 es\n\n// Instance attributes\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\n\n// Uniforms\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\n\n// Attributes\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\n\n// Varying\nout vec4 vColor;\n\n// MODULE_PBR contains all the varying definitions needed\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\n\n// Main\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  vec3 normal = vec3(0.0, 0.0, 1.0);\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;\n    #endif\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    // using instancePositions as world coordinates\n    // when using globe mode, this branch does not re-orient the model to align with the surface of the earth\n    // call project_normal before setting position to avoid rotation\n    geometry.normal = project_normal(normal);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n    geometry.normal = project_normal(normal);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    // set PBR data\n    pbr_vPosition = geometry.position.xyz;\n    #ifdef HAS_NORMALS\n      pbr_vNormal = geometry.normal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n\n// Uniforms\nuniform float opacity;\n\n// Varying\nin vec4 vColor;\n\nout vec4 fragmentColor;\n\n// MODULE_PBR contains all the varying definitions needed\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:e}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:fG,transition:!0},instanceModelMatrix:tz})}updateState(e){super.updateState(e);const{props:t,oldProps:i}=e;t.scenegraph!==i.scenegraph?this._updateScenegraph():t._animations!==i._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,t._animations)}finalizeState(e){super.finalizeState(e),this._deleteScenegraph()}_updateScenegraph(){const e=this.props,{gl:t}=this.context;let i=null;if(e.scenegraph instanceof Xd)i={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){const a=e.scenegraph,c=function Rbe(n,e,t){const i=new Dbe(n,t);return{scenes:i.instantiate(e),animator:i.createAnimator()}}(t,a,this._getModelOptions());i={gltf:a,...c},function MEe(n){return fI.apply(this,arguments)}(c).then(()=>this.setNeedsRedraw())}else e.scenegraph&&(ot.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),i=e.scenegraph);const r={layer:this,gl:t},s=e.getScene(i,r),o=e.getAnimator(i,r);s instanceof Xd?(this._deleteScenegraph(),this._applyAllAttributes(s),this._applyAnimationsProp(s,o,e._animations),this.setState({scenegraph:s,animator:o})):null!==s&&ot.warn("invalid scenegraph:",s)()}_applyAllAttributes(e){if(this.state.attributesAvailable){const t=this.getAttributeManager().getAttributes();e.traverse(i=>{this._setModelAttributes(i.model,t)})}}_applyAnimationsProp(e,t,i){if(!e||!t||!i)return;const r=t.getAnimations();Object.keys(i).sort().forEach(s=>{const o=i[s];if("*"===s)r.forEach(a=>{Object.assign(a,o)});else if(Number.isFinite(Number(s))){const a=Number(s);a>=0&&a<r.length?Object.assign(r[a],o):ot.warn("animation ".concat(s," not found"))()}else{const a=r.find(({name:c})=>c===s);a?Object.assign(a,o):ot.warn("animation ".concat(s," not found"))()}})}_deleteScenegraph(){const{scenegraph:e}=this.state;e instanceof Xd&&e.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:e}=this.props;let t=null;return e&&(t="function"==typeof e?e({gl:this.context.gl,layer:this}):e),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:t,modelOptions:{isInstanced:!0,transpileToGLSL100:!et(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(e){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(t=>{this._setModelAttributes(t.model,e)})}draw({moduleParameters:e=null,parameters:t={},context:i}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(i.timeline.getTime()),this.setNeedsRedraw());const{viewport:r}=this.context,{sizeScale:s,sizeMinPixels:o,sizeMaxPixels:a,opacity:c,coordinateSystem:l}=this.props,u=this.getNumInstances();this.state.scenegraph.traverse((d,{worldMatrix:h})=>{d.model.setInstanceCount(u),d.updateModuleSettings(e),d.draw({parameters:t,uniforms:{sizeScale:s,opacity:c,sizeMinPixels:o,sizeMaxPixels:a,composeModelMatrix:nz(r,l),sceneModelMatrix:h,u_Camera:d.model.getUniforms().project_uCameraPosition}})})}}w(gI,"defaultProps",OEe),w(gI,"layerName","ScenegraphLayer");class PEe extends _c{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=Er("sphere-geometry")}=e,{indices:i,attributes:r}=function NEe(n){const{nlat:e=10,nlong:t=10}=n;let{radius:i=1}=n;const o=Math.PI-0,l=2*Math.PI-0,u=(e+1)*(t+1);if("number"==typeof i){const y=i;i=(v,_,E,A,x)=>y}const d=new Float32Array(3*u),h=new Float32Array(3*u),f=new Float32Array(2*u),g=new(u>65535?Uint32Array:Uint16Array)(e*t*6);for(let y=0;y<=e;y++)for(let v=0;v<=t;v++){const _=v/t,E=y/e,A=v+y*(t+1),x=2*A,I=3*A,S=l*_,F=o*E,U=Math.sin(S),V=Math.cos(S),G=Math.sin(F),L=V*G,$=Math.cos(F),W=U*G,Ce=i(L,$,W,_,E);d[I+0]=Ce*L,d[I+1]=Ce*$,d[I+2]=Ce*W,h[I+0]=L,h[I+1]=$,h[I+2]=W,f[x+0]=_,f[x+1]=1-E}const m=t+1;for(let y=0;y<t;y++)for(let v=0;v<e;v++){const _=6*(y*e+v);g[_+0]=v*m+y,g[_+1]=v*m+y+1,g[_+2]=(v+1)*m+y,g[_+3]=(v+1)*m+y,g[_+4]=v*m+y+1,g[_+5]=(v+1)*m+y+1}return{indices:{size:1,value:g},attributes:{POSITION:{size:3,value:d},NORMAL:{size:3,value:h},TEXCOORD_0:{size:2,value:f}}}}(e);super({...e,id:t,indices:i,attributes:{...r,...e.attributes}})}}const kEe={x:[2,0,1],y:[0,1,2],z:[1,2,0]};class pG extends _c{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=Er("truncated-code-geometry")}=e,{indices:i,attributes:r}=function FEe(n){const{bottomRadius:e=0,topRadius:t=0,height:i=1,nradial:r=10,nvertical:s=10,verticalAxis:o="y",topCap:a=!1,bottomCap:c=!1}=n,l=(a?2:0)+(c?2:0),u=(r+1)*(s+1+l),d=Math.atan2(e-t,i),h=Math.sin,f=Math.cos,p=Math.PI,g=f(d),m=h(d),y=a?-2:0,v=s+(c?2:0),_=r+1,E=new Uint16Array(r*(s+l)*6),A=kEe[o],x=new Float32Array(3*u),I=new Float32Array(3*u),S=new Float32Array(2*u);let F=0,U=0;for(let V=y;V<=v;V++){let L,G=V/s,P=i*G;V<0?(P=0,G=1,L=e):V>s?(P=i,G=1,L=t):L=e+V/s*(t-e),(-2===V||V===s+2)&&(L=0,G=0),P-=i/2;for(let $=0;$<_;$++){const W=h($*p*2/r),Ce=f($*p*2/r);x[F+A[0]]=W*L,x[F+A[1]]=P,x[F+A[2]]=Ce*L,I[F+A[0]]=V<0||V>s?0:W*g,I[F+A[1]]=V<0?-1:V>s?1:m,I[F+A[2]]=V<0||V>s?0:Ce*g,S[U+0]=$/r,S[U+1]=G,U+=2,F+=3}}for(let V=0;V<s+l;V++)for(let G=0;G<r;G++){const P=6*(V*r+G);E[P+0]=_*(V+0)+0+G,E[P+1]=_*(V+0)+1+G,E[P+2]=_*(V+1)+1+G,E[P+3]=_*(V+0)+0+G,E[P+4]=_*(V+1)+1+G,E[P+5]=_*(V+1)+0+G}return{indices:E,attributes:{POSITION:{size:3,value:x},NORMAL:{size:3,value:I},TEXCOORD_0:{size:2,value:S}}}}(e);super({...e,id:t,indices:i,attributes:{...r,...e.attributes}})}}class LEe extends pG{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=Er("cone-geometry"),radius:i=1,cap:r=!0}=e;super({...e,id:t,topRadius:0,topCap:!!r,bottomCap:!!r,bottomRadius:i})}}class BEe extends pG{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=Er("cylinder-geometry"),radius:i=1}=e;super({...e,id:t,bottomRadius:i,topRadius:i})}}const VEe=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),UEe=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),jEe=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),HEe=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),zEe={POSITION:{size:3,value:new Float32Array(UEe)},NORMAL:{size:3,value:new Float32Array(jEe)},TEXCOORD_0:{size:2,value:new Float32Array(HEe)}};class GEe extends _c{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=Er("cube-geometry")}=e;super({...e,id:t,indices:{size:1,value:new Uint16Array(VEe)},attributes:{...zEe,...e.attributes}})}}function ub(n,e,t){e||(e=new Ge(Ge.IDENTITY));const i=new Ge(Ge.IDENTITY);if(!n)return!0;if(n.matrix)i.copy(n.matrix);else{if(i.identity(),n.translation&&i.translate(n.translation),n.rotation){const s=new Ge(Ge.IDENTITY).fromQuaternion(n.rotation);i.multiplyRight(s)}n.scale&&i.scale(n.scale)}const r=new Ge(e).multiplyRight(i);if(!1===t(n,r,e))return!1;for(const s of n.nodes||n.children||[])if(!1===ub(s,r,t))return!1;return!0}function gG(){pj([Gz,Qd])}function mG(n,e){const t=e.nodes?.find(i=>i.name===n);if(t){let i=!1;for(const r of e.scenes)i||ub(r,new Ge(Ge.IDENTITY),(s,o)=>s!==t||(s.matrix=o,s.translation=void 0,s.rotation=void 0,s.scale=void 0,i=!0,!1));return e.scene={id:n,name:n,nodes:[t]},e.scenes=[e.scene],{scene:e.scene,scenes:e.scenes}}return e}function _G(n,e){return mI.apply(this,arguments)}function mI(){return mI=Q(function*(n,e){const t=n.scenegraph;let i;i=e?e[t]||(e[t]=fetch(t).then(s=>s.blob())):fetch(t);const r=yield Pv(i,Qd,{DracoLoader:XM,gltf:{decompressMeshes:!0,postProcess:!0}});return r.nodes||console.log("WARNING: Empty Scene",t,r),mG(n.scenegraphNode,r)}),mI.apply(this,arguments)}function WEe(n,e){return _I.apply(this,arguments)}function _I(){return _I=Q(function*(n,e){return mG(n,yield e)}),_I.apply(this,arguments)}class js{constructor(e){void 0===e&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e){void 0===e&&(e=new b);const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t){void 0===t&&(t=new b);const i=this.elements,r=e.x,s=e.y,o=e.z;return t.x=i[0]*r+i[1]*s+i[2]*o,t.y=i[3]*r+i[4]*s+i[5]*o,t.z=i[6]*r+i[7]*s+i[8]*o,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t){void 0===t&&(t=new js);const i=this.elements,r=e.elements,s=t.elements,o=i[0],a=i[1],c=i[2],l=i[3],u=i[4],d=i[5],h=i[6],f=i[7],p=i[8],g=r[0],m=r[1],y=r[2],v=r[3],_=r[4],E=r[5],A=r[6],x=r[7],I=r[8];return s[0]=o*g+a*v+c*A,s[1]=o*m+a*_+c*x,s[2]=o*y+a*E+c*I,s[3]=l*g+u*v+d*A,s[4]=l*m+u*_+d*x,s[5]=l*y+u*E+d*I,s[6]=h*g+f*v+p*A,s[7]=h*m+f*_+p*x,s[8]=h*y+f*E+p*I,t}scale(e,t){void 0===t&&(t=new js);const i=this.elements,r=t.elements;for(let s=0;3!==s;s++)r[3*s+0]=e.x*i[3*s+0],r[3*s+1]=e.y*i[3*s+1],r[3*s+2]=e.z*i[3*s+2];return t}solve(e,t){void 0===t&&(t=new b);const s=[];let o,a;for(o=0;o<12;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+4*a]=this.elements[o+3*a];s[3]=e.x,s[7]=e.y,s[11]=e.z;let c=3;const l=c;let u,h;do{if(o=l-c,0===s[o+4*o])for(a=o+1;a<l;a++)if(0!==s[o+4*a]){u=4;do{h=4-u,s[h+4*o]+=s[h+4*a]}while(--u);break}if(0!==s[o+4*o])for(a=o+1;a<l;a++){const f=s[o+4*a]/s[o+4*o];u=4;do{h=4-u,s[h+4*a]=h<=o?0:s[h+4*a]-s[h+4*o]*f}while(--u)}}while(--c);if(t.z=s[11]/s[10],t.y=(s[7]-s[6]*t.z)/s[5],t.x=(s[3]-s[2]*t.z-s[1]*t.y)/s[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw`Could not solve equation! Got x=[${t.toString()}], b=[${e.toString()}], A=[${this.toString()}]`;return t}e(e,t,i){if(void 0===i)return this.elements[t+3*e];this.elements[t+3*e]=i}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let i=0;i<9;i++)e+=this.elements[i]+",";return e}reverse(e){void 0===e&&(e=new js);const r=$Ee;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)r[s+6*o]=this.elements[s+3*o];r[3]=1,r[9]=0,r[15]=0,r[4]=0,r[10]=1,r[16]=0,r[5]=0,r[11]=0,r[17]=1;let a=3;const c=a;let l,d;do{if(s=c-a,0===r[s+6*s])for(o=s+1;o<c;o++)if(0!==r[s+6*o]){l=6;do{d=6-l,r[d+6*s]+=r[d+6*o]}while(--l);break}if(0!==r[s+6*s])for(o=s+1;o<c;o++){const h=r[s+6*o]/r[s+6*s];l=6;do{d=6-l,r[d+6*o]=d<=s?0:r[d+6*o]-r[d+6*s]*h}while(--l)}}while(--a);s=2;do{o=s-1;do{const h=r[s+6*o]/r[s+6*s];l=6;do{d=6-l,r[d+6*o]=r[d+6*o]-r[d+6*s]*h}while(--l)}while(o--)}while(--s);s=2;do{const h=1/r[s+6*s];l=6;do{d=6-l,r[d+6*s]=r[d+6*s]*h}while(--l)}while(s--);s=2;do{o=2;do{if(d=r[3+o+6*s],isNaN(d)||d===1/0)throw`Could not reverse! A=[${this.toString()}]`;e.e(s,o,d)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const t=e.x,i=e.y,r=e.z,s=e.w,o=t+t,a=i+i,c=r+r,l=t*o,u=t*a,d=t*c,h=i*a,f=i*c,p=r*c,g=s*o,m=s*a,y=s*c,v=this.elements;return v[0]=1-(h+p),v[1]=u-y,v[2]=d+m,v[3]=u+y,v[4]=1-(l+p),v[5]=f-g,v[6]=d-m,v[7]=f+g,v[8]=1-(l+h),this}transpose(e){void 0===e&&(e=new js);const t=this.elements,i=e.elements;let r;return i[0]=t[0],i[4]=t[4],i[8]=t[8],r=t[1],i[1]=t[3],i[3]=r,r=t[2],i[2]=t[6],i[6]=r,r=t[5],i[5]=t[7],i[7]=r,e}}const $Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class b{constructor(e,t,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),this.x=e,this.y=t,this.z=i}cross(e,t){void 0===t&&(t=new b);const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,c=this.z;return t.x=a*s-c*r,t.y=c*i-o*s,t.z=o*r-a*i,t}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new b(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new b(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new js([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,i=this.z,r=Math.sqrt(e*e+t*t+i*i);if(r>0){const s=1/r;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return r}unit(e){void 0===e&&(e=new b);const t=this.x,i=this.y,r=this.z;let s=Math.sqrt(t*t+i*i+r*r);return s>0?(s=1/s,e.x=t*s,e.y=i*s,e.z=r*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r))}distanceSquared(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return(s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r)}scale(e,t){void 0===t&&(t=new b);const r=this.y,s=this.z;return t.x=e*this.x,t.y=e*r,t.z=e*s,t}vmul(e,t){return void 0===t&&(t=new b),t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,i){return void 0===i&&(i=new b),i.x=this.x+e*t.x,i.y=this.y+e*t.y,i.z=this.z+e*t.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e){return void 0===e&&(e=new b),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const i=this.length();if(i>0){const r=qEe,s=1/i;r.set(this.x*s,this.y*s,this.z*s);const o=XEe;Math.abs(r.x)<.9?(o.set(1,0,0),r.cross(o,e)):(o.set(0,1,0),r.cross(o,e)),r.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,i){const r=this.x,s=this.y,o=this.z;i.x=r+(e.x-r)*t,i.y=s+(e.y-s)*t,i.z=o+(e.z-o)*t}almostEquals(e,t){return void 0===t&&(t=1e-6),!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e){return void 0===e&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(yG),yG.almostEquals(e,t)}clone(){return new b(this.x,this.y,this.z)}}b.ZERO=new b(0,0,0),b.UNIT_X=new b(1,0,0),b.UNIT_Y=new b(0,1,0),b.UNIT_Z=new b(0,0,1);const qEe=new b,XEe=new b,yG=new b;class Xt{constructor(e){void 0===e&&(e={}),this.lowerBound=new b,this.upperBound=new b,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,i,r){const s=this.lowerBound,o=this.upperBound,a=i;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let c=1;c<e.length;c++){let l=e[c];a&&(a.vmult(l,vG),l=vG),l.x>o.x&&(o.x=l.x),l.x<s.x&&(s.x=l.x),l.y>o.y&&(o.y=l.y),l.y<s.y&&(s.y=l.y),l.z>o.z&&(o.z=l.z),l.z<s.z&&(s.z=l.z)}return t&&(t.vadd(s,s),t.vadd(o,o)),r&&(s.x-=r,s.y-=r,s.z-=r,o.x+=r,o.y+=r,o.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new Xt).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return(r.x<=i.x&&i.x<=s.x||t.x<=s.x&&s.x<=i.x)&&(r.y<=i.y&&i.y<=s.y||t.y<=s.y&&s.y<=i.y)&&(r.z<=i.z&&i.z<=s.z||t.z<=s.z&&s.z<=i.z)}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return t.x<=r.x&&i.x>=s.x&&t.y<=r.y&&i.y>=s.y&&t.z<=r.z&&i.z>=s.z}getCorners(e,t,i,r,s,o,a,c){const l=this.lowerBound,u=this.upperBound;e.copy(l),t.set(u.x,l.y,l.z),i.set(u.x,u.y,l.z),r.set(l.x,u.y,u.z),s.set(u.x,l.y,u.z),o.set(l.x,u.y,l.z),a.set(l.x,l.y,u.z),c.copy(u)}toLocalFrame(e,t){const i=bG;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let h=0;8!==h;h++){const f=i[h];e.pointToLocal(f,f)}return t.setFromPoints(i)}toWorldFrame(e,t){const i=bG;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let h=0;8!==h;h++){const f=i[h];e.pointToWorld(f,f)}return t.setFromPoints(i)}overlapsRay(e){const{direction:t,from:i}=e,r=1/t.x,s=1/t.y,o=1/t.z,a=(this.lowerBound.x-i.x)*r,c=(this.upperBound.x-i.x)*r,l=(this.lowerBound.y-i.y)*s,u=(this.upperBound.y-i.y)*s,d=(this.lowerBound.z-i.z)*o,h=(this.upperBound.z-i.z)*o,f=Math.max(Math.max(Math.min(a,c),Math.min(l,u)),Math.min(d,h)),p=Math.min(Math.min(Math.max(a,c),Math.max(l,u)),Math.max(d,h));return!(p<0||f>p)}}const vG=new b,bG=[new b,new b,new b,new b,new b,new b,new b,new b];class EG{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;return void 0===i[e]&&(i[e]=[]),i[e].includes(t)||i[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return!(void 0===i[e]||!i[e].includes(t))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const i=this._listeners;if(void 0===i[e])return this;const r=i[e].indexOf(t);return-1!==r&&i[e].splice(r,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const i=this._listeners[e.type];if(void 0!==i){e.target=this;for(let r=0,s=i.length;r<s;r++)i[r].call(this,e)}return this}}class _n{constructor(e,t,i,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===r&&(r=1),this.x=e,this.y=t,this.z=i,this.w=r}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const i=Math.sin(.5*t);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(.5*t),this}toAxisAngle(e){void 0===e&&(e=new b),this.normalize();const t=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const i=YEe;e.tangents(i,ZEe),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(t);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(e.length()**2*t.length()**2)+e.dot(t),this.normalize()}return this}mult(e,t){void 0===t&&(t=new _n);const i=this.x,r=this.y,s=this.z,o=this.w,a=e.x,c=e.y,l=e.z,u=e.w;return t.x=i*u+o*a+r*l-s*c,t.y=r*u+o*c+s*a-i*l,t.z=s*u+o*l+i*c-r*a,t.w=o*u-i*a-r*c-s*l,t}inverse(e){void 0===e&&(e=new _n);const t=this.x,i=this.y,r=this.z,s=this.w;this.conjugate(e);const o=1/(t*t+i*i+r*r+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e){return void 0===e&&(e=new _n),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t){void 0===t&&(t=new b);const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,c=this.z,l=this.w,u=l*i+a*s-c*r,d=l*r+c*i-o*s,h=l*s+o*r-a*i,f=-o*i-a*r-c*s;return t.x=u*l+f*-o+d*-c-h*-a,t.y=d*l+f*-a+h*-o-u*-c,t.z=h*l+f*-c+u*-a-d*-o,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t){let i,r,s;void 0===t&&(t="YZX");const o=this.x,a=this.y,c=this.z,l=this.w;if("YZX"!==t)throw new Error(`Euler order ${t} not supported yet.`);{const u=o*a+c*l;if(u>.499&&(i=2*Math.atan2(o,l),r=Math.PI/2,s=0),u<-.499&&(i=-2*Math.atan2(o,l),r=-Math.PI/2,s=0),void 0===i){const d=o*o,f=c*c;i=Math.atan2(2*a*l-2*o*c,1-a*a*2-2*f),r=Math.asin(2*u),s=Math.atan2(2*o*l-2*a*c,1-2*d-2*f)}}e.y=i,e.z=r,e.x=s}setFromEuler(e,t,i,r){void 0===r&&(r="XYZ");const s=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(i/2),c=Math.sin(e/2),l=Math.sin(t/2),u=Math.sin(i/2);return"XYZ"===r?(this.x=c*o*a+s*l*u,this.y=s*l*a-c*o*u,this.z=s*o*u+c*l*a,this.w=s*o*a-c*l*u):"YXZ"===r?(this.x=c*o*a+s*l*u,this.y=s*l*a-c*o*u,this.z=s*o*u-c*l*a,this.w=s*o*a+c*l*u):"ZXY"===r?(this.x=c*o*a-s*l*u,this.y=s*l*a+c*o*u,this.z=s*o*u+c*l*a,this.w=s*o*a-c*l*u):"ZYX"===r?(this.x=c*o*a-s*l*u,this.y=s*l*a+c*o*u,this.z=s*o*u-c*l*a,this.w=s*o*a+c*l*u):"YZX"===r?(this.x=c*o*a+s*l*u,this.y=s*l*a+c*o*u,this.z=s*o*u-c*l*a,this.w=s*o*a-c*l*u):"XZY"===r&&(this.x=c*o*a-s*l*u,this.y=s*l*a-c*o*u,this.z=s*o*u+c*l*a,this.w=s*o*a+c*l*u),this}clone(){return new _n(this.x,this.y,this.z,this.w)}slerp(e,t,i){void 0===i&&(i=new _n);const r=this.x,s=this.y,o=this.z,a=this.w;let h,f,p,g,m,c=e.x,l=e.y,u=e.z,d=e.w;return f=r*c+s*l+o*u+a*d,f<0&&(f=-f,c=-c,l=-l,u=-u,d=-d),1-f>1e-6?(h=Math.acos(f),p=Math.sin(h),g=Math.sin((1-t)*h)/p,m=Math.sin(t*h)/p):(g=1-t,m=t),i.x=g*r+m*c,i.y=g*s+m*l,i.z=g*o+m*u,i.w=g*a+m*d,i}integrate(e,t,i,r){void 0===r&&(r=new _n);const s=e.x*i.x,o=e.y*i.y,a=e.z*i.z,c=this.x,l=this.y,u=this.z,d=this.w,h=.5*t;return r.x+=h*(s*d+o*u-a*l),r.y+=h*(o*d+a*c-s*u),r.z+=h*(a*d+s*l-o*c),r.w+=h*(-s*c-o*l-a*u),r}}const YEe=new b,ZEe=new b,KEe={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let ae=(()=>{class n{constructor(t){void 0===t&&(t={}),this.id=n.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(t,i){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(t,i,r,s){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}return n.idCounter=0,n.types=KEe,n})();class yt{constructor(e){void 0===e&&(e={}),this.position=new b,this.quaternion=new _n,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return yt.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return yt.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t){return void 0===t&&(t=new b),this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,i,r){return void 0===r&&(r=new b),i.vsub(e,r),t.conjugate(CG),CG.vmult(r,r),r}static pointToWorldFrame(e,t,i,r){return void 0===r&&(r=new b),t.vmult(i,r),r.vadd(e,r),r}static vectorToWorldFrame(e,t,i){return void 0===i&&(i=new b),e.vmult(t,i),i}static vectorToLocalFrame(e,t,i,r){return void 0===r&&(r=new b),t.w*=-1,t.vmult(i,r),t.w*=-1,r}}const CG=new _n;class bc extends ae{constructor(e){void 0===e&&(e={});const{vertices:t=[],faces:i=[],normals:r=[],axes:s,boundingSphereRadius:o}=e;super({type:ae.types.CONVEXPOLYHEDRON}),this.vertices=t,this.faces=i,this.faceNormals=r,0===this.faceNormals.length&&this.computeNormals(),o?this.boundingSphereRadius=o:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=s?s.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,i=this.uniqueEdges;i.length=0;const r=new b;for(let s=0;s!==e.length;s++){const o=e[s],a=o.length;for(let c=0;c!==a;c++){t[o[c]].vsub(t[o[(c+1)%a]],r),r.normalize();let u=!1;for(let d=0;d!==i.length;d++)if(i[d].almostEquals(r)||i[d].almostEquals(r)){u=!0;break}u||i.push(r.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let r=0;r<this.faces[e].length;r++)if(!this.vertices[this.faces[e][r]])throw new Error(`Vertex ${this.faces[e][r]} not found!`);const t=this.faceNormals[e]||new b;if(this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t,t.dot(this.vertices[this.faces[e][0]])<0){console.error(`.faceNormals[${e}] = Vec3(${t.toString()}) looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.`);for(let r=0;r<this.faces[e].length;r++)console.warn(`.vertices[${this.faces[e][r]}] = Vec3(${this.vertices[this.faces[e][r]].toString()})`)}}}getFaceNormal(e,t){const i=this.faces[e];bc.computeNormal(this.vertices[i[0]],this.vertices[i[1]],this.vertices[i[2]],t)}static computeNormal(e,t,i,r){const s=new b,o=new b;t.vsub(e,o),i.vsub(t,s),s.cross(o,r),r.isZero()||r.normalize()}clipAgainstHull(e,t,i,r,s,o,a,c,l){const u=new b;let d=-1,h=-Number.MAX_VALUE;for(let p=0;p<i.faces.length;p++){u.copy(i.faceNormals[p]),s.vmult(u,u);const g=u.dot(o);g>h&&(h=g,d=p)}const f=[];for(let p=0;p<i.faces[d].length;p++){const g=i.vertices[i.faces[d][p]],m=new b;m.copy(g),s.vmult(m,m),r.vadd(m,m),f.push(m)}d>=0&&this.clipFaceAgainstHull(o,e,t,f,a,c,l)}findSeparatingAxis(e,t,i,r,s,o,a,c){const l=new b,u=new b,d=new b,h=new b,f=new b,p=new b;let g=Number.MAX_VALUE;const m=this;if(m.uniqueAxes)for(let y=0;y!==m.uniqueAxes.length;y++){i.vmult(m.uniqueAxes[y],l);const v=m.testSepAxis(l,e,t,i,r,s);if(!1===v)return!1;v<g&&(g=v,o.copy(l))}else{const y=a?a.length:m.faces.length;for(let v=0;v<y;v++){l.copy(m.faceNormals[a?a[v]:v]),i.vmult(l,l);const E=m.testSepAxis(l,e,t,i,r,s);if(!1===E)return!1;E<g&&(g=E,o.copy(l))}}if(e.uniqueAxes)for(let y=0;y!==e.uniqueAxes.length;y++){s.vmult(e.uniqueAxes[y],u);const v=m.testSepAxis(u,e,t,i,r,s);if(!1===v)return!1;v<g&&(g=v,o.copy(u))}else{const y=c?c.length:e.faces.length;for(let v=0;v<y;v++){u.copy(e.faceNormals[c?c[v]:v]),s.vmult(u,u);const E=m.testSepAxis(u,e,t,i,r,s);if(!1===E)return!1;E<g&&(g=E,o.copy(u))}}for(let y=0;y!==m.uniqueEdges.length;y++){i.vmult(m.uniqueEdges[y],h);for(let v=0;v!==e.uniqueEdges.length;v++)if(s.vmult(e.uniqueEdges[v],f),h.cross(f,p),!p.almostZero()){p.normalize();const _=m.testSepAxis(p,e,t,i,r,s);if(!1===_)return!1;_<g&&(g=_,o.copy(p))}}return r.vsub(t,d),d.dot(o)>0&&o.negate(o),!0}testSepAxis(e,t,i,r,s,o){bc.project(this,e,i,r,yI),bc.project(t,e,s,o,vI);const c=yI[0],l=yI[1],u=vI[0],d=vI[1];if(c<d||u<l)return!1;const h=c-d,f=u-l;return h<f?h:f}calculateLocalInertia(e,t){const i=new b,r=new b;this.computeLocalAABB(r,i);const s=i.x-r.x,o=i.y-r.y,a=i.z-r.z;t.x=1/12*e*(2*o*2*o+2*a*2*a),t.y=1/12*e*(2*s*2*s+2*a*2*a),t.z=1/12*e*(2*o*2*o+2*s*2*s)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,t,i,r,s,o,a){const c=new b,l=new b,u=new b,d=new b,h=new b,f=new b,p=new b,g=new b,m=this,v=r,_=[];let E=-1,A=Number.MAX_VALUE;for(let U=0;U<m.faces.length;U++){c.copy(m.faceNormals[U]),i.vmult(c,c);const V=c.dot(e);V<A&&(A=V,E=U)}if(E<0)return;const x=m.faces[E];x.connectedFaces=[];for(let U=0;U<m.faces.length;U++)for(let V=0;V<m.faces[U].length;V++)-1!==x.indexOf(m.faces[U][V])&&U!==E&&-1===x.connectedFaces.indexOf(U)&&x.connectedFaces.push(U);const I=x.length;for(let U=0;U<I;U++){const V=m.vertices[x[U]];V.vsub(m.vertices[x[(U+1)%I]],l),u.copy(l),i.vmult(u,u),t.vadd(u,u),d.copy(this.faceNormals[E]),i.vmult(d,d),t.vadd(d,d),u.cross(d,h),h.negate(h),f.copy(V),i.vmult(f,f),t.vadd(f,f);const P=x.connectedFaces[U];p.copy(this.faceNormals[P]);const L=this.getPlaneConstantOfFace(P);g.copy(p),i.vmult(g,g);const $=L-g.dot(t);for(this.clipFaceAgainstPlane(v,_,g,$);v.length;)v.shift();for(;_.length;)v.push(_.shift())}p.copy(this.faceNormals[E]);const S=this.getPlaneConstantOfFace(E);g.copy(p),i.vmult(g,g);const F=S-g.dot(t);for(let U=0;U<v.length;U++){let V=g.dot(v[U])+F;V<=s&&(console.log(`clamped: depth=${V} to minDist=${s}`),V=s),V<=o&&V<=1e-6&&a.push({point:v[U],normal:g,depth:V})}}clipFaceAgainstPlane(e,t,i,r){let s,o;const a=e.length;if(a<2)return t;let c=e[e.length-1],l=e[0];s=i.dot(c)+r;for(let u=0;u<a;u++){if(l=e[u],o=i.dot(l)+r,s<0)if(o<0){const d=new b;d.copy(l),t.push(d)}else{const d=new b;c.lerp(l,s/(s-o),d),t.push(d)}else if(o<0){const d=new b;c.lerp(l,s/(s-o),d),t.push(d),t.push(l)}c=l,s=o}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new b);const i=this.vertices,r=this.worldVertices;for(let s=0;s!==this.vertices.length;s++)t.vmult(i[s],r[s]),e.vadd(r[s],r[s]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let r=0;r<this.vertices.length;r++){const s=i[r];s.x<e.x?e.x=s.x:s.x>t.x&&(t.x=s.x),s.y<e.y?e.y=s.y:s.y>t.y&&(t.y=s.y),s.z<e.z?e.z=s.z:s.z>t.z&&(t.z=s.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new b);const i=this.faceNormals,r=this.worldFaceNormals;for(let s=0;s!==t;s++)e.vmult(i[s],r[s]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let i=0;i!==t.length;i++){const r=t[i].lengthSquared();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,i,r){const s=this.vertices;let o,a,c,l,u,d,h=new b;for(let f=0;f<s.length;f++)h.copy(s[f]),t.vmult(h,h),e.vadd(h,h),(void 0===o||h.x<o)&&(o=h.x),(void 0===l||h.x>l)&&(l=h.x),(void 0===a||h.y<a)&&(a=h.y),(void 0===u||h.y>u)&&(u=h.y),(void 0===c||h.z<c)&&(c=h.z),(void 0===d||h.z>d)&&(d=h.z);i.set(o,a,c),r.set(l,u,d)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e){void 0===e&&(e=new b);const t=this.vertices;for(let i=0;i<t.length;i++)e.vadd(t[i],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const i=this.vertices.length,r=this.vertices;if(t){for(let s=0;s<i;s++){const o=r[s];t.vmult(o,o)}for(let s=0;s<this.faceNormals.length;s++){const o=this.faceNormals[s];t.vmult(o,o)}}if(e)for(let s=0;s<i;s++){const o=r[s];o.vadd(e,o)}}pointIsInside(e){const t=this.vertices,i=this.faces,r=this.faceNormals,o=new b;this.getAveragePointLocal(o);for(let a=0;a<this.faces.length;a++){let c=r[a];const l=t[i[a][0]],u=new b;e.vsub(l,u);const d=c.dot(u),h=new b;o.vsub(l,h);const f=c.dot(h);if(d<0&&f>0||d>0&&f<0)return!1}return-1}static project(e,t,i,r,s){const o=e.vertices.length,a=QEe;let c=0,l=0;const u=eCe,d=e.vertices;u.setZero(),yt.vectorToLocalFrame(i,r,t,a),yt.pointToLocalFrame(i,r,u,u);const h=u.dot(a);l=c=d[0].dot(a);for(let f=1;f<o;f++){const p=d[f].dot(a);p>c&&(c=p),p<l&&(l=p)}if(l-=h,c-=h,l>c){const f=l;l=c,c=f}s[0]=c,s[1]=l}}const yI=[],vI=[],QEe=(new b,new b),eCe=new b;class db extends ae{constructor(e){super({type:ae.types.BOX}),this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,i=this.halfExtents.z,r=b,s=[new r(-e,-t,-i),new r(e,-t,-i),new r(e,t,-i),new r(-e,t,-i),new r(-e,-t,i),new r(e,-t,i),new r(e,t,i),new r(-e,t,i)],a=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],c=new bc({vertices:s,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:a});this.convexPolyhedronRepresentation=c,c.material=this.material}calculateLocalInertia(e,t){return void 0===t&&(t=new b),db.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,i){const r=e;i.x=1/12*t*(2*r.y*2*r.y+2*r.z*2*r.z),i.y=1/12*t*(2*r.x*2*r.x+2*r.z*2*r.z),i.z=1/12*t*(2*r.y*2*r.y+2*r.x*2*r.x)}getSideNormals(e,t){const i=e,r=this.halfExtents;if(i[0].set(r.x,0,0),i[1].set(0,r.y,0),i[2].set(0,0,r.z),i[3].set(-r.x,0,0),i[4].set(0,-r.y,0),i[5].set(0,0,-r.z),void 0!==t)for(let s=0;s!==i.length;s++)t.vmult(i[s],i[s]);return i}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,i){const r=this.halfExtents,s=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]];for(let o=0;o<s.length;o++)wc.set(s[o][0],s[o][1],s[o][2]),t.vmult(wc,wc),e.vadd(wc,wc),i(wc.x,wc.y,wc.z)}calculateWorldAABB(e,t,i,r){const s=this.halfExtents;Ao[0].set(s.x,s.y,s.z),Ao[1].set(-s.x,s.y,s.z),Ao[2].set(-s.x,-s.y,s.z),Ao[3].set(-s.x,-s.y,-s.z),Ao[4].set(s.x,-s.y,-s.z),Ao[5].set(s.x,s.y,-s.z),Ao[6].set(-s.x,s.y,-s.z),Ao[7].set(s.x,-s.y,s.z);const o=Ao[0];t.vmult(o,o),e.vadd(o,o),r.copy(o),i.copy(o);for(let a=1;a<8;a++){const c=Ao[a];t.vmult(c,c),e.vadd(c,c);const l=c.x,u=c.y,d=c.z;l>r.x&&(r.x=l),u>r.y&&(r.y=u),d>r.z&&(r.z=d),l<i.x&&(i.x=l),u<i.y&&(i.y=u),d<i.z&&(i.z=d)}}}const wc=new b,Ao=[new b,new b,new b,new b,new b,new b,new b,new b];class de extends EG{constructor(e){void 0===e&&(e={}),super(),this.id=de.idCounter++,this.index=-1,this.world=null,this.vlambda=new b,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new b,this.previousPosition=new b,this.interpolatedPosition=new b,this.initPosition=new b,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new b,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new b,this.force=new b;const t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?de.STATIC:de.DYNAMIC,typeof e.type==typeof de.STATIC&&(this.type=e.type),this.allowSleep=!(typeof e.allowSleep<"u")||e.allowSleep,this.sleepState=de.AWAKE,this.sleepSpeedLimit=typeof e.sleepSpeedLimit<"u"?e.sleepSpeedLimit:.1,this.sleepTimeLimit=typeof e.sleepTimeLimit<"u"?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new b,this.quaternion=new _n,this.initQuaternion=new _n,this.previousQuaternion=new _n,this.interpolatedQuaternion=new _n,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new b,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new b,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new b,this.invInertia=new b,this.invInertiaWorld=new js,this.invMassSolve=0,this.invInertiaSolve=new b,this.invInertiaWorldSolve=new js,this.fixedRotation=typeof e.fixedRotation<"u"&&e.fixedRotation,this.angularDamping=typeof e.angularDamping<"u"?e.angularDamping:.01,this.linearFactor=new b(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new b(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new Xt,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new b,this.isTrigger=!!e.isTrigger,e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=de.AWAKE,this.wakeUpAfterNarrowphase=!1,e===de.SLEEPING&&this.dispatchEvent(de.wakeupEvent)}sleep(){this.sleepState=de.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),r=this.sleepSpeedLimit**2;t===de.AWAKE&&i<r?(this.sleepState=de.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(de.sleepyEvent)):t===de.SLEEPY&&i>r?this.wakeUp():t===de.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(de.sleepEvent))}}updateSolveMassProperties(){this.sleepState===de.SLEEPING||this.type===de.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t){return void 0===t&&(t=new b),e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t){return void 0===t&&(t=new b),this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t){return void 0===t&&(t=new b),this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t){return void 0===t&&(t=new b),this.quaternion.vmult(e,t),t}addShape(e,t,i){const r=new b,s=new _n;return t&&r.copy(t),i&&s.copy(i),this.shapes.push(e),this.shapeOffsets.push(r),this.shapeOrientations.push(s),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,i=e.length;let r=0;for(let s=0;s!==i;s++){const o=e[s];o.updateBoundingSphereRadius();const a=t[s].length(),c=o.boundingSphereRadius;a+c>r&&(r=a+c)}this.boundingRadius=r}updateAABB(){const e=this.shapes,t=this.shapeOffsets,i=this.shapeOrientations,r=e.length,s=tCe,o=nCe,a=this.quaternion,c=this.aabb,l=iCe;for(let u=0;u!==r;u++){const d=e[u];a.vmult(t[u],s),s.vadd(this.position,s),a.mult(i[u],o),d.calculateWorldAABB(s,o,l.lowerBound,l.upperBound),0===u?c.copy(l):c.extend(l)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const i=rCe,r=sCe;i.setRotationFromQuaternion(this.quaternion),i.transpose(r),i.scale(t,i),i.mmult(r,this.invInertiaWorld)}}applyForce(e,t){if(void 0===t&&(t=new b),this.type!==de.DYNAMIC)return;this.sleepState===de.SLEEPING&&this.wakeUp();const i=aCe;t.cross(e,i),this.force.vadd(e,this.force),this.torque.vadd(i,this.torque)}applyLocalForce(e,t){if(void 0===t&&(t=new b),this.type!==de.DYNAMIC)return;const i=cCe,r=lCe;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyForce(i,r)}applyTorque(e){this.type===de.DYNAMIC&&(this.sleepState===de.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t){if(void 0===t&&(t=new b),this.type!==de.DYNAMIC)return;this.sleepState===de.SLEEPING&&this.wakeUp();const i=t,r=uCe;r.copy(e),r.scale(this.invMass,r),this.velocity.vadd(r,this.velocity);const s=dCe;i.cross(e,s),this.invInertiaWorld.vmult(s,s),this.angularVelocity.vadd(s,this.angularVelocity)}applyLocalImpulse(e,t){if(void 0===t&&(t=new b),this.type!==de.DYNAMIC)return;const i=hCe,r=fCe;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyImpulse(i,r)}updateMassProperties(){const e=pCe;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,i=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),db.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!i?1/t.x:0,t.y>0&&!i?1/t.y:0,t.z>0&&!i?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const i=new b;return e.vsub(this.position,i),this.angularVelocity.cross(i,t),this.velocity.vadd(t,t),t}integrate(e,t,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==de.DYNAMIC&&this.type!==de.KINEMATIC||this.sleepState===de.SLEEPING)return;const r=this.velocity,s=this.angularVelocity,o=this.position,a=this.force,c=this.torque,l=this.quaternion,d=this.invInertiaWorld,h=this.linearFactor,f=this.invMass*e;r.x+=a.x*f*h.x,r.y+=a.y*f*h.y,r.z+=a.z*f*h.z;const p=d.elements,g=this.angularFactor,m=c.x*g.x,y=c.y*g.y,v=c.z*g.z;s.x+=e*(p[0]*m+p[1]*y+p[2]*v),s.y+=e*(p[3]*m+p[4]*y+p[5]*v),s.z+=e*(p[6]*m+p[7]*y+p[8]*v),o.x+=r.x*e,o.y+=r.y*e,o.z+=r.z*e,l.integrate(this.angularVelocity,e,this.angularFactor,l),t&&(i?l.normalizeFast():l.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}de.idCounter=0,de.COLLIDE_EVENT_NAME="collide",de.DYNAMIC=1,de.STATIC=2,de.KINEMATIC=4,de.AWAKE=0,de.SLEEPY=1,de.SLEEPING=2,de.wakeupEvent={type:"wakeup"},de.sleepyEvent={type:"sleepy"},de.sleepEvent={type:"sleep"};const tCe=new b,nCe=new _n,iCe=new Xt,rCe=new js,sCe=new js,aCe=(new js,new b),cCe=new b,lCe=new b,uCe=new b,dCe=new b,hCe=new b,fCe=new b,pCe=new b;new b,new b,new _n,new b,new b,new b,new b;class ug{constructor(){this.rayFromWorld=new b,this.rayToWorld=new b,this.hitNormalWorld=new b,this.hitPointWorld=new b,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,i,r,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(r),this.shape=s,this.body=o,this.distance=a}}let AG,TG,xG,SG,MG,IG,DG;AG=ae.types.SPHERE,TG=ae.types.PLANE,xG=ae.types.BOX,SG=ae.types.CYLINDER,MG=ae.types.CONVEXPOLYHEDRON,IG=ae.types.HEIGHTFIELD,DG=ae.types.TRIMESH;class jn{get[AG](){return this._intersectSphere}get[TG](){return this._intersectPlane}get[xG](){return this._intersectBox}get[SG](){return this._intersectConvex}get[MG](){return this._intersectConvex}get[IG](){return this._intersectHeightfield}get[DG](){return this._intersectTrimesh}constructor(e,t){void 0===e&&(e=new b),void 0===t&&(t=new b),this.from=e.clone(),this.to=t.clone(),this.direction=new b,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=jn.ANY,this.result=new ug,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,t){return this.mode=t.mode||jn.ANY,this.result=t.result||new ug,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=typeof t.collisionFilterMask<"u"?t.collisionFilterMask:-1,this.collisionFilterGroup=typeof t.collisionFilterGroup<"u"?t.collisionFilterGroup:-1,this.checkCollisionResponse=!(typeof t.checkCollisionResponse<"u")||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(RG),AI.length=0,e.broadphase.aabbQuery(e,RG,AI),this.intersectBodies(AI),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||!(this.collisionFilterGroup&e.collisionFilterMask)||!(e.collisionFilterGroup&this.collisionFilterMask))return;const r=wCe,s=ECe;for(let o=0,a=e.shapes.length;o<a;o++){const c=e.shapes[o];if((!i||c.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],r),r.vadd(e.position,r),this.intersectShape(c,s,r,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let i=0,r=e.length;!this.result.shouldStop&&i<r;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,i,r){if(function BCe(n,e,t){t.vsub(n,Ll);const i=Ll.dot(e);return e.scale(i,fb),fb.vadd(n,fb),t.distanceTo(fb)}(this.from,this.direction,i)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,t,i,r,e)}_intersectBox(e,t,i,r,s){return this._intersectConvex(e.convexPolyhedronRepresentation,t,i,r,s)}_intersectPlane(e,t,i,r,s){const o=this.from,a=this.to,c=this.direction,l=new b(0,0,1);t.vmult(l,l);const u=new b;o.vsub(i,u);const d=u.dot(l);if(a.vsub(i,u),d*u.dot(l)>0||o.distanceTo(a)<d)return;const f=l.dot(c);if(Math.abs(f)<this.precision)return;const p=new b,g=new b,m=new b;o.vsub(i,p);const y=-l.dot(p)/f;c.scale(y,g),o.vadd(g,m),this.reportIntersection(l,m,s,r,-1)}getAABB(e){const{lowerBound:t,upperBound:i}=e,r=this.to,s=this.from;t.x=Math.min(r.x,s.x),t.y=Math.min(r.y,s.y),t.z=Math.min(r.z,s.z),i.x=Math.max(r.x,s.x),i.y=Math.max(r.y,s.y),i.z=Math.max(r.z,s.z)}_intersectHeightfield(e,t,i,r,s){const o=CCe;o.from.copy(this.from),o.to.copy(this.to),yt.pointToLocalFrame(i,t,o.from,o.from),yt.pointToLocalFrame(i,t,o.to,o.to),o.updateDirection();const a=ACe;let c,l,u,d;c=l=0,u=d=e.data.length-1;const h=new Xt;o.getAABB(h),e.getIndexOfPosition(h.lowerBound.x,h.lowerBound.y,a,!0),c=Math.max(c,a[0]),l=Math.max(l,a[1]),e.getIndexOfPosition(h.upperBound.x,h.upperBound.y,a,!0),u=Math.min(u,a[0]+1),d=Math.min(d,a[1]+1);for(let f=c;f<u;f++)for(let p=l;p<d;p++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(f,p,h),h.overlapsRay(o)){if(e.getConvexTrianglePillar(f,p,!1),yt.pointToWorldFrame(i,t,e.pillarOffset,hb),this._intersectConvex(e.pillarConvex,t,hb,r,s,OG),this.result.shouldStop)return;e.getConvexTrianglePillar(f,p,!0),yt.pointToWorldFrame(i,t,e.pillarOffset,hb),this._intersectConvex(e.pillarConvex,t,hb,r,s,OG)}}}_intersectSphere(e,t,i,r,s){const o=this.from,a=this.to,l=(a.x-o.x)**2+(a.y-o.y)**2+(a.z-o.z)**2,u=2*((a.x-o.x)*(o.x-i.x)+(a.y-o.y)*(o.y-i.y)+(a.z-o.z)*(o.z-i.z)),h=u**2-4*l*((o.x-i.x)**2+(o.y-i.y)**2+(o.z-i.z)**2-e.radius**2),f=TCe,p=xCe;if(!(h<0))if(0===h)o.lerp(a,h,f),f.vsub(i,p),p.normalize(),this.reportIntersection(p,f,s,r,-1);else{const g=(-u-Math.sqrt(h))/(2*l),m=(-u+Math.sqrt(h))/(2*l);if(g>=0&&g<=1&&(o.lerp(a,g,f),f.vsub(i,p),p.normalize(),this.reportIntersection(p,f,s,r,-1)),this.result.shouldStop)return;m>=0&&m<=1&&(o.lerp(a,m,f),f.vsub(i,p),p.normalize(),this.reportIntersection(p,f,s,r,-1))}}_intersectConvex(e,t,i,r,s,o){const a=SCe,c=PG,l=o&&o.faceList||null,u=e.faces,d=e.vertices,h=e.faceNormals,f=this.direction,p=this.from,m=p.distanceTo(this.to),y=l?l.length:u.length,v=this.result;for(let _=0;!v.shouldStop&&_<y;_++){const E=l?l[_]:_,A=u[E],x=h[E],I=t,S=i;c.copy(d[A[0]]),I.vmult(c,c),c.vadd(S,c),c.vsub(p,c),I.vmult(x,a);const F=f.dot(a);if(Math.abs(F)<this.precision)continue;const U=a.dot(c)/F;if(!(U<0)){f.scale(U,Ar),Ar.vadd(p,Ar),Hs.copy(d[A[0]]),I.vmult(Hs,Hs),S.vadd(Hs,Hs);for(let V=1;!v.shouldStop&&V<A.length-1;V++){To.copy(d[A[V]]),xo.copy(d[A[V+1]]),I.vmult(To,To),I.vmult(xo,xo),S.vadd(To,To),S.vadd(xo,xo);const G=Ar.distanceTo(p);!jn.pointInTriangle(Ar,Hs,To,xo)&&!jn.pointInTriangle(Ar,To,Hs,xo)||G>m||this.reportIntersection(a,Ar,s,r,E)}}}}_intersectTrimesh(e,t,i,r,s,o){const a=DCe,c=FCe,l=LCe,u=PG,d=RCe,h=OCe,f=PCe,p=kCe,g=NCe,m=e.indices,y=this.from,v=this.to,_=this.direction;l.position.copy(i),l.quaternion.copy(t),yt.vectorToLocalFrame(i,t,_,d),yt.pointToLocalFrame(i,t,y,h),yt.pointToLocalFrame(i,t,v,f),f.x*=e.scale.x,f.y*=e.scale.y,f.z*=e.scale.z,h.x*=e.scale.x,h.y*=e.scale.y,h.z*=e.scale.z,f.vsub(h,d),d.normalize();const E=h.distanceSquared(f);e.tree.rayQuery(this,l,c);for(let A=0,x=c.length;!this.result.shouldStop&&A!==x;A++){const I=c[A];e.getNormal(I,a),e.getVertex(m[3*I],Hs),Hs.vsub(h,u);const S=d.dot(a),F=a.dot(u)/S;if(F<0)continue;d.scale(F,Ar),Ar.vadd(h,Ar),e.getVertex(m[3*I+1],To),e.getVertex(m[3*I+2],xo);const U=Ar.distanceSquared(h);!jn.pointInTriangle(Ar,To,Hs,xo)&&!jn.pointInTriangle(Ar,Hs,To,xo)||U>E||(yt.vectorToWorldFrame(t,a,g),yt.pointToWorldFrame(i,t,Ar,p),this.reportIntersection(g,p,s,r,I))}c.length=0}reportIntersection(e,t,i,r,s){const o=this.from,a=this.to,c=o.distanceTo(t),l=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(l.hitFaceIndex=typeof s<"u"?s:-1,this.mode){case jn.ALL:this.hasHit=!0,l.set(o,a,e,t,i,r,c),l.hasHit=!0,this.callback(l);break;case jn.CLOSEST:(c<l.distance||!l.hasHit)&&(this.hasHit=!0,l.hasHit=!0,l.set(o,a,e,t,i,r,c));break;case jn.ANY:this.hasHit=!0,l.hasHit=!0,l.set(o,a,e,t,i,r,c),l.shouldStop=!0}}static pointInTriangle(e,t,i,r){r.vsub(t,Ll),i.vsub(t,dg),e.vsub(t,TI);const s=Ll.dot(Ll),o=Ll.dot(dg),a=Ll.dot(TI),c=dg.dot(dg),l=dg.dot(TI);let u,d;return(u=c*a-o*l)>=0&&(d=s*l-o*a)>=0&&u+d<s*c-o*o}}jn.CLOSEST=1,jn.ANY=2,jn.ALL=4;const RG=new Xt,AI=[],dg=new b,TI=new b,wCe=new b,ECe=new _n,Ar=new b,Hs=new b,To=new b,xo=new b;new b,new ug;const OG={faceList:[0]},hb=new b,CCe=new jn,ACe=[],TCe=new b,xCe=new b,SCe=new b,PG=(new b,new b,new b),DCe=new b,RCe=new b,OCe=new b,PCe=new b,NCe=new b,kCe=new b;new Xt;const FCe=[],LCe=new yt,Ll=new b,fb=new b;new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new jn,new b,new b,new b,new b(1,0,0),new b(0,1,0),new b(0,0,1),new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new Xt,new b,new Xt,new b,new b,new b,new b,new b,new b,new b,new Xt,new b,new yt,new Xt,new b,new b,new b,new b,new b,new _n,new _n,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new Xt,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new b,new _n,new b,new b,new b,new b,new b,new b,new b,new b,new b,new Xt,new jn;const ni=globalThis.performance||{};if(!ni.now){let n=Date.now();ni.timing&&ni.timing.navigationStart&&(n=ni.timing.navigationStart),ni.now=()=>Date.now()-n}function DI(){return DI=Q(function*(n){console.log("Starting Collisioning");const e=n.filter(o=>!o.scenegraph&&"wireframe"!==o.geometry).map(o=>{const a=new Ge(o.transformMatrix),c=a.transformAsPoint([-1,-1,-1],[]),l=a.transformAsPoint([1,1,1],[]);return{"@id":o["@id"],name:o.tooltip,entityId:o.entityId,bbox:new Xt({lowerBound:new b(...c.map((u,d)=>Math.min(u,l[d]))),upperBound:new b(...l.map((u,d)=>Math.max(u,c[d])))})}}),t=[];for(const o of n.filter(a=>!!a.scenegraph)){const a=yield Wp(o.scenegraph,Qd,{DracoLoader:XM,decompress:!0,postProcess:!0});for(const c of a.scenes??[])ub(c,new Ge(o.transformMatrix),(l,u)=>{if(l.mesh&&l.mesh.primitives&&l.mesh.primitives.length>0)for(const d of l.mesh.primitives)if(d.attributes.POSITION&&d.attributes.POSITION.min){const h=u.transformAsPoint(d.attributes.POSITION.min,[]),f=u.transformAsPoint(d.attributes.POSITION.max,[]);t.push({"@id":o["@id"],name:l.name,entityId:o.entityId,bbox:new Xt({lowerBound:new b(...h.map((p,g)=>Math.min(p,f[g]))),upperBound:new b(...f.map((p,g)=>Math.max(p,h[g])))}),gltf:a})}return!0})}const i=[],r=[];for(const o of e){const a=[];for(const c of t)o.bbox.overlaps(c.bbox)&&a.push({"@id":c["@id"],name:c.name});a.length>0?i.push({"@id":o.entityId,name:o.name,hits:a}):r.push(o)}console.log({sourceBoxes:e,targetBoxes:t,report:i,sad:r,maxHits:Math.max(...i.map(o=>o.hits.length))});const s=[];for(const o of i){s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":"","Hit Name":""});for(const a of o.hits)s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":a["@id"],"Hit Name":a.name})}return console.log(s),i}),DI.apply(this,arguments)}function RI(n,e,t){if(e&&0!==e.length){let i;switch(t.geometry){case"sphere":i=new PEe;break;case"cone":i=new LEe;break;case"cylinder":i=new BEe;break;default:i=new GEe}return new eM({id:n,pickable:!0,autoHighlight:!1,highlightColor:[30,136,229,255],coordinateSystem:ut.CARTESIAN,data:e,mesh:i,wireframe:!1,getColor:r=>r.color||[255,255,255,229.5],getTransformMatrix:r=>r.transformMatrix,...t})}}function o4(n,e,t){if(e&&0!==e.length)return new ZS({id:n,pickable:!0,data:e.map(i=>({...i,position:new Ge(i.transformMatrix).getTranslation()})),getText:i=>i.text,getPosition:i=>i.position,getColor:i=>i.color,...t})}new b;let zxe=(()=>{class n extends WS{static{this.layerName="BodyUILayer"}static{this.gltfCache={}}initializeState(){const{data:t}=this.props;this.setState({data:t??[],zoomOpacity:.8,doCollisions:!1}),gG()}renderLayers(){const t=this.state,i={sphere:[],cone:[],cylinder:[],cube:[],text:[],wireframe:[],scenegraph:[]};for(const o of t.data){const a=o.geometry??"cube";o.scenegraph?i.scenegraph.push(o):void 0!==i[a]&&i[a].push(o)}const r={};for(const o of i.scenegraph)o.scenegraph&&o.scenegraphNode&&!Object.prototype.hasOwnProperty.call(r,o.scenegraph)&&(r[o.scenegraph]=_G({scenegraph:o.scenegraph},n.gltfCache));const s=[];for(const[o,a]of Object.entries(i))if("scenegraph"===o)for(const c of a)s.push(new gI({id:"models-"+c["@id"],opacity:c.zoomBasedOpacity?t.zoomOpacity:c.opacity??1,pickable:!c.unpickable,coordinateSystem:ut.CARTESIAN,data:[c],scenegraph:c.scenegraphNode?WEe(c.scenegraphNode,r[c.scenegraph]):c.scenegraph,_lighting:c._lighting,getTransformMatrix:c.transformMatrix,getColor:c.color??[0,255,0,127.5],parameters:{depthMask:!c.zoomBasedOpacity&&(void 0===c.opacity||1===c.opacity)}}));else"text"===o?(s.push(o4("text",a.filter(c=>c.unpickable),{pickable:!1})),s.push(o4("textPickable",a.filter(c=>!c.unpickable),{pickable:!0}))):"wireframe"===o?s.push(RI(o,a,{wireframe:!0,pickable:!1,geometry:o})):(s.push(RI(o,a.filter(c=>c.unpickable),{wireframe:!1,pickable:!1,geometry:o})),s.push(RI(`${o}Pickable`,a.filter(c=>!c.unpickable),{wireframe:!1,pickable:!0,geometry:o})));return t.doCollisions&&function Hxe(n){DI.apply(this,arguments)}(t.data),s.filter(o=>!!o)}getPickingInfo(t){return t.info}}return n})();function a4(n,e=[]){for(const t of n.nodes||n.children||[])e.push(t.name),a4(t,e);return e}function OI(){return OI=Q(function*(n,e,t,i){gG();const r=yield _G({scenegraph:n,scenegraphNode:t},i),s={},o=[];e=new Ge(e??Ge.IDENTITY);for(const a of r.scenes)ub(a,e,(c,l)=>{const u={"@id":c.name||c.id,"@type":"ProcessedNode",transformMatrix:new Ge(l),geometry:"wireframe",node:c};if(o.push({"@id":`GLTF:${u["@id"]}`,"@type":"GLTFNode",scenegraph:n,scenegraphNode:u["@id"],transformMatrix:new Ge(e||Ge.IDENTITY),tooltip:c.name||c.id,color:[255,255,255,255],_lighting:"pbr",zoomBasedOpacity:!0,node:c}),c.mesh&&c.mesh.primitives&&c.mesh.primitives.length>0)for(const d of c.mesh.primitives)if(d.attributes.POSITION&&d.attributes.POSITION.min){const h=l.transformAsPoint(d.attributes.POSITION.min,[]),f=l.transformAsPoint(d.attributes.POSITION.max,[]);u.bbox=new Xt({lowerBound:new b(...h.map((p,g)=>Math.min(p,f[g]))),upperBound:new b(...f.map((p,g)=>Math.max(p,h[g])))})}return s[u["@id"]]=u,!0});for(const a of Object.values(s).filter(c=>!c.bbox)){for(const c of a4(a.node).map(l=>s[l]).filter(l=>l.bbox))a.bbox?a.bbox.extend(c.bbox):a.bbox=c.bbox.clone();a.bbox||delete s[a["@id"]]}for(const a of Object.values(s)){const c=a.bbox.lowerBound,d=(a.size=a.bbox.upperBound.clone().vsub(c)).clone().vmul(new b(.5,.5,.5)),h=a.center=c.clone().vadd(d);a.transformMatrix=new Ge(Ge.IDENTITY).translate(h.toArray()).scale(d.toArray())}for(const a of o)s[a["@id"]]=a;return s}),OI.apply(this,arguments)}class Wxe{constructor(e){this.deckProps=e,this.bodyUILayer=new zxe({}),this.nodeClickSubject=new fe,this.nodeHoverStartSubject=new fe,this.nodeHoverStopSubject=new fe,this.sceneRotationSubject=new On([0,0]),this.nodeDragStartSubject=new fe,this.nodeDragSubject=new fe,this.nodeDragEndSubject=new fe,this.nodeClick$=this.nodeClickSubject.pipe(fa()),this.nodeHoverStart$=this.nodeHoverStartSubject.pipe(fa()),this.nodeHoverStop$=this.nodeHoverStopSubject.pipe(fa()),this.sceneRotation$=this.sceneRotationSubject.pipe(fa()),this.nodeDragStart$=this.nodeDragStartSubject.pipe(fa()),this.nodeDrag$=this.nodeDragSubject.pipe(fa()),this.nodeDragEnd$=this.nodeDragEndSubject.pipe(fa()),this._onHover=i=>{const{lastHovered:r}=this;this.cursor=i.picked?"pointer":void 0,i.picked&&i.object?.["@id"]?r!==i.object&&(r&&this.nodeHoverStopSubject.next(r),this.lastHovered=i.object,this.nodeHoverStartSubject.next(i.object)):r&&(this.nodeHoverStopSubject.next(r),this.lastHovered=void 0)},this._onClick=(i,r)=>{i.picked&&i.object?.["@id"]&&this.nodeClickSubject.next({node:i.object,ctrlClick:r?.srcEvent?.ctrlKey??void 0})},this._onViewStateChange=i=>{if(i.interactionState?.isZooming){const r=this.bodyUILayer.state,s=Math.min(Math.max(1-(i.viewState.zoom-8.9)/2,.05),1);r.zoomOpacity!==s&&this.bodyUILayer.setState({data:r.data,zoomOpacity:s})}this.deck.setProps({viewState:{...i.viewState}}),this.sceneRotationSubject.next([i.viewState.rotationOrbit,i.viewState.rotationX])},this._onDragStart=(i,r)=>{this._dragEvent(i,r,this.nodeDragStartSubject)},this._onDrag=(i,r)=>{this._dragEvent(i,r,this.nodeDragSubject)},this._onDragEnd=(i,r)=>{this._dragEvent(i,r,this.nodeDragEndSubject)};const t={...e,views:["orthographic"===e.camera?new ZT({flipY:!1,near:-1e3}):new AU({orbitAxis:"Y"})],controller:e.interactive??!0,layers:[this.bodyUILayer],onHover:this._onHover,onClick:this._onClick,onViewStateChange:this._onViewStateChange,onDragStart:this._onDragStart,onDrag:this._onDrag,onDragEnd:this._onDragEnd,getCursor:i=>this.cursor??(i.isDragging?"grabbing":"grab")};e.legacyLighting&&(t.effects=[new Dx({ambientLight:new O3({color:[255,255,255],intensity:10})})]),this.deck=new RS(t),this.deck.setProps({viewState:{orbitAxis:"Y",minRotationX:e.minRotationX??-15,maxRotationX:e.maxRotationX??15,target:e.target??[.5,.5,0],rotationX:0,rotationOrbit:e.rotation??0,zoom:e.zoom??9.5,camera:e.camera}}),e.rotation&&this.sceneRotationSubject.next([e.rotation,0])}initialize(){var e=this;return Q(function*(){for(;!e.bodyUILayer.state;)yield new Promise(t=>{setTimeout(t,200)})})()}finalize(){this.deck.finalize()}setScene(e){if(e?.length>0){let t=this.bodyUILayer.state.zoomOpacity,i=!1;for(const r of e)r.zoomToOnLoad&&(this.zoomTo(r),i=!0);t=i?.05:t,this.deckProps.debugSceneNodeProcessing?this.debugSceneNodeProcessing(e,t):this.bodyUILayer.setState({data:e,zoomOpacity:t})}}debugSceneNodeProcessing(e,t){const i="https://hubmapconsortium.github.io/ccf-3d-reference-object-library/VH_Female/United/VHF_United_Color.glb",r=new Ge([.076,0,0,0,0,.076,16875389974302382e-33,0,0,-16875389974302382e-33,.076,0,.49,.034,.11,1]);(function Gxe(n,e,t,i){return OI.apply(this,arguments)})(i,r,"VHF_Kidney_L_Low1").then(s=>{console.log("results",s),console.log("data",e),(e=e.concat(Object.values(s))).push({"@id":"TEST","@type":"TEST",scenegraph:i,scenegraphNode:"VHF_Kidney_R_Low",transformMatrix:r,color:[255,255,255,200],_lighting:"pbr",zoomBasedOpacity:!1}),this.bodyUILayer.setState({data:e,zoomOpacity:t})})}zoomTo(e){const t=new Ge(e.transformMatrix);this.deck.setProps({viewState:{...this.deck.props.viewState,target:t.getTranslation(),rotationX:0,rotationOrbit:0,zoom:11.5}})}setRotation(e){this.deck.setProps({viewState:{...this.deck.props.viewState,rotationOrbit:e}})}setRotationX(e){this.deck.setProps({viewState:{...this.deck.props.viewState,rotationX:e}})}setZoom(e){this.deck.setProps({viewState:{...this.deck.props.viewState,zoom:e}})}setTarget(e){this.deck.setProps({viewState:{...this.deck.props.viewState,target:e}})}setInteractive(e){this.deck.setProps({controller:e})}_dragEvent(e,t,i){e?.object?.["@id"]&&i.next({node:e.object,info:e,e:t})}}var dt;!function(n){n.assertEqual=r=>r,n.assertIs=function e(r){},n.assertNever=function t(r){throw new Error},n.arrayToEnum=r=>{const s={};for(const o of r)s[o]=o;return s},n.getValidEnumValues=r=>{const s=n.objectKeys(r).filter(a=>"number"!=typeof r[r[a]]),o={};for(const a of s)o[a]=r[a];return n.objectValues(o)},n.objectValues=r=>n.objectKeys(r).map(function(s){return r[s]}),n.objectKeys="function"==typeof Object.keys?r=>Object.keys(r):r=>{const s=[];for(const o in r)Object.prototype.hasOwnProperty.call(r,o)&&s.push(o);return s},n.find=(r,s)=>{for(const o of r)if(s(o))return o},n.isInteger="function"==typeof Number.isInteger?r=>Number.isInteger(r):r=>"number"==typeof r&&isFinite(r)&&Math.floor(r)===r,n.joinValues=function i(r,s=" | "){return r.map(o=>"string"==typeof o?`'${o}'`:o).join(s)},n.jsonStringifyReplacer=(r,s)=>"bigint"==typeof s?s.toString():s}(dt||(dt={}));var c4=function(n){return n.mergeShapes=(e,t)=>({...e,...t}),n}(c4||{});const ce=dt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),va=n=>{switch(typeof n){case"undefined":return ce.undefined;case"string":return ce.string;case"number":return isNaN(n)?ce.nan:ce.number;case"boolean":return ce.boolean;case"function":return ce.function;case"bigint":return ce.bigint;case"symbol":return ce.symbol;case"object":return Array.isArray(n)?ce.array:null===n?ce.null:n.then&&"function"==typeof n.then&&n.catch&&"function"==typeof n.catch?ce.promise:typeof Map<"u"&&n instanceof Map?ce.map:typeof Set<"u"&&n instanceof Set?ce.set:typeof Date<"u"&&n instanceof Date?ce.date:ce.object;default:return ce.unknown}},X=dt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);let ba=(()=>{class n extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const i=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,i):this.__proto__=i,this.name="ZodError",this.issues=t}format(t){const i=t||function(o){return o.message},r={_errors:[]},s=o=>{for(const a of o.issues)if("invalid_union"===a.code)a.unionErrors.map(s);else if("invalid_return_type"===a.code)s(a.returnTypeError);else if("invalid_arguments"===a.code)s(a.argumentsError);else if(0===a.path.length)r._errors.push(i(a));else{let c=r,l=0;for(;l<a.path.length;){const u=a.path[l];l===a.path.length-1?(c[u]=c[u]||{_errors:[]},c[u]._errors.push(i(a))):c[u]=c[u]||{_errors:[]},c=c[u],l++}}};return s(this),r}static assert(t){if(!(t instanceof n))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,dt.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(t=i=>i.message){const i={},r=[];for(const s of this.issues)s.path.length>0?(i[s.path[0]]=i[s.path[0]]||[],i[s.path[0]].push(t(s))):r.push(t(s));return{formErrors:r,fieldErrors:i}}get formErrors(){return this.flatten()}}return n.create=e=>new n(e),n})();const ih=(n,e)=>{let t;switch(n.code){case X.invalid_type:t=n.received===ce.undefined?"Required":`Expected ${n.expected}, received ${n.received}`;break;case X.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,dt.jsonStringifyReplacer)}`;break;case X.unrecognized_keys:t=`Unrecognized key(s) in object: ${dt.joinValues(n.keys,", ")}`;break;case X.invalid_union:t="Invalid input";break;case X.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${dt.joinValues(n.options)}`;break;case X.invalid_enum_value:t=`Invalid enum value. Expected ${dt.joinValues(n.options)}, received '${n.received}'`;break;case X.invalid_arguments:t="Invalid function arguments";break;case X.invalid_return_type:t="Invalid function return type";break;case X.invalid_date:t="Invalid date";break;case X.invalid_string:"object"==typeof n.validation?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,"number"==typeof n.validation.position&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:dt.assertNever(n.validation):t="regex"!==n.validation?`Invalid ${n.validation}`:"Invalid";break;case X.too_small:t="array"===n.type?`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:"string"===n.type?`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:"number"===n.type?`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:"date"===n.type?`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:"Invalid input";break;case X.too_big:t="array"===n.type?`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:"string"===n.type?`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:"number"===n.type?`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:"bigint"===n.type?`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:"date"===n.type?`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:"Invalid input";break;case X.custom:t="Invalid input";break;case X.invalid_intersection_types:t="Intersection results could not be merged";break;case X.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case X.not_finite:t="Number must be finite";break;default:t=e.defaultError,dt.assertNever(n)}return{message:t}};let l4=ih;function Eb(){return l4}const Cb=n=>{const{data:e,path:t,errorMaps:i,issueData:r}=n,s=[...t,...r.path||[]],o={...r,path:s};if(void 0!==r.message)return{...r,path:s,message:r.message};let a="";const c=i.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...r,path:s,message:a}};function ie(n,e){const t=Eb(),i=Cb({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===ih?void 0:ih].filter(r=>!!r)});n.common.issues.push(i)}class zi{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const i=[];for(const r of t){if("aborted"===r.status)return ke;"dirty"===r.status&&e.dirty(),i.push(r.value)}return{status:e.value,value:i}}static mergeObjectAsync(e,t){return Q(function*(){const i=[];for(const r of t){const s=yield r.key,o=yield r.value;i.push({key:s,value:o})}return zi.mergeObjectSync(e,i)})()}static mergeObjectSync(e,t){const i={};for(const r of t){const{key:s,value:o}=r;if("aborted"===s.status||"aborted"===o.status)return ke;"dirty"===s.status&&e.dirty(),"dirty"===o.status&&e.dirty(),"__proto__"!==s.value&&(typeof o.value<"u"||r.alwaysSet)&&(i[s.value]=o.value)}return{status:e.value,value:i}}}const ke=Object.freeze({status:"aborted"}),rh=n=>({status:"dirty",value:n}),sr=n=>({status:"valid",value:n}),PI=n=>"aborted"===n.status,NI=n=>"dirty"===n.status,jl=n=>"valid"===n.status,yg=n=>typeof Promise<"u"&&n instanceof Promise;function Ab(n,e,t,i){if("a"===t&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?i:"a"===t?i.call(n):i?i.value:e.get(n)}function u4(n,e,t,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?n!==e||!r:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(n,t):r?r.value=t:e.set(n,t),t}"function"==typeof SuppressedError&&SuppressedError;var vg,bg,me=function(n){return n.errToObj=e=>"string"==typeof e?{message:e}:e||{},n.toString=e=>"string"==typeof e?e:e?.message,n}(me||{});class Mo{constructor(e,t,i,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=i,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const d4=(n,e)=>{if(jl(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new ba(n.common.issues);return this._error=t,this._error}}};function je(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:i,description:r}=n;if(e&&(t||i))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return e?{errorMap:e,description:r}:{errorMap:(o,a)=>{var c,l;const{message:u}=n;return"invalid_enum_value"===o.code?{message:u??a.defaultError}:typeof a.data>"u"?{message:null!==(c=u??i)&&void 0!==c?c:a.defaultError}:"invalid_type"!==o.code?{message:a.defaultError}:{message:null!==(l=u??t)&&void 0!==l?l:a.defaultError}},description:r}}class Ye{get description(){return this._def.description}_getType(e){return va(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:va(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new zi,ctx:{common:e.parent.common,data:e.data,parsedType:va(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(yg(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const i=this.safeParse(e,t);if(i.success)return i.data;throw i.error}safeParse(e,t){var i;const r={common:{issues:[],async:null!==(i=t?.async)&&void 0!==i&&i,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:va(e)},s=this._parseSync({data:e,path:r.path,parent:r});return d4(r,s)}"~validate"(e){var t,i;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:va(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:r});return jl(s)?{value:s.value}:{issues:r.common.issues}}catch(s){!(null===(i=null===(t=s?.message)||void 0===t?void 0:t.toLowerCase())||void 0===i)&&i.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(s=>jl(s)?{value:s.value}:{issues:r.common.issues})}parseAsync(e,t){var i=this;return Q(function*(){const r=yield i.safeParseAsync(e,t);if(r.success)return r.data;throw r.error})()}safeParseAsync(e,t){var i=this;return Q(function*(){const r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:i._def.errorMap,parent:null,data:e,parsedType:va(e)},s=i._parse({data:e,path:r.path,parent:r}),o=yield yg(s)?s:Promise.resolve(s);return d4(r,o)})()}refine(e,t){const i=r=>"string"==typeof t||typeof t>"u"?{message:t}:"function"==typeof t?t(r):t;return this._refinement((r,s)=>{const o=e(r),a=()=>s.addIssue({code:X.custom,...i(r)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>!!c||(a(),!1)):!!o||(a(),!1)})}refinement(e,t){return this._refinement((i,r)=>!!e(i)||(r.addIssue("function"==typeof t?t(i,r):t),!1))}_refinement(e){return new zl({schema:this,typeName:Fe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Cc.create(this,this._def)}nullable(){return lh.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Eg.create(this)}promise(){return Mb.create(this,this._def)}or(e){return HI.create([this,e],this._def)}and(e){return GI.create(this,e,this._def)}transform(e){return new zl({...je(this._def),schema:this,typeName:Fe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new qI({...je(this._def),innerType:this,defaultValue:t,typeName:Fe.ZodDefault})}brand(){return new YI({typeName:Fe.ZodBranded,type:this,...je(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new XI({...je(this._def),innerType:this,catchValue:t,typeName:Fe.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return Tg.create(this,e)}readonly(){return ZI.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Yxe=/^c[^\s-]{8,}$/i,Zxe=/^[0-9a-z]+$/,Kxe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Jxe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Qxe=/^[a-z0-9_-]{21}$/i,eSe=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,tSe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,nSe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let kI;const rSe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,sSe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,oSe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,aSe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,cSe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,lSe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,h4="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",uSe=new RegExp(`^${h4}$`);function f4(n){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return n.precision?e=`${e}\\.\\d{${n.precision}}`:null==n.precision&&(e=`${e}(\\.\\d+)?`),e}function dSe(n){return new RegExp(`^${f4(n)}$`)}function p4(n){let e=`${h4}T${f4(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function hSe(n,e){return!(("v4"!==e&&e||!rSe.test(n))&&("v6"!==e&&e||!oSe.test(n)))}function fSe(n,e){if(!eSe.test(n))return!1;try{const[t]=n.split("."),i=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),r=JSON.parse(atob(i));return!("object"!=typeof r||null===r||!r.typ||!r.alg||e&&r.alg!==e)}catch{return!1}}function pSe(n,e){return!(("v4"!==e&&e||!sSe.test(n))&&("v6"!==e&&e||!aSe.test(n)))}let Tb=(()=>{class n extends Ye{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==ce.string){const o=this._getOrReturnCtx(t);return ie(o,{code:X.invalid_type,expected:ce.string,received:o.parsedType}),ke}const r=new zi;let s;for(const o of this._def.checks)if("min"===o.kind)t.data.length<o.value&&(s=this._getOrReturnCtx(t,s),ie(s,{code:X.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if("max"===o.kind)t.data.length>o.value&&(s=this._getOrReturnCtx(t,s),ie(s,{code:X.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if("length"===o.kind){const a=t.data.length>o.value,c=t.data.length<o.value;(a||c)&&(s=this._getOrReturnCtx(t,s),a?ie(s,{code:X.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):c&&ie(s,{code:X.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),r.dirty())}else if("email"===o.kind)nSe.test(t.data)||(s=this._getOrReturnCtx(t,s),ie(s,{validation:"email",code:X.invalid_string,message:o.message}),r.dirty());else if("emoji"===o.kind)kI||(kI=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),kI.test(t.data)||(s=this._getOrReturnCtx(t,s),ie(s,{validation:"emoji",code:X.invalid_string,message:o.message}),r.dirty());else if("uuid"===o.kind)Jxe.test(t.data)||(s=this._getOrReturnCtx(t,s),ie(s,{validation:"uuid",code:X.invalid_string,message:o.message}),r.dirty());else if("nanoid"===o.kind)Qxe.test(t.data)||(s=this._getOrReturnCtx(t,s),ie(s,{validation:"nanoid",code:X.invalid_string,message:o.message}),r.dirty());else if("cuid"===o.kind)Yxe.test(t.data)||(s=this._getOrReturnCtx(t,s),ie(s,{validation:"cuid",code:X.invalid_string,message:o.message}),r.dirty());else if("cuid2"===o.kind)Zxe.test(t.data)||(s=this._getOrReturnCtx(t,s),ie(s,{validation:"cuid2",code:X.invalid_string,message:o.message}),r.dirty());else if("ulid"===o.kind)Kxe.test(t.data)||(s=this._getOrReturnCtx(t,s),ie(s,{validation:"ulid",code:X.invalid_string,message:o.message}),r.dirty());else if("url"===o.kind)try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),ie(s,{validation:"url",code:X.invalid_string,message:o.message}),r.dirty()}else"regex"===o.kind?(o.regex.lastIndex=0,o.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),ie(s,{validation:"regex",code:X.invalid_string,message:o.message}),r.dirty())):"trim"===o.kind?t.data=t.data.trim():"includes"===o.kind?t.data.includes(o.value,o.position)||(s=this._getOrReturnCtx(t,s),ie(s,{code:X.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),r.dirty()):"toLowerCase"===o.kind?t.data=t.data.toLowerCase():"toUpperCase"===o.kind?t.data=t.data.toUpperCase():"startsWith"===o.kind?t.data.startsWith(o.value)||(s=this._getOrReturnCtx(t,s),ie(s,{code:X.invalid_string,validation:{startsWith:o.value},message:o.message}),r.dirty()):"endsWith"===o.kind?t.data.endsWith(o.value)||(s=this._getOrReturnCtx(t,s),ie(s,{code:X.invalid_string,validation:{endsWith:o.value},message:o.message}),r.dirty()):"datetime"===o.kind?p4(o).test(t.data)||(s=this._getOrReturnCtx(t,s),ie(s,{code:X.invalid_string,validation:"datetime",message:o.message}),r.dirty()):"date"===o.kind?uSe.test(t.data)||(s=this._getOrReturnCtx(t,s),ie(s,{code:X.invalid_string,validation:"date",message:o.message}),r.dirty()):"time"===o.kind?dSe(o).test(t.data)||(s=this._getOrReturnCtx(t,s),ie(s,{code:X.invalid_string,validation:"time",message:o.message}),r.dirty()):"duration"===o.kind?tSe.test(t.data)||(s=this._getOrReturnCtx(t,s),ie(s,{validation:"duration",code:X.invalid_string,message:o.message}),r.dirty()):"ip"===o.kind?hSe(t.data,o.version)||(s=this._getOrReturnCtx(t,s),ie(s,{validation:"ip",code:X.invalid_string,message:o.message}),r.dirty()):"jwt"===o.kind?fSe(t.data,o.alg)||(s=this._getOrReturnCtx(t,s),ie(s,{validation:"jwt",code:X.invalid_string,message:o.message}),r.dirty()):"cidr"===o.kind?pSe(t.data,o.version)||(s=this._getOrReturnCtx(t,s),ie(s,{validation:"cidr",code:X.invalid_string,message:o.message}),r.dirty()):"base64"===o.kind?cSe.test(t.data)||(s=this._getOrReturnCtx(t,s),ie(s,{validation:"base64",code:X.invalid_string,message:o.message}),r.dirty()):"base64url"===o.kind?lSe.test(t.data)||(s=this._getOrReturnCtx(t,s),ie(s,{validation:"base64url",code:X.invalid_string,message:o.message}),r.dirty()):dt.assertNever(o);return{status:r.value,value:t.data}}_regex(t,i,r){return this.refinement(s=>t.test(s),{validation:i,code:X.invalid_string,...me.errToObj(r)})}_addCheck(t){return new n({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...me.errToObj(t)})}url(t){return this._addCheck({kind:"url",...me.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...me.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...me.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...me.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...me.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...me.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...me.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...me.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...me.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...me.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...me.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...me.errToObj(t)})}datetime(t){var i,r;return this._addCheck("string"==typeof t?{kind:"datetime",precision:null,offset:!1,local:!1,message:t}:{kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:null!==(i=t?.offset)&&void 0!==i&&i,local:null!==(r=t?.local)&&void 0!==r&&r,...me.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return this._addCheck("string"==typeof t?{kind:"time",precision:null,message:t}:{kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,...me.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",...me.errToObj(t)})}regex(t,i){return this._addCheck({kind:"regex",regex:t,...me.errToObj(i)})}includes(t,i){return this._addCheck({kind:"includes",value:t,position:i?.position,...me.errToObj(i?.message)})}startsWith(t,i){return this._addCheck({kind:"startsWith",value:t,...me.errToObj(i)})}endsWith(t,i){return this._addCheck({kind:"endsWith",value:t,...me.errToObj(i)})}min(t,i){return this._addCheck({kind:"min",value:t,...me.errToObj(i)})}max(t,i){return this._addCheck({kind:"max",value:t,...me.errToObj(i)})}length(t,i){return this._addCheck({kind:"length",value:t,...me.errToObj(i)})}nonempty(t){return this.min(1,me.errToObj(t))}trim(){return new n({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new n({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new n({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>"datetime"===t.kind)}get isDate(){return!!this._def.checks.find(t=>"date"===t.kind)}get isTime(){return!!this._def.checks.find(t=>"time"===t.kind)}get isDuration(){return!!this._def.checks.find(t=>"duration"===t.kind)}get isEmail(){return!!this._def.checks.find(t=>"email"===t.kind)}get isURL(){return!!this._def.checks.find(t=>"url"===t.kind)}get isEmoji(){return!!this._def.checks.find(t=>"emoji"===t.kind)}get isUUID(){return!!this._def.checks.find(t=>"uuid"===t.kind)}get isNANOID(){return!!this._def.checks.find(t=>"nanoid"===t.kind)}get isCUID(){return!!this._def.checks.find(t=>"cuid"===t.kind)}get isCUID2(){return!!this._def.checks.find(t=>"cuid2"===t.kind)}get isULID(){return!!this._def.checks.find(t=>"ulid"===t.kind)}get isIP(){return!!this._def.checks.find(t=>"ip"===t.kind)}get isCIDR(){return!!this._def.checks.find(t=>"cidr"===t.kind)}get isBase64(){return!!this._def.checks.find(t=>"base64"===t.kind)}get isBase64url(){return!!this._def.checks.find(t=>"base64url"===t.kind)}get minLength(){let t=null;for(const i of this._def.checks)"min"===i.kind&&(null===t||i.value>t)&&(t=i.value);return t}get maxLength(){let t=null;for(const i of this._def.checks)"max"===i.kind&&(null===t||i.value<t)&&(t=i.value);return t}}return n.create=e=>{var t;return new n({checks:[],typeName:Fe.ZodString,coerce:null!==(t=e?.coerce)&&void 0!==t&&t,...je(e)})},n})();function gSe(n,e){const t=(n.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,r=t>i?t:i;return parseInt(n.toFixed(r).replace(".",""))%parseInt(e.toFixed(r).replace(".",""))/Math.pow(10,r)}let FI=(()=>{class n extends Ye{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==ce.number){const o=this._getOrReturnCtx(t);return ie(o,{code:X.invalid_type,expected:ce.number,received:o.parsedType}),ke}let r;const s=new zi;for(const o of this._def.checks)"int"===o.kind?dt.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),ie(r,{code:X.invalid_type,expected:"integer",received:"float",message:o.message}),s.dirty()):"min"===o.kind?(o.inclusive?t.data<o.value:t.data<=o.value)&&(r=this._getOrReturnCtx(t,r),ie(r,{code:X.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):"max"===o.kind?(o.inclusive?t.data>o.value:t.data>=o.value)&&(r=this._getOrReturnCtx(t,r),ie(r,{code:X.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):"multipleOf"===o.kind?0!==gSe(t.data,o.value)&&(r=this._getOrReturnCtx(t,r),ie(r,{code:X.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):"finite"===o.kind?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),ie(r,{code:X.not_finite,message:o.message}),s.dirty()):dt.assertNever(o);return{status:s.value,value:t.data}}gte(t,i){return this.setLimit("min",t,!0,me.toString(i))}gt(t,i){return this.setLimit("min",t,!1,me.toString(i))}lte(t,i){return this.setLimit("max",t,!0,me.toString(i))}lt(t,i){return this.setLimit("max",t,!1,me.toString(i))}setLimit(t,i,r,s){return new n({...this._def,checks:[...this._def.checks,{kind:t,value:i,inclusive:r,message:me.toString(s)}]})}_addCheck(t){return new n({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:me.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:me.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:me.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:me.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:me.toString(t)})}multipleOf(t,i){return this._addCheck({kind:"multipleOf",value:t,message:me.toString(i)})}finite(t){return this._addCheck({kind:"finite",message:me.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:me.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:me.toString(t)})}get minValue(){let t=null;for(const i of this._def.checks)"min"===i.kind&&(null===t||i.value>t)&&(t=i.value);return t}get maxValue(){let t=null;for(const i of this._def.checks)"max"===i.kind&&(null===t||i.value<t)&&(t=i.value);return t}get isInt(){return!!this._def.checks.find(t=>"int"===t.kind||"multipleOf"===t.kind&&dt.isInteger(t.value))}get isFinite(){let t=null,i=null;for(const r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===i||r.value>i)&&(i=r.value):"max"===r.kind&&(null===t||r.value<t)&&(t=r.value)}return Number.isFinite(i)&&Number.isFinite(t)}}return n.create=e=>new n({checks:[],typeName:Fe.ZodNumber,coerce:e?.coerce||!1,...je(e)}),n})(),LI=(()=>{class n extends Ye{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==ce.bigint)return this._getInvalidInput(t);let r;const s=new zi;for(const o of this._def.checks)"min"===o.kind?(o.inclusive?t.data<o.value:t.data<=o.value)&&(r=this._getOrReturnCtx(t,r),ie(r,{code:X.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):"max"===o.kind?(o.inclusive?t.data>o.value:t.data>=o.value)&&(r=this._getOrReturnCtx(t,r),ie(r,{code:X.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):"multipleOf"===o.kind?t.data%o.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),ie(r,{code:X.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):dt.assertNever(o);return{status:s.value,value:t.data}}_getInvalidInput(t){const i=this._getOrReturnCtx(t);return ie(i,{code:X.invalid_type,expected:ce.bigint,received:i.parsedType}),ke}gte(t,i){return this.setLimit("min",t,!0,me.toString(i))}gt(t,i){return this.setLimit("min",t,!1,me.toString(i))}lte(t,i){return this.setLimit("max",t,!0,me.toString(i))}lt(t,i){return this.setLimit("max",t,!1,me.toString(i))}setLimit(t,i,r,s){return new n({...this._def,checks:[...this._def.checks,{kind:t,value:i,inclusive:r,message:me.toString(s)}]})}_addCheck(t){return new n({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:me.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:me.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:me.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:me.toString(t)})}multipleOf(t,i){return this._addCheck({kind:"multipleOf",value:t,message:me.toString(i)})}get minValue(){let t=null;for(const i of this._def.checks)"min"===i.kind&&(null===t||i.value>t)&&(t=i.value);return t}get maxValue(){let t=null;for(const i of this._def.checks)"max"===i.kind&&(null===t||i.value<t)&&(t=i.value);return t}}return n.create=e=>{var t;return new n({checks:[],typeName:Fe.ZodBigInt,coerce:null!==(t=e?.coerce)&&void 0!==t&&t,...je(e)})},n})(),BI=(()=>{class n extends Ye{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==ce.boolean){const r=this._getOrReturnCtx(t);return ie(r,{code:X.invalid_type,expected:ce.boolean,received:r.parsedType}),ke}return sr(t.data)}}return n.create=e=>new n({typeName:Fe.ZodBoolean,coerce:e?.coerce||!1,...je(e)}),n})(),VI=(()=>{class n extends Ye{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==ce.date){const o=this._getOrReturnCtx(t);return ie(o,{code:X.invalid_type,expected:ce.date,received:o.parsedType}),ke}if(isNaN(t.data.getTime()))return ie(this._getOrReturnCtx(t),{code:X.invalid_date}),ke;const r=new zi;let s;for(const o of this._def.checks)"min"===o.kind?t.data.getTime()<o.value&&(s=this._getOrReturnCtx(t,s),ie(s,{code:X.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),r.dirty()):"max"===o.kind?t.data.getTime()>o.value&&(s=this._getOrReturnCtx(t,s),ie(s,{code:X.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),r.dirty()):dt.assertNever(o);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new n({...this._def,checks:[...this._def.checks,t]})}min(t,i){return this._addCheck({kind:"min",value:t.getTime(),message:me.toString(i)})}max(t,i){return this._addCheck({kind:"max",value:t.getTime(),message:me.toString(i)})}get minDate(){let t=null;for(const i of this._def.checks)"min"===i.kind&&(null===t||i.value>t)&&(t=i.value);return null!=t?new Date(t):null}get maxDate(){let t=null;for(const i of this._def.checks)"max"===i.kind&&(null===t||i.value<t)&&(t=i.value);return null!=t?new Date(t):null}}return n.create=e=>new n({checks:[],coerce:e?.coerce||!1,typeName:Fe.ZodDate,...je(e)}),n})(),g4=(()=>{class n extends Ye{_parse(t){if(this._getType(t)!==ce.symbol){const r=this._getOrReturnCtx(t);return ie(r,{code:X.invalid_type,expected:ce.symbol,received:r.parsedType}),ke}return sr(t.data)}}return n.create=e=>new n({typeName:Fe.ZodSymbol,...je(e)}),n})(),UI=(()=>{class n extends Ye{_parse(t){if(this._getType(t)!==ce.undefined){const r=this._getOrReturnCtx(t);return ie(r,{code:X.invalid_type,expected:ce.undefined,received:r.parsedType}),ke}return sr(t.data)}}return n.create=e=>new n({typeName:Fe.ZodUndefined,...je(e)}),n})(),jI=(()=>{class n extends Ye{_parse(t){if(this._getType(t)!==ce.null){const r=this._getOrReturnCtx(t);return ie(r,{code:X.invalid_type,expected:ce.null,received:r.parsedType}),ke}return sr(t.data)}}return n.create=e=>new n({typeName:Fe.ZodNull,...je(e)}),n})(),xb=(()=>{class n extends Ye{constructor(){super(...arguments),this._any=!0}_parse(t){return sr(t.data)}}return n.create=e=>new n({typeName:Fe.ZodAny,...je(e)}),n})(),wg=(()=>{class n extends Ye{constructor(){super(...arguments),this._unknown=!0}_parse(t){return sr(t.data)}}return n.create=e=>new n({typeName:Fe.ZodUnknown,...je(e)}),n})(),Hl=(()=>{class n extends Ye{_parse(t){const i=this._getOrReturnCtx(t);return ie(i,{code:X.invalid_type,expected:ce.never,received:i.parsedType}),ke}}return n.create=e=>new n({typeName:Fe.ZodNever,...je(e)}),n})(),m4=(()=>{class n extends Ye{_parse(t){if(this._getType(t)!==ce.undefined){const r=this._getOrReturnCtx(t);return ie(r,{code:X.invalid_type,expected:ce.void,received:r.parsedType}),ke}return sr(t.data)}}return n.create=e=>new n({typeName:Fe.ZodVoid,...je(e)}),n})(),Eg=(()=>{class n extends Ye{_parse(t){const{ctx:i,status:r}=this._processInputParams(t),s=this._def;if(i.parsedType!==ce.array)return ie(i,{code:X.invalid_type,expected:ce.array,received:i.parsedType}),ke;if(null!==s.exactLength){const a=i.data.length>s.exactLength.value,c=i.data.length<s.exactLength.value;(a||c)&&(ie(i,{code:a?X.too_big:X.too_small,minimum:c?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(null!==s.minLength&&i.data.length<s.minLength.value&&(ie(i,{code:X.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),null!==s.maxLength&&i.data.length>s.maxLength.value&&(ie(i,{code:X.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),i.common.async)return Promise.all([...i.data].map((a,c)=>s.type._parseAsync(new Mo(i,a,i.path,c)))).then(a=>zi.mergeArray(r,a));const o=[...i.data].map((a,c)=>s.type._parseSync(new Mo(i,a,i.path,c)));return zi.mergeArray(r,o)}get element(){return this._def.type}min(t,i){return new n({...this._def,minLength:{value:t,message:me.toString(i)}})}max(t,i){return new n({...this._def,maxLength:{value:t,message:me.toString(i)}})}length(t,i){return new n({...this._def,exactLength:{value:t,message:me.toString(i)}})}nonempty(t){return this.min(1,t)}}return n.create=(e,t)=>new n({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Fe.ZodArray,...je(t)}),n})();function sh(n){if(n instanceof oh){const e={};for(const t in n.shape)e[t]=Cc.create(sh(n.shape[t]));return new oh({...n._def,shape:()=>e})}return n instanceof Eg?new Eg({...n._def,type:sh(n.element)}):n instanceof Cc?Cc.create(sh(n.unwrap())):n instanceof lh?lh.create(sh(n.unwrap())):n instanceof ah?ah.create(n.items.map(e=>sh(e))):n}let oh=(()=>{class n extends Ye{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const t=this._def.shape(),i=dt.objectKeys(t);return this._cached={shape:t,keys:i}}_parse(t){if(this._getType(t)!==ce.object){const u=this._getOrReturnCtx(t);return ie(u,{code:X.invalid_type,expected:ce.object,received:u.parsedType}),ke}const{status:r,ctx:s}=this._processInputParams(t),{shape:o,keys:a}=this._getCached(),c=[];if(!(this._def.catchall instanceof Hl&&"strip"===this._def.unknownKeys))for(const u in s.data)a.includes(u)||c.push(u);const l=[];for(const u of a)l.push({key:{status:"valid",value:u},value:o[u]._parse(new Mo(s,s.data[u],s.path,u)),alwaysSet:u in s.data});if(this._def.catchall instanceof Hl){const u=this._def.unknownKeys;if("passthrough"===u)for(const d of c)l.push({key:{status:"valid",value:d},value:{status:"valid",value:s.data[d]}});else if("strict"===u)c.length>0&&(ie(s,{code:X.unrecognized_keys,keys:c}),r.dirty());else if("strip"!==u)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const d of c)l.push({key:{status:"valid",value:d},value:u._parse(new Mo(s,s.data[d],s.path,d)),alwaysSet:d in s.data})}return s.common.async?Promise.resolve().then(Q(function*(){const u=[];for(const d of l){const h=yield d.key,f=yield d.value;u.push({key:h,value:f,alwaysSet:d.alwaysSet})}return u})).then(u=>zi.mergeObjectSync(r,u)):zi.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(t){return new n({...this._def,unknownKeys:"strict",...void 0!==t?{errorMap:(i,r)=>{var s,o,a,c;const l=null!==(a=null===(o=(s=this._def).errorMap)||void 0===o?void 0:o.call(s,i,r).message)&&void 0!==a?a:r.defaultError;return"unrecognized_keys"===i.code?{message:null!==(c=me.errToObj(t).message)&&void 0!==c?c:l}:{message:l}}}:{}})}strip(){return new n({...this._def,unknownKeys:"strip"})}passthrough(){return new n({...this._def,unknownKeys:"passthrough"})}extend(t){return new n({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new n({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Fe.ZodObject})}setKey(t,i){return this.augment({[t]:i})}catchall(t){return new n({...this._def,catchall:t})}pick(t){const i={};return dt.objectKeys(t).forEach(r=>{t[r]&&this.shape[r]&&(i[r]=this.shape[r])}),new n({...this._def,shape:()=>i})}omit(t){const i={};return dt.objectKeys(this.shape).forEach(r=>{t[r]||(i[r]=this.shape[r])}),new n({...this._def,shape:()=>i})}deepPartial(){return sh(this)}partial(t){const i={};return dt.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];i[r]=t&&!t[r]?s:s.optional()}),new n({...this._def,shape:()=>i})}required(t){const i={};return dt.objectKeys(this.shape).forEach(r=>{if(t&&!t[r])i[r]=this.shape[r];else{let o=this.shape[r];for(;o instanceof Cc;)o=o._def.innerType;i[r]=o}}),new n({...this._def,shape:()=>i})}keyof(){return v4(dt.objectKeys(this.shape))}}return n.create=(e,t)=>new n({shape:()=>e,unknownKeys:"strip",catchall:Hl.create(),typeName:Fe.ZodObject,...je(t)}),n.strictCreate=(e,t)=>new n({shape:()=>e,unknownKeys:"strict",catchall:Hl.create(),typeName:Fe.ZodObject,...je(t)}),n.lazycreate=(e,t)=>new n({shape:e,unknownKeys:"strip",catchall:Hl.create(),typeName:Fe.ZodObject,...je(t)}),n})(),HI=(()=>{class n extends Ye{_parse(t){const{ctx:i}=this._processInputParams(t),r=this._def.options;if(i.common.async)return Promise.all(r.map(function(){var o=Q(function*(a){const c={...i,common:{...i.common,issues:[]},parent:null};return{result:yield a._parseAsync({data:i.data,path:i.path,parent:c}),ctx:c}});return function(a){return o.apply(this,arguments)}}())).then(function s(o){for(const c of o)if("valid"===c.result.status)return c.result;for(const c of o)if("dirty"===c.result.status)return i.common.issues.push(...c.ctx.common.issues),c.result;const a=o.map(c=>new ba(c.ctx.common.issues));return ie(i,{code:X.invalid_union,unionErrors:a}),ke});{let o;const a=[];for(const l of r){const u={...i,common:{...i.common,issues:[]},parent:null},d=l._parseSync({data:i.data,path:i.path,parent:u});if("valid"===d.status)return d;"dirty"===d.status&&!o&&(o={result:d,ctx:u}),u.common.issues.length&&a.push(u.common.issues)}if(o)return i.common.issues.push(...o.ctx.common.issues),o.result;const c=a.map(l=>new ba(l));return ie(i,{code:X.invalid_union,unionErrors:c}),ke}}get options(){return this._def.options}}return n.create=(e,t)=>new n({options:e,typeName:Fe.ZodUnion,...je(t)}),n})();const wa=n=>n instanceof WI?wa(n.schema):n instanceof zl?wa(n.innerType()):n instanceof $I?[n.value]:n instanceof Ec?n.options:n instanceof Ag?dt.objectValues(n.enum):n instanceof qI?wa(n._def.innerType):n instanceof UI?[void 0]:n instanceof jI?[null]:n instanceof Cc?[void 0,...wa(n.unwrap())]:n instanceof lh?[null,...wa(n.unwrap())]:n instanceof YI||n instanceof ZI?wa(n.unwrap()):n instanceof XI?wa(n._def.innerType):[];class Sb extends Ye{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ce.object)return ie(t,{code:X.invalid_type,expected:ce.object,received:t.parsedType}),ke;const i=this.discriminator,s=this.optionsMap.get(t.data[i]);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(ie(t,{code:X.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[i]}),ke)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,i){const r=new Map;for(const s of t){const o=wa(s.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(r.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);r.set(a,s)}}return new Sb({typeName:Fe.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...je(i)})}}function zI(n,e){const t=va(n),i=va(e);if(n===e)return{valid:!0,data:n};if(t===ce.object&&i===ce.object){const r=dt.objectKeys(e),s=dt.objectKeys(n).filter(a=>-1!==r.indexOf(a)),o={...n,...e};for(const a of s){const c=zI(n[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}if(t===ce.array&&i===ce.array){if(n.length!==e.length)return{valid:!1};const r=[];for(let s=0;s<n.length;s++){const c=zI(n[s],e[s]);if(!c.valid)return{valid:!1};r.push(c.data)}return{valid:!0,data:r}}return t===ce.date&&i===ce.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}let GI=(()=>{class n extends Ye{_parse(t){const{status:i,ctx:r}=this._processInputParams(t),s=(o,a)=>{if(PI(o)||PI(a))return ke;const c=zI(o.value,a.value);return c.valid?((NI(o)||NI(a))&&i.dirty(),{status:i.value,value:c.data}):(ie(r,{code:X.invalid_intersection_types}),ke)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([o,a])=>s(o,a)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}return n.create=(e,t,i)=>new n({left:e,right:t,typeName:Fe.ZodIntersection,...je(i)}),n})(),ah=(()=>{class n extends Ye{_parse(t){const{status:i,ctx:r}=this._processInputParams(t);if(r.parsedType!==ce.array)return ie(r,{code:X.invalid_type,expected:ce.array,received:r.parsedType}),ke;if(r.data.length<this._def.items.length)return ie(r,{code:X.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ke;!this._def.rest&&r.data.length>this._def.items.length&&(ie(r,{code:X.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),i.dirty());const o=[...r.data].map((a,c)=>{const l=this._def.items[c]||this._def.rest;return l?l._parse(new Mo(r,a,r.path,c)):null}).filter(a=>!!a);return r.common.async?Promise.all(o).then(a=>zi.mergeArray(i,a)):zi.mergeArray(i,o)}get items(){return this._def.items}rest(t){return new n({...this._def,rest:t})}}return n.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new n({items:e,typeName:Fe.ZodTuple,rest:null,...je(t)})},n})();class Cg extends Ye{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:i}=this._processInputParams(e);if(i.parsedType!==ce.object)return ie(i,{code:X.invalid_type,expected:ce.object,received:i.parsedType}),ke;const r=[],s=this._def.keyType,o=this._def.valueType;for(const a in i.data)r.push({key:s._parse(new Mo(i,a,i.path,a)),value:o._parse(new Mo(i,i.data[a],i.path,a)),alwaysSet:a in i.data});return i.common.async?zi.mergeObjectAsync(t,r):zi.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,i){return new Cg(t instanceof Ye?{keyType:e,valueType:t,typeName:Fe.ZodRecord,...je(i)}:{keyType:Tb.create(),valueType:e,typeName:Fe.ZodRecord,...je(t)})}}let _4=(()=>{class n extends Ye{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:i,ctx:r}=this._processInputParams(t);if(r.parsedType!==ce.map)return ie(r,{code:X.invalid_type,expected:ce.map,received:r.parsedType}),ke;const s=this._def.keyType,o=this._def.valueType,a=[...r.data.entries()].map(([c,l],u)=>({key:s._parse(new Mo(r,c,r.path,[u,"key"])),value:o._parse(new Mo(r,l,r.path,[u,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(Q(function*(){for(const l of a){const u=yield l.key,d=yield l.value;if("aborted"===u.status||"aborted"===d.status)return ke;("dirty"===u.status||"dirty"===d.status)&&i.dirty(),c.set(u.value,d.value)}return{status:i.value,value:c}}))}{const c=new Map;for(const l of a){const u=l.key,d=l.value;if("aborted"===u.status||"aborted"===d.status)return ke;("dirty"===u.status||"dirty"===d.status)&&i.dirty(),c.set(u.value,d.value)}return{status:i.value,value:c}}}}return n.create=(e,t,i)=>new n({valueType:t,keyType:e,typeName:Fe.ZodMap,...je(i)}),n})(),y4=(()=>{class n extends Ye{_parse(t){const{status:i,ctx:r}=this._processInputParams(t);if(r.parsedType!==ce.set)return ie(r,{code:X.invalid_type,expected:ce.set,received:r.parsedType}),ke;const s=this._def;null!==s.minSize&&r.data.size<s.minSize.value&&(ie(r,{code:X.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),i.dirty()),null!==s.maxSize&&r.data.size>s.maxSize.value&&(ie(r,{code:X.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),i.dirty());const o=this._def.valueType;function a(l){const u=new Set;for(const d of l){if("aborted"===d.status)return ke;"dirty"===d.status&&i.dirty(),u.add(d.value)}return{status:i.value,value:u}}const c=[...r.data.values()].map((l,u)=>o._parse(new Mo(r,l,r.path,u)));return r.common.async?Promise.all(c).then(l=>a(l)):a(c)}min(t,i){return new n({...this._def,minSize:{value:t,message:me.toString(i)}})}max(t,i){return new n({...this._def,maxSize:{value:t,message:me.toString(i)}})}size(t,i){return this.min(t,i).max(t,i)}nonempty(t){return this.min(1,t)}}return n.create=(e,t)=>new n({valueType:e,minSize:null,maxSize:null,typeName:Fe.ZodSet,...je(t)}),n})();class ch extends Ye{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ce.function)return ie(t,{code:X.invalid_type,expected:ce.function,received:t.parsedType}),ke;function i(a,c){return Cb({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Eb(),ih].filter(l=>!!l),issueData:{code:X.invalid_arguments,argumentsError:c}})}function r(a,c){return Cb({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Eb(),ih].filter(l=>!!l),issueData:{code:X.invalid_return_type,returnTypeError:c}})}const s={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof Mb){const a=this;return sr(Q(function*(...c){const l=new ba([]),u=yield a._def.args.parseAsync(c,s).catch(f=>{throw l.addIssue(i(c,f)),l}),d=yield Reflect.apply(o,this,u);return yield a._def.returns._def.type.parseAsync(d,s).catch(f=>{throw l.addIssue(r(d,f)),l})}))}{const a=this;return sr(function(...c){const l=a._def.args.safeParse(c,s);if(!l.success)throw new ba([i(c,l.error)]);const u=Reflect.apply(o,this,l.data),d=a._def.returns.safeParse(u,s);if(!d.success)throw new ba([r(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ch({...this._def,args:ah.create(e).rest(wg.create())})}returns(e){return new ch({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,i){return new ch({args:e||ah.create([]).rest(wg.create()),returns:t||wg.create(),typeName:Fe.ZodFunction,...je(i)})}}let WI=(()=>{class n extends Ye{get schema(){return this._def.getter()}_parse(t){const{ctx:i}=this._processInputParams(t);return this._def.getter()._parse({data:i.data,path:i.path,parent:i})}}return n.create=(e,t)=>new n({getter:e,typeName:Fe.ZodLazy,...je(t)}),n})(),$I=(()=>{class n extends Ye{_parse(t){if(t.data!==this._def.value){const i=this._getOrReturnCtx(t);return ie(i,{received:i.data,code:X.invalid_literal,expected:this._def.value}),ke}return{status:"valid",value:t.data}}get value(){return this._def.value}}return n.create=(e,t)=>new n({value:e,typeName:Fe.ZodLiteral,...je(t)}),n})();function v4(n,e){return new Ec({values:n,typeName:Fe.ZodEnum,...je(e)})}class Ec extends Ye{constructor(){super(...arguments),vg.set(this,void 0)}_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e);return ie(t,{expected:dt.joinValues(this._def.values),received:t.parsedType,code:X.invalid_type}),ke}if(Ab(this,vg,"f")||u4(this,vg,new Set(this._def.values),"f"),!Ab(this,vg,"f").has(e.data)){const t=this._getOrReturnCtx(e);return ie(t,{received:t.data,code:X.invalid_enum_value,options:this._def.values}),ke}return sr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Ec.create(e,{...this._def,...t})}exclude(e,t=this._def){return Ec.create(this.options.filter(i=>!e.includes(i)),{...this._def,...t})}}vg=new WeakMap,Ec.create=v4;class Ag extends Ye{constructor(){super(...arguments),bg.set(this,void 0)}_parse(e){const t=dt.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(e);if(i.parsedType!==ce.string&&i.parsedType!==ce.number){const r=dt.objectValues(t);return ie(i,{expected:dt.joinValues(r),received:i.parsedType,code:X.invalid_type}),ke}if(Ab(this,bg,"f")||u4(this,bg,new Set(dt.getValidEnumValues(this._def.values)),"f"),!Ab(this,bg,"f").has(e.data)){const r=dt.objectValues(t);return ie(i,{received:i.data,code:X.invalid_enum_value,options:r}),ke}return sr(e.data)}get enum(){return this._def.values}}bg=new WeakMap,Ag.create=(n,e)=>new Ag({values:n,typeName:Fe.ZodNativeEnum,...je(e)});let Mb=(()=>{class n extends Ye{unwrap(){return this._def.type}_parse(t){const{ctx:i}=this._processInputParams(t);if(i.parsedType!==ce.promise&&!1===i.common.async)return ie(i,{code:X.invalid_type,expected:ce.promise,received:i.parsedType}),ke;const r=i.parsedType===ce.promise?i.data:Promise.resolve(i.data);return sr(r.then(s=>this._def.type.parseAsync(s,{path:i.path,errorMap:i.common.contextualErrorMap})))}}return n.create=(e,t)=>new n({type:e,typeName:Fe.ZodPromise,...je(t)}),n})(),zl=(()=>{class n extends Ye{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Fe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){var i=this;const{status:r,ctx:s}=this._processInputParams(t),o=this._def.effect||null,a={addIssue:c=>{ie(s,c),c.fatal?r.abort():r.dirty()},get path(){return s.path}};if(a.addIssue=a.addIssue.bind(a),"preprocess"===o.type){const c=o.transform(s.data,a);if(s.common.async)return Promise.resolve(c).then(function(){var l=Q(function*(u){if("aborted"===r.value)return ke;const d=yield i._def.schema._parseAsync({data:u,path:s.path,parent:s});return"aborted"===d.status?ke:"dirty"===d.status||"dirty"===r.value?rh(d.value):d});return function(u){return l.apply(this,arguments)}}());{if("aborted"===r.value)return ke;const l=this._def.schema._parseSync({data:c,path:s.path,parent:s});return"aborted"===l.status?ke:"dirty"===l.status||"dirty"===r.value?rh(l.value):l}}if("refinement"===o.type){const c=l=>{const u=o.refinement(l,a);if(s.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(!1===s.common.async){const l=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return"aborted"===l.status?ke:("dirty"===l.status&&r.dirty(),c(l.value),{status:r.value,value:l.value})}return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(l=>"aborted"===l.status?ke:("dirty"===l.status&&r.dirty(),c(l.value).then(()=>({status:r.value,value:l.value}))))}if("transform"===o.type){if(!1===s.common.async){const c=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!jl(c))return c;const l=o.transform(c.value,a);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:l}}return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(c=>jl(c)?Promise.resolve(o.transform(c.value,a)).then(l=>({status:r.value,value:l})):c)}dt.assertNever(o)}}return n.create=(e,t,i)=>new n({schema:e,typeName:Fe.ZodEffects,effect:t,...je(i)}),n.createWithPreprocess=(e,t,i)=>new n({schema:t,effect:{type:"preprocess",transform:e},typeName:Fe.ZodEffects,...je(i)}),n})(),Cc=(()=>{class n extends Ye{_parse(t){return this._getType(t)===ce.undefined?sr(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}return n.create=(e,t)=>new n({innerType:e,typeName:Fe.ZodOptional,...je(t)}),n})(),lh=(()=>{class n extends Ye{_parse(t){return this._getType(t)===ce.null?sr(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}return n.create=(e,t)=>new n({innerType:e,typeName:Fe.ZodNullable,...je(t)}),n})(),qI=(()=>{class n extends Ye{_parse(t){const{ctx:i}=this._processInputParams(t);let r=i.data;return i.parsedType===ce.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:i.path,parent:i})}removeDefault(){return this._def.innerType}}return n.create=(e,t)=>new n({innerType:e,typeName:Fe.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...je(t)}),n})(),XI=(()=>{class n extends Ye{_parse(t){const{ctx:i}=this._processInputParams(t),r={...i,common:{...i.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return yg(s)?s.then(o=>({status:"valid",value:"valid"===o.status?o.value:this._def.catchValue({get error(){return new ba(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===s.status?s.value:this._def.catchValue({get error(){return new ba(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}return n.create=(e,t)=>new n({innerType:e,typeName:Fe.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...je(t)}),n})(),b4=(()=>{class n extends Ye{_parse(t){if(this._getType(t)!==ce.nan){const r=this._getOrReturnCtx(t);return ie(r,{code:X.invalid_type,expected:ce.nan,received:r.parsedType}),ke}return{status:"valid",value:t.data}}}return n.create=e=>new n({typeName:Fe.ZodNaN,...je(e)}),n})();const mSe=Symbol("zod_brand");class YI extends Ye{_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.type._parse({data:t.data,path:t.path,parent:t})}unwrap(){return this._def.type}}class Tg extends Ye{_parse(e){var t=this;const{status:i,ctx:r}=this._processInputParams(e);if(r.common.async)return function(){var o=Q(function*(){const a=yield t._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===a.status?ke:"dirty"===a.status?(i.dirty(),rh(a.value)):t._def.out._parseAsync({data:a.value,path:r.path,parent:r})});return function(){return o.apply(this,arguments)}}()();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===s.status?ke:"dirty"===s.status?(i.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,t){return new Tg({in:e,out:t,typeName:Fe.ZodPipeline})}}let ZI=(()=>{class n extends Ye{_parse(t){const i=this._def.innerType._parse(t),r=s=>(jl(s)&&(s.value=Object.freeze(s.value)),s);return yg(i)?i.then(s=>r(s)):r(i)}unwrap(){return this._def.innerType}}return n.create=(e,t)=>new n({innerType:e,typeName:Fe.ZodReadonly,...je(t)}),n})();function w4(n,e={},t){return n?xb.create().superRefine((i,r)=>{var s,o;if(!n(i)){const a="function"==typeof e?e(i):"string"==typeof e?{message:e}:e,c=null===(o=null!==(s=a.fatal)&&void 0!==s?s:t)||void 0===o||o;r.addIssue({code:"custom",..."string"==typeof a?{message:a}:a,fatal:c})}}):xb.create()}const _Se={object:oh.lazycreate};var Fe=function(n){return n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly",n}(Fe||{});const E4=Tb.create,C4=FI.create,vSe=b4.create,bSe=LI.create,A4=BI.create,wSe=VI.create,ESe=g4.create,CSe=UI.create,ASe=jI.create,TSe=xb.create,xSe=wg.create,SSe=Hl.create,MSe=m4.create,ISe=Eg.create,DSe=oh.create,RSe=oh.strictCreate,OSe=HI.create,PSe=Sb.create,NSe=GI.create,kSe=ah.create,FSe=Cg.create,LSe=_4.create,BSe=y4.create,VSe=ch.create,USe=WI.create,jSe=$I.create,HSe=Ec.create,zSe=Ag.create,GSe=Mb.create,T4=zl.create,WSe=Cc.create,$Se=lh.create,qSe=zl.createWithPreprocess,XSe=Tg.create;var Gi=Object.freeze({__proto__:null,defaultErrorMap:ih,setErrorMap:function qxe(n){l4=n},getErrorMap:Eb,makeIssue:Cb,EMPTY_PATH:[],addIssueToContext:ie,ParseStatus:zi,INVALID:ke,DIRTY:rh,OK:sr,isAborted:PI,isDirty:NI,isValid:jl,isAsync:yg,get util(){return dt},get objectUtil(){return c4},ZodParsedType:ce,getParsedType:va,ZodType:Ye,datetimeRegex:p4,ZodString:Tb,ZodNumber:FI,ZodBigInt:LI,ZodBoolean:BI,ZodDate:VI,ZodSymbol:g4,ZodUndefined:UI,ZodNull:jI,ZodAny:xb,ZodUnknown:wg,ZodNever:Hl,ZodVoid:m4,ZodArray:Eg,ZodObject:oh,ZodUnion:HI,ZodDiscriminatedUnion:Sb,ZodIntersection:GI,ZodTuple:ah,ZodRecord:Cg,ZodMap:_4,ZodSet:y4,ZodFunction:ch,ZodLazy:WI,ZodLiteral:$I,ZodEnum:Ec,ZodNativeEnum:Ag,ZodPromise:Mb,ZodEffects:zl,ZodTransformer:zl,ZodOptional:Cc,ZodNullable:lh,ZodDefault:qI,ZodCatch:XI,ZodNaN:b4,BRAND:mSe,ZodBranded:YI,ZodPipeline:Tg,ZodReadonly:ZI,custom:w4,Schema:Ye,ZodSchema:Ye,late:_Se,get ZodFirstPartyTypeKind(){return Fe},coerce:{string:n=>Tb.create({...n,coerce:!0}),number:n=>FI.create({...n,coerce:!0}),boolean:n=>BI.create({...n,coerce:!0}),bigint:n=>LI.create({...n,coerce:!0}),date:n=>VI.create({...n,coerce:!0})},any:TSe,array:ISe,bigint:bSe,boolean:A4,date:wSe,discriminatedUnion:PSe,effect:T4,enum:HSe,function:VSe,instanceof:(n,e={message:`Input not instance of ${n.name}`})=>w4(t=>t instanceof n,e),intersection:NSe,lazy:USe,literal:jSe,map:LSe,nan:vSe,nativeEnum:zSe,never:SSe,null:ASe,nullable:$Se,number:C4,object:DSe,oboolean:()=>A4().optional(),onumber:()=>C4().optional(),optional:WSe,ostring:()=>E4().optional(),pipeline:XSe,preprocess:qSe,promise:GSe,record:FSe,set:BSe,strictObject:RSe,string:E4,symbol:ESe,transformer:T4,tuple:kSe,undefined:CSe,union:OSe,unknown:xSe,void:MSe,NEVER:ke,ZodIssueCode:X,quotelessJson:n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:ba});function KI(n){try{if("string"==typeof n)return JSON.parse(n)}catch{}return n}const YSe=Gi.object({}).passthrough().refine(n=>!0),ZSe=Gi.array(YSe),x4=Gi.preprocess(KI,Gi.union([Gi.literal(""),Gi.string().url(),ZSe])),S4=(x4.parse.bind(x4),Gi.preprocess(KI,Gi.tuple([Gi.number(),Gi.number(),Gi.number()]))),M4=(S4.parse.bind(S4),Gi.preprocess(KI,Gi.object({x:Gi.number(),y:Gi.number(),z:Gi.number()})));M4.parse.bind(M4);const KSe=["bodyCanvas"];let JSe=(()=>{class n{constructor(){this.clsName="ccf-body-ui",this.rotationChange=new Ae,this.nodeDrag=new Ae,this.nodeClick=new Ae,this.nodeHoverStart=new Ae,this.nodeHoverStop=new Ae,this.initialized=new Ae,this._interactive=!0,this._rotation=0,this._rotationX=0,this._zoom=9.5,this._target=[0,0,0],this._scene=[],this.subscriptions=[]}get scene(){return this._scene}set scene(t){this._scene=t,this.bodyUI?.setScene(t)}get rotation(){return this._rotation}set rotation(t){this._rotation=t,this.bodyUI?.setRotation(t)}get rotationX(){return this._rotationX}set rotationX(t){this._rotationX=t,this.bodyUI?.setRotationX(t)}get zoom(){return this._zoom}set zoom(t){this._zoom=t,this.bodyUI?.setZoom(t)}get target(){return this._target}set target(t){this._target=t,this.bodyUI?.setTarget(t)}get bounds(){return this._bounds}set bounds(t){this._bounds=t,this.zoomToBounds(t)}get camera(){return this._camera}set camera(t){this._camera=t}get interactive(){return this._interactive}set interactive(t){this._interactive=t,this.bodyUI&&this.recreateBodyUI()}ngAfterViewInit(){this.setupBodyUI()}zoomToBounds(t,i={x:48,y:48}){if(this.bodyCanvas){const{width:r,height:s}=this.bodyCanvas.nativeElement,o=window.devicePixelRatio,a=Math.min(Math.log2((r-i.x)/o/t.x),Math.log2((s-i.y)/o/t.y));this.zoom=a}}setupBodyUI(){var t=this;return Q(function*(){const i=t.bodyCanvas.nativeElement,r=new Wxe({id:"body-ui",canvas:i,zoom:t.zoom,target:[0,0,0],rotation:0,minRotationX:-75,maxRotationX:75,interactive:t.interactive,camera:t.camera});i.addEventListener("contextmenu",s=>s.preventDefault()),yield r.initialize(),t.bodyUI=r,window.bodyUI=r,t.scene?.length>0&&t.bodyUI.setScene(t.scene),t.bounds&&t.zoomToBounds(t.bounds),t.target&&t.bodyUI.setTarget(t.target),t.subscriptions=[t.bodyUI.sceneRotation$.subscribe(s=>t.rotationChange.next(s)),t.bodyUI.nodeDrag$.subscribe(s=>t.nodeDrag.emit(s)),t.bodyUI.nodeClick$.subscribe(s=>t.nodeClick.emit(s)),t.bodyUI.nodeHoverStart$.subscribe(s=>t.nodeHoverStart.emit(s)),t.bodyUI.nodeHoverStop$.subscribe(s=>t.nodeHoverStop.emit(s))],t.initialized.emit()})()}recreateBodyUI(){this.clearSubscriptions(),this.bodyUI.finalize(),this.setupBodyUI()}clearSubscriptions(){this.subscriptions.forEach(t=>t.unsubscribe()),this.subscriptions=[]}ngOnDestroy(){this.clearSubscriptions()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Yt({type:n,selectors:[["ccf-body-ui"]],viewQuery:function(i,r){if(1&i&&ea(KSe,5,At),2&i){let s;Ns(s=ks())&&(r.bodyCanvas=s.first)}},hostVars:2,hostBindings:function(i,r){2&i&&_d(r.clsName)},inputs:{scene:"scene",rotation:"rotation",rotationX:"rotationX",zoom:"zoom",target:"target",bounds:"bounds",camera:"camera",interactive:"interactive"},outputs:{rotationChange:"rotationChange",nodeDrag:"nodeDrag",nodeClick:"nodeClick",nodeHoverStart:"nodeHoverStart",nodeHoverStop:"nodeHoverStop",initialized:"initialized"},decls:2,vars:0,consts:[["bodyCanvas",""],[1,"body-ui"]],template:function(i,r){1&i&&Ei(0,"canvas",1,0)},styles:["[_nghost-%COMP%]{height:100%;width:100%;display:block}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{position:relative!important;background-color:#000;border-radius:.5rem}"],changeDetection:0})}}return n})();new k("Maximum number of autocomplete options displayed",{providedIn:"root",factory:()=>10}),at(123);const I4=[{src:"app:skin",organ:"Skin",name:"Skin",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002097"},{src:"app:brain",organ:"Brain",name:"Brain",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000955"},{disabled:!0,src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002509"},{disabled:!0,src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000970"},{src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004548"},{src:"app:eye",organ:"Eye",name:"Eye, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004549"},{disabled:!0,src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0003889"},{src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001303"},{src:"app:fallopian-tube-right",organ:"Fallopian Tube",name:"Fallopian Tube, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001302"},{src:"app:heart",organ:"Heart",name:"Heart",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000948"},{disabled:!0,src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002113"},{src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004538"},{src:"app:kidney-right",organ:"Kidney",name:"Kidney, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004539"},{disabled:!0,src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001465"},{src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.org/sig/ont/fma/fma24978"},{src:"app:knee",organ:"Knee",name:"Knee, R",side:"right",hasSex:!0,id:"http://purl.org/sig/ont/fma/fma24977"},{src:"app:liver",organ:"Liver",name:"Liver",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002107"},{disabled:!0,src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002048"},{src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001004"},{disabled:!0,src:"app:mammary-gland",organ:"Mammary Gland",name:"Mammary Gland, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001911"},{src:"app:mammary-gland",organ:"Mammary Gland",name:"Mammary Gland, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma57991"},{src:"app:mammary-gland",organ:"Mammary Gland",name:"Mammary Gland, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma57987"},{src:"app:manubrium",organ:"Manubrium",name:"Manubrium",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_2001553"},{disabled:!0,src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000992"},{disabled:!0,src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma7214"},{src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0002119"},{disabled:!0,src:"app:ovary-right",organ:"Ovary",name:"Ovary, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma7213"},{src:"app:ovary-right",organ:"Ovary",name:"Ovary, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0002118"},{src:"app:larynx",organ:"Larynx",name:"Larynx",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001737"},{src:"app:main-bronchus",organ:"Main Bronchus",name:"Main Bronchus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002182"},{disabled:!0,src:"app:palatine-tonsil",organ:"Palatine Tonsil",name:"Palatine Tonsil, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002373"},{src:"app:palatine-tonsil",organ:"Palatine Tonsil",name:"Palatine Tonsil, L",side:"left",hasSex:!0,id:"http://purl.org/sig/ont/fma/fma54974"},{src:"app:palatine-tonsil",organ:"Palatine Tonsil",name:"Palatine Tonsil, R",side:"right",hasSex:!0,id:"http://purl.org/sig/ont/fma/fma54973"},{src:"app:pancreas",organ:"Pancreas",name:"Pancreas",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001264"},{src:"app:pelvis-f",organ:"Pelvis",name:"Pelvis",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001270"},{src:"app:placenta",organ:"Placenta",name:"Placenta",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001987"},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0002367",disabled:!0},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0000079"},{src:"app:renal-pelvis-left",organ:"Renal Pelvis",name:"Renal Pelvis, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0018115"},{src:"app:renal-pelvis-right",organ:"Renal Pelvis",name:"Renal Pelvis, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0018116"},{src:"app:small-intestine",organ:"Small Intestine",name:"Small Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002108"},{src:"app:sternum",organ:"Sternum",name:"Sternum",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000975"},{src:"app:large-intestine",organ:"Large Intestine",name:"Large Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000059"},{src:"app:spinal-cord",organ:"Spinal Cord",name:"Spinal Cord",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002240"},{src:"app:spleen",organ:"Spleen",name:"Spleen",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002106"},{src:"app:thymus",organ:"Thymus",name:"Thymus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002370"},{src:"app:trachea",organ:"Trachea",name:"Trachea",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0003126"},{disabled:!0,src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000056"},{src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001223"},{src:"app:ureter-right",organ:"Ureter",name:"Ureter, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001222"},{src:"app:bladder",organ:"Urinary Bladder",name:"Urinary Bladder",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001255"},{src:"app:uterus",organ:"Uterus",name:"Uterus",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000995"},{src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004537"},{disabled:!0,src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002049"}].sort((n,e)=>n.name.localeCompare(e.name));function uh(n){return!0===n}function Tr(n){return null===n||typeof n>"u"}function or(n){return!Tr(n)}function JI(n){return!!n}function N4(n){return Tr(n)?n:JSON.parse(JSON.stringify(n))}function k4(n){return or(n)&&"object"==typeof n&&function QI(n){return"[object Object]"===Object.prototype.toString.call(n)}(n)}I4.filter(n=>!0!==n.disabled);const{isArray:CMe}=Array,{getPrototypeOf:AMe,prototype:TMe,keys:xMe}=Object;function B4(n){if(1===n.length){const e=n[0];if(CMe(e))return{args:e,keys:null};if(function SMe(n){return n&&"object"==typeof n&&AMe(n)===TMe}(e)){const t=xMe(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:MMe}=Array;function Pb(n){return le(e=>function IMe(n,e){return MMe(e)?n(...e):n(e)}(n,e))}function V4(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function Sg(...n){const e=H2(n),{args:t,keys:i}=B4(n),r=new be(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let c=o,l=o;for(let u=0;u<o;u++){let d=!1;li(t[u]).subscribe(It(s,h=>{d||(d=!0,l--),a[u]=h},()=>c--,void 0,()=>{(!c||!d)&&(l||s.next(i?V4(i,a):a),s.complete())}))}});return e?r.pipe(Pb(e)):r}function ee(...n){return Ln(n,mp(n))}function Ac(n,e){const t=$e(n)?n:()=>n,i=r=>r.error(t());return new be(e?r=>e.schedule(i,0,r):i)}function dh(n){return Ft((e,t)=>{let i=!1;e.subscribe(It(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function Io(n){return Ft((e,t)=>{let s,i=null,r=!1;i=e.subscribe(It(t,void 0,void 0,o=>{s=li(n(o,Io(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function zs(n){return Ft((e,t)=>{li(n).subscribe(It(t,()=>t.complete(),zc)),!t.closed&&e.subscribe(t)})}function Tc(n){return Ft((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function ps(n,e,t){let i,r=!1;return n&&"object"==typeof n?({bufferSize:i=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=n):i=n??1/0,fa({connector:()=>new na(i,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}function hh(n,e=Ys){return n=n??DMe,Ft((t,i)=>{let r,s=!0;t.subscribe(It(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}function DMe(n,e){return n===e}function ii(n){return n<=0?()=>Br:Ft((e,t)=>{let i=0;e.subscribe(It(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}const Ea="NGXS_META",U4="NGXS_OPTIONS_META",eD="NGXS_SELECTOR_META";function j4(n){if(!n.hasOwnProperty(Ea)){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,Ea,{value:e})}return Mg(n)}function Mg(n){return n[Ea]}function z4(n){return n[eD]}function tD(n,e=Object.is){let t=null,i=null;function r(){return function RMe(n,e,t){if(null===e||null===t||e.length!==t.length)return!1;const i=e.length;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}(e,t,arguments)||(i=n.apply(null,arguments)),t=arguments,i}return r.reset=function(){t=null,i=null},r}let OMe=(()=>{class n{static{this._value={}}static set(t){this._value=t}static pop(){const t=this._value;return this._value={},t}}return n})();const G4=new k("",{providedIn:"root",factory:()=>OMe.pop()});let W4=(()=>{class n extends na{constructor(){super(1)}bootstrap(){this.next(!0),this.complete()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const $4=new k(""),q4=new k("");function X4(n){const e=[];let t=!1;return function(...r){if(t)e.unshift(r);else{for(t=!0,n(...r);e.length>0;){const s=e.pop();s&&n(...s)}t=!1}}}class PMe extends fe{constructor(){super(...arguments),this._orderedNext=X4(e=>super.next(e))}next(e){this._orderedNext(e)}}class NMe extends On{constructor(e){super(e),this._orderedNext=X4(t=>super.next(t)),this._currentValue=e}getValue(){return this._currentValue}next(e){this._currentValue=e,this._orderedNext(e)}}function Y4(n){return e=>new be(t=>e.subscribe({next(i){n(()=>t.next(i))},error(i){n(()=>t.error(i))},complete(){n(()=>t.complete())}}))}let nD=(()=>{class n extends NMe{constructor(){super({}),this.state=function LV(n,e){const t=!e?.manualCleanup;t&&!e?.injector&&rf();const i=t?e?.injector?.get(nl)??D(nl):null,r=function Nae(n=Object.is){return(e,t)=>1===e.kind&&1===t.kind&&n(e.value,t.value)}(e?.equal);let s;s=qa(e?.requireSync?{kind:0}:{kind:1,value:e?.initialValue},{equal:r});const o=n.subscribe({next:a=>s.set({kind:1,value:a}),error:a=>{if(e?.rejectErrors)throw a;s.set({kind:2,error:a})}});if(e?.requireSync&&0===s().kind)throw new H(601,!1);return i?.onDestroy(o.unsubscribe.bind(o)),yl(()=>{const a=s();switch(a.kind){case 1:return a.value;case 2:throw a.error;case 0:throw new H(601,!1)}},{equal:e?.equal})}(this.pipe(Y4(ss)),{manualCleanup:!0,requireSync:!0})}ngOnDestroy(){this.complete()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Nt(n,e,t){const i=$e(n)||e||t?{next:n,error:e,complete:t}:n;return i?Ft((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(It(s,c=>{var l;null===(l=i.next)||void 0===l||l.call(i,c),s.next(c)},()=>{var c;a=!1,null===(c=i.complete)||void 0===c||c.call(i),s.complete()},c=>{var l;a=!1,null===(l=i.error)||void 0===l||l.call(i,c),s.error(c)},()=>{var c,l;a&&(null===(c=i.unsubscribe)||void 0===c||c.call(i)),null===(l=i.finalize)||void 0===l||l.call(i)}))}):Ys}function fh(...n){return function kMe(){return Oy(1)}()(Ln(n,mp(n)))}function xc(...n){const e=mp(n);return Ft((t,i)=>{(e?fh(n,t,e):fh(n,t)).subscribe(i)})}let Z4=(()=>{class n{static{this.type="@@INIT"}}return n})(),K4=(()=>{class n{static{this.type="@@UPDATE_STATE"}constructor(t){this.addedStates=t}}return n})();const iD=new k("");function LMe(n){return!!n.prototype.handle}function Gl(n){return n.constructor?.type||n.type}const J4=(n,e,t)=>{n={...n};const i=e.split("."),r=i.length-1;return i.reduce((s,o,a)=>(s[o]=a===r?t:Array.isArray(s[o])?s[o].slice():{...s[o]},s&&s[o]),n),n},rD=(n,e)=>e.split(".").reduce((t,i)=>t&&t[i],n);let VMe=(()=>{class n{enter(t){return t()}leave(t){return t()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),i8=(()=>{class n{constructor(){this._ngZone=D(ye),this._isServer=yT(D(is))}enter(t){return this._isServer?this.runInsideAngular(t):this.runOutsideAngular(t)}leave(t){return this.runInsideAngular(t)}runInsideAngular(t){return ye.isInAngularZone()?t():this._ngZone.run(t)}runOutsideAngular(t){return ye.isInAngularZone()?this._ngZone.runOutsideAngular(t):t()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const r8=new k(""),qMe=new k("",{providedIn:"root",factory:()=>{const n=D(ye),e=D(Gm),t=e.get(r8);return e.get(t||(n instanceof ye?i8:VMe))}});let s8=(()=>{class n{constructor(){this._executionStrategy=D(qMe)}enter(t){return this._executionStrategy.enter(t)}leave(t){return this._executionStrategy.leave(t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function kb(n){return Y4(e=>n.leave(e))}let o8=(()=>{class n extends PMe{constructor(){super(),this.dispatched$=new fe,this.pipe(wt(t=>"DISPATCHED"===t.status)).subscribe(t=>{this.dispatched$.next(t)})}ngOnDestroy(){this.complete()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),oD=(()=>{class n{constructor(){this.plugins=[],this._parentManager=D(n,{optional:!0,skipSelf:!0}),this._pluginHandlers=D(iD,{optional:!0}),this.registerHandlers()}get _rootPlugins(){return this._parentManager?.plugins||this.plugins}registerHandlers(){const t=this.getPluginHandlers();this._rootPlugins.push(...t)}getPluginHandlers(){return(this._pluginHandlers||[]).map(i=>i.handle?i.handle.bind(i):i)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const aD=new WeakMap;let a8=!1;let c8=(()=>{class n extends fe{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=rn(n)))(r||n)}})()}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),JMe=(()=>{class n{constructor(){this._ngZone=D(ye),this._actions=D(o8),this._actionResults=D(c8),this._pluginManager=D(oD),this._stateStream=D(nD),this._ngxsExecutionStrategy=D(s8),this._injector=D(gt)}dispatch(t){return this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(t)).pipe(function KMe(n){return e=>{let t=e.subscribe({error:i=>{n.runOutsideAngular(()=>{queueMicrotask(()=>{t&&function YMe(n){const e=aD.get(n);e&&e()}(i)})})}});return new be(i=>(t?.unsubscribe(),t=null,e.subscribe(i)))}}(this._ngZone),kb(this._ngxsExecutionStrategy))}dispatchByEvents(t){return Array.isArray(t)?0===t.length?ee(void 0):Sg(t.map(i=>this.dispatchSingle(i))).pipe(le(()=>{})):this.dispatchSingle(t)}dispatchSingle(t){const i=this._stateStream.getValue();return l8(this._injector,[...this._pluginManager.plugins,(s,o)=>{s!==i&&this._stateStream.next(s);const a=this.getActionResultStream(o);return a.subscribe(c=>this._actions.next(c)),this._actions.next({action:o,status:"DISPATCHED"}),this.createDispatchObservable(a)}])(i,t).pipe(ps())}getActionResultStream(t){return this._actionResults.pipe(wt(i=>i.action===t&&"DISPATCHED"!==i.status),ii(1),ps())}createDispatchObservable(t){return t.pipe(Dn(i=>{switch(i.status){case"SUCCESSFUL":return ee(this._stateStream.getValue());case"ERRORED":return Ac(()=>i.error);default:return ee()}}),ps())}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const l8=(n,e)=>(...t)=>{const i=e.shift();return es(n,()=>i(...t,(...r)=>l8(n,e)(...r)))},u8=new k(""),d8=new k(""),h8=new k("");let Ig=(()=>{class n{constructor(){this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=i8,this.selectorOptions={injectContainerState:!1,suppressErrors:!1}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:()=>(()=>{const t=new n,i=D(h8);return{...t,...i,selectorOptions:{...t.selectorOptions,...i.selectorOptions}}})(),providedIn:"root"})}}return n})();class QMe{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}}let Dg=(()=>{class n{constructor(){this._stateStream=D(nD),this._dispatcher=D(JMe),this._config=D(Ig)}getRootStateOperations(){return{getState:()=>this._stateStream.getValue(),setState:i=>this._stateStream.next(i),dispatch:i=>this._dispatcher.dispatch(i)}}setStateToTheCurrentWithNew(t){const i=this.getRootStateOperations(),r=i.getState();i.setState({...r,...t.defaults})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function p8(n){const e=z4(n)||Mg(n);return e&&e.makeRootSelector||(()=>n)}function g8(n){return e=>{for(let t=0;t<n.length;t++){if(!e)return;e=e[n[t]]}return e}}function m8(n){const e=n;let t="store."+e[0],i=0;const r=e.length;let s=t;for(;++i<r;)s=s+" && "+(t=t+"."+e[i]);return new Function("store","return "+s+";")}const sIe=new k("",{providedIn:"root",factory:()=>D(Ig).compatibility?.strictContentSecurityPolicy?g8:m8});let uIe=(()=>{class n{constructor(){this._actionTypeToHandlersMap=new Map}ngOnDestroy(){this._actionTypeToHandlersMap.clear()}get(t){return this._actionTypeToHandlersMap.get(t)}register(t,i){const r=this._actionTypeToHandlersMap.get(t)??new Set;return r.add(i),this._actionTypeToHandlersMap.set(t,r),()=>{this._actionTypeToHandlersMap.get(t).delete(i)}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();new RegExp("^[a-zA-Z0-9_]+$");let gIe=(()=>{class n{constructor(){this._ngZone=D(ye),this._errorHandler=D(pr)}handleError(t,i){this._ngZone.runOutsideAngular(()=>this._errorHandler.handleError(t))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),cD=(()=>{class n{constructor(){this._internalStateOperations=D(Dg)}createStateContext(t){const i=this._internalStateOperations.getRootStateOperations();return{getState:()=>b8(i.getState(),t),patchState(r){const s=i.getState(),o=function mIe(n){return e=>{const t={...e};for(const i in n)t[i]=n[i];return t}}(r);v8(i,s,o,t)},setState(r){const s=i.getState();!function Nb(n){return"function"==typeof n}(r)?y8(i,s,r,t):v8(i,s,r,t)},dispatch:r=>i.dispatch(r)}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function y8(n,e,t,i){const r=J4(e,i,t);return n.setState(r),r}function v8(n,e,t,i){return y8(n,e,t(b8(e,i)),i)}function b8(n,e){return rD(n,e)}function _Ie(...n){return function ph(n,e,t=vIe){const i=function bIe(n){return n.reduce((e,t)=>(e[Gl(t)]=!0,e),{})}(n),r=e&&function wIe(n){return n.reduce((e,t)=>(e[t]=!0,e),{})}(e);return function(s){return s.pipe(function yIe(n,e){return wt(t=>{const i=Gl(t.action);return n[i]&&(!e||e[t.status])})}(i,r),t())}}(n,["DISPATCHED"])}function vIe(){return le(n=>n.action)}function EIe(n){let e=void 0===n?{}:n;return n&&(Array.isArray(n)?e=n.slice():"object"==typeof n&&(e={...n})),e}let Fb=(()=>{class n{constructor(){this._injector=D(gt),this._config=D(Ig),this._stateContextFactory=D(cD),this._actions=D(o8),this._actionResults=D(c8),this._initialState=D(G4,{optional:!0}),this._actionRegistry=D(uIe),this._propGetter=D(sIe),this._actionsSubscription=null,this._ngxsUnhandledErrorHandler=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=tD(()=>{const t=this,i=t._propGetter;return{getStateGetter(o){let a=function r(o){const a=t._statePaths[o];return a?i(a.split(".")):null}(o);return a||((...c)=>(a||(a=function r(o){const a=t._statePaths[o];return a?i(a.split(".")):null}(o)),a?a(...c):void 0))},getSelectorOptions:o=>({...t._config.selectorOptions,...o||{}})}})}ngOnDestroy(){this._actionsSubscription?.unsubscribe()}add(t){const{newStates:i}=this.addToStatesMap(t);if(!i.length)return[];const r=function oIe(n){const e=t=>n.find(r=>r===t)[Ea].name;return n.reduce((t,i)=>{const{name:r,children:s}=i[Ea];return t[r]=(s||[]).map(e),t},{})}(i),s=function lIe(n){const e=[],t={},i=(r,s=[])=>{Array.isArray(s)||(s=[]),s.push(r),t[r]=!0,n[r].forEach(o=>{t[o]||i(o,s.slice(0))}),e.indexOf(r)<0&&e.push(r)};return Object.keys(n).forEach(r=>i(r)),e.reverse()}(r),o=function cIe(n,e={}){const t=(i,r)=>{for(const s in i)if(i.hasOwnProperty(s)&&i[s].indexOf(r)>=0){const o=t(i,s);return null!==o?`${o}.${s}`:s}return null};for(const i in n)if(n.hasOwnProperty(i)){const r=t(n,i);e[i]=r?`${r}.${i}`:i}return e}(r),a=function aIe(n){return n.reduce((e,t)=>(e[t[Ea].name]=t,e),{})}(i),c=[];for(const l of s){const u=a[l],d=o[l],h=u[Ea];this.addRuntimeInfoToMeta(h,d);const f={name:l,path:d,isInitialised:!1,actions:h.actions,instance:D(u),defaults:EIe(h.defaults)};this.hasBeenMountedAndBootstrapped(l,d)||c.push(f),this._states.push(f),this.hydrateActionMetasMap(f)}return c}addAndReturnDefaults(t){const r=this.add(t||[]);return{defaults:r.reduce((o,a)=>J4(o,a.path,a.defaults),{}),states:r}}connectActionHandlers(){this._actionsSubscription=this._actions.pipe(wt(t=>"DISPATCHED"===t.status),Dn(t=>{const i=t.action;return this.invokeActions(i).pipe(le(()=>({action:i,status:"SUCCESSFUL"})),dh({action:i,status:"CANCELED"}),Io(r=>{const s=this._ngxsUnhandledErrorHandler||=this._injector.get(gIe),o=function ZMe(n,e){if(null!==n&&"object"==typeof n){let t=!1;aD.set(n,()=>{t||(t=!0,e())})}return n}(r,()=>s.handleError(r,{action:i}));return ee({action:i,status:"ERRORED",error:o})}))})).subscribe(t=>this._actionResults.next(t))}invokeActions(t){const i=Gl(t),r=[];let s=!1;const o=this._actionRegistry.get(i);if(o)for(const a of o){let c;try{c=a(t)}catch(l){c=Ac(()=>l)}r.push(c),s=!0}return r.length||r.push(ee(void 0)),Sg(r)}addToStatesMap(t){const i=[],r=this._statesByName;for(const s of t){const o=Mg(s).name;!r[o]&&(i.push(s),r[o]=s)}return{newStates:i}}addRuntimeInfoToMeta(t,i){this._statePaths[t.name]=i,t.path=i}hasBeenMountedAndBootstrapped(t,i){const r=void 0!==rD(this._initialState,i);return this._statesByName[t]&&r}hydrateActionMetasMap({path:t,actions:i,instance:r}){const{dispatched$:s}=this._actions;for(const o of Object.keys(i)){const a=i[o].map(c=>{const l=!!c.options.cancelUncompleted;return u=>{const d=this._stateContextFactory.createStateContext(t);let h=r[c.fn](d,u);if(Qa(h)&&(h=Ln(h)),Bs(h)){if(h=h.pipe(Dn(f=>Qa(f)?Ln(f):Bs(f)?f:ee(f)),dh(void 0)),l){const f=s.pipe(_Ie(u));h=h.pipe(zs(f))}h=h.pipe(Tc(()=>{d.setState=E8,d.patchState=E8}))}else h=ee(void 0);return h}});for(const c of a)this._actionRegistry.register(o,c)}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function E8(){}let gs=(()=>{class n{constructor(){this._stateStream=D(nD),this._internalStateOperations=D(Dg),this._config=D(Ig),this._internalExecutionStrategy=D(s8),this._stateFactory=D(Fb),this._selectableStateStream=this._stateStream.pipe(kb(this._internalExecutionStrategy),ps({bufferSize:1,refCount:!0})),this.initStateStream()}dispatch(t){return this._internalStateOperations.getRootStateOperations().dispatch(t)}select(t){const i=this.getStoreBoundSelectorFn(t);return this._selectableStateStream.pipe(le(i),Io(r=>this._config.selectorOptions.suppressErrors&&r instanceof TypeError?ee(void 0):Ac(r)),hh(),kb(this._internalExecutionStrategy))}selectOnce(t){return this.select(t).pipe(ii(1))}selectSnapshot(t){return this.getStoreBoundSelectorFn(t)(this._stateStream.getValue())}selectSignal(t){const i=this.getStoreBoundSelectorFn(t);return yl(()=>i(this._stateStream.state()))}subscribe(t){return this._selectableStateStream.pipe(kb(this._internalExecutionStrategy)).subscribe(t)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(t){this._internalStateOperations.getRootStateOperations().setState(t)}getStoreBoundSelectorFn(t){return p8(t)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(){const t=D(G4),i=this._stateStream.value;(!i||0===Object.keys(i).length)&&this._stateStream.next(t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const C8=new k("");let Lb=(()=>{class n{static{this.store=null}static{this.config=null}constructor(t,i){n.store=t,n.config=i}ngOnDestroy(){n.store=null,n.config=null}static{this.\u0275fac=function(i){return new(i||n)(O(gs),O(Ig))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),A8=(()=>{class n{constructor(){this._store=D(gs),this._internalStateOperations=D(Dg),this._stateContextFactory=D(cD),this._appBootstrappedState=D(W4),this._destroy$=new na(1)}ngOnDestroy(){this._destroy$.next()}ngxsBootstrap(t,i){this._internalStateOperations.getRootStateOperations().dispatch(t).pipe(wt(()=>!!i),Nt(()=>this._invokeInitOnStates(i.states)),Dn(()=>this._appBootstrappedState),wt(r=>!!r),zs(this._destroy$)).subscribe(()=>this._invokeBootstrapOnStates(i.states))}_invokeInitOnStates(t){for(const i of t){const r=i.instance;r.ngxsOnChanges&&this._store.select(s=>rD(s,i.path)).pipe(xc(void 0),Ft((n,e)=>{let t,i=!1;n.subscribe(It(e,r=>{const s=t;t=r,i&&e.next([s,r]),i=!0}))}),zs(this._destroy$)).subscribe(([s,o])=>{const a=new QMe(s,o,!i.isInitialised);r.ngxsOnChanges(a)}),r.ngxsOnInit&&r.ngxsOnInit(this._getStateContext(i)),i.isInitialised=!0}}_invokeBootstrapOnStates(t){for(const i of t){const r=i.instance;r.ngxsAfterBootstrap&&r.ngxsAfterBootstrap(this._getStateContext(i))}}_getStateContext(t){return this._stateContextFactory.createStateContext(t.path)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();new k(""),new k("");let TIe=(()=>{class n{constructor(){!function T8(){(function XMe(){if(a8)return;const n=Zr.onUnhandledError;Zr.onUnhandledError=function(e){const t=aD.get(e);if(t)t();else{if(!n)throw e;n.call(this,e)}},a8=!0})(),(D(C8,{optional:!0})||[]).forEach(o=>o());const e=D(Fb),t=D(Dg);D(gs),D(Lb);const i=D(u8,{optional:!0})||[],r=D(A8),s=e.addAndReturnDefaults(i);t.setStateToTheCurrentWithNew(s),e.connectActionHandlers(),r.ngxsBootstrap(new Z4,s)}()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({})}}return n})(),xIe=(()=>{class n{constructor(){!function x8(){D(gs);const n=D(Dg),e=D(Fb),t=D(d8,{optional:!0})||[],i=D(A8),r=t.reduce((o,a)=>o.concat(a),[]),s=e.addAndReturnDefaults(r);s.states.length&&(n.setStateToTheCurrentWithNew(s),i.ngxsBootstrap(new K4(s.defaults),s))}()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({})}}return n})();function I8(n,e){return[...n,{provide:u8,useValue:n},{provide:up,useFactory:()=>{const t=D(W4);return()=>t.bootstrap()},multi:!0},{provide:h8,useValue:e},{provide:r8,useValue:e.executionStrategy}]}function D8(n){return[oD,...n,{provide:d8,multi:!0,useValue:n}]}let SIe=(()=>{class n{static forRoot(t=[],i={}){return{ngModule:TIe,providers:I8(t,i)}}static forFeature(t=[]){return{ngModule:xIe,providers:D8(t)}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({})}}return n})();function lD(n,e){return(t,i,r)=>{const s=j4(t.constructor),o=Array.isArray(n)?n:[n];for(const a of o){const c=a.type;s.actions[c]||(s.actions[c]=[]),s.actions[c].push({fn:i,options:e||{},type:c})}}}function uD(n){return e=>{const t=e,i=j4(t),r=Object.getPrototypeOf(t),s=function MIe(n,e){return{...n[U4]||{},...e}}(r,n);(function IIe(n){const{meta:e,inheritedStateClass:t,optionsWithInheritance:i}=n,{children:r,defaults:s,name:o}=i,a="string"==typeof o?o:o&&o.getName()||null;t.hasOwnProperty(Ea)&&(e.actions={...e.actions,...(t[Ea]||{}).actions}),e.children=r,e.defaults=s,e.name=a})({meta:i,inheritedStateClass:r,optionsWithInheritance:s}),t[U4]=s}}const DIe=36;function Bb(n,...e){return function(t,i){const r=i.toString(),s=`__${r}__selector`,o=function OIe(n,e,t=[]){return e=e||function PIe(n){const e=n.length-1;return n.charCodeAt(e)===DIe?n.slice(0,e):n}(n),"string"==typeof e?function rIe(n,e){return e?.compatibility?.strictContentSecurityPolicy?g8(n):m8(n)}(t.length?[e,...t]:e.split("."),Lb.config):e}(r,n,e);Object.defineProperties(t,{[s]:{writable:!0,enumerable:!1,configurable:!0},[r]:{enumerable:!0,configurable:!0,get(){return this[s]||(this[s]=function RIe(n){return Lb.store||function $Me(){throw new Error("You have forgotten to import the NGXS module!")}(),Lb.store.select(n)}(o))}}})}}const R8="NGXS_SELECTOR_OPTIONS_META",Vb={getOptions:n=>n&&n[R8]||{},defineOptions:(n,e)=>{n&&(n[R8]=e)}};function NIe(n,e){const t=function H4(n){return n.hasOwnProperty(eD)||Object.defineProperty(n,eD,{value:{makeRootSelector:null,originalFn:null,containerClass:null,selectorName:null,getSelectorOptions:()=>({})}}),z4(n)}(n);t.originalFn=n;let i=()=>({});e&&(t.containerClass=e.containerClass,t.selectorName=e.selectorName||null,i=e.getSelectorOptions||i);const r={...t};return t.getSelectorOptions=()=>function kIe(n,e){return{...Vb.getOptions(n.containerClass)||{},...Vb.getOptions(n.originalFn)||{},...n.getSelectorOptions()||{},...e}}(r,i()),t}function Rg(n,e,t){const i=function tIe(n,e){const t=e&&e.containerClass,r=tD(function(){const o=n.apply(t,arguments);return"function"==typeof o?tD.apply(null,[o]):o});return Object.setPrototypeOf(r,n),r}(e,t),r=NIe(e,t);return r.makeRootSelector=function eIe(n,e,t){return i=>{const{argumentSelectorFunctions:r,selectorOptions:s}=function nIe(n,e,t=[]){const i=e.getSelectorOptions(),r=n.getSelectorOptions(i),o=function iIe(n=[],e,t){const i=[];return t&&(e.injectContainerState||0===n.length)&&Mg(t)&&i.push(t),i.push(...n),i}(t,r,e.containerClass).map(a=>p8(a)(n));return{selectorOptions:r,argumentSelectorFunctions:o}}(i,n,e),{suppressErrors:o}=s;return function(c){const l=r.map(u=>u(c));try{return t(...l)}catch(u){if(o&&u instanceof TypeError)return;throw u}}}}(r,n,i),i}function gh(n){return(e,t,i)=>{i||=Object.getOwnPropertyDescriptor(e,t);const r=i?.value,s=Rg(n,r,{containerClass:e,selectorName:t.toString(),getSelectorOptions:()=>({})});return{configurable:!0,get:()=>s,originalFn:r}}}function BIe(n){return qc([LMe(n)?{provide:iD,useClass:n,multi:!0}:{provide:iD,useValue:n,multi:!0},{provide:fr,useValue:()=>D(oD),multi:!0}])}const jIe="NGXS_COMPUTED_OPTION",P8="NGXS_DATA_META",dD="NGXS_META",N8="NGXS_ARGUMENT_REGISTRY_META";function k8(n=zIe){return Ft((e,t)=>{let i=!1;e.subscribe(It(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function zIe(){return new Ep}let F8=(()=>{class n{constructor(t){this.subscription=null,this.sequence$=new On(0),t&&(this.subscription=t.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){this.sequence$.next(0),this.subscription?.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}static{this.\u0275fac=function(i){return new(i||n)(O(gs,8))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();function Og(n){return n[P8]}let $r=(()=>{class n{static{this.store=null}static{this.computed=null}static{this.context=null}static{this.factory=null}static{this.ngZone=null}static{this.injector=null}constructor(t,i,r){n.store=t.get(gs),n.ngZone=t.get(ye),n.factory=i,n.context=r,n.computed=t.get(F8),n.injector=t}static{this.\u0275fac=function(i){return new(i||n)(O(gt),O($4),O(q4))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();class ui{static{this.statesCachedMeta=new Map}constructor(){ui.statesCachedMeta.clear()}static createStateContext(e){return $r.context.createStateContext(e)}static ensureMappedState(e){if(Tr($r.factory)||Tr(e))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return(or(e.name)?ui.statesCachedMeta.get(e.name):null)||ui.ensureMeta(e)}static getRepositoryByInstance(e){const i=Og(ui.getStateClassByInstance(e))??null;if(Tr(i))throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return i}static getStateClassByInstance(e){return(e??{}).constructor}static clearMetaByInstance(e){const t=ui.getRepositoryByInstance(e);t.stateMeta.actions={},t.operations={}}static createPayload(e,t){const i={},r=Array.from(e);for(const[s,o]of r.entries()){const a=t?.getPayloadTypeByIndex(s);or(a)&&(i[a]=o)}return Object.keys(i).length>0?i:null}static createAction(e,t,i){const r=ui.createPayload(t,i),s=function $Ie(n){return class{constructor(t){if(t)for(const i of Object.keys(t))this[i]=t[i]}static get type(){return n}}}(e);return new s(r)}static ensureMeta(e){const t=or(e.name)?$r.factory._states?.find(i=>i.name===e.name):null;return or(t)&&or(e.name)&&ui.statesCachedMeta.set(e.name,t),t}static{this.\u0275fac=function(t){return new(t||ui)}}static{this.\u0275prov=j({token:ui,factory:ui.\u0275fac})}}new class qIe{constructor(){this.subject=new na(1)}init(){this.subject.next()}onInit(e){this.subject.pipe(function Ca(n,e){const t=arguments.length>=2;return i=>i.pipe(n?wt((r,s)=>n(r,s,i)):Ys,ii(1),t?dh(e):k8(()=>new Ep))}()).subscribe(e)}reset(){this.subject.complete(),this.subject=new na(1)}};class YIe extends Error{constructor(e){super(`Child states can only be added to an object. Cannot convert ${or(e?.constructor)?e.constructor.name:e} to PlainObject`)}}function L8(n){return n.NGXS_OPTIONS_META??{name:""}}function B8(n){const e=L8(n),t=e.children??[],r=N4(void 0===e.defaults?{}:e.defaults);if(t.length>0){if(k4(r))return function ZIe(n,e){return e.reduce((t,i)=>{const r=L8(i);if(function xg(n){const e="string"==typeof n?n.trim():n;return[void 0,null,NaN,"",1/0].includes(e)}(r.name))throw new Error("State name not provided in class");return t[r.name.toString()]=B8(i),t},n??{})}(r,t);throw new YIe(r)}return r}function V8(){return`__${jIe}__`}function U8(n){return n[V8()]??null}function j8(){return $r?.computed?.sequenceValue??0}function QIe(n){let e=!1;return Bs(n)&&(e=!0),e}function hD(n){return n[N8]}class eDe extends Error{constructor(e,t){super(`An argument with the name '${e}' already exists in the method '${t}'`)}}class tDe{constructor(){this.payloadMap=new Map,this.argumentMap=new Map}getPayloadTypeByIndex(e){return this.payloadMap.get(e)??null}getArgumentNameByIndex(e){return this.argumentMap.get(e)??null}createPayloadType(e,t,i){this.checkDuplicateName(e,t),this.payloadMap.set(i,e),this.payloadMap.set(e,e)}createArgumentName(e,t,i){this.checkDuplicateName(e,t),this.argumentMap.set(i,e),this.argumentMap.set(e,e)}checkDuplicateName(e,t){if(JI(this.argumentMap.has(e))||JI(this.payloadMap.has(e)))throw new eDe(e,t)}}function aDe(n){return{enumerable:!0,configurable:!0,get(){const e=Og(n),t=ui.ensureMappedState(e.stateMeta);return ui.createStateContext(t.path)}}}const fDe={dataActionSubscribeRequired:!0},pDe=new k("NGXS_DATA_CONFIG",{providedIn:"root",factory:()=>fDe});let gDe=(()=>{class n{constructor(t,i){this.accessor=t,this.injector=i}static forRoot(t=[]){return{ngModule:n,providers:[ui,$r,F8,qc([{provide:q4,useExisting:cD},{provide:$4,useExisting:Fb}]),...t]}}static{this.\u0275fac=function(i){return new(i||n)(O(ui,2),O($r,2))}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({})}}return n})();function H8(){return(n,e,t)=>{!function WIe(n,e){if(!function mMe(n,e){let t=n,i=!1;if(k4(t))for(;null!==t;){if(uh(t?.hasOwnProperty(e))){i=!!Object.getOwnPropertyDescriptor(t,e)?.get;break}t=Object.getPrototypeOf(t)}return i}(n,e?.toString()))throw new Error(`The method must be a getter for the computed decorator to work properly.\nExample: \n@Computed() get ${e.toString()}() { \n\t .. \n}`)}(n,e);const i=t.get;return t.get=function(...r){const s=function JIe(n){return Tr(U8(n))&&Object.defineProperties(n,{[V8()]:{enumerable:!0,configurable:!0,value:new WeakMap}}),U8(n)}(this),o=s?.get(i);if(uh(o?.isObservable))return o?.value;if(Tr(o)||o.sequenceId!==j8()){s.delete(i);const c=i.apply(this,r);return s.set(i,{value:c,sequenceId:j8(),isObservable:QIe(c)}),c}return o?.value},t}}const mDe={cancelUncompleted:!0,insideZone:!1,subscribeRequired:!0};function jb(n={}){const e=function _De(n){const e=$r?.injector?.get(pDe,void 0,rt.Optional),t={...mDe};return or(e)&&void 0!==e?.dataActionSubscribeRequired&&(t.subscribeRequired=e.dataActionSubscribeRequired),{...t,...n}}(n);return(t,i,r)=>{!function GIe(n,e){if(n.hasOwnProperty("prototype"))throw new Error("Cannot support static methods with @DataAction()");if(void 0===e)throw new Error("@DataAction() can only decorate a method implementation")}(t,r);const s=r.value,o=i.toString();return r.value=function(...a){const c=this;let l=null;const u=ui.getRepositoryByInstance(c),d=u.operations;let h=d[o];const f=Tr(h),p=u.stateMeta,g=hD(s);if(f){const E=function hDe(n){return String(n).replaceAll(/\/\/.*$/gm,"").replaceAll(/\s+/g,"").replaceAll(/\/\*[^*/]*\*\//g,"").split("){",1)?.[0]?.replace(/^[^(]*\(/,"").replaceAll(/=[^,]+/g,"").split(",").filter(Boolean)??[]}(s),A=function XIe(n){const{statePath:e,argumentsNames:t,methodName:i,argumentRegistry:r}=n;let s="";for(let o=0;o<t.length;o++)or(r?.getArgumentNameByIndex(o))?s+=r?.getArgumentNameByIndex(o):or(r?.getPayloadTypeByIndex(o))?s+=r?.getPayloadTypeByIndex(o):s+=`$arg${o}`,o!==t.length-1&&(s+=", ");return`@${e.replaceAll(".","/")}.${i}(${s})`}({statePath:p.path,methodName:o,argumentsNames:E,argumentRegistry:g});h=d[o]={type:A,options:{cancelUncompleted:e.cancelUncompleted??!1}},p.actions[h.type]=[{type:h.type,options:h.options,fn:h.type}]}const m=ui.ensureMappedState(p);m.instance[h.type]=()=>(uh(e.insideZone)?$r.ngZone?.run(()=>{l=s.apply(c,a)}):l=s.apply(c,a),Bs(l)&&uh(e.subscribeRequired)?ee(null).pipe(le(()=>l)):l),f&&$r.factory.hydrateActionMetasMap({...m,actions:{[h.type]:m.actions[h.type]}});const v=ui.createAction(h.type,a,g),_=$r.store.dispatch(v);return Bs(l)?function KIe(n,e){return Sg([n,e]).pipe(le(t=>t.pop()))}(_,l):l},r}}function z8(n){return(e,t,i)=>{const r=n.trim();if(!r)throw new Error("Payload name should be initialized");(function nDe(n,e){const t=n[e];return Tr(hD(t))&&Object.defineProperties(t,{[N8]:{enumerable:!0,configurable:!0,value:new tDe}}),hD(t)})(e,t).createPayloadType(r,t,i)}}function G8(){return n=>{const e=function dDe(n){if(function sMe(n){return!JI(n)}(n.hasOwnProperty(dD))){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,dD,{value:e})}return function uDe(n){return n?.[dD]}(n)}(n);if(Tr(e.name))throw new Error("@StateRepository should be add before decorator @State");!function sDe(n,e){(function rDe(n){const e=Og(n)??null;return(Tr(e)||e?.stateClass!==n)&&function iDe(n){Object.defineProperty(n,P8,{writable:!0,configurable:!0,enumerable:!0,value:{stateMeta:null,operations:{},stateClass:n}})}(n),Og(n)}(n)).stateMeta=e}(n,e),function vDe(n,e,t){Object.defineProperties(n.prototype,{name:{enumerable:!0,configurable:!0,value:e.name},initialState:{enumerable:!0,configurable:!0,get:()=>N4(t)},context:aDe(n)})}(n,e,B8(n)),function cDe(n){const t=Og(n)?.stateMeta?.name??null;if(or(t)){const i=`__${t}__selector`;Object.defineProperties(n.prototype,{[i]:{writable:!0,enumerable:!1,configurable:!0},state$:{enumerable:!0,configurable:!0,get(){if(or(this[i]))return this[i];if(Tr($r.store))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return this[i]=$r.store.select(n).pipe(le(r=>r),ps({refCount:!0,bufferSize:1})),this[i]}}})}}(n)}}let bDe=(()=>{class n{constructor(){this._dirty=!0,this.browserStorageEvents$=new fe,this.isInitialised=!1,this.isBootstrapped=!1}get dirty(){return this._dirty}set dirty(t){this._dirty=t}ngxsOnChanges(t){this.dirty&&this.isBootstrapped&&(this.dirty=!1,this.ngxsDataDoCheck?.())}ngxsOnInit(){this.isInitialised=!0}ngxsAfterBootstrap(){this.isBootstrapped=!0,this.dirty&&(this.dirty=!1,this.ngxsDataDoCheck?.())}markAsDirtyAfterReset(){this.dirty=!0,this.ngxsDataAfterReset?.()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})(),W8=(()=>{class n extends bDe{get snapshot(){return this.getState()}get ctx(){return function lDe(n){if(!n)throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return{...n,getState:()=>n.getState(),setState(e){n.setState(e)},patchState(e){n.patchState(e)}}}(this.context)}patchState(t){this.ctx.patchState(t)}setState(t){this.ctx.setState(t)}reset(){this.ctx.setState(this.initialState),this.markAsDirtyAfterReset()}getState(){return this.ctx.getState()}dispatch(t){return this.ctx.dispatch(t)}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=rn(n)))(r||n)}})()}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return tt([H8()],n.prototype,"snapshot",null),tt([jb(),KA(0,z8("patchValue"))],n.prototype,"patchState",null),tt([jb(),KA(0,z8("stateValue"))],n.prototype,"setState",null),tt([jb()],n.prototype,"reset",null),n})();function $8(...n){const e=n.length;if(0===e)throw new Error("list of properties cannot be empty.");return le(t=>{let i=t;for(let r=0;r<e;r++){const s=i?.[n[r]];if(!(typeof s<"u"))return;i=s}return i})}let Wl=class gm extends W8{constructor(){super(...arguments),this.optionCache=new Map}get config$(){return this.state$.pipe(function wDe(){return wt(n=>null!=n)}(),ps(1))}setConfig(e){this.setState(e)}patchConfig(e){this.patchState(e)}getProperty(e){return this.config$.pipe($8(...e),hh(),ps(1))}getOption(...e){const t=this.getPathKey(e);if(this.optionCache.has(t))return this.optionCache.get(t)??ee();const i=this.config$.pipe($8(...e),hh(),ps(1));return this.optionCache.set(t,i),i}getPathKey(e){return`${e.length}:${e.join(".")}`}static{this.\u0275fac=(()=>{let e;return function(i){return(e||(e=rn(gm)))(i||gm)}})()}static{this.\u0275prov=j({token:gm,factory:gm.\u0275fac})}};tt([H8(),te("design:type",be),te("design:paramtypes",[])],Wl.prototype,"config$",null),Wl=tt([G8(),uD({name:"globalConfig",defaults:null})],Wl);const q8="ALLOW_TELEMETRY",CDe=X8();function X8(){const n=localStorage.getItem(q8);return null===n?void 0:"true"===n.toLowerCase()}let fD=class mm extends W8{setAllowTelemetry(e){const t=X8();localStorage.setItem(q8,e.toString()),this.ctx.patchState({allowTelemetry:e}),(void 0!==t||!1===e)&&location.reload()}static{this.\u0275fac=(()=>{let e;return function(i){return(e||(e=rn(mm)))(i||mm)}})()}static{this.\u0275prov=j({token:mm,factory:mm.\u0275fac})}};tt([jb(),te("design:type",Function),te("design:paramtypes",[Boolean]),te("design:returntype",void 0)],fD.prototype,"setAllowTelemetry",null),fD=tt([G8(),uD({name:"tracking",defaults:{allowTelemetry:CDe}})],fD);const ADe=["addListener","removeListener"],TDe=["addEventListener","removeEventListener"],xDe=["on","off"];function Pg(n,e,t,i){if($e(t)&&(i=t,t=void 0),i)return Pg(n,e,t).pipe(Pb(i));const[r,s]=function IDe(n){return $e(n.addEventListener)&&$e(n.removeEventListener)}(n)?TDe.map(o=>a=>n[o](e,a,t)):function SDe(n){return $e(n.addListener)&&$e(n.removeListener)}(n)?ADe.map(Y8(n,e)):function MDe(n){return $e(n.on)&&$e(n.off)}(n)?xDe.map(Y8(n,e)):[];if(!r&&eT(n))return Dn(o=>Pg(o,e,t))(li(n));if(!r)throw new TypeError("Invalid event target");return new be(o=>{const a=(...c)=>o.next(1<c.length?c:c[0]);return r(a),()=>s(a)})}function Y8(n,e){return t=>i=>n[t](e,i)}function Hb(...n){const e=mp(n),t=H2(n),{args:i,keys:r}=B4(n);if(0===i.length)return Ln([],e);const s=new be(function DDe(n,e,t=Ys){return i=>{Z8(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let c=0;c<r;c++)Z8(e,()=>{const l=Ln(n[c],e);let u=!1;l.subscribe(It(i,d=>{s[c]=d,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>V4(r,o):Ys));return t?s.pipe(Pb(t)):s}function Z8(n,e,t){n?ia(t,n,e):e()}function zb(n){return new be(e=>{li(n()).subscribe(e)})}function Gb(){return Ft((n,e)=>{let t=null;n._refCount++;const i=It(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class pD extends be{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Wh(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new kt;const t=this.getSubject();e.add(this.source.subscribe(It(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=kt.EMPTY)}return e}refCount(){return Gb()(this)}}function mD(n){return le(()=>n)}function HD(n){return wt((e,t)=>n<=t)}Error;let K9=(()=>{class n{constructor(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=se({type:n,selectors:[["","gaEvent","","gaCategory",""],["","gaCategory",""]],inputs:{gaCategory:"gaCategory"},exportAs:["gaCategory"]}),n})();const Zg=new k("ngx-google-analytics-settings",{factory:()=>({trackingCode:"",enableTracing:!1})}),zD=new k("ngx-window",{providedIn:"root",factory:()=>{const{defaultView:n}=D(nt);if(!n)throw new Error("Window is not available");return n}}),GRe=new k("ngx-data-layer",{providedIn:"root",factory:()=>function zRe(n){return n?n.dataLayer=n.dataLayer||[]:null}(D(zD))}),J9=new k("ngx-gtag-fn",{providedIn:"root",factory:()=>function WRe(n,e){return n?n.gtag=n.gtag||function(){e.push(arguments)}:null}(D(zD),D(GRe))});let Ch=(()=>{class n{constructor(t,i,r){this.settings=t,this._document=i,this._gtag=r}get document(){return this._document}throw(t){this.settings.enableTracing&&console&&console.error&&console.error(t)}toKeyValue(t){return t.size>0?Array.from(t).reduce((i,[r,s])=>Object.defineProperty(i,r,{value:s,enumerable:!0}),{}):void 0}gtag(...t){try{this._gtag(...t.filter(i=>void 0!==i))}catch(i){this.throw(i)}}event(t,i,r,s,o,a){try{const c=new Map;i&&c.set("event_category",i),r&&c.set("event_label",r),s&&c.set("value",s),void 0!==o&&c.set("interaction",o),a&&Object.entries(a).map(([u,d])=>c.set(u,d));const l=this.toKeyValue(c);l?this.gtag("event",t,l):this.gtag("event",t)}catch(c){this.throw(c)}}pageView(t,i,r,s){try{const o=new Map([["page_path",t]]);i&&o.set("page_title",i),(r||this.document)&&o.set("page_location",r||this.document.location.href),s&&Object.entries(s).map(([a,c])=>o.set(a,c)),this.gtag("config",this.settings.trackingCode,this.toKeyValue(o))}catch(o){this.throw(o)}}appView(t,i,r,s,o){try{const a=new Map([["screen_name",t],["app_name",i]]);r&&a.set("app_id",r),s&&a.set("app_version",s),o&&a.set("app_installer_id",o),this.gtag("event","screen_view",this.toKeyValue(a))}catch(a){this.throw(a)}}set(...t){try{this._gtag("set",...t)}catch(i){this.throw(i)}}exception(t,i){try{const r=new Map;t&&r.set("description",t),i&&r.set("fatal",i),this.toKeyValue(r)?this.gtag("event","exception",this.toKeyValue(r)):this.gtag("event","exception")}catch(r){this.throw(r)}}}return n.\u0275fac=function(t){return new(t||n)(O(Zg),O(nt),O(J9))},n.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),$Re=(()=>{class n{constructor(t,i,r,s){this.gaCategoryDirective=t,this.gaService=i,this.settings=r,this.el=s,this.gaBind="click"}set gaBind(t){this.bindSubscription&&this.bindSubscription.unsubscribe(),this._gaBind=t,this.bindSubscription=Pg(this.el.nativeElement,t).subscribe(()=>this.trigger())}get gaBind(){return this._gaBind}ngOnDestroy(){this.bindSubscription&&this.bindSubscription.unsubscribe()}trigger(){try{if(!this.gaAction&&!this.gaEvent)throw new Error("You must provide a gaAction attribute to identify this event.");this.gaService.event(this.gaAction||this.gaEvent,this.gaCategoryDirective?this.gaCategoryDirective.gaCategory:void 0,this.gaLabel||this.label,this.gaValue,this.gaInteraction)}catch(t){this.throw(t)}}throw(t){this.settings.enableTracing&&console&&console.warn&&console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)(R(K9,8),R(Ch),R(Zg),R(At))},n.\u0275dir=se({type:n,selectors:[["","gaEvent",""]],inputs:{gaAction:"gaAction",gaLabel:"gaLabel",label:"label",gaValue:"gaValue",gaInteraction:"gaInteraction",gaEvent:"gaEvent",gaBind:"gaBind"},exportAs:["gaEvent"]}),n})();const XRe={provide:NA,multi:!0,useFactory:function YRe(n,e,t){return Q(function*(){if(!n.trackingCode)return void console.error("Empty tracking code for Google Analytics. Make sure to provide one when initializing NgxGoogleAnalyticsModule.");if(!e)return void console.error("Was not possible create or read gtag() fn. Make sure this module is running on a Browser w/ access to Window interface.");t||console.error("Was not possible to access Document interface. Make sure this module is running on a Browser w/ access do Document interface."),n.uri=n.uri||`https://www.googletagmanager.com/gtag/js?id=${n.trackingCode}`,n.initCommands=n?.initCommands??[],n.initCommands.find(s=>"config"===s.command)||n.initCommands.unshift({command:"config",values:[n.trackingCode]}),n.initCommands.find(s=>"js"===s.command)||n.initCommands.unshift({command:"js",values:[new Date]});for(const s of n.initCommands)e(s.command,...s.values);const i=t.createElement("script");i.async=!0,i.src=n.uri,n.nonce&&i.setAttribute("nonce",n.nonce),t.getElementsByTagName("head")[0].appendChild(i)})},deps:[Zg,J9,nt]};new k("ngx-google-analytics-routing-settings",{factory:()=>({})});let GD=(()=>{class n{static forRoot(t,i=[],r,s,o){return{ngModule:n,providers:[{provide:Zg,useValue:{trackingCode:t,initCommands:i,uri:r,enableTracing:s,nonce:o}},XRe]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=fn({type:n}),n.\u0275inj=ln({}),n})(),WD=(()=>{class n{constructor(){this.consent="not-set",this.consentChange=new na(1),this.consentChange.next(this.consent)}ngOnDestroy(){this.consentChange.complete()}setConsent(t){this.consent!==t&&(this.consent=t,this.consentChange.next(t))}unsetConsent(){this.setConsent("not-set")}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})(),JRe=(()=>{class n{constructor(t,i,{trackingCode:r}){this.window=i,this.subscriptions=new kt,this.token=r,this.subscriptions.add(t.consentChange.subscribe(s=>this.toggleGoogleAnalytics("rescinded"===s)))}ngOnDestroy(){this.subscriptions.unsubscribe()}toggleGoogleAnalytics(t){this.window&&(this.window[`ga-disable-${this.token}`]=t)}static{this.\u0275fac=function(i){return new(i||n)(O(WD),O(zD),O(Zg))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();const QRe=new k("Key under which consent is stored",{providedIn:"root",factory:()=>"ALLOW_TELEMETRY"}),e6=[WD,JRe,(()=>{class n{constructor(t,i){this.key=i,this.subscriptions=new kt;try{this.storage=localStorage}catch{}t.setConsent(this.loadConsent()),this.subscriptions.add(t.consentChange.subscribe(r=>this.saveConsent(r)))}ngOnDestroy(){this.subscriptions.unsubscribe()}loadConsent(){const t=this.storage?.getItem?.(this.key);if(null==t)return"not-set";const i=t.trim().toLowerCase();switch(i){case"given":case"rescinded":return i;default:return"not-set"}}saveConsent(t){this.storage?.setItem?.(this.key,t)}static{this.\u0275fac=function(i){return new(i||n)(O(WD),O(QRe))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})()];function eOe(n){return Object.entries(n).reduce((e,[t,i])=>(null!=i&&(e[t]=`${i}`),e),{})}let nOe=(()=>{class n{static forRoot(t){const{providers:i=[]}=GD.forRoot(t.gaToken,function tOe(n){const{appName:e,projectName:t,developmentMode:i}=n;return[{command:"set",values:[eOe({appName:e,projectName:t,developmentMode:i})]}]}(t));return{ngModule:n,providers:i}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({providers:[...e6,{provide:NA,multi:!0,useFactory:()=>()=>{},deps:e6}],imports:[GD]})}}return n})(),t6=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();class u0{}class d0{}class ar{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof ar?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new ar;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof ar?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class iOe{encodeKey(e){return n6(e)}encodeValue(e){return n6(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const sOe=/%(\d[a-f0-9])/gi,oOe={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function n6(n){return encodeURIComponent(n).replace(sOe,(e,t)=>oOe[t]??e)}function h0(n){return`${n}`}class ht{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new iOe,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function rOe(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],c=t.get(o)||[];c.push(a),t.set(o,c)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(h0):[h0(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new ht({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(h0(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(h0(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class it{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function r6(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function s6(n){return typeof Blob<"u"&&n instanceof Blob}function o6(n){return typeof FormData<"u"&&n instanceof FormData}class Kg{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function aOe(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new ar,this.context??=new it,this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new ht,this.urlWithParams=t}serializeBody(){return null===this.body?null:"string"==typeof this.body||r6(this.body)||s6(this.body)||o6(this.body)||function cOe(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)?this.body:this.body instanceof ht?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||o6(this.body)?null:s6(this.body)?this.body.type||null:r6(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof ht?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=void 0!==e.body?e.body:this.body,a=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress;let l=e.headers||this.headers,u=e.params||this.params;const d=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((h,f)=>h.set(f,e.setHeaders[f]),l)),e.setParams&&(u=Object.keys(e.setParams).reduce((h,f)=>h.set(f,e.setParams[f]),u)),new Kg(t,i,o,{params:u,headers:l,context:d,reportProgress:c,responseType:r,withCredentials:a,transferCache:s})}}var Ic=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Ic||{});class $D{constructor(e,t=200,i="OK"){this.headers=e.headers||new ar,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class f0 extends $D{constructor(e={}){super(e),this.type=Ic.ResponseHeader}clone(e={}){return new f0({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Zl extends $D{constructor(e={}){super(e),this.type=Ic.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Zl({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Ah extends $D{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function qD(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}let $s=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof Kg)s=t;else{let c,l;c=r.headers instanceof ar?r.headers:new ar(r.headers),r.params&&(l=r.params instanceof ht?r.params:new ht({fromObject:r.params})),s=new Kg(t,i,void 0!==r.body?r.body:null,{headers:c,context:r.context,params:l,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}const o=ee(s).pipe(function Ng(n,e){return $e(e)?Dn(n,e,1):Dn(n,1)}(c=>this.handler.handle(c)));if(t instanceof Kg||"events"===r.observe)return o;const a=o.pipe(wt(c=>c instanceof Zl));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(le(c=>{if(null!==c.body&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return a.pipe(le(c=>{if(null!==c.body&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return a.pipe(le(c=>{if(null!==c.body&&"string"!=typeof c.body)throw new Error("Response is not a string.");return c.body}));default:return a.pipe(le(c=>c.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new ht).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,qD(r,i))}post(t,i,r={}){return this.request("POST",t,qD(r,i))}put(t,i,r={}){return this.request("PUT",t,qD(r,i))}static{this.\u0275fac=function(i){return new(i||n)(O(u0))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();const dOe=/^\)\]\}',?\n/;function c6(n){if(n.url)return n.url;const e="X-Request-URL".toLocaleLowerCase();return n.headers.get(e)}let XD=(()=>{class n{constructor(){this.fetchImpl=D(fOe,{optional:!0})?.fetch??fetch.bind(globalThis),this.ngZone=D(ye)}handle(t){return new be(i=>{const r=new AbortController;return this.doRequest(t,r.signal,i).then(YD,s=>i.error(new Ah({error:s}))),()=>r.abort()})}doRequest(t,i,r){var s=this;return Q(function*(){const o=s.createRequestInit(t);let a;try{const p=s.ngZone.runOutsideAngular(()=>s.fetchImpl(t.urlWithParams,{signal:i,...o}));(function pOe(n){n.then(YD,YD)})(p),r.next({type:Ic.Sent}),a=yield p}catch(p){return void r.error(new Ah({error:p,status:p.status??0,statusText:p.statusText,url:t.urlWithParams,headers:p.headers}))}const c=new ar(a.headers),l=a.statusText,u=c6(a)??t.urlWithParams;let d=a.status,h=null;if(t.reportProgress&&r.next(new f0({headers:c,status:d,statusText:l,url:u})),a.body){const p=a.headers.get("content-length"),g=[],m=a.body.getReader();let v,_,y=0;const E=typeof Zone<"u"&&Zone.current;yield s.ngZone.runOutsideAngular(Q(function*(){for(;;){const{done:x,value:I}=yield m.read();if(x)break;if(g.push(I),y+=I.length,t.reportProgress){_="text"===t.responseType?(_??"")+(v??=new TextDecoder).decode(I,{stream:!0}):void 0;const S=()=>r.next({type:Ic.DownloadProgress,total:p?+p:void 0,loaded:y,partialText:_});E?E.run(S):S()}}}));const A=s.concatChunks(g,y);try{const x=a.headers.get("Content-Type")??"";h=s.parseBody(t,A,x)}catch(x){return void r.error(new Ah({error:x,headers:new ar(a.headers),status:a.status,statusText:a.statusText,url:c6(a)??t.urlWithParams}))}}0===d&&(d=h?200:0),d>=200&&d<300?(r.next(new Zl({body:h,headers:c,status:d,statusText:l,url:u})),r.complete()):r.error(new Ah({error:h,headers:c,status:d,statusText:l,url:u}))})()}parseBody(t,i,r){switch(t.responseType){case"json":const s=(new TextDecoder).decode(i).replace(dOe,"");return""===s?null:JSON.parse(s);case"text":return(new TextDecoder).decode(i);case"blob":return new Blob([i],{type:r});case"arraybuffer":return i.buffer}}createRequestInit(t){const i={},r=t.withCredentials?"include":void 0;if(t.headers.forEach((s,o)=>i[s]=o.join(",")),t.headers.has("Accept")||(i.Accept="application/json, text/plain, */*"),!t.headers.has("Content-Type")){const s=t.detectContentTypeHeader();null!==s&&(i["Content-Type"]=s)}return{body:t.serializeBody(),method:t.method,headers:i,credentials:r}}concatChunks(t,i){const r=new Uint8Array(i);let s=0;for(const o of t)r.set(o,s),s+=o.length;return r}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();class fOe{}function YD(){}function l6(n,e){return e(n)}function gOe(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}const _Oe=new k(""),Jg=new k(""),u6=new k(""),d6=new k("",{providedIn:"root",factory:()=>!0});function yOe(){let n=null;return(e,t)=>{null===n&&(n=(D(_Oe,{optional:!0})??[]).reduceRight(gOe,l6));const i=D(Zo);if(D(d6)){const s=i.add();return n(e,t).pipe(Tc(()=>i.remove(s)))}return n(e,t)}}let h6=(()=>{class n extends u0{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=D(Zo),this.contributeToStability=D(d6)}handle(t){if(null===this.chain){const i=Array.from(new Set([...this.injector.get(Jg),...this.injector.get(u6,[])]));this.chain=i.reduceRight((r,s)=>function mOe(n,e,t){return(i,r)=>es(t,()=>e(i,s=>n(s,r)))}(r,s,this.injector),l6)}if(this.contributeToStability){const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(Tc(()=>this.pendingTasks.remove(i)))}return this.chain(t,i=>this.backend.handle(i))}static{this.\u0275fac=function(i){return new(i||n)(O(d0),O(ki))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();const COe=/^\)\]\}',?\n/;let p6=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new H(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?Ln(i.\u0275loadImpl()):ee(null)).pipe(pn(()=>new be(s=>{const o=i.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((g,m)=>o.setRequestHeader(g,m.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const g=t.detectContentTypeHeader();null!==g&&o.setRequestHeader("Content-Type",g)}if(t.responseType){const g=t.responseType.toLowerCase();o.responseType="json"!==g?g:"text"}const a=t.serializeBody();let c=null;const l=()=>{if(null!==c)return c;const g=o.statusText||"OK",m=new ar(o.getAllResponseHeaders()),y=function AOe(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(o)||t.url;return c=new f0({headers:m,status:o.status,statusText:g,url:y}),c},u=()=>{let{headers:g,status:m,statusText:y,url:v}=l(),_=null;204!==m&&(_=typeof o.response>"u"?o.responseText:o.response),0===m&&(m=_?200:0);let E=m>=200&&m<300;if("json"===t.responseType&&"string"==typeof _){const A=_;_=_.replace(COe,"");try{_=""!==_?JSON.parse(_):null}catch(x){_=A,E&&(E=!1,_={error:x,text:_})}}E?(s.next(new Zl({body:_,headers:g,status:m,statusText:y,url:v||void 0})),s.complete()):s.error(new Ah({error:_,headers:g,status:m,statusText:y,url:v||void 0}))},d=g=>{const{url:m}=l(),y=new Ah({error:g,status:o.status||0,statusText:o.statusText||"Unknown Error",url:m||void 0});s.error(y)};let h=!1;const f=g=>{h||(s.next(l()),h=!0);let m={type:Ic.DownloadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),"text"===t.responseType&&o.responseText&&(m.partialText=o.responseText),s.next(m)},p=g=>{let m={type:Ic.UploadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),s.next(m)};return o.addEventListener("load",u),o.addEventListener("error",d),o.addEventListener("timeout",d),o.addEventListener("abort",d),t.reportProgress&&(o.addEventListener("progress",f),null!==a&&o.upload&&o.upload.addEventListener("progress",p)),o.send(a),s.next({type:Ic.Sent}),()=>{o.removeEventListener("error",d),o.removeEventListener("abort",d),o.removeEventListener("load",u),o.removeEventListener("timeout",d),t.reportProgress&&(o.removeEventListener("progress",f),null!==a&&o.upload&&o.upload.removeEventListener("progress",p)),o.readyState!==o.DONE&&o.abort()}})))}static{this.\u0275fac=function(i){return new(i||n)(O(fV))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();const ZD=new k(""),g6=new k("",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),m6=new k("",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class _6{}let SOe=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=sV(t,this.cookieName),this.lastCookieString=t),this.lastToken}static{this.\u0275fac=function(i){return new(i||n)(O(nt),O(is),O(g6))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();function MOe(n,e){const t=n.url.toLowerCase();if(!D(ZD)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const i=D(_6).getToken(),r=D(m6);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}var Dc=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(Dc||{});function Kl(n,e){return{\u0275kind:n,\u0275providers:e}}function IOe(...n){const e=[$s,p6,h6,{provide:u0,useExisting:h6},{provide:d0,useFactory:()=>D(XD,{optional:!0})??D(p6)},{provide:Jg,useValue:MOe,multi:!0},{provide:ZD,useValue:!0},{provide:_6,useClass:SOe}];for(const t of n)e.push(...t.\u0275providers);return qc(e)}const y6=new k("");class KD{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const JD=new k("basePath");class Rc{apiKeys;username;password;accessToken;basePath;withCredentials;encoder;encodeParam;credentials;constructor(e={}){this.apiKeys=e.apiKeys,this.username=e.username,this.password=e.password,this.accessToken=e.accessToken,this.basePath=e.basePath,this.withCredentials=e.withCredentials,this.encoder=e.encoder,this.encodeParam=e.encodeParam?e.encodeParam:t=>this.defaultEncodeParam(t),this.credentials=e.credentials?e.credentials:{}}selectHeaderContentType(e){if(0===e.length)return;const t=e.find(i=>this.isJsonMime(i));return void 0===t?e[0]:t}selectHeaderAccept(e){if(0===e.length)return;const t=e.find(i=>this.isJsonMime(i));return void 0===t?e[0]:t}isJsonMime(e){const t=new RegExp("^(application/json|[^;/ \t]+/[^;/ \t]+[+]json)[ \t]*(;.*)?$","i");return null!==e&&(t.test(e)||"application/json-patch+json"===e.toLowerCase())}lookupCredential(e){const t=this.credentials[e];return"function"==typeof t?t():t}defaultEncodeParam(e){const t="date-time"===e.dataFormat&&e.value instanceof Date?e.value.toISOString():e.value;return encodeURIComponent(String(t))}}let x6=(()=>{class n{httpClient;basePath="https://apps.humanatlas.io/api";defaultHeaders=new ar;configuration=new Rc;encoder;constructor(t,i,r){this.httpClient=t,r&&(this.configuration=r),"string"!=typeof this.configuration.basePath&&("string"!=typeof i&&(i=this.basePath),this.configuration.basePath=i),this.encoder=this.configuration.encoder||new KD}addToHttpParams(t,i,r){return this.addToHttpParamsRecursive(t,i,r)}addToHttpParamsRecursive(t,i,r){if(null==i)return t;if("object"==typeof i)if(Array.isArray(i))i.forEach(s=>t=this.addToHttpParamsRecursive(t,s,r));else if(i instanceof Date){if(null==r)throw Error("key may not be null if value is Date");t=t.append(r,i.toISOString().substr(0,10))}else Object.keys(i).forEach(s=>t=this.addToHttpParamsRecursive(t,i[s],null!=r?`${r}.${s}`:s));else{if(null==r)throw Error("key may not be null if value is not object or array");t=t.append(r,i)}return t}aggregateResults(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,c=t.bmi,l=t.bmiRange,u=t.cache,d=t.ontologyTerms,h=t.cellTypeTerms,f=t.consortiums,p=t.providers,g=t.sex,m=t.spatial,y=t.technologies,v=t.token;let _=new ht({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(S=>{_=this.addToHttpParams(_,S,"ontology-terms")}),h&&h.forEach(S=>{_=this.addToHttpParams(_,S,"cell-type-terms")}),f&&f.forEach(S=>{_=this.addToHttpParams(_,S,"consortiums")}),p&&p.forEach(S=>{_=this.addToHttpParams(_,S,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(S=>{_=this.addToHttpParams(_,S,"spatial")}),y&&y.forEach(S=>{_=this.addToHttpParams(_,S,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let E=this.defaultHeaders,A=s&&s.httpHeaderAccept;void 0===A&&(A=this.configuration.selectHeaderAccept(["application/json"])),void 0!==A&&(E=E.set("Accept",A));let x=s&&s.context;void 0===x&&(x=new it);let I="json";return A&&(I=A.startsWith("text")?"text":this.configuration.isJsonMime(A)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/aggregate-results`,{context:x,params:_,responseType:I,withCredentials:this.configuration.withCredentials,headers:E,observe:i,reportProgress:r})}anatomicalSystemsTreeModel(t,i="body",r=!1,s){const o=t.cache,a=t.token;let c=new ht({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new it);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/anatomical-systems-tree-model`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}biomarkerTermOccurences(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,c=t.bmi,l=t.bmiRange,u=t.cache,d=t.ontologyTerms,h=t.cellTypeTerms,f=t.consortiums,p=t.providers,g=t.sex,m=t.spatial,y=t.technologies,v=t.token;let _=new ht({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(S=>{_=this.addToHttpParams(_,S,"ontology-terms")}),h&&h.forEach(S=>{_=this.addToHttpParams(_,S,"cell-type-terms")}),f&&f.forEach(S=>{_=this.addToHttpParams(_,S,"consortiums")}),p&&p.forEach(S=>{_=this.addToHttpParams(_,S,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(S=>{_=this.addToHttpParams(_,S,"spatial")}),y&&y.forEach(S=>{_=this.addToHttpParams(_,S,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let E=this.defaultHeaders,A=s&&s.httpHeaderAccept;void 0===A&&(A=this.configuration.selectHeaderAccept(["application/json"])),void 0!==A&&(E=E.set("Accept",A));let x=s&&s.context;void 0===x&&(x=new it);let I="json";return A&&(I=A.startsWith("text")?"text":this.configuration.isJsonMime(A)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/biomarker-term-occurences`,{context:x,params:_,responseType:I,withCredentials:this.configuration.withCredentials,headers:E,observe:i,reportProgress:r})}biomarkerTreeModel(t,i="body",r=!1,s){const o=t.cache,a=t.token;let c=new ht({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new it);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/biomarker-tree-model`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}cellTypeTermOccurences(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,c=t.bmi,l=t.bmiRange,u=t.cache,d=t.ontologyTerms,h=t.cellTypeTerms,f=t.consortiums,p=t.providers,g=t.sex,m=t.spatial,y=t.technologies,v=t.token;let _=new ht({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(S=>{_=this.addToHttpParams(_,S,"ontology-terms")}),h&&h.forEach(S=>{_=this.addToHttpParams(_,S,"cell-type-terms")}),f&&f.forEach(S=>{_=this.addToHttpParams(_,S,"consortiums")}),p&&p.forEach(S=>{_=this.addToHttpParams(_,S,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(S=>{_=this.addToHttpParams(_,S,"spatial")}),y&&y.forEach(S=>{_=this.addToHttpParams(_,S,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let E=this.defaultHeaders,A=s&&s.httpHeaderAccept;void 0===A&&(A=this.configuration.selectHeaderAccept(["application/json"])),void 0!==A&&(E=E.set("Accept",A));let x=s&&s.context;void 0===x&&(x=new it);let I="json";return A&&(I=A.startsWith("text")?"text":this.configuration.isJsonMime(A)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/cell-type-term-occurences`,{context:x,params:_,responseType:I,withCredentials:this.configuration.withCredentials,headers:E,observe:i,reportProgress:r})}cellTypeTreeModel(t,i="body",r=!1,s){const o=t.cache,a=t.token;let c=new ht({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new it);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/cell-type-tree-model`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}collisions(t,i="body",r=!1,s){const o=t.spatialEntity;if(null==o)throw new Error("Required parameter spatialEntity was null or undefined when calling collisions.");let a=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(a=a.set("Accept",c));let l=s&&s.context;void 0===l&&(l=new it);const d=this.configuration.selectHeaderContentType(["application/json"]);void 0!==d&&(a=a.set("Content-Type",d));let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/v1/collisions`,o,{context:l,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:i,reportProgress:r})}corridor(t,i="body",r=!1,s){const o=t.spatialEntity;if(null==o)throw new Error("Required parameter spatialEntity was null or undefined when calling corridor.");let a=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["model/gltf-binary","application/json"])),void 0!==c&&(a=a.set("Accept",c));let l=s&&s.context;void 0===l&&(l=new it);const d=this.configuration.selectHeaderContentType(["application/json"]);return void 0!==d&&(a=a.set("Content-Type",d)),this.httpClient.post(`${this.configuration.basePath}/v1/corridor`,o,{context:l,responseType:"blob",withCredentials:this.configuration.withCredentials,headers:a,observe:i,reportProgress:r})}dbStatus(t,i="body",r=!1,s){const o=t.token;let a=new ht({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"token"));let c=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(c=c.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new it);let d="json";return l&&(d=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/db-status`,{context:u,params:a,responseType:d,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}dsGraph(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,c=t.bmi,l=t.bmiRange,u=t.cache,d=t.ontologyTerms,h=t.cellTypeTerms,f=t.consortiums,p=t.providers,g=t.sex,m=t.spatial,y=t.technologies,v=t.token;let _=new ht({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(S=>{_=this.addToHttpParams(_,S,"ontology-terms")}),h&&h.forEach(S=>{_=this.addToHttpParams(_,S,"cell-type-terms")}),f&&f.forEach(S=>{_=this.addToHttpParams(_,S,"consortiums")}),p&&p.forEach(S=>{_=this.addToHttpParams(_,S,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(S=>{_=this.addToHttpParams(_,S,"spatial")}),y&&y.forEach(S=>{_=this.addToHttpParams(_,S,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let E=this.defaultHeaders,A=s&&s.httpHeaderAccept;void 0===A&&(A=this.configuration.selectHeaderAccept(["application/json"])),void 0!==A&&(E=E.set("Accept",A));let x=s&&s.context;void 0===x&&(x=new it);let I="json";return A&&(I=A.startsWith("text")?"text":this.configuration.isJsonMime(A)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/ds-graph`,{context:x,params:_,responseType:I,withCredentials:this.configuration.withCredentials,headers:E,observe:i,reportProgress:r})}extractionSite(t,i="body",r=!1,s){const o=t.iri;if(null==o)throw new Error("Required parameter iri was null or undefined when calling extractionSite.");let a=new ht({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"iri"));let c=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(c=c.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new it);let d="json";return l&&(d=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/extraction-site`,{context:u,params:a,responseType:d,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}getSpatialPlacement(t,i="body",r=!1,s){const o=t.getSpatialPlacementRequest;if(null==o)throw new Error("Required parameter getSpatialPlacementRequest was null or undefined when calling getSpatialPlacement.");let a=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(a=a.set("Accept",c));let l=s&&s.context;void 0===l&&(l=new it);const d=this.configuration.selectHeaderContentType(["application/json"]);void 0!==d&&(a=a.set("Content-Type",d));let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/v1/get-spatial-placement`,o,{context:l,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:i,reportProgress:r})}gtexRuiLocations(t,i="body",r=!1,s){const o=t.cache;let a=new ht({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"cache"));let c=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(c=c.set("Accept",l));let u=s&&s.context;void 0===u&&(u=new it);let d="json";return l&&(d=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/gtex/rui_locations.jsonld`,{context:u,params:a,responseType:d,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}hubmapRuiLocations(t,i="body",r=!1,s){const o=t.cache,a=t.token;let c=new ht({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new it);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/hubmap/rui_locations.jsonld`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}mesh3dCellPopulation(t,i="body",r=!1,s){const o=t.mesh3dCellPopulationRequest;if(null==o)throw new Error("Required parameter mesh3dCellPopulationRequest was null or undefined when calling mesh3dCellPopulation.");let a=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["text/csv","application/json"])),void 0!==c&&(a=a.set("Accept",c));let l=s&&s.context;void 0===l&&(l=new it);const d=this.configuration.selectHeaderContentType(["application/json"]);return void 0!==d&&(a=a.set("Content-Type",d)),this.httpClient.post(`${this.configuration.basePath}/v1/mesh-3d-cell-population`,o,{context:l,responseType:"blob",withCredentials:this.configuration.withCredentials,headers:a,observe:i,reportProgress:r})}ontologyTermOccurences(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,c=t.bmi,l=t.bmiRange,u=t.cache,d=t.ontologyTerms,h=t.cellTypeTerms,f=t.consortiums,p=t.providers,g=t.sex,m=t.spatial,y=t.technologies,v=t.token;let _=new ht({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(S=>{_=this.addToHttpParams(_,S,"ontology-terms")}),h&&h.forEach(S=>{_=this.addToHttpParams(_,S,"cell-type-terms")}),f&&f.forEach(S=>{_=this.addToHttpParams(_,S,"consortiums")}),p&&p.forEach(S=>{_=this.addToHttpParams(_,S,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(S=>{_=this.addToHttpParams(_,S,"spatial")}),y&&y.forEach(S=>{_=this.addToHttpParams(_,S,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let E=this.defaultHeaders,A=s&&s.httpHeaderAccept;void 0===A&&(A=this.configuration.selectHeaderAccept(["application/json"])),void 0!==A&&(E=E.set("Accept",A));let x=s&&s.context;void 0===x&&(x=new it);let I="json";return A&&(I=A.startsWith("text")?"text":this.configuration.isJsonMime(A)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/ontology-term-occurences`,{context:x,params:_,responseType:I,withCredentials:this.configuration.withCredentials,headers:E,observe:i,reportProgress:r})}ontologyTreeModel(t,i="body",r=!1,s){const o=t.cache,a=t.token;let c=new ht({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new it);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/ontology-tree-model`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}providerNames(t,i="body",r=!1,s){const o=t.cache,a=t.token;let c=new ht({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new it);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/provider-names`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}referenceOrganScene(t,i="body",r=!1,s){const o=t.organIri;if(null==o)throw new Error("Required parameter organIri was null or undefined when calling referenceOrganScene.");const a=t.age,c=t.ageRange,l=t.bmi,u=t.bmiRange,d=t.cache,h=t.ontologyTerms,f=t.cellTypeTerms,p=t.consortiums,g=t.providers,m=t.sex,y=t.spatial,v=t.technologies,_=t.token;let E=new ht({encoder:this.encoder});null!=a&&(E=this.addToHttpParams(E,a,"age")),null!=c&&(E=this.addToHttpParams(E,c,"age-range")),null!=l&&(E=this.addToHttpParams(E,l,"bmi")),null!=u&&(E=this.addToHttpParams(E,u,"bmi-range")),null!=d&&(E=this.addToHttpParams(E,d,"cache")),h&&h.forEach(F=>{E=this.addToHttpParams(E,F,"ontology-terms")}),f&&f.forEach(F=>{E=this.addToHttpParams(E,F,"cell-type-terms")}),null!=o&&(E=this.addToHttpParams(E,o,"organ-iri")),p&&p.forEach(F=>{E=this.addToHttpParams(E,F,"consortiums")}),g&&g.forEach(F=>{E=this.addToHttpParams(E,F,"providers")}),null!=m&&(E=this.addToHttpParams(E,m,"sex")),y&&y.forEach(F=>{E=this.addToHttpParams(E,F,"spatial")}),v&&v.forEach(F=>{E=this.addToHttpParams(E,F,"technologies")}),null!=_&&(E=this.addToHttpParams(E,_,"token"));let A=this.defaultHeaders,x=s&&s.httpHeaderAccept;void 0===x&&(x=this.configuration.selectHeaderAccept(["application/json"])),void 0!==x&&(A=A.set("Accept",x));let I=s&&s.context;void 0===I&&(I=new it);let S="json";return x&&(S=x.startsWith("text")?"text":this.configuration.isJsonMime(x)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/reference-organ-scene`,{context:I,params:E,responseType:S,withCredentials:this.configuration.withCredentials,headers:A,observe:i,reportProgress:r})}referenceOrgans(t,i="body",r=!1,s){const o=t.cache,a=t.token;let c=new ht({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new it);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/reference-organs`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}ruiReferenceData(t="body",i=!1,r){let s=this.defaultHeaders,o=r&&r.httpHeaderAccept;void 0===o&&(o=this.configuration.selectHeaderAccept(["application/json"])),void 0!==o&&(s=s.set("Accept",o));let a=r&&r.context;void 0===a&&(a=new it);let c="json";return o&&(c=o.startsWith("text")?"text":this.configuration.isJsonMime(o)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/rui-reference-data`,{context:a,responseType:c,withCredentials:this.configuration.withCredentials,headers:s,observe:t,reportProgress:i})}scene(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,c=t.bmi,l=t.bmiRange,u=t.cache,d=t.ontologyTerms,h=t.cellTypeTerms,f=t.consortiums,p=t.providers,g=t.sex,m=t.spatial,y=t.technologies,v=t.token;let _=new ht({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(S=>{_=this.addToHttpParams(_,S,"ontology-terms")}),h&&h.forEach(S=>{_=this.addToHttpParams(_,S,"cell-type-terms")}),f&&f.forEach(S=>{_=this.addToHttpParams(_,S,"consortiums")}),p&&p.forEach(S=>{_=this.addToHttpParams(_,S,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(S=>{_=this.addToHttpParams(_,S,"spatial")}),y&&y.forEach(S=>{_=this.addToHttpParams(_,S,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let E=this.defaultHeaders,A=s&&s.httpHeaderAccept;void 0===A&&(A=this.configuration.selectHeaderAccept(["application/json"])),void 0!==A&&(E=E.set("Accept",A));let x=s&&s.context;void 0===x&&(x=new it);let I="json";return A&&(I=A.startsWith("text")?"text":this.configuration.isJsonMime(A)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/scene`,{context:x,params:_,responseType:I,withCredentials:this.configuration.withCredentials,headers:E,observe:i,reportProgress:r})}sennetRuiLocations(t,i="body",r=!1,s){const o=t.cache,a=t.token;let c=new ht({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new it);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/sennet/rui_locations.jsonld`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}sessionToken(t,i="body",r=!1,s){const o=t.sessionTokenRequest;if(null==o)throw new Error("Required parameter sessionTokenRequest was null or undefined when calling sessionToken.");let a=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(a=a.set("Accept",c));let l=s&&s.context;void 0===l&&(l=new it);const d=this.configuration.selectHeaderContentType(["application/json"]);void 0!==d&&(a=a.set("Content-Type",d));let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/v1/session-token`,o,{context:l,responseType:h,withCredentials:this.configuration.withCredentials,headers:a,observe:i,reportProgress:r})}sparql(t,i="body",r=!1,s){const o=t.query;if(null==o)throw new Error("Required parameter query was null or undefined when calling sparql.");const a=t.token,c=t.format;let l=new ht({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"query")),null!=a&&(l=this.addToHttpParams(l,a,"token")),null!=c&&(l=this.addToHttpParams(l,c,"format"));let u=this.defaultHeaders,d=s&&s.httpHeaderAccept;void 0===d&&(d=this.configuration.selectHeaderAccept(["application/json","text/csv"])),void 0!==d&&(u=u.set("Accept",d));let h=s&&s.context;void 0===h&&(h=new it);let f="json";return d&&(f=d.startsWith("text")?"text":this.configuration.isJsonMime(d)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/sparql`,{context:h,params:l,responseType:f,withCredentials:this.configuration.withCredentials,headers:u,observe:i,reportProgress:r})}sparqlPost(t,i="body",r=!1,s){const o=t.sparqlQueryRequest;if(null==o)throw new Error("Required parameter sparqlQueryRequest was null or undefined when calling sparqlPost.");const a=t.token,c=t.format;let l=new ht({encoder:this.encoder});null!=a&&(l=this.addToHttpParams(l,a,"token")),null!=c&&(l=this.addToHttpParams(l,c,"format"));let u=this.defaultHeaders,d=s&&s.httpHeaderAccept;void 0===d&&(d=this.configuration.selectHeaderAccept(["application/json","text/csv"])),void 0!==d&&(u=u.set("Accept",d));let h=s&&s.context;void 0===h&&(h=new it);const p=this.configuration.selectHeaderContentType(["application/json","application/x-www-form-urlencoded"]);void 0!==p&&(u=u.set("Content-Type",p));let g="json";return d&&(g=d.startsWith("text")?"text":this.configuration.isJsonMime(d)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/v1/sparql`,o,{context:h,params:l,responseType:g,withCredentials:this.configuration.withCredentials,headers:u,observe:i,reportProgress:r})}technologyNames(t,i="body",r=!1,s){const o=t.cache,a=t.token;let c=new ht({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"cache")),null!=a&&(c=this.addToHttpParams(c,a,"token"));let l=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(l=l.set("Accept",u));let d=s&&s.context;void 0===d&&(d=new it);let h="json";return u&&(h=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/technology-names`,{context:d,params:c,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}tissueBlocks(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,c=t.bmi,l=t.bmiRange,u=t.cache,d=t.ontologyTerms,h=t.cellTypeTerms,f=t.consortiums,p=t.providers,g=t.sex,m=t.spatial,y=t.technologies,v=t.token;let _=new ht({encoder:this.encoder});null!=o&&(_=this.addToHttpParams(_,o,"age")),null!=a&&(_=this.addToHttpParams(_,a,"age-range")),null!=c&&(_=this.addToHttpParams(_,c,"bmi")),null!=l&&(_=this.addToHttpParams(_,l,"bmi-range")),null!=u&&(_=this.addToHttpParams(_,u,"cache")),d&&d.forEach(S=>{_=this.addToHttpParams(_,S,"ontology-terms")}),h&&h.forEach(S=>{_=this.addToHttpParams(_,S,"cell-type-terms")}),f&&f.forEach(S=>{_=this.addToHttpParams(_,S,"consortiums")}),p&&p.forEach(S=>{_=this.addToHttpParams(_,S,"providers")}),null!=g&&(_=this.addToHttpParams(_,g,"sex")),m&&m.forEach(S=>{_=this.addToHttpParams(_,S,"spatial")}),y&&y.forEach(S=>{_=this.addToHttpParams(_,S,"technologies")}),null!=v&&(_=this.addToHttpParams(_,v,"token"));let E=this.defaultHeaders,A=s&&s.httpHeaderAccept;void 0===A&&(A=this.configuration.selectHeaderAccept(["application/json"])),void 0!==A&&(E=E.set("Accept",A));let x=s&&s.context;void 0===x&&(x=new it);let I="json";return A&&(I=A.startsWith("text")?"text":this.configuration.isJsonMime(A)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/v1/tissue-blocks`,{context:x,params:_,responseType:I,withCredentials:this.configuration.withCredentials,headers:E,observe:i,reportProgress:r})}static \u0275fac=function(i){return new(i||n)(O($s),O(JD,8),O(Rc,8))};static \u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Th=function(n){return n.Both="Both",n.Male="Male",n.Female="Female",n}(Th||{});let jOe=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[{provide:Rc,useFactory:t}]}}constructor(t,i){if(t)throw new Error("HraApiModule is already loaded. Import in your base AppModule only.");if(!i)throw new Error("You need to import the HttpClientModule in your AppModule! \nSee also https://github.com/angular/angular/issues/20575")}static \u0275fac=function(i){return new(i||n)(O(n,12),O($s,8))};static \u0275mod=fn({type:n});static \u0275inj=ln({})}return n})();class HOe extends kt{constructor(e,t){super()}schedule(e,t=0){return this}}const g0={setInterval(n,e,...t){const{delegate:i}=g0;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=g0;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class QD extends HOe{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return g0.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&g0.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,fu(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}class Qg{constructor(e,t=Qg.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}Qg.now=XA.now;class e1 extends Qg{constructor(e,t=Qg.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const m0=new e1(QD),zOe=m0;function _0(n,e=m0){return Ft((t,i)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const l=s;s=null,i.next(l)}};function c(){const l=o+n,u=e.now();if(u<l)return r=this.schedule(void 0,l-u),void i.add(r);a()}t.subscribe(It(i,l=>{s=l,o=e.now(),r||(r=e.schedule(c,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{s=r=null}))})}function S6(){return Ft((n,e)=>{n.subscribe(It(e,zc))})}function M6(n,e){return e?t=>fh(e.pipe(ii(1),S6()),t.pipe(M6(n))):Dn((t,i)=>li(n(t,i)).pipe(ii(1),mD(t)))}function y0(n=0,e,t=zOe){let i=-1;return null!=e&&(j2(e)?t=e:i=e),new be(r=>{let s=function GOe(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}function I6(n,e=m0){const t=y0(n,e);return M6(()=>t)}const XOe={connector:()=>new fe};function KOe(n,e,t,i){t&&!$e(t)&&(i=t);const r=$e(t)?t:void 0;return s=>function ZOe(n,e){const t=$e(n)?n:()=>n;return $e(e)?function YOe(n,e=XOe){const{connector:t}=e;return Ft((i,r)=>{const s=t();li(n(function qOe(n){return new be(e=>n.subscribe(e))}(s))).subscribe(r),r.add(i.subscribe(s))})}(e,{connector:t}):i=>new pD(i,t)}(new na(n,e,i),r)(s)}class JOe{}const ePe=(n,e)=>JSON.stringify(n)===JSON.stringify(e),tPe=n=>n.map(e=>void 0!==e?JSON.parse(JSON.stringify(e)):e),qs={storageStrategy:class QOe extends JOe{constructor(){super(...arguments),this.cachePairs=[]}add(e,t,i){this.cachePairs.push(e)}addMany(e){this.cachePairs=e}updateAtIndex(e,t){Object.assign(this.cachePairs[e],t)}update(e,t){Object.assign(this.cachePairs[e],t)}getAll(){return this.cachePairs}removeAtIndex(e){this.cachePairs.splice(e,1)}remove(e){this.cachePairs.splice(e,1)}removeAll(){this.cachePairs.length=0}},globalCacheKey:"CACHE_STORAGE",promiseImplementation:Promise},nPe=new fe;function Xr(n={}){return function(e,t,i){const r=n.cacheKey||e.constructor.name+"#"+t,s=i.value;if(i&&i.value){let o=n.storageStrategy?new n.storageStrategy:new qs.storageStrategy;const a=[];n.cacheModifier&&n.cacheModifier.subscribe(u=>o.addMany(u(o.getAll(r,this)),r,this)),vl(nPe.asObservable(),n.cacheBusterObserver?n.cacheBusterObserver:function Bre(n){return n?function Vre(n){return new be(e=>n.schedule(()=>e.complete()))}(n):Br}()).subscribe(u=>{o.removeAll(r,this),a.length=0}),n.cacheResolver=n.cacheResolver||qs.cacheResolver||ePe,n.cacheHasher=n.cacheHasher||qs.cacheHasher||tPe,i.value=function(...u){const d=o.getAll(r,this);let h=n.cacheHasher(u),f=d.find(g=>n.cacheResolver(g.parameters,h));const p=a.find(g=>n.cacheResolver(g.parameters,h));if((n.maxAge||qs.maxAge)&&f&&f.created&&((new Date).getTime()-new Date(f.created).getTime()>(n.maxAge||qs.maxAge)?(o.remove?o.remove(d.indexOf(f),f,r,this):o.removeAtIndex(d.indexOf(f),r,this),f=null):(n.slidingExpiration||qs.slidingExpiration)&&(f.created=new Date,o.update?o.update(d.indexOf(f),f,r,this):o.updateAtIndex(d.indexOf(f),f,r,this))),f){const g=ee(f.response);return n.async?g.pipe(I6(0)):g}if(p)return p.response;{const g=s.call(this,...u).pipe(Tc(()=>{const m=a.find(y=>n.cacheResolver(y.parameters,h));a.splice(a.indexOf(m),1)}),Nt(m=>{(!n.shouldCacheDecider||n.shouldCacheDecider(m))&&((!(n.maxCacheCount||qs.maxCacheCount)||1===(n.maxCacheCount||qs.maxCacheCount)||(n.maxCacheCount||qs.maxCacheCount)&&(n.maxCacheCount||qs.maxCacheCount)<d.length+1)&&(o.remove?o.remove(0,d[0],r,this):o.removeAtIndex(0,r,this)),o.add({parameters:h,response:m,created:n.maxAge||qs.maxAge?new Date:null},r,this))}),KOe(1),Gb());return a.push({parameters:h,response:g,created:new Date}),g}}}return i}}const t1=new fe,xh={cacheBusterObserver:t1},Jl={cacheBusterObserver:t1,maxCacheCount:4};function D6(n,e,t){return n?{min:n[0]>e?n[0]:void 0,max:n[1]<t?n[1]:void 0}:void 0}function iPe(n){return n.map(e=>({...e,transformMatrix:new Ge(e.transformMatrix??[])}))}function rPe(n){return{age:D6(n?.ageRange,1,110),bmi:D6(n?.bmiRange,13,83),sex:n?.sex?.toLowerCase(),ontologyTerms:n?.ontologyTerms,cellTypeTerms:n?.cellTypeTerms,biomarkerTerms:n?.biomarkerTerms,consortiums:n?.consortiums,providers:n?.tmc,technologies:n?.technologies,spatial:n?.spatialSearches}}function sPe(n,e){return n.remoteApiEndpoint===e.remoteApiEndpoint&&n.token===e.token&&(void 0!==n.token||n.filter===e.filter&&n.dataSources===e.dataSources)}class di{constructor(){this.api=D(x6),this.globalConfig=D(Wl),this.config$=this.globalConfig.config$.pipe(le(n=>n),hh(sPe),_0(10),pn(e=>this.getSessionToken(e)),Nt(()=>t1.next(null)),ps(1)),this.config$.subscribe()}getDatabaseStatus(){return this.doRequest(e=>this.api.dbStatus(e))}getProviderNames(){return this.doRequest(e=>this.api.providerNames(e))}getDatasetTechnologyNames(){return this.doRequest(e=>this.api.technologyNames(e))}getOntologyTreeModel(){return this.doRequest(e=>this.api.ontologyTreeModel(e),void 0,{},n=>n)}getCellTypeTreeModel(){return this.doRequest(e=>this.api.cellTypeTreeModel(e),void 0,{},n=>n)}getBiomarkerTreeModel(){return this.doRequest(e=>this.api.biomarkerTreeModel(e),void 0,{},n=>n)}getReferenceOrgans(){return this.doRequest(e=>this.api.referenceOrgans(e),void 0,{},n=>n)}getTissueBlockResults(e){return this.doRequest(t=>this.api.tissueBlocks(t),e,{},n=>n)}getAggregateResults(e){return this.doRequest(t=>this.api.aggregateResults(t),e)}getOntologyTermOccurences(e){return this.doRequest(t=>this.api.ontologyTermOccurences(t),e)}getCellTypeTermOccurences(e){return this.doRequest(t=>this.api.cellTypeTermOccurences(t),e)}getBiomarkerTermOccurences(e){return this.doRequest(t=>this.api.biomarkerTermOccurences(t),e)}getScene(e){return this.doRequest(t=>this.api.scene(t),e,{},iPe)}getReferenceOrganScene(e,t){return this.doRequest(i=>this.api.referenceOrganScene(i),t,{organIri:e})}doRequest(e,t,i,r){const{api:s,config$:o}=this,a={...rPe(t),...i};return o.pipe(_0(50),ii(1),Nt(({remoteApiEndpoint:c,token:l})=>{s.configuration.basePath=c,l&&(a.token=l)}),pn(()=>e(a)),le(c=>r?r(c):c))}getSessionToken(e){if(e.token)return ee(e);const{remoteApiEndpoint:t,dataSources:i=[],filter:r}=e;if(0===i.length&&void 0===r)return ee(e);const{api:s}=this,o={dataSources:i,filter:r};return s.configuration.basePath=t,s.sessionToken({sessionTokenRequest:o}).pipe(pn(({token:a})=>this.ensureDatabaseReady(a)),le(a=>({...e,token:a})))}ensureDatabaseReady(e){return ee(void 0).pipe(function WOe(n){let t,e=1/0;return null!=n&&("object"==typeof n?({count:e=1/0,delay:t}=n):e=n),e<=0?()=>Br:Ft((i,r)=>{let o,s=0;const a=()=>{if(o?.unsubscribe(),o=null,null!=t){const l="number"==typeof t?y0(t):li(t(s)),u=It(r,()=>{u.unsubscribe(),c()});l.subscribe(u)}else c()},c=()=>{let l=!1;o=i.subscribe(It(r,void 0,()=>{++s<e?o?a():l=!0:r.complete()})),l&&a()};c()})}({delay:()=>this.api.dbStatus({token:e}).pipe(wt(i=>"Ready"!==i.status),pn(i=>ee(void 0).pipe(I6(i.checkback??0))))}),S6(),function $Oe(...n){return e=>fh(e,ee(...n))}(e))}static{this.\u0275fac=function(t){return new(t||di)}}static{this.\u0275prov=j({token:di,factory:di.\u0275fac,providedIn:"root"})}}tt([Xr(xh),te("design:type",Function),te("design:paramtypes",[]),te("design:returntype",be)],di.prototype,"getProviderNames",null),tt([Xr(xh),te("design:type",Function),te("design:paramtypes",[]),te("design:returntype",be)],di.prototype,"getDatasetTechnologyNames",null),tt([Xr(xh),te("design:type",Function),te("design:paramtypes",[]),te("design:returntype",be)],di.prototype,"getOntologyTreeModel",null),tt([Xr(xh),te("design:type",Function),te("design:paramtypes",[]),te("design:returntype",be)],di.prototype,"getCellTypeTreeModel",null),tt([Xr(xh),te("design:type",Function),te("design:paramtypes",[]),te("design:returntype",be)],di.prototype,"getBiomarkerTreeModel",null),tt([Xr(xh),te("design:type",Function),te("design:paramtypes",[]),te("design:returntype",be)],di.prototype,"getReferenceOrgans",null),tt([Xr(Jl),te("design:type",Function),te("design:paramtypes",[Object]),te("design:returntype",be)],di.prototype,"getTissueBlockResults",null),tt([Xr(Jl),te("design:type",Function),te("design:paramtypes",[Object]),te("design:returntype",be)],di.prototype,"getAggregateResults",null),tt([Xr(Jl),te("design:type",Function),te("design:paramtypes",[Object]),te("design:returntype",be)],di.prototype,"getOntologyTermOccurences",null),tt([Xr(Jl),te("design:type",Function),te("design:paramtypes",[Object]),te("design:returntype",be)],di.prototype,"getCellTypeTermOccurences",null),tt([Xr(Jl),te("design:type",Function),te("design:paramtypes",[Object]),te("design:returntype",be)],di.prototype,"getBiomarkerTermOccurences",null),tt([Xr(Jl),te("design:type",Function),te("design:paramtypes",[Object]),te("design:returntype",be)],di.prototype,"getScene",null),tt([Xr(Jl),te("design:type",Function),te("design:paramtypes",[String,Object]),te("design:returntype",be)],di.prototype,"getReferenceOrganScene",null);class R6 extends Error{constructor(){super(...arguments),this.message="NgxsDispatchPluginModule is not imported"}}class dPe{constructor(){this.cancelUncompleted$=new fe}cancelPreviousAction(){this.cancelUncompleted$.next()}}const n1="\u0275fac",O6=Symbol("InjectorInstance"),P6=Symbol("FactoryHasBeenDecorated");function N6(n,e){const t=n[O6];return t?t.get(e):null}const pPe={cancelUncompleted:!1};function k6(n=pPe){return(e,t,i)=>{let r;const s=function hPe(n){return n?new dPe:null}(n.cancelUncompleted);function o(){null!==s&&s.cancelPreviousAction();const a=N6(this,gs)||function lPe(){throw new R6}(),c=N6(this,ye)||function uPe(){throw new R6}(),l=r.apply(this,arguments);return c.runOutsideAngular(()=>function cPe(n,e,t){return Qa(e)?function aPe(n,e){return e.then(t=>(n.dispatch(t),t))}(n,e):Bs(e)?function oPe(n,e,t){return null!==t&&(e=e.pipe(zs(t.cancelUncompleted$))),e.subscribe({next:i=>n.dispatch(i)}),e}(n,e,t):(n.dispatch(e),e)}(a,l,s))}"function"==typeof i?.value?(r=i.value,i.value=o):Object.defineProperty(e,t,{set:a=>r=a,get:()=>o}),function fPe(n){if(P6 in n.constructor.prototype)return;const e=n.constructor;"function"==typeof e[n1]&&function r1(n){const e=n[n1];if("function"!=typeof e)return;const t=n.\u0275prov||n.\u0275pipe||n.\u0275cmp||n.\u0275dir,i=()=>{const r=e();return r[O6]=R(Gm),r};t&&(t.factory=i),Object.defineProperty(n,n1,{get:()=>i})}(e),n.constructor.prototype[P6]=!0}(e)}}let F6=(()=>{class n{static{this.type="[CallToAction] Learn More"}}return n})(),L6=(()=>{class n{static{this.type="[CallToAction] Open Dialog"}}return n})(),B6=(()=>{class n{static{this.type="[CallToAction] Close Dialog"}}return n})();function V6(n,e=0){return function gPe(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):2===arguments.length?e:0}function v0(n){return Array.isArray(n)?n:[n]}function Hn(n){return null==n?"":"string"==typeof n?n:`${n}px`}function Mh(n){return n instanceof At?n.nativeElement:n}const tm={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=tm;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=e(s=>{t=void 0,n(s)});return new kt(()=>t?.(r))},requestAnimationFrame(...n){const{delegate:e}=tm;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=tm;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0};new class _Pe extends e1{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class mPe extends QD{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=tm.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(tm.cancelAnimationFrame(t),e._scheduled=void 0)}});let s1,vPe=1;const b0={};function U6(n){return n in b0&&(delete b0[n],!0)}const bPe={setImmediate(n){const e=vPe++;return b0[e]=!0,s1||(s1=Promise.resolve()),s1.then(()=>U6(e)&&n()),e},clearImmediate(n){U6(n)}},{setImmediate:wPe,clearImmediate:EPe}=bPe,w0={setImmediate(...n){const{delegate:e}=w0;return(e?.setImmediate||wPe)(...n)},clearImmediate(n){const{delegate:e}=w0;return(e?.clearImmediate||EPe)(n)},delegate:void 0};new class APe extends e1{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class CPe extends QD{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=w0.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(w0.clearImmediate(t),e._scheduled=void 0)}});function j6(n,e=m0){return function xPe(n){return Ft((e,t)=>{let i=!1,r=null,s=null,o=!1;const a=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const l=r;r=null,t.next(l)}o&&t.complete()},c=()=>{s=null,o&&t.complete()};e.subscribe(It(t,l=>{i=!0,r=l,s||li(n(l)).subscribe(s=It(t,a,c))},()=>{o=!0,(!i||!s||s.closed)&&t.complete()}))})}(()=>y0(n,e))}let o1;try{o1=typeof Intl<"u"&&Intl.v8BreakIterator}catch{o1=!1}let nm,ms=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?rc(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!o1)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static{this.\u0275fac=function(i){return new(i||n)(O(is))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function E0(n){return function SPe(){if(null==nm&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>nm=!0}))}finally{nm=nm||!1}return nm}()?n:!!n.capture}var Po=function(n){return n[n.NORMAL=0]="NORMAL",n[n.NEGATED=1]="NEGATED",n[n.INVERTED=2]="INVERTED",n}(Po||{});let C0,Ql,a1;function z6(){if(null==Ql){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Ql=!1,Ql;if("scrollBehavior"in document.documentElement.style)Ql=!0;else{const n=Element.prototype.scrollTo;Ql=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return Ql}function im(){if("object"!=typeof document||!document)return Po.NORMAL;if(null==C0){const n=document.createElement("div"),e=n.style;n.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),i=t.style;i.width="2px",i.height="1px",n.appendChild(t),document.body.appendChild(n),C0=Po.NORMAL,0===n.scrollLeft&&(n.scrollLeft=1,C0=0===n.scrollLeft?Po.NEGATED:Po.INVERTED),n.remove()}return C0}function c1(){let n=typeof document<"u"&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const e=n.shadowRoot.activeElement;if(e===n)break;n=e}return n}function Oc(n){return n.composedPath?n.composedPath()[0]:n.target}function l1(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}const DPe=new k("cdk-dir-doc",{providedIn:"root",factory:function RPe(){return D(nt)}}),OPe=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let A0=(()=>{class n{constructor(t){this.value="ltr",this.change=new Ae,t&&(this.value=function PPe(n){const e=n?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?OPe.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static{this.\u0275fac=function(i){return new(i||n)(O(DPe,8))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),G6=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({})}}return n})(),W6=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new fe,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new be(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(j6(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):ee()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(wt(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=Mh(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Pg(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static{this.\u0275fac=function(i){return new(i||n)(O(ye),O(ms),O(nt,8))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),kPe=(()=>{class n{constructor(t,i,r,s){this.elementRef=t,this.scrollDispatcher=i,this.ngZone=r,this.dir=s,this._destroyed=new fe,this._elementScrolled=new be(o=>this.ngZone.runOutsideAngular(()=>Pg(this.elementRef.nativeElement,"scroll").pipe(zs(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const i=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=r?t.end:t.start),null==t.right&&(t.right=r?t.start:t.end),null!=t.bottom&&(t.top=i.scrollHeight-i.clientHeight-t.bottom),r&&im()!=Po.NORMAL?(null!=t.left&&(t.right=i.scrollWidth-i.clientWidth-t.left),im()==Po.INVERTED?t.left=t.right:im()==Po.NEGATED&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=i.scrollWidth-i.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const i=this.elementRef.nativeElement;z6()?i.scrollTo(t):(null!=t.top&&(i.scrollTop=t.top),null!=t.left&&(i.scrollLeft=t.left))}measureScrollOffset(t){const i="left",r="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const o=this.dir&&"rtl"==this.dir.value;return"start"==t?t=o?r:i:"end"==t&&(t=o?i:r),o&&im()==Po.INVERTED?t==i?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:o&&im()==Po.NEGATED?t==i?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==i?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}static{this.\u0275fac=function(i){return new(i||n)(R(At),R(W6),R(ye),R(A0,8))}}static{this.\u0275dir=se({type:n,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0})}}return n})(),$6=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new fe,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(j6(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static{this.\u0275fac=function(i){return new(i||n)(O(ms),O(ye),O(nt,8))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();class u1{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class d1 extends u1{constructor(e,t,i,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=s}}class h1 extends u1{constructor(e,t,i,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class LPe extends u1{constructor(e){super(),this.element=e instanceof At?e.nativeElement:e}}class f1{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof d1?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof h1?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof LPe?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class BPe extends f1{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=o=>{const a=o.element,c=this._document.createComment("dom-portal");a.parentNode.insertBefore(c,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{c.parentNode&&c.parentNode.replaceChild(a,c)})},this._document=s}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector||gt.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let T0=(()=>{class n extends f1{constructor(t,i,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new Ae,this.attachDomPortal=s=>{const o=s.element,a=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(a,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{a.parentNode&&a.parentNode.replaceChild(o,a)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);const i=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),o=i.createComponent(s,i.length,t.injector||i.injector,t.projectableNodes||void 0);return i!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=t,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(t){t.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}static{this.\u0275fac=function(i){return new(i||n)(R(Ga),R(Qi),R(nt))}}static{this.\u0275dir=se({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[0,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],standalone:!0,features:[st]})}}return n})();const q6=z6();class VPe{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=Hn(-this._previousScrollPosition.left),e.style.top=Hn(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,r=this._document.body.style,s=i.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),q6&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),q6&&(i.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class UPe{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0).pipe(wt(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class X6{enable(){}disable(){}attach(){}}function p1(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function Y6(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class jPe{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();p1(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let HPe=(()=>{class n{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new X6,this.close=o=>new UPe(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new VPe(this._viewportRuler,this._document),this.reposition=o=>new jPe(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}static{this.\u0275fac=function(i){return new(i||n)(O(W6),O($6),O(ye),O(nt))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();class Z6{constructor(e){if(this.scrollStrategy=new X6,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class zPe{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let K6=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}static{this.\u0275fac=function(i){return new(i||n)(O(nt))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),GPe=(()=>{class n extends K6{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const a=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>a.next(r)):a.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static{this.\u0275fac=function(i){return new(i||n)(O(nt),O(ye,8))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),WPe=(()=>{class n extends K6{constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=Oc(s)},this._clickListener=s=>{const o=Oc(s),a="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const c=this._attachedOverlays.slice();for(let l=c.length-1;l>-1;l--){const u=c[l];if(u._outsidePointerEvents.observers.length<1||!u.hasAttached())continue;if(J6(u.overlayElement,o)||J6(u.overlayElement,a))break;const d=u._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>d.next(s)):d.next(s)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}static{this.\u0275fac=function(i){return new(i||n)(O(nt),O(ms),O(ye,8))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function J6(n,e){const t=typeof ShadowRoot<"u"&&ShadowRoot;let i=e;for(;i;){if(i===n)return!0;i=t&&i instanceof ShadowRoot?i.host:i.parentNode}return!1}let x0=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||l1()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const i=this._document.createElement("div");i.classList.add(t),l1()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}static{this.\u0275fac=function(i){return new(i||n)(O(nt),O(ms))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();class S0{constructor(e,t,i,r,s,o,a,c,l,u=!1,d){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=c,this._outsideClickDispatcher=l,this._animationsDisabled=u,this._injector=d,this._backdropElement=null,this._backdropClick=new fe,this._attachments=new fe,this._detachments=new fe,this._locationChanges=kt.EMPTY,this._backdropClickHandler=h=>this._backdropClick.next(h),this._backdropTransitionendHandler=h=>{this._disposeBackdrop(h.target)},this._keydownEvents=new fe,this._outsidePointerEvents=new fe,this._renders=new fe,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy,this._afterRenderRef=ss(()=>function yk(n,e){!e&&rf();const t=e?.injector??D(gt);return mr(t)?(Ki("NgAfterRender"),vk(n,t,!1,e?.phase??Ji.MixedReadWrite)):_k}(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),q_(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=Hn(this._config.width),e.height=Hn(this._config.height),e.minWidth=Hn(this._config.minWidth),e.minHeight=Hn(this._config.minHeight),e.maxWidth=Hn(this._config.maxWidth),e.maxHeight=Hn(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,i){const r=v0(t||[]).filter(s=>!!s);r.length&&(i?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{const e=this._renders.pipe(zs(vl(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const Q6="cdk-overlay-connected-position-bounding-box",$Pe=/([A-Za-z%]+)$/;class qPe{get positions(){return this._preferredPositions}constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new fe,this._resizeSubscription=kt.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add(Q6),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[];let o;for(let a of this._preferredPositions){let c=this._getOriginPoint(e,r,a),l=this._getOverlayPoint(c,t,a),u=this._getOverlayFit(l,t,i,a);if(u.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,c);this._canFitWithFlexibleDimensions(u,l,i)?s.push({position:a,origin:c,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(c,a)}):(!o||o.overlayFit.visibleArea<u.visibleArea)&&(o={overlayFit:u,overlayPoint:l,originPoint:c,position:a,overlayRect:t})}if(s.length){let a=null,c=-1;for(const l of s){const u=l.boundingBoxRect.width*l.boundingBoxRect.height*(l.position.weight||1);u>c&&(c=u,a=l)}return this._isPushed=!1,void this._applyPosition(a.position,a.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&eu(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(Q6),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,i){let r,s;if("center"==i.originX)r=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;r="start"==i.originX?o:a}return t.left<0&&(r-=t.left),s="center"==i.originY?e.top+e.height/2:"top"==i.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,i){let r,s;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){const s=t5(t);let{x:o,y:a}=e,c=this._getOffset(r,"x"),l=this._getOffset(r,"y");c&&(o+=c),l&&(a+=l);let h=0-a,f=a+s.height-i.height,p=this._subtractOverflows(s.width,0-o,o+s.width-i.width),g=this._subtractOverflows(s.height,h,f),m=p*g;return{visibleArea:m,isCompletelyWithinViewport:s.width*s.height===m,fitsInViewportVertically:g===s.height,fitsInViewportHorizontally:p==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,s=i.right-t.x,o=e5(this._overlayRef.getConfig().minHeight),a=e5(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=o&&o<=r)&&(e.fitsInViewportHorizontally||null!=a&&a<=s)}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=t5(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),c=Math.max(s.top-i.top-e.y,0),l=Math.max(s.left-i.left-e.x,0);let u=0,d=0;return u=r.width<=s.width?l||-o:e.x<this._viewportMargin?s.left-i.left-e.x:0,d=r.height<=s.height?c||-a:e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:u,y:d},{x:e.x+u,y:e.y+d}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._positionChanges.observers.length){const i=this._getScrollVisibility();if(e!==this._lastPosition||!this._lastScrollVisibility||!function XPe(n,e){return n===e||n.isOriginClipped===e.isOriginClipped&&n.isOriginOutsideView===e.isOriginOutsideView&&n.isOverlayClipped===e.isOverlayClipped&&n.isOverlayOutsideView===e.isOverlayOutsideView}(this._lastScrollVisibility,i)){const r=new zPe(e,i);this._positionChanges.next(r)}this._lastScrollVisibility=i}this._lastPosition=e,this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,r=this._isRtl();let s,o,a,u,d,h;if("top"===t.overlayY)o=e.y,s=i.height-o+this._viewportMargin;else if("bottom"===t.overlayY)a=i.height-e.y+2*this._viewportMargin,s=i.height-a+this._viewportMargin;else{const f=Math.min(i.bottom-e.y+i.top,e.y),p=this._lastBoundingBoxSize.height;s=2*f,o=e.y-f,s>p&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-p/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)h=i.width-e.x+2*this._viewportMargin,u=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)d=e.x,u=i.right-e.x;else{const f=Math.min(i.right-e.x+i.left,e.x),p=this._lastBoundingBoxSize.width;u=2*f,d=e.x-f,u>p&&!this._isInitialRender&&!this._growAfterOpen&&(d=e.x-p/2)}return{top:o,left:d,bottom:a,right:h,width:u,height:s}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=Hn(i.height),r.top=Hn(i.top),r.bottom=Hn(i.bottom),r.width=Hn(i.width),r.left=Hn(i.left),r.right=Hn(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=Hn(s)),o&&(r.maxWidth=Hn(o))}this._lastBoundingBoxSize=i,eu(this._boundingBox.style,r)}_resetBoundingBoxStyles(){eu(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){eu(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const u=this._viewportRuler.getViewportScrollPosition();eu(i,this._getExactOverlayY(t,e,u)),eu(i,this._getExactOverlayX(t,e,u))}else i.position="static";let a="",c=this._getOffset(t,"x"),l=this._getOffset(t,"y");c&&(a+=`translateX(${c}px) `),l&&(a+=`translateY(${l}px)`),i.transform=a.trim(),o.maxHeight&&(r?i.maxHeight=Hn(o.maxHeight):s&&(i.maxHeight="")),o.maxWidth&&(r?i.maxWidth=Hn(o.maxWidth):s&&(i.maxWidth="")),eu(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=Hn(s.y),r}_getExactOverlayX(e,t,i){let o,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=Hn(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Y6(e,i),isOriginOutsideView:p1(e,i),isOverlayClipped:Y6(t,i),isOverlayOutsideView:p1(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&v0(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof At)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function eu(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function e5(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split($Pe);return t&&"px"!==t?null:parseFloat(e)}return n||null}function t5(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const n5="cdk-global-overlay-wrapper";class YPe{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(n5),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=i,c=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),l=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a),u=this._xPosition,d=this._xOffset,h="rtl"===this._overlayRef.getConfig().direction;let f="",p="",g="";c?g="flex-start":"center"===u?(g="center",h?p=d:f=d):h?"left"===u||"end"===u?(g="flex-end",f=d):("right"===u||"start"===u)&&(g="flex-start",p=d):"left"===u||"start"===u?(g="flex-start",f=d):("right"===u||"end"===u)&&(g="flex-end",p=d),e.position=this._cssPosition,e.marginLeft=c?"0":f,e.marginTop=l?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=c?"0":p,t.justifyContent=g,t.alignItems=l?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(n5),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let ZPe=(()=>{class n{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new YPe}flexibleConnectedTo(t){return new qPe(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static{this.\u0275fac=function(i){return new(i||n)(O($6),O(nt),O(ms),O(x0))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),KPe=0,Pc=(()=>{class n{constructor(t,i,r,s,o,a,c,l,u,d,h,f){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=c,this._document=l,this._directionality=u,this._location=d,this._outsideClickDispatcher=h,this._animationsModuleType=f}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),o=new Z6(t);return o.direction=o.direction||this._directionality.value,new S0(s,i,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType,this._injector.get(ki))}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+KPe++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(vr)),new BPe(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static{this.\u0275fac=function(i){return new(i||n)(O(HPe),O(x0),O(Ga),O(ZPe),O(GPe),O(gt),O(ye),O(nt),O(A0),O(wl),O(WPe),O(il,8))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function M0(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}const o5=new Set;let tu,bNe=(()=>{class n{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):ENe}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function wNe(n,e){if(!o5.has(n))try{tu||(tu=document.createElement("style"),e&&tu.setAttribute("nonce",e),tu.setAttribute("type","text/css"),document.head.appendChild(tu)),tu.sheet&&(tu.sheet.insertRule(`@media ${n} {body{ }}`,0),o5.add(n))}catch(t){console.error(t)}}(t,this._nonce),this._matchMedia(t)}static{this.\u0275fac=function(i){return new(i||n)(O(ms),O(v_,8))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function ENe(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let CNe=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new fe}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return a5(v0(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=Hb(a5(v0(t)).map(o=>this._registerQuery(o).observable));return s=fh(s.pipe(ii(1)),s.pipe(HD(1),_0(0))),s.pipe(le(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:c,query:l})=>{a.matches=a.matches||c,a.breakpoints[l]=c}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new be(o=>{const a=c=>this._zone.run(()=>o.next(c));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(xc(i),le(({matches:o})=>({query:t,matches:o})),zs(this._destroySubject)),mql:i};return this._queries.set(t,s),s}static{this.\u0275fac=function(i){return new(i||n)(O(bNe),O(ye))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function a5(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}let g1=(()=>{class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function ONe(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const i=function RNe(n){try{return n.frameElement}catch{return null}}(function UNe(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(t));if(i&&(-1===p5(i)||!this.isVisible(i)))return!1;let r=t.nodeName.toLowerCase(),s=p5(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function BNe(n){let e=n.nodeName.toLowerCase(),t="input"===e&&n.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,i){return function VNe(n){return!function NNe(n){return function FNe(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function PNe(n){let e=n.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(n)||function kNe(n){return function LNe(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||f5(n))}(t)&&!this.isDisabled(t)&&(i?.ignoreVisibility||this.isVisible(t))}static{this.\u0275fac=function(i){return new(i||n)(O(ms))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function f5(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let e=n.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function p5(n){if(!f5(n))return null;const e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class g5{get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,t,i,r,s=!1,o){this._element=e,this._checker=t,this._ngZone=i,this._document=r,this._injector=o,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const i=this._getFirstTabbableElement(t);return i?.focus(e),!!i}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=0;i<t.length;i++){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=t.length-1;i>=0;i--){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._injector?q_(e,{injector:this._injector}):setTimeout(e)}}let m5=(()=>{class n{constructor(t,i,r){this._checker=t,this._ngZone=i,this._injector=D(gt),this._document=r}create(t,i=!1){return new g5(t,this._checker,this._ngZone,this._document,i,this._injector)}static{this.\u0275fac=function(i){return new(i||n)(O(g1),O(ye),O(nt))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function _5(n){return 0===n.buttons||0===n.detail}function y5(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const jNe=new k("cdk-input-modality-detector-options"),HNe={ignoreKeys:[18,17,224,91,16]},Dh=E0({passive:!0,capture:!0});let zNe=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new On(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(a=>a===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Oc(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(_5(o)?"keyboard":"mouse"),this._mostRecentTarget=Oc(o))},this._onTouchstart=o=>{y5(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Oc(o))},this._options={...HNe,...s},this.modalityDetected=this._modality.pipe(HD(1)),this.modalityChanged=this.modalityDetected.pipe(hh()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,Dh),r.addEventListener("mousedown",this._onMousedown,Dh),r.addEventListener("touchstart",this._onTouchstart,Dh)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Dh),document.removeEventListener("mousedown",this._onMousedown,Dh),document.removeEventListener("touchstart",this._onTouchstart,Dh))}static{this.\u0275fac=function(i){return new(i||n)(O(ms),O(ye),O(nt),O(jNe,8))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var I0=function(n){return n[n.IMMEDIATE=0]="IMMEDIATE",n[n.EVENTUAL=1]="EVENTUAL",n}(I0||{});const WNe=new k("cdk-focus-monitor-default-options"),D0=E0({passive:!0,capture:!0});let R0=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new fe,this._rootNodeFocusAndBlurListener=a=>{for(let l=Oc(a);l;l=l.parentElement)"focus"===a.type?this._onFocus(a,l):this._onBlur(a,l)},this._document=s,this._detectionMode=o?.detectionMode||I0.IMMEDIATE}monitor(t,i=!1){const r=Mh(t);if(!this._platform.isBrowser||1!==r.nodeType)return ee();const s=function IPe(n){if(function MPe(){if(null==a1){const n=typeof document<"u"?document.head:null;a1=!(!n||!n.createShadowRoot&&!n.attachShadow)}return a1}()){const e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const a={checkChildren:i,subject:new fe,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const i=Mh(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=Mh(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,c])=>this._originChanged(a,i,c)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return this._detectionMode===I0.EVENTUAL||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,this._detectionMode===I0.IMMEDIATE&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=Oc(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,D0),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,D0)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(zs(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,D0),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,D0),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let o=0;o<s.length;o++)if(s[o].contains(i))return!0;return!1}static{this.\u0275fac=function(i){return new(i||n)(O(ye),O(ms),O(zNe),O(nt,8),O(WNe,8))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var nu=function(n){return n[n.NONE=0]="NONE",n[n.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",n[n.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",n}(nu||{});const b5="cdk-high-contrast-black-on-white",w5="cdk-high-contrast-white-on-black",m1="cdk-high-contrast-active";let $Ne=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=D(CNe).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return nu.NONE;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return nu.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return nu.BLACK_ON_WHITE}return nu.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(m1,b5,w5),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();i===nu.BLACK_ON_WHITE?t.add(m1,b5):i===nu.WHITE_ON_BLACK&&t.add(m1,w5)}}static{this.\u0275fac=function(i){return new(i||n)(O(ms),O(nt))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function qNe(n,e){}class O0{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}}let E5=(()=>{class n extends f1{constructor(t,i,r,s,o,a,c,l){super(),this._elementRef=t,this._focusTrapFactory=i,this._config=s,this._interactivityChecker=o,this._ngZone=a,this._overlayRef=c,this._focusMonitor=l,this._platform=D(ms),this._focusTrap=null,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this._ariaLabelledByQueue=[],this._changeDetectorRef=D(br),this._injector=D(gt),this._isDestroyed=!1,this.attachDomPortal=u=>{this._portalOutlet.hasAttached();const d=this._portalOutlet.attachDomPortal(u);return this._contentAttached(),d},this._document=r,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(t){this._ariaLabelledByQueue.push(t),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(t){const i=this._ariaLabelledByQueue.indexOf(t);i>-1&&(this._ariaLabelledByQueue.splice(i,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._isDestroyed=!0,this._restoreFocus()}attachComponentPortal(t){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachComponentPortal(t);return this._contentAttached(),i}attachTemplatePortal(t){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachTemplatePortal(t);return this._contentAttached(),i}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(t,i){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(i)}_focusByCssSelector(t,i){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,i)}_trapFocus(){this._isDestroyed||q_(()=>{const t=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||t.focus();break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElement()||this._focusDialogContainer();break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}},{injector:this._injector})}_restoreFocus(){const t=this._config.restoreFocus;let i=null;if("string"==typeof t?i=this._document.querySelector(t):"boolean"==typeof t?i=t?this._elementFocusedBeforeDialogWasOpened:null:t&&(i=t),this._config.restoreFocus&&i&&"function"==typeof i.focus){const r=c1(),s=this._elementRef.nativeElement;(!r||r===this._document.body||r===s||s.contains(r))&&(this._focusMonitor?(this._focusMonitor.focusVia(i,this._closeInteractionType),this._closeInteractionType=null):i.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const t=this._elementRef.nativeElement,i=c1();return t===i||t.contains(i)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=c1()))}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}static{this.\u0275fac=function(i){return new(i||n)(R(At),R(m5),R(nt,8),R(O0),R(g1),R(ye),R(S0),R(R0))}}static{this.\u0275cmp=Yt({type:n,selectors:[["cdk-dialog-container"]],viewQuery:function(i,r){if(1&i&&ea(T0,7),2&i){let s;Ns(s=ks())&&(r._portalOutlet=s.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(i,r){2&i&&kn("id",r._config.id||null)("role",r._config.role)("aria-modal",r._config.ariaModal)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledByQueue[0])("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null)},standalone:!0,features:[st,Bi],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(i,r){1&i&&er(0,qNe,0,0,"ng-template",0)},dependencies:[T0],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2})}}return n})();class _1{constructor(e,t){this.overlayRef=e,this.config=t,this.closed=new fe,this.disableClose=t.disableClose,this.backdropClick=e.backdropClick(),this.keydownEvents=e.keydownEvents(),this.outsidePointerEvents=e.outsidePointerEvents(),this.id=t.id,this.keydownEvents.subscribe(i=>{27===i.keyCode&&!this.disableClose&&!M0(i)&&(i.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=e.detachments().subscribe(()=>{!1!==t.closeOnOverlayDetachments&&this.close()})}close(e,t){if(this.containerInstance){const i=this.closed;this.containerInstance._closeInteractionType=t?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),i.next(e),i.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(e="",t=""){return this.overlayRef.updateSize({width:e,height:t}),this}addPanelClass(e){return this.overlayRef.addPanelClass(e),this}removePanelClass(e){return this.overlayRef.removePanelClass(e),this}}const C5=new k("DialogScrollStrategy",{providedIn:"root",factory:()=>{const n=D(Pc);return()=>n.scrollStrategies.block()}}),XNe=new k("DialogData"),YNe=new k("DefaultDialogConfig");let KNe=0,JNe=(()=>{class n{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(t,i,r,s,o,a){this._overlay=t,this._injector=i,this._defaultOptions=r,this._parentDialog=s,this._overlayContainer=o,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new fe,this._afterOpenedAtThisLevel=new fe,this._ariaHiddenElements=new Map,this.afterAllClosed=zb(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(xc(void 0))),this._scrollStrategy=a}open(t,i){(i={...this._defaultOptions||new O0,...i}).id=i.id||"cdk-dialog-"+KNe++,i.id&&this.getDialogById(i.id);const s=this._getOverlayConfig(i),o=this._overlay.create(s),a=new _1(o,i),c=this._attachContainer(o,a,i);return a.containerInstance=c,this._attachDialogContent(t,a,c,i),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(a),a.closed.subscribe(()=>this._removeOpenDialog(a,!0)),this.afterOpened.next(a),a}closeAll(){y1(this.openDialogs,t=>t.close())}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){y1(this._openDialogsAtThisLevel,t=>{!1===t.config.closeOnDestroy&&this._removeOpenDialog(t,!1)}),y1(this._openDialogsAtThisLevel,t=>t.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(t){const i=new Z6({positionStrategy:t.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,width:t.width,height:t.height,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(i.backdropClass=t.backdropClass),i}_attachContainer(t,i,r){const s=r.injector||r.viewContainerRef?.injector,o=[{provide:O0,useValue:r},{provide:_1,useValue:i},{provide:S0,useValue:t}];let a;r.container?"function"==typeof r.container?a=r.container:(a=r.container.type,o.push(...r.container.providers(r))):a=E5;const c=new d1(a,r.viewContainerRef,gt.create({parent:s||this._injector,providers:o}),r.componentFactoryResolver);return t.attach(c).instance}_attachDialogContent(t,i,r,s){if(t instanceof Ds){const o=this._createInjector(s,i,r,void 0);let a={$implicit:s.data,dialogRef:i};s.templateContext&&(a={...a,..."function"==typeof s.templateContext?s.templateContext():s.templateContext}),r.attachTemplatePortal(new h1(t,null,a,o))}else{const o=this._createInjector(s,i,r,this._injector),a=r.attachComponentPortal(new d1(t,s.viewContainerRef,o,s.componentFactoryResolver));i.componentRef=a,i.componentInstance=a.instance}}_createInjector(t,i,r,s){const o=t.injector||t.viewContainerRef?.injector,a=[{provide:XNe,useValue:t.data},{provide:_1,useValue:i}];return t.providers&&("function"==typeof t.providers?a.push(...t.providers(i,t,r)):a.push(...t.providers)),t.direction&&(!o||!o.get(A0,null,{optional:!0}))&&a.push({provide:A0,useValue:{value:t.direction,change:ee()}}),gt.create({parent:o||s,providers:a})}_removeOpenDialog(t,i){const r=this.openDialogs.indexOf(t);r>-1&&(this.openDialogs.splice(r,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((s,o)=>{s?o.setAttribute("aria-hidden",s):o.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),i&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const i=t.parentElement.children;for(let r=i.length-1;r>-1;r--){const s=i[r];s!==t&&"SCRIPT"!==s.nodeName&&"STYLE"!==s.nodeName&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}static{this.\u0275fac=function(i){return new(i||n)(O(Pc),O(gt),O(YNe,8),O(n,12),O(x0),O(C5))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function y1(n,e){let t=n.length;for(;t--;)e(n[t])}var xr=function(n){return n[n.State=0]="State",n[n.Transition=1]="Transition",n[n.Sequence=2]="Sequence",n[n.Group=3]="Group",n[n.Animate=4]="Animate",n[n.Keyframes=5]="Keyframes",n[n.Style=6]="Style",n[n.Trigger=7]="Trigger",n[n.Reference=8]="Reference",n[n.AnimateChild=9]="AnimateChild",n[n.AnimateRef=10]="AnimateRef",n[n.Query=11]="Query",n[n.Stagger=12]="Stagger",n}(xr||{});function v1(n,e){return{type:xr.Trigger,name:n,definitions:e,options:{}}}function P0(n,e=null){return{type:xr.Animate,styles:e,timings:n}}function Nc(n){return{type:xr.Style,styles:n,offset:null}}function Rh(n,e,t){return{type:xr.State,name:n,styles:e,options:t}}function N0(n,e,t=null){return{type:xr.Transition,expr:n,animation:e,options:t}}function ike(n,e){}class b1{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}const w1="mdc-dialog--open",S5="mdc-dialog--opening",M5="mdc-dialog--closing";let I5=(()=>{class n extends E5{constructor(t,i,r,s,o,a,c,l,u){super(t,i,r,s,o,a,c,u),this._animationMode=l,this._animationStateChanged=new Ae,this._animationsEnabled="NoopAnimations"!==this._animationMode,this._actionSectionCount=0,this._hostElement=this._elementRef.nativeElement,this._enterAnimationDuration=this._animationsEnabled?R5(this._config.enterAnimationDuration)??150:0,this._exitAnimationDuration=this._animationsEnabled?R5(this._config.exitAnimationDuration)??75:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(D5,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(S5,w1)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(w1),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(w1),this._animationsEnabled?(this._hostElement.style.setProperty(D5,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(M5)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(t){this._actionSectionCount+=t,this._changeDetectorRef.markForCheck()}_clearAnimationClasses(){this._hostElement.classList.remove(S5,M5)}_waitForAnimationToComplete(t,i){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(i,t)}_requestAnimationFrame(t){this._ngZone.runOutsideAngular(()=>{"function"==typeof requestAnimationFrame?requestAnimationFrame(t):t()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(t){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:t})}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}attachComponentPortal(t){const i=super.attachComponentPortal(t);return i.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),i}static{this.\u0275fac=function(i){return new(i||n)(R(At),R(m5),R(nt,8),R(b1),R(g1),R(ye),R(S0),R(il,8),R(R0))}}static{this.\u0275cmp=Yt({type:n,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(i,r){2&i&&(ep("id",r._config.id),kn("aria-modal",r._config.ariaModal)("role",r._config.role)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledByQueue[0])("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null),Sn("_mat-animation-noopable",!r._animationsEnabled)("mat-mdc-dialog-container-with-actions",r._actionSectionCount>0))},standalone:!0,features:[st,Bi],decls:3,vars:0,consts:[[1,"mat-mdc-dialog-inner-container","mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(i,r){1&i&&(xe(0,"div",0)(1,"div",1),er(2,ike,0,0,"ng-template",2),Ie()())},dependencies:[T0],styles:['.mat-mdc-dialog-container{width:100%;height:100%;display:block;box-sizing:border-box;max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;outline:0}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 80vw);min-width:var(--mat-dialog-container-min-width, 0)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, 80vw)}}.mat-mdc-dialog-inner-container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;transition:opacity linear var(--mat-dialog-transition-duration, 0ms);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mdc-dialog--closing .mat-mdc-dialog-inner-container{transition:opacity 75ms linear;transform:none}.mdc-dialog--open .mat-mdc-dialog-inner-container{opacity:1}._mat-animation-noopable .mat-mdc-dialog-inner-container{transition:none}.mat-mdc-dialog-surface{display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;width:100%;height:100%;position:relative;overflow-y:auto;outline:0;transform:scale(0.8);transition:transform var(--mat-dialog-transition-duration, 0ms) cubic-bezier(0, 0, 0.2, 1);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;box-shadow:var(--mat-dialog-container-elevation-shadow, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12));border-radius:var(--mdc-dialog-container-shape, var(--mat-app-corner-extra-large, 4px));background-color:var(--mdc-dialog-container-color, var(--mat-app-surface, white))}[dir=rtl] .mat-mdc-dialog-surface{text-align:right}.mdc-dialog--open .mat-mdc-dialog-surface,.mdc-dialog--closing .mat-mdc-dialog-surface{transform:none}._mat-animation-noopable .mat-mdc-dialog-surface{transition:none}.mat-mdc-dialog-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mat-mdc-dialog-title{display:block;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:var(--mat-dialog-headline-padding, 0 24px 9px)}.mat-mdc-dialog-title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mat-mdc-dialog-title{text-align:right}.mat-mdc-dialog-container .mat-mdc-dialog-title{color:var(--mdc-dialog-subhead-color, var(--mat-app-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mdc-dialog-subhead-font, var(--mat-app-headline-small-font, inherit));line-height:var(--mdc-dialog-subhead-line-height, var(--mat-app-headline-small-line-height, 1.5rem));font-size:var(--mdc-dialog-subhead-size, var(--mat-app-headline-small-size, 1rem));font-weight:var(--mdc-dialog-subhead-weight, var(--mat-app-headline-small-weight, 400));letter-spacing:var(--mdc-dialog-subhead-tracking, var(--mat-app-headline-small-tracking, 0.03125em))}.mat-mdc-dialog-content{display:block;flex-grow:1;box-sizing:border-box;margin:0;overflow:auto;max-height:65vh}.mat-mdc-dialog-content>:first-child{margin-top:0}.mat-mdc-dialog-content>:last-child{margin-bottom:0}.mat-mdc-dialog-container .mat-mdc-dialog-content{color:var(--mdc-dialog-supporting-text-color, var(--mat-app-on-surface-variant, rgba(0, 0, 0, 0.6)));font-family:var(--mdc-dialog-supporting-text-font, var(--mat-app-body-medium-font, inherit));line-height:var(--mdc-dialog-supporting-text-line-height, var(--mat-app-body-medium-line-height, 1.5rem));font-size:var(--mdc-dialog-supporting-text-size, var(--mat-app-body-medium-size, 1rem));font-weight:var(--mdc-dialog-supporting-text-weight, var(--mat-app-body-medium-weight, 400));letter-spacing:var(--mdc-dialog-supporting-text-tracking, var(--mat-app-body-medium-tracking, 0.03125em))}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0);padding:var(--mat-dialog-actions-padding, 8px);justify-content:var(--mat-dialog-actions-alignment, start)}.cdk-high-contrast-active .mat-mdc-dialog-actions{border-top-color:CanvasText}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}.mat-mdc-dialog-component-host{display:contents}'],encapsulation:2})}}return n})();const D5="--mat-dialog-transition-duration";function R5(n){return null==n?null:"number"==typeof n?n:n.endsWith("ms")?V6(n.substring(0,n.length-2)):n.endsWith("s")?1e3*V6(n.substring(0,n.length-1)):"0"===n?0:null}var k0=function(n){return n[n.OPEN=0]="OPEN",n[n.CLOSING=1]="CLOSING",n[n.CLOSED=2]="CLOSED",n}(k0||{});class F0{constructor(e,t,i){this._ref=e,this._containerInstance=i,this._afterOpened=new fe,this._beforeClosed=new fe,this._state=k0.OPEN,this.disableClose=t.disableClose,this.id=e.id,e.addPanelClass("mat-mdc-dialog-panel"),i._animationStateChanged.pipe(wt(r=>"opened"===r.state),ii(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),i._animationStateChanged.pipe(wt(r=>"closed"===r.state),ii(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),vl(this.backdropClick(),this.keydownEvents().pipe(wt(r=>27===r.keyCode&&!this.disableClose&&!M0(r)))).subscribe(r=>{this.disableClose||(r.preventDefault(),function O5(n,e,t){return n._closeInteractionType=e,n.close(t)}(this,"keydown"===r.type?"keyboard":"mouse"))})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(wt(t=>"closing"===t.state),ii(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=k0.CLOSING,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(e){let t=this._ref.config.positionStrategy;return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._ref.updatePosition(),this}updateSize(e="",t=""){return this._ref.updateSize(e,t),this}addPanelClass(e){return this._ref.addPanelClass(e),this}removePanelClass(e){return this._ref.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=k0.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const P5=new k("MatMdcDialogData"),oke=new k("mat-mdc-dialog-default-options"),N5=new k("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{const n=D(Pc);return()=>n.scrollStrategies.block()}});let cke=0,L0=(()=>{class n{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(t,i,r,s,o,a,c,l){this._overlay=t,this._defaultOptions=s,this._scrollStrategy=o,this._parentDialog=a,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new fe,this._afterOpenedAtThisLevel=new fe,this.dialogConfigClass=b1,this.afterAllClosed=zb(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(xc(void 0))),this._dialog=i.get(JNe),this._dialogRefConstructor=F0,this._dialogContainerType=I5,this._dialogDataToken=P5}open(t,i){let r;(i={...this._defaultOptions||new b1,...i}).id=i.id||"mat-mdc-dialog-"+cke++,i.scrollStrategy=i.scrollStrategy||this._scrollStrategy();const s=this._dialog.open(t,{...i,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:i},{provide:O0,useValue:i}]},templateContext:()=>({dialogRef:r}),providers:(o,a,c)=>(r=new this._dialogRefConstructor(o,i,c),r.updatePosition(i?.position),[{provide:this._dialogContainerType,useValue:c},{provide:this._dialogDataToken,useValue:a.data},{provide:this._dialogRefConstructor,useValue:r}])});return r.componentRef=s.componentRef,r.componentInstance=s.componentInstance,this.openDialogs.push(r),this.afterOpened.next(r),r.afterClosed().subscribe(()=>{const o=this.openDialogs.indexOf(r);o>-1&&(this.openDialogs.splice(o,1),this.openDialogs.length||this._getAfterAllClosed().next())}),r}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(t){let i=t.length;for(;i--;)t[i].close()}static{this.\u0275fac=function(i){return new(i||n)(O(Pc),O(gt),O(wl,8),O(oke,8),O(N5),O(n,12),O(x0),O(il,8))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),lke=0,k5=(()=>{class n{constructor(t,i,r){this._dialogRef=t,this._elementRef=i,this._dialog=r}ngOnInit(){this._dialogRef||(this._dialogRef=function F5(n,e){let t=n.nativeElement.parentElement;for(;t&&!t.classList.contains("mat-mdc-dialog-container");)t=t.parentElement;return t?e.find(i=>i.id===t.id):null}(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{this._onAdd()})}ngOnDestroy(){this._dialogRef?._containerInstance&&Promise.resolve().then(()=>{this._onRemove()})}static{this.\u0275fac=function(i){return new(i||n)(R(F0,8),R(At),R(L0))}}static{this.\u0275dir=se({type:n,standalone:!0})}}return n})(),E1=(()=>{class n extends k5{constructor(){super(...arguments),this.id="mat-mdc-dialog-title-"+lke++}_onAdd(){this._dialogRef._containerInstance?._addAriaLabelledBy?.(this.id)}_onRemove(){this._dialogRef?._containerInstance?._removeAriaLabelledBy?.(this.id)}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=rn(n)))(r||n)}})()}static{this.\u0275dir=se({type:n,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-mdc-dialog-title","mdc-dialog__title"],hostVars:1,hostBindings:function(i,r){2&i&&ep("id",r.id)},inputs:{id:"id"},exportAs:["matDialogTitle"],standalone:!0,features:[st]})}}return n})(),C1=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=se({type:n,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-mdc-dialog-content","mdc-dialog__content"],standalone:!0,features:[Zk([kPe])]})}}return n})();let B5=(()=>{class n{constructor(t){this.http=t,this.panelContent=new On({content:[],infoTitle:"",videoID:""})}updateData(t,i,r){this.http.get(t,{responseType:"text"}).subscribe(s=>{const o={content:this.parseMarkdown(s),infoTitle:r,videoID:i};this.panelContent.next(o)})}parseMarkdown(t){const i=[],r=t.split("# ");for(const s of r)if(s.length){const o=s.includes("\n\n")?"\n\n":"\r\n\r\n",a=s.split(o);i.push({title:a[0],content:a.splice(1).join(o)})}return i}static{this.\u0275fac=function(i){return new(i||n)(O($s))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const hke=["*"];let B0;function rm(n){return function fke(){if(void 0===B0&&(B0=null,typeof window<"u")){const n=window;void 0!==n.trustedTypes&&(B0=n.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return B0}()?.createHTML(n)||n}function V5(n){return Error(`Unable to find icon with the name "${n}"`)}function U5(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function j5(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class iu{constructor(e,t,i){this.url=e,this.svgText=t,this.options=i}}let V0=(()=>{class n{constructor(t,i,r,s){this._httpClient=t,this._sanitizer=i,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(t,i,r){return this.addSvgIconInNamespace("",t,i,r)}addSvgIconLiteral(t,i,r){return this.addSvgIconLiteralInNamespace("",t,i,r)}addSvgIconInNamespace(t,i,r,s){return this._addSvgIconConfig(t,i,new iu(r,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,i,r,s){const o=this._sanitizer.sanitize(wi.HTML,r);if(!o)throw j5(r);const a=rm(o);return this._addSvgIconConfig(t,i,new iu("",a,s))}addSvgIconSet(t,i){return this.addSvgIconSetInNamespace("",t,i)}addSvgIconSetLiteral(t,i){return this.addSvgIconSetLiteralInNamespace("",t,i)}addSvgIconSetInNamespace(t,i,r){return this._addSvgIconSetConfig(t,new iu(i,null,r))}addSvgIconSetLiteralInNamespace(t,i,r){const s=this._sanitizer.sanitize(wi.HTML,i);if(!s)throw j5(i);const o=rm(s);return this._addSvgIconSetConfig(t,new iu("",o,r))}registerFontClassAlias(t,i=t){return this._fontCssClassesByAlias.set(t,i),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const i=this._sanitizer.sanitize(wi.RESOURCE_URL,t);if(!i)throw U5(t);const r=this._cachedIconsByUrl.get(i);return r?ee(U0(r)):this._loadSvgIconFromConfig(new iu(t,null)).pipe(Nt(s=>this._cachedIconsByUrl.set(i,s)),le(s=>U0(s)))}getNamedSvgIcon(t,i=""){const r=H5(i,t);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(i,t),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(i);return o?this._getSvgFromIconSetConfigs(t,o):Ac(V5(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?ee(U0(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(le(i=>U0(i)))}_getSvgFromIconSetConfigs(t,i){const r=this._extractIconWithNameFromAnySet(t,i);return r?ee(r):Sg(i.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(Io(a=>{const l=`Loading icon set URL: ${this._sanitizer.sanitize(wi.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(l)),ee(null)})))).pipe(le(()=>{const o=this._extractIconWithNameFromAnySet(t,i);if(!o)throw V5(t);return o}))}_extractIconWithNameFromAnySet(t,i){for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,t,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(Nt(i=>t.svgText=i),le(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?ee(null):this._fetchIcon(t).pipe(Nt(i=>t.svgText=i))}_extractSvgIconFromSet(t,i,r){const s=t.querySelector(`[id="${i}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,r);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),r);const a=this._svgElementFromString(rm("<svg></svg>"));return a.appendChild(o),this._setSvgAttributes(a,r)}_svgElementFromString(t){const i=this._document.createElement("DIV");i.innerHTML=t;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const i=this._svgElementFromString(rm("<svg></svg>")),r=t.attributes;for(let s=0;s<r.length;s++){const{name:o,value:a}=r[s];"id"!==o&&i.setAttribute(o,a)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&i.appendChild(t.childNodes[s].cloneNode(!0));return i}_setSvgAttributes(t,i){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),i&&i.viewBox&&t.setAttribute("viewBox",i.viewBox),t}_fetchIcon(t){const{url:i,options:r}=t,s=r?.withCredentials??!1;if(!this._httpClient)throw function pke(){return Error("Could not find HttpClient for use with Angular Material icons. Please add provideHttpClient() to your providers.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const o=this._sanitizer.sanitize(wi.RESOURCE_URL,i);if(!o)throw U5(i);const a=this._inProgressUrlFetches.get(o);if(a)return a;const c=this._httpClient.get(o,{responseType:"text",withCredentials:s}).pipe(le(l=>rm(l)),Tc(()=>this._inProgressUrlFetches.delete(o)),fa());return this._inProgressUrlFetches.set(o,c),c}_addSvgIconConfig(t,i,r){return this._svgIconConfigs.set(H5(t,i),r),this}_addSvgIconSetConfig(t,i){const r=this._iconSetConfigs.get(t);return r?r.push(i):this._iconSetConfigs.set(t,[i]),this}_svgElementFromConfig(t){if(!t.svgElement){const i=this._svgElementFromString(t.svgText);this._setSvgAttributes(i,t.options),t.svgElement=i}return t.svgElement}_getIconConfigFromResolvers(t,i){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](i,t);if(s)return mke(s)?new iu(s.url,null,s.options):new iu(s,null)}}static{this.\u0275fac=function(i){return new(i||n)(O($s,8),O(wp),O(nt,8),O(pr))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function U0(n){return n.cloneNode(!0)}function H5(n,e){return n+":"+e}function mke(n){return!(!n.url||!n.options)}const _ke=new k("MAT_ICON_DEFAULT_OPTIONS"),yke=new k("mat-icon-location",{providedIn:"root",factory:function vke(){const n=D(nt),e=n?n.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),z5=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],bke=z5.map(n=>`[${n}]`).join(", "),wke=/^url\(['"]?#(.*?)['"]?\)$/;let G5=(()=>{class n{get color(){return this._color||this._defaultColor}set color(t){this._color=t}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const i=this._cleanupFontValue(t);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const i=this._cleanupFontValue(t);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}constructor(t,i,r,s,o,a){this._elementRef=t,this._iconRegistry=i,this._location=s,this._errorHandler=o,this.inline=!1,this._previousFontSetClass=[],this._currentIconFetch=kt.EMPTY,a&&(a.color&&(this.color=this._defaultColor=a.color),a.fontSet&&(this.fontSet=a.fontSet)),r||t.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];const i=t.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let i=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=t.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),i.forEach(r=>t.classList.add(r)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const i=this._elementsWithExternalReferences;i&&i.forEach((r,s)=>{r.forEach(o=>{s.setAttribute(o.name,`url('${t}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(t){const i=t.querySelectorAll(bke),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<i.length;s++)z5.forEach(o=>{const a=i[s],c=a.getAttribute(o),l=c?c.match(wke):null;if(l){let u=r.get(a);u||(u=[],r.set(a,u)),u.push({name:o,value:l[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[i,r]=this._splitIconName(t);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(ii(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${s.message}`))})}}static{this.\u0275fac=function(i){return new(i||n)(R(At),R(V0),ja("aria-hidden"),R(yke),R(pr),R(_ke,8))}}static{this.\u0275cmp=Yt({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(i,r){2&i&&(kn("data-mat-icon-type",r._usingFontIcon()?"font":"svg")("data-mat-icon-name",r._svgName||r.fontIcon)("data-mat-icon-namespace",r._svgNamespace||r.fontSet)("fontIcon",r._usingFontIcon()?r.fontIcon:null),_d(r.color?"mat-"+r.color:""),Sn("mat-icon-inline",r.inline)("mat-icon-no-color","primary"!==r.color&&"accent"!==r.color&&"warn"!==r.color))},inputs:{color:"color",inline:[2,"inline","inline",Fn],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],standalone:!0,features:[Xa,Bi],ngContentSelectors:hke,decls:1,vars:0,template:function(i,r){1&i&&(co(),ci(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}}return n})(),W5=(()=>{class n{constructor(){this._listeners=[]}notify(t,i){for(let r of this._listeners)r(t,i)}listen(t){return this._listeners.push(t),()=>{this._listeners=this._listeners.filter(i=>t!==i)}}ngOnDestroy(){this._listeners=[]}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const $5=new k("CdkAccordion");let Cke=0,Ake=(()=>{class n{get expanded(){return this._expanded}set expanded(t){this._expanded!==t&&(this._expanded=t,this.expandedChange.emit(t),t?(this.opened.emit(),this._expansionDispatcher.notify(this.id,this.accordion?this.accordion.id:this.id)):this.closed.emit(),this._changeDetectorRef.markForCheck())}constructor(t,i,r){this.accordion=t,this._changeDetectorRef=i,this._expansionDispatcher=r,this._openCloseAllSubscription=kt.EMPTY,this.closed=new Ae,this.opened=new Ae,this.destroyed=new Ae,this.expandedChange=new Ae,this.id="cdk-accordion-child-"+Cke++,this._expanded=!1,this.disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=r.listen((s,o)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===o&&this.id!==s&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(t=>{this.disabled||(this.expanded=t)})}static{this.\u0275fac=function(i){return new(i||n)(R($5,12),R(br),R(W5))}}static{this.\u0275dir=se({type:n,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:[2,"expanded","expanded",Fn],disabled:[2,"disabled","disabled",Fn]},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],standalone:!0,features:[Vt([{provide:$5,useValue:void 0}]),Xa]})}}return n})();const Tke=["body"],xke=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],Ske=["mat-expansion-panel-header","*","mat-action-row"];function Mke(n,e){}const Ike=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],Dke=["mat-panel-title","mat-panel-description","*"];function Rke(n,e){1&n&&(xe(0,"span",1),o_(),xe(1,"svg",2),Ei(2,"path",3),Ie()()),2&n&&Tt("@indicatorRotate",Ps()._getExpandedState())}const q5=new k("MAT_ACCORDION"),X5="225ms cubic-bezier(0.4,0.0,0.2,1)",Y5={indicatorRotate:v1("indicatorRotate",[Rh("collapsed, void",Nc({transform:"rotate(0deg)"})),Rh("expanded",Nc({transform:"rotate(180deg)"})),N0("expanded <=> collapsed, void => collapsed",P0(X5))]),bodyExpansion:v1("bodyExpansion",[Rh("collapsed, void",Nc({height:"0px",visibility:"hidden"})),Rh("expanded",Nc({height:"*",visibility:""})),N0("expanded <=> collapsed, void => collapsed",P0(X5))])},Z5=new k("MAT_EXPANSION_PANEL");let Oke=(()=>{class n{constructor(t,i){this._template=t,this._expansionPanel=i}static{this.\u0275fac=function(i){return new(i||n)(R(Ds),R(Z5,8))}}static{this.\u0275dir=se({type:n,selectors:[["ng-template","matExpansionPanelContent",""]],standalone:!0})}}return n})(),Pke=0;const K5=new k("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS");let J5=(()=>{class n extends Ake{get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(t){this._hideToggle=t}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(t){this._togglePosition=t}constructor(t,i,r,s,o,a,c){super(t,i,r),this._viewContainerRef=s,this._animationMode=a,this._hideToggle=!1,this.afterExpand=new Ae,this.afterCollapse=new Ae,this._inputChanges=new fe,this._headerId="mat-expansion-panel-header-"+Pke++,this.accordion=t,this._document=o,this._animationsDisabled="NoopAnimations"===a,c&&(this.hideToggle=c.hideToggle)}_hasSpacing(){return!!this.accordion&&this.expanded&&"default"===this.accordion.displayMode}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this._lazyContent._expansionPanel===this&&this.opened.pipe(xc(null),wt(()=>this.expanded&&!this._portal),ii(1)).subscribe(()=>{this._portal=new h1(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(t){this._inputChanges.next(t)}ngOnDestroy(){super.ngOnDestroy(),this._inputChanges.complete()}_containsFocus(){if(this._body){const t=this._document.activeElement,i=this._body.nativeElement;return t===i||i.contains(t)}return!1}_animationStarted(t){!Q5(t)&&!this._animationsDisabled&&this._body&&this._body?.nativeElement.setAttribute("inert","")}_animationDone(t){Q5(t)||("expanded"===t.toState?this.afterExpand.emit():"collapsed"===t.toState&&this.afterCollapse.emit(),!this._animationsDisabled&&this._body&&this._body.nativeElement.removeAttribute("inert"))}static{this.\u0275fac=function(i){return new(i||n)(R(q5,12),R(br),R(W5),R(Qi),R(nt),R(il,8),R(K5,8))}}static{this.\u0275cmp=Yt({type:n,selectors:[["mat-expansion-panel"]],contentQueries:function(i,r,s){if(1&i&&bA(s,Oke,5),2&i){let o;Ns(o=ks())&&(r._lazyContent=o.first)}},viewQuery:function(i,r){if(1&i&&ea(Tke,5),2&i){let s;Ns(s=ks())&&(r._body=s.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(i,r){2&i&&Sn("mat-expanded",r.expanded)("_mat-animation-noopable",r._animationsDisabled)("mat-expansion-panel-spacing",r._hasSpacing())},inputs:{hideToggle:[2,"hideToggle","hideToggle",Fn],togglePosition:"togglePosition"},outputs:{afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],standalone:!0,features:[Vt([{provide:q5,useValue:void 0},{provide:Z5,useExisting:n}]),Xa,st,Kn,Bi],ngContentSelectors:Ske,decls:7,vars:4,consts:[["body",""],["role","region",1,"mat-expansion-panel-content",3,"id"],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(i,r){if(1&i){const s=ao();co(xke),ci(0),xe(1,"div",1,0),mt("@bodyExpansion.start",function(a){return En(s),Cn(r._animationStarted(a))})("@bodyExpansion.done",function(a){return En(s),Cn(r._animationDone(a))}),xe(3,"div",2),ci(4,1),er(5,Mke,0,0,"ng-template",3),Ie(),ci(6,2),Ie()}2&i&&(Xe(),Tt("@bodyExpansion",r._getExpandedState())("id",r.id),kn("aria-labelledby",r._headerId),Xe(4),Tt("cdkPortalOutlet",r._portal))},dependencies:[T0],styles:['.mat-expansion-panel{box-sizing:content-box;display:block;margin:0;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative;background:var(--mat-expansion-container-background-color, var(--mat-app-surface));color:var(--mat-expansion-container-text-color, var(--mat-app-on-surface));border-radius:var(--mat-expansion-container-shape)}.mat-expansion-panel:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:var(--mat-expansion-container-shape);border-top-left-radius:var(--mat-expansion-container-shape)}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:var(--mat-expansion-container-shape);border-bottom-left-radius:var(--mat-expansion-container-shape)}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible;font-family:var(--mat-expansion-container-text-font, var(--mat-app-body-large-font));font-size:var(--mat-expansion-container-text-size, var(--mat-app-body-large-size));font-weight:var(--mat-expansion-container-text-weight, var(--mat-app-body-large-weight));line-height:var(--mat-expansion-container-text-line-height, var(--mat-app-body-large-line-height));letter-spacing:var(--mat-expansion-container-text-tracking, var(--mat-app-body-large-tracking))}.mat-expansion-panel-content[style*="visibility: hidden"] *{visibility:hidden !important}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px;border-top-color:var(--mat-expansion-actions-divider-color, var(--mat-app-outline))}.mat-action-row .mat-button-base,.mat-action-row .mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row .mat-button-base,[dir=rtl] .mat-action-row .mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2,data:{animation:[Y5.bodyExpansion]},changeDetection:0})}}return n})();function Q5(n){return"void"===n.fromState}let Nke=(()=>{class n{constructor(t,i,r,s,o,a,c){this.panel=t,this._element=i,this._focusMonitor=r,this._changeDetectorRef=s,this._animationMode=a,this._parentChangeSubscription=kt.EMPTY,this.tabIndex=0;const l=t.accordion?t.accordion._stateChanges.pipe(wt(u=>!(!u.hideToggle&&!u.togglePosition))):Br;this.tabIndex=parseInt(c||"")||0,this._parentChangeSubscription=vl(t.opened,t.closed,l,t._inputChanges.pipe(wt(u=>!!(u.hideToggle||u.disabled||u.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),t.closed.pipe(wt(()=>t._containsFocus())).subscribe(()=>r.focusVia(i,"program")),o&&(this.expandedHeight=o.expandedHeight,this.collapsedHeight=o.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){const t=this._isExpanded();return t&&this.expandedHeight?this.expandedHeight:!t&&this.collapsedHeight?this.collapsedHeight:null}_keydown(t){switch(t.keyCode){case 32:case 13:M0(t)||(t.preventDefault(),this._toggle());break;default:return void(this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(t))}}focus(t,i){t?this._focusMonitor.focusVia(this._element,t,i):this._element.nativeElement.focus(i)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(t=>{t&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}static{this.\u0275fac=function(i){return new(i||n)(R(J5,1),R(At),R(R0),R(br),R(K5,8),R(il,8),ja("tabindex"))}}static{this.\u0275cmp=Yt({type:n,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(i,r){1&i&&mt("click",function(){return r._toggle()})("keydown",function(o){return r._keydown(o)}),2&i&&(kn("id",r.panel._headerId)("tabindex",r.disabled?-1:r.tabIndex)("aria-controls",r._getPanelId())("aria-expanded",r._isExpanded())("aria-disabled",r.panel.disabled),Jf("height",r._getHeaderHeight()),Sn("mat-expanded",r._isExpanded())("mat-expansion-toggle-indicator-after","after"===r._getTogglePosition())("mat-expansion-toggle-indicator-before","before"===r._getTogglePosition())("_mat-animation-noopable","NoopAnimations"===r._animationMode))},inputs:{expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight",tabIndex:[2,"tabIndex","tabIndex",t=>null==t?0:gp(t)]},standalone:!0,features:[Xa,Bi],ngContentSelectors:Dke,decls:5,vars:3,consts:[[1,"mat-content"],[1,"mat-expansion-indicator"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-hidden","true","focusable","false"],["d","M480-345 240-585l56-56 184 184 184-184 56 56-240 240Z"]],template:function(i,r){1&i&&(co(Ike),xe(0,"span",0),ci(1),ci(2,1),ci(3,2),Ie(),er(4,Rke,3,1,"span",1)),2&i&&(Sn("mat-content-hide-toggle",!r._showToggle()),Xe(4),cy(r._showToggle()?4:-1))},styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-expansion-header-collapsed-state-height);font-family:var(--mat-expansion-header-text-font, var(--mat-app-title-medium-font));font-size:var(--mat-expansion-header-text-size, var(--mat-app-title-medium-size));font-weight:var(--mat-expansion-header-text-weight, var(--mat-app-title-medium-weight));line-height:var(--mat-expansion-header-text-line-height, var(--mat-app-title-medium-line-height));letter-spacing:var(--mat-expansion-header-text-tracking, var(--mat-app-title-medium-tracking))}.mat-expansion-panel-header.mat-expanded{height:var(--mat-expansion-header-expanded-state-height)}.mat-expansion-panel-header[aria-disabled=true]{color:var(--mat-expansion-header-disabled-state-text-color)}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-header-hover-state-layer-color)}@media(hover: none){.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-container-background-color, var(--mat-app-surface))}}.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-keyboard-focused,.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-program-focused{background:var(--mat-expansion-header-focus-state-layer-color)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-content.mat-content-hide-toggle{margin-right:8px}[dir=rtl] .mat-content.mat-content-hide-toggle{margin-right:0;margin-left:8px}.mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-left:24px;margin-right:0}[dir=rtl] .mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-right:24px;margin-left:0}.mat-expansion-panel-header-title{color:var(--mat-expansion-header-text-color, var(--mat-app-on-surface))}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;flex-basis:0;margin-right:16px;align-items:center}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-title,.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-description{color:inherit}.mat-expansion-panel-header-description{flex-grow:2;color:var(--mat-expansion-header-description-color, var(--mat-app-on-surface-variant))}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle;color:var(--mat-expansion-header-indicator-color, var(--mat-app-on-surface-variant));display:var(--mat-expansion-legacy-header-indicator-display, inline-block)}.mat-expansion-indicator svg{width:24px;height:24px;margin:0 -8px;vertical-align:middle;fill:var(--mat-expansion-header-indicator-color, var(--mat-app-on-surface-variant));display:var(--mat-expansion-header-indicator-display, none)}.cdk-high-contrast-active .mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}'],encapsulation:2,data:{animation:[Y5.indicatorRotate]},changeDetection:0})}}return n})();function eW(n,e,t){return t?eW(n,e).pipe(Pb(t)):new be(i=>{const r=(...o)=>i.next(1===o.length?o[0]:o),s=n(r);return $e(e)?()=>e(r,s):void 0})}const kke=["youtubeContainer"];function Fke(n,e){if(1&n){const t=ao();xe(0,"youtube-player-placeholder",2),mt("click",function(){return En(t),Cn(Ps()._load(!0))}),Ie()}if(2&n){const t=Ps();Tt("videoId",t.videoId)("width",t.width)("height",t.height)("isLoading",t._isLoading)("buttonLabel",t.placeholderButtonLabel)("quality",t.placeholderImageQuality)}}let Lke=(()=>{class n{_getBackgroundImage(){let t;return t="low"===this.quality?`https://i.ytimg.com/vi/${this.videoId}/hqdefault.jpg`:"high"===this.quality?`https://i.ytimg.com/vi/${this.videoId}/maxresdefault.jpg`:`https://i.ytimg.com/vi_webp/${this.videoId}/sddefault.webp`,`url(${t})`}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Yt({type:n,selectors:[["youtube-player-placeholder"]],hostAttrs:[1,"youtube-player-placeholder"],hostVars:8,hostBindings:function(i,r){2&i&&(Jf("background-image",r._getBackgroundImage())("width",r.width,"px")("height",r.height,"px"),Sn("youtube-player-placeholder-loading",r.isLoading))},inputs:{videoId:"videoId",width:"width",height:"height",isLoading:"isLoading",buttonLabel:"buttonLabel",quality:"quality"},standalone:!0,features:[Bi],decls:4,vars:1,consts:[["type","button",1,"youtube-player-placeholder-button"],["height","100%","version","1.1","viewBox","0 0 68 48","focusable","false","aria-hidden","true"],["d","M66.52,7.74c-0.78-2.93-2.49-5.41-5.42-6.19C55.79,.13,34,0,34,0S12.21,.13,6.9,1.55 C3.97,2.33,2.27,4.81,1.48,7.74C0.06,13.05,0,24,0,24s0.06,10.95,1.48,16.26c0.78,2.93,2.49,5.41,5.42,6.19 C12.21,47.87,34,48,34,48s21.79-0.13,27.1-1.55c2.93-0.78,4.64-3.26,5.42-6.19C67.94,34.95,68,24,68,24S67.94,13.05,66.52,7.74z","fill","#f00"],["d","M 45,24 27,14 27,34","fill","#fff"]],template:function(i,r){1&i&&(xe(0,"button",0),o_(),xe(1,"svg",1),Ei(2,"path",2)(3,"path",3),Ie()()),2&i&&kn("aria-label",r.buttonLabel)},styles:[".youtube-player-placeholder{display:flex;align-items:center;justify-content:center;width:100%;overflow:hidden;cursor:pointer;background-color:#000;background-position:center center;background-size:cover;transition:box-shadow 300ms ease;box-shadow:inset 0 120px 90px -90px rgba(0,0,0,.8)}.youtube-player-placeholder-button{transition:opacity 300ms ease;-moz-appearance:none;-webkit-appearance:none;background:none;border:none;padding:0;display:flex}.youtube-player-placeholder-button svg{width:68px;height:48px}.youtube-player-placeholder-loading{box-shadow:none}.youtube-player-placeholder-loading .youtube-player-placeholder-button{opacity:0}"],encapsulation:2,changeDetection:0})}}return n})();const Bke=new k("YOUTUBE_PLAYER_CONFIG");function iW(n){return null==n?n:gp(n,0)}var No=function(n){return n[n.UNSTARTED=-1]="UNSTARTED",n[n.ENDED=0]="ENDED",n[n.PLAYING=1]="PLAYING",n[n.PAUSED=2]="PAUSED",n[n.BUFFERING=3]="BUFFERING",n[n.CUED=5]="CUED",n}(No||{});let Vke=(()=>{class n{get height(){return this._height}set height(t){this._height=null==t||isNaN(t)?390:t}get width(){return this._width}set width(t){this._width=null==t||isNaN(t)?640:t}constructor(t,i){this._ngZone=t,this._destroyed=new fe,this._playerChanges=new On(void 0),this._nonce=D(v_,{optional:!0}),this._changeDetectorRef=D(br),this._isLoading=!1,this._hasPlaceholder=!0,this._height=390,this._width=640,this.disableCookies=!1,this.disablePlaceholder=!1,this.showBeforeIframeApiLoads=!1,this.ready=this._getLazyEmitter("onReady"),this.stateChange=this._getLazyEmitter("onStateChange"),this.error=this._getLazyEmitter("onError"),this.apiChange=this._getLazyEmitter("onApiChange"),this.playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange"),this.playbackRateChange=this._getLazyEmitter("onPlaybackRateChange");const r=D(Bke,{optional:!0});this.loadApi=r?.loadApi??!0,this.disablePlaceholder=!!r?.disablePlaceholder,this.placeholderButtonLabel=r?.placeholderButtonLabel||"Play video",this.placeholderImageQuality=r?.placeholderImageQuality||"standard",this._isBrowser=rc(i)}ngAfterViewInit(){this._conditionallyLoad()}ngOnChanges(t){this._shouldRecreatePlayer(t)?this._conditionallyLoad():this._player&&((t.width||t.height)&&this._setSize(),t.suggestedQuality&&this._setQuality(),(t.startSeconds||t.endSeconds||t.suggestedQuality)&&this._cuePlayer())}ngOnDestroy(){this._pendingPlayer?.destroy(),this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():(this._getPendingState().playbackState=No.PLAYING,this._load(!0))}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=No.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=No.CUED}seekTo(t,i){this._player?this._player.seekTo(t,i):this._getPendingState().seek={seconds:t,allowSeekAhead:i}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(t){this._player?this._player.setVolume(t):this._getPendingState().volume=t}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(t){if(this._player)return this._player.setPlaybackRate(t);this._getPendingState().playbackRate=t}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:No.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}_load(t){this._isBrowser&&(window.YT&&window.YT.Player?this._createPlayer(t):(this.loadApi&&(this._isLoading=!0,function Uke(n){if(A1)return;const t=document.createElement("script"),i=r=>{t.removeEventListener("load",i),t.removeEventListener("error",i),"error"===r.type&&(A1=!1)};t.addEventListener("load",i),t.addEventListener("error",i),t.src="https://www.youtube.com/iframe_api",t.async=!0,n&&t.setAttribute("nonce",n),A1=!0,document.body.appendChild(t)}(this._nonce)),this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback?.(),this._ngZone.run(()=>this._createPlayer(t))}))}_conditionallyLoad(){this._shouldShowPlaceholder()?1===this.playerVars?.autoplay&&this._load(!0):this._load(!1)}_shouldShowPlaceholder(){return!this.disablePlaceholder&&(!this._isBrowser||this._hasPlaceholder&&!!this.videoId&&!this._player)}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_shouldRecreatePlayer(t){const i=t.videoId||t.playerVars||t.disableCookies||t.disablePlaceholder;return!!i&&!i.isFirstChange()}_createPlayer(t){if(this._player?.destroy(),this._pendingPlayer?.destroy(),typeof YT>"u"||!this.videoId&&!this.playerVars?.list)return;const i=this._ngZone.runOutsideAngular(()=>new YT.Player(this.youtubeContainer.nativeElement,{videoId:this.videoId,host:this.disableCookies?"https://www.youtube-nocookie.com":void 0,width:this.width,height:this.height,playerVars:t?{...this.playerVars||{},autoplay:1}:this.playerVars})),r=()=>{this._ngZone.run(()=>{this._isLoading=!1,this._hasPlaceholder=!1,this._player=i,this._pendingPlayer=void 0,i.removeEventListener("onReady",r),this._playerChanges.next(i),this._setSize(),this._setQuality(),this._pendingPlayerState&&(this._applyPendingPlayerState(i,this._pendingPlayerState),this._pendingPlayerState=void 0);const s=i.getPlayerState();(s===No.UNSTARTED||s===No.CUED||null==s)&&this._cuePlayer(),this._changeDetectorRef.markForCheck()})};this._pendingPlayer=i,i.addEventListener("onReady",r)}_applyPendingPlayerState(t,i){const{playbackState:r,playbackRate:s,volume:o,muted:a,seek:c}=i;switch(r){case No.PLAYING:t.playVideo();break;case No.PAUSED:t.pauseVideo();break;case No.CUED:t.stopVideo()}null!=s&&t.setPlaybackRate(s),null!=o&&t.setVolume(o),null!=a&&(a?t.mute():t.unMute()),null!=c&&t.seekTo(c.seconds,c.allowSeekAhead)}_cuePlayer(){this._player&&this.videoId&&this._player.cueVideoById({videoId:this.videoId,startSeconds:this.startSeconds,endSeconds:this.endSeconds,suggestedQuality:this.suggestedQuality})}_setSize(){this._player?.setSize(this.width,this.height)}_setQuality(){this._player&&this.suggestedQuality&&this._player.setPlaybackQuality(this.suggestedQuality)}_getLazyEmitter(t){return this._playerChanges.pipe(pn(i=>i?eW(r=>{i.addEventListener(t,r)},r=>{try{i?.removeEventListener?.(t,r)}catch{}}):ee()),i=>new be(r=>i.subscribe({next:s=>this._ngZone.run(()=>r.next(s)),error:s=>r.error(s),complete:()=>r.complete()})),zs(this._destroyed))}static{this.\u0275fac=function(i){return new(i||n)(R(ye),R(is))}}static{this.\u0275cmp=Yt({type:n,selectors:[["youtube-player"]],viewQuery:function(i,r){if(1&i&&ea(kke,7),2&i){let s;Ns(s=ks())&&(r.youtubeContainer=s.first)}},inputs:{videoId:"videoId",height:[2,"height","height",gp],width:[2,"width","width",gp],startSeconds:[2,"startSeconds","startSeconds",iW],endSeconds:[2,"endSeconds","endSeconds",iW],suggestedQuality:"suggestedQuality",playerVars:"playerVars",disableCookies:[2,"disableCookies","disableCookies",Fn],loadApi:[2,"loadApi","loadApi",Fn],disablePlaceholder:[2,"disablePlaceholder","disablePlaceholder",Fn],showBeforeIframeApiLoads:[2,"showBeforeIframeApiLoads","showBeforeIframeApiLoads",Fn],placeholderButtonLabel:"placeholderButtonLabel",placeholderImageQuality:"placeholderImageQuality"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},standalone:!0,features:[Xa,Kn,Bi],decls:4,vars:3,consts:[["youtubeContainer",""],[3,"videoId","width","height","isLoading","buttonLabel","quality"],[3,"click","videoId","width","height","isLoading","buttonLabel","quality"]],template:function(i,r){1&i&&(er(0,Fke,1,6,"youtube-player-placeholder",1),xe(1,"div"),Ei(2,"div",null,0),Ie()),2&i&&(cy(r._shouldShowPlaceholder()?0:-1),Xe(),Jf("display",r._shouldShowPlaceholder()?"none":""))},dependencies:[Lke],encapsulation:2,changeDetection:0})}}return n})(),A1=!1;let ru={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function rW(n){ru=n}const sW=/[&<>"']/,jke=new RegExp(sW.source,"g"),oW=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,Hke=new RegExp(oW.source,"g"),zke={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},aW=n=>zke[n];function Yr(n,e){if(e){if(sW.test(n))return n.replace(jke,aW)}else if(oW.test(n))return n.replace(Hke,aW);return n}const Gke=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function Wke(n){return n.replace(Gke,(e,t)=>"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):"")}const $ke=/(^|[^\[])\^/g;function Ht(n,e){let t="string"==typeof n?n:n.source;e=e||"";const i={replace:(r,s)=>{let o="string"==typeof s?s:s.source;return o=o.replace($ke,"$1"),t=t.replace(r,o),i},getRegex:()=>new RegExp(t,e)};return i}function cW(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const sm={exec:()=>null};function lW(n,e){const i=n.replace(/\|/g,(s,o,a)=>{let c=!1,l=o;for(;--l>=0&&"\\"===a[l];)c=!c;return c?"|":" |"}).split(/ \|/);let r=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(/\\\|/g,"|");return i}function j0(n,e,t){const i=n.length;if(0===i)return"";let r=0;for(;r<i;){const s=n.charAt(i-r-1);if(s!==e||t){if(s===e||!t)break;r++}else r++}return n.slice(0,i-r)}function uW(n,e,t,i){const r=e.href,s=e.title?Yr(e.title):null,o=n[1].replace(/\\([\[\]])/g,"$1");if("!"!==n[0].charAt(0)){i.state.inLink=!0;const a={type:"link",raw:t,href:r,title:s,text:o,tokens:i.inlineTokens(o)};return i.state.inLink=!1,a}return{type:"image",raw:t,href:r,title:s,text:Yr(o)}}class H0{options;rules;lexer;constructor(e){this.options=e||ru}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:j0(i,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],r=function Xke(n,e){const t=n.match(/^(\s+)(?:```)/);if(null===t)return e;const i=t[1];return e.split("\n").map(r=>{const s=r.match(/^\s+/);if(null===s)return r;const[o]=s;return o.length>=i.length?r.slice(i.length):r}).join("\n")}(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const r=j0(i,"#");(this.options.pedantic||!r||/ $/.test(r))&&(i=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let i=t[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,"\n    $1");i=j0(i.replace(/^ *>[ \t]?/gm,""),"\n");const r=this.lexer.state.top;this.lexer.state.top=!0;const s=this.lexer.blockTokens(i);return this.lexer.state.top=r,{type:"blockquote",raw:t[0],tokens:s,text:i}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i=t[1].trim();const r=i.length>1,s={type:"list",raw:"",ordered:r,start:r?+i.slice(0,-1):"",loose:!1,items:[]};i=r?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=r?i:"[*+-]");const o=new RegExp(`^( {0,3}${i})((?:[\t ][^\\n]*)?(?:\\n|$))`);let a="",c="",l=!1;for(;e;){let u=!1;if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;a=t[0],e=e.substring(a.length);let d=t[2].split("\n",1)[0].replace(/^\t+/,y=>" ".repeat(3*y.length)),h=e.split("\n",1)[0],f=0;this.options.pedantic?(f=2,c=d.trimStart()):(f=t[2].search(/[^ ]/),f=f>4?1:f,c=d.slice(f),f+=t[1].length);let p=!1;if(!d&&/^ *$/.test(h)&&(a+=h+"\n",e=e.substring(h.length+1),u=!0),!u){const y=new RegExp(`^ {0,${Math.min(3,f-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),v=new RegExp(`^ {0,${Math.min(3,f-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),_=new RegExp(`^ {0,${Math.min(3,f-1)}}(?:\`\`\`|~~~)`),E=new RegExp(`^ {0,${Math.min(3,f-1)}}#`);for(;e;){const A=e.split("\n",1)[0];if(h=A,this.options.pedantic&&(h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),_.test(h)||E.test(h)||y.test(h)||v.test(e))break;if(h.search(/[^ ]/)>=f||!h.trim())c+="\n"+h.slice(f);else{if(p||d.search(/[^ ]/)>=4||_.test(d)||E.test(d)||v.test(d))break;c+="\n"+h}!p&&!h.trim()&&(p=!0),a+=A+"\n",e=e.substring(A.length+1),d=h.slice(f)}}s.loose||(l?s.loose=!0:/\n *\n *$/.test(a)&&(l=!0));let m,g=null;this.options.gfm&&(g=/^\[[ xX]\] /.exec(c),g&&(m="[ ] "!==g[0],c=c.replace(/^\[[ xX]\] +/,""))),s.items.push({type:"list_item",raw:a,task:!!g,checked:m,loose:!1,text:c,tokens:[]}),s.raw+=a}s.items[s.items.length-1].raw=a.trimEnd(),s.items[s.items.length-1].text=c.trimEnd(),s.raw=s.raw.trimEnd();for(let u=0;u<s.items.length;u++)if(this.lexer.state.top=!1,s.items[u].tokens=this.lexer.blockTokens(s.items[u].text,[]),!s.loose){const d=s.items[u].tokens.filter(f=>"space"===f.type),h=d.length>0&&d.some(f=>/\n.*\n/.test(f.raw));s.loose=h}if(s.loose)for(let u=0;u<s.items.length;u++)s.items[u].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const i=t[1].toLowerCase().replace(/\s+/g," "),r=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:r,title:s}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const i=lW(t[1]),r=t[2].replace(/^\||\| *$/g,"").split("|"),s=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split("\n"):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(i.length===r.length){for(const a of r)/^ *-+: *$/.test(a)?o.align.push("right"):/^ *:-+: *$/.test(a)?o.align.push("center"):/^ *:-+ *$/.test(a)?o.align.push("left"):o.align.push(null);for(const a of i)o.header.push({text:a,tokens:this.lexer.inline(a)});for(const a of s)o.rows.push(lW(a,o.header.length).map(c=>({text:c,tokens:this.lexer.inline(c)})));return o}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Yr(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const o=j0(i.slice(0,-1),"\\");if((i.length-o.length)%2==0)return}else{const o=function qke(n,e){if(-1===n.indexOf(e[1]))return-1;let t=0;for(let i=0;i<n.length;i++)if("\\"===n[i])i++;else if(n[i]===e[0])t++;else if(n[i]===e[1]&&(t--,t<0))return i;return-1}(t[2],"()");if(o>-1){const c=(0===t[0].indexOf("!")?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,c).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);o&&(r=o[1],s=o[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(r=this.options.pedantic&&!/>$/.test(i)?r.slice(1):r.slice(1,-1)),uW(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){const s=t[(i[2]||i[1]).replace(/\s+/g," ").toLowerCase()];if(!s){const o=i[0].charAt(0);return{type:"text",raw:o,text:o}}return uW(i,s,i[0],this.lexer)}}emStrong(e,t,i=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!(!r||r[3]&&i.match(/[\p{L}\p{N}]/u))&&(!r[1]&&!r[2]||!i||this.rules.inline.punctuation.exec(i))){const o=[...r[0]].length-1;let a,c,l=o,u=0;const d="*"===r[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,t=t.slice(-1*e.length+o);null!=(r=d.exec(t));){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(c=[...a].length,r[3]||r[4]){l+=c;continue}if((r[5]||r[6])&&o%3&&!((o+c)%3)){u+=c;continue}if(l-=c,l>0)continue;c=Math.min(c,c+l+u);const h=[...r[0]][0].length,f=e.slice(0,o+r.index+h+c);if(Math.min(o,c)%2){const g=f.slice(1,-1);return{type:"em",raw:f,text:g,tokens:this.lexer.inlineTokens(g)}}const p=f.slice(2,-2);return{type:"strong",raw:f,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const r=/[^ ]/.test(i),s=/^ /.test(i)&&/ $/.test(i);return r&&s&&(i=i.substring(1,i.length-1)),i=Yr(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let i,r;return"@"===t[2]?(i=Yr(t[1]),r="mailto:"+i):(i=Yr(t[1]),r=i),{type:"link",raw:t[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let i,r;if("@"===t[2])i=Yr(t[0]),r="mailto:"+i;else{let s;do{s=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??""}while(s!==t[0]);i=Yr(t[0]),r="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let i;return i=this.lexer.state.inRawBlock?t[0]:Yr(t[0]),{type:"text",raw:t[0],text:i}}}}const om=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,dW=/(?:[*+-]|\d{1,9}[.)])/,hW=Ht(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,dW).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),x1=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,S1=/(?!\s*\])(?:\\.|[^\[\]\\])+/,eFe=Ht(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",S1).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),tFe=Ht(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,dW).getRegex(),z0="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",M1=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,nFe=Ht("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",M1).replace("tag",z0).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),fW=Ht(x1).replace("hr",om).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",z0).getRegex(),I1={blockquote:Ht(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",fW).getRegex(),code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,def:eFe,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:om,html:nFe,lheading:hW,list:tFe,newline:/^(?: *(?:\n|$))+/,paragraph:fW,table:sm,text:/^[^\n]+/},pW=Ht("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",om).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",z0).getRegex(),iFe={...I1,table:pW,paragraph:Ht(x1).replace("hr",om).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",pW).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",z0).getRegex()},rFe={...I1,html:Ht("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",M1).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:sm,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ht(x1).replace("hr",om).replace("heading"," *#{1,6} *[^\n]").replace("lheading",hW).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},gW=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,mW=/^( {2,}|\\)\n(?!\s*$)/,am="\\p{P}\\p{S}",aFe=Ht(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,am).getRegex(),lFe=Ht(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,am).getRegex(),uFe=Ht("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,am).getRegex(),dFe=Ht("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,am).getRegex(),hFe=Ht(/\\([punct])/,"gu").replace(/punct/g,am).getRegex(),fFe=Ht(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),pFe=Ht(M1).replace("(?:--\x3e|$)","--\x3e").getRegex(),gFe=Ht("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",pFe).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),G0=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,mFe=Ht(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",G0).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),_W=Ht(/^!?\[(label)\]\[(ref)\]/).replace("label",G0).replace("ref",S1).getRegex(),yW=Ht(/^!?\[(ref)\](?:\[\])?/).replace("ref",S1).getRegex(),D1={_backpedal:sm,anyPunctuation:hFe,autolink:fFe,blockSkip:/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,br:mW,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:sm,emStrongLDelim:lFe,emStrongRDelimAst:uFe,emStrongRDelimUnd:dFe,escape:gW,link:mFe,nolink:yW,punctuation:aFe,reflink:_W,reflinkSearch:Ht("reflink|nolink(?!\\()","g").replace("reflink",_W).replace("nolink",yW).getRegex(),tag:gFe,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:sm},yFe={...D1,link:Ht(/^!?\[(label)\]\((.*?)\)/).replace("label",G0).getRegex(),reflink:Ht(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",G0).getRegex()},R1={...D1,escape:Ht(gW).replace("])","~|])").getRegex(),url:Ht(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},vFe={...R1,br:Ht(mW).replace("{2,}","*").getRegex(),text:Ht(R1.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},W0={normal:I1,gfm:iFe,pedantic:rFe},cm={normal:D1,gfm:R1,breaks:vFe,pedantic:yFe};class ko{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||ru,this.options.tokenizer=this.options.tokenizer||new H0,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:W0.normal,inline:cm.normal};this.options.pedantic?(t.block=W0.pedantic,t.inline=cm.pedantic):this.options.gfm&&(t.block=W0.gfm,t.inline=this.options.breaks?cm.breaks:cm.gfm),this.tokenizer.rules=t}static get rules(){return{block:W0,inline:cm}}static lex(e,t){return new ko(t).lex(e)}static lexInline(e,t){return new ko(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,"\n"),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const i=this.inlineQueue[t];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[]){let i,r,s,o;for(e=this.options.pedantic?e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e.replace(/^( *)(\t+)/gm,(a,c,l)=>c+"    ".repeat(l.length));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>!!(i=a.call({lexer:this},e,t))&&(e=e.substring(i.raw.length),t.push(i),!0)))){if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length),1===i.raw.length&&t.length>0?t[t.length-1].raw+="\n":t.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length),r=t[t.length-1],!r||"paragraph"!==r.type&&"text"!==r.type?t.push(i):(r.raw+="\n"+i.raw,r.text+="\n"+i.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length),r=t[t.length-1],!r||"paragraph"!==r.type&&"text"!==r.type?this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title}):(r.raw+="\n"+i.raw,r.text+="\n"+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text);continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const c=e.slice(1);let l;this.options.extensions.startBlock.forEach(u=>{l=u.call({lexer:this},c),"number"==typeof l&&l>=0&&(a=Math.min(a,l))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(i=this.tokenizer.paragraph(s))){r=t[t.length-1],o&&"paragraph"===r.type?(r.raw+="\n"+i.raw,r.text+="\n"+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(i),o=s.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length),r=t[t.length-1],r&&"text"===r.type?(r.raw+="\n"+i.raw,r.text+="\n"+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(i);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let i,r,s,a,c,l,o=e;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;null!=(a=this.tokenizer.rules.inline.reflinkSearch.exec(o));)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(a=this.tokenizer.rules.inline.blockSkip.exec(o));)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(a=this.tokenizer.rules.inline.anyPunctuation.exec(o));)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(c||(l=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>!!(i=u.call({lexer:this},e,t))&&(e=e.substring(i.raw.length),t.push(i),!0)))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),r=t[t.length-1],r&&"text"===i.type&&"text"===r.type?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),r=t[t.length-1],r&&"text"===i.type&&"text"===r.type?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(i=this.tokenizer.emStrong(e,o,l)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.autolink(e)){e=e.substring(i.raw.length),t.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e))){e=e.substring(i.raw.length),t.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const d=e.slice(1);let h;this.options.extensions.startInline.forEach(f=>{h=f.call({lexer:this},d),"number"==typeof h&&h>=0&&(u=Math.min(u,h))}),u<1/0&&u>=0&&(s=e.substring(0,u+1))}if(i=this.tokenizer.inlineText(s)){e=e.substring(i.raw.length),"_"!==i.raw.slice(-1)&&(l=i.raw.slice(-1)),c=!0,r=t[t.length-1],r&&"text"===r.type?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}throw new Error(u)}}return t}}class su{options;constructor(e){this.options=e||ru}code(e,t,i){const r=(t||"").match(/^\S*/)?.[0];return e=e.replace(/\n$/,"")+"\n",r?'<pre><code class="language-'+Yr(r)+'">'+(i?e:Yr(e,!0))+"</code></pre>\n":"<pre><code>"+(i?e:Yr(e,!0))+"</code></pre>\n"}blockquote(e){return`<blockquote>\n${e}</blockquote>\n`}html(e,t){return e}heading(e,t,i){return`<h${t}>${e}</h${t}>\n`}hr(){return"<hr>\n"}list(e,t,i){const r=t?"ol":"ul";return"<"+r+(t&&1!==i?' start="'+i+'"':"")+">\n"+e+"</"+r+">\n"}listitem(e,t,i){return`<li>${e}</li>\n`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>\n`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"}tablerow(e){return`<tr>\n${e}</tr>\n`}tablecell(e,t){const i=t.header?"th":"td";return(t.align?`<${i} align="${t.align}">`:`<${i}>`)+e+`</${i}>\n`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,t,i){const r=cW(e);if(null===r)return i;let s='<a href="'+(e=r)+'"';return t&&(s+=' title="'+t+'"'),s+=">"+i+"</a>",s}image(e,t,i){const r=cW(e);if(null===r)return i;let s=`<img src="${e=r}" alt="${i}"`;return t&&(s+=` title="${t}"`),s+=">",s}text(e){return e}}class O1{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,i){return""+i}image(e,t,i){return""+i}br(){return""}}class Fo{options;renderer;textRenderer;constructor(e){this.options=e||ru,this.options.renderer=this.options.renderer||new su,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new O1}static parse(e,t){return new Fo(t).parse(e)}static parseInline(e,t){return new Fo(t).parseInline(e)}parse(e,t=!0){let i="";for(let r=0;r<e.length;r++){const s=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const o=s,a=this.options.extensions.renderers[o.type].call({parser:this},o);if(!1!==a||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(o.type)){i+=a||"";continue}}switch(s.type){case"space":continue;case"hr":i+=this.renderer.hr();continue;case"heading":{const o=s;i+=this.renderer.heading(this.parseInline(o.tokens),o.depth,Wke(this.parseInline(o.tokens,this.textRenderer)));continue}case"code":i+=this.renderer.code(s.text,s.lang,!!s.escaped);continue;case"table":{const o=s;let a="",c="";for(let u=0;u<o.header.length;u++)c+=this.renderer.tablecell(this.parseInline(o.header[u].tokens),{header:!0,align:o.align[u]});a+=this.renderer.tablerow(c);let l="";for(let u=0;u<o.rows.length;u++){const d=o.rows[u];c="";for(let h=0;h<d.length;h++)c+=this.renderer.tablecell(this.parseInline(d[h].tokens),{header:!1,align:o.align[h]});l+=this.renderer.tablerow(c)}i+=this.renderer.table(a,l);continue}case"blockquote":{const a=this.parse(s.tokens);i+=this.renderer.blockquote(a);continue}case"list":{const o=s,a=o.ordered,c=o.start,l=o.loose;let u="";for(let d=0;d<o.items.length;d++){const h=o.items[d],f=h.checked,p=h.task;let g="";if(h.task){const m=this.renderer.checkbox(!!f);l?h.tokens.length>0&&"paragraph"===h.tokens[0].type?(h.tokens[0].text=m+" "+h.tokens[0].text,h.tokens[0].tokens&&h.tokens[0].tokens.length>0&&"text"===h.tokens[0].tokens[0].type&&(h.tokens[0].tokens[0].text=m+" "+h.tokens[0].tokens[0].text)):h.tokens.unshift({type:"text",text:m+" "}):g+=m+" "}g+=this.parse(h.tokens,l),u+=this.renderer.listitem(g,p,!!f)}i+=this.renderer.list(u,a,c);continue}case"html":i+=this.renderer.html(s.text,s.block);continue;case"paragraph":i+=this.renderer.paragraph(this.parseInline(s.tokens));continue;case"text":{let o=s,a=o.tokens?this.parseInline(o.tokens):o.text;for(;r+1<e.length&&"text"===e[r+1].type;)o=e[++r],a+="\n"+(o.tokens?this.parseInline(o.tokens):o.text);i+=t?this.renderer.paragraph(a):a;continue}default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return i}parseInline(e,t){t=t||this.renderer;let i="";for(let r=0;r<e.length;r++){const s=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const o=this.options.extensions.renderers[s.type].call({parser:this},s);if(!1!==o||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){i+=o||"";continue}}switch(s.type){case"escape":case"text":i+=t.text(s.text);break;case"html":i+=t.html(s.text);break;case"link":i+=t.link(s.href,s.title,this.parseInline(s.tokens,t));break;case"image":i+=t.image(s.href,s.title,s.text);break;case"strong":i+=t.strong(this.parseInline(s.tokens,t));break;case"em":i+=t.em(this.parseInline(s.tokens,t));break;case"codespan":i+=t.codespan(s.text);break;case"br":i+=t.br();break;case"del":i+=t.del(this.parseInline(s.tokens,t));break;default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return i}}class $0{options;constructor(e){this.options=e||ru}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}const ou=new class bFe{defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};options=this.setOptions;parse=this.#e(ko.lex,Fo.parse);parseInline=this.#e(ko.lexInline,Fo.parseInline);Parser=Fo;Renderer=su;TextRenderer=O1;Lexer=ko;Tokenizer=H0;Hooks=$0;constructor(...e){this.use(...e)}walkTokens(e,t){let i=[];for(const r of e)switch(i=i.concat(t.call(this,r)),r.type){case"table":{const s=r;for(const o of s.header)i=i.concat(this.walkTokens(o.tokens,t));for(const o of s.rows)for(const a of o)i=i.concat(this.walkTokens(a.tokens,t));break}case"list":i=i.concat(this.walkTokens(r.items,t));break;default:{const s=r;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(o=>{const a=s[o].flat(1/0);i=i.concat(this.walkTokens(a,t))}):s.tokens&&(i=i.concat(this.walkTokens(s.tokens,t)))}}return i}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(i=>{const r={...i};if(r.async=this.defaults.async||r.async||!1,i.extensions&&(i.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const o=t.renderers[s.name];t.renderers[s.name]=o?function(...a){let c=s.renderer.apply(this,a);return!1===c&&(c=o.apply(this,a)),c}:s.renderer}if("tokenizer"in s){if(!s.level||"block"!==s.level&&"inline"!==s.level)throw new Error("extension level must be 'block' or 'inline'");const o=t[s.level];o?o.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&("block"===s.level?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:"inline"===s.level&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),i.renderer){const s=this.defaults.renderer||new su(this.defaults);for(const o in i.renderer){if(!(o in s))throw new Error(`renderer '${o}' does not exist`);if("options"===o)continue;const c=i.renderer[o],l=s[o];s[o]=(...u)=>{let d=c.apply(s,u);return!1===d&&(d=l.apply(s,u)),d||""}}r.renderer=s}if(i.tokenizer){const s=this.defaults.tokenizer||new H0(this.defaults);for(const o in i.tokenizer){if(!(o in s))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const c=i.tokenizer[o],l=s[o];s[o]=(...u)=>{let d=c.apply(s,u);return!1===d&&(d=l.apply(s,u)),d}}r.tokenizer=s}if(i.hooks){const s=this.defaults.hooks||new $0;for(const o in i.hooks){if(!(o in s))throw new Error(`hook '${o}' does not exist`);if("options"===o)continue;const c=i.hooks[o],l=s[o];s[o]=$0.passThroughHooks.has(o)?u=>{if(this.defaults.async)return Promise.resolve(c.call(s,u)).then(h=>l.call(s,h));const d=c.call(s,u);return l.call(s,d)}:(...u)=>{let d=c.apply(s,u);return!1===d&&(d=l.apply(s,u)),d}}r.hooks=s}if(i.walkTokens){const s=this.defaults.walkTokens,o=i.walkTokens;r.walkTokens=function(a){let c=[];return c.push(o.call(this,a)),s&&(c=c.concat(s.call(this,a))),c}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return ko.lex(e,t??this.defaults)}parser(e,t){return Fo.parse(e,t??this.defaults)}#e(e,t){return(i,r)=>{const s={...r},o={...this.defaults,...s};!0===this.defaults.async&&!1===s.async&&(o.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),o.async=!0);const a=this.#t(!!o.silent,!!o.async);if(typeof i>"u"||null===i)return a(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof i)return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(i):i).then(c=>e(c,o)).then(c=>o.hooks?o.hooks.processAllTokens(c):c).then(c=>o.walkTokens?Promise.all(this.walkTokens(c,o.walkTokens)).then(()=>c):c).then(c=>t(c,o)).then(c=>o.hooks?o.hooks.postprocess(c):c).catch(a);try{o.hooks&&(i=o.hooks.preprocess(i));let c=e(i,o);o.hooks&&(c=o.hooks.processAllTokens(c)),o.walkTokens&&this.walkTokens(c,o.walkTokens);let l=t(c,o);return o.hooks&&(l=o.hooks.postprocess(l)),l}catch(c){return a(c)}}}#t(e,t){return i=>{if(i.message+="\nPlease report this to https://github.com/markedjs/marked.",e){const r="<p>An error occurred:</p><pre>"+Yr(i.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(i);throw i}}};function Et(n,e){return ou.parse(n,e)}Et.options=Et.setOptions=function(n){return ou.setOptions(n),rW(Et.defaults=ou.defaults),Et},Et.getDefaults=function T1(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}},Et.defaults=ru,Et.use=function(...n){return ou.use(...n),rW(Et.defaults=ou.defaults),Et},Et.walkTokens=function(n,e){return ou.walkTokens(n,e)},Et.parseInline=ou.parseInline,Et.Parser=Fo,Et.parser=Fo.parse,Et.Renderer=su,Et.TextRenderer=O1,Et.Lexer=ko,Et.lexer=ko.lex,Et.Tokenizer=H0,Et.Hooks=$0,Et.parse=Et;const wFe=["*"];let vW=(()=>{class n{constructor(){this._buttonClick$=new fe,this.copied$=this._buttonClick$.pipe(pn(()=>vl(ee(!0),y0(3e3).pipe(mD(!1)))),hh(),ps(1)),this.copiedText$=this.copied$.pipe(xc(!1),le(t=>t?"Copied":"Copy"))}onCopyToClipboardClick(){this._buttonClick$.next()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Yt({type:n,selectors:[["markdown-clipboard"]],standalone:!0,features:[Bi],decls:4,vars:7,consts:[[1,"markdown-clipboard-button",3,"click"]],template:function(i,r){1&i&&(xe(0,"button",0),Mn(1,"async"),mt("click",function(){return r.onCopyToClipboardClick()}),Ci(2),Mn(3,"async"),Ie()),2&i&&(Sn("copied",In(1,3,r.copied$)),Xe(2),lo(In(3,5,r.copiedText$)))},dependencies:[qy],encapsulation:2,changeDetection:0})}}return n})();const AFe=new k("CLIPBOARD_OPTIONS");var P1=function(n){return n.CommandLine="command-line",n.LineHighlight="line-highlight",n.LineNumbers="line-numbers",n}(P1||{});const bW=new k("MARKED_EXTENSIONS"),xFe=new k("MARKED_OPTIONS"),wW=new k("SECURITY_CONTEXT");let N1=(()=>{class n{get options(){return this._options}set options(t){this._options={...this.DEFAULT_MARKED_OPTIONS,...t}}get renderer(){return this.options.renderer}set renderer(t){this.options.renderer=t}constructor(t,i,r,s,o,a,c){this.clipboardOptions=t,this.extensions=i,this.platform=s,this.securityContext=o,this.http=a,this.sanitizer=c,this.DEFAULT_MARKED_OPTIONS={renderer:new su},this.DEFAULT_KATEX_OPTIONS={delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\begin{CD}",right:"\\end{CD}",display:!0},{left:"\\[",right:"\\]",display:!0}]},this.DEFAULT_MERMAID_OPTIONS={startOnLoad:!1},this.DEFAULT_CLIPBOARD_OPTIONS={buttonComponent:void 0},this.DEFAULT_PARSE_OPTIONS={decodeHtml:!1,inline:!1,emoji:!1,mermaid:!1,markedOptions:void 0,disableSanitizer:!1},this.DEFAULT_RENDER_OPTIONS={clipboard:!1,clipboardOptions:void 0,katex:!1,katexOptions:void 0,mermaid:!1,mermaidOptions:void 0},this._reload$=new fe,this.reload$=this._reload$.asObservable(),this.options=r}parse(t,i=this.DEFAULT_PARSE_OPTIONS){const{decodeHtml:r,inline:s,emoji:o,mermaid:a,disableSanitizer:c}=i,l={...this.options,...i.markedOptions},u=l.renderer||this.renderer||new su;this.extensions&&(this.renderer=this.extendsRendererForExtensions(u)),a&&(this.renderer=this.extendsRendererForMermaid(u));const d=this.trimIndentation(t),h=r?this.decodeHtml(d):d,f=o?this.parseEmoji(h):h,p=this.parseMarked(f,l,s);return(c?p:this.sanitizer.sanitize(this.securityContext,p))||""}render(t,i=this.DEFAULT_RENDER_OPTIONS,r){const{clipboard:s,clipboardOptions:o,katex:a,katexOptions:c,mermaid:l,mermaidOptions:u}=i;a&&this.renderKatex(t,{...this.DEFAULT_KATEX_OPTIONS,...c}),l&&this.renderMermaid(t,{...this.DEFAULT_MERMAID_OPTIONS,...u}),s&&this.renderClipboard(t,r,{...this.DEFAULT_CLIPBOARD_OPTIONS,...this.clipboardOptions,...o}),this.highlight(t)}reload(){this._reload$.next()}getSource(t){if(!this.http)throw new Error("[ngx-markdown] When using the `src` attribute you *have to* pass the `HttpClient` as a parameter of the `forRoot` method. See README for more information");return this.http.get(t,{responseType:"text"}).pipe(le(i=>this.handleExtension(t,i)))}highlight(t){if(!rc(this.platform)||typeof Prism>"u"||typeof Prism.highlightAllUnder>"u")return;t||(t=document);const i=t.querySelectorAll('pre code:not([class*="language-"])');Array.prototype.forEach.call(i,r=>r.classList.add("language-none")),Prism.highlightAllUnder(t)}decodeHtml(t){if(!rc(this.platform))return t;const i=document.createElement("textarea");return i.innerHTML=t,i.value}extendsRendererForExtensions(t){const i=t;return!0===i.\u0275NgxMarkdownRendererExtendedForExtensions||(this.extensions?.length>0&&Et.use(...this.extensions),i.\u0275NgxMarkdownRendererExtendedForExtensions=!0),t}extendsRendererForMermaid(t){const i=t;if(!0===i.\u0275NgxMarkdownRendererExtendedForMermaid)return t;const r=t.code;return t.code=function(s,o,a){return"mermaid"===o?`<div class="mermaid">${s}</div>`:r.call(this,s,o,a)},i.\u0275NgxMarkdownRendererExtendedForMermaid=!0,t}handleExtension(t,i){const r=t.lastIndexOf("://"),s=r>-1?t.substring(r+4):t,o=s.lastIndexOf("/"),a=o>-1?s.substring(o+1).split("?")[0]:"",c=a.lastIndexOf("."),l=c>-1?a.substring(c+1):"";return l&&"md"!==l?"```"+l+"\n"+i+"\n```":i}parseMarked(t,i,r=!1){if(i.renderer){const s={...i.renderer};delete s.\u0275NgxMarkdownRendererExtendedForExtensions,delete s.\u0275NgxMarkdownRendererExtendedForMermaid,delete i.renderer,Et.use({renderer:s})}return r?Et.parseInline(t,i):Et.parse(t,i)}parseEmoji(t){if(!rc(this.platform))return t;if(typeof joypixels>"u"||typeof joypixels.shortnameToUnicode>"u")throw new Error("[ngx-markdown] When using the `emoji` attribute you *have to* include Emoji-Toolkit files to `angular.json` or use imports. See README for more information");return joypixels.shortnameToUnicode(t)}renderKatex(t,i){if(rc(this.platform)){if(typeof katex>"u"||typeof renderMathInElement>"u")throw new Error("[ngx-markdown] When using the `katex` attribute you *have to* include KaTeX files to `angular.json` or use imports. See README for more information");renderMathInElement(t,i)}}renderClipboard(t,i,r){if(!rc(this.platform))return;if(typeof ClipboardJS>"u")throw new Error("[ngx-markdown] When using the `clipboard` attribute you *have to* include Clipboard files to `angular.json` or use imports. See README for more information");if(!i)throw new Error("[ngx-markdown] When using the `clipboard` attribute you *have to* provide the `viewContainerRef` parameter to `MarkdownService.render()` function");const{buttonComponent:s,buttonTemplate:o}=r,a=t.querySelectorAll("pre");for(let c=0;c<a.length;c++){const l=a.item(c),u=document.createElement("div");u.style.position="relative",l.parentNode.insertBefore(u,l),u.appendChild(l);const d=document.createElement("div");let h,f;if(d.classList.add("markdown-clipboard-toolbar"),d.style.position="absolute",d.style.top=".5em",d.style.right=".5em",d.style.zIndex="1",u.insertAdjacentElement("beforeend",d),u.onmouseenter=()=>d.classList.add("hover"),u.onmouseleave=()=>d.classList.remove("hover"),s){const p=i.createComponent(s);h=p.hostView,p.changeDetectorRef.markForCheck()}else if(o)h=i.createEmbeddedView(o);else{const p=i.createComponent(vW);h=p.hostView,p.changeDetectorRef.markForCheck()}h.rootNodes.forEach(p=>{d.appendChild(p),f=new ClipboardJS(p,{text:()=>l.innerText})}),h.onDestroy(()=>f.destroy())}}renderMermaid(t,i=this.DEFAULT_MERMAID_OPTIONS){if(!rc(this.platform))return;if(typeof mermaid>"u"||typeof mermaid.initialize>"u")throw new Error("[ngx-markdown] When using the `mermaid` attribute you *have to* include Mermaid files to `angular.json` or use imports. See README for more information");const r=t.querySelectorAll(".mermaid");0!==r.length&&(mermaid.initialize(i),mermaid.run({nodes:r}))}trimIndentation(t){if(!t)return"";let i;return t.split("\n").map(r=>{let s=i;return r.length>0&&(s=isNaN(s)?r.search(/\S|$/):Math.min(r.search(/\S|$/),s)),isNaN(i)&&(i=s),s?r.substring(s):r}).join("\n")}static{this.\u0275fac=function(i){return new(i||n)(O(AFe,8),O(bW,8),O(xFe,8),O(is),O(wW),O($s,8),O(wp))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})(),EW=(()=>{class n{get disableSanitizer(){return this._disableSanitizer}set disableSanitizer(t){this._disableSanitizer=this.coerceBooleanProperty(t)}get inline(){return this._inline}set inline(t){this._inline=this.coerceBooleanProperty(t)}get clipboard(){return this._clipboard}set clipboard(t){this._clipboard=this.coerceBooleanProperty(t)}get emoji(){return this._emoji}set emoji(t){this._emoji=this.coerceBooleanProperty(t)}get katex(){return this._katex}set katex(t){this._katex=this.coerceBooleanProperty(t)}get mermaid(){return this._mermaid}set mermaid(t){this._mermaid=this.coerceBooleanProperty(t)}get lineHighlight(){return this._lineHighlight}set lineHighlight(t){this._lineHighlight=this.coerceBooleanProperty(t)}get lineNumbers(){return this._lineNumbers}set lineNumbers(t){this._lineNumbers=this.coerceBooleanProperty(t)}get commandLine(){return this._commandLine}set commandLine(t){this._commandLine=this.coerceBooleanProperty(t)}constructor(t,i,r){this.element=t,this.markdownService=i,this.viewContainerRef=r,this.error=new Ae,this.load=new Ae,this.ready=new Ae,this._clipboard=!1,this._commandLine=!1,this._disableSanitizer=!1,this._emoji=!1,this._inline=!1,this._katex=!1,this._lineHighlight=!1,this._lineNumbers=!1,this._mermaid=!1,this.destroyed$=new fe}ngOnChanges(){this.loadContent()}loadContent(){null==this.data?null==this.src||this.handleSrc():this.handleData()}ngAfterViewInit(){!this.data&&!this.src&&this.handleTransclusion(),this.markdownService.reload$.pipe(zs(this.destroyed$)).subscribe(()=>this.loadContent())}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}render(t,i=!1){var r=this;return Q(function*(){const s={decodeHtml:i,inline:r.inline,emoji:r.emoji,mermaid:r.mermaid,disableSanitizer:r.disableSanitizer},o={clipboard:r.clipboard,clipboardOptions:r.getClipboardOptions(),katex:r.katex,katexOptions:r.katexOptions,mermaid:r.mermaid,mermaidOptions:r.mermaidOptions},a=yield r.markdownService.parse(t,s);r.element.nativeElement.innerHTML=a,r.handlePlugins(),r.markdownService.render(r.element.nativeElement,o,r.viewContainerRef),r.ready.emit()})()}coerceBooleanProperty(t){return null!=t&&"false"!=`${String(t)}`}getClipboardOptions(){if(this.clipboardButtonComponent||this.clipboardButtonTemplate)return{buttonComponent:this.clipboardButtonComponent,buttonTemplate:this.clipboardButtonTemplate}}handleData(){this.render(this.data)}handleSrc(){this.markdownService.getSource(this.src).subscribe({next:t=>{this.render(t).then(()=>{this.load.emit(t)})},error:t=>this.error.emit(t)})}handleTransclusion(){this.render(this.element.nativeElement.innerHTML,!0)}handlePlugins(){this.commandLine&&(this.setPluginClass(this.element.nativeElement,P1.CommandLine),this.setPluginOptions(this.element.nativeElement,{dataFilterOutput:this.filterOutput,dataHost:this.host,dataPrompt:this.prompt,dataOutput:this.output,dataUser:this.user})),this.lineHighlight&&this.setPluginOptions(this.element.nativeElement,{dataLine:this.line,dataLineOffset:this.lineOffset}),this.lineNumbers&&(this.setPluginClass(this.element.nativeElement,P1.LineNumbers),this.setPluginOptions(this.element.nativeElement,{dataStart:this.start}))}setPluginClass(t,i){const r=t.querySelectorAll("pre");for(let s=0;s<r.length;s++){const o=i instanceof Array?i:[i];r.item(s).classList.add(...o)}}setPluginOptions(t,i){const r=t.querySelectorAll("pre");for(let s=0;s<r.length;s++)Object.keys(i).forEach(o=>{const a=i[o];if(a){const c=this.toLispCase(o);r.item(s).setAttribute(c,a.toString())}})}toLispCase(t){const i=t.match(/([A-Z])/g);if(!i)return t;let r=t.toString();for(let s=0,o=i.length;s<o;s++)r=r.replace(new RegExp(i[s]),"-"+i[s].toLowerCase());return"-"===r.slice(0,1)&&(r=r.slice(1)),r}static{this.\u0275fac=function(i){return new(i||n)(R(At),R(N1),R(Qi))}}static{this.\u0275cmp=Yt({type:n,selectors:[["markdown"],["","markdown",""]],inputs:{data:"data",src:"src",disableSanitizer:"disableSanitizer",inline:"inline",clipboard:"clipboard",clipboardButtonComponent:"clipboardButtonComponent",clipboardButtonTemplate:"clipboardButtonTemplate",emoji:"emoji",katex:"katex",katexOptions:"katexOptions",mermaid:"mermaid",mermaidOptions:"mermaidOptions",lineHighlight:"lineHighlight",line:"line",lineOffset:"lineOffset",lineNumbers:"lineNumbers",start:"start",commandLine:"commandLine",filterOutput:"filterOutput",host:"host",prompt:"prompt",output:"output",user:"user"},outputs:{error:"error",load:"load",ready:"ready"},standalone:!0,features:[Kn,Bi],ngContentSelectors:wFe,decls:1,vars:0,template:function(i,r){1&i&&(co(),ci(0))},encapsulation:2})}}return n})();var CW;function NFe(n,e){if(1&n&&(xe(0,"div",16),Ei(1,"youtube-player",17),Ie()),2&n){const t=Ps(3);Xe(),yA("videoId",t.videoID)}}function kFe(n,e){if(1&n&&(xe(0,"mat-expansion-panel",11)(1,"mat-expansion-panel-header")(2,"h2",12),Ci(3),Ie()(),xe(4,"div",13),Ei(5,"markdown",14),er(6,NFe,2,1,"div",15),Ie()()),2&n){const t=Ps(),i=t.$implicit,r=t.index;Tt("expanded",0===r),Xe(3),lo(i.title),Xe(2),Sn("first",0===r),Tt("data",i.content),Xe(),Tt("ngIf",0===r)}}function FFe(n,e){if(1&n&&(xe(0,"div",9),er(1,kFe,7,6,"mat-expansion-panel",10),Ie()),2&n){const t=e.$implicit;Xe(),Tt("ngIf",t)}}!function(n){let e;var r;let t,i;(r=e=n.SecurityLevel||(n.SecurityLevel={})).Strict="strict",r.Loose="loose",r.Antiscript="antiscript",r.Sandbox="sandbox",function(r){r.Base="base",r.Forest="forest",r.Dark="dark",r.Default="default",r.Neutral="neutral"}(t=n.Theme||(n.Theme={})),function(r){r[r.Debug=1]="Debug",r[r.Info=2]="Info",r[r.Warn=3]="Warn",r[r.Error=4]="Error",r[r.Fatal=5]="Fatal"}(i=n.LogLevel||(n.LogLevel={}))}(CW||(CW={}));let LFe=(()=>{class n{constructor(t,i){this.dialogRef=t,this.data=i,this.documentationContents=i.content||[],this.infoTitle=i.title||"",this.videoID=i.videoID}ngOnInit(){const t=document.createElement("script");t.src="https://www.youtube.com/iframe_api",document.body.appendChild(t)}close(){document.getElementsByClassName("modal-animated")[0]?.classList.add("modal-animate-fade-out"),setTimeout(()=>{this.dialogRef.close()},250)}static{this.\u0275fac=function(i){return new(i||n)(R(F0),R(P5))}}static{this.\u0275cmp=Yt({type:n,selectors:[["ccf-info-dialog"]],decls:11,vars:2,consts:[[1,"about","wrapper"],[1,"container"],[1,"content"],[1,"header"],["mat-dialog-title","",1,"title"],[1,"close"],[1,"material-icons","close-icon",3,"click"],[1,"mat-typography","dialog-content"],["class","panel",4,"ngFor","ngForOf"],[1,"panel"],[3,"expanded",4,"ngIf"],[3,"expanded"],[1,"no-header-margin"],[1,"top-padding"],[1,"variable-binding",3,"data"],["class","video-player",4,"ngIf"],[1,"video-player"],[3,"videoId"]],template:function(i,r){1&i&&(xe(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),Ci(5),Ie(),xe(6,"div",5)(7,"mat-icon",6),mt("click",function(){return r.close()}),Ci(8,"clear"),Ie()()(),xe(9,"mat-dialog-content",7),er(10,FFe,2,1,"div",8),Ie()()()()),2&i&&(Xe(5),lo(r.infoTitle),Xe(5),Tt("ngForOf",r.documentationContents))},dependencies:[$y,fT,E1,C1,G5,J5,Nke,Vke,EW],styles:[".mat-dialog-container{padding:0}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:1.5rem;text-align:left}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;height:3rem;margin-bottom:2.25rem;position:relative}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.5rem;margin-bottom:1rem}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{cursor:pointer;height:3rem;width:3rem;line-height:3rem;text-align:center;transition:.6s}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.5rem;margin:0 auto;line-height:3rem;height:3rem;justify-self:center;display:flex}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1rem;margin-top:0;margin-bottom:.5rem}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]{margin-bottom:1.5rem}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .no-header-margin[_ngcontent-%COMP%]{font-weight:300;margin-bottom:0}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .top-padding[_ngcontent-%COMP%]{display:flex}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .top-padding[_ngcontent-%COMP%]   markdown[_ngcontent-%COMP%]     ul{margin-top:0;padding-left:1.5rem}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]{height:50rem;min-height:10rem;padding:0 1.5rem}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding[_ngcontent-%COMP%]{font-weight:300;display:flex}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding.first[_ngcontent-%COMP%]{padding-right:1rem;width:73%}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding[_ngcontent-%COMP%]     ul{margin:0}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding[_ngcontent-%COMP%]     img{margin-left:1rem;float:right}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .video-player[_ngcontent-%COMP%]{position:relative;width:50%}.about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .video-player[_ngcontent-%COMP%]     iframe{width:100%;height:100%}"],changeDetection:0})}}return n})();class _s{static{this.storage=(()=>{let e;try{e=window.localStorage;const t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&e&&0!==e.length?e:void 0}})()}get length(){return _s.storage?.length??0}key(e){return _s.storage?.key(e)??null}getItem(e,t){return _s.storage?.getItem(e)??t??null}setItem(e,t){try{return _s.storage?.setItem(e,t),!0}catch{return!1}}removeItem(e){_s.storage?.removeItem(e)}clear(){_s.storage?.clear()}static{this.\u0275fac=function(t){return new(t||_s)}}static{this.\u0275prov=j({token:_s,factory:_s.\u0275fac,providedIn:"root"})}}var q0;const AW="callToActionPopupShown";let ys=class aw{static{q0=this}static ctaDatePassed(e,t=Date.now){return+t()>+new Date(e)}constructor(e,t,i,r,s){this.dialog=e,this.ga=t,this.storage=i,this.infoService=r,this.http=s}ngxsOnInit(e){const{expirationDate:t,popupShown:i}=e.getState(),r=this.storage.getItem(AW,`${i}`),s=q0.ctaDatePassed(t);"true"!==r&&!s&&e.dispatch(new L6)}getDialogData(){return this.http.get("assets/docs/SPATIAL_SEARCH_README.md",{responseType:"text"}).pipe(le(e=>this.infoService.parseMarkdown(e)))}launchLearnMore(e){this.dialog.open(LFe,{autoFocus:!1,panelClass:"modal-animated",width:"72rem",data:{title:"Spatial Search",content:e,videoID:"UfxMpzatowE"}})}learnMore(e){return this.dialog.closeAll(),this.ga.event("open_learn_more","call_to_action"),this.getDialogData().pipe(Nt(t=>this.launchLearnMore(t)))}open(e){this.dialog.open(q0.callToActionComponent,{autoFocus:!1,panelClass:"modal-animated",width:"30.75rem",height:"36.688rem"}),this.ga.event("open","call_to_action"),this.storage.setItem(AW,"true"),e.patchState({popupShown:!0})}close(e){this.dialog.closeAll(),this.ga.event("close","call_to_action")}static{this.\u0275fac=function(t){return new(t||aw)(O(L0),O(Ch),O(_s),O(B5),O($s))}}static{this.\u0275prov=j({token:aw,factory:aw.\u0275fac})}};tt([lD(F6),te("design:type",Function),te("design:paramtypes",[Object]),te("design:returntype",be)],ys.prototype,"learnMore",null),tt([lD(L6),te("design:type",Function),te("design:paramtypes",[Object]),te("design:returntype",void 0)],ys.prototype,"open",null),tt([lD(B6),te("design:type",Function),te("design:paramtypes",[Object]),te("design:returntype",void 0)],ys.prototype,"close",null),ys=q0=tt([uD({name:"callToAction",defaults:{title:"New to the Exploration User Interface",message:"Spatial Search has arrived!",callToAction:"Learn More",imageUrl:"assets/images/spatial_search.gif",expirationDate:"Dec 1, 2022",popupShown:!1}}),te("design:paramtypes",[L0,Ch,_s,B5,$s])],ys);class Lo{static title(e){return e.title}static message(e){return e.message}static callToAction(e){return e.callToAction}static imageUrl(e){return e.imageUrl}static expirationDate(e){return e.expirationDate}static popupShown(e){return e.popupShown}}tt([gh([ys]),te("design:type",Function),te("design:paramtypes",[Object]),te("design:returntype",String)],Lo,"title",null),tt([gh([ys]),te("design:type",Function),te("design:paramtypes",[Object]),te("design:returntype",String)],Lo,"message",null),tt([gh([ys]),te("design:type",Function),te("design:paramtypes",[Object]),te("design:returntype",String)],Lo,"callToAction",null),tt([gh([ys]),te("design:type",Function),te("design:paramtypes",[Object]),te("design:returntype",String)],Lo,"imageUrl",null),tt([gh([ys]),te("design:type",Function),te("design:paramtypes",[Object]),te("design:returntype",String)],Lo,"expirationDate",null),tt([gh([ys]),te("design:type",Function),te("design:paramtypes",[Object]),te("design:returntype",Boolean)],Lo,"popupShown",null);let TW=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=se({type:n,selectors:[["","mat-card-sm-image",""],["","matCardImageSmall",""]],hostAttrs:[1,"mat-mdc-card-sm-image","mdc-card__media"],standalone:!0})}}return n})(),eLe=(()=>{class n{constructor(){this.clsName="ccf-call-to-action",this.callToActionClicked=new Ae,this.closeClicked=new Ae}close(){this.closeClicked.emit()}onDialogButtonClick(){this.callToActionClicked.emit()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Yt({type:n,selectors:[["ccf-call-to-action"]],hostVars:2,hostBindings:function(i,r){2&i&&_d(r.clsName)},inputs:{infoTitle:"infoTitle",imageUrl:"imageUrl",message:"message",callToAction:"callToAction"},outputs:{callToActionClicked:"callToActionClicked",closeClicked:"closeClicked"},decls:13,vars:4,consts:[[1,"rui-about","wrapper"],[1,"container"],[1,"content"],[1,"first-row"],["mat-dialog-title","",1,"title"],[1,"cta-mat-icon","material-icons","close-icon",3,"click"],["mat-card-sm-image","","alt","preview","layout-fill","",1,"cta-image",3,"src"],[1,"mat-typography","dialog-content"],[1,"message"],["mat-button","",1,"mat-button",3,"click","text"]],template:function(i,r){1&i&&(xe(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"p",4),Ci(5),Ie(),xe(6,"mat-icon",5),mt("click",function(){return r.close()}),Ci(7,"clear"),Ie()(),Ei(8,"img",6),xe(9,"mat-dialog-content",7)(10,"div",8),Ci(11),Ie(),xe(12,"a",9),mt("click",function(){return r.onDialogButtonClick()}),Ie()()()()()),2&i&&(Xe(5),lo(r.infoTitle),Xe(3),Tt("src",r.imageUrl,qE),Xe(3),lo(r.message),Xe(),Tt("text",r.callToAction))},dependencies:[G5,E1,C1,TW],styles:["[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{display:block;align-content:center;padding-left:1.6rem;padding-right:1.6rem;border-radius:.25rem}[_nghost-%COMP%]   .info-button-wrapper[_ngcontent-%COMP%]{border-radius:.25rem;padding:.6rem;transition:.6s}[_nghost-%COMP%]   .info-button-wrapper[_ngcontent-%COMP%]   .ccf-info-button[_ngcontent-%COMP%]{cursor:pointer;transition:color .6s;font-size:1.2rem;vertical-align:sub}[_nghost-%COMP%]   .first-row[_ngcontent-%COMP%]{display:flex;width:100%;line-height:.9rem}[_nghost-%COMP%]   .first-row[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:7rem;padding-left:.2rem;font-size:.875rem;padding-top:.75rem}[_nghost-%COMP%]   .first-row[_ngcontent-%COMP%]   .cta-mat-icon[_ngcontent-%COMP%]{height:30%;line-height:3.4rem}[_nghost-%COMP%]   .message[_ngcontent-%COMP%]{padding:.5rem}[_nghost-%COMP%]   .cta-image[_ngcontent-%COMP%]{align-self:center;object-fit:cover;width:100%;border-radius:.25rem}[_nghost-%COMP%]   .mat-button[_ngcontent-%COMP%]{background-color:#444a65;font-size:.75rem;position:relative;margin-bottom:1rem;width:100%;height:2rem;color:#fff}"],changeDetection:0})}}return n})();class Bo{constructor(){this.close=()=>new B6,this.learnMore=()=>new F6}static{this.\u0275fac=function(t){return new(t||Bo)}}static{this.\u0275cmp=Yt({type:Bo,selectors:[["ccf-call-to-action-behavior"]],decls:5,vars:12,consts:[[3,"callToActionClicked","closeClicked","infoTitle","message","callToAction","imageUrl"]],template:function(t,i){if(1&t&&(xe(0,"ccf-call-to-action",0),Mn(1,"async"),Mn(2,"async"),Mn(3,"async"),Mn(4,"async"),mt("callToActionClicked",function(){return i.learnMore()})("closeClicked",function(){return i.close()}),Ie()),2&t){let r,s,o,a;Tt("infoTitle",null!==(r=In(1,4,i.title$))&&void 0!==r?r:"")("message",null!==(s=In(2,6,i.message$))&&void 0!==s?s:"")("callToAction",null!==(o=In(3,8,i.callToAction$))&&void 0!==o?o:"")("imageUrl",null!==(a=In(4,10,i.imageUrl$))&&void 0!==a?a:"")}},dependencies:[eLe,qy],changeDetection:0})}}tt([Bb(Lo.title),te("design:type",be)],Bo.prototype,"title$",void 0),tt([Bb(Lo.message),te("design:type",be)],Bo.prototype,"message$",void 0),tt([Bb(Lo.callToAction),te("design:type",be)],Bo.prototype,"callToAction$",void 0),tt([Bb(Lo.imageUrl),te("design:type",be)],Bo.prototype,"imageUrl$",void 0),tt([k6(),te("design:type",Object)],Bo.prototype,"close",void 0),tt([k6(),te("design:type",Object)],Bo.prototype,"learnMore",void 0),ys.callToActionComponent=Bo,new Set(Object.keys({q:[0,0,1],e:[0,0,-1],w:[0,1,0],s:[0,-1,0],a:[-1,0,0],d:[1,0,0]}));const nLe={initialConfig:{},parse:{},rename:{}};class iLe{constructor(e,t){this.configState=e,this.storedChanges={},this.options={...nLe,...t}}addChanges(e){this.storedChanges={...this.storedChanges,...e}}applyChanges(e,t={}){void 0===e&&(e=this.storedChanges,this.storedChanges={});const{configState:i,options:{initialConfig:r}}=this,o={...r,...i.snapshot,...t};for(const[a,c]of Object.entries(e))this.processChange(a,c,o);i.setConfig(o)}processChange(e,t,i){const{options:{parse:r,rename:s}}=this,o=s[e]??e,a=t.currentValue,c=r[e]??r[o];if(null==a)delete i[o];else if(c)try{i[o]=c(a)}catch(l){console.warn(`Failed to parse ${e} = ${a} (${typeof a})`,l.message)}else i[o]=a}}let rLe=(()=>{class n{constructor(t,i,r={}){this.configState=t,this.cdr=i,this.options=r,this.initialized=!1,this.configManager=new iLe(this.configState,this.options)}ngOnInit(){this._init=setTimeout(()=>this.initialize(),this.options.initialDelay??0)}ngOnDestroy(){this._init&&clearTimeout(this._init)}ngOnChanges(t){this.configManager.addChanges(t),this.initialized&&this.configManager.applyChanges()}initialize(){this._init=void 0,!this.initialized&&(this.configManager.applyChanges(),this.initialized=!0,this.cdr.markForCheck())}static{this.\u0275fac=function(i){!function AN(){throw new Error("invalid")}()}}static{this.\u0275dir=se({type:n,features:[Kn]})}}return n})();const xW_json=n=>"string"==typeof n?JSON.parse(n):n,Oh_dbOptions={dataSources:["https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@staging/assets/kpmp/data/rui_locations.jsonld","https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@staging/assets/sparc/data/rui_locations.jsonld"],remoteApiEndpoint:"https://apps.humanatlas.io/api"};let sLe=(()=>{class n{constructor(t){this.source=t,this.organs=I4}getOrganInfo(t,i,r=Th.Female){let s=this.organs.find(a=>a.id===t);if(!s)return ee(void 0);const o=s.organ;return s.disabled&&(s=this.organs.find(a=>!a.disabled&&a.organ===o)),s?.side&&i&&s.side!==i&&(s=this.organs.find(a=>!a.disabled&&a.organ===o&&a.side===i)),ee(s)}getOrgan(t,i=Th.Both){return this.source.getReferenceOrgans().pipe(le(r=>r.find(s=>s.representation_of===t.id&&("Both"===i||s.sex===i))))}getOrganScene(t,i=Th.Female){return t.id?this.source.getReferenceOrganScene(t.id,{ontologyTerms:[t.id],sex:i}):ee([])}getOrganStats(t,i=Th.Female){return t.id?this.source.getAggregateResults({ontologyTerms:[t.id],sex:i}):ee([])}getBlocks(t,i=Th.Female){return t.id?this.source.getTissueBlockResults({ontologyTerms:[t.id],sex:i}):ee([])}static{this.\u0275fac=function(i){return new(i||n)(O(t6))}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function oLe(n,e){if(1&n){const t=ao();xe(0,"div",6)(1,"div",7)(2,"div",8),Ci(3),Ie(),xe(4,"div",9),mt("click",function(){const r=En(t).$implicit;return Cn(Ps().goToURL(r.buttonUrl))}),Ci(5),Ie()()()}if(2&n){const t=e.$implicit;Xe(3),lo(t.body),Xe(),Tt("gaLabel",t.buttonUrl),Xe(),Ka(" ",t.buttonTitle," ")}}function aLe(n,e){if(1&n){const t=ao();xe(0,"div",10),mt("click",function(){const r=En(t).$implicit;return Cn(Ps().goToURL(r.buttonUrl))}),Ci(1),Ie()}if(2&n){const t=e.$implicit;Tt("gaLabel",t.buttonUrl),Xe(),Ka(" ",t.buttonTitle," ")}}let cLe=(()=>{class n{constructor(){this.linkCards=[{body:"Add tissue blocks using the HRA Registration User Interface (RUI).",buttonTitle:"Register Tissue",buttonUrl:"https://hubmapconsortium.github.io/ccf-ui/rui/"},{body:"Explore tissue sections in tissue blocks with the HRA Exploration User Interface (EUI).",buttonTitle:"Explore Tissue",buttonUrl:"https://portal.hubmapconsortium.org/ccf-eui"},{body:"View linkages between anatomical structures, cell types, and common biomarkers (ASCT+B).",buttonTitle:"ASCT+B Reporter",buttonUrl:"https://hubmapconsortium.github.io/ccf-asct-reporter/"}],this.deepDives=[{body:"",buttonTitle:"HRA Portal",buttonUrl:"https://humanatlas.io"},{body:"",buttonTitle:"Online Course",buttonUrl:"https://expand.iu.edu/browse/sice/cns/courses/hubmap-visible-human-mooc"},{body:"",buttonTitle:"Paper",buttonUrl:"https://www.biorxiv.org/content/10.1101/2024.03.27.587041"}]}ngOnInit(){const t=[this.ruiUrl,this.euiUrl,this.asctbUrl],i=[this.hraPortalUrl,this.onlineCourseUrl,this.paperUrl];this.linkCards=this.linkCards.map((r,s)=>({...r,buttonUrl:t[s]??r.buttonUrl})),this.deepDives=this.deepDives.map((r,s)=>({...r,buttonUrl:i[s]??r.buttonUrl}))}goToURL(t){window.open(t,"_blank")}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Yt({type:n,selectors:[["ccf-link-cards"]],inputs:{ruiUrl:"ruiUrl",euiUrl:"euiUrl",asctbUrl:"asctbUrl",hraPortalUrl:"hraPortalUrl",onlineCourseUrl:"onlineCourseUrl",paperUrl:"paperUrl"},decls:7,vars:2,consts:[["gaCategory","link-cards",1,"link-cards-container"],["class","link-card",4,"ngFor","ngForOf"],["gaCategory","deep-dive",1,"deep-dive-section"],[1,"title"],[1,"button-container"],["class","btn-outline btn","gaEvent","visit-link",3,"gaLabel","click",4,"ngFor","ngForOf"],[1,"link-card"],[1,"link-card-content"],[1,"body"],["gaEvent","visit-link",1,"link-button","btn",3,"click","gaLabel"],["gaEvent","visit-link",1,"btn-outline","btn",3,"click","gaLabel"]],template:function(i,r){1&i&&(xe(0,"div",0),er(1,oLe,6,3,"div",1),Ie(),xe(2,"div",2)(3,"div",3),Ci(4,"Human Reference Atlas (HRA) Deep Dive"),Ie(),xe(5,"div",4),er(6,aLe,2,2,"div",5),Ie()()),2&i&&(Xe(),Tt("ngForOf",r.linkCards),Xe(5),Tt("ngForOf",r.deepDives))},dependencies:[$y,$Re,K9],styles:['.link-cards-container[_ngcontent-%COMP%]{max-width:30rem}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]{border-top:1px solid #e0e0e0;padding-top:1px;padding-bottom:1px}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]:last-of-type{border-bottom:1px solid #e0e0e0}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]{align-items:center;padding:1rem 0rem 1rem 1rem;display:flex;flex-direction:row;justify-content:space-between;border-left:6px solid #444a65}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]{margin-left:2rem;background-color:#444a65;color:#fff}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]:hover{background-color:#2f3346}.deep-dive-section[_ngcontent-%COMP%]{margin-top:2rem}.deep-dive-section[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{color:#444a65;border:1px solid #444a65;background-color:#fff}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:not(:last-of-type){margin-right:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.btn[_ngcontent-%COMP%]{min-width:9rem!important;max-height:2.28125rem;text-align:center;white-space:nowrap;cursor:pointer;font-size:.875rem;font-weight:500;border-radius:2px;line-height:2.75;transition:background-color .25s cubic-bezier(.4,0,.2,1) 0ms,box-shadow .25s cubic-bezier(.4,0,.2,1) 0ms,border .25s cubic-bezier(.4,0,.2,1) 0ms;font-family:var(--ccf-ui-font, ""),Inter,Inter Variable,Helvetica,Arial,sans-serif}'],changeDetection:0})}}return n})();function lLe(n,e){if(1&n&&(xe(0,"div",3)(1,"div",4),Ci(2),Ie(),xe(3,"div",5),Ci(4),Ie()()),2&n){const t=e.$implicit;Xe(2),lo(t.count),Xe(2),lo(t.label)}}let uLe=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Yt({type:n,selectors:[["ccf-stats-list"]],inputs:{statsLabel:"statsLabel",stats:"stats"},decls:4,vars:2,consts:[[1,"stats-container"],[1,"header"],["class","stats-row",4,"ngFor","ngForOf"],[1,"stats-row"],[1,"stat"],[1,"label"]],template:function(i,r){1&i&&(xe(0,"div",0)(1,"div",1),Ci(2),Ie(),er(3,lLe,5,2,"div",2),Ie()),2&i&&(Xe(2),Ka(" ",r.statsLabel," "),Xe(),Tt("ngForOf",r.stats))},dependencies:[$y],styles:[".stats-container[_ngcontent-%COMP%]{margin-bottom:2rem;min-height:9rem}.stats-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{margin-bottom:1rem}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:1.325rem}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{width:2rem;margin-right:1rem;text-align:right}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{flex-grow:1;text-align:left}"],changeDetection:0})}}return n})();const Xs=new k(""),hi=new k("");Promise.resolve(),Promise.resolve();const dBe=["mat-internal-form-field",""],hBe=["*"],pBe=new k("mat-sanity-checks",{providedIn:"root",factory:function fBe(){return!0}});let R$=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!l1()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}static{this.\u0275fac=function(i){return new(i||n)(O($Ne),O(pBe,8),O(nt))}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({imports:[G6,G6]})}}return n})();var vs=function(n){return n[n.FADING_IN=0]="FADING_IN",n[n.VISIBLE=1]="VISIBLE",n[n.FADING_OUT=2]="FADING_OUT",n[n.HIDDEN=3]="HIDDEN",n}(vs||{});class wBe{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=vs.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}}const O$=E0({passive:!0,capture:!0});class EBe{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=Oc(e);t&&this._events.get(e.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,i,r){const s=this._events.get(t);if(s){const o=s.get(i);o?o.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,O$)})}removeHandler(e,t,i){const r=this._events.get(e);if(!r)return;const s=r.get(t);s&&(s.delete(i),0===s.size&&r.delete(t),0===r.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,O$)))}}const P$={enterDuration:225,exitDuration:150},N$=E0({passive:!0,capture:!0}),k$=["mousedown","touchstart"],F$=["mouseup","mouseleave","touchend","touchcancel"];class rw{static{this._eventManager=new EBe}constructor(e,t,i,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Mh(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...P$,...i.animation};i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=i.radius||function ABe(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),a=e-r.left,c=t-r.top,l=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=a-o+"px",u.style.top=c-o+"px",u.style.height=2*o+"px",u.style.width=2*o+"px",null!=i.color&&(u.style.backgroundColor=i.color),u.style.transitionDuration=`${l}ms`,this._containerElement.appendChild(u);const d=window.getComputedStyle(u),f=d.transitionDuration,p="none"===d.transitionProperty||"0s"===f||"0s, 0s"===f||0===r.width&&0===r.height,g=new wBe(this,u,i,p);u.style.transform="scale3d(1, 1, 1)",g.state=vs.FADING_IN,i.persistent||(this._mostRecentTransientRipple=g);let m=null;return!p&&(l||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const y=()=>{m&&(m.fallbackTimer=null),clearTimeout(_),this._finishRippleTransition(g)},v=()=>this._destroyRipple(g),_=setTimeout(v,l+100);u.addEventListener("transitionend",y),u.addEventListener("transitioncancel",v),m={onTransitionEnd:y,onTransitionCancel:v,fallbackTimer:_}}),this._activeRipples.set(g,m),(p||!l)&&this._finishRippleTransition(g),g}fadeOutRipple(e){if(e.state===vs.FADING_OUT||e.state===vs.HIDDEN)return;const t=e.element,i={...P$,...e.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=vs.FADING_OUT,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=Mh(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,k$.forEach(i=>{rw._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{F$.forEach(t=>{this._triggerElement.addEventListener(t,this,N$)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===vs.FADING_IN?this._startFadeOutTransition(e):e.state===vs.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=vs.VISIBLE,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=vs.HIDDEN,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel),null!==t.fallbackTimer&&clearTimeout(t.fallbackTimer)),e.element.remove()}_onMousedown(e){const t=_5(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!y5(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;if(t)for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(e.state===vs.VISIBLE||e.config.terminateOnPointerUp&&e.state===vs.FADING_IN)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&(k$.forEach(t=>rw._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&(F$.forEach(t=>e.removeEventListener(t,this,N$)),this._pointerUpEventsRegistered=!1))}}const TBe=new k("mat-ripple-global-options");let xBe=(()=>{class n{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new rw(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}static{this.\u0275fac=function(i){return new(i||n)(R(At),R(ye),R(ms),R(TBe,8),R(il,8))}}static{this.\u0275dir=se({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(i,r){2&i&&Sn("mat-ripple-unbounded",r.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0})}}return n})(),SBe=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Yt({type:n,selectors:[["div","mat-internal-form-field",""]],hostAttrs:[1,"mdc-form-field","mat-internal-form-field"],hostVars:2,hostBindings:function(i,r){2&i&&Sn("mdc-form-field--align-end","before"===r.labelPosition)},inputs:{labelPosition:"labelPosition"},standalone:!0,features:[Bi],attrs:dBe,ngContentSelectors:hBe,decls:1,vars:0,template:function(i,r){1&i&&(co(),ci(0))},styles:[".mat-internal-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-flex;align-items:center;vertical-align:middle}.mat-internal-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mat-internal-form-field>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end .mdc-form-field--align-end label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0}"],encapsulation:2,changeDetection:0})}}return n})();const MBe=["switch"],IBe=["*"];function DBe(n,e){1&n&&(xe(0,"span",10),o_(),xe(1,"svg",12),Ei(2,"path",13),Ie(),xe(3,"svg",14),Ei(4,"path",15),Ie()())}const RBe=new k("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1,hideIcon:!1,disabledInteractive:!1})}),OBe={provide:Xs,useExisting:Bt(()=>oR),multi:!0};class L${constructor(e,t){this.source=e,this.checked=t}}let PBe=0,oR=(()=>{class n{_createChangeEvent(t){return new L$(this,t)}get buttonId(){return`${this.id||this._uniqueId}-button`}focus(){this._switchElement.nativeElement.focus()}get checked(){return this._checked}set checked(t){this._checked=t,this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(t,i,r,s,o,a){this._elementRef=t,this._focusMonitor=i,this._changeDetectorRef=r,this.defaults=o,this._onChange=c=>{},this._onTouched=()=>{},this._validatorOnChange=()=>{},this._checked=!1,this.name=null,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.disabled=!1,this.disableRipple=!1,this.tabIndex=0,this.change=new Ae,this.toggleChange=new Ae,this.tabIndex=parseInt(s)||0,this.color=o.color||"accent",this._noopAnimations="NoopAnimations"===a,this.id=this._uniqueId="mat-mdc-slide-toggle-"+ ++PBe,this.hideIcon=o.hideIcon??!1,this.disabledInteractive=o.disabledInteractive??!1,this._labelId=this._uniqueId+"-label"}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{"keyboard"===t||"program"===t?(this._focused=!0,this._changeDetectorRef.markForCheck()):t||Promise.resolve().then(()=>{this._focused=!1,this._onTouched(),this._changeDetectorRef.markForCheck()})})}ngOnChanges(t){t.required&&this._validatorOnChange()}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}writeValue(t){this.checked=!!t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}validate(t){return this.required&&!0!==t.value?{required:!0}:null}registerOnValidatorChange(t){this._validatorOnChange=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck()}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(this._createChangeEvent(this.checked))}_handleClick(){this.disabled||(this.toggleChange.emit(),this.defaults.disableToggleValue||(this.checked=!this.checked,this._onChange(this.checked),this.change.emit(new L$(this,this.checked))))}_getAriaLabelledBy(){return this.ariaLabelledby?this.ariaLabelledby:this.ariaLabel?null:this._labelId}static{this.\u0275fac=function(i){return new(i||n)(R(At),R(R0),R(br),ja("tabindex"),R(RBe),R(il,8))}}static{this.\u0275cmp=Yt({type:n,selectors:[["mat-slide-toggle"]],viewQuery:function(i,r){if(1&i&&ea(MBe,5),2&i){let s;Ns(s=ks())&&(r._switchElement=s.first)}},hostAttrs:[1,"mat-mdc-slide-toggle"],hostVars:13,hostBindings:function(i,r){2&i&&(ep("id",r.id),kn("tabindex",null)("aria-label",null)("name",null)("aria-labelledby",null),_d(r.color?"mat-"+r.color:""),Sn("mat-mdc-slide-toggle-focused",r._focused)("mat-mdc-slide-toggle-checked",r.checked)("_mat-animation-noopable",r._noopAnimations))},inputs:{name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],required:[2,"required","required",Fn],color:"color",disabled:[2,"disabled","disabled",Fn],disableRipple:[2,"disableRipple","disableRipple",Fn],tabIndex:[2,"tabIndex","tabIndex",t=>null==t?0:gp(t)],checked:[2,"checked","checked",Fn],hideIcon:[2,"hideIcon","hideIcon",Fn],disabledInteractive:[2,"disabledInteractive","disabledInteractive",Fn]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],standalone:!0,features:[Vt([OBe,{provide:hi,useExisting:n,multi:!0}]),Xa,Kn,Bi],ngContentSelectors:IBe,decls:13,vars:27,consts:[["switch",""],["mat-internal-form-field","",3,"labelPosition"],["role","switch","type","button",1,"mdc-switch",3,"click","tabIndex","disabled"],[1,"mdc-switch__track"],[1,"mdc-switch__handle-track"],[1,"mdc-switch__handle"],[1,"mdc-switch__shadow"],[1,"mdc-elevation-overlay"],[1,"mdc-switch__ripple"],["mat-ripple","",1,"mat-mdc-slide-toggle-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-switch__icons"],[1,"mdc-label",3,"click","for"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--on"],["d","M19.69,5.23L8.96,15.96l-4.23-4.23L2.96,13.5l6,6L21.46,7L19.69,5.23z"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--off"],["d","M20 13H4v-2h16v2z"]],template:function(i,r){if(1&i){const s=ao();co(),xe(0,"div",1)(1,"button",2,0),mt("click",function(){return En(s),Cn(r._handleClick())}),Ei(3,"span",3),xe(4,"span",4)(5,"span",5)(6,"span",6),Ei(7,"span",7),Ie(),xe(8,"span",8),Ei(9,"span",9),Ie(),er(10,DBe,5,0,"span",10),Ie()()(),xe(11,"label",11),mt("click",function(a){return En(s),Cn(a.stopPropagation())}),ci(12),Ie()()}if(2&i){const s=py(2);Tt("labelPosition",r.labelPosition),Xe(),Sn("mdc-switch--selected",r.checked)("mdc-switch--unselected",!r.checked)("mdc-switch--checked",r.checked)("mdc-switch--disabled",r.disabled)("mat-mdc-slide-toggle-disabled-interactive",r.disabledInteractive),Tt("tabIndex",r.disabled&&!r.disabledInteractive?-1:r.tabIndex)("disabled",r.disabled&&!r.disabledInteractive),kn("id",r.buttonId)("name",r.name)("aria-label",r.ariaLabel)("aria-labelledby",r._getAriaLabelledBy())("aria-describedby",r.ariaDescribedby)("aria-required",r.required||null)("aria-checked",r.checked)("aria-disabled",r.disabled&&r.disabledInteractive?"true":null),Xe(8),Tt("matRippleTrigger",s)("matRippleDisabled",r.disableRipple||r.disabled)("matRippleCentered",!0),Xe(),cy(r.hideIcon?-1:10),Xe(),Tt("for",r.buttonId),kn("id",r._labelId)}},dependencies:[xBe,SBe],styles:['.mdc-switch{align-items:center;background:none;border:none;cursor:pointer;display:inline-flex;flex-shrink:0;margin:0;outline:none;overflow:visible;padding:0;position:relative;width:var(--mdc-switch-track-width)}.mdc-switch.mdc-switch--disabled{cursor:default;pointer-events:none}.mdc-switch.mat-mdc-slide-toggle-disabled-interactive{pointer-events:auto}.mdc-switch__track{overflow:hidden;position:relative;width:100%;height:var(--mdc-switch-track-height);border-radius:var(--mdc-switch-track-shape, var(--mat-app-corner-full))}.mdc-switch--disabled.mdc-switch .mdc-switch__track{opacity:var(--mdc-switch-disabled-track-opacity)}.mdc-switch__track::before,.mdc-switch__track::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";height:100%;left:0;position:absolute;width:100%;border-width:var(--mat-switch-track-outline-width);border-color:var(--mat-switch-track-outline-color, var(--mat-app-outline))}.cdk-high-contrast-active .mdc-switch__track::before,.cdk-high-contrast-active .mdc-switch__track::after{border-color:currentColor}.mdc-switch--selected .mdc-switch__track::before,.mdc-switch--selected .mdc-switch__track::after{border-width:var(--mat-switch-selected-track-outline-width);border-color:var(--mat-switch-selected-track-outline-color)}.mdc-switch--disabled .mdc-switch__track::before,.mdc-switch--disabled .mdc-switch__track::after{border-width:var(--mat-switch-disabled-unselected-track-outline-width);border-color:var(--mat-switch-disabled-unselected-track-outline-color, var(--mat-app-on-surface))}.mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0);background:var(--mdc-switch-unselected-track-color, var(--mat-app-surface-variant))}.mdc-switch--selected .mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch--selected .mdc-switch__track::before{transform:translateX(-100%)}.mdc-switch--selected .mdc-switch__track::before{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mdc-switch--unselected .mdc-switch__track::before{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-hover-track-color, var(--mat-app-surface-variant))}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-focus-track-color, var(--mat-app-surface-variant))}.mdc-switch:enabled:active .mdc-switch__track::before{background:var(--mdc-switch-unselected-pressed-track-color, var(--mat-app-surface-variant))}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:hover:not(:focus):not(:active) .mdc-switch__track::before,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:focus:not(:active) .mdc-switch__track::before,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:active .mdc-switch__track::before,.mdc-switch.mdc-switch--disabled .mdc-switch__track::before{background:var(--mdc-switch-disabled-unselected-track-color, var(--mat-app-surface-variant))}.mdc-switch__track::after{transform:translateX(-100%);background:var(--mdc-switch-selected-track-color, var(--mat-app-primary))}[dir=rtl] .mdc-switch__track::after{transform:translateX(100%)}.mdc-switch--selected .mdc-switch__track::after{transform:translateX(0)}.mdc-switch--selected .mdc-switch__track::after{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch--unselected .mdc-switch__track::after{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-hover-track-color, var(--mat-app-primary))}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-focus-track-color, var(--mat-app-primary))}.mdc-switch:enabled:active .mdc-switch__track::after{background:var(--mdc-switch-selected-pressed-track-color, var(--mat-app-primary))}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:hover:not(:focus):not(:active) .mdc-switch__track::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:focus:not(:active) .mdc-switch__track::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:active .mdc-switch__track::after,.mdc-switch.mdc-switch--disabled .mdc-switch__track::after{background:var(--mdc-switch-disabled-selected-track-color, var(--mat-app-on-surface))}.mdc-switch__handle-track{height:100%;pointer-events:none;position:absolute;top:0;transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);left:0;right:auto;transform:translateX(0);width:calc(100% - var(--mdc-switch-handle-width))}[dir=rtl] .mdc-switch__handle-track{left:auto;right:0}.mdc-switch--selected .mdc-switch__handle-track{transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__handle-track{transform:translateX(-100%)}.mdc-switch__handle{display:flex;pointer-events:auto;position:absolute;top:50%;transform:translateY(-50%);left:0;right:auto;transition:width 75ms cubic-bezier(0.4, 0, 0.2, 1),height 75ms cubic-bezier(0.4, 0, 0.2, 1),margin 75ms cubic-bezier(0.4, 0, 0.2, 1);width:var(--mdc-switch-handle-width);height:var(--mdc-switch-handle-height);border-radius:var(--mdc-switch-handle-shape, var(--mat-app-corner-full))}[dir=rtl] .mdc-switch__handle{left:auto;right:0}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{width:var(--mat-switch-unselected-handle-size);height:var(--mat-switch-unselected-handle-size);margin:var(--mat-switch-unselected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-unselected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{width:var(--mat-switch-selected-handle-size);height:var(--mat-switch-selected-handle-size);margin:var(--mat-switch-selected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-selected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch__handle:has(.mdc-switch__icons){width:var(--mat-switch-with-icon-handle-size);height:var(--mat-switch-with-icon-handle-size)}.mat-mdc-slide-toggle .mdc-switch:active:not(.mdc-switch--disabled) .mdc-switch__handle{width:var(--mat-switch-pressed-handle-size);height:var(--mat-switch-pressed-handle-size)}.mat-mdc-slide-toggle .mdc-switch--selected:active:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-selected-pressed-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected:active:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-unselected-pressed-handle-horizontal-margin)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-selected-handle-opacity)}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-unselected-handle-opacity)}.mdc-switch__handle::before,.mdc-switch__handle::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";width:100%;height:100%;left:0;position:absolute;top:0;transition:background-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1),border-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);z-index:-1}.cdk-high-contrast-active .mdc-switch__handle::before,.cdk-high-contrast-active .mdc-switch__handle::after{border-color:currentColor}.mdc-switch--selected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-selected-handle-color, var(--mat-app-on-primary))}.mdc-switch--selected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-hover-handle-color, var(--mat-app-primary-container))}.mdc-switch--selected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-focus-handle-color, var(--mat-app-primary-container))}.mdc-switch--selected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-selected-pressed-handle-color, var(--mat-app-primary-container))}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled.mdc-switch--selected:hover:not(:focus):not(:active) .mdc-switch__handle::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled.mdc-switch--selected:focus:not(:active) .mdc-switch__handle::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled.mdc-switch--selected:active .mdc-switch__handle::after,.mdc-switch--selected.mdc-switch--disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-selected-handle-color, var(--mat-app-surface))}.mdc-switch--unselected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-unselected-handle-color, var(--mat-app-outline))}.mdc-switch--unselected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-hover-handle-color, var(--mat-app-on-surface-variant))}.mdc-switch--unselected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-focus-handle-color, var(--mat-app-on-surface-variant))}.mdc-switch--unselected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-unselected-pressed-handle-color, var(--mat-app-on-surface-variant))}.mdc-switch--unselected.mdc-switch--disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-unselected-handle-color, var(--mat-app-on-surface))}.mdc-switch__handle::before{background:var(--mdc-switch-handle-surface-color)}.mdc-switch__shadow{border-radius:inherit;bottom:0;left:0;position:absolute;right:0;top:0}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation-shadow)}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:hover:not(:focus):not(:active) .mdc-switch__shadow,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:focus:not(:active) .mdc-switch__shadow,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:active .mdc-switch__shadow,.mdc-switch.mdc-switch--disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation-shadow)}.mdc-switch__ripple{left:50%;position:absolute;top:50%;transform:translate(-50%, -50%);z-index:-1;width:var(--mdc-switch-state-layer-size);height:var(--mdc-switch-state-layer-size)}.mdc-switch__ripple::after{content:"";opacity:0}.mdc-switch--disabled .mdc-switch__ripple::after{display:none}.mat-mdc-slide-toggle-disabled-interactive .mdc-switch__ripple::after{display:block}.mdc-switch:hover .mdc-switch__ripple::after{opacity:.04;transition:75ms opacity cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mdc-switch .mdc-switch__ripple::after{opacity:.12}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:enabled:focus .mdc-switch__ripple::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:enabled:active .mdc-switch__ripple::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:enabled:hover:not(:focus) .mdc-switch__ripple::after,.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background:var(--mdc-switch-unselected-hover-state-layer-color, var(--mat-app-on-surface))}.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::after{background:var(--mdc-switch-unselected-focus-state-layer-color, var(--mat-app-on-surface))}.mdc-switch--unselected:enabled:active .mdc-switch__ripple::after{background:var(--mdc-switch-unselected-pressed-state-layer-color, var(--mat-app-on-surface));opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity));transition:opacity 75ms linear}.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background:var(--mdc-switch-selected-hover-state-layer-color, var(--mat-app-primary))}.mdc-switch--selected:enabled:focus .mdc-switch__ripple::after{background:var(--mdc-switch-selected-focus-state-layer-color, var(--mat-app-primary))}.mdc-switch--selected:enabled:active .mdc-switch__ripple::after{background:var(--mdc-switch-selected-pressed-state-layer-color, var(--mat-app-primary));opacity:var(--mdc-switch-selected-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity));transition:opacity 75ms linear}.mdc-switch__icons{position:relative;height:100%;width:100%;z-index:1}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__icons{opacity:var(--mdc-switch-disabled-unselected-icon-opacity)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__icons{opacity:var(--mdc-switch-disabled-selected-icon-opacity)}.mdc-switch__icon{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;opacity:0;transition:opacity 30ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-switch--unselected .mdc-switch__icon{width:var(--mdc-switch-unselected-icon-size);height:var(--mdc-switch-unselected-icon-size);fill:var(--mdc-switch-unselected-icon-color, var(--mat-app-surface-variant))}.mdc-switch--unselected.mdc-switch--disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-unselected-icon-color, var(--mat-app-surface-variant))}.mdc-switch--selected .mdc-switch__icon{width:var(--mdc-switch-selected-icon-size);height:var(--mdc-switch-selected-icon-size);fill:var(--mdc-switch-selected-icon-color, var(--mat-app-on-primary-container))}.mdc-switch--selected.mdc-switch--disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-selected-icon-color, var(--mat-app-on-surface))}.mdc-switch--selected .mdc-switch__icon--on,.mdc-switch--unselected .mdc-switch__icon--off{opacity:1;transition:opacity 45ms 30ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle{-webkit-user-select:none;user-select:none;display:inline-block;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple,.mat-mdc-slide-toggle .mdc-switch__ripple::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple:not(:empty),.mat-mdc-slide-toggle .mdc-switch__ripple::after:not(:empty){transform:translateZ(0)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mat-mdc-focus-indicator::before{content:""}.mat-mdc-slide-toggle .mat-internal-form-field{color:var(--mat-switch-label-text-color, var(--mat-app-on-surface));font-family:var(--mat-switch-label-text-font, var(--mat-app-body-medium-font));line-height:var(--mat-switch-label-text-line-height, var(--mat-app-body-medium-line-height));font-size:var(--mat-switch-label-text-size, var(--mat-app-body-medium-size));letter-spacing:var(--mat-switch-label-text-tracking, var(--mat-app-body-medium-tracking));font-weight:var(--mat-switch-label-text-weight, var(--mat-app-body-medium-weight))}.mat-mdc-slide-toggle .mat-ripple-element{opacity:.12}.mat-mdc-slide-toggle .mat-mdc-focus-indicator::before{border-radius:50%}.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle-track,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__icon,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::after,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::after{transition:none}.mat-mdc-slide-toggle .mdc-switch:enabled+.mdc-label{cursor:pointer}.mat-mdc-slide-toggle .mdc-switch--disabled+label{color:var(--mdc-switch-disabled-label-text-color)}'],encapsulation:2,changeDetection:0})}}return n})(),FBe=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({imports:[oR,R$,R$]})}}return n})(),LBe=(()=>{class n{constructor(){this.clsName="ccf-slide-toggle",this.labels=["Left","Right"],this.value="Left",this.disabled=!1,this.valueChange=new Ae}get left(){const{value:t,labels:i}=this;return t!==i[1]}updateToggle(t){this.value=t?this.labels[0]:this.labels[1],this.valueChange.emit(this.value)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Yt({type:n,selectors:[["ccf-slide-toggle"]],hostVars:2,hostBindings:function(i,r){2&i&&_d(r.clsName)},inputs:{labels:"labels",value:"value",disabled:"disabled"},outputs:{valueChange:"valueChange"},decls:6,vars:12,consts:[["toggle",""],[1,"slide-label",3,"click"],["hideIcon","",1,"slider",3,"change","disabled","checked"]],template:function(i,r){if(1&i){const s=ao();xe(0,"span",1),mt("click",function(){En(s);const a=py(3);return r.left||a.toggle(),Cn(r.updateToggle(!0))}),Ci(1),Ie(),xe(2,"mat-slide-toggle",2,0),mt("change",function(a){return En(s),Cn(r.updateToggle(!a.checked))}),Ie(),xe(4,"span",1),mt("click",function(){En(s);const a=py(3);return r.left&&a.toggle(),Cn(r.updateToggle(!1))}),Ci(5),Ie()}2&i&&(Sn("disabled",r.disabled)("highlighted",r.left),Xe(),Ka(" ",r.labels[0].charAt(0).toUpperCase()+r.labels[0].slice(1),"\n"),Xe(),Tt("disabled",r.disabled)("checked",!r.left),Xe(2),Sn("disabled",r.disabled)("highlighted",!r.left),Xe(),Ka(" ",r.labels[1].charAt(0).toUpperCase()+r.labels[1].slice(1),"\n"))},dependencies:[oR],styles:["[_nghost-%COMP%]   .slide-label[_ngcontent-%COMP%]{margin:0 1rem;transition:color .6s;cursor:pointer;opacity:50%}[_nghost-%COMP%]   .slide-label.highlighted[_ngcontent-%COMP%]{opacity:100%}[_nghost-%COMP%]   .disabled[_ngcontent-%COMP%]{opacity:30%!important;cursor:not-allowed}[_nghost-%COMP%]     .slider .mdc-switch__track:before, [_nghost-%COMP%]     .slider .mdc-switch__track:after{background-color:#43476580!important}[_nghost-%COMP%]     .slider .mdc-switch__shadow{background-color:#434765}"],changeDetection:0})}}return n})();const BBe=["bodyUI"],VBe=()=>["Male","Female"],UBe=()=>["Left","Right"];let jBe=(()=>{class n{constructor(t){this.ga=t,this.sexChange=new Ae,this.sideChange=new Ae,this.nodeClick=new Ae}ngAfterViewChecked(){this.updateHighlighting()}updateHighlighting(){const t=new Set(this.filter?.tmc??[]);this.filteredBlocks=this.blocks?.filter(i=>t.has(i.donor?.providerName??"")).map(i=>i["@id"])??[],this.bodyUI.scene=this.bodyUI.scene.map(i=>({...i,color:i.entityId&&this.highlightedNodeId===i["@id"]?[30,136,229,255]:this.filteredBlocks.includes(i.entityId??"")?[173,255,47,229.5]:[255,255,255,229.5]}))}ngOnChanges(t){this.bodyUI&&"organ"in t&&this.zoomToFitOrgan()}updateSex(t){this.sex=t,this.sexChange.emit(this.sex)}updateSide(t){this.side=t,this.sideChange.emit(this.side)}zoomToFitOrgan(){const{bodyUI:t,organ:i}=this;if(i){const{x_dimension:r,y_dimension:s,z_dimension:o}=i;t.rotation=t.rotationX=0,t.bounds={x:1.25*r/1e3,y:1.25*s/1e3,z:1.25*o/1e3},t.target=[r/1e3/2,s/1e3/2,o/1e3/2]}}nodeClicked(t){this.ga.event("node_click","organ",t.node["@id"]),this.highlightedNodeId=this.highlightedNodeId&&this.highlightedNodeId===t.node["@id"]?"":t.node["@id"],this.nodeClick.emit(t)}static{this.\u0275fac=function(i){return new(i||n)(R(Ch))}}static{this.\u0275cmp=Yt({type:n,selectors:[["ccf-organ"]],viewQuery:function(i,r){if(1&i&&ea(BBe,7),2&i){let s;Ns(s=ks())&&(r.bodyUI=s.first)}},inputs:{organ:"organ",scene:"scene",organIri:"organIri",sex:"sex",side:"side",blocks:"blocks",filter:"filter"},outputs:{sexChange:"sexChange",sideChange:"sideChange",nodeClick:"nodeClick"},features:[Kn],decls:5,vars:10,consts:[["bodyUI",""],["camera","perspective",1,"body-ui",3,"nodeClick","initialized","scene","interactive"],[1,"stage-options"],[1,"view-slider",3,"valueChange","labels","value","hidden"]],template:function(i,r){if(1&i){const s=ao();xe(0,"ccf-body-ui",1,0),mt("nodeClick",function(a){return En(s),Cn(r.nodeClicked(a))})("initialized",function(){return En(s),Cn(r.zoomToFitOrgan())}),Ie(),xe(2,"div",2)(3,"ccf-slide-toggle",3),mt("valueChange",function(a){return En(s),Cn(r.updateSex(a))}),Ie(),xe(4,"ccf-slide-toggle",3),mt("valueChange",function(a){return En(s),Cn(r.updateSide(a))}),Ie()()}2&i&&(Tt("scene",r.scene)("interactive",!0),Xe(3),Tt("labels",vd(8,VBe))("value",r.sex)("hidden",!r.sex),Xe(),Tt("labels",vd(9,UBe))("value",r.side)("hidden",!r.side))},dependencies:[JSe,LBe],styles:["[_nghost-%COMP%]{display:block;background-color:#000;border-radius:.5rem;color:#fff;height:100%}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{height:90%}[_nghost-%COMP%]   .stage-options[_ngcontent-%COMP%]{padding:1rem;min-width:352px}"],changeDetection:0})}}return n})();const HBe=["left"],zBe=["right"],aR=()=>[],GBe=[{color:[0,0,0,0],opacity:.001}];let WBe=(()=>{class n{constructor(t,i,r){this.ga=i,this.configState=r,this.sexChange=new Ae,this.sideChange=new Ae,this.nodeClicked=new Ae,this.sex$=this.configState.getOption("sex"),this.side$=this.configState.getOption("side"),this.filter$=this.configState.getOption("highlightProviders").pipe(le(s=>({tmc:s??[]}))),this.donorLabel$=this.configState.getOption("donorLabel"),this.ruiUrl$=this.configState.getOption("ruiUrl"),this.euiUrl$=this.configState.getOption("euiUrl"),this.asctbUrl$=this.configState.getOption("asctbUrl"),this.hraPortalUrl$=this.configState.getOption("hraPortalUrl"),this.onlineCourseUrl$=this.configState.getOption("onlineCourseUrl"),this.paperUrl$=this.configState.getOption("paperUrl"),this.stats=[],this.latestConfig={},this.organInfo$=r.config$.pipe(Nt(s=>this.latestConfig=s),pn(s=>t.getOrganInfo(s.organIri??"",s.side?.toLowerCase?.(),s.sex)),Nt(s=>this.logOrganLookup(s)),Nt(s=>this.latestOrganInfo=s),ps(1)),this.organ$=this.organInfo$.pipe(pn(s=>s?t.getOrgan(s,s.hasSex?this.latestConfig.sex:void 0):ee(void 0)),Nt(s=>{if(s&&this.latestOrganInfo){const o=this.latestOrganInfo?.hasSex?s.sex:void 0;o!==this.latestConfig.sex&&this.updateInput("sex",o),s.side!==this.latestConfig.side&&this.updateInput("side",s.side)}}),ps(1)),this.scene$=this.organ$.pipe(pn(s=>s&&this.latestOrganInfo?t.getOrganScene(this.latestOrganInfo,s.sex):ee(GBe))),this.stats$=Hb([this.organ$,this.donorLabel$]).pipe(pn(([s,o])=>s&&this.latestOrganInfo?t.getOrganStats(this.latestOrganInfo,s.sex).pipe(le(a=>a.map(c=>o&&"Donors"===c.label?{...c,label:o}:c))):ee([]))),this.statsLabel$=this.organ$.pipe(le(s=>this.makeStatsLabel(this.latestOrganInfo,s?.sex)),xc("Loading...")),this.blocks$=this.organ$.pipe(pn(s=>s&&this.latestOrganInfo?t.getBlocks(this.latestOrganInfo,s.sex):ee([])))}ngAfterViewInit(){const{left:t,right:i}=this;t.nativeElement.style.height=`${i.nativeElement.offsetHeight}px`}updateInput(t,i){this.configState.patchConfig({[t]:i})}makeStatsLabel(t,i){let r=[`Unknown IRI: ${this.latestConfig.organIri}`];if(t){const s=t.side?t.side.charAt(0).toUpperCase()+t.side.slice(1):void 0;r=[i,t.organ,s]}return r.filter(s=>!!s).join(", ")}logOrganLookup(t){this.ga.event(t?"organ_lookup_success":"organ_lookup_failure","organ",`Iri: ${this.latestConfig.organIri} - Sex: ${this.latestConfig.sex} - Side: ${this.latestConfig.side}`)}static{this.\u0275fac=function(i){return new(i||n)(R(sLe),R(Ch),R(Wl))}}static{this.\u0275cmp=Yt({type:n,selectors:[["ccf-root"]],viewQuery:function(i,r){if(1&i&&(ea(HBe,7,At),ea(zBe,7,At)),2&i){let s;Ns(s=ks())&&(r.left=s.first),Ns(s=ks())&&(r.right=s.first)}},hostAttrs:[1,"hra-app"],outputs:{sexChange:"sexChange",sideChange:"sideChange",nodeClicked:"nodeClicked"},decls:22,vars:45,consts:[["left",""],["right",""],[1,"container"],[1,"left"],[3,"sexChange","nodeClick","sideChange","blocks","filter","sex","side","organ","scene"],[1,"right"],[3,"statsLabel","stats"],[3,"ruiUrl","euiUrl","asctbUrl","hraPortalUrl","onlineCourseUrl","paperUrl"]],template:function(i,r){if(1&i){const s=ao();xe(0,"div",2)(1,"div",3,0)(3,"ccf-organ",4),Mn(4,"async"),Mn(5,"async"),Mn(6,"async"),Mn(7,"async"),Mn(8,"async"),Mn(9,"async"),mt("sexChange",function(a){return En(s),r.updateInput("sex",a),Cn(r.sexChange.emit(a))})("nodeClick",function(a){return En(s),Cn(r.nodeClicked.emit(a))})("sideChange",function(a){return En(s),r.updateInput("side",a),Cn(r.sideChange.emit(a))}),Ie()(),xe(10,"div",5,1),Ei(12,"ccf-stats-list",6),Mn(13,"async"),Mn(14,"async"),Ei(15,"ccf-link-cards",7),Mn(16,"async"),Mn(17,"async"),Mn(18,"async"),Mn(19,"async"),Mn(20,"async"),Mn(21,"async"),Ie()()}if(2&i){let s,o,a,c,l,u,d,h,f,p,g;Xe(3),Tt("blocks",null!==(s=In(4,14,r.blocks$))&&void 0!==s?s:vd(42,aR))("filter",In(5,16,r.filter$))("sex",In(6,18,r.sex$))("side",In(7,20,r.side$))("organ",null!==(o=In(8,22,r.organ$))&&void 0!==o?o:void 0)("scene",null!==(a=In(9,24,r.scene$))&&void 0!==a?a:vd(43,aR)),Xe(9),Tt("statsLabel",null!==(c=In(13,26,r.statsLabel$))&&void 0!==c?c:"")("stats",null!==(l=In(14,28,r.stats$))&&void 0!==l?l:vd(44,aR)),Xe(3),Tt("ruiUrl",null!==(u=In(16,30,r.ruiUrl$))&&void 0!==u?u:"")("euiUrl",null!==(d=In(17,32,r.euiUrl$))&&void 0!==d?d:"")("asctbUrl",null!==(h=In(18,34,r.asctbUrl$))&&void 0!==h?h:"")("hraPortalUrl",null!==(f=In(19,36,r.hraPortalUrl$))&&void 0!==f?f:"")("onlineCourseUrl",null!==(p=In(20,38,r.onlineCourseUrl$))&&void 0!==p?p:"")("paperUrl",null!==(g=In(21,40,r.paperUrl$))&&void 0!==g?g:"")}},dependencies:[cLe,uLe,jBe,qy],styles:['.container[_ngcontent-%COMP%]{height:fit-content;display:flex;flex-direction:row;padding:1rem;font-family:var(--ccf-ui-font, ""),Inter,Inter Variable,sans-serif;font-size:.95rem;line-height:1.5;text-align:left;position:relative;background-color:#fff;color:#000}.container[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{width:auto;flex-grow:1}.container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{margin-left:2rem;height:fit-content;width:29rem}'],changeDetection:0})}}return n})();function $Be(n,e){if(1&n){const t=ao();xe(0,"ccf-root",1),mt("sexChange",function(r){return En(t),Cn(Ps().sexChange.emit(r))})("nodeClicked",function(r){return En(t),Cn(Ps().nodeClicked.emit(r))})("sideChange",function(r){return En(t),Cn(Ps().sideChange.emit(r))}),Ie()}}function qBe(n){const e=i=>"string"==typeof i,t=i=>Array.isArray(i)&&i.every(e);if("string"==typeof n){const i=xW_json(n);if(t(i))return i}else if(t(n))return n;throw new Error("Invalid data sources")}function XBe(n){const e=i=>"string"==typeof i,t=i=>Array.isArray(i)&&i.every(e);if("string"==typeof n){if(!n?.startsWith("["))return[n];{const i=xW_json(n);if(t(i))return i}}else if(t(n))return n;throw new Error("Invalid data sources")}let YBe=(()=>{class n extends rLe{constructor(t,i){super(t,i,{initialDelay:10,initialConfig:{...Oh_dbOptions,...globalThis.dbOptions},parse:{dataSources:qBe,highlightProviders:XBe}}),this.sex="Female",this.side="Left",this.sexChange=new Ae,this.sideChange=new Ae,this.nodeClicked=new Ae}static{this.\u0275fac=function(i){return new(i||n)(R(Wl),R(br))}}static{this.\u0275cmp=Yt({type:n,selectors:[["ccf-root-wc"]],inputs:{organIri:"organIri",sex:"sex",side:"side",dataSources:"dataSources",highlightProviders:"highlightProviders",token:"token",remoteApiEndpoint:"remoteApiEndpoint",donorLabel:"donorLabel",ruiUrl:"ruiUrl",euiUrl:"euiUrl",asctbUrl:"asctbUrl",hraPortalUrl:"hraPortalUrl",onlineCourseUrl:"onlineCourseUrl",paperUrl:"paperUrl"},outputs:{sexChange:"sexChange",sideChange:"sideChange",nodeClicked:"nodeClicked"},features:[st],decls:1,vars:1,consts:[[3,"sexChange","nodeClicked","sideChange",4,"ngIf"],[3,"sexChange","nodeClicked","sideChange"]],template:function(i,r){1&i&&er(0,$Be,1,0,"ccf-root",0),2&i&&Tt("ngIf",r.initialized)},dependencies:[fT,WBe],encapsulation:2,changeDetection:0})}}return n})();class ZBe{constructor(e){this.options=e,this.options=this.options||{},this.logger=e.logger||console}startGroup(e){const t=this.options.collapsed?this.logger.groupCollapsed:this.logger.group;try{t.call(this.logger,e)}catch{console.log(e)}}endGroup(){try{this.logger.groupEnd()}catch{this.logger.log("\u2014\u2014 log end \u2014\u2014")}}logGrey(e,t){this.log(e,"color: #9E9E9E; font-weight: bold",t)}logGreen(e,t){this.log(e,"color: #4CAF50; font-weight: bold",t)}logRedish(e,t){this.log(e,"color: #FD8182; font-weight: bold",t)}log(e,t,i){this.logger.log("%c "+e,t,i)}}const sw=(n,e)=>((n,e)=>new Array(e+1).join("0"))(0,e-n.toString().length)+n;class QBe{constructor(e,t,i){this.action=e,this.store=t,this.logWriter=i}dispatched(e){const t=Gl(this.action),i=function JBe(n){return sw(n.getHours(),2)+":"+sw(n.getMinutes(),2)+":"+sw(n.getSeconds(),2)+"."+sw(n.getMilliseconds(),3)}(new Date);this.logWriter.startGroup(`action ${t} @ ${i}`),this._hasPayload(this.action)&&this.logWriter.logGrey("payload",{...this.action}),this.logWriter.logGrey("prev state",e)}completed(e){this.logWriter.logGreen("next state",e),this.logWriter.endGroup()}errored(e){this.logWriter.logRedish("next state after error",this.store.snapshot()),this.logWriter.logRedish("error",e),this.logWriter.endGroup()}_hasPayload(e){return this._getNonEmptyProperties(e).length>0}_getNonEmptyProperties(e){return Object.keys(e).map(r=>e[r]).filter(r=>void 0!==r)}}const cR=new k("NGXS_LOGGER_PLUGIN_OPTIONS");let B$=(()=>{class n{constructor(){this._options=D(cR),this._injector=D(gt)}handle(t,i,r){if(this._options.disabled||this._skipLogging(t,i))return r(t,i);this._logWriter||=new ZBe(this._options),this._store||=this._injector.get(gs);const s=new QBe(i,this._store,this._logWriter);return s.dispatched(t),r(t,i).pipe(Nt(o=>{s.completed(o)}),Io(o=>{throw s.errored(o),o}))}_skipLogging(t,i){return!es(this._injector,()=>this._options.filter(i,t))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac})}}return n})();const ow=new k("LOGGER_USER_OPTIONS");function V$(n){return{logger:console,collapsed:!1,disabled:!1,filter:()=>!0,...n}}let e2e=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[BIe(B$),{provide:ow,useValue:t},{provide:cR,useFactory:V$,deps:[ow]}]}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({})}}return n})();const t2e=[Wl];let n2e=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({imports:[gDe.forRoot(),SIe.forRoot(t2e,{developmentMode:!1}),e2e.forRoot({disabled:true})]})}}return n})(),i2e=(()=>{class n{constructor(t){if(t)throw new Error("The core module should only be imported once in the root module")}static{this.\u0275fac=function(i){return new(i||n)(O(n,12))}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({providers:[{provide:t6,useExisting:di},IOe(Kl(Dc.LegacyInterceptors,[{provide:y6,useFactory:yOe},{provide:Jg,useExisting:y6,multi:!0}]))],imports:[nOe.forRoot({gaToken:"G-ERNVZ1Q4KE",appName:"organ-info",projectName:"ccf",developmentMode:!1}),jOe.forRoot(()=>new Rc({basePath:Oh_dbOptions.remoteApiEndpoint})),n2e]})}}return n})(),r2e=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({imports:[Cd,FBe]})}}return n})(),s2e=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({imports:[Cd,$ae,r2e]})}}return n})(),o2e=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({imports:[Cd,GD]})}}return n})(),a2e=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({imports:[Cd]})}}return n})();!function Wae(){DT.apply(this,arguments)}("ccf-organ-info",YBe,{providers:[ZR((()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=fn({type:n})}static{this.\u0275inj=ln({imports:[Aae,i2e,o2e,a2e,s2e]})}}return n})())]})},123:(Di,ri,at)=>{Di.exports={ResizeSensor:at(718),ElementQueries:at(240)}},240:function(Di,ri,at){"use strict";var yn,zt,hn;typeof window<"u"&&window,zt=[at(718)],void 0!==(hn="function"==typeof(yn=function(si){var ve=function(){var Se,Ze={},Te=[];function Ue(Z){Z||(Z=document.documentElement);var J=window.getComputedStyle(Z,null).fontSize;return parseFloat(J)||16}function K(Z,J){var De=J.split(/\d/),Re=De[De.length-1];switch(J=parseFloat(J),Re){case"px":default:return J;case"em":return J*Ue(Z);case"rem":return J*Ue();case"vw":return J*document.documentElement.clientWidth/100;case"vh":return J*document.documentElement.clientHeight/100;case"vmin":case"vmax":var ze=document.documentElement.clientWidth/100,Rt=document.documentElement.clientHeight/100;return J*(0,Math["vmin"===Re?"min":"max"])(ze,Rt)}}function z(Z,J){this.element=Z;var De,Re,ze,Rt,cn,Gt,vn,oi,pi=["min-width","min-height","max-width","max-height"];this.call=function(){for(De in ze=function re(Z){if(!Z.getBoundingClientRect)return{width:Z.offsetWidth,height:Z.offsetHeight};var J=Z.getBoundingClientRect();return{width:Math.round(J.width),height:Math.round(J.height)}}(this.element),Gt={},Ze[J])Ze[J].hasOwnProperty(De)&&(Rt=K(this.element,(Re=Ze[J][De]).value),cn="width"===Re.property?ze.width:ze.height,vn="","min"===Re.mode&&cn>=Rt&&(vn+=Re.value),"max"===Re.mode&&cn<=Rt&&(vn+=Re.value),Gt[oi=Re.mode+"-"+Re.property]||(Gt[oi]=""),vn&&-1===(" "+Gt[oi]+" ").indexOf(" "+vn+" ")&&(Gt[oi]+=" "+vn));for(var ai in pi)pi.hasOwnProperty(ai)&&(Gt[pi[ai]]?this.element.setAttribute(pi[ai],Gt[pi[ai]].substr(1)):this.element.removeAttribute(pi[ai]))}}function Ke(Z,J){Z.elementQueriesSetupInformation||(Z.elementQueriesSetupInformation=new z(Z,J)),Z.elementQueriesSensor||(Z.elementQueriesSensor=new si(Z,function(){Z.elementQueriesSetupInformation.call()}))}function ct(Z,J,De,Re){if(typeof Ze[Z]>"u"){Ze[Z]=[];var ze=Te.length;Se.innerHTML+="\n"+Z+" {animation: 0.1s element-queries;}",Se.innerHTML+="\n"+Z+" > .resize-sensor {min-width: "+ze+"px;}",Te.push(Z)}Ze[Z].push({mode:J,property:De,value:Re})}function he(Z){var J;if(document.querySelectorAll&&(J=Z?Z.querySelectorAll.bind(Z):document.querySelectorAll.bind(document)),!J&&typeof $$<"u"&&(J=$$),!J&&typeof jQuery<"u"&&(J=jQuery),!J)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return J}function gn(Z){var J=[],De=[],Re=[],ze=0,Rt=-1,cn=[];for(var Gt in Z.children)if(Z.children.hasOwnProperty(Gt)&&Z.children[Gt].tagName&&"img"===Z.children[Gt].tagName.toLowerCase()){J.push(Z.children[Gt]);var vn=Z.children[Gt].getAttribute("min-width")||Z.children[Gt].getAttribute("data-min-width"),oi=Z.children[Gt].getAttribute("data-src")||Z.children[Gt].getAttribute("url");Re.push(oi),De.push({minWidth:vn}),vn?Z.children[Gt].style.display="none":(ze=J.length-1,Z.children[Gt].style.display="block")}function ai(){var Ri,bt=!1;for(Ri in J)J.hasOwnProperty(Ri)&&De[Ri].minWidth&&Z.offsetWidth>De[Ri].minWidth&&(bt=Ri);if(bt||(bt=ze),Rt!==bt)if(cn[bt])J[Rt].style.display="none",J[bt].style.display="block",Rt=bt;else{var Ir=new Image;Ir.onload=function(){J[bt].src=Re[bt],J[Rt].style.display="none",J[bt].style.display="block",cn[bt]=!0,Rt=bt},Ir.src=Re[bt]}else J[bt].src=Re[bt]}Rt=ze,Z.resizeSensorInstance=new si(Z,ai),ai()}var Gn=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,Mr=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function fi(Z){var J,De,Re,ze;for(Z=Z.replace(/'/g,'"');null!==(J=Gn.exec(Z));)for(De=J[1]+J[3],Re=J[2];null!==(ze=Mr.exec(Re));)ct(De,ze[1],ze[2],ze[3])}function $i(Z){var J="";if(Z)if("string"==typeof Z)(-1!==(Z=Z.toLowerCase()).indexOf("min-width")||-1!==Z.indexOf("max-width"))&&fi(Z);else for(var De=0,Re=Z.length;De<Re;De++)1===Z[De].type?(-1!==(J=Z[De].selectorText||Z[De].cssText).indexOf("min-height")||-1!==J.indexOf("max-height")||-1!==J.indexOf("min-width")||-1!==J.indexOf("max-width"))&&fi(J):4===Z[De].type?$i(Z[De].cssRules||Z[De].rules):3===Z[De].type&&Z[De].styleSheet.hasOwnProperty("cssRules")&&$i(Z[De].styleSheet.cssRules)}var qi=!1;this.init=function(){var Z="animationstart";typeof document.documentElement.style.webkitAnimationName<"u"?Z="webkitAnimationStart":typeof document.documentElement.style.MozAnimationName<"u"?Z="mozanimationstart":typeof document.documentElement.style.OAnimationName<"u"&&(Z="oanimationstart"),document.body.addEventListener(Z,function(Re){var ze=Re.target,Rt=ze&&window.getComputedStyle(ze,null),cn=Rt&&Rt.getPropertyValue("animation-name");if(cn&&-1!==cn.indexOf("element-queries")){ze.elementQueriesSensor=new si(ze,function(){ze.elementQueriesSetupInformation&&ze.elementQueriesSetupInformation.call()});var oi=window.getComputedStyle(ze.resizeSensor,null).getPropertyValue("min-width");oi=parseInt(oi.replace("px","")),Ke(Re.target,Te[oi])}}),qi||((Se=document.createElement("style")).type="text/css",Se.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",Se.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(Se),qi=!0);for(var J=0,De=document.styleSheets.length;J<De;J++)try{document.styleSheets[J].href&&0===document.styleSheets[J].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[J].href),$i(document.styleSheets[J].cssRules||document.styleSheets[J].rules||document.styleSheets[J].cssText)}catch{}!function Dt(){for(var J=he()("[data-responsive-image],[responsive-image]"),De=0,Re=J.length;De<Re;De++)gn(J[De])}()},this.findElementQueriesElements=function(Z){!function Mt(Z){var J=he(Z);for(var De in Ze)if(Ze.hasOwnProperty(De))for(var Re=J(De,Z),ze=0,Rt=Re.length;ze<Rt;ze++)Ke(Re[ze],De)}(Z)},this.update=function(){this.init()}};ve.update=function(){ve.instance.update()},ve.detach=function(Se){Se.elementQueriesSetupInformation?(Se.elementQueriesSensor.detach(),delete Se.elementQueriesSetupInformation,delete Se.elementQueriesSensor):Se.resizeSensorInstance&&(Se.resizeSensorInstance.detach(),delete Se.resizeSensorInstance)},ve.init=function(){ve.instance||(ve.instance=new ve),ve.instance.init()};return ve.findElementQueriesElements=function(Se){ve.instance.findElementQueriesElements(Se)},ve.listen=function(){!function(Se){if(document.addEventListener)document.addEventListener("DOMContentLoaded",Se,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var Ze=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(Se(),clearInterval(Ze))},10);else window.onload=Se}(ve.init)},ve})?yn.apply(ri,zt):yn)&&(Di.exports=hn)},718:function(Di,ri,at){"use strict";var yn,zt;typeof window<"u"&&window,void 0!==(zt="function"==typeof(yn=function(){if(typeof window>"u")return null;var hn=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")(),si=hn.requestAnimationFrame||hn.mozRequestAnimationFrame||hn.webkitRequestAnimationFrame||function(re){return hn.setTimeout(re,20)},ve=hn.cancelAnimationFrame||hn.mozCancelAnimationFrame||hn.webkitCancelAnimationFrame||function(re){hn.clearTimeout(re)};function vt(re,K){var z=Object.prototype.toString.call(re),Ke="[object Array]"===z||"[object NodeList]"===z||"[object HTMLCollection]"===z||"[object Object]"===z||typeof jQuery<"u"&&re instanceof jQuery||typeof Elements<"u"&&re instanceof Elements,ct=0,he=re.length;if(Ke)for(;ct<he;ct++)K(re[ct]);else K(re)}function Se(re){if(!re.getBoundingClientRect)return{width:re.offsetWidth,height:re.offsetHeight};var K=re.getBoundingClientRect();return{width:Math.round(K.width),height:Math.round(K.height)}}function Ze(re,K){Object.keys(K).forEach(function(z){re.style[z]=K[z]})}var Te=function(re,K){var z=0;function Ke(){var Mt,gn,he=[];this.add=function(Dt){he.push(Dt)},this.call=function(Dt){for(Mt=0,gn=he.length;Mt<gn;Mt++)he[Mt].call(this,Dt)},this.remove=function(Dt){var Gn=[];for(Mt=0,gn=he.length;Mt<gn;Mt++)he[Mt]!==Dt&&Gn.push(he[Mt]);he=Gn},this.length=function(){return he.length}}function ct(he,Mt){if(he){if(he.resizedAttached)return void he.resizedAttached.add(Mt);he.resizedAttached=new Ke,he.resizedAttached.add(Mt),he.resizeSensor=document.createElement("div"),he.resizeSensor.dir="ltr",he.resizeSensor.className="resize-sensor";var gn={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},Dt={position:"absolute",left:"0px",top:"0px",transition:"0s"};Ze(he.resizeSensor,gn);var Gn=document.createElement("div");Gn.className="resize-sensor-expand",Ze(Gn,gn);var Mr=document.createElement("div");Ze(Mr,Dt),Gn.appendChild(Mr);var fi=document.createElement("div");fi.className="resize-sensor-shrink",Ze(fi,gn);var $i=document.createElement("div");Ze($i,Dt),Ze($i,{width:"200%",height:"200%"}),fi.appendChild($i),he.resizeSensor.appendChild(Gn),he.resizeSensor.appendChild(fi),he.appendChild(he.resizeSensor);var qi=window.getComputedStyle(he),Z=qi?qi.getPropertyValue("position"):null;"absolute"!==Z&&"relative"!==Z&&"fixed"!==Z&&"sticky"!==Z&&(he.style.position="relative");var J=!1,De=0,Re=Se(he),ze=0,Rt=0,cn=!0;z=0;var vn=function(){if(cn){if(0===he.offsetWidth&&0===he.offsetHeight)return void(z||(z=si(function(){z=0,vn()})));cn=!1}var bt,Ri;Ri=he.offsetHeight,Mr.style.width=(bt=he.offsetWidth)+10+"px",Mr.style.height=Ri+10+"px",Gn.scrollLeft=bt+10,Gn.scrollTop=Ri+10,fi.scrollLeft=bt+10,fi.scrollTop=Ri+10};he.resizeSensor.resetSensor=vn;var oi=function(){De=0,J&&(ze=Re.width,Rt=Re.height,he.resizedAttached&&he.resizedAttached.call(Re))},pi=function(){Re=Se(he),(J=Re.width!==ze||Re.height!==Rt)&&!De&&(De=si(oi)),vn()},ai=function(bt,Ri,Ir){bt.attachEvent?bt.attachEvent("on"+Ri,Ir):bt.addEventListener(Ri,Ir)};ai(Gn,"scroll",pi),ai(fi,"scroll",pi),z=si(function(){z=0,vn()})}}vt(re,function(he){ct(he,K)}),this.detach=function(he){z||(ve(z),z=0),Te.detach(re,he)},this.reset=function(){re.resizeSensor.resetSensor()}};if(Te.reset=function(re){vt(re,function(K){K.resizeSensor.resetSensor()})},Te.detach=function(re,K){vt(re,function(z){z&&(z.resizedAttached&&"function"==typeof K&&(z.resizedAttached.remove(K),z.resizedAttached.length())||z.resizeSensor&&(z.contains(z.resizeSensor)&&z.removeChild(z.resizeSensor),delete z.resizeSensor,delete z.resizedAttached))})},typeof MutationObserver<"u"){var Ue=new MutationObserver(function(re){for(var K in re)if(re.hasOwnProperty(K))for(var z=re[K].addedNodes,Ke=0;Ke<z.length;Ke++)z[Ke].resizeSensor&&Te.reset(z[Ke])});document.addEventListener("DOMContentLoaded",function(re){Ue.observe(document.body,{childList:!0,subtree:!0})})}return Te})?yn.call(ri,at,ri,Di):yn)&&(Di.exports=zt)},511:(Di,ri,at)=>{var yn;!function(zt,hn,si,ve){"use strict";var he,vt=["","webkit","Moz","MS","ms","o"],Se=hn.createElement("div"),Ze="function",Te=Math.round,Ue=Math.abs,re=Date.now;function K(C,T,M){return setTimeout(Gn(C,M),T)}function z(C,T,M){return!!Array.isArray(C)&&(Ke(C,M[T],M),!0)}function Ke(C,T,M){var N;if(C)if(C.forEach)C.forEach(T,M);else if(C.length!==ve)for(N=0;N<C.length;)T.call(M,C[N],N,C),N++;else for(N in C)C.hasOwnProperty(N)&&T.call(M,C[N],N,C)}function ct(C,T,M){var N="DEPRECATED METHOD: "+T+"\n"+M+" AT \n";return function(){var q=new Error("get-stack-trace"),oe=q&&q.stack?q.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Je=zt.console&&(zt.console.warn||zt.console.log);return Je&&Je.call(zt.console,N,oe),C.apply(this,arguments)}}he="function"!=typeof Object.assign?function(T){if(T===ve||null===T)throw new TypeError("Cannot convert undefined or null to object");for(var M=Object(T),N=1;N<arguments.length;N++){var q=arguments[N];if(q!==ve&&null!==q)for(var oe in q)q.hasOwnProperty(oe)&&(M[oe]=q[oe])}return M}:Object.assign;var Mt=ct(function(T,M,N){for(var q=Object.keys(M),oe=0;oe<q.length;)(!N||N&&T[q[oe]]===ve)&&(T[q[oe]]=M[q[oe]]),oe++;return T},"extend","Use `assign`."),gn=ct(function(T,M){return Mt(T,M,!0)},"merge","Use `assign`.");function Dt(C,T,M){var q,N=T.prototype;(q=C.prototype=Object.create(N)).constructor=C,q._super=N,M&&he(q,M)}function Gn(C,T){return function(){return C.apply(T,arguments)}}function Mr(C,T){return typeof C==Ze?C.apply(T&&T[0]||ve,T):C}function fi(C,T){return C===ve?T:C}function $i(C,T,M){Ke(De(T),function(N){C.addEventListener(N,M,!1)})}function qi(C,T,M){Ke(De(T),function(N){C.removeEventListener(N,M,!1)})}function Z(C,T){for(;C;){if(C==T)return!0;C=C.parentNode}return!1}function J(C,T){return C.indexOf(T)>-1}function De(C){return C.trim().split(/\s+/g)}function Re(C,T,M){if(C.indexOf&&!M)return C.indexOf(T);for(var N=0;N<C.length;){if(M&&C[N][M]==T||!M&&C[N]===T)return N;N++}return-1}function ze(C){return Array.prototype.slice.call(C,0)}function Rt(C,T,M){for(var N=[],q=[],oe=0;oe<C.length;){var Je=T?C[oe][T]:C[oe];Re(q,Je)<0&&N.push(C[oe]),q[oe]=Je,oe++}return M&&(N=T?N.sort(function($n,_i){return $n[T]>_i[T]}):N.sort()),N}function cn(C,T){for(var M,N,q=T[0].toUpperCase()+T.slice(1),oe=0;oe<vt.length;){if((N=(M=vt[oe])?M+q:T)in C)return N;oe++}return ve}var Gt=1;function oi(C){var T=C.ownerDocument||C;return T.defaultView||T.parentWindow||zt}var ai="ontouchstart"in zt,bt=cn(zt,"PointerEvent")!==ve,Ri=ai&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Ir="touch",lu="mouse",uu=25,gi=1,bn=4,mi=8,du=1,hu=2,Vc=4,Uc=8,jc=16,ur=hu|Vc,Vo=Uc|jc,lw=ur|Vo,$e=["x","y"],Da=["clientX","clientY"];function Oi(C,T){var M=this;this.manager=C,this.callback=T,this.element=C.element,this.target=C.options.inputTarget,this.domHandler=function(N){Mr(C.options.enable,[C])&&M.handler(N)},this.init()}function kt(C,T,M){var N=M.pointers.length,q=M.changedPointers.length,oe=T&gi&&N-q==0,Je=T&(bn|mi)&&N-q==0;M.isFirst=!!oe,M.isFinal=!!Je,oe&&(C.session={}),M.eventType=T,function ym(C,T){var M=C.session,N=T.pointers,q=N.length;M.firstInput||(M.firstInput=Zr(T)),q>1&&!M.firstMultiple?M.firstMultiple=Zr(T):1===q&&(M.firstMultiple=!1);var oe=M.firstInput,Je=M.firstMultiple,Wn=Je?Je.center:oe.center,$n=T.center=Hc(N);T.timeStamp=re(),T.deltaTime=T.timeStamp-oe.timeStamp,T.angle=Vh(Wn,$n),T.distance=pu(Wn,$n),function vm(C,T){var M=T.center,N=C.offsetDelta||{},q=C.prevDelta||{},oe=C.prevInput||{};(T.eventType===gi||oe.eventType===bn)&&(q=C.prevDelta={x:oe.deltaX||0,y:oe.deltaY||0},N=C.offsetDelta={x:M.x,y:M.y}),T.deltaX=q.x+(M.x-N.x),T.deltaY=q.y+(M.y-N.y)}(M,T),T.offsetDirection=zc(T.deltaX,T.deltaY);var _i=Bh(T.deltaTime,T.deltaX,T.deltaY);T.overallVelocityX=_i.x,T.overallVelocityY=_i.y,T.overallVelocity=Ue(_i.x)>Ue(_i.y)?_i.x:_i.y,T.scale=Je?function Uh(C,T){return pu(T[0],T[1],Da)/pu(C[0],C[1],Da)}(Je.pointers,N):1,T.rotation=Je?function uw(C,T){return Vh(T[1],T[0],Da)+Vh(C[1],C[0],Da)}(Je.pointers,N):0,T.maxPointers=M.prevInput?T.pointers.length>M.prevInput.maxPointers?T.pointers.length:M.prevInput.maxPointers:T.pointers.length,function bm(C,T){var q,oe,Je,Wn,M=C.lastInterval||T,N=T.timeStamp-M.timeStamp;if(T.eventType!=mi&&(N>uu||M.velocity===ve)){var $n=T.deltaX-M.deltaX,_i=T.deltaY-M.deltaY,Qr=Bh(N,$n,_i);oe=Qr.x,Je=Qr.y,q=Ue(Qr.x)>Ue(Qr.y)?Qr.x:Qr.y,Wn=zc($n,_i),C.lastInterval=T}else q=M.velocity,oe=M.velocityX,Je=M.velocityY,Wn=M.direction;T.velocity=q,T.velocityX=oe,T.velocityY=Je,T.direction=Wn}(M,T);var Qr=C.element;Z(T.srcEvent.target,Qr)&&(Qr=T.srcEvent.target),T.target=Qr}(C,M),C.emit("hammer.input",M),C.recognize(M),C.session.prevInput=M}function Zr(C){for(var T=[],M=0;M<C.pointers.length;)T[M]={clientX:Te(C.pointers[M].clientX),clientY:Te(C.pointers[M].clientY)},M++;return{timeStamp:re(),pointers:T,center:Hc(T),deltaX:C.deltaX,deltaY:C.deltaY}}function Hc(C){var T=C.length;if(1===T)return{x:Te(C[0].clientX),y:Te(C[0].clientY)};for(var M=0,N=0,q=0;q<T;)M+=C[q].clientX,N+=C[q].clientY,q++;return{x:Te(M/T),y:Te(N/T)}}function Bh(C,T,M){return{x:T/C||0,y:M/C||0}}function zc(C,T){return C===T?du:Ue(C)>=Ue(T)?C<0?hu:Vc:T<0?Uc:jc}function pu(C,T,M){M||(M=$e);var N=T[M[0]]-C[M[0]],q=T[M[1]]-C[M[1]];return Math.sqrt(N*N+q*q)}function Vh(C,T,M){return M||(M=$e),180*Math.atan2(T[M[1]]-C[M[1]],T[M[0]]-C[M[0]])/Math.PI}Oi.prototype={handler:function(){},init:function(){this.evEl&&$i(this.element,this.evEl,this.domHandler),this.evTarget&&$i(this.target,this.evTarget,this.domHandler),this.evWin&&$i(oi(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&qi(this.element,this.evEl,this.domHandler),this.evTarget&&qi(this.target,this.evTarget,this.domHandler),this.evWin&&qi(oi(this.element),this.evWin,this.domHandler)}};var Uo={mousedown:gi,mousemove:2,mouseup:bn},gu="mousedown",dw="mousemove mouseup";function Ra(){this.evEl=gu,this.evWin=dw,this.pressed=!1,Oi.apply(this,arguments)}Dt(Ra,Oi,{handler:function(T){var M=Uo[T.type];M&gi&&0===T.button&&(this.pressed=!0),2&M&&1!==T.which&&(M=bn),this.pressed&&(M&bn&&(this.pressed=!1),this.callback(this.manager,M,{pointers:[T],changedPointers:[T],pointerType:lu,srcEvent:T}))}});var hw={pointerdown:gi,pointermove:2,pointerup:bn,pointercancel:mi,pointerout:mi},jh={2:Ir,3:"pen",4:lu,5:"kinect"},wm="pointerdown",jo="pointermove pointerup pointercancel";function Oa(){this.evEl=wm,this.evWin=jo,Oi.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}zt.MSPointerEvent&&!zt.PointerEvent&&(wm="MSPointerDown",jo="MSPointerMove MSPointerUp MSPointerCancel"),Dt(Oa,Oi,{handler:function(T){var M=this.store,N=!1,q=T.type.toLowerCase().replace("ms",""),oe=hw[q],Je=jh[T.pointerType]||T.pointerType,Wn=Je==Ir,$n=Re(M,T.pointerId,"pointerId");oe&gi&&(0===T.button||Wn)?$n<0&&(M.push(T),$n=M.length-1):oe&(bn|mi)&&(N=!0),!($n<0)&&(M[$n]=T,this.callback(this.manager,oe,{pointers:M,changedPointers:[T],pointerType:Je,srcEvent:T}),N&&M.splice($n,1))}});var fw={touchstart:gi,touchmove:2,touchend:bn,touchcancel:mi};function mu(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,Oi.apply(this,arguments)}function Ys(C,T){var M=ze(C.touches),N=ze(C.changedTouches);return T&(bn|mi)&&(M=Rt(M.concat(N),"identifier",!0)),[M,N]}Dt(mu,Oi,{handler:function(T){var M=fw[T.type];if(M===gi&&(this.started=!0),this.started){var N=Ys.call(this,T,M);M&(bn|mi)&&N[0].length-N[1].length==0&&(this.started=!1),this.callback(this.manager,M,{pointers:N[0],changedPointers:N[1],pointerType:Ir,srcEvent:T})}}});var gw={touchstart:gi,touchmove:2,touchend:bn,touchcancel:mi},Em="touchstart touchmove touchend touchcancel";function be(){this.evTarget=Em,this.targetIds={},Oi.apply(this,arguments)}function Cm(C,T){var M=ze(C.touches),N=this.targetIds;if(T&(2|gi)&&1===M.length)return N[M[0].identifier]=!0,[M,M];var q,oe,Je=ze(C.changedTouches),Wn=[],$n=this.target;if(oe=M.filter(function(_i){return Z(_i.target,$n)}),T===gi)for(q=0;q<oe.length;)N[oe[q].identifier]=!0,q++;for(q=0;q<Je.length;)N[Je[q].identifier]&&Wn.push(Je[q]),T&(bn|mi)&&delete N[Je[q].identifier],q++;return Wn.length?[Rt(oe.concat(Wn),"identifier",!0),Wn]:void 0}Dt(be,Oi,{handler:function(T){var M=gw[T.type],N=Cm.call(this,T,M);N&&this.callback(this.manager,M,{pointers:N[0],changedPointers:N[1],pointerType:Ir,srcEvent:T})}});var mw=2500;function zh(){Oi.apply(this,arguments);var C=Gn(this.handler,this);this.touch=new be(this.manager,C),this.mouse=new Ra(this.manager,C),this.primaryTouch=null,this.lastTouches=[]}function fe(C,T){C&gi?(this.primaryTouch=T.changedPointers[0].identifier,Gh.call(this,T)):C&(bn|mi)&&Gh.call(this,T)}function Gh(C){var T=C.changedPointers[0];if(T.identifier===this.primaryTouch){var M={x:T.clientX,y:T.clientY};this.lastTouches.push(M);var N=this.lastTouches;setTimeout(function(){var oe=N.indexOf(M);oe>-1&&N.splice(oe,1)},mw)}}function On(C){for(var T=C.srcEvent.clientX,M=C.srcEvent.clientY,N=0;N<this.lastTouches.length;N++){var q=this.lastTouches[N],oe=Math.abs(T-q.x),Je=Math.abs(M-q.y);if(oe<=25&&Je<=25)return!0}return!1}Dt(zh,Oi,{handler:function(T,M,N){var oe=N.pointerType==lu;if(!(oe&&N.sourceCapabilities&&N.sourceCapabilities.firesTouchEvents)){if(N.pointerType==Ir)fe.call(this,M,N);else if(oe&&On.call(this,N))return;this.callback(T,M,N)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Wh=cn(Se.style,"touchAction"),Ft=Wh!==ve,It="compute",le="manipulation",Ho="none",bs="pan-x",Pa="pan-y",Gc=function _w(){if(!Ft)return!1;var C={},T=zt.CSS&&zt.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(M){C[M]=!T||zt.CSS.supports("touch-action",M)}),C}();function _u(C,T){this.manager=C,this.set(T)}_u.prototype={set:function(C){C==It&&(C=this.compute()),Ft&&this.manager.element.style&&Gc[C]&&(this.manager.element.style[Wh]=C),this.actions=C.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var C=[];return Ke(this.manager.recognizers,function(T){Mr(T.options.enable,[T])&&(C=C.concat(T.getTouchAction()))}),function $h(C){if(J(C,Ho))return Ho;var T=J(C,bs),M=J(C,Pa);return T&&M?Ho:T||M?T?bs:Pa:J(C,le)?le:"auto"}(C.join(" "))},preventDefaults:function(C){var T=C.srcEvent,M=C.offsetDirection;if(!this.manager.session.prevented){var N=this.actions,q=J(N,Ho)&&!Gc[Ho],oe=J(N,Pa)&&!Gc[Pa],Je=J(N,bs)&&!Gc[bs];if(q&&1===C.pointers.length&&C.distance<2&&C.deltaTime<250)return;return Je&&oe||!(q||oe&&M&ur||Je&&M&Vo)?void 0:this.preventSrc(T)}T.preventDefault()},preventSrc:function(C){this.manager.session.prevented=!0,C.preventDefault()}};var yu=1;function Es(C){this.options=he({},this.defaults,C||{}),this.id=function vn(){return Gt++}(),this.manager=null,this.options.enable=fi(this.options.enable,!0),this.state=yu,this.simultaneous={},this.requireFail=[]}function xm(C){return 16&C?"cancel":8&C?"end":4&C?"move":2&C?"start":""}function yw(C){return C==jc?"down":C==Uc?"up":C==hu?"left":C==Vc?"right":""}function qh(C,T){var M=T.manager;return M?M.get(C):C}function Jr(){Es.apply(this,arguments)}function nn(){Jr.apply(this,arguments),this.pX=null,this.pY=null}function Sm(){Jr.apply(this,arguments)}function Xh(){Es.apply(this,arguments),this._timer=null,this._input=null}function Yh(){Jr.apply(this,arguments)}function Mm(){Jr.apply(this,arguments)}function vu(){Es.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Cs(C,T){return(T=T||{}).recognizers=fi(T.recognizers,Cs.defaults.preset),new Kh(C,T)}function Kh(C,T){this.options=he({},Cs.defaults,T||{}),this.options.inputTarget=this.options.inputTarget||C,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=C,this.input=function fu(C){return new(C.options.inputClass||(bt?Oa:Ri?be:ai?zh:Ra))(C,kt)}(this),this.touchAction=new _u(this,this.options.touchAction),Dm(this,!0),Ke(this.options.recognizers,function(M){var N=this.add(new M[0](M[1]));M[2]&&N.recognizeWith(M[2]),M[3]&&N.requireFailure(M[3])},this)}function Dm(C,T){var N,M=C.element;M.style&&(Ke(C.options.cssProps,function(q,oe){N=cn(M.style,oe),T?(C.oldCssProps[N]=M.style[N],M.style[N]=q):M.style[N]=C.oldCssProps[N]||""}),T||(C.oldCssProps={}))}Es.prototype={defaults:{},set:function(C){return he(this.options,C),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(C){if(z(C,"recognizeWith",this))return this;var T=this.simultaneous;return T[(C=qh(C,this)).id]||(T[C.id]=C,C.recognizeWith(this)),this},dropRecognizeWith:function(C){return z(C,"dropRecognizeWith",this)||(C=qh(C,this),delete this.simultaneous[C.id]),this},requireFailure:function(C){if(z(C,"requireFailure",this))return this;var T=this.requireFail;return-1===Re(T,C=qh(C,this))&&(T.push(C),C.requireFailure(this)),this},dropRequireFailure:function(C){if(z(C,"dropRequireFailure",this))return this;C=qh(C,this);var T=Re(this.requireFail,C);return T>-1&&this.requireFail.splice(T,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(C){return!!this.simultaneous[C.id]},emit:function(C){var T=this,M=this.state;function N(q){T.manager.emit(q,C)}M<8&&N(T.options.event+xm(M)),N(T.options.event),C.additionalEvent&&N(C.additionalEvent),M>=8&&N(T.options.event+xm(M))},tryEmit:function(C){if(this.canEmit())return this.emit(C);this.state=32},canEmit:function(){for(var C=0;C<this.requireFail.length;){if(!(this.requireFail[C].state&(32|yu)))return!1;C++}return!0},recognize:function(C){var T=he({},C);if(!Mr(this.options.enable,[this,T]))return this.reset(),void(this.state=32);56&this.state&&(this.state=yu),this.state=this.process(T),30&this.state&&this.tryEmit(T)},process:function(C){},getTouchAction:function(){},reset:function(){}},Dt(Jr,Es,{defaults:{pointers:1},attrTest:function(C){var T=this.options.pointers;return 0===T||C.pointers.length===T},process:function(C){var T=this.state,M=C.eventType,N=6&T,q=this.attrTest(C);return N&&(M&mi||!q)?16|T:N||q?M&bn?8|T:2&T?4|T:2:32}}),Dt(nn,Jr,{defaults:{event:"pan",threshold:10,pointers:1,direction:lw},getTouchAction:function(){var C=this.options.direction,T=[];return C&ur&&T.push(Pa),C&Vo&&T.push(bs),T},directionTest:function(C){var T=this.options,M=!0,N=C.distance,q=C.direction,oe=C.deltaX,Je=C.deltaY;return q&T.direction||(T.direction&ur?(q=0===oe?du:oe<0?hu:Vc,M=oe!=this.pX,N=Math.abs(C.deltaX)):(q=0===Je?du:Je<0?Uc:jc,M=Je!=this.pY,N=Math.abs(C.deltaY))),C.direction=q,M&&N>T.threshold&&q&T.direction},attrTest:function(C){return Jr.prototype.attrTest.call(this,C)&&(2&this.state||!(2&this.state)&&this.directionTest(C))},emit:function(C){this.pX=C.deltaX,this.pY=C.deltaY;var T=yw(C.direction);T&&(C.additionalEvent=this.options.event+T),this._super.emit.call(this,C)}}),Dt(Sm,Jr,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ho]},attrTest:function(C){return this._super.attrTest.call(this,C)&&(Math.abs(C.scale-1)>this.options.threshold||2&this.state)},emit:function(C){1!==C.scale&&(C.additionalEvent=this.options.event+(C.scale<1?"in":"out")),this._super.emit.call(this,C)}}),Dt(Xh,Es,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(C){var T=this.options,M=C.pointers.length===T.pointers,N=C.distance<T.threshold,q=C.deltaTime>T.time;if(this._input=C,!N||!M||C.eventType&(bn|mi)&&!q)this.reset();else if(C.eventType&gi)this.reset(),this._timer=K(function(){this.state=8,this.tryEmit()},T.time,this);else if(C.eventType&bn)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(C){8===this.state&&(C&&C.eventType&bn?this.manager.emit(this.options.event+"up",C):(this._input.timeStamp=re(),this.manager.emit(this.options.event,this._input)))}}),Dt(Yh,Jr,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ho]},attrTest:function(C){return this._super.attrTest.call(this,C)&&(Math.abs(C.rotation)>this.options.threshold||2&this.state)}}),Dt(Mm,Jr,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ur|Vo,pointers:1},getTouchAction:function(){return nn.prototype.getTouchAction.call(this)},attrTest:function(C){var M,T=this.options.direction;return T&(ur|Vo)?M=C.overallVelocity:T&ur?M=C.overallVelocityX:T&Vo&&(M=C.overallVelocityY),this._super.attrTest.call(this,C)&&T&C.offsetDirection&&C.distance>this.options.threshold&&C.maxPointers==this.options.pointers&&Ue(M)>this.options.velocity&&C.eventType&bn},emit:function(C){var T=yw(C.offsetDirection);T&&this.manager.emit(this.options.event+T,C),this.manager.emit(this.options.event,C)}}),Dt(vu,Es,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[le]},process:function(C){var T=this.options,M=C.pointers.length===T.pointers,N=C.distance<T.threshold,q=C.deltaTime<T.time;if(this.reset(),C.eventType&gi&&0===this.count)return this.failTimeout();if(N&&q&&M){if(C.eventType!=bn)return this.failTimeout();var oe=!this.pTime||C.timeStamp-this.pTime<T.interval,Je=!this.pCenter||pu(this.pCenter,C.center)<T.posThreshold;if(this.pTime=C.timeStamp,this.pCenter=C.center,Je&&oe?this.count+=1:this.count=1,this._input=C,0==this.count%T.taps)return this.hasRequireFailures()?(this._timer=K(function(){this.state=8,this.tryEmit()},T.interval,this),2):8}return 32},failTimeout:function(){return this._timer=K(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Cs.VERSION="2.0.7",Cs.defaults={domEvents:!1,touchAction:It,enable:!0,inputTarget:null,inputClass:null,preset:[[Yh,{enable:!1}],[Sm,{enable:!1},["rotate"]],[Mm,{direction:ur}],[nn,{direction:ur},["swipe"]],[vu],[vu,{event:"doubletap",taps:2},["tap"]],[Xh]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Kh.prototype={set:function(C){return he(this.options,C),C.touchAction&&this.touchAction.update(),C.inputTarget&&(this.input.destroy(),this.input.target=C.inputTarget,this.input.init()),this},stop:function(C){this.session.stopped=C?2:1},recognize:function(C){var T=this.session;if(!T.stopped){this.touchAction.preventDefaults(C);var M,N=this.recognizers,q=T.curRecognizer;(!q||q&&8&q.state)&&(q=T.curRecognizer=null);for(var oe=0;oe<N.length;)M=N[oe],2===T.stopped||q&&M!=q&&!M.canRecognizeWith(q)?M.reset():M.recognize(C),!q&&14&M.state&&(q=T.curRecognizer=M),oe++}},get:function(C){if(C instanceof Es)return C;for(var T=this.recognizers,M=0;M<T.length;M++)if(T[M].options.event==C)return T[M];return null},add:function(C){if(z(C,"add",this))return this;var T=this.get(C.options.event);return T&&this.remove(T),this.recognizers.push(C),C.manager=this,this.touchAction.update(),C},remove:function(C){if(z(C,"remove",this))return this;if(C=this.get(C)){var T=this.recognizers,M=Re(T,C);-1!==M&&(T.splice(M,1),this.touchAction.update())}return this},on:function(C,T){if(C!==ve&&T!==ve){var M=this.handlers;return Ke(De(C),function(N){M[N]=M[N]||[],M[N].push(T)}),this}},off:function(C,T){if(C!==ve){var M=this.handlers;return Ke(De(C),function(N){T?M[N]&&M[N].splice(Re(M[N],T),1):delete M[N]}),this}},emit:function(C,T){this.options.domEvents&&function lR(C,T){var M=hn.createEvent("Event");M.initEvent(C,!0,!0),M.gesture=T,T.target.dispatchEvent(M)}(C,T);var M=this.handlers[C]&&this.handlers[C].slice();if(M&&M.length){T.type=C,T.preventDefault=function(){T.srcEvent.preventDefault()};for(var N=0;N<M.length;)M[N](T),N++}},destroy:function(){this.element&&Dm(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},he(Cs,{INPUT_START:gi,INPUT_MOVE:2,INPUT_END:bn,INPUT_CANCEL:mi,STATE_POSSIBLE:yu,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:du,DIRECTION_LEFT:hu,DIRECTION_RIGHT:Vc,DIRECTION_UP:Uc,DIRECTION_DOWN:jc,DIRECTION_HORIZONTAL:ur,DIRECTION_VERTICAL:Vo,DIRECTION_ALL:lw,Manager:Kh,Input:Oi,TouchAction:_u,TouchInput:be,MouseInput:Ra,PointerEventInput:Oa,TouchMouseInput:zh,SingleTouchInput:mu,Recognizer:Es,AttrRecognizer:Jr,Tap:vu,Pan:nn,Swipe:Mm,Pinch:Sm,Rotate:Yh,Press:Xh,on:$i,off:qi,each:Ke,merge:gn,extend:Mt,assign:he,inherit:Dt,bindFn:Gn,prefixed:cn}),(typeof zt<"u"?zt:typeof self<"u"?self:{}).Hammer=Cs,(yn=function(){return Cs}.call(ri,at,ri,Di))!==ve&&(Di.exports=yn)}(window,document)},492:()=>{},435:()=>{}},Di=>{Di(Di.s=725)}]);