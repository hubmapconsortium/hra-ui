<ng-scrollbar>
  <form [formGroup]="filterForm">
    <div class="input-container">
      <div class="section">
        <div class="section-title">Demographics</div>
        <div class="patient-filters">
          <mat-form-field class="dropdown-form-field" subscriptSizing="dynamic">
            <mat-label>Sex</mat-label>
            <mat-select
              (selectionChange)="updateFilter($event.value, 'sex')"
              disableOptionCentering="true"
              panelClass="options-container"
              disableRipple
              [value]="filterForm.controls.sex.value"
            >
              @for (option of ['Both', 'Male', 'Female']; track option) {
                <mat-option class="dropdown-option" [value]="option">
                  <div>{{ option }}</div>
                </mat-option>
              }
            </mat-select>
          </mat-form-field>

          <ccf-dual-slider
            label="Age"
            [valueRange]="[1, 110]"
            [selection]="filterForm.controls.ageRange.value ?? []"
            (selectionChange)="updateFilter($event, 'ageRange')"
          ></ccf-dual-slider>
          <ccf-dual-slider
            label="BMI"
            [valueRange]="[13, 83]"
            [selection]="filterForm.controls.bmiRange.value ?? []"
            (selectionChange)="updateFilter($event, 'bmiRange')"
          ></ccf-dual-slider>
        </div>
      </div>

      <div class="section">
        <div class="section-title">Provenance</div>
        <ccf-autocomplete-chips-form
          class="assay-form"
          label="Assay Types"
          [filterOptions]="technologyFilters()"
          [form]="filterForm.controls.technologies"
        >
        </ccf-autocomplete-chips-form>

        <ccf-autocomplete-chips-form
          class="consortia-form"
          label="Consortia"
          [filterOptions]="['HuBMAP', 'SenNet']"
          [form]="filterForm.controls.consortia"
        >
        </ccf-autocomplete-chips-form>

        <ccf-autocomplete-chips-form
          class="providers-form"
          label="Tissue Data Providers"
          [filterOptions]="providerFilters()"
          [form]="filterForm.controls.providers"
        >
        </ccf-autocomplete-chips-form>
      </div>

      <div class="section spatial-search">
        <div class="spatial-search-header">
          <div class="section-title">Spatial Locations</div>
          <ccf-run-spatial-search></ccf-run-spatial-search>
        </div>
        <ccf-spatial-search-list
          [items]="spatialSearchFilters()"
          (selectionChanged)="updateSearchSelection($event)"
          (itemRemoved)="spatialSearchRemoved.emit($event.id)"
        >
        </ccf-spatial-search-list>
      </div>
    </div>
  </form>
</ng-scrollbar>

<div class="button-container">
  <button mat-button (click)="refreshFilters()">
    Reset Filters<mat-icon class="reset icon" svgIcon="reset_wrench"></mat-icon>
  </button>
  <button mat-flat-button (click)="applyButtonClick()" [disabled]="filterForm.pristine || filterForm.invalid">
    Apply
  </button>
</div>
