<mat-tree [dataSource]="dataSource" [treeControl]="treeControl" hraTreeSize="small">
  <!-- This is the tree node template for leaf nodes -->
  <mat-tree-node
    *matTreeNodeDef="let node"
    matTreeNodePadding
    (click)="select($event.ctrlKey, node, true, !isSelected(node))"
  >
    <div class="node-content leaf" [class.selected]="isSelected(node)">
      <!-- use a disabled button to provide padding for tree leaf -->
      <button mat-icon-button disabled></button>
      {{ node.label }}
      <div class="num-results" [class.suborgan]="node.level > 1">
        {{ getCountLabel(node) }}{{ occurenceData[node.original.id] || 0 }}
      </div>
    </div>

    <div class="biomarkers-toggle" *ngIf="node.original.id === 'biomarkers'">
      <mat-button-toggle-group
        multiple
        hideMultipleSelectionIndicator
        name="multiSelect"
        aria-label="Multi Select"
        hraButtonToggleSize="small"
        (change)="toggleSelection($event.value)"
      >
        @for (option of menuOptions; track option) {
          <mat-button-toggle [value]="option" [checked]="isItemSelected(option)">{{ option }}</mat-button-toggle>
        }
      </mat-button-toggle-group>
    </div>
  </mat-tree-node>

  <!-- This is the tree node template for expandable nodes -->
  <mat-tree-node
    *matTreeNodeDef="let node; when: hasChild"
    matTreeNodePadding
    matTreeNodeToggle
    [cdkTreeNodeTypeaheadLabel]="node.label"
    (click)="select($event.ctrlKey, node, true, !isSelected(node))"
  >
    <div class="node-content leaf" [class.selected]="isSelected(node)">
      <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'Toggle ' + node.label">
        <mat-icon class="mat-icon-rtl-mirror">
          {{ treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right' }}
        </mat-icon>
      </button>
      {{ node.label }}
      <div class="num-results" [class.suborgan]="node.level > 1">
        {{ getCountLabel(node) }}{{ occurenceData[node.original.id] || 0 }}
      </div>
    </div>

    <div class="biomarkers-toggle" *ngIf="node.original.id === 'biomarkers'">
      <mat-button-toggle-group
        multiple
        hideMultipleSelectionIndicator
        name="multiSelect"
        aria-label="Multi Select"
        hraButtonToggleSize="small"
        (change)="toggleSelection($event.value)"
      >
        @for (option of menuOptions; track option) {
          <mat-button-toggle [value]="option" [checked]="isItemSelected(option)">{{ option }}</mat-button-toggle>
        }
      </mat-button-toggle-group>
    </div>
  </mat-tree-node>
</mat-tree>
